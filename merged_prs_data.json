[
    {
        "prompt": "issue: test | description: <!--\r\n  Thanks for submitting a pull request!\r\n  We appreciate you spending the time to work on these changes. Please provide enough information so that others can review your pull request. The three fields below are mandatory.\r\n\r\n  Before submitting a pull request, please make sure the following is done:\r\n\r\n  1. Fork [the repository](https://github.com/facebook/react) and create your branch from `main`.\r\n  2. Run `yarn` in the repository root.\r\n  3. If you've fixed a bug or added code that should be tested, add tests!\r\n  4. Ensure the test suite passes (`yarn test`). Tip: `yarn test --watch TestName` is helpful in development.\r\n  5. Run `yarn test --prod` to test in the production environment. It supports the same options as `yarn test`.\r\n  6. If you need a debugger, run `yarn test --debug --watch TestName`, open `chrome://inspect`, and press \"Inspect\".\r\n  7. Format your code with [prettier](https://github.com/prettier/prettier) (`yarn prettier`).\r\n  8. Make sure your code lints (`yarn lint`). Tip: `yarn linc` to only check changed files.\r\n  9. Run the [Flow](https://flowtype.org/) type checks (`yarn flow`).\r\n  10. If you haven't already, complete the CLA.\r\n\r\n  Learn more about contributing: https://reactjs.org/docs/how-to-contribute.html\r\n-->\r\n\r\n## Summary\r\n\r\n<!--\r\n Explain the **motivation** for making this change. What existing problem does the pull request solve?\r\n-->\r\n\r\n## How did you test this change?\r\n\r\n<!--\r\n  Demonstrate the code is solid. Example: The exact commands you ran and their output, screenshots / videos if the pull request changes the user interface.\r\n  How exactly did you verify that your PR solves the issue you wanted to solve?\r\n  If you leave this empty, your PR will very likely be closed.\r\n-->\r\n",
        "completion": [
            {
                "file": "packages/react/index.js",
                "git_diff": "@@ -8,13 +8,13 @@\n  */\n \n // Keep in sync with https://github.com/facebook/flow/blob/main/lib/react.js\n-export type ComponentType<-P> = React$ComponentType<P>;\n+export type ComponentType<-P > = React$ComponentType < P >;\n export type AbstractComponent<\n   -Config,\n   +Instance = mixed,\n-> = React$AbstractComponent<Config, Instance>;\n+> = React$AbstractComponent < Config, Instance >;\n export type ElementType = React$ElementType;\n-export type Element<+C> = React$Element<C>;\n+export type Element<+C > = React$Element < C >;\n export type MixedElement = React$Element<ElementType>;\n export type Key = React$Key;\n export type Ref<C> = React$Ref<C>;\n@@ -25,10 +25,11 @@ export type ElementProps<C> = React$ElementProps<C>;\n export type ElementConfig<C> = React$ElementConfig<C>;\n export type ElementRef<C> = React$ElementRef<C>;\n export type Config<Props, DefaultProps> = React$Config<Props, DefaultProps>;\n-export type ChildrenArray<+T> = $ReadOnlyArray<ChildrenArray<T>> | T;\n+export type ChildrenArray<+T > = $ReadOnlyArray < ChildrenArray < T >> | T;\n \n // Export all exports so that they're available in tests.\n // We can't use export * from in Flow for some reason.\n+console.log('hello wrod')\n export {\n   __CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,\n   Children,"
            }
        ]
    },
    {
        "prompt": "issue: [compiler] Fixture to show current behavior of nested function declarations | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* #30922\n* __->__ #30921\n\nSummary:\nShows both memoized and unmemoized function declarations",
        "completion": [
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/function-decl-nested.expect.md",
                "git_diff": "@@ -0,0 +1,83 @@\n+\n+## Input\n+\n+```javascript\n+import {useRef} from 'react';\n+\n+function C(x) {\n+  function g(x) {\n+    return 2;\n+  }\n+  g();\n+  function f() {\n+    return x.x;\n+  }\n+  function h(x) {\n+    return 2;\n+  }\n+  return <>{h(f)}</>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: C,\n+  params: [{x: 1}],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\";\n+import { useRef } from \"react\";\n+\n+function C(x) {\n+  const $ = _c(5);\n+  const g = function g(x_0) {\n+    return 2;\n+  };\n+\n+  g();\n+  let t0;\n+  if ($[0] !== x.x) {\n+    t0 = function f() {\n+      return x.x;\n+    };\n+    $[0] = x.x;\n+    $[1] = t0;\n+  } else {\n+    t0 = $[1];\n+  }\n+  const f = t0;\n+  let t1;\n+  if ($[2] === Symbol.for(\"react.memo_cache_sentinel\")) {\n+    t1 = function h(x_1) {\n+      return 2;\n+    };\n+    $[2] = t1;\n+  } else {\n+    t1 = $[2];\n+  }\n+  const h = t1;\n+\n+  const t2 = h(f);\n+  let t3;\n+  if ($[3] !== t2) {\n+    t3 = <>{t2}</>;\n+    $[3] = t2;\n+    $[4] = t3;\n+  } else {\n+    t3 = $[4];\n+  }\n+  return t3;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: C,\n+  params: [{ x: 1 }],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) 2\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/function-decl-nested.js",
                "git_diff": "@@ -0,0 +1,20 @@\n+import {useRef} from 'react';\n+\n+function C(x) {\n+  function g(x) {\n+    return 2;\n+  }\n+  g();\n+  function f() {\n+    return x.x;\n+  }\n+  function h(x) {\n+    return 2;\n+  }\n+  return <>{h(f)}</>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: C,\n+  params: [{x: 1}],\n+};"
            }
        ]
    },
    {
        "prompt": "issue: [compiler] Allow ref access in useImperativeHandle | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* __->__ #30913\n* #30902\n* #30912\n\nSummary:\nCode within the useImperativeHandle callback is not executed during render, much like useEffect. We can apply the same rules around ref access to this callback.",
        "completion": [
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/Globals.ts",
                "git_diff": "@@ -362,6 +362,17 @@ const REACT_APIS: Array<[string, BuiltInType]> = [\n       returnValueKind: ValueKind.Mutable,\n     }),\n   ],\n+  [\n+    'useImperativeHandle',\n+    addHook(DEFAULT_SHAPES, {\n+      positionalParams: [],\n+      restParam: Effect.Freeze,\n+      returnType: {kind: 'Primitive'},\n+      calleeEffect: Effect.Read,\n+      hookKind: 'useImperativeHandle',\n+      returnValueKind: ValueKind.Frozen,\n+    }),\n+  ],\n   [\n     'useMemo',\n     addHook(DEFAULT_SHAPES, {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/ObjectShape.ts",
                "git_diff": "@@ -127,6 +127,7 @@ export type HookKind =\n   | 'useMemo'\n   | 'useCallback'\n   | 'useTransition'\n+  | 'useImperativeHandle'\n   | 'Custom';\n \n /*"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoRefAccesInRender.ts",
                "git_diff": "@@ -282,7 +282,12 @@ function validateNoRefAccessInRenderImpl(\n             break;\n           }\n           case 'MethodCall': {\n-            if (!isEffectHook(instr.value.property.identifier)) {\n+            if (\n+              !isHookThatAllowsRefValueAccess(\n+                fn,\n+                instr.value.property.identifier,\n+              )\n+            ) {\n               for (const operand of eachInstructionValueOperand(instr.value)) {\n                 const hookKind = getHookKindForType(\n                   fn.env,\n@@ -307,7 +312,10 @@ function validateNoRefAccessInRenderImpl(\n           case 'CallExpression': {\n             const callee = instr.value.callee;\n             const hookKind = getHookKindForType(fn.env, callee.identifier.type);\n-            const isUseEffect = isEffectHook(callee.identifier);\n+            const isUseEffect = isHookThatAllowsRefValueAccess(\n+              fn,\n+              callee.identifier,\n+            );\n             let returnType: RefAccessType = {kind: 'None'};\n             if (!isUseEffect) {\n               // Report a more precise error when calling a local function that accesses a ref\n@@ -499,3 +507,11 @@ function validateNoDirectRefValueAccess(\n     });\n   }\n }\n+\n+function isHookThatAllowsRefValueAccess(\n+  fn: HIRFunction,\n+  identifier: Identifier,\n+): boolean {\n+  const hookKind = getHookKindForType(fn.env, identifier.type);\n+  return isEffectHook(identifier) || hookKind === 'useImperativeHandle';\n+}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/useImperativeHandle-ref-mutate.expect.md",
                "git_diff": "@@ -0,0 +1,66 @@\n+\n+## Input\n+\n+```javascript\n+// @flow\n+\n+import {useImperativeHandle, useRef} from 'react';\n+\n+component Component(prop: number) {\n+  const ref1 = useRef(null);\n+  const ref2 = useRef(1);\n+  useImperativeHandle(ref1, () => {\n+    const precomputed = prop + ref2.current;\n+    return {\n+      foo: () => prop + ref2.current + precomputed,\n+    };\n+  }, [prop]);\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{prop: 1}],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\";\n+\n+import { useImperativeHandle, useRef } from \"react\";\n+\n+function Component(t0) {\n+  const $ = _c(3);\n+  const { prop } = t0;\n+  const ref1 = useRef(null);\n+  const ref2 = useRef(1);\n+  let t1;\n+  let t2;\n+  if ($[0] !== prop) {\n+    t1 = () => {\n+      const precomputed = prop + ref2.current;\n+      return { foo: () => prop + ref2.current + precomputed };\n+    };\n+\n+    t2 = [prop];\n+    $[0] = prop;\n+    $[1] = t1;\n+    $[2] = t2;\n+  } else {\n+    t1 = $[1];\n+    t2 = $[2];\n+  }\n+  useImperativeHandle(ref1, t1, t2);\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{ prop: 1 }],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) \n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/useImperativeHandle-ref-mutate.js",
                "git_diff": "@@ -0,0 +1,19 @@\n+// @flow\n+\n+import {useImperativeHandle, useRef} from 'react';\n+\n+component Component(prop: number) {\n+  const ref1 = useRef(null);\n+  const ref2 = useRef(1);\n+  useImperativeHandle(ref1, () => {\n+    const precomputed = prop + ref2.current;\n+    return {\n+      foo: () => prop + ref2.current + precomputed,\n+    };\n+  }, [prop]);\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{prop: 1}],\n+};"
            }
        ]
    },
    {
        "prompt": "issue: [flow] Upgrade Flow to 0.245.2 | description: ## Summary\r\n\r\nThis PR bumps Flow all the way to the latest 0.245.2. \r\n\r\nMost of the suppressions comes from Flow v0.239.0's change to include undefined in the return of `Array.pop`. \r\n\r\nI also enabled `react.custom_jsx_typing=true` and added custom jsx typing to match the old behavior that `React.createElement` is effectively any typed. This is necessary since various builtin components like `React.Fragment` is actually symbol in the React repo instead of `React.AbstractComponent<...>`. It can be made more accurate by customizing the `React$CustomJSXFactory` type, but I will leave it to the React team to decide.\r\n\r\n## How did you test this change?\r\n\r\n`yarn flow` for all the renderers\r\n",
        "completion": [
            {
                "file": "package.json",
                "git_diff": "@@ -63,8 +63,8 @@\n     \"eslint-plugin-react-internal\": \"link:./scripts/eslint-rules\",\n     \"fbjs-scripts\": \"^3.0.1\",\n     \"filesize\": \"^6.0.1\",\n-    \"flow-bin\": \"^0.235.0\",\n-    \"flow-remove-types\": \"^2.235.0\",\n+    \"flow-bin\": \"^0.245.2\",\n+    \"flow-remove-types\": \"^2.245.2\",\n     \"glob\": \"^7.1.6\",\n     \"glob-stream\": \"^6.1.0\",\n     \"google-closure-compiler\": \"^20230206.0.0\","
            },
            {
                "file": "packages/internal-test-utils/internalAct.js",
                "git_diff": "@@ -163,6 +163,7 @@ export async function act<T>(scope: () => Thenable<T>): Thenable<T> {\n       throw thrownError;\n     }\n \n+    // $FlowFixMe[incompatible-return]\n     return result;\n   } finally {\n     const depth = actingUpdatesScopeDepth;\n@@ -271,6 +272,7 @@ export async function serverAct<T>(scope: () => Thenable<T>): Thenable<T> {\n       throw thrownError;\n     }\n \n+    // $FlowFixMe[incompatible-return]\n     return result;\n   } finally {\n     if (typeof process === 'object') {"
            },
            {
                "file": "packages/react-client/src/ReactFlightReplyClient.js",
                "git_diff": "@@ -554,6 +554,7 @@ export function processReply(\n         const prefix = formFieldPrefix + refId + '_';\n         // $FlowFixMe[prop-missing]: FormData has forEach.\n         value.forEach((originalValue: string | File, originalKey: string) => {\n+          // $FlowFixMe[incompatible-call]\n           data.append(prefix + originalKey, originalValue);\n         });\n         return serializeFormDataReference(refId);\n@@ -925,6 +926,7 @@ function defaultEncodeFormAction(\n     const prefixedData = new FormData();\n     // $FlowFixMe[prop-missing]\n     encodedFormData.forEach((value: string | File, key: string) => {\n+      // $FlowFixMe[incompatible-call]\n       prefixedData.append('$ACTION_' + identifierPrefix + ':' + key, value);\n     });\n     data = prefixedData;\n@@ -1153,6 +1155,7 @@ const FunctionBind = Function.prototype.bind;\n const ArraySlice = Array.prototype.slice;\n function bind(this: Function): Function {\n   // $FlowFixMe[unsupported-syntax]\n+  // $FlowFixMe[prop-missing]\n   const newFn = FunctionBind.apply(this, arguments);\n   const reference = knownServerReferences.get(this);\n   if (reference) {"
            },
            {
                "file": "packages/react-debug-tools/src/ReactDebugHooks.js",
                "git_diff": "@@ -1033,6 +1033,7 @@ function buildTree(\n         }\n         // Pop back the stack as many steps as were not common.\n         for (let j = prevStack.length - 1; j > commonSteps; j--) {\n+          // $FlowFixMe[incompatible-type]\n           levelChildren = stackOfChildren.pop();\n         }\n       }"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/profilingHooks.js",
                "git_diff": "@@ -274,16 +274,19 @@ export function createProfilingHooks({\n     }\n \n     const top = currentReactMeasuresStack.pop();\n+    // $FlowFixMe[incompatible-type]\n     if (top.type !== type) {\n       console.error(\n         'Unexpected type \"%s\" completed at %sms before \"%s\" completed.',\n         type,\n         currentTime,\n+        // $FlowFixMe[incompatible-use]\n         top.type,\n       );\n     }\n \n     // $FlowFixMe[cannot-write] This property should not be writable outside of this function.\n+    // $FlowFixMe[incompatible-use]\n     top.duration = currentTime - top.timestamp;\n \n     if (currentTimelineData) {"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/utils.js",
                "git_diff": "@@ -299,10 +299,12 @@ export function formatConsoleArgumentsToSingleString(\n     if (args.length) {\n       const REGEXP = /(%?)(%([jds]))/g;\n \n+      // $FlowFixMe[incompatible-call]\n       formatted = formatted.replace(REGEXP, (match, escaped, ptn, flag) => {\n         let arg = args.shift();\n         switch (flag) {\n           case 's':\n+            // $FlowFixMe[unsafe-addition]\n             arg += '';\n             break;\n           case 'd':"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/views/Highlighter/Overlay.js",
                "git_diff": "@@ -194,6 +194,7 @@ export default class Overlay {\n \n     while (this.rects.length > elements.length) {\n       const rect = this.rects.pop();\n+      // $FlowFixMe[incompatible-use]\n       rect.remove();\n     }\n     if (elements.length === 0) {"
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Profiler/CommitTreeBuilder.js",
                "git_diff": "@@ -391,18 +391,22 @@ const __printTree = (commitTree: CommitTree) => {\n       const id = queue.shift();\n       const depth = queue.shift();\n \n+      // $FlowFixMe[incompatible-call]\n       const node = nodes.get(id);\n       if (node == null) {\n+        // $FlowFixMe[incompatible-type]\n         throw Error(`Could not find node with id \"${id}\" in commit tree`);\n       }\n \n       console.log(\n+        // $FlowFixMe[incompatible-call]\n         `${'\u2022'.repeat(depth)}${node.id}:${node.displayName || ''} ${\n           node.key ? `key:\"${node.key}\"` : ''\n         } (${node.treeBaseDuration})`,\n       );\n \n       node.children.forEach(childID => {\n+        // $FlowFixMe[unsafe-addition]\n         queue.push(childID, depth + 1);\n       });\n     }"
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/utils.js",
                "git_diff": "@@ -142,10 +142,14 @@ export function serializeHooksForCopy(hooks: HooksTree | null): string {\n     const current = queue.pop();\n \n     // These aren't meaningful\n+    // $FlowFixMe[incompatible-use]\n     delete current.id;\n+    // $FlowFixMe[incompatible-use]\n     delete current.isStateEditable;\n \n+    // $FlowFixMe[incompatible-use]\n     if (current.subHooks.length > 0) {\n+      // $FlowFixMe[incompatible-use]\n       queue.push(...current.subHooks);\n     }\n   }"
            },
            {
                "file": "packages/react-devtools-shared/src/hook.js",
                "git_diff": "@@ -532,6 +532,7 @@ export function installHook(target: any): DevToolsHook | null {\n       const startStackFrame = openModuleRangesStack.pop();\n       const stopStackFrame = getTopStackFrameString(error);\n       if (stopStackFrame !== null) {\n+        // $FlowFixMe[incompatible-call]\n         moduleRanges.push([startStackFrame, stopStackFrame]);\n       }\n     }"
            },
            {
                "file": "packages/react-devtools-shared/src/utils.js",
                "git_diff": "@@ -475,6 +475,7 @@ export function parseElementDisplayNameFromBackend(\n       if (displayName.indexOf('(') >= 0) {\n         const matches = displayName.match(/[^()]+/g);\n         if (matches != null) {\n+          // $FlowFixMe[incompatible-type]\n           displayName = matches.pop();\n           hocDisplayNames = matches;\n         }\n@@ -485,6 +486,7 @@ export function parseElementDisplayNameFromBackend(\n   }\n \n   return {\n+    // $FlowFixMe[incompatible-return]\n     formattedDisplayName: displayName,\n     hocDisplayNames,\n     compiledWithForget: false,"
            },
            {
                "file": "packages/react-devtools-timeline/src/import-worker/preprocessData.js",
                "git_diff": "@@ -202,6 +202,7 @@ function markWorkCompleted(\n     );\n   }\n \n+  // $FlowFixMe[incompatible-use]\n   const {measure, startTime} = stack.pop();\n   if (!measure) {\n     console.error('Could not find matching measure for type \"%s\".', type);"
            },
            {
                "file": "packages/react-dom/src/client/ReactDOMClientFB.js",
                "git_diff": "@@ -100,6 +100,7 @@ function flushSyncFromReconciler<R>(fn: (() => R) | void): R | void {\n       );\n     }\n   }\n+  // $FlowFixMe[incompatible-call]\n   return flushSyncWithoutWarningIfAlreadyRendering(fn);\n }\n "
            },
            {
                "file": "packages/react-native-renderer/src/ReactNativeTypes.js",
                "git_diff": "@@ -233,8 +233,8 @@ export type ReactNativeType = {\n   ): ?ElementRef<ElementType>,\n   unmountComponentAtNode(containerTag: number): void,\n   unmountComponentAtNodeAndRemoveContainer(containerTag: number): void,\n-  unstable_batchedUpdates: <T>(fn: (T) => void, bookkeeping: T) => void,\n-  __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED: SecretInternalsType,\n+  +unstable_batchedUpdates: <T>(fn: (T) => void, bookkeeping: T) => void,\n+  +__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED: SecretInternalsType,\n   ...\n };\n "
            },
            {
                "file": "packages/react-server-dom-esm/src/ReactFlightESMReferences.js",
                "git_diff": "@@ -49,7 +49,7 @@ const FunctionBind = Function.prototype.bind;\n // $FlowFixMe[method-unbinding]\n const ArraySlice = Array.prototype.slice;\n function bind(this: ServerReference<any>): any {\n-  // $FlowFixMe[unsupported-syntax]\n+  // $FlowFixMe[prop-missing]\n   const newFn = FunctionBind.apply(this, arguments);\n   if (this.$$typeof === SERVER_REFERENCE_TAG) {\n     if (__DEV__) {"
            },
            {
                "file": "packages/react-server-dom-turbopack/src/ReactFlightTurbopackReferences.js",
                "git_diff": "@@ -63,7 +63,7 @@ const FunctionBind = Function.prototype.bind;\n // $FlowFixMe[method-unbinding]\n const ArraySlice = Array.prototype.slice;\n function bind(this: ServerReference<any>): any {\n-  // $FlowFixMe[unsupported-syntax]\n+  // $FlowFixMe[prop-missing]\n   const newFn = FunctionBind.apply(this, arguments);\n   if (this.$$typeof === SERVER_REFERENCE_TAG) {\n     if (__DEV__) {"
            },
            {
                "file": "packages/react-server-dom-webpack/src/ReactFlightWebpackReferences.js",
                "git_diff": "@@ -64,6 +64,7 @@ const FunctionBind = Function.prototype.bind;\n const ArraySlice = Array.prototype.slice;\n function bind(this: ServerReference<any>): any {\n   // $FlowFixMe[unsupported-syntax]\n+  // $FlowFixMe[prop-missing]\n   const newFn = FunctionBind.apply(this, arguments);\n   if (this.$$typeof === SERVER_REFERENCE_TAG) {\n     if (__DEV__) {"
            },
            {
                "file": "packages/react-server/src/ReactFlightActionServer.js",
                "git_diff": "@@ -93,6 +93,7 @@ export function decodeAction<T>(\n   // $FlowFixMe[prop-missing]\n   body.forEach((value: string | File, key: string) => {\n     if (!key.startsWith('$ACTION_')) {\n+      // $FlowFixMe[incompatible-call]\n       formData.append(key, value);\n       return;\n     }"
            },
            {
                "file": "packages/react-server/src/ReactFlightReplyServer.js",
                "git_diff": "@@ -978,6 +978,7 @@ function parseModelString(\n         // $FlowFixMe[prop-missing] FormData has forEach on it.\n         backingFormData.forEach((entry: File | string, entryKey: string) => {\n           if (entryKey.startsWith(formPrefix)) {\n+            // $FlowFixMe[incompatible-call]\n             data.append(entryKey.slice(formPrefix.length), entry);\n           }\n         });"
            },
            {
                "file": "packages/react-test-renderer/src/ReactTestRenderer.js",
                "git_diff": "@@ -166,10 +166,14 @@ function flatten(arr) {\n   const stack = [{i: 0, array: arr}];\n   while (stack.length) {\n     const n = stack.pop();\n+    // $FlowFixMe[incompatible-use]\n     while (n.i < n.array.length) {\n+      // $FlowFixMe[incompatible-use]\n       const el = n.array[n.i];\n+      // $FlowFixMe[incompatible-use]\n       n.i += 1;\n       if (isArray(el)) {\n+        // $FlowFixMe[incompatible-call]\n         stack.push(n);\n         stack.push({i: 0, array: el});\n         break;"
            },
            {
                "file": "packages/scheduler/src/SchedulerMinHeap.js",
                "git_diff": "@@ -31,7 +31,9 @@ export function pop<T: Node>(heap: Heap<T>): T | null {\n   const first = heap[0];\n   const last = heap.pop();\n   if (last !== first) {\n+    // $FlowFixMe[incompatible-type]\n     heap[0] = last;\n+    // $FlowFixMe[incompatible-call]\n     siftDown(heap, last, 0);\n   }\n   return first;"
            },
            {
                "file": "scripts/flow/config/flowconfig",
                "git_diff": "@@ -31,9 +31,12 @@\n \n [lints]\n untyped-type-import=error\n+internal-type=off\n+deprecated-type=off\n \n [options]\n munge_underscores=false\n+react.custom_jsx_typing=true\n \n # Substituted by createFlowConfig.js:\n %REACT_RENDERER_FLOW_OPTIONS%"
            },
            {
                "file": "scripts/flow/environment.js",
                "git_diff": "@@ -26,7 +26,7 @@ declare const AggregateError: Class<Error>;\n declare const FinalizationRegistry: any;\n \n declare module 'create-react-class' {\n-  declare const exports: React$CreateClass;\n+  declare const exports: $FlowFixMe;\n }\n \n declare interface ConsoleTask {\n@@ -46,6 +46,8 @@ declare opaque type React$Element<\n   +ref: any,\n };\n \n+declare type React$CustomJSXFactory = any;\n+\n declare const trustedTypes: {\n   isHTML: (value: any) => boolean,\n   isScript: (value: any) => boolean,"
            },
            {
                "file": "yarn.lock",
                "git_diff": "@@ -7366,7 +7366,7 @@ eslint-utils@^2.0.0, eslint-utils@^2.1.0:\n   dependencies:\n     eslint-visitor-keys \"^1.1.0\"\n \n-\"eslint-v7@npm:eslint@^7.7.0\", eslint@^7.7.0:\n+\"eslint-v7@npm:eslint@^7.7.0\":\n   version \"7.32.0\"\n   resolved \"https://registry.yarnpkg.com/eslint/-/eslint-7.32.0.tgz#c6d328a14be3fb08c8d1d21e12c02fdb7a2a812d\"\n   integrity sha512-VHZ8gX+EDfz+97jGcgyGCyRia/dPOd6Xh9yPv8Bl1+SoaIwD+a/vlrOmGRUyOYu7MwUhc7CxqeaDZU13S4+EpA==\n@@ -7526,6 +7526,52 @@ eslint@8.57.0:\n     strip-ansi \"^6.0.1\"\n     text-table \"^0.2.0\"\n \n+eslint@^7.7.0:\n+  version \"7.32.0\"\n+  resolved \"https://registry.yarnpkg.com/eslint/-/eslint-7.32.0.tgz#c6d328a14be3fb08c8d1d21e12c02fdb7a2a812d\"\n+  integrity sha512-VHZ8gX+EDfz+97jGcgyGCyRia/dPOd6Xh9yPv8Bl1+SoaIwD+a/vlrOmGRUyOYu7MwUhc7CxqeaDZU13S4+EpA==\n+  dependencies:\n+    \"@babel/code-frame\" \"7.12.11\"\n+    \"@eslint/eslintrc\" \"^0.4.3\"\n+    \"@humanwhocodes/config-array\" \"^0.5.0\"\n+    ajv \"^6.10.0\"\n+    chalk \"^4.0.0\"\n+    cross-spawn \"^7.0.2\"\n+    debug \"^4.0.1\"\n+    doctrine \"^3.0.0\"\n+    enquirer \"^2.3.5\"\n+    escape-string-regexp \"^4.0.0\"\n+    eslint-scope \"^5.1.1\"\n+    eslint-utils \"^2.1.0\"\n+    eslint-visitor-keys \"^2.0.0\"\n+    espree \"^7.3.1\"\n+    esquery \"^1.4.0\"\n+    esutils \"^2.0.2\"\n+    fast-deep-equal \"^3.1.3\"\n+    file-entry-cache \"^6.0.1\"\n+    functional-red-black-tree \"^1.0.1\"\n+    glob-parent \"^5.1.2\"\n+    globals \"^13.6.0\"\n+    ignore \"^4.0.6\"\n+    import-fresh \"^3.0.0\"\n+    imurmurhash \"^0.1.4\"\n+    is-glob \"^4.0.0\"\n+    js-yaml \"^3.13.1\"\n+    json-stable-stringify-without-jsonify \"^1.0.1\"\n+    levn \"^0.4.1\"\n+    lodash.merge \"^4.6.2\"\n+    minimatch \"^3.0.4\"\n+    natural-compare \"^1.4.0\"\n+    optionator \"^0.9.1\"\n+    progress \"^2.0.0\"\n+    regexpp \"^3.1.0\"\n+    semver \"^7.2.1\"\n+    strip-ansi \"^6.0.0\"\n+    strip-json-comments \"^3.1.0\"\n+    table \"^6.0.9\"\n+    text-table \"^0.2.0\"\n+    v8-compile-cache \"^2.0.3\"\n+\n espree@10.0.1, espree@^10.0.1:\n   version \"10.0.1\"\n   resolved \"https://registry.yarnpkg.com/espree/-/espree-10.0.1.tgz#600e60404157412751ba4a6f3a2ee1a42433139f\"\n@@ -8296,17 +8342,17 @@ flatted@^3.2.9:\n   resolved \"https://registry.yarnpkg.com/flatted/-/flatted-3.3.1.tgz#21db470729a6734d4997002f439cb308987f567a\"\n   integrity sha512-X8cqMLLie7KsNUDSdzeN8FYK9rEt4Dt67OsG/DNGnYTSDBG4uFAJFBnUeiV+zCVAvwFy56IjM9sH51jVaEhNxw==\n \n-flow-bin@^0.235.0:\n-  version \"0.235.1\"\n-  resolved \"https://registry.yarnpkg.com/flow-bin/-/flow-bin-0.235.1.tgz#7dfca9c480bb7cb83fa3caca58386e9beca09bc3\"\n-  integrity sha512-SuXw5NQDIdSBMg/NgvS5mzdI6dPEYWubnucnYno9wWLd6xoK1nkH6t2Dn2GsML9bIoVqp3E/ni1jo18A4G4FrQ==\n+flow-bin@^0.245.2:\n+  version \"0.245.2\"\n+  resolved \"https://registry.yarnpkg.com/flow-bin/-/flow-bin-0.245.2.tgz#ab5cd2115a8b57cc91c0d84add105c7098418f4c\"\n+  integrity sha512-1rFzkb7OoknVovimQvB+2Dq2vYP+guqSZAb4Cnnh0YsIdAOU7upCwnLHBOhMSXvEp6+J6tDMe9G8KwTAB8aI/g==\n \n-flow-remove-types@^2.235.0:\n-  version \"2.238.2\"\n-  resolved \"https://registry.yarnpkg.com/flow-remove-types/-/flow-remove-types-2.238.2.tgz#85c9d26e83ba395f0206a23bce438223bc035609\"\n-  integrity sha512-WJXRomjPiZ34nG14y7AceoPxg1L00FxjPSA3TDBTG2OPt8QFNtiYEmO4/3WG58n3C4wjxyVuoE6KjxQIvCDyjw==\n+flow-remove-types@^2.245.2:\n+  version \"2.245.2\"\n+  resolved \"https://registry.yarnpkg.com/flow-remove-types/-/flow-remove-types-2.245.2.tgz#ccc7b8db25609833f9bf549bd025e740f023464f\"\n+  integrity sha512-p4rWHk20Vp8/pu9MOVi26r+r8hYpZ1vk+9OsFcJnKc/oUYJBxmTL8/fBlIo4/LJ9aLOrAeHwO1PnSsU6Z7gVsw==\n   dependencies:\n-    hermes-parser \"0.22.0\"\n+    hermes-parser \"0.23.1\"\n     pirates \"^3.0.2\"\n     vlq \"^0.2.1\"\n \n@@ -9138,6 +9184,11 @@ hermes-estree@0.23.0:\n   resolved \"https://registry.yarnpkg.com/hermes-estree/-/hermes-estree-0.23.0.tgz#89c5419877b9d6bce4bb616821f496f5c5daddbc\"\n   integrity sha512-Rkp0PNLGpORw4ktsttkVbpYJbrYKS3hAnkxu8D9nvQi6LvSbuPa+tYw/t2u3Gjc35lYd/k95YkjqyTcN4zspag==\n \n+hermes-estree@0.23.1:\n+  version \"0.23.1\"\n+  resolved \"https://registry.yarnpkg.com/hermes-estree/-/hermes-estree-0.23.1.tgz#d0bac369a030188120ee7024926aabe5a9f84fdb\"\n+  integrity sha512-eT5MU3f5aVhTqsfIReZ6n41X5sYn4IdQL0nvz6yO+MMlPxw49aSARHLg/MSehQftyjnrE8X6bYregzSumqc6cg==\n+\n hermes-parser@0.22.0, hermes-parser@^0.22.0:\n   version \"0.22.0\"\n   resolved \"https://registry.yarnpkg.com/hermes-parser/-/hermes-parser-0.22.0.tgz#fc8e0e6c7bfa8db85b04c9f9544a102c4fcb4040\"\n@@ -9152,6 +9203,13 @@ hermes-parser@0.23.0:\n   dependencies:\n     hermes-estree \"0.23.0\"\n \n+hermes-parser@0.23.1:\n+  version \"0.23.1\"\n+  resolved \"https://registry.yarnpkg.com/hermes-parser/-/hermes-parser-0.23.1.tgz#e5de648e664f3b3d84d01b48fc7ab164f4b68205\"\n+  integrity sha512-oxl5h2DkFW83hT4DAUJorpah8ou4yvmweUzLJmmr6YV2cezduCdlil1AvU/a/xSsAFo4WUcNA4GoV5Bvq6JffA==\n+  dependencies:\n+    hermes-estree \"0.23.1\"\n+\n homedir-polyfill@^1.0.0, homedir-polyfill@^1.0.1:\n   version \"1.0.3\"\n   resolved \"https://registry.yarnpkg.com/homedir-polyfill/-/homedir-polyfill-1.0.3.tgz#743298cef4e5af3e194161fbadcc2151d3a058e8\"\n@@ -15083,7 +15141,7 @@ string-natural-compare@^3.0.1:\n   resolved \"https://registry.yarnpkg.com/string-natural-compare/-/string-natural-compare-3.0.1.tgz#7a42d58474454963759e8e8b7ae63d71c1e7fdf4\"\n   integrity sha512-n3sPwynL1nwKi3WJ6AIsClwBMa0zTi54fn2oLU6ndfTSIO05xaznjSf15PcBZU6FNWbmN5Q6cxT4V5hGvB4taw==\n \n-\"string-width-cjs@npm:string-width@^4.2.0\", string-width@^4.1.0, string-width@^4.2.0, string-width@^4.2.3:\n+\"string-width-cjs@npm:string-width@^4.2.0\":\n   version \"4.2.3\"\n   resolved \"https://registry.yarnpkg.com/string-width/-/string-width-4.2.3.tgz#269c7117d27b05ad2e536830a8ec895ef9c6d010\"\n   integrity sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==\n@@ -15118,6 +15176,15 @@ string-width@^4.0.0:\n     is-fullwidth-code-point \"^3.0.0\"\n     strip-ansi \"^6.0.0\"\n \n+string-width@^4.1.0, string-width@^4.2.0, string-width@^4.2.3:\n+  version \"4.2.3\"\n+  resolved \"https://registry.yarnpkg.com/string-width/-/string-width-4.2.3.tgz#269c7117d27b05ad2e536830a8ec895ef9c6d010\"\n+  integrity sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==\n+  dependencies:\n+    emoji-regex \"^8.0.0\"\n+    is-fullwidth-code-point \"^3.0.0\"\n+    strip-ansi \"^6.0.1\"\n+\n string-width@^5.0.1, string-width@^5.1.2:\n   version \"5.1.2\"\n   resolved \"https://registry.yarnpkg.com/string-width/-/string-width-5.1.2.tgz#14f8daec6d81e7221d2a357e668cab73bdbca794\"\n@@ -15178,7 +15245,7 @@ string_decoder@~1.1.1:\n   dependencies:\n     safe-buffer \"~5.1.0\"\n \n-\"strip-ansi-cjs@npm:strip-ansi@^6.0.1\", strip-ansi@^6.0.0, strip-ansi@^6.0.1:\n+\"strip-ansi-cjs@npm:strip-ansi@^6.0.1\":\n   version \"6.0.1\"\n   resolved \"https://registry.yarnpkg.com/strip-ansi/-/strip-ansi-6.0.1.tgz#9e26c63d30f53443e9489495b2105d37b67a85d9\"\n   integrity sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==\n@@ -15206,6 +15273,13 @@ strip-ansi@^5.1.0:\n   dependencies:\n     ansi-regex \"^4.1.0\"\n \n+strip-ansi@^6.0.0, strip-ansi@^6.0.1:\n+  version \"6.0.1\"\n+  resolved \"https://registry.yarnpkg.com/strip-ansi/-/strip-ansi-6.0.1.tgz#9e26c63d30f53443e9489495b2105d37b67a85d9\"\n+  integrity sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==\n+  dependencies:\n+    ansi-regex \"^5.0.1\"\n+\n strip-ansi@^7.0.1:\n   version \"7.1.0\"\n   resolved \"https://registry.yarnpkg.com/strip-ansi/-/strip-ansi-7.1.0.tgz#d5b6568ca689d8561370b0707685d22434faff45\"\n@@ -16673,7 +16747,7 @@ workerize-loader@^2.0.2:\n   dependencies:\n     loader-utils \"^2.0.0\"\n \n-\"wrap-ansi-cjs@npm:wrap-ansi@^7.0.0\", wrap-ansi@^7.0.0:\n+\"wrap-ansi-cjs@npm:wrap-ansi@^7.0.0\":\n   version \"7.0.0\"\n   resolved \"https://registry.yarnpkg.com/wrap-ansi/-/wrap-ansi-7.0.0.tgz#67e145cff510a6a6984bdf1152911d69d2eb9e43\"\n   integrity sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==\n@@ -16691,6 +16765,15 @@ wrap-ansi@^6.2.0:\n     string-width \"^4.1.0\"\n     strip-ansi \"^6.0.0\"\n \n+wrap-ansi@^7.0.0:\n+  version \"7.0.0\"\n+  resolved \"https://registry.yarnpkg.com/wrap-ansi/-/wrap-ansi-7.0.0.tgz#67e145cff510a6a6984bdf1152911d69d2eb9e43\"\n+  integrity sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==\n+  dependencies:\n+    ansi-styles \"^4.0.0\"\n+    string-width \"^4.1.0\"\n+    strip-ansi \"^6.0.0\"\n+\n wrap-ansi@^8.1.0:\n   version \"8.1.0\"\n   resolved \"https://registry.yarnpkg.com/wrap-ansi/-/wrap-ansi-8.1.0.tgz#56dc22368ee570face1b49819975d9b9a5ead214\""
            }
        ]
    },
    {
        "prompt": "issue: Create Prince | description: ### \r\nA google app\r\n\r\n<!--\r\n  Thanks for submitting a pull request!\r\n  We appreciate you spending the time to work on these changes. Please provide enough information so that others can review your pull request. The three fields below are mandatory.\r\n\r\n  Before submitting a pull request, please make sure the following is done:\r\n\r\n  1. Fork [the repository](https://github.com/facebook/react) and create your branch from `main`.\r\n  2. Run `yarn` in the repository root.\r\n  3. If you've fixed a bug or added code that should be tested, add tests!\r\n  4. Ensure the test suite passes (`yarn test`). Tip: `yarn test --watch TestName` is helpful in development.\r\n  5. Run `yarn test --prod` to test in the production environment. It supports the same options as `yarn test`.\r\n  6. If you need a debugger, run `yarn test --debug --watch TestName`, open `chrome://inspect`, and press \"Inspect\".\r\n  7. Format your code with [prettier](https://github.com/prettier/prettier) (`yarn prettier`).\r\n  8. Make sure your code lints (`yarn lint`). Tip: `yarn linc` to only check changed files.\r\n  9. Run the [Flow](https://flowtype.org/) type checks (`yarn flow`).\r\n  10. If you haven't already, complete the CLA.\r\n\r\n  Learn more about contributing: https://reactjs.org/docs/how-to-contribute.html\r\n-->\r\n\r\n## Summary\r\n\r\n<!--\r\n Explain the **motivation** for making this change. What existing problem does the pull request solve?\r\n-->\r\n\r\n## How did you test this change?\r\n\r\n<!--\r\n  Demonstrate the code is solid. Example: The exact commands you ran and their output, screenshots / videos if the pull request changes the user interface.\r\n  How exactly did you verify that your PR solves the issue you wanted to solve?\r\n  If you leave this empty, your PR will very likely be closed.\r\n-->\r\n",
        "completion": [
            {
                "file": "Prince",
                "git_diff": "@@ -0,0 +1 @@\n+google"
            }
        ]
    },
    {
        "prompt": "issue: spike: some experiments on use(obserable) - very rough | description: This is the *actual* code I've been writing around `use(observable)` - it's much messier than https://github.com/facebook/react/pull/30908, which serves as a high level demo of what I think we need to do, or at least where I think we would start. \r\n\r\n\r\nTo see progress, run:\r\n\r\n```sh\r\nyarn test packages/react-reconciler/src/__tests__/ReactUseObservable-test.js\r\n```",
        "completion": [
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactUseObservable-test.js",
                "git_diff": "@@ -0,0 +1,118 @@\n+const StateManager = {\n+    nodes: [],\n+    possibleListener: null,\n+};\n+\n+function ConvertObjectToState(target) {\n+    const listeners = {};\n+\n+    const handler = {\n+        get(target, prop, receiver) {\n+            if (StateManager.possibleListener) {\n+                if (!listeners[prop]) {\n+                    listeners[prop] = new Set();\n+                }\n+                listeners[prop].add(StateManager.possibleListener);\n+            }\n+\n+            return Reflect.get(...arguments);\n+        },\n+        set(target, prop, value) {\n+            const result = Reflect.set(...arguments);\n+            console.log('are we here?')\n+            if (listeners[prop]) {\n+                console.log('we have al istener for this prop', prop)\n+                listeners[prop].forEach((callback) => {\n+                    callback();\n+                });\n+            }\n+\n+            return result;\n+        },\n+    };\n+\n+    const proxy = new Proxy(target, handler);\n+    proxy.$$typeof = 'REACT_OBSERVABLE_TYPE';\n+    proxy.$$registerObserver = (callback) => {\n+        StateManager.possibleListener = callback;\n+    };\n+    StateManager.nodes.push(proxy);\n+    return proxy;\n+}\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ *\n+ * @emails react-core\n+ */\n+\n+'use strict';\n+\n+let React;\n+let ReactNoop;\n+let Scheduler;\n+let act;\n+let use;\n+let pendingTextRequests;\n+let waitFor;\n+let waitForPaint;\n+let assertLog;\n+let waitForAll;\n+let waitForMicrotasks;\n+\n+describe('ReactUse', () => {\n+    beforeEach(() => {\n+        jest.resetModules();\n+\n+        React = require('react');\n+        ReactNoop = require('react-noop-renderer');\n+        Scheduler = require('scheduler');\n+        act = require('internal-test-utils').act;\n+        use = React.use;\n+        useDebugValue = React.useDebugValue;\n+        useState = React.useState;\n+        useTransition = React.useTransition;\n+        useMemo = React.useMemo;\n+        useEffect = React.useEffect;\n+        Suspense = React.Suspense;\n+        startTransition = React.startTransition;\n+\n+        const InternalTestUtils = require('internal-test-utils');\n+        waitForAll = InternalTestUtils.waitForAll;\n+        assertLog = InternalTestUtils.assertLog;\n+        waitForPaint = InternalTestUtils.waitForPaint;\n+        waitFor = InternalTestUtils.waitFor;\n+        waitForMicrotasks = InternalTestUtils.waitForMicrotasks;\n+\n+        pendingTextRequests = new Map();\n+    });\n+\n+    it('basic use(observable)', async () => {\n+        const observable = ConvertObjectToState({\n+            \"name\": \"John\"\n+        })\n+\n+        function Sync() {\n+            const { name } = use(observable)\n+            return name;\n+        }\n+\n+        function App() {\n+            return (\n+                <Sync />\n+            );\n+        }\n+\n+        const root = ReactNoop.createRoot();\n+        root.render(<App />);\n+        await waitForAll([]);\n+        expect(root).toMatchRenderedOutput('John');\n+        await act(() => {\n+            observable.name = \"Jane\";\n+        });\n+        await waitForAll([]);\n+        expect(root).toMatchRenderedOutput('Jane');\n+    });\n+});"
            }
        ]
    },
    {
        "prompt": "issue: [compiler][playground] Fix displayed naming of outlined functions | description: At present the playground's output JS tab incorrectly displays the name of all outlined functions as the name of the function from which they were outlined -- see the name of the outlined function in [this](https://playground.react.dev/#N4Igzg9grgTgxgUxALhAMygOzgFwJYSYAEAwhALYAOhCmOAFAJRHAA6xRchYOR0OAGzyYEAEyIBeIk0kA+FkQC+7IkRgIcsYvyEjRAbnaKQioA) example. This PR fixes.\r\n\r\nStack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\r\n* __->__ #30907\r\n\r\n",
        "completion": [
            {
                "file": "compiler/apps/playground/components/Editor/EditorImpl.tsx",
                "git_diff": "@@ -235,7 +235,7 @@ function compile(source: string): [CompilerOutput, 'flow' | 'typescript'] {\n               name: result.name,\n               value: {\n                 type: 'FunctionDeclaration',\n-                id,\n+                id: withIdentifier(result.value.id),\n                 async: result.value.async,\n                 generator: result.value.generator,\n                 body: result.value.body,"
            }
        ]
    },
    {
        "prompt": "issue: spike: an incomplete idea of what might work for observers in use | description: This is an example PR that outlines my current best understanding of how to implement `use(observable)` in the React codebase.",
        "completion": [
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -1191,13 +1191,35 @@ function use<T>(usable: Usable<T>): T {\n     } else if (usable.$$typeof === REACT_CONTEXT_TYPE) {\n       const context: ReactContext<T> = (usable: any);\n       return readContext(context);\n+    } else if (usable.$$typeof === 'REACT_OBSERVABLE_TYPE') { // TODO: set up the symbol value for REACT_OBSERVABLE_TYPE, or use some other property as preferred.\n+      return readObservable(usable);\n     }\n   }\n \n   // eslint-disable-next-line react-internal/safe-string-coercion\n   throw new Error('An unsupported type was passed to use(): ' + String(usable));\n }\n \n+/**\n+ * In readObservable, we hook into some observable interface. Maybe it's a method called\n+ * `registerObserver` that accepts some callback. React can take control of that method and\n+ * delegate its call to some kind of safe process where side-effects can be run \n+ * @param {*} observable \n+ * @returns \n+ */\n+function readObservable(observable: any) {\n+  // This is the observable method we might delegae elsewhere\n+  const delegatedSideEffect = observable.registerObserver\n+\n+  // Then we could send that method to the commit phase (or other appropriate place)\n+  // Method does not exist.\n+  addSideEffectToCorrectQueue(delegatedSideEffect);\n+\n+  // Return the observable value, with the knowledge that React will set up the correct\n+  // callbacks that trigger re-renders or schedule work when observable values changed.\n+  return observable;\n+}\n+\n function useMemoCache(size: number): Array<any> {\n   let memoCache = null;\n   // Fast-path, load memo cache from wip fiber if already prepared"
            }
        ]
    },
    {
        "prompt": "issue: [compiler] Allow ref access in useImperativeHandle | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* __->__ #30904\n* #30902\n\n",
        "completion": [
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/Globals.ts",
                "git_diff": "@@ -362,6 +362,17 @@ const REACT_APIS: Array<[string, BuiltInType]> = [\n       returnValueKind: ValueKind.Mutable,\n     }),\n   ],\n+  [\n+    'useImperativeHandle',\n+    addHook(DEFAULT_SHAPES, {\n+      positionalParams: [],\n+      restParam: Effect.Freeze,\n+      returnType: {kind: 'Primitive'},\n+      calleeEffect: Effect.Read,\n+      hookKind: 'useEffect',\n+      returnValueKind: ValueKind.Frozen,\n+    }),\n+  ],\n   [\n     'useMemo',\n     addHook(DEFAULT_SHAPES, {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/ObjectShape.ts",
                "git_diff": "@@ -127,6 +127,7 @@ export type HookKind =\n   | 'useMemo'\n   | 'useCallback'\n   | 'useTransition'\n+  | 'useImperativeHandle'\n   | 'Custom';\n \n /*"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateNoRefAccesInRender.ts",
                "git_diff": "@@ -282,7 +282,12 @@ function validateNoRefAccessInRenderImpl(\n             break;\n           }\n           case 'MethodCall': {\n-            if (!isEffectHook(instr.value.property.identifier)) {\n+            if (\n+              !isHookThatAllowsRefValueAccess(\n+                fn,\n+                instr.value.property.identifier,\n+              )\n+            ) {\n               for (const operand of eachInstructionValueOperand(instr.value)) {\n                 const hookKind = getHookKindForType(\n                   fn.env,\n@@ -307,7 +312,10 @@ function validateNoRefAccessInRenderImpl(\n           case 'CallExpression': {\n             const callee = instr.value.callee;\n             const hookKind = getHookKindForType(fn.env, callee.identifier.type);\n-            const isUseEffect = isEffectHook(callee.identifier);\n+            const isUseEffect = isHookThatAllowsRefValueAccess(\n+              fn,\n+              callee.identifier,\n+            );\n             let returnType: RefAccessType = {kind: 'None'};\n             if (!isUseEffect) {\n               // Report a more precise error when calling a local function that accesses a ref\n@@ -499,3 +507,11 @@ function validateNoDirectRefValueAccess(\n     });\n   }\n }\n+\n+function isHookThatAllowsRefValueAccess(\n+  fn: HIRFunction,\n+  identifier: Identifier,\n+): boolean {\n+  const hookKind = getHookKindForType(fn.env, identifier.type);\n+  return isEffectHook(identifier) || hookKind === 'useImperativeHandle';\n+}"
            }
        ]
    },
    {
        "prompt": "issue: [compiler][WIP] Factor out function effects from reference effects | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* __->__ #30911\n\n",
        "completion": [
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/error.invalid-function-expression-mutates-immutable-value.js",
                "git_diff": "@@ -5,5 +5,5 @@ function Component(props) {\n     x.value = e.target.value;\n     setX(x);\n   };\n-  return <input value={x.value} onChange={onChange} />;\n+  return <input onChange={onChange} />;\n }"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Inference/InferFunctionEffects.ts",
                "git_diff": "@@ -0,0 +1,336 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {CompilerError, ErrorSeverity, ValueKind} from '..';\n+import {\n+  AbstractValue,\n+  BasicBlock,\n+  Effect,\n+  Environment,\n+  FunctionEffect,\n+  HIRFunction,\n+  Instruction,\n+  InstructionValue,\n+  Place,\n+  ValueReason,\n+  getHookKind,\n+  isRefOrRefValue,\n+} from '../HIR';\n+import {eachInstructionOperand, eachTerminalOperand} from '../HIR/visitors';\n+import {assertExhaustive} from '../Utils/utils';\n+\n+interface State {\n+  kind(place: Place): AbstractValue;\n+  values(place: Place): Array<InstructionValue>;\n+  isDefined(place: Place): boolean;\n+}\n+\n+function inferOperandEffect(state: State, place: Place): null | FunctionEffect {\n+  const value = state.kind(place);\n+  CompilerError.invariant(value != null, {\n+    reason: 'Expected operand to have a kind',\n+    loc: null,\n+  });\n+\n+  switch (place.effect) {\n+    case Effect.Store:\n+    case Effect.Mutate: {\n+      if (isRefOrRefValue(place.identifier)) {\n+        break;\n+      } else if (value.kind === ValueKind.Context) {\n+        return {\n+          kind: 'ContextMutation',\n+          loc: place.loc,\n+          effect: place.effect,\n+          places: value.context.size === 0 ? new Set([place]) : value.context,\n+        };\n+      } else if (\n+        value.kind !== ValueKind.Mutable &&\n+        // We ignore mutations of primitives since this is not a React-specific problem\n+        value.kind !== ValueKind.Primitive\n+      ) {\n+        let reason = getWriteErrorReason(value);\n+        return {\n+          kind:\n+            value.reason.size === 1 && value.reason.has(ValueReason.Global)\n+              ? 'GlobalMutation'\n+              : 'ReactMutation',\n+          error: {\n+            reason,\n+            description:\n+              place.identifier.name !== null &&\n+              place.identifier.name.kind === 'named'\n+                ? `Found mutation of \\`${place.identifier.name.value}\\``\n+                : null,\n+            loc: place.loc,\n+            suggestions: null,\n+            severity: ErrorSeverity.InvalidReact,\n+          },\n+        };\n+      }\n+      break;\n+    }\n+  }\n+  return null;\n+}\n+\n+function inheritFunctionEffects(\n+  state: State,\n+  place: Place,\n+): Array<FunctionEffect> {\n+  const effects = inferFunctionInstrEffects(state, place);\n+\n+  return effects\n+    .flatMap(effect => {\n+      if (effect.kind === 'GlobalMutation' || effect.kind === 'ReactMutation') {\n+        return [effect];\n+      } else {\n+        const effects: Array<FunctionEffect | null> = [];\n+        CompilerError.invariant(effect.kind === 'ContextMutation', {\n+          reason: 'Expected ContextMutation',\n+          loc: null,\n+        });\n+        /**\n+         * Contextual effects need to be replayed against the current inference\n+         * state, which may know more about the value to which the effect applied.\n+         * The main cases are:\n+         * 1. The mutated context value is _still_ a context value in the current scope,\n+         *    so we have to continue propagating the original context mutation.\n+         * 2. The mutated context value is a mutable value in the current scope,\n+         *    so the context mutation was fine and we can skip propagating the effect.\n+         * 3. The mutated context value  is an immutable value in the current scope,\n+         *    resulting in a non-ContextMutation FunctionEffect. We propagate that new,\n+         *    more detailed effect to the current function context.\n+         */\n+        for (const place of effect.places) {\n+          if (state.isDefined(place)) {\n+            const replayedEffect = inferOperandEffect(state, {\n+              ...place,\n+              loc: effect.loc,\n+              effect: effect.effect,\n+            });\n+            if (replayedEffect != null) {\n+              if (replayedEffect.kind === 'ContextMutation') {\n+                // Case 1, still a context value so propagate the original effect\n+                effects.push(effect);\n+              } else {\n+                // Case 3, immutable value so propagate the more precise effect\n+                effects.push(replayedEffect);\n+              }\n+            } // else case 2, local mutable value so this effect was fine\n+          }\n+        }\n+        return effects;\n+      }\n+    })\n+    .filter((effect): effect is FunctionEffect => effect != null);\n+}\n+\n+function inferFunctionInstrEffects(\n+  state: State,\n+  place: Place,\n+): Array<FunctionEffect> {\n+  const effects: Array<FunctionEffect> = [];\n+  const instrs = state.values(place);\n+  CompilerError.invariant(instrs != null, {\n+    reason: 'Expected operand to have instructions',\n+    loc: null,\n+  });\n+\n+  for (const instr of instrs) {\n+    if (\n+      (instr.kind === 'FunctionExpression' || instr.kind === 'ObjectMethod') &&\n+      instr.loweredFunc.func.effects != null\n+    ) {\n+      effects.push(...instr.loweredFunc.func.effects);\n+    }\n+  }\n+\n+  return effects;\n+}\n+\n+function operandEffects(\n+  state: State,\n+  place: Place,\n+  filterRenderSafe: boolean,\n+): Array<FunctionEffect> {\n+  const functionEffects: Array<FunctionEffect> = [];\n+  const effect = inferOperandEffect(state, place);\n+  effect && functionEffects.push(effect);\n+  functionEffects.push(...inheritFunctionEffects(state, place));\n+  if (filterRenderSafe) {\n+    return functionEffects.filter(effect => !isEffectSafeOutsideRender(effect));\n+  } else {\n+    return functionEffects;\n+  }\n+}\n+\n+export function inferInstructionFunctionEffects(\n+  env: Environment,\n+  state: State,\n+  instr: Instruction,\n+): Array<FunctionEffect> {\n+  const functionEffects: Array<FunctionEffect> = [];\n+  switch (instr.value.kind) {\n+    case 'JsxExpression': {\n+      if (instr.value.tag.kind === 'Identifier') {\n+        functionEffects.push(...operandEffects(state, instr.value.tag, false));\n+      }\n+      instr.value.children?.forEach(child =>\n+        functionEffects.push(...operandEffects(state, child, false)),\n+      );\n+      for (const attr of instr.value.props) {\n+        if (attr.kind === 'JsxSpreadAttribute') {\n+          functionEffects.push(...operandEffects(state, attr.argument, false));\n+        } else {\n+          functionEffects.push(...operandEffects(state, attr.place, true));\n+        }\n+      }\n+      break;\n+    }\n+    case 'ObjectMethod':\n+    case 'FunctionExpression': {\n+      /**\n+       * If this function references other functions, propagate the referenced function's\n+       * effects to this function.\n+       *\n+       * ```\n+       * let f = () => global = true;\n+       * let g = () => f();\n+       * g();\n+       * ```\n+       *\n+       * In this example, because `g` references `f`, we propagate the GlobalMutation from\n+       * `f` to `g`. Thus, referencing `g` in `g()` will evaluate the GlobalMutation in the outer\n+       * function effect context and report an error. But if instead we do:\n+       *\n+       * ```\n+       * let f = () => global = true;\n+       * let g = () => f();\n+       * useEffect(() => g(), [g])\n+       * ```\n+       *\n+       * Now `g`'s effects will be discarded since they're in a useEffect.\n+       */\n+      for (const operand of eachInstructionOperand(instr)) {\n+        instr.value.loweredFunc.func.effects ??= [];\n+        instr.value.loweredFunc.func.effects.push(\n+          ...inferFunctionInstrEffects(state, operand),\n+        );\n+      }\n+      break;\n+    }\n+    case 'MethodCall':\n+    case 'CallExpression': {\n+      let callee;\n+      if (instr.value.kind === 'MethodCall') {\n+        callee = instr.value.property;\n+        functionEffects.push(\n+          ...operandEffects(state, instr.value.receiver, false),\n+        );\n+      } else {\n+        callee = instr.value.callee;\n+      }\n+      functionEffects.push(...operandEffects(state, callee, false));\n+      let isHook = getHookKind(env, callee.identifier) != null;\n+      for (const arg of instr.value.args) {\n+        const place = arg.kind === 'Identifier' ? arg : arg.place;\n+        /*\n+         * Join the effects of the argument with the effects of the enclosing function,\n+         * unless the we're detecting a global mutation inside a useEffect hook\n+         */\n+        functionEffects.push(...operandEffects(state, place, isHook));\n+      }\n+      break;\n+    }\n+    case 'StartMemoize':\n+    case 'FinishMemoize':\n+    case 'LoadLocal':\n+    case 'StoreLocal': {\n+      break;\n+    }\n+    case 'StoreGlobal': {\n+      functionEffects.push({\n+        kind: 'GlobalMutation',\n+        error: {\n+          reason:\n+            'Unexpected reassignment of a variable which was defined outside of the component. Components and hooks should be pure and side-effect free, but variable reassignment is a form of side-effect. If this variable is used in rendering, use useState instead. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#side-effects-must-run-outside-of-render)',\n+          loc: instr.loc,\n+          suggestions: null,\n+          severity: ErrorSeverity.InvalidReact,\n+        },\n+      });\n+      break;\n+    }\n+    default: {\n+      for (const operand of eachInstructionOperand(instr)) {\n+        functionEffects.push(...operandEffects(state, operand, false));\n+      }\n+    }\n+  }\n+  return functionEffects;\n+}\n+\n+export function inferTerminalFunctionEffects(\n+  state: State,\n+  block: BasicBlock,\n+): Array<FunctionEffect> {\n+  const functionEffects: Array<FunctionEffect> = [];\n+  for (const operand of eachTerminalOperand(block.terminal)) {\n+    functionEffects.push(...operandEffects(state, operand, true));\n+  }\n+  return functionEffects;\n+}\n+\n+export function raiseFunctionEffectErrors(\n+  functionEffects: Array<FunctionEffect>,\n+): void {\n+  functionEffects.forEach(eff => {\n+    switch (eff.kind) {\n+      case 'ReactMutation':\n+      case 'GlobalMutation': {\n+        CompilerError.throw(eff.error);\n+      }\n+      case 'ContextMutation': {\n+        CompilerError.throw({\n+          severity: ErrorSeverity.Invariant,\n+          reason: `Unexpected ContextMutation in top-level function effects`,\n+          loc: eff.loc,\n+        });\n+      }\n+      default:\n+        assertExhaustive(\n+          eff,\n+          `Unexpected function effect kind \\`${(eff as any).kind}\\``,\n+        );\n+    }\n+  });\n+}\n+\n+function isEffectSafeOutsideRender(effect: FunctionEffect): boolean {\n+  return effect.kind === 'GlobalMutation';\n+}\n+\n+function getWriteErrorReason(abstractValue: AbstractValue): string {\n+  if (abstractValue.reason.has(ValueReason.Global)) {\n+    return 'Writing to a variable defined outside a component or hook is not allowed. Consider using an effect';\n+  } else if (abstractValue.reason.has(ValueReason.JsxCaptured)) {\n+    return 'Updating a value used previously in JSX is not allowed. Consider moving the mutation before the JSX';\n+  } else if (abstractValue.reason.has(ValueReason.Context)) {\n+    return `Mutating a value returned from 'useContext()', which should not be mutated`;\n+  } else if (abstractValue.reason.has(ValueReason.KnownReturnSignature)) {\n+    return 'Mutating a value returned from a function whose return value should not be mutated';\n+  } else if (abstractValue.reason.has(ValueReason.ReactiveFunctionArgument)) {\n+    return 'Mutating component props or hook arguments is not allowed. Consider using a local variable instead';\n+  } else if (abstractValue.reason.has(ValueReason.State)) {\n+    return \"Mutating a value returned from 'useState()', which should not be mutated. Use the setter function to update instead\";\n+  } else if (abstractValue.reason.has(ValueReason.ReducerState)) {\n+    return \"Mutating a value returned from 'useReducer()', which should not be mutated. Use the dispatch function to update instead\";\n+  } else {\n+    return 'This mutates a variable that React considers immutable';\n+  }\n+}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Inference/InferReferenceEffects.ts",
                "git_diff": "@@ -5,7 +5,7 @@\n  * LICENSE file in the root directory of this source tree.\n  */\n \n-import {CompilerError, ErrorSeverity} from '../CompilerError';\n+import {CompilerError} from '../CompilerError';\n import {Environment} from '../HIR';\n import {\n   AbstractValue,\n@@ -26,11 +26,9 @@ import {\n   Type,\n   ValueKind,\n   ValueReason,\n-  getHookKind,\n   isArrayType,\n   isMutableEffect,\n   isObjectType,\n-  isRefOrRefValue,\n } from '../HIR/HIR';\n import {FunctionSignature} from '../HIR/ObjectShape';\n import {\n@@ -48,6 +46,11 @@ import {\n   eachTerminalSuccessor,\n } from '../HIR/visitors';\n import {assertExhaustive} from '../Utils/utils';\n+import {\n+  inferTerminalFunctionEffects,\n+  inferInstructionFunctionEffects,\n+  raiseFunctionEffectErrors,\n+} from './InferFunctionEffects';\n \n const UndefinedValue: InstructionValue = {\n   kind: 'Primitive',\n@@ -228,45 +231,26 @@ export default function inferReferenceEffects(\n \n       statesByBlock.set(blockId, incomingState);\n       const state = incomingState.clone();\n-      inferBlock(fn.env, functionEffects, state, block);\n+      inferBlock(fn.env, state, block, functionEffects);\n \n       for (const nextBlockId of eachTerminalSuccessor(block.terminal)) {\n         queue(nextBlockId, state);\n       }\n     }\n   }\n \n-  if (!options.isFunctionExpression) {\n-    functionEffects.forEach(eff => {\n-      switch (eff.kind) {\n-        case 'ReactMutation':\n-        case 'GlobalMutation': {\n-          CompilerError.throw(eff.error);\n-        }\n-        case 'ContextMutation': {\n-          CompilerError.throw({\n-            severity: ErrorSeverity.Invariant,\n-            reason: `Unexpected ContextMutation in top-level function effects`,\n-            loc: eff.loc,\n-          });\n-        }\n-        default:\n-          assertExhaustive(\n-            eff,\n-            `Unexpected function effect kind \\`${(eff as any).kind}\\``,\n-          );\n-      }\n-    });\n-  } else {\n+  if (options.isFunctionExpression) {\n     fn.effects = functionEffects;\n+  } else {\n+    raiseFunctionEffectErrors(functionEffects);\n   }\n }\n \n // Maintains a mapping of top-level variables to the kind of value they hold\n class InferenceState {\n   #env: Environment;\n \n-  // The kind of reach value, based on its allocation site\n+  // The kind of each value, based on its allocation site\n   #values: Map<InstructionValue, AbstractValue>;\n   /*\n    * The set of values pointed to by each identifier. This is a set\n@@ -381,7 +365,6 @@ class InferenceState {\n     place: Place,\n     effectKind: Effect,\n     reason: ValueReason,\n-    functionEffects: Array<FunctionEffect>,\n   ): void {\n     const values = this.#variables.get(place.identifier.id);\n     if (values === undefined) {\n@@ -398,68 +381,18 @@ class InferenceState {\n       return;\n     }\n \n-    // Propagate effects of function expressions to the outer (ie current) effect context\n-    for (const value of values) {\n-      if (\n-        (value.kind === 'FunctionExpression' ||\n-          value.kind === 'ObjectMethod') &&\n-        value.loweredFunc.func.effects != null\n-      ) {\n-        for (const effect of value.loweredFunc.func.effects) {\n-          if (\n-            effect.kind === 'GlobalMutation' ||\n-            effect.kind === 'ReactMutation'\n-          ) {\n-            // Known effects are always propagated upwards\n-            functionEffects.push(effect);\n-          } else {\n-            /**\n-             * Contextual effects need to be replayed against the current inference\n-             * state, which may know more about the value to which the effect applied.\n-             * The main cases are:\n-             * 1. The mutated context value is _still_ a context value in the current scope,\n-             *    so we have to continue propagating the original context mutation.\n-             * 2. The mutated context value is a mutable value in the current scope,\n-             *    so the context mutation was fine and we can skip propagating the effect.\n-             * 3. The mutated context value  is an immutable value in the current scope,\n-             *    resulting in a non-ContextMutation FunctionEffect. We propagate that new,\n-             *    more detailed effect to the current function context.\n-             */\n-            for (const place of effect.places) {\n-              if (this.isDefined(place)) {\n-                const replayedEffect = this.reference(\n-                  {...place, loc: effect.loc},\n-                  effect.effect,\n-                  reason,\n-                );\n-                if (replayedEffect != null) {\n-                  if (replayedEffect.kind === 'ContextMutation') {\n-                    // Case 1, still a context value so propagate the original effect\n-                    functionEffects.push(effect);\n-                  } else {\n-                    // Case 3, immutable value so propagate the more precise effect\n-                    functionEffects.push(replayedEffect);\n-                  }\n-                } // else case 2, local mutable value so this effect was fine\n-              }\n-            }\n-          }\n-        }\n-      }\n-    }\n-    const functionEffect = this.reference(place, effectKind, reason);\n-    if (functionEffect !== null) {\n-      functionEffects.push(functionEffect);\n-    }\n+    this.reference(place, effectKind, reason);\n   }\n \n   freezeValues(values: Set<InstructionValue>, reason: Set<ValueReason>): void {\n     for (const value of values) {\n-      this.#values.set(value, {\n-        kind: ValueKind.Frozen,\n-        reason,\n-        context: new Set(),\n-      });\n+      if (this.#values.get(value)?.kind !== ValueKind.Context) {\n+        this.#values.set(value, {\n+          kind: ValueKind.Frozen,\n+          reason,\n+          context: new Set(),\n+        });\n+      }\n       if (value.kind === 'FunctionExpression') {\n         if (\n           this.#env.config.enablePreserveExistingMemoizationGuarantees ||\n@@ -484,11 +417,7 @@ class InferenceState {\n     }\n   }\n \n-  reference(\n-    place: Place,\n-    effectKind: Effect,\n-    reason: ValueReason,\n-  ): FunctionEffect | null {\n+  reference(place: Place, effectKind: Effect, reason: ValueReason): void {\n     const values = this.#variables.get(place.identifier.id);\n     CompilerError.invariant(values !== undefined, {\n       reason: '[InferReferenceEffects] Expected value to be initialized',\n@@ -498,7 +427,7 @@ class InferenceState {\n     });\n     let valueKind: AbstractValue | null = this.kind(place);\n     let effect: Effect | null = null;\n-    let functionEffect: FunctionEffect | null = null;\n+    let freeze: null | [Set<InstructionValue>, Set<ValueReason>] = null;\n     switch (effectKind) {\n       case Effect.Freeze: {\n         if (\n@@ -531,85 +460,10 @@ class InferenceState {\n         break;\n       }\n       case Effect.Mutate: {\n-        if (isRefOrRefValue(place.identifier)) {\n-          // no-op: refs are validate via ValidateNoRefAccessInRender\n-        } else if (valueKind.kind === ValueKind.Context) {\n-          functionEffect = {\n-            kind: 'ContextMutation',\n-            loc: place.loc,\n-            effect: effectKind,\n-            places:\n-              valueKind.context.size === 0\n-                ? new Set([place])\n-                : valueKind.context,\n-          };\n-        } else if (\n-          valueKind.kind !== ValueKind.Mutable &&\n-          // We ignore mutations of primitives since this is not a React-specific problem\n-          valueKind.kind !== ValueKind.Primitive\n-        ) {\n-          let reason = getWriteErrorReason(valueKind);\n-          functionEffect = {\n-            kind:\n-              valueKind.reason.size === 1 &&\n-              valueKind.reason.has(ValueReason.Global)\n-                ? 'GlobalMutation'\n-                : 'ReactMutation',\n-            error: {\n-              reason,\n-              description:\n-                place.identifier.name !== null &&\n-                place.identifier.name.kind === 'named'\n-                  ? `Found mutation of \\`${place.identifier.name.value}\\``\n-                  : null,\n-              loc: place.loc,\n-              suggestions: null,\n-              severity: ErrorSeverity.InvalidReact,\n-            },\n-          };\n-        }\n         effect = Effect.Mutate;\n         break;\n       }\n       case Effect.Store: {\n-        if (isRefOrRefValue(place.identifier)) {\n-          // no-op: refs are validate via ValidateNoRefAccessInRender\n-        } else if (valueKind.kind === ValueKind.Context) {\n-          functionEffect = {\n-            kind: 'ContextMutation',\n-            loc: place.loc,\n-            effect: effectKind,\n-            places:\n-              valueKind.context.size === 0\n-                ? new Set([place])\n-                : valueKind.context,\n-          };\n-        } else if (\n-          valueKind.kind !== ValueKind.Mutable &&\n-          // We ignore mutations of primitives since this is not a React-specific problem\n-          valueKind.kind !== ValueKind.Primitive\n-        ) {\n-          let reason = getWriteErrorReason(valueKind);\n-          functionEffect = {\n-            kind:\n-              valueKind.reason.size === 1 &&\n-              valueKind.reason.has(ValueReason.Global)\n-                ? 'GlobalMutation'\n-                : 'ReactMutation',\n-            error: {\n-              reason,\n-              description:\n-                place.identifier.name !== null &&\n-                place.identifier.name.kind === 'named'\n-                  ? `Found mutation of \\`${place.identifier.name.value}\\``\n-                  : null,\n-              loc: place.loc,\n-              suggestions: null,\n-              severity: ErrorSeverity.InvalidReact,\n-            },\n-          };\n-        }\n-\n         /*\n          * TODO(gsn): This should be bailout once we add bailout infra.\n          *\n@@ -661,7 +515,6 @@ class InferenceState {\n       suggestions: null,\n     });\n     place.effect = effect;\n-    return functionEffect;\n   }\n \n   /*\n@@ -958,9 +811,9 @@ function mergeAbstractValues(\n  */\n function inferBlock(\n   env: Environment,\n-  functionEffects: Array<FunctionEffect>,\n   state: InferenceState,\n   block: BasicBlock,\n+  functionEffects: Array<FunctionEffect>,\n ): void {\n   for (const phi of block.phis) {\n     state.inferPhi(phi);\n@@ -1023,21 +876,22 @@ function inferBlock(\n           instrValue.callee,\n           Effect.Read,\n           ValueReason.Other,\n-          functionEffects,\n         );\n \n         for (const operand of eachCallArgument(instrValue.args)) {\n           state.referenceAndRecordEffects(\n             operand,\n             Effect.ConditionallyMutate,\n             ValueReason.Other,\n-            functionEffects,\n           );\n         }\n \n         state.initialize(instrValue, valueKind);\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = lvalueEffect;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'ObjectExpression': {\n@@ -1062,15 +916,13 @@ function inferBlock(\n                   property.key.name,\n                   Effect.Freeze,\n                   ValueReason.Other,\n-                  functionEffects,\n                 );\n               }\n               // Object construction captures but does not modify the key/property values\n               state.referenceAndRecordEffects(\n                 property.place,\n                 Effect.Capture,\n                 ValueReason.Other,\n-                functionEffects,\n               );\n               break;\n             }\n@@ -1080,7 +932,6 @@ function inferBlock(\n                 property.place,\n                 Effect.Capture,\n                 ValueReason.Other,\n-                functionEffects,\n               );\n               break;\n             }\n@@ -1096,6 +947,9 @@ function inferBlock(\n         state.initialize(instrValue, valueKind);\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.Store;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'UnaryExpression': {\n@@ -1122,7 +976,6 @@ function inferBlock(\n             instrValue.tag,\n             Effect.Freeze,\n             ValueReason.JsxCaptured,\n-            functionEffects,\n           );\n         }\n         if (instrValue.children !== null) {\n@@ -1131,7 +984,6 @@ function inferBlock(\n               child,\n               Effect.Freeze,\n               ValueReason.JsxCaptured,\n-              functionEffects,\n             );\n           }\n         }\n@@ -1141,20 +993,12 @@ function inferBlock(\n               attr.argument,\n               Effect.Freeze,\n               ValueReason.JsxCaptured,\n-              functionEffects,\n             );\n           } else {\n-            const propEffects: Array<FunctionEffect> = [];\n             state.referenceAndRecordEffects(\n               attr.place,\n               Effect.Freeze,\n               ValueReason.JsxCaptured,\n-              propEffects,\n-            );\n-            functionEffects.push(\n-              ...propEffects.filter(\n-                effect => !isEffectSafeOutsideRender(effect),\n-              ),\n             );\n           }\n         }\n@@ -1166,6 +1010,9 @@ function inferBlock(\n         });\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.ConditionallyMutate;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'JsxFragment': {\n@@ -1208,6 +1055,9 @@ function inferBlock(\n       }\n       case 'MetaProperty': {\n         if (instrValue.meta !== 'import' || instrValue.property !== 'meta') {\n+          functionEffects.push(\n+            ...inferInstructionFunctionEffects(env, state, instr),\n+          );\n           continue;\n         }\n \n@@ -1244,48 +1094,11 @@ function inferBlock(\n             operand,\n             operand.effect === Effect.Unknown ? Effect.Read : operand.effect,\n             ValueReason.Other,\n-            [],\n           );\n           if (isMutableEffect(operand.effect, operand.loc)) {\n             mutableOperands.push(operand);\n           }\n           hasMutableOperand ||= isMutableEffect(operand.effect, operand.loc);\n-\n-          /**\n-           * If this function references other functions, propagate the referenced function's\n-           * effects to this function.\n-           *\n-           * ```\n-           * let f = () => global = true;\n-           * let g = () => f();\n-           * g();\n-           * ```\n-           *\n-           * In this example, because `g` references `f`, we propagate the GlobalMutation from\n-           * `f` to `g`. Thus, referencing `g` in `g()` will evaluate the GlobalMutation in the outer\n-           * function effect context and report an error. But if instead we do:\n-           *\n-           * ```\n-           * let f = () => global = true;\n-           * let g = () => f();\n-           * useEffect(() => g(), [g])\n-           * ```\n-           *\n-           * Now `g`'s effects will be discarded since they're in a useEffect.\n-           */\n-          const values = state.values(operand);\n-          for (const value of values) {\n-            if (\n-              (value.kind === 'ObjectMethod' ||\n-                value.kind === 'FunctionExpression') &&\n-              value.loweredFunc.func.effects !== null\n-            ) {\n-              instrValue.loweredFunc.func.effects ??= [];\n-              instrValue.loweredFunc.func.effects.push(\n-                ...value.loweredFunc.func.effects,\n-              );\n-            }\n-          }\n         }\n         /*\n          * If a closure did not capture any mutable values, then we can consider it to be\n@@ -1298,6 +1111,9 @@ function inferBlock(\n         });\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.Store;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'TaggedTemplateExpression': {\n@@ -1334,11 +1150,13 @@ function inferBlock(\n           instrValue.tag,\n           calleeEffect,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.initialize(instrValue, returnValueKind);\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.ConditionallyMutate;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'CallExpression': {\n@@ -1365,50 +1183,35 @@ function inferBlock(\n                 context: new Set(),\n               };\n         let hasCaptureArgument = false;\n-        let isHook = getHookKind(env, instrValue.callee.identifier) != null;\n         for (let i = 0; i < instrValue.args.length; i++) {\n-          const argumentEffects: Array<FunctionEffect> = [];\n           const arg = instrValue.args[i];\n           const place = arg.kind === 'Identifier' ? arg : arg.place;\n           if (effects !== null) {\n             state.referenceAndRecordEffects(\n               place,\n               effects[i],\n               ValueReason.Other,\n-              argumentEffects,\n             );\n           } else {\n             state.referenceAndRecordEffects(\n               place,\n               Effect.ConditionallyMutate,\n               ValueReason.Other,\n-              argumentEffects,\n             );\n           }\n-          /*\n-           * Join the effects of the argument with the effects of the enclosing function,\n-           * unless the we're detecting a global mutation inside a useEffect hook\n-           */\n-          functionEffects.push(\n-            ...argumentEffects.filter(\n-              argEffect => !isHook || !isEffectSafeOutsideRender(argEffect),\n-            ),\n-          );\n           hasCaptureArgument ||= place.effect === Effect.Capture;\n         }\n         if (signature !== null) {\n           state.referenceAndRecordEffects(\n             instrValue.callee,\n             signature.calleeEffect,\n             ValueReason.Other,\n-            functionEffects,\n           );\n         } else {\n           state.referenceAndRecordEffects(\n             instrValue.callee,\n             Effect.ConditionallyMutate,\n             ValueReason.Other,\n-            functionEffects,\n           );\n         }\n         hasCaptureArgument ||= instrValue.callee.effect === Effect.Capture;\n@@ -1418,6 +1221,9 @@ function inferBlock(\n         instr.lvalue.effect = hasCaptureArgument\n           ? Effect.Store\n           : Effect.ConditionallyMutate;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'MethodCall': {\n@@ -1432,7 +1238,6 @@ function inferBlock(\n           instrValue.property,\n           Effect.Read,\n           ValueReason.Other,\n-          functionEffects,\n         );\n \n         const signature = getFunctionCallSignature(\n@@ -1468,30 +1273,29 @@ function inferBlock(\n               place,\n               Effect.Read,\n               ValueReason.Other,\n-              functionEffects,\n             );\n           }\n           state.referenceAndRecordEffects(\n             instrValue.receiver,\n             Effect.Capture,\n             ValueReason.Other,\n-            functionEffects,\n           );\n           state.initialize(instrValue, returnValueKind);\n           state.define(instr.lvalue, instrValue);\n           instr.lvalue.effect =\n             instrValue.receiver.effect === Effect.Capture\n               ? Effect.Store\n               : Effect.ConditionallyMutate;\n+          functionEffects.push(\n+            ...inferInstructionFunctionEffects(env, state, instr),\n+          );\n           continue;\n         }\n \n         const effects =\n           signature !== null ? getFunctionEffects(instrValue, signature) : null;\n         let hasCaptureArgument = false;\n-        let isHook = getHookKind(env, instrValue.property.identifier) != null;\n         for (let i = 0; i < instrValue.args.length; i++) {\n-          const argumentEffects: Array<FunctionEffect> = [];\n           const arg = instrValue.args[i];\n           const place = arg.kind === 'Identifier' ? arg : arg.place;\n           if (effects !== null) {\n@@ -1503,40 +1307,27 @@ function inferBlock(\n               place,\n               effects[i],\n               ValueReason.Other,\n-              argumentEffects,\n             );\n           } else {\n             state.referenceAndRecordEffects(\n               place,\n               Effect.ConditionallyMutate,\n               ValueReason.Other,\n-              argumentEffects,\n             );\n           }\n-          /*\n-           * Join the effects of the argument with the effects of the enclosing function,\n-           * unless the we're detecting a global mutation inside a useEffect hook\n-           */\n-          functionEffects.push(\n-            ...argumentEffects.filter(\n-              argEffect => !isHook || !isEffectSafeOutsideRender(argEffect),\n-            ),\n-          );\n           hasCaptureArgument ||= place.effect === Effect.Capture;\n         }\n         if (signature !== null) {\n           state.referenceAndRecordEffects(\n             instrValue.receiver,\n             signature.calleeEffect,\n             ValueReason.Other,\n-            functionEffects,\n           );\n         } else {\n           state.referenceAndRecordEffects(\n             instrValue.receiver,\n             Effect.ConditionallyMutate,\n             ValueReason.Other,\n-            functionEffects,\n           );\n         }\n         hasCaptureArgument ||= instrValue.receiver.effect === Effect.Capture;\n@@ -1546,6 +1337,9 @@ function inferBlock(\n         instr.lvalue.effect = hasCaptureArgument\n           ? Effect.Store\n           : Effect.ConditionallyMutate;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'PropertyStore': {\n@@ -1557,18 +1351,19 @@ function inferBlock(\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.referenceAndRecordEffects(\n           instrValue.object,\n           Effect.Store,\n           ValueReason.Other,\n-          functionEffects,\n         );\n \n         const lvalue = instr.lvalue;\n         state.alias(lvalue, instrValue.value);\n         lvalue.effect = Effect.Store;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'PropertyDelete': {\n@@ -1586,12 +1381,14 @@ function inferBlock(\n           instrValue.object,\n           Effect.Read,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.ConditionallyMutate;\n         state.initialize(instrValue, state.kind(instrValue.object));\n         state.define(lvalue, instrValue);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'ComputedStore': {\n@@ -1603,38 +1400,36 @@ function inferBlock(\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.referenceAndRecordEffects(\n           instrValue.property,\n           Effect.Capture,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.referenceAndRecordEffects(\n           instrValue.object,\n           Effect.Store,\n           ValueReason.Other,\n-          functionEffects,\n         );\n \n         const lvalue = instr.lvalue;\n         state.alias(lvalue, instrValue.value);\n         lvalue.effect = Effect.Store;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'ComputedDelete': {\n         state.referenceAndRecordEffects(\n           instrValue.object,\n           Effect.Mutate,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.referenceAndRecordEffects(\n           instrValue.property,\n           Effect.Read,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.initialize(instrValue, {\n           kind: ValueKind.Primitive,\n@@ -1643,25 +1438,29 @@ function inferBlock(\n         });\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.Mutate;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'ComputedLoad': {\n         state.referenceAndRecordEffects(\n           instrValue.object,\n           Effect.Read,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.referenceAndRecordEffects(\n           instrValue.property,\n           Effect.Read,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.ConditionallyMutate;\n         state.initialize(instrValue, state.kind(instrValue.object));\n         state.define(lvalue, instrValue);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'Await': {\n@@ -1675,11 +1474,13 @@ function inferBlock(\n           instrValue.value,\n           Effect.ConditionallyMutate,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.ConditionallyMutate;\n         state.alias(lvalue, instrValue.value);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'TypeCastExpression': {\n@@ -1696,11 +1497,13 @@ function inferBlock(\n           instrValue.value,\n           Effect.Read,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.ConditionallyMutate;\n         state.alias(lvalue, instrValue.value);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'StartMemoize':\n@@ -1711,14 +1514,12 @@ function inferBlock(\n               val,\n               Effect.Freeze,\n               ValueReason.Other,\n-              [],\n             );\n           } else {\n             state.referenceAndRecordEffects(\n               val,\n               Effect.Read,\n               ValueReason.Other,\n-              [],\n             );\n           }\n         }\n@@ -1730,6 +1531,9 @@ function inferBlock(\n           context: new Set(),\n         });\n         state.define(lvalue, instrValue);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'LoadLocal': {\n@@ -1743,25 +1547,29 @@ function inferBlock(\n           instrValue.place,\n           effect,\n           ValueReason.Other,\n-          [],\n         );\n         lvalue.effect = Effect.ConditionallyMutate;\n         // direct aliasing: `a = b`;\n         state.alias(lvalue, instrValue.place);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'LoadContext': {\n         state.referenceAndRecordEffects(\n           instrValue.place,\n           Effect.Capture,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.ConditionallyMutate;\n         const valueKind = state.kind(instrValue.place);\n         state.initialize(instrValue, valueKind);\n         state.define(lvalue, instrValue);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'DeclareLocal': {\n@@ -1782,6 +1590,9 @@ function inferBlock(\n               },\n         );\n         state.define(instrValue.lvalue.place, value);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'DeclareContext': {\n@@ -1791,6 +1602,9 @@ function inferBlock(\n           context: new Set(),\n         });\n         state.define(instrValue.lvalue.place, instrValue);\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'PostfixUpdate':\n@@ -1804,7 +1618,6 @@ function inferBlock(\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n-          functionEffects,\n         );\n \n         const lvalue = instr.lvalue;\n@@ -1818,6 +1631,9 @@ function inferBlock(\n          * replacing it\n          */\n         instrValue.lvalue.effect = Effect.Store;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'StoreLocal': {\n@@ -1830,7 +1646,6 @@ function inferBlock(\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n-          [],\n         );\n \n         const lvalue = instr.lvalue;\n@@ -1844,47 +1659,42 @@ function inferBlock(\n          * replacing it\n          */\n         instrValue.lvalue.place.effect = Effect.Store;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'StoreContext': {\n         state.referenceAndRecordEffects(\n           instrValue.value,\n           Effect.ConditionallyMutate,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.referenceAndRecordEffects(\n           instrValue.lvalue.place,\n           Effect.Mutate,\n           ValueReason.Other,\n-          functionEffects,\n         );\n \n         const lvalue = instr.lvalue;\n         state.alias(lvalue, instrValue.value);\n         lvalue.effect = Effect.Store;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'StoreGlobal': {\n         state.referenceAndRecordEffects(\n           instrValue.value,\n           Effect.Capture,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.Store;\n-\n-        functionEffects.push({\n-          kind: 'GlobalMutation',\n-          error: {\n-            reason:\n-              'Unexpected reassignment of a variable which was defined outside of the component. Components and hooks should be pure and side-effect free, but variable reassignment is a form of side-effect. If this variable is used in rendering, use useState instead. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#side-effects-must-run-outside-of-render)',\n-            loc: instr.loc,\n-            suggestions: null,\n-            severity: ErrorSeverity.InvalidReact,\n-          },\n-        });\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'Destructure': {\n@@ -1902,7 +1712,6 @@ function inferBlock(\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n-          functionEffects,\n         );\n \n         const lvalue = instr.lvalue;\n@@ -1918,6 +1727,9 @@ function inferBlock(\n            */\n           place.effect = Effect.Store;\n         }\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'GetIterator': {\n@@ -1975,7 +1787,6 @@ function inferBlock(\n           instrValue.iterator,\n           Effect.ConditionallyMutate,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         /**\n          * Regardless of the effect on the iterator, the *result* of advancing the iterator\n@@ -1987,11 +1798,13 @@ function inferBlock(\n           instrValue.collection,\n           Effect.Capture,\n           ValueReason.Other,\n-          functionEffects,\n         );\n         state.initialize(instrValue, state.kind(instrValue.collection));\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.Store;\n+        functionEffects.push(\n+          ...inferInstructionFunctionEffects(env, state, instr),\n+        );\n         continue;\n       }\n       case 'NextPropertyOf': {\n@@ -2016,17 +1829,14 @@ function inferBlock(\n         loc: instrValue.loc,\n         suggestions: null,\n       });\n-      state.referenceAndRecordEffects(\n-        operand,\n-        effect.kind,\n-        effect.reason,\n-        functionEffects,\n-      );\n+      state.referenceAndRecordEffects(operand, effect.kind, effect.reason);\n     }\n \n     state.initialize(instrValue, valueKind);\n     state.define(instr.lvalue, instrValue);\n     instr.lvalue.effect = lvalueEffect;\n+\n+    functionEffects.push(...inferInstructionFunctionEffects(env, state, instr));\n   }\n \n   for (const operand of eachTerminalOperand(block.terminal)) {\n@@ -2043,17 +1853,9 @@ function inferBlock(\n     } else {\n       effect = Effect.Read;\n     }\n-    const propEffects: Array<FunctionEffect> = [];\n-    state.referenceAndRecordEffects(\n-      operand,\n-      effect,\n-      ValueReason.Other,\n-      propEffects,\n-    );\n-    functionEffects.push(\n-      ...propEffects.filter(effect => !isEffectSafeOutsideRender(effect)),\n-    );\n+    state.referenceAndRecordEffects(operand, effect, ValueReason.Other);\n   }\n+  functionEffects.push(...inferTerminalFunctionEffects(state, block));\n }\n \n function hasContextRefOperand(\n@@ -2089,7 +1891,7 @@ export function getFunctionCallSignature(\n  * @param sig\n  * @returns Inferred effects of function arguments, or null if inference fails.\n  */\n-function getFunctionEffects(\n+export function getFunctionEffects(\n   fn: MethodCall | CallExpression,\n   sig: FunctionSignature,\n ): Array<Effect> | null {\n@@ -2164,27 +1966,3 @@ function areArgumentsImmutableAndNonMutating(\n   }\n   return true;\n }\n-\n-function isEffectSafeOutsideRender(effect: FunctionEffect): boolean {\n-  return effect.kind === 'GlobalMutation';\n-}\n-\n-function getWriteErrorReason(abstractValue: AbstractValue): string {\n-  if (abstractValue.reason.has(ValueReason.Global)) {\n-    return 'Writing to a variable defined outside a component or hook is not allowed. Consider using an effect';\n-  } else if (abstractValue.reason.has(ValueReason.JsxCaptured)) {\n-    return 'Updating a value used previously in JSX is not allowed. Consider moving the mutation before the JSX';\n-  } else if (abstractValue.reason.has(ValueReason.Context)) {\n-    return `Mutating a value returned from 'useContext()', which should not be mutated`;\n-  } else if (abstractValue.reason.has(ValueReason.KnownReturnSignature)) {\n-    return 'Mutating a value returned from a function whose return value should not be mutated';\n-  } else if (abstractValue.reason.has(ValueReason.ReactiveFunctionArgument)) {\n-    return 'Mutating component props or hook arguments is not allowed. Consider using a local variable instead';\n-  } else if (abstractValue.reason.has(ValueReason.State)) {\n-    return \"Mutating a value returned from 'useState()', which should not be mutated. Use the setter function to update instead\";\n-  } else if (abstractValue.reason.has(ValueReason.ReducerState)) {\n-    return \"Mutating a value returned from 'useReducer()', which should not be mutated. Use the dispatch function to update instead\";\n-  } else {\n-    return 'This mutates a variable that React considers immutable';\n-  }\n-}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-function-expression-mutates-immutable-value.expect.md",
                "git_diff": "@@ -21,7 +21,7 @@ function Component(props) {\n   3 |   const onChange = e => {\n   4 |     // INVALID! should use copy-on-write and pass the new value\n > 5 |     x.value = e.target.value;\n-    |     ^ InvalidReact: Mutating a value returned from 'useState()', which should not be mutated. Use the setter function to update instead. Found mutation of `x` (5:5)\n+    |     ^ InvalidReact: Updating a value used previously in JSX is not allowed. Consider moving the mutation before the JSX. Found mutation of `x` (5:5)\n   6 |     setX(x);\n   7 |   };\n   8 |   return <input value={x.value} onChange={onChange} />;"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/useImperativeHandle-external-mutate.expect.md",
                "git_diff": "@@ -0,0 +1,80 @@\n+\n+## Input\n+\n+```javascript\n+// @flow\n+\n+import {useImperativeHandle, useRef} from 'react';\n+\n+const a = {b: 42};\n+let b = 42;\n+\n+component Component(prop: number) {\n+  const ref = useRef(null);\n+  useImperativeHandle(ref, () => {\n+    a.b = prop;\n+    b = prop;\n+    return {\n+      foo: () => {\n+        a.b = prop;\n+        b = prop;\n+      },\n+    };\n+  }, [prop]);\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{prop: 1}],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\";\n+\n+import { useImperativeHandle, useRef } from \"react\";\n+\n+const a = { b: 42 };\n+let b = 42;\n+\n+function Component(t0) {\n+  const $ = _c(3);\n+  const { prop } = t0;\n+  const ref = useRef(null);\n+  let t1;\n+  let t2;\n+  if ($[0] !== prop) {\n+    t1 = () => {\n+      a.b = prop;\n+      b = prop;\n+      return {\n+        foo: () => {\n+          a.b = prop;\n+          b = prop;\n+        },\n+      };\n+    };\n+\n+    t2 = [prop];\n+    $[0] = prop;\n+    $[1] = t1;\n+    $[2] = t2;\n+  } else {\n+    t1 = $[1];\n+    t2 = $[2];\n+  }\n+  useImperativeHandle(ref, t1, t2);\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{ prop: 1 }],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) \n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/useImperativeHandle-external-mutate.js",
                "git_diff": "@@ -0,0 +1,25 @@\n+// @flow\n+\n+import {useImperativeHandle, useRef} from 'react';\n+\n+const a = {b: 42};\n+let b = 42;\n+\n+component Component(prop: number) {\n+  const ref = useRef(null);\n+  useImperativeHandle(ref, () => {\n+    a.b = prop;\n+    b = prop;\n+    return {\n+      foo: () => {\n+        a.b = prop;\n+        b = prop;\n+      },\n+    };\n+  }, [prop]);\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{prop: 1}],\n+};"
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/error.invalid-function-expression-mutates-immutable-value.js",
                "git_diff": "@@ -5,5 +5,5 @@ function Component(props) {\n     x.value = e.target.value;\n     setX(x);\n   };\n-  return <input onChange={onChange} />;\n+  return <input value={x.value} onChange={onChange} />;\n }"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Inference/InferReferenceEffects.ts",
                "git_diff": "@@ -246,6 +246,8 @@ export default function inferReferenceEffects(\n   }\n }\n \n+type FreezeAction = {values: Set<InstructionValue>; reason: Set<ValueReason>};\n+\n // Maintains a mapping of top-level variables to the kind of value they hold\n class InferenceState {\n   #env: Environment;\n@@ -362,6 +364,7 @@ class InferenceState {\n    * value is already frozen or is immutable.\n    */\n   referenceAndRecordEffects(\n+    freezeActions: Array<FreezeAction>,\n     place: Place,\n     effectKind: Effect,\n     reason: ValueReason,\n@@ -381,18 +384,17 @@ class InferenceState {\n       return;\n     }\n \n-    this.reference(place, effectKind, reason);\n+    const action = this.reference(place, effectKind, reason);\n+    action && freezeActions.push(action);\n   }\n \n   freezeValues(values: Set<InstructionValue>, reason: Set<ValueReason>): void {\n     for (const value of values) {\n-      if (this.#values.get(value)?.kind !== ValueKind.Context) {\n-        this.#values.set(value, {\n-          kind: ValueKind.Frozen,\n-          reason,\n-          context: new Set(),\n-        });\n-      }\n+      this.#values.set(value, {\n+        kind: ValueKind.Frozen,\n+        reason,\n+        context: new Set(),\n+      });\n       if (value.kind === 'FunctionExpression') {\n         if (\n           this.#env.config.enablePreserveExistingMemoizationGuarantees ||\n@@ -417,7 +419,11 @@ class InferenceState {\n     }\n   }\n \n-  reference(place: Place, effectKind: Effect, reason: ValueReason): void {\n+  reference(\n+    place: Place,\n+    effectKind: Effect,\n+    reason: ValueReason,\n+  ): null | FreezeAction {\n     const values = this.#variables.get(place.identifier.id);\n     CompilerError.invariant(values !== undefined, {\n       reason: '[InferReferenceEffects] Expected value to be initialized',\n@@ -427,7 +433,7 @@ class InferenceState {\n     });\n     let valueKind: AbstractValue | null = this.kind(place);\n     let effect: Effect | null = null;\n-    let freeze: null | [Set<InstructionValue>, Set<ValueReason>] = null;\n+    let freeze: null | FreezeAction = null;\n     switch (effectKind) {\n       case Effect.Freeze: {\n         if (\n@@ -442,7 +448,7 @@ class InferenceState {\n             reason: reasonSet,\n             context: new Set(),\n           };\n-          this.freezeValues(values, reasonSet);\n+          freeze = {values, reason: reasonSet};\n         } else {\n           effect = Effect.Read;\n         }\n@@ -515,6 +521,7 @@ class InferenceState {\n       suggestions: null,\n     });\n     place.effect = effect;\n+    return freeze;\n   }\n \n   /*\n@@ -805,6 +812,15 @@ function mergeAbstractValues(\n   return {kind, reason, context};\n }\n \n+type Continuation =\n+  | {\n+      kind: 'initialize';\n+      valueKind: AbstractValue;\n+      effect: {kind: Effect; reason: ValueReason} | null;\n+      lvalueEffect?: Effect;\n+    }\n+  | {kind: 'funeffects'};\n+\n /*\n  * Iterates over the given @param block, defining variables and\n  * recording references on the @param state according to JS semantics.\n@@ -821,24 +837,27 @@ function inferBlock(\n \n   for (const instr of block.instructions) {\n     const instrValue = instr.value;\n-    let effect: {kind: Effect; reason: ValueReason} | null = null;\n-    let lvalueEffect = Effect.ConditionallyMutate;\n-    let valueKind: AbstractValue;\n+    const defaultLvalueEffect = Effect.ConditionallyMutate;\n+    let continuation: Continuation;\n+    const freezeActions: Array<FreezeAction> = [];\n     switch (instrValue.kind) {\n       case 'BinaryExpression': {\n-        valueKind = {\n-          kind: ValueKind.Primitive,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n-        };\n-        effect = {\n-          kind: Effect.Read,\n-          reason: ValueReason.Other,\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Primitive,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n+          effect: {\n+            kind: Effect.Read,\n+            reason: ValueReason.Other,\n+          },\n         };\n         break;\n       }\n       case 'ArrayExpression': {\n-        valueKind = hasContextRefOperand(state, instrValue)\n+        const valueKind: AbstractValue = hasContextRefOperand(state, instrValue)\n           ? {\n               kind: ValueKind.Context,\n               reason: new Set([ValueReason.Other]),\n@@ -849,8 +868,12 @@ function inferBlock(\n               reason: new Set([ValueReason.Other]),\n               context: new Set(),\n             };\n-        effect = {kind: Effect.Capture, reason: ValueReason.Other};\n-        lvalueEffect = Effect.Store;\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind,\n+          effect: {kind: Effect.Capture, reason: ValueReason.Other},\n+          lvalueEffect: Effect.Store,\n+        };\n         break;\n       }\n       case 'NewExpression': {\n@@ -867,19 +890,21 @@ function inferBlock(\n          * Classes / functions created during render could technically capture and\n          * mutate their enclosing scope, which we currently do not detect.\n          */\n-        valueKind = {\n+        const valueKind: AbstractValue = {\n           kind: ValueKind.Mutable,\n           reason: new Set([ValueReason.Other]),\n           context: new Set(),\n         };\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.callee,\n           Effect.Read,\n           ValueReason.Other,\n         );\n \n         for (const operand of eachCallArgument(instrValue.args)) {\n           state.referenceAndRecordEffects(\n+            freezeActions,\n             operand,\n             Effect.ConditionallyMutate,\n             ValueReason.Other,\n@@ -888,14 +913,12 @@ function inferBlock(\n \n         state.initialize(instrValue, valueKind);\n         state.define(instr.lvalue, instrValue);\n-        instr.lvalue.effect = lvalueEffect;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        instr.lvalue.effect = Effect.ConditionallyMutate;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'ObjectExpression': {\n-        valueKind = hasContextRefOperand(state, instrValue)\n+        const valueKind: AbstractValue = hasContextRefOperand(state, instrValue)\n           ? {\n               kind: ValueKind.Context,\n               reason: new Set([ValueReason.Other]),\n@@ -913,13 +936,15 @@ function inferBlock(\n               if (property.key.kind === 'computed') {\n                 // Object keys must be primitives, so we know they're frozen at this point\n                 state.referenceAndRecordEffects(\n+                  freezeActions,\n                   property.key.name,\n                   Effect.Freeze,\n                   ValueReason.Other,\n                 );\n               }\n               // Object construction captures but does not modify the key/property values\n               state.referenceAndRecordEffects(\n+                freezeActions,\n                 property.place,\n                 Effect.Capture,\n                 ValueReason.Other,\n@@ -929,6 +954,7 @@ function inferBlock(\n             case 'Spread': {\n               // Object construction captures but does not modify the key/property values\n               state.referenceAndRecordEffects(\n+                freezeActions,\n                 property.place,\n                 Effect.Capture,\n                 ValueReason.Other,\n@@ -947,32 +973,38 @@ function inferBlock(\n         state.initialize(instrValue, valueKind);\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'UnaryExpression': {\n-        valueKind = {\n-          kind: ValueKind.Primitive,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Primitive,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n+          effect: {kind: Effect.Read, reason: ValueReason.Other},\n         };\n-        effect = {kind: Effect.Read, reason: ValueReason.Other};\n         break;\n       }\n       case 'UnsupportedNode': {\n         // TODO: handle other statement kinds\n-        valueKind = {\n-          kind: ValueKind.Mutable,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Mutable,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n+          effect: null,\n         };\n         break;\n       }\n       case 'JsxExpression': {\n         if (instrValue.tag.kind === 'Identifier') {\n           state.referenceAndRecordEffects(\n+            freezeActions,\n             instrValue.tag,\n             Effect.Freeze,\n             ValueReason.JsxCaptured,\n@@ -981,6 +1013,7 @@ function inferBlock(\n         if (instrValue.children !== null) {\n           for (const child of instrValue.children) {\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               child,\n               Effect.Freeze,\n               ValueReason.JsxCaptured,\n@@ -990,12 +1023,14 @@ function inferBlock(\n         for (const attr of instrValue.props) {\n           if (attr.kind === 'JsxSpreadAttribute') {\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               attr.argument,\n               Effect.Freeze,\n               ValueReason.JsxCaptured,\n             );\n           } else {\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               attr.place,\n               Effect.Freeze,\n               ValueReason.JsxCaptured,\n@@ -1010,20 +1045,21 @@ function inferBlock(\n         });\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.ConditionallyMutate;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'JsxFragment': {\n-        valueKind = {\n-          kind: ValueKind.Frozen,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n-        };\n-        effect = {\n-          kind: Effect.Freeze,\n-          reason: ValueReason.Other,\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Frozen,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n+          effect: {\n+            kind: Effect.Freeze,\n+            reason: ValueReason.Other,\n+          },\n         };\n         break;\n       }\n@@ -1032,56 +1068,71 @@ function inferBlock(\n          * template literal (with no tag function) always produces\n          * an immutable string\n          */\n-        valueKind = {\n-          kind: ValueKind.Primitive,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Primitive,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n+          effect: {kind: Effect.Read, reason: ValueReason.Other},\n         };\n-        effect = {kind: Effect.Read, reason: ValueReason.Other};\n         break;\n       }\n       case 'RegExpLiteral': {\n         // RegExp instances are mutable objects\n-        valueKind = {\n-          kind: ValueKind.Mutable,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n-        };\n-        effect = {\n-          kind: Effect.ConditionallyMutate,\n-          reason: ValueReason.Other,\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Mutable,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n+          effect: {\n+            kind: Effect.ConditionallyMutate,\n+            reason: ValueReason.Other,\n+          },\n         };\n         break;\n       }\n       case 'MetaProperty': {\n         if (instrValue.meta !== 'import' || instrValue.property !== 'meta') {\n-          functionEffects.push(\n-            ...inferInstructionFunctionEffects(env, state, instr),\n-          );\n-          continue;\n+          continuation = {kind: 'funeffects'};\n+          break;\n         }\n-\n-        valueKind = {\n-          kind: ValueKind.Global,\n-          reason: new Set([ValueReason.Global]),\n-          context: new Set(),\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Global,\n+            reason: new Set([ValueReason.Global]),\n+            context: new Set(),\n+          },\n+          effect: null,\n         };\n         break;\n       }\n       case 'LoadGlobal':\n-        valueKind = {\n-          kind: ValueKind.Global,\n-          reason: new Set([ValueReason.Global]),\n-          context: new Set(),\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Global,\n+            reason: new Set([ValueReason.Global]),\n+            context: new Set(),\n+          },\n+          effect: null,\n         };\n         break;\n       case 'Debugger':\n       case 'JSXText':\n       case 'Primitive': {\n-        valueKind = {\n-          kind: ValueKind.Primitive,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Primitive,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n+          effect: null,\n         };\n         break;\n       }\n@@ -1091,6 +1142,7 @@ function inferBlock(\n         const mutableOperands: Array<Place> = [];\n         for (const operand of eachInstructionOperand(instr)) {\n           state.referenceAndRecordEffects(\n+            freezeActions,\n             operand,\n             operand.effect === Effect.Unknown ? Effect.Read : operand.effect,\n             ValueReason.Other,\n@@ -1111,10 +1163,8 @@ function inferBlock(\n         });\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'TaggedTemplateExpression': {\n         const operands = [...eachInstructionValueOperand(instrValue)];\n@@ -1147,17 +1197,16 @@ function inferBlock(\n                 context: new Set(),\n               };\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.tag,\n           calleeEffect,\n           ValueReason.Other,\n         );\n         state.initialize(instrValue, returnValueKind);\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.ConditionallyMutate;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'CallExpression': {\n         const signature = getFunctionCallSignature(\n@@ -1188,12 +1237,14 @@ function inferBlock(\n           const place = arg.kind === 'Identifier' ? arg : arg.place;\n           if (effects !== null) {\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               place,\n               effects[i],\n               ValueReason.Other,\n             );\n           } else {\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               place,\n               Effect.ConditionallyMutate,\n               ValueReason.Other,\n@@ -1203,12 +1254,14 @@ function inferBlock(\n         }\n         if (signature !== null) {\n           state.referenceAndRecordEffects(\n+            freezeActions,\n             instrValue.callee,\n             signature.calleeEffect,\n             ValueReason.Other,\n           );\n         } else {\n           state.referenceAndRecordEffects(\n+            freezeActions,\n             instrValue.callee,\n             Effect.ConditionallyMutate,\n             ValueReason.Other,\n@@ -1221,10 +1274,8 @@ function inferBlock(\n         instr.lvalue.effect = hasCaptureArgument\n           ? Effect.Store\n           : Effect.ConditionallyMutate;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'MethodCall': {\n         CompilerError.invariant(state.isDefined(instrValue.receiver), {\n@@ -1235,6 +1286,7 @@ function inferBlock(\n           suggestions: null,\n         });\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.property,\n           Effect.Read,\n           ValueReason.Other,\n@@ -1270,12 +1322,14 @@ function inferBlock(\n           for (const arg of instrValue.args) {\n             const place = arg.kind === 'Identifier' ? arg : arg.place;\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               place,\n               Effect.Read,\n               ValueReason.Other,\n             );\n           }\n           state.referenceAndRecordEffects(\n+            freezeActions,\n             instrValue.receiver,\n             Effect.Capture,\n             ValueReason.Other,\n@@ -1286,10 +1340,8 @@ function inferBlock(\n             instrValue.receiver.effect === Effect.Capture\n               ? Effect.Store\n               : Effect.ConditionallyMutate;\n-          functionEffects.push(\n-            ...inferInstructionFunctionEffects(env, state, instr),\n-          );\n-          continue;\n+          continuation = {kind: 'funeffects'};\n+          break;\n         }\n \n         const effects =\n@@ -1304,12 +1356,14 @@ function inferBlock(\n              * mutating effects\n              */\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               place,\n               effects[i],\n               ValueReason.Other,\n             );\n           } else {\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               place,\n               Effect.ConditionallyMutate,\n               ValueReason.Other,\n@@ -1319,12 +1373,14 @@ function inferBlock(\n         }\n         if (signature !== null) {\n           state.referenceAndRecordEffects(\n+            freezeActions,\n             instrValue.receiver,\n             signature.calleeEffect,\n             ValueReason.Other,\n           );\n         } else {\n           state.referenceAndRecordEffects(\n+            freezeActions,\n             instrValue.receiver,\n             Effect.ConditionallyMutate,\n             ValueReason.Other,\n@@ -1337,22 +1393,22 @@ function inferBlock(\n         instr.lvalue.effect = hasCaptureArgument\n           ? Effect.Store\n           : Effect.ConditionallyMutate;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'PropertyStore': {\n         const effect =\n           state.kind(instrValue.object).kind === ValueKind.Context\n             ? Effect.ConditionallyMutate\n             : Effect.Capture;\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n         );\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.object,\n           Effect.Store,\n           ValueReason.Other,\n@@ -1361,23 +1417,25 @@ function inferBlock(\n         const lvalue = instr.lvalue;\n         state.alias(lvalue, instrValue.value);\n         lvalue.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'PropertyDelete': {\n         // `delete` returns a boolean (immutable) and modifies the object\n-        valueKind = {\n-          kind: ValueKind.Primitive,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n+        continuation = {\n+          kind: 'initialize',\n+          valueKind: {\n+            kind: ValueKind.Primitive,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n+          effect: {kind: Effect.Mutate, reason: ValueReason.Other},\n         };\n-        effect = {kind: Effect.Mutate, reason: ValueReason.Other};\n         break;\n       }\n       case 'PropertyLoad': {\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.object,\n           Effect.Read,\n           ValueReason.Other,\n@@ -1386,27 +1444,28 @@ function inferBlock(\n         lvalue.effect = Effect.ConditionallyMutate;\n         state.initialize(instrValue, state.kind(instrValue.object));\n         state.define(lvalue, instrValue);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'ComputedStore': {\n         const effect =\n           state.kind(instrValue.object).kind === ValueKind.Context\n             ? Effect.ConditionallyMutate\n             : Effect.Capture;\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n         );\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.property,\n           Effect.Capture,\n           ValueReason.Other,\n         );\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.object,\n           Effect.Store,\n           ValueReason.Other,\n@@ -1415,18 +1474,18 @@ function inferBlock(\n         const lvalue = instr.lvalue;\n         state.alias(lvalue, instrValue.value);\n         lvalue.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'ComputedDelete': {\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.object,\n           Effect.Mutate,\n           ValueReason.Other,\n         );\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.property,\n           Effect.Read,\n           ValueReason.Other,\n@@ -1438,18 +1497,18 @@ function inferBlock(\n         });\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.Mutate;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'ComputedLoad': {\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.object,\n           Effect.Read,\n           ValueReason.Other,\n         );\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.property,\n           Effect.Read,\n           ValueReason.Other,\n@@ -1458,10 +1517,8 @@ function inferBlock(\n         lvalue.effect = Effect.ConditionallyMutate;\n         state.initialize(instrValue, state.kind(instrValue.object));\n         state.define(lvalue, instrValue);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'Await': {\n         state.initialize(instrValue, state.kind(instrValue.value));\n@@ -1471,17 +1528,16 @@ function inferBlock(\n          * will occur.\n          */\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           Effect.ConditionallyMutate,\n           ValueReason.Other,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.ConditionallyMutate;\n         state.alias(lvalue, instrValue.value);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'TypeCastExpression': {\n         /*\n@@ -1494,29 +1550,30 @@ function inferBlock(\n          */\n         state.initialize(instrValue, state.kind(instrValue.value));\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           Effect.Read,\n           ValueReason.Other,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.ConditionallyMutate;\n         state.alias(lvalue, instrValue.value);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'StartMemoize':\n       case 'FinishMemoize': {\n         for (const val of eachInstructionValueOperand(instrValue)) {\n           if (env.config.enablePreserveExistingMemoizationGuarantees) {\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               val,\n               Effect.Freeze,\n               ValueReason.Other,\n             );\n           } else {\n             state.referenceAndRecordEffects(\n+              freezeActions,\n               val,\n               Effect.Read,\n               ValueReason.Other,\n@@ -1531,10 +1588,8 @@ function inferBlock(\n           context: new Set(),\n         });\n         state.define(lvalue, instrValue);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'LoadLocal': {\n         const lvalue = instr.lvalue;\n@@ -1544,20 +1599,20 @@ function inferBlock(\n             ? Effect.ConditionallyMutate\n             : Effect.Capture;\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.place,\n           effect,\n           ValueReason.Other,\n         );\n         lvalue.effect = Effect.ConditionallyMutate;\n         // direct aliasing: `a = b`;\n         state.alias(lvalue, instrValue.place);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'LoadContext': {\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.place,\n           Effect.Capture,\n           ValueReason.Other,\n@@ -1567,10 +1622,8 @@ function inferBlock(\n         const valueKind = state.kind(instrValue.place);\n         state.initialize(instrValue, valueKind);\n         state.define(lvalue, instrValue);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'DeclareLocal': {\n         const value = UndefinedValue;\n@@ -1590,10 +1643,8 @@ function inferBlock(\n               },\n         );\n         state.define(instrValue.lvalue.place, value);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'DeclareContext': {\n         state.initialize(instrValue, {\n@@ -1602,10 +1653,8 @@ function inferBlock(\n           context: new Set(),\n         });\n         state.define(instrValue.lvalue.place, instrValue);\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'PostfixUpdate':\n       case 'PrefixUpdate': {\n@@ -1615,6 +1664,7 @@ function inferBlock(\n             ? Effect.ConditionallyMutate\n             : Effect.Capture;\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n@@ -1631,10 +1681,8 @@ function inferBlock(\n          * replacing it\n          */\n         instrValue.lvalue.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'StoreLocal': {\n         const effect =\n@@ -1643,6 +1691,7 @@ function inferBlock(\n             ? Effect.ConditionallyMutate\n             : Effect.Capture;\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n@@ -1659,18 +1708,18 @@ function inferBlock(\n          * replacing it\n          */\n         instrValue.lvalue.place.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'StoreContext': {\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           Effect.ConditionallyMutate,\n           ValueReason.Other,\n         );\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.lvalue.place,\n           Effect.Mutate,\n           ValueReason.Other,\n@@ -1679,23 +1728,20 @@ function inferBlock(\n         const lvalue = instr.lvalue;\n         state.alias(lvalue, instrValue.value);\n         lvalue.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'StoreGlobal': {\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           Effect.Capture,\n           ValueReason.Other,\n         );\n         const lvalue = instr.lvalue;\n         lvalue.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'Destructure': {\n         let effect: Effect = Effect.Capture;\n@@ -1709,6 +1755,7 @@ function inferBlock(\n           }\n         }\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.value,\n           effect,\n           ValueReason.Other,\n@@ -1727,10 +1774,8 @@ function inferBlock(\n            */\n           place.effect = Effect.Store;\n         }\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'GetIterator': {\n         /**\n@@ -1750,6 +1795,8 @@ function inferBlock(\n         const kind = state.kind(instrValue.collection).kind;\n         const isMutable =\n           kind === ValueKind.Mutable || kind === ValueKind.Context;\n+        let effect;\n+        let valueKind: AbstractValue;\n         if (!isMutable || isArrayType(instrValue.collection.identifier)) {\n           // Case 1, assume iterator is a separate mutable object\n           effect = {\n@@ -1769,7 +1816,12 @@ function inferBlock(\n           };\n           valueKind = state.kind(instrValue.collection);\n         }\n-        lvalueEffect = Effect.Store;\n+        continuation = {\n+          kind: 'initialize',\n+          effect,\n+          valueKind,\n+          lvalueEffect: Effect.Store,\n+        };\n         break;\n       }\n       case 'IteratorNext': {\n@@ -1784,6 +1836,7 @@ function inferBlock(\n          * ConditionallyMutate reflects this \"mutate if mutable\" semantic.\n          */\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.iterator,\n           Effect.ConditionallyMutate,\n           ValueReason.Other,\n@@ -1795,25 +1848,27 @@ function inferBlock(\n          * ensure that the item is mutable or frozen if the collection is mutable/frozen.\n          */\n         state.referenceAndRecordEffects(\n+          freezeActions,\n           instrValue.collection,\n           Effect.Capture,\n           ValueReason.Other,\n         );\n         state.initialize(instrValue, state.kind(instrValue.collection));\n         state.define(instr.lvalue, instrValue);\n         instr.lvalue.effect = Effect.Store;\n-        functionEffects.push(\n-          ...inferInstructionFunctionEffects(env, state, instr),\n-        );\n-        continue;\n+        continuation = {kind: 'funeffects'};\n+        break;\n       }\n       case 'NextPropertyOf': {\n-        effect = {kind: Effect.Read, reason: ValueReason.Other};\n-        lvalueEffect = Effect.Store;\n-        valueKind = {\n-          kind: ValueKind.Primitive,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n+        continuation = {\n+          kind: 'initialize',\n+          effect: {kind: Effect.Read, reason: ValueReason.Other},\n+          lvalueEffect: Effect.Store,\n+          valueKind: {\n+            kind: ValueKind.Primitive,\n+            reason: new Set([ValueReason.Other]),\n+            context: new Set(),\n+          },\n         };\n         break;\n       }\n@@ -1822,23 +1877,34 @@ function inferBlock(\n       }\n     }\n \n-    for (const operand of eachInstructionOperand(instr)) {\n-      CompilerError.invariant(effect != null, {\n-        reason: `effectKind must be set for instruction value \\`${instrValue.kind}\\``,\n-        description: null,\n-        loc: instrValue.loc,\n-        suggestions: null,\n-      });\n-      state.referenceAndRecordEffects(operand, effect.kind, effect.reason);\n-    }\n+    if (continuation.kind === 'initialize') {\n+      for (const operand of eachInstructionOperand(instr)) {\n+        CompilerError.invariant(continuation.effect != null, {\n+          reason: `effectKind must be set for instruction value \\`${instrValue.kind}\\``,\n+          description: null,\n+          loc: instrValue.loc,\n+          suggestions: null,\n+        });\n+        state.referenceAndRecordEffects(\n+          freezeActions,\n+          operand,\n+          continuation.effect.kind,\n+          continuation.effect.reason,\n+        );\n+      }\n \n-    state.initialize(instrValue, valueKind);\n-    state.define(instr.lvalue, instrValue);\n-    instr.lvalue.effect = lvalueEffect;\n+      state.initialize(instrValue, continuation.valueKind);\n+      state.define(instr.lvalue, instrValue);\n+      instr.lvalue.effect = continuation.lvalueEffect ?? defaultLvalueEffect;\n+    }\n \n     functionEffects.push(...inferInstructionFunctionEffects(env, state, instr));\n+    freezeActions.forEach(({values, reason}) =>\n+      state.freezeValues(values, reason),\n+    );\n   }\n \n+  const terminalFreezeActions: Array<FreezeAction> = [];\n   for (const operand of eachTerminalOperand(block.terminal)) {\n     let effect;\n     if (block.terminal.kind === 'return' || block.terminal.kind === 'throw') {\n@@ -1853,9 +1919,17 @@ function inferBlock(\n     } else {\n       effect = Effect.Read;\n     }\n-    state.referenceAndRecordEffects(operand, effect, ValueReason.Other);\n+    state.referenceAndRecordEffects(\n+      terminalFreezeActions,\n+      operand,\n+      effect,\n+      ValueReason.Other,\n+    );\n   }\n   functionEffects.push(...inferTerminalFunctionEffects(state, block));\n+  terminalFreezeActions.forEach(({values, reason}) =>\n+    state.freezeValues(values, reason),\n+  );\n }\n \n function hasContextRefOperand("
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.invalid-function-expression-mutates-immutable-value.expect.md",
                "git_diff": "@@ -21,7 +21,7 @@ function Component(props) {\n   3 |   const onChange = e => {\n   4 |     // INVALID! should use copy-on-write and pass the new value\n > 5 |     x.value = e.target.value;\n-    |     ^ InvalidReact: Updating a value used previously in JSX is not allowed. Consider moving the mutation before the JSX. Found mutation of `x` (5:5)\n+    |     ^ InvalidReact: Mutating a value returned from 'useState()', which should not be mutated. Use the setter function to update instead. Found mutation of `x` (5:5)\n   6 |     setX(x);\n   7 |   };\n   8 |   return <input value={x.value} onChange={onChange} />;"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/useImperativeHandle-external-mutate.expect.md",
                "git_diff": "@@ -1,80 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @flow\n-\n-import {useImperativeHandle, useRef} from 'react';\n-\n-const a = {b: 42};\n-let b = 42;\n-\n-component Component(prop: number) {\n-  const ref = useRef(null);\n-  useImperativeHandle(ref, () => {\n-    a.b = prop;\n-    b = prop;\n-    return {\n-      foo: () => {\n-        a.b = prop;\n-        b = prop;\n-      },\n-    };\n-  }, [prop]);\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{prop: 1}],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\";\n-\n-import { useImperativeHandle, useRef } from \"react\";\n-\n-const a = { b: 42 };\n-let b = 42;\n-\n-function Component(t0) {\n-  const $ = _c(3);\n-  const { prop } = t0;\n-  const ref = useRef(null);\n-  let t1;\n-  let t2;\n-  if ($[0] !== prop) {\n-    t1 = () => {\n-      a.b = prop;\n-      b = prop;\n-      return {\n-        foo: () => {\n-          a.b = prop;\n-          b = prop;\n-        },\n-      };\n-    };\n-\n-    t2 = [prop];\n-    $[0] = prop;\n-    $[1] = t1;\n-    $[2] = t2;\n-  } else {\n-    t1 = $[1];\n-    t2 = $[2];\n-  }\n-  useImperativeHandle(ref, t1, t2);\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{ prop: 1 }],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) \n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/useImperativeHandle-external-mutate.js",
                "git_diff": "@@ -1,25 +0,0 @@\n-// @flow\n-\n-import {useImperativeHandle, useRef} from 'react';\n-\n-const a = {b: 42};\n-let b = 42;\n-\n-component Component(prop: number) {\n-  const ref = useRef(null);\n-  useImperativeHandle(ref, () => {\n-    a.b = prop;\n-    b = prop;\n-    return {\n-      foo: () => {\n-        a.b = prop;\n-        b = prop;\n-      },\n-    };\n-  }, [prop]);\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{prop: 1}],\n-};"
            }
        ]
    },
    {
        "prompt": "issue: [compiler] Add enablePropagateDepsInHIR flag | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* #30894\n* __->__ #30893\n* #30892\n* #30891\n\nAdding new feature flag in preparation for #30894",
        "completion": [
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts",
                "git_diff": "@@ -222,6 +222,8 @@ const EnvironmentConfigSchema = z.object({\n    */\n   enableUseTypeAnnotations: z.boolean().default(false),\n \n+  enablePropagateDepsInHIR: z.boolean().default(true),\n+\n   /**\n    * Enables inference of optional dependency chains. Without this flag\n    * a property chain such as `props?.items?.foo` will infer as a dep on"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-as-memo-dep.expect.md",
                "git_diff": "@@ -2,7 +2,7 @@\n ## Input\n \n ```javascript\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n function Component(props) {\n   const data = useMemo(() => {\n     return props?.items.edges?.nodes.map();\n@@ -15,7 +15,7 @@ function Component(props) {\n ## Code\n \n ```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n function Component(props) {\n   const $ = _c(4);\n "
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-as-memo-dep.js",
                "git_diff": "@@ -1,4 +1,4 @@\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n function Component(props) {\n   const data = useMemo(() => {\n     return props?.items.edges?.nodes.map();"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-inverted-optionals-parallel-paths.expect.md",
                "git_diff": "@@ -2,7 +2,7 @@\n ## Input\n \n ```javascript\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {\n@@ -19,7 +19,7 @@ function Component(props) {\n ## Code\n \n ```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import { ValidateMemoization } from \"shared-runtime\";\n function Component(props) {\n   const $ = _c(2);"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-inverted-optionals-parallel-paths.js",
                "git_diff": "@@ -1,4 +1,4 @@\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-single-with-unconditional.expect.md",
                "git_diff": "@@ -2,7 +2,7 @@\n ## Input\n \n ```javascript\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {\n@@ -19,7 +19,7 @@ function Component(props) {\n ## Code\n \n ```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import { ValidateMemoization } from \"shared-runtime\";\n function Component(props) {\n   const $ = _c(7);"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-single-with-unconditional.js",
                "git_diff": "@@ -1,4 +1,4 @@\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-single.expect.md",
                "git_diff": "@@ -2,7 +2,7 @@\n ## Input\n \n ```javascript\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {\n@@ -18,7 +18,7 @@ function Component(props) {\n ## Code\n \n ```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import { ValidateMemoization } from \"shared-runtime\";\n function Component(props) {\n   const $ = _c(7);"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-single.js",
                "git_diff": "@@ -1,4 +1,4 @@\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-with-conditional-optional.expect.md",
                "git_diff": "@@ -2,7 +2,7 @@\n ## Input\n \n ```javascript\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {\n@@ -23,7 +23,7 @@ function Component(props) {\n ## Code\n \n ```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import { ValidateMemoization } from \"shared-runtime\";\n function Component(props) {\n   const $ = _c(9);"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-with-conditional-optional.js",
                "git_diff": "@@ -1,4 +1,4 @@\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-with-conditional.expect.md",
                "git_diff": "@@ -2,7 +2,7 @@\n ## Input\n \n ```javascript\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {\n@@ -23,7 +23,7 @@ function Component(props) {\n ## Code\n \n ```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+import { c as _c } from \"react/compiler-runtime\"; // @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import { ValidateMemoization } from \"shared-runtime\";\n function Component(props) {\n   const $ = _c(9);"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/optional-member-expression-with-conditional.js",
                "git_diff": "@@ -1,4 +1,4 @@\n-// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies\n+// @validatePreserveExistingMemoizationGuarantees @enableOptionalDependencies @enablePropagateDepsInHIR:false\n import {ValidateMemoization} from 'shared-runtime';\n function Component(props) {\n   const data = useMemo(() => {"
            }
        ]
    },
    {
        "prompt": "issue: [DevTools] Remove use of .alternate in root and recordProfilingDurations | description: Ideally we shouldn't use the `.alternate` to access previous state because ideally Fibers shouldn't have alternates.\r\n\r\nThe only case it's ok to use it is when it is used to identity the stateful part of a component's identity. In a non-alternate Fiber model there would instead be another object that represents instance but in the current model it's modeled by the pair. \r\n\r\nIt's not ok is to get the previous state of the tree since that would not live on the stateful part.\r\n\r\nWe don't generally need this though because we have the previous state on instance.data before updating it, or passed from above.",
        "completion": [
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -2363,7 +2363,7 @@ export function attach(\n     }\n \n     if (isProfilingSupported) {\n-      recordProfilingDurations(fiberInstance);\n+      recordProfilingDurations(fiberInstance, null);\n     }\n     return fiberInstance;\n   }\n@@ -2929,21 +2929,22 @@ export function attach(\n     removeChild(instance, null);\n   }\n \n-  function recordProfilingDurations(fiberInstance: FiberInstance) {\n+  function recordProfilingDurations(\n+    fiberInstance: FiberInstance,\n+    prevFiber: null | Fiber,\n+  ) {\n     const id = fiberInstance.id;\n     const fiber = fiberInstance.data;\n     const {actualDuration, treeBaseDuration} = fiber;\n \n     fiberInstance.treeBaseDuration = treeBaseDuration || 0;\n \n     if (isProfiling) {\n-      const {alternate} = fiber;\n-\n       // It's important to update treeBaseDuration even if the current Fiber did not render,\n       // because it's possible that one of its descendants did.\n       if (\n-        alternate == null ||\n-        treeBaseDuration !== alternate.treeBaseDuration\n+        prevFiber == null ||\n+        treeBaseDuration !== prevFiber.treeBaseDuration\n       ) {\n         // Tree base duration updates are included in the operations typed array.\n         // So we have to convert them from milliseconds to microseconds so we can send them as ints.\n@@ -2955,7 +2956,7 @@ export function attach(\n         pushOperation(convertedTreeBaseDuration);\n       }\n \n-      if (alternate == null || didFiberRender(alternate, fiber)) {\n+      if (prevFiber == null || didFiberRender(prevFiber, fiber)) {\n         if (actualDuration != null) {\n           // The actual duration reported by React includes time spent working on children.\n           // This is useful information, but it's also useful to be able to exclude child durations.\n@@ -2983,7 +2984,7 @@ export function attach(\n           );\n \n           if (recordChangeDescriptions) {\n-            const changeDescription = getChangeDescription(alternate, fiber);\n+            const changeDescription = getChangeDescription(prevFiber, fiber);\n             if (changeDescription !== null) {\n               if (metadata.changeDescriptions !== null) {\n                 metadata.changeDescriptions.set(id, changeDescription);\n@@ -3306,8 +3307,6 @@ export function attach(\n           // Register the new alternate in case it's not already in.\n           fiberToFiberInstanceMap.set(nextChild, fiberInstance);\n \n-          // Update the Fiber so we that we always keep the current Fiber on the data.\n-          fiberInstance.data = nextChild;\n           moveChild(fiberInstance, previousSiblingOfExistingInstance);\n \n           if (\n@@ -3447,6 +3446,8 @@ export function attach(\n     const stashedPrevious = previouslyReconciledSibling;\n     const stashedRemaining = remainingReconcilingChildren;\n     if (fiberInstance !== null) {\n+      // Update the Fiber so we that we always keep the current Fiber on the data.\n+      fiberInstance.data = nextFiber;\n       if (\n         mostRecentlyInspectedElement !== null &&\n         mostRecentlyInspectedElement.id === fiberInstance.id &&\n@@ -3602,7 +3603,7 @@ export function attach(\n         const isProfilingSupported =\n           nextFiber.hasOwnProperty('treeBaseDuration');\n         if (isProfilingSupported) {\n-          recordProfilingDurations(fiberInstance);\n+          recordProfilingDurations(fiberInstance, prevFiber);\n         }\n       }\n       if (shouldResetChildren) {\n@@ -3673,11 +3674,11 @@ export function attach(\n       // If we have not been profiling, then we can just walk the tree and build up its current state as-is.\n       hook.getFiberRoots(rendererID).forEach(root => {\n         const current = root.current;\n-        const alternate = current.alternate;\n         const newRoot = createFiberInstance(current);\n         rootToFiberInstanceMap.set(root, newRoot);\n         idToDevToolsInstanceMap.set(newRoot.id, newRoot);\n         fiberToFiberInstanceMap.set(current, newRoot);\n+        const alternate = current.alternate;\n         if (alternate) {\n           fiberToFiberInstanceMap.set(alternate, newRoot);\n         }\n@@ -3747,20 +3748,22 @@ export function attach(\n     priorityLevel: void | number,\n   ) {\n     const current = root.current;\n-    const alternate = current.alternate;\n \n+    let prevFiber: null | Fiber = null;\n     let rootInstance = rootToFiberInstanceMap.get(root);\n     if (!rootInstance) {\n       rootInstance = createFiberInstance(current);\n       rootToFiberInstanceMap.set(root, rootInstance);\n       idToDevToolsInstanceMap.set(rootInstance.id, rootInstance);\n       fiberToFiberInstanceMap.set(current, rootInstance);\n+      const alternate = current.alternate;\n       if (alternate) {\n         fiberToFiberInstanceMap.set(alternate, rootInstance);\n       }\n       currentRootID = rootInstance.id;\n     } else {\n       currentRootID = rootInstance.id;\n+      prevFiber = rootInstance.data;\n     }\n \n     // Before the traversals, remember to start tracking\n@@ -3796,13 +3799,13 @@ export function attach(\n       };\n     }\n \n-    if (alternate) {\n+    if (prevFiber !== null) {\n       // TODO: relying on this seems a bit fishy.\n       const wasMounted =\n-        alternate.memoizedState != null &&\n-        alternate.memoizedState.element != null &&\n+        prevFiber.memoizedState != null &&\n+        prevFiber.memoizedState.element != null &&\n         // A dehydrated root is not considered mounted\n-        alternate.memoizedState.isDehydrated !== true;\n+        prevFiber.memoizedState.isDehydrated !== true;\n       const isMounted =\n         current.memoizedState != null &&\n         current.memoizedState.element != null &&\n@@ -3814,7 +3817,7 @@ export function attach(\n         mountFiberRecursively(current, false);\n       } else if (wasMounted && isMounted) {\n         // Update an existing root.\n-        updateFiberRecursively(rootInstance, current, alternate, false);\n+        updateFiberRecursively(rootInstance, current, prevFiber, false);\n       } else if (wasMounted && !isMounted) {\n         // Unmount an existing root.\n         unmountInstanceRecursively(rootInstance);"
            }
        ]
    },
    {
        "prompt": "issue: [DevTools] Build Updater List from the Commit instead of Map | description: Stacked on #30896.\r\n\r\nThe problem with the `getUpdatersList` function is that it iterates over Fibers and then looks up each of those Fibers in the fiberToFiberInstanceMap which we ideally could get rid of.\r\n\r\nHowever, every time an updater comes into play for a commit it must mean that something below the updater itself updated and so the updater will also be cloned which means we'll pass it on the way down when traversing the tree in the commit.\r\n\r\nWhen we do this traversal, we can just look if the Fiber is in the updater set and if so add it to the updater list as we go.\r\n",
        "completion": [
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -1293,11 +1293,11 @@ export function attach(\n           'Expected the root instance to already exist when applying filters',\n         );\n       }\n-      currentRootID = rootInstance.id;\n+      currentRoot = rootInstance;\n       unmountInstanceRecursively(rootInstance);\n       rootToFiberInstanceMap.delete(root);\n       flushPendingEvents(root);\n-      currentRootID = -1;\n+      currentRoot = (null: any);\n     });\n \n     applyComponentFilters(componentFilters);\n@@ -1323,11 +1323,11 @@ export function attach(\n         mightBeOnTrackedPath = true;\n       }\n \n-      currentRootID = newRoot.id;\n-      setRootPseudoKey(currentRootID, root.current);\n+      currentRoot = newRoot;\n+      setRootPseudoKey(currentRoot.id, root.current);\n       mountFiberRecursively(root.current, false);\n       flushPendingEvents(root);\n-      currentRootID = -1;\n+      currentRoot = (null: any);\n     });\n \n     // Also re-evaluate all error and warning counts given the new filters.\n@@ -1528,7 +1528,7 @@ export function attach(\n   }\n \n   // When a mount or update is in progress, this value tracks the root that is being operated on.\n-  let currentRootID: number = -1;\n+  let currentRoot: FiberInstance = (null: any);\n \n   // Returns a FiberInstance if one has already been generated for the Fiber or null if one has not been generated.\n   // Use this method while e.g. logging to avoid over-retaining Fibers.\n@@ -1885,7 +1885,12 @@ export function attach(\n         3 + pendingOperations.length,\n       );\n       operations[0] = rendererID;\n-      operations[1] = currentRootID;\n+      if (currentRoot === null) {\n+        // TODO: This is not always safe so this field is probably not needed.\n+        operations[1] = -1;\n+      } else {\n+        operations[1] = currentRoot.id;\n+      }\n       operations[2] = 0; // String table size\n       for (let j = 0; j < pendingOperations.length; j++) {\n         operations[3 + j] = pendingOperations[j];\n@@ -2038,7 +2043,12 @@ export function attach(\n     // Which in turn enables fiber props, states, and hooks to be inspected.\n     let i = 0;\n     operations[i++] = rendererID;\n-    operations[i++] = currentRootID;\n+    if (currentRoot === null) {\n+      // TODO: This is not always safe so this field is probably not needed.\n+      operations[i++] = -1;\n+    } else {\n+      operations[i++] = currentRoot.id;\n+    }\n \n     // Now fill in the string table.\n     // [stringTableLength, str1Length, ...str1, str2Length, ...str2, ...]\n@@ -3568,8 +3578,8 @@ export function attach(\n         if (alternate) {\n           fiberToFiberInstanceMap.set(alternate, newRoot);\n         }\n-        currentRootID = newRoot.id;\n-        setRootPseudoKey(currentRootID, root.current);\n+        currentRoot = newRoot;\n+        setRootPseudoKey(currentRoot.id, root.current);\n \n         // Handle multi-renderer edge-case where only some v16 renderers support profiling.\n         if (isProfiling && rootSupportsProfiling(root)) {\n@@ -3589,7 +3599,7 @@ export function attach(\n \n         mountFiberRecursively(root.current, false);\n         flushPendingEvents(root);\n-        currentRootID = -1;\n+        currentRoot = (null: any);\n       });\n     }\n   }\n@@ -3646,11 +3656,10 @@ export function attach(\n       if (alternate) {\n         fiberToFiberInstanceMap.set(alternate, rootInstance);\n       }\n-      currentRootID = rootInstance.id;\n     } else {\n-      currentRootID = rootInstance.id;\n       prevFiber = rootInstance.data;\n     }\n+    currentRoot = rootInstance;\n \n     // Before the traversals, remember to start tracking\n     // our path in case we have selection to restore.\n@@ -3699,28 +3708,28 @@ export function attach(\n         current.memoizedState.isDehydrated !== true;\n       if (!wasMounted && isMounted) {\n         // Mount a new root.\n-        setRootPseudoKey(currentRootID, current);\n+        setRootPseudoKey(currentRoot.id, current);\n         mountFiberRecursively(current, false);\n       } else if (wasMounted && isMounted) {\n         // Update an existing root.\n         updateFiberRecursively(rootInstance, current, prevFiber, false);\n       } else if (wasMounted && !isMounted) {\n         // Unmount an existing root.\n         unmountInstanceRecursively(rootInstance);\n-        removeRootPseudoKey(currentRootID);\n+        removeRootPseudoKey(currentRoot.id);\n         rootToFiberInstanceMap.delete(root);\n       }\n     } else {\n       // Mount a new root.\n-      setRootPseudoKey(currentRootID, current);\n+      setRootPseudoKey(currentRoot.id, current);\n       mountFiberRecursively(current, false);\n     }\n \n     if (isProfiling && isProfilingSupported) {\n       if (!shouldBailoutWithPendingOperations()) {\n         const commitProfilingMetadata =\n           ((rootToCommitProfilingMetadataMap: any): CommitProfilingMetadataMap).get(\n-            currentRootID,\n+            currentRoot.id,\n           );\n \n         if (commitProfilingMetadata != null) {\n@@ -3729,7 +3738,7 @@ export function attach(\n           );\n         } else {\n           ((rootToCommitProfilingMetadataMap: any): CommitProfilingMetadataMap).set(\n-            currentRootID,\n+            currentRoot.id,\n             [((currentCommitProfilingMetadata: any): CommitProfilingData)],\n           );\n         }\n@@ -3743,7 +3752,7 @@ export function attach(\n       hook.emit('traceUpdates', traceUpdatesForNodes);\n     }\n \n-    currentRootID = -1;\n+    currentRoot = (null: any);\n   }\n \n   function getResourceInstance(fiber: Fiber): HostInstance | null {"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -2891,6 +2891,25 @@ export function attach(\n           }\n         }\n       }\n+\n+      // If this Fiber was in the set of memoizedUpdaters we need to record\n+      // it to be included in the description of the commit.\n+      const fiberRoot: FiberRoot = currentRoot.data.stateNode;\n+      const updaters = fiberRoot.memoizedUpdaters;\n+      if (\n+        updaters != null &&\n+        (updaters.has(fiber) ||\n+          // We check the alternate here because we're matching identity and\n+          // prevFiber might be same as fiber.\n+          (fiber.alternate !== null && updaters.has(fiber.alternate)))\n+      ) {\n+        const metadata =\n+          ((currentCommitProfilingMetadata: any): CommitProfilingData);\n+        if (metadata.updaters === null) {\n+          metadata.updaters = [];\n+        }\n+        metadata.updaters.push(instanceToSerializedElement(fiberInstance));\n+      }\n     }\n   }\n \n@@ -3591,35 +3610,20 @@ export function attach(\n             commitTime: getCurrentTime() - profilingStartTime,\n             maxActualDuration: 0,\n             priorityLevel: null,\n-            updaters: getUpdatersList(root),\n+            updaters: null,\n             effectDuration: null,\n             passiveEffectDuration: null,\n           };\n         }\n \n         mountFiberRecursively(root.current, false);\n+\n         flushPendingEvents(root);\n         currentRoot = (null: any);\n       });\n     }\n   }\n \n-  function getUpdatersList(root: any): Array<SerializedElement> | null {\n-    const updaters = root.memoizedUpdaters;\n-    if (updaters == null) {\n-      return null;\n-    }\n-    const result = [];\n-    // eslint-disable-next-line no-for-of-loops/no-for-of-loops\n-    for (const updater of updaters) {\n-      const inst = getFiberInstanceUnsafe(updater);\n-      if (inst !== null) {\n-        result.push(instanceToSerializedElement(inst));\n-      }\n-    }\n-    return result;\n-  }\n-\n   function handleCommitFiberUnmount(fiber: any) {\n     // This Hook is no longer used. After having shipped DevTools everywhere it is\n     // safe to stop calling it from Fiber.\n@@ -3684,9 +3688,7 @@ export function attach(\n         maxActualDuration: 0,\n         priorityLevel:\n           priorityLevel == null ? null : formatPriorityLevel(priorityLevel),\n-\n-        updaters: getUpdatersList(root),\n-\n+        updaters: null,\n         // Initialize to null; if new enough React version is running,\n         // these values will be read during separate handlePostCommitFiberRoot() call.\n         effectDuration: null,"
            }
        ]
    },
    {
        "prompt": "issue: [compiler][cleanup] Delete now-unused reactive scope fork | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* #30894\n* #30893\n* __->__ #30892\n* #30891\n\nFollowup to #30891",
        "completion": [
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/HIR.ts",
                "git_diff": "@@ -1492,6 +1492,7 @@ export type ReactiveScopeDeclaration = {\n   scope: ReactiveScope; // the scope in which the variable was originally declared\n };\n \n+export type DependencyPath = Array<{property: string; optional: boolean}>;\n export type ReactiveScopeDependency = {\n   identifier: Identifier;\n   path: DependencyPath;\n@@ -1506,7 +1507,21 @@ export function areEqualPaths(a: DependencyPath, b: DependencyPath): boolean {\n     )\n   );\n }\n-export type DependencyPath = Array<{property: string; optional: boolean}>;\n+\n+export function getPlaceScope(\n+  id: InstructionId,\n+  place: Place,\n+): ReactiveScope | null {\n+  const scope = place.identifier.scope;\n+  if (scope !== null && isScopeActive(scope, id)) {\n+    return scope;\n+  }\n+  return null;\n+}\n+\n+function isScopeActive(scope: ReactiveScope, id: InstructionId): boolean {\n+  return id >= scope.range.start && id < scope.range.end;\n+}\n \n /*\n  * Simulated opaque type for BlockIds to prevent using normal numbers as block ids"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/MergeOverlappingReactiveScopesHIR.ts",
                "git_diff": "@@ -5,7 +5,7 @@ import {\n   ReactiveScope,\n   makeInstructionId,\n } from '.';\n-import {getPlaceScope} from '../ReactiveScopes/BuildReactiveBlocks';\n+import {getPlaceScope} from '../HIR/HIR';\n import {isMutable} from '../ReactiveScopes/InferReactiveScopeVariables';\n import DisjointSet from '../Utils/DisjointSet';\n import {getOrInsertDefault} from '../Utils/utils';"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/AlignReactiveScopesToBlockScopes.ts",
                "git_diff": "@@ -1,187 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- */\n-\n-import {\n-  InstructionId,\n-  Place,\n-  ReactiveBlock,\n-  ReactiveFunction,\n-  ReactiveInstruction,\n-  ReactiveScope,\n-  ScopeId,\n-  makeInstructionId,\n-} from '../HIR/HIR';\n-import {getPlaceScope} from './BuildReactiveBlocks';\n-import {ReactiveFunctionVisitor, visitReactiveFunction} from './visitors';\n-\n-/*\n- * Note: this is the 2nd of 4 passes that determine how to break a function into discrete\n- * reactive scopes (independently memoizeable units of code):\n- * 1. InferReactiveScopeVariables (on HIR) determines operands that mutate together and assigns\n- *     them a unique reactive scope.\n- * 2. AlignReactiveScopesToBlockScopes (this pass, on ReactiveFunction) aligns reactive scopes\n- *     to block scopes.\n- * 3. MergeOverlappingReactiveScopes (on ReactiveFunction) ensures that reactive scopes do not\n- *     overlap, merging any such scopes.\n- * 4. BuildReactiveBlocks (on ReactiveFunction) groups the statements for each scope into\n- *     a ReactiveScopeBlock.\n- *\n- * Prior inference passes assign a reactive scope to each operand, but the ranges of these\n- * scopes are based on specific instructions at arbitrary points in the control-flow graph.\n- * However, to codegen blocks around the instructions in each scope, the scopes must be\n- * aligned to block-scope boundaries - we can't memoize half of a loop!\n- *\n- * This pass updates reactive scope boundaries to align to control flow boundaries, for\n- * example:\n- *\n- * ```javascript\n- * function foo(cond, a) {\n- *                     \u2335 original scope\n- *                          \u2335 expanded scope\n- *    const x = [];    \u231d    \u231d\n- *    if (cond) {      \u23ae    \u23ae\n- *      ...            \u23ae    \u23ae\n- *      x.push(a);     \u231f    \u23ae\n- *      ...                 \u23ae\n- *    }                     \u231f\n- * }\n- * ```\n- *\n- * Here the original scope for `x` ended partway through the if consequent, but we can't\n- * memoize part of that block. This pass would align the scope to the end of the consequent.\n- *\n- * The more general rule is that a reactive scope may only end at the same block scope as it\n- * began: this pass therefore finds, for each scope, the block where that scope started and\n- * finds the first instruction after the scope's mutable range in that same block scope (which\n- * will be the updated end for that scope).\n- */\n-\n-export function alignReactiveScopesToBlockScopes(fn: ReactiveFunction): void {\n-  const context = new Context();\n-  visitReactiveFunction(fn, new Visitor(), context);\n-}\n-\n-class Visitor extends ReactiveFunctionVisitor<Context> {\n-  override visitID(id: InstructionId, state: Context): void {\n-    state.visitId(id);\n-  }\n-  override visitPlace(id: InstructionId, place: Place, state: Context): void {\n-    const scope = getPlaceScope(id, place);\n-    if (scope !== null) {\n-      state.visitScope(scope);\n-    }\n-  }\n-  override visitLValue(id: InstructionId, lvalue: Place, state: Context): void {\n-    const scope = getPlaceScope(id, lvalue);\n-    if (scope !== null) {\n-      state.visitScope(scope);\n-    }\n-  }\n-\n-  override visitInstruction(instr: ReactiveInstruction, state: Context): void {\n-    switch (instr.value.kind) {\n-      case 'OptionalExpression':\n-      case 'SequenceExpression':\n-      case 'ConditionalExpression':\n-      case 'LogicalExpression': {\n-        const prevScopeCount = state.currentScopes().length;\n-        this.traverseInstruction(instr, state);\n-\n-        /**\n-         * These compound value types can have nested sequences of instructions\n-         * with scopes that start \"partway\" through a block-level instruction.\n-         * This would cause the start of the scope to not align with any block-level\n-         * instruction and get skipped by the later BuildReactiveBlocks pass.\n-         *\n-         * Here we detect scopes created within compound instructions and align the\n-         * start of these scopes to the outer instruction id to ensure the scopes\n-         * aren't skipped.\n-         */\n-        const scopes = state.currentScopes();\n-        for (let i = prevScopeCount; i < scopes.length; i++) {\n-          const scope = scopes[i];\n-          scope.scope.range.start = makeInstructionId(\n-            Math.min(instr.id, scope.scope.range.start),\n-          );\n-        }\n-        break;\n-      }\n-      default: {\n-        this.traverseInstruction(instr, state);\n-      }\n-    }\n-  }\n-\n-  override visitBlock(block: ReactiveBlock, state: Context): void {\n-    state.enter(() => {\n-      this.traverseBlock(block, state);\n-    });\n-  }\n-}\n-\n-type PendingReactiveScope = {active: boolean; scope: ReactiveScope};\n-\n-class Context {\n-  /*\n-   * For each block scope (outer array) stores a list of ReactiveScopes that start\n-   * in that block scope.\n-   */\n-  #blockScopes: Array<Array<PendingReactiveScope>> = [];\n-\n-  /*\n-   * ReactiveScopes whose declaring block scope has ended but may still need to\n-   * be \"closed\" (ie have their range.end be updated). A given scope can be in\n-   * blockScopes OR this array but not both.\n-   */\n-  #unclosedScopes: Array<PendingReactiveScope> = [];\n-\n-  /*\n-   * Set of all scope ids that have been seen so far, regardless of which of\n-   * the above data structures they're in, to avoid tracking the same scope twice.\n-   */\n-  #seenScopes: Set<ScopeId> = new Set();\n-\n-  currentScopes(): Array<PendingReactiveScope> {\n-    return this.#blockScopes.at(-1) ?? [];\n-  }\n-\n-  enter(fn: () => void): void {\n-    this.#blockScopes.push([]);\n-    fn();\n-    const lastScope = this.#blockScopes.pop()!;\n-    for (const scope of lastScope) {\n-      if (scope.active) {\n-        this.#unclosedScopes.push(scope);\n-      }\n-    }\n-  }\n-\n-  visitId(id: InstructionId): void {\n-    const currentScopes = this.#blockScopes.at(-1)!;\n-    const scopes = [...currentScopes, ...this.#unclosedScopes];\n-    for (const pending of scopes) {\n-      if (!pending.active) {\n-        continue;\n-      }\n-      if (id >= pending.scope.range.end) {\n-        pending.active = false;\n-        pending.scope.range.end = id;\n-      }\n-    }\n-  }\n-\n-  visitScope(scope: ReactiveScope): void {\n-    if (!this.#seenScopes.has(scope.id)) {\n-      const currentScopes = this.#blockScopes.at(-1)!;\n-      this.#seenScopes.add(scope.id);\n-      currentScopes.push({\n-        active: true,\n-        scope,\n-      });\n-    }\n-  }\n-}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/AlignReactiveScopesToBlockScopesHIR.ts",
                "git_diff": "@@ -13,6 +13,7 @@ import {\n   MutableRange,\n   Place,\n   ReactiveScope,\n+  getPlaceScope,\n   makeInstructionId,\n } from '../HIR/HIR';\n import {\n@@ -23,7 +24,6 @@ import {\n   terminalFallthrough,\n } from '../HIR/visitors';\n import {retainWhere_Set} from '../Utils/utils';\n-import {getPlaceScope} from './BuildReactiveBlocks';\n \n type InstructionRange = MutableRange;\n /*"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/AssertScopeInstructionsWithinScope.ts",
                "git_diff": "@@ -14,7 +14,7 @@ import {\n   ReactiveScopeBlock,\n   ScopeId,\n } from '../HIR';\n-import {getPlaceScope} from './BuildReactiveBlocks';\n+import {getPlaceScope} from '../HIR/HIR';\n import {ReactiveFunctionVisitor} from './visitors';\n \n /*"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/BuildReactiveBlocks.ts",
                "git_diff": "@@ -1,244 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- */\n-\n-import {CompilerError} from '../CompilerError';\n-import {\n-  BlockId,\n-  InstructionId,\n-  Place,\n-  ReactiveBlock,\n-  ReactiveFunction,\n-  ReactiveInstruction,\n-  ReactiveScope,\n-  ReactiveScopeBlock,\n-  ReactiveStatement,\n-  ScopeId,\n-} from '../HIR';\n-import {eachInstructionLValue} from '../HIR/visitors';\n-import {assertExhaustive} from '../Utils/utils';\n-import {eachReactiveValueOperand, mapTerminalBlocks} from './visitors';\n-\n-/*\n- * Note: this is the 4th of 4 passes that determine how to break a function into discrete\n- * reactive scopes (independently memoizeable units of code):\n- * 1. InferReactiveScopeVariables (on HIR) determines operands that mutate together and assigns\n- *     them a unique reactive scope.\n- * 2. AlignReactiveScopesToBlockScopes (on ReactiveFunction) aligns reactive scopes\n- *     to block scopes.\n- * 3. MergeOverlappingReactiveScopes (this pass, on ReactiveFunction) ensures that reactive\n- *     scopes do not overlap, merging any such scopes.\n- * 4. BuildReactiveBlocks (on ReactiveFunction) groups the statements for each scope into\n- *     a ReactiveScopeBlock.\n- *\n- * Given a function where the reactive scopes have been correctly aligned and merged,\n- * this pass groups the instructions for each reactive scope into ReactiveBlocks.\n- */\n-export function buildReactiveBlocks(fn: ReactiveFunction): void {\n-  const context = new Context();\n-  fn.body = context.enter(() => {\n-    visitBlock(context, fn.body);\n-  });\n-}\n-\n-class Context {\n-  #builders: Array<Builder> = [];\n-  #scopes: Set<ScopeId> = new Set();\n-\n-  visitId(id: InstructionId): void {\n-    const builder = this.#builders.at(-1)!;\n-    builder.visitId(id);\n-  }\n-\n-  visitScope(scope: ReactiveScope): void {\n-    if (this.#scopes.has(scope.id)) {\n-      return;\n-    }\n-    this.#scopes.add(scope.id);\n-    this.#builders.at(-1)!.startScope(scope);\n-  }\n-\n-  append(\n-    stmt: ReactiveStatement,\n-    label: {id: BlockId; implicit: boolean} | null,\n-  ): void {\n-    this.#builders.at(-1)!.append(stmt, label);\n-  }\n-\n-  enter(fn: () => void): ReactiveBlock {\n-    const builder = new Builder();\n-    this.#builders.push(builder);\n-    fn();\n-    const popped = this.#builders.pop();\n-    CompilerError.invariant(popped === builder, {\n-      reason: 'Expected push/pop to be called 1:1',\n-      description: null,\n-      loc: null,\n-      suggestions: null,\n-    });\n-    return builder.complete();\n-  }\n-}\n-\n-class Builder {\n-  #instructions: ReactiveBlock;\n-  #stack: Array<\n-    | {kind: 'scope'; block: ReactiveScopeBlock}\n-    | {kind: 'block'; block: ReactiveBlock}\n-  >;\n-\n-  constructor() {\n-    const block: ReactiveBlock = [];\n-    this.#instructions = block;\n-    this.#stack = [{kind: 'block', block}];\n-  }\n-\n-  append(\n-    item: ReactiveStatement,\n-    label: {id: BlockId; implicit: boolean} | null,\n-  ): void {\n-    if (label !== null) {\n-      CompilerError.invariant(item.kind === 'terminal', {\n-        reason: 'Only terminals may have a label',\n-        description: null,\n-        loc: null,\n-        suggestions: null,\n-      });\n-      item.label = label;\n-    }\n-    this.#instructions.push(item);\n-  }\n-\n-  startScope(scope: ReactiveScope): void {\n-    const block: ReactiveScopeBlock = {\n-      kind: 'scope',\n-      scope,\n-      instructions: [],\n-    };\n-    this.append(block, null);\n-    this.#instructions = block.instructions;\n-    this.#stack.push({kind: 'scope', block});\n-  }\n-\n-  visitId(id: InstructionId): void {\n-    for (let i = 0; i < this.#stack.length; i++) {\n-      const entry = this.#stack[i]!;\n-      if (entry.kind === 'scope' && id >= entry.block.scope.range.end) {\n-        this.#stack.length = i;\n-        break;\n-      }\n-    }\n-    const last = this.#stack[this.#stack.length - 1]!;\n-    if (last.kind === 'block') {\n-      this.#instructions = last.block;\n-    } else {\n-      this.#instructions = last.block.instructions;\n-    }\n-  }\n-\n-  complete(): ReactiveBlock {\n-    /*\n-     * TODO: @josephsavona debug violations of this invariant\n-     * invariant(\n-     *   this.#stack.length === 1,\n-     *   \"Expected all scopes to be closed when exiting a block\"\n-     * );\n-     */\n-    const first = this.#stack[0]!;\n-    CompilerError.invariant(first.kind === 'block', {\n-      reason: 'Expected first stack item to be a basic block',\n-      description: null,\n-      loc: null,\n-      suggestions: null,\n-    });\n-    return first.block;\n-  }\n-}\n-\n-function visitBlock(context: Context, block: ReactiveBlock): void {\n-  for (const stmt of block) {\n-    switch (stmt.kind) {\n-      case 'instruction': {\n-        context.visitId(stmt.instruction.id);\n-        const scope = getInstructionScope(stmt.instruction);\n-        if (scope !== null) {\n-          context.visitScope(scope);\n-        }\n-        context.append(stmt, null);\n-        break;\n-      }\n-      case 'terminal': {\n-        const id = stmt.terminal.id;\n-        if (id !== null) {\n-          context.visitId(id);\n-        }\n-        mapTerminalBlocks(stmt.terminal, block => {\n-          return context.enter(() => {\n-            visitBlock(context, block);\n-          });\n-        });\n-        context.append(stmt, stmt.label);\n-        break;\n-      }\n-      case 'pruned-scope':\n-      case 'scope': {\n-        CompilerError.invariant(false, {\n-          reason: 'Expected the function to not have scopes already assigned',\n-          description: null,\n-          loc: null,\n-          suggestions: null,\n-        });\n-      }\n-      default: {\n-        assertExhaustive(\n-          stmt,\n-          `Unexpected statement kind \\`${(stmt as any).kind}\\``,\n-        );\n-      }\n-    }\n-  }\n-}\n-\n-export function getInstructionScope(\n-  instr: ReactiveInstruction,\n-): ReactiveScope | null {\n-  CompilerError.invariant(instr.lvalue !== null, {\n-    reason:\n-      'Expected lvalues to not be null when assigning scopes. ' +\n-      'Pruning lvalues too early can result in missing scope information.',\n-    description: null,\n-    loc: instr.loc,\n-    suggestions: null,\n-  });\n-  for (const operand of eachInstructionLValue(instr)) {\n-    const operandScope = getPlaceScope(instr.id, operand);\n-    if (operandScope !== null) {\n-      return operandScope;\n-    }\n-  }\n-  for (const operand of eachReactiveValueOperand(instr.value)) {\n-    const operandScope = getPlaceScope(instr.id, operand);\n-    if (operandScope !== null) {\n-      return operandScope;\n-    }\n-  }\n-  return null;\n-}\n-\n-export function getPlaceScope(\n-  id: InstructionId,\n-  place: Place,\n-): ReactiveScope | null {\n-  const scope = place.identifier.scope;\n-  if (scope !== null && isScopeActive(scope, id)) {\n-    return scope;\n-  }\n-  return null;\n-}\n-\n-function isScopeActive(scope: ReactiveScope, id: InstructionId): boolean {\n-  return id >= scope.range.start && id < scope.range.end;\n-}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/FlattenReactiveLoops.ts",
                "git_diff": "@@ -1,84 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- */\n-\n-import {\n-  ReactiveFunction,\n-  ReactiveScopeBlock,\n-  ReactiveStatement,\n-  ReactiveTerminal,\n-  ReactiveTerminalStatement,\n-} from '../HIR/HIR';\n-import {assertExhaustive} from '../Utils/utils';\n-import {\n-  ReactiveFunctionTransform,\n-  Transformed,\n-  visitReactiveFunction,\n-} from './visitors';\n-\n-/*\n- * Given a reactive function, flattens any scopes contained within a loop construct.\n- * We won't initially support memoization within loops though this is possible in the future.\n- */\n-export function flattenReactiveLoops(fn: ReactiveFunction): void {\n-  visitReactiveFunction(fn, new Transform(), false);\n-}\n-\n-class Transform extends ReactiveFunctionTransform<boolean> {\n-  override transformScope(\n-    scope: ReactiveScopeBlock,\n-    isWithinLoop: boolean,\n-  ): Transformed<ReactiveStatement> {\n-    this.visitScope(scope, isWithinLoop);\n-    if (isWithinLoop) {\n-      return {\n-        kind: 'replace',\n-        value: {\n-          kind: 'pruned-scope',\n-          scope: scope.scope,\n-          instructions: scope.instructions,\n-        },\n-      };\n-    } else {\n-      return {kind: 'keep'};\n-    }\n-  }\n-\n-  override visitTerminal(\n-    stmt: ReactiveTerminalStatement<ReactiveTerminal>,\n-    isWithinLoop: boolean,\n-  ): void {\n-    switch (stmt.terminal.kind) {\n-      // Loop terminals flatten nested scopes\n-      case 'do-while':\n-      case 'while':\n-      case 'for':\n-      case 'for-of':\n-      case 'for-in': {\n-        this.traverseTerminal(stmt, true);\n-        break;\n-      }\n-      // Non-loop terminals passthrough is contextual, inherits the parent isWithinScope\n-      case 'try':\n-      case 'label':\n-      case 'break':\n-      case 'continue':\n-      case 'if':\n-      case 'return':\n-      case 'switch':\n-      case 'throw': {\n-        this.traverseTerminal(stmt, isWithinLoop);\n-        break;\n-      }\n-      default: {\n-        assertExhaustive(\n-          stmt.terminal,\n-          `Unexpected terminal kind \\`${(stmt.terminal as any).kind}\\``,\n-        );\n-      }\n-    }\n-  }\n-}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/FlattenScopesWithHooksOrUse.ts",
                "git_diff": "@@ -1,123 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- */\n-\n-import {\n-  Environment,\n-  InstructionId,\n-  ReactiveFunction,\n-  ReactiveScopeBlock,\n-  ReactiveStatement,\n-  ReactiveValue,\n-  getHookKind,\n-  isUseOperator,\n-} from '../HIR';\n-import {\n-  ReactiveFunctionTransform,\n-  Transformed,\n-  visitReactiveFunction,\n-} from './visitors';\n-\n-/**\n- * For simplicity the majority of compiler passes do not treat hooks specially. However, hooks are different\n- * from regular functions in two key ways:\n- * - They can introduce reactivity even when their arguments are non-reactive (accounted for in InferReactivePlaces)\n- * - They cannot be called conditionally\n- *\n- * The `use` operator is similar:\n- * - It can access context, and therefore introduce reactivity\n- * - It can be called conditionally, but _it must be called if the component needs the return value_. This is because\n- *   React uses the fact that use was called to remember that the component needs the value, and that changes to the\n- *   input should invalidate the component itself.\n- *\n- * This pass accounts for the \"can't call conditionally\" aspect of both hooks and use. Though the reasoning is slightly\n- * different for reach, the result is that we can't memoize scopes that call hooks or use since this would make them\n- * called conditionally in the output.\n- *\n- * The pass finds and removes any scopes that transitively contain a hook or use call. By running all\n- * the reactive scope inference first, agnostic of hooks, we know that the reactive scopes accurately\n- * describe the set of values which \"construct together\", and remove _all_ that memoization in order\n- * to ensure the hook call does not inadvertently become conditional.\n- */\n-export function flattenScopesWithHooksOrUse(fn: ReactiveFunction): void {\n-  visitReactiveFunction(fn, new Transform(), {\n-    env: fn.env,\n-    hasHook: false,\n-  });\n-}\n-\n-type State = {\n-  env: Environment;\n-  hasHook: boolean;\n-};\n-\n-class Transform extends ReactiveFunctionTransform<State> {\n-  override transformScope(\n-    scope: ReactiveScopeBlock,\n-    outerState: State,\n-  ): Transformed<ReactiveStatement> {\n-    const innerState: State = {\n-      env: outerState.env,\n-      hasHook: false,\n-    };\n-    this.visitScope(scope, innerState);\n-    outerState.hasHook ||= innerState.hasHook;\n-    if (innerState.hasHook) {\n-      if (scope.instructions.length === 1) {\n-        /*\n-         * This was a scope just for a hook call, which doesn't need memoization.\n-         * flatten it away\n-         */\n-        return {\n-          kind: 'replace-many',\n-          value: scope.instructions,\n-        };\n-      }\n-      /*\n-       * else this scope had multiple instructions and produced some other value:\n-       * mark it as pruned\n-       */\n-      return {\n-        kind: 'replace',\n-        value: {\n-          kind: 'pruned-scope',\n-          scope: scope.scope,\n-          instructions: scope.instructions,\n-        },\n-      };\n-    } else {\n-      return {kind: 'keep'};\n-    }\n-  }\n-\n-  override visitValue(\n-    id: InstructionId,\n-    value: ReactiveValue,\n-    state: State,\n-  ): void {\n-    this.traverseValue(id, value, state);\n-    switch (value.kind) {\n-      case 'CallExpression': {\n-        if (\n-          getHookKind(state.env, value.callee.identifier) != null ||\n-          isUseOperator(value.callee.identifier)\n-        ) {\n-          state.hasHook = true;\n-        }\n-        break;\n-      }\n-      case 'MethodCall': {\n-        if (\n-          getHookKind(state.env, value.property.identifier) != null ||\n-          isUseOperator(value.property.identifier)\n-        ) {\n-          state.hasHook = true;\n-        }\n-        break;\n-      }\n-    }\n-  }\n-}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/MergeOverlappingReactiveScopes.ts",
                "git_diff": "@@ -1,281 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- */\n-\n-import {\n-  InstructionId,\n-  makeInstructionId,\n-  Place,\n-  ReactiveBlock,\n-  ReactiveFunction,\n-  ReactiveInstruction,\n-  ReactiveScope,\n-  ScopeId,\n-} from '../HIR';\n-import DisjointSet from '../Utils/DisjointSet';\n-import {retainWhere} from '../Utils/utils';\n-import {getPlaceScope} from './BuildReactiveBlocks';\n-import {ReactiveFunctionVisitor, visitReactiveFunction} from './visitors';\n-\n-/*\n- * Note: this is the 3rd of 4 passes that determine how to break a function into discrete\n- * reactive scopes (independently memoizeable units of code):\n- * 1. InferReactiveScopeVariables (on HIR) determines operands that mutate together and assigns\n- *     them a unique reactive scope.\n- * 2. AlignReactiveScopesToBlockScopes (on ReactiveFunction) aligns reactive scopes\n- *     to block scopes.\n- * 3. MergeOverlappingReactiveScopes (this pass, on ReactiveFunction) ensures that reactive\n- *     scopes do not overlap, merging any such scopes.\n- * 4. BuildReactiveBlocks (on ReactiveFunction) groups the statements for each scope into\n- *     a ReactiveScopeBlock.\n- *\n- * Previous passes may leave \"overlapping\" scopes, ie where one or more instructions are within\n- * the mutable range of multiple reactive scopes. We prefer to avoid executing instructions twice\n- * for performance reasons (side effects are less of a concern bc components are required to be\n- * idempotent), so we cannot simply repeat the instruction once for each scope. Instead, the only\n- * option is to combine the two scopes into one. This is an area where an eventual Forget IDE\n- * could provide real-time feedback to the developer that two computations are accidentally merged.\n- *\n- * ## Detailed Walkthrough\n- *\n- * Two scopes overlap if there is one or more instruction that is inside the range\n- * of both scopes. In general, overlapping scopes are merged togther. The only\n- * exception to this is when one scope *shadows* another scope. For example:\n- *\n- * ```javascript\n- * function foo(cond, a) {\n- *                                  \u2335 scope for x\n- *    let x = [];                   \u231d\n- *    if (cond) {                   \u23ae\n- *                    \u2335 scope for y \u23ae\n- *      let y = [];   \u231d             \u23ae\n- *      if (b) {      \u23ae             \u23ae\n- *        y.push(b);  \u231f             \u23ae\n- *      }                           \u23ae\n- *      x.push(<div>{y}</div>);     \u23ae\n- *    }                             \u231f\n- * }\n- * ```\n- *\n- * In this example the two scopes overlap, but mutation of the two scopes is not\n- * interleaved. Specifically within the y scope there are no instructions that\n- * modify any other scope: the inner scope \"shadows\" the outer one. This category\n- * of overlap does *NOT* merge the scopes together.\n- *\n- * The implementation is inspired by the Rust notion of \"stacked borrows\". We traverse\n- * the control-flow graph in tree form, at each point keeping track of which scopes are\n- * active. So initially we see\n- *\n- * `let x = []`\n- * active scopes: [x]\n- *\n- * and mark the x scope as active.\n- *\n- * Then we later encounter\n- *\n- * `let y = [];`\n- * active scopes: [x, y]\n- *\n- * Here we first check to see if 'y' is already in the list of active scopes. It isn't,\n- * so we push it to the stop of the stack.\n- *\n- * Then\n- *\n- * `y.push(b)`\n- * active scopes: [x, y]\n- *\n- * Mutates y, so we check if y is the top of the stack. It is, so no merging must occur.\n- *\n- * If instead we saw eg\n- *\n- * `x.push(b)`\n- * active scopes: [x, y]\n- *\n- * Then we would see that 'x' is active, but that it is shadowed. The two scopes would have\n- * to be merged.\n- */\n-export function mergeOverlappingReactiveScopes(fn: ReactiveFunction): void {\n-  const context = new Context();\n-  visitReactiveFunction(fn, new Visitor(), context);\n-  context.complete();\n-}\n-\n-class Visitor extends ReactiveFunctionVisitor<Context> {\n-  override visitID(id: InstructionId, state: Context): void {\n-    state.visitId(id);\n-  }\n-  override visitPlace(id: InstructionId, place: Place, state: Context): void {\n-    state.visitPlace(id, place);\n-  }\n-  override visitLValue(id: InstructionId, lvalue: Place, state: Context): void {\n-    state.visitPlace(id, lvalue);\n-  }\n-  override visitBlock(block: ReactiveBlock, state: Context): void {\n-    state.enter(() => {\n-      this.traverseBlock(block, state);\n-    });\n-  }\n-  override visitInstruction(\n-    instruction: ReactiveInstruction,\n-    state: Context,\n-  ): void {\n-    if (\n-      instruction.value.kind === 'ConditionalExpression' ||\n-      instruction.value.kind === 'LogicalExpression' ||\n-      instruction.value.kind === 'OptionalExpression'\n-    ) {\n-      state.enter(() => {\n-        super.visitInstruction(instruction, state);\n-      });\n-    } else {\n-      super.visitInstruction(instruction, state);\n-    }\n-  }\n-}\n-\n-class BlockScope {\n-  seen: Set<ScopeId> = new Set();\n-  scopes: Array<ShadowableReactiveScope> = [];\n-}\n-\n-type ShadowableReactiveScope = {\n-  scope: ReactiveScope;\n-  shadowedBy: ReactiveScope | null;\n-};\n-\n-class Context {\n-  scopes: Array<BlockScope> = [];\n-  seenScopes: Set<ScopeId> = new Set();\n-  joinedScopes: DisjointSet<ReactiveScope> = new DisjointSet();\n-  operandScopes: Map<Place, ReactiveScope> = new Map();\n-\n-  visitId(id: InstructionId): void {\n-    const currentBlock = this.scopes[this.scopes.length - 1]!;\n-    retainWhere(currentBlock.scopes, pending => {\n-      if (pending.scope.range.end > id) {\n-        return true;\n-      } else {\n-        currentBlock.seen.delete(pending.scope.id);\n-        return false;\n-      }\n-    });\n-  }\n-\n-  visitPlace(id: InstructionId, place: Place): void {\n-    const scope = getPlaceScope(id, place);\n-    if (scope === null) {\n-      return;\n-    }\n-    this.operandScopes.set(place, scope);\n-    const currentBlock = this.scopes[this.scopes.length - 1]!;\n-    // Fast-path for the first time we see a new scope\n-    if (!this.seenScopes.has(scope.id)) {\n-      this.seenScopes.add(scope.id);\n-      currentBlock.seen.add(scope.id);\n-      currentBlock.scopes.push({shadowedBy: null, scope});\n-      return;\n-    }\n-    // Scope has already been seen, find it in the current block or a parent\n-    let index = this.scopes.length - 1;\n-    let nextBlock = currentBlock;\n-    while (!nextBlock.seen.has(scope.id)) {\n-      /*\n-       * scopes that cross control-flow boundaries are merged with overlapping\n-       * scopes\n-       */\n-      this.joinedScopes.union([scope, ...nextBlock.scopes.map(s => s.scope)]);\n-      index--;\n-      if (index < 0) {\n-        /*\n-         * TODO: handle reassignments in multiple branches. these create new identifiers that\n-         * add an entry to this.seenScopes but which are then removed when their blocks exit.\n-         * this is also wrong for codegen, different versions of an identifier could be cached\n-         * differently and so a reassigned version of a variable needs a separate declaration.\n-         * console.log(`scope ${scope.id} not found`);\n-         */\n-\n-        /*\n-         * for (let i = this.scopes.length - 1; i > index; i--) {\n-         *   const s = this.scopes[i];\n-         *   console.log(\n-         *     JSON.stringify(\n-         *       {\n-         *         seen: Array.from(s.seen),\n-         *         scopes: s.scopes,\n-         *       },\n-         *       null,\n-         *       2\n-         *     )\n-         *   );\n-         * }\n-         */\n-        currentBlock.seen.add(scope.id);\n-        currentBlock.scopes.push({shadowedBy: null, scope});\n-        return;\n-      }\n-      nextBlock = this.scopes[index]!;\n-    }\n-\n-    // Handle interleaving within a given block scope\n-    let found = false;\n-    for (let i = 0; i < nextBlock.scopes.length; i++) {\n-      const current = nextBlock.scopes[i]!;\n-      if (current.scope.id === scope.id) {\n-        found = true;\n-        if (current.shadowedBy !== null) {\n-          this.joinedScopes.union([current.shadowedBy, current.scope]);\n-        }\n-      } else if (found && current.shadowedBy === null) {\n-        // `scope` is shadowing `current` and may interleave\n-        current.shadowedBy = scope;\n-        if (current.scope.range.end > scope.range.end) {\n-          /*\n-           * Current is shadowed by `scope`, and we know that `current` will mutate\n-           * again (per its range), so the scopes are already known to interleave.\n-           *\n-           * Eagerly extend the ranges of the scopes so that we don't prematurely end\n-           * a scope relative to its eventual post-merge mutable range\n-           */\n-          const end = makeInstructionId(\n-            Math.max(current.scope.range.end, scope.range.end),\n-          );\n-          current.scope.range.end = end;\n-          scope.range.end = end;\n-          this.joinedScopes.union([current.scope, scope]);\n-        }\n-      }\n-    }\n-    if (!currentBlock.seen.has(scope.id)) {\n-      currentBlock.seen.add(scope.id);\n-      currentBlock.scopes.push({shadowedBy: null, scope});\n-    }\n-  }\n-\n-  enter(fn: () => void): void {\n-    this.scopes.push(new BlockScope());\n-    fn();\n-    this.scopes.pop();\n-  }\n-\n-  complete(): void {\n-    this.joinedScopes.forEach((scope, groupScope) => {\n-      if (scope !== groupScope) {\n-        groupScope.range.start = makeInstructionId(\n-          Math.min(groupScope.range.start, scope.range.start),\n-        );\n-        groupScope.range.end = makeInstructionId(\n-          Math.max(groupScope.range.end, scope.range.end),\n-        );\n-      }\n-    });\n-    for (const [operand, originalScope] of this.operandScopes) {\n-      const mergedScope = this.joinedScopes.find(originalScope);\n-      if (mergedScope !== null) {\n-        operand.identifier.scope = mergedScope;\n-      }\n-    }\n-  }\n-}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/PruneNonEscapingScopes.ts",
                "git_diff": "@@ -26,7 +26,7 @@ import {\n } from '../HIR';\n import {getFunctionCallSignature} from '../Inference/InferReferenceEffects';\n import {assertExhaustive, getOrInsertDefault} from '../Utils/utils';\n-import {getPlaceScope} from './BuildReactiveBlocks';\n+import {getPlaceScope} from '../HIR/HIR';\n import {\n   ReactiveFunctionTransform,\n   ReactiveFunctionVisitor,"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/index.ts",
                "git_diff": "@@ -6,18 +6,13 @@\n  */\n \n export {alignObjectMethodScopes} from './AlignObjectMethodScopes';\n-export {alignReactiveScopesToBlockScopes} from './AlignReactiveScopesToBlockScopes';\n export {assertScopeInstructionsWithinScopes} from './AssertScopeInstructionsWithinScope';\n export {assertWellFormedBreakTargets} from './AssertWellFormedBreakTargets';\n-export {buildReactiveBlocks} from './BuildReactiveBlocks';\n export {buildReactiveFunction} from './BuildReactiveFunction';\n export {codegenFunction, type CodegenFunction} from './CodegenReactiveFunction';\n export {extractScopeDeclarationsFromDestructuring} from './ExtractScopeDeclarationsFromDestructuring';\n-export {flattenReactiveLoops} from './FlattenReactiveLoops';\n-export {flattenScopesWithHooksOrUse} from './FlattenScopesWithHooksOrUse';\n export {inferReactiveScopeVariables} from './InferReactiveScopeVariables';\n export {memoizeFbtAndMacroOperandsInSameScope} from './MemoizeFbtAndMacroOperandsInSameScope';\n-export {mergeOverlappingReactiveScopes} from './MergeOverlappingReactiveScopes';\n export {mergeReactiveScopesThatInvalidateTogether} from './MergeReactiveScopesThatInvalidateTogether';\n export {printReactiveFunction} from './PrintReactiveFunction';\n export {promoteUsedTemporaries} from './PromoteUsedTemporaries';"
            }
        ]
    },
    {
        "prompt": "issue: [DevTools] Simplify Context Change Tracking in Profiler | description: When Context change tracking was added to support modern Context it relied on the \"memoizedValue\" to read the current value. This only works in React 18+ when it was added to support Lazy Context Propagation. However, the backend stored the old value the same way it used to work for legacy Context in a global map. This was unnecessary since we *also* have the old value on the previous Fiber.\r\n\r\nThis removes all the costly tracking of previous values for every Fiber that uses Contexts slowing down profiling. Instead, we just compare the Contexts from \r\n\r\nThe downside is that this no longer supports detecting changes due to legacy Context because it doesn't have a similar \"previous\" value. However, legacy Context has long been deprecated and is completely removed in 19. So I don't think it's worth supporting since you have to be on an old version *and* actually use legacy Context *and* trying to profile something that updates it. Which btw, updating legacy contexts only worked at all from 16 something when we made updates work. So it was unusual even in the slight gap where you could and before you had migrated to modern Context introduced in 16.3.",
        "completion": [
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -1613,11 +1613,8 @@ export function attach(\n     prevFiber: Fiber | null,\n     nextFiber: Fiber,\n   ): ChangeDescription | null {\n-    switch (getElementTypeForFiber(nextFiber)) {\n-      case ElementTypeClass:\n-      case ElementTypeFunction:\n-      case ElementTypeMemo:\n-      case ElementTypeForwardRef:\n+    switch (nextFiber.tag) {\n+      case ClassComponent:\n         if (prevFiber === null) {\n           return {\n             context: null,\n@@ -1640,15 +1637,39 @@ export function attach(\n               nextFiber.memoizedState,\n             ),\n           };\n-\n-          // Only traverse the hooks list once, depending on what info we're returning.\n+          return data;\n+        }\n+      case IncompleteFunctionComponent:\n+      case FunctionComponent:\n+      case IndeterminateComponent:\n+      case ForwardRef:\n+      case MemoComponent:\n+      case SimpleMemoComponent:\n+        if (prevFiber === null) {\n+          return {\n+            context: null,\n+            didHooksChange: false,\n+            isFirstMount: true,\n+            props: null,\n+            state: null,\n+          };\n+        } else {\n           const indices = getChangedHooksIndices(\n             prevFiber.memoizedState,\n             nextFiber.memoizedState,\n           );\n-          data.hooks = indices;\n-          data.didHooksChange = indices !== null && indices.length > 0;\n-\n+          const data: ChangeDescription = {\n+            context: getContextChangedKeys(nextFiber),\n+            didHooksChange: indices !== null && indices.length > 0,\n+            isFirstMount: false,\n+            props: getChangedKeys(\n+              prevFiber.memoizedProps,\n+              nextFiber.memoizedProps,\n+            ),\n+            state: null,\n+            hooks: indices,\n+          };\n+          // Only traverse the hooks list once, depending on what info we're returning.\n           return data;\n         }\n       default:\n@@ -1841,20 +1862,13 @@ export function attach(\n \n     const indices = [];\n     let index = 0;\n-    if (\n-      next.hasOwnProperty('baseState') &&\n-      next.hasOwnProperty('memoizedState') &&\n-      next.hasOwnProperty('next') &&\n-      next.hasOwnProperty('queue')\n-    ) {\n-      while (next !== null) {\n-        if (didStatefulHookChange(prev, next)) {\n-          indices.push(index);\n-        }\n-        next = next.next;\n-        prev = prev.next;\n-        index++;\n+    while (next !== null) {\n+      if (didStatefulHookChange(prev, next)) {\n+        indices.push(index);\n       }\n+      next = next.next;\n+      prev = prev.next;\n+      index++;\n     }\n \n     return indices;\n@@ -1865,16 +1879,6 @@ export function attach(\n       return null;\n     }\n \n-    // We can't report anything meaningful for hooks changes.\n-    if (\n-      next.hasOwnProperty('baseState') &&\n-      next.hasOwnProperty('memoizedState') &&\n-      next.hasOwnProperty('next') &&\n-      next.hasOwnProperty('queue')\n-    ) {\n-      return null;\n-    }\n-\n     const keys = new Set([...Object.keys(prev), ...Object.keys(next)]);\n     const changedKeys = [];\n     // eslint-disable-next-line no-for-of-loops/no-for-of-loops"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilerChangeDescriptions-test.js",
                "git_diff": "@@ -123,7 +123,7 @@ describe('Profiler change descriptions', () => {\n     expect(commitData.changeDescriptions.get(element.id))\n       .toMatchInlineSnapshot(`\n       {\n-        \"context\": null,\n+        \"context\": false,\n         \"didHooksChange\": false,\n         \"hooks\": null,\n         \"isFirstMount\": false,"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -1530,16 +1530,6 @@ export function attach(\n   // When a mount or update is in progress, this value tracks the root that is being operated on.\n   let currentRootID: number = -1;\n \n-  function getFiberIDThrows(fiber: Fiber): number {\n-    const fiberInstance = getFiberInstanceUnsafe(fiber);\n-    if (fiberInstance !== null) {\n-      return fiberInstance.id;\n-    }\n-    throw Error(\n-      `Could not find ID for Fiber \"${getDisplayNameForFiber(fiber) || ''}\"`,\n-    );\n-  }\n-\n   // Returns a FiberInstance if one has already been generated for the Fiber or null if one has not been generated.\n   // Use this method while e.g. logging to avoid over-retaining Fibers.\n   function getFiberInstanceUnsafe(fiber: Fiber): FiberInstance | null {\n@@ -1625,7 +1615,7 @@ export function attach(\n           };\n         } else {\n           const data: ChangeDescription = {\n-            context: getContextChangedKeys(nextFiber),\n+            context: getContextChanged(prevFiber, nextFiber),\n             didHooksChange: false,\n             isFirstMount: false,\n             props: getChangedKeys(\n@@ -1659,7 +1649,7 @@ export function attach(\n             nextFiber.memoizedState,\n           );\n           const data: ChangeDescription = {\n-            context: getContextChangedKeys(nextFiber),\n+            context: getContextChanged(prevFiber, nextFiber),\n             didHooksChange: indices !== null && indices.length > 0,\n             isFirstMount: false,\n             props: getChangedKeys(\n@@ -1677,147 +1667,33 @@ export function attach(\n     }\n   }\n \n-  function updateContextsForFiber(fiber: Fiber) {\n-    switch (getElementTypeForFiber(fiber)) {\n-      case ElementTypeClass:\n-      case ElementTypeForwardRef:\n-      case ElementTypeFunction:\n-      case ElementTypeMemo:\n-        if (idToContextsMap !== null) {\n-          const id = getFiberIDThrows(fiber);\n-          const contexts = getContextsForFiber(fiber);\n-          if (contexts !== null) {\n-            // $FlowFixMe[incompatible-use] found when upgrading Flow\n-            idToContextsMap.set(id, contexts);\n-          }\n-        }\n-        break;\n-      default:\n-        break;\n-    }\n-  }\n-\n-  // Differentiates between a null context value and no context.\n-  const NO_CONTEXT = {};\n-\n-  function getContextsForFiber(fiber: Fiber): [Object, any] | null {\n-    let legacyContext = NO_CONTEXT;\n-    let modernContext = NO_CONTEXT;\n-\n-    switch (getElementTypeForFiber(fiber)) {\n-      case ElementTypeClass:\n-        const instance = fiber.stateNode;\n-        if (instance != null) {\n-          if (\n-            instance.constructor &&\n-            instance.constructor.contextType != null\n-          ) {\n-            modernContext = instance.context;\n-          } else {\n-            legacyContext = instance.context;\n-            if (legacyContext && Object.keys(legacyContext).length === 0) {\n-              legacyContext = NO_CONTEXT;\n-            }\n-          }\n-        }\n-        return [legacyContext, modernContext];\n-      case ElementTypeForwardRef:\n-      case ElementTypeFunction:\n-      case ElementTypeMemo:\n-        const dependencies = fiber.dependencies;\n-        if (dependencies && dependencies.firstContext) {\n-          modernContext = dependencies.firstContext;\n-        }\n-\n-        return [legacyContext, modernContext];\n-      default:\n-        return null;\n-    }\n-  }\n-\n-  // Record all contexts at the time profiling is started.\n-  // Fibers only store the current context value,\n-  // so we need to track them separately in order to determine changed keys.\n-  function crawlToInitializeContextsMap(fiber: Fiber) {\n-    const id = getFiberIDUnsafe(fiber);\n-\n-    // Not all Fibers in the subtree have mounted yet.\n-    // For example, Offscreen (hidden) or Suspense (suspended) subtrees won't yet be tracked.\n-    // We can safely skip these subtrees.\n-    if (id !== null) {\n-      updateContextsForFiber(fiber);\n-\n-      let current = fiber.child;\n-      while (current !== null) {\n-        crawlToInitializeContextsMap(current);\n-        current = current.sibling;\n+  function getContextChanged(prevFiber: Fiber, nextFiber: Fiber): boolean {\n+    let prevContext =\n+      prevFiber.dependencies && prevFiber.dependencies.firstContext;\n+    let nextContext =\n+      nextFiber.dependencies && nextFiber.dependencies.firstContext;\n+\n+    while (prevContext && nextContext) {\n+      // Note this only works for versions of React that support this key (e.v. 18+)\n+      // For older versions, there's no good way to read the current context value after render has completed.\n+      // This is because React maintains a stack of context values during render,\n+      // but by the time DevTools is called, render has finished and the stack is empty.\n+      if (prevContext.context !== nextContext.context) {\n+        // If the order of context has changed, then the later context values might have\n+        // changed too but the main reason it rerendered was earlier. Either an earlier\n+        // context changed value but then we would have exited already. If we end up here\n+        // it's because a state or props change caused the order of contexts used to change.\n+        // So the main cause is not the contexts themselves.\n+        return false;\n       }\n-    }\n-  }\n-\n-  function getContextChangedKeys(fiber: Fiber): null | boolean | Array<string> {\n-    if (idToContextsMap !== null) {\n-      const id = getFiberIDThrows(fiber);\n-      // $FlowFixMe[incompatible-use] found when upgrading Flow\n-      const prevContexts = idToContextsMap.has(id)\n-        ? // $FlowFixMe[incompatible-use] found when upgrading Flow\n-          idToContextsMap.get(id)\n-        : null;\n-      const nextContexts = getContextsForFiber(fiber);\n-\n-      if (prevContexts == null || nextContexts == null) {\n-        return null;\n+      if (!is(prevContext.memoizedValue, nextContext.memoizedValue)) {\n+        return true;\n       }\n \n-      const [prevLegacyContext, prevModernContext] = prevContexts;\n-      const [nextLegacyContext, nextModernContext] = nextContexts;\n-\n-      switch (getElementTypeForFiber(fiber)) {\n-        case ElementTypeClass:\n-          if (prevContexts && nextContexts) {\n-            if (nextLegacyContext !== NO_CONTEXT) {\n-              return getChangedKeys(prevLegacyContext, nextLegacyContext);\n-            } else if (nextModernContext !== NO_CONTEXT) {\n-              return prevModernContext !== nextModernContext;\n-            }\n-          }\n-          break;\n-        case ElementTypeForwardRef:\n-        case ElementTypeFunction:\n-        case ElementTypeMemo:\n-          if (nextModernContext !== NO_CONTEXT) {\n-            let prevContext = prevModernContext;\n-            let nextContext = nextModernContext;\n-\n-            while (prevContext && nextContext) {\n-              // Note this only works for versions of React that support this key (e.v. 18+)\n-              // For older versions, there's no good way to read the current context value after render has completed.\n-              // This is because React maintains a stack of context values during render,\n-              // but by the time DevTools is called, render has finished and the stack is empty.\n-              if (prevContext.context !== nextContext.context) {\n-                // If the order of context has changed, then the later context values might have\n-                // changed too but the main reason it rerendered was earlier. Either an earlier\n-                // context changed value but then we would have exited already. If we end up here\n-                // it's because a state or props change caused the order of contexts used to change.\n-                // So the main cause is not the contexts themselves.\n-                return false;\n-              }\n-              if (!is(prevContext.memoizedValue, nextContext.memoizedValue)) {\n-                return true;\n-              }\n-\n-              prevContext = prevContext.next;\n-              nextContext = nextContext.next;\n-            }\n-\n-            return false;\n-          }\n-          break;\n-        default:\n-          break;\n-      }\n+      prevContext = prevContext.next;\n+      nextContext = nextContext.next;\n     }\n-    return null;\n+    return false;\n   }\n \n   function isHookThatCanScheduleUpdate(hookObject: any) {\n@@ -3002,8 +2878,6 @@ export function attach(\n                 metadata.changeDescriptions.set(id, changeDescription);\n               }\n             }\n-\n-            updateContextsForFiber(fiber);\n           }\n         }\n       }\n@@ -5209,7 +5083,6 @@ export function attach(\n \n   let currentCommitProfilingMetadata: CommitProfilingData | null = null;\n   let displayNamesByRootID: DisplayNamesByRootID | null = null;\n-  let idToContextsMap: Map<number, any> | null = null;\n   let initialTreeBaseDurationsMap: Map<number, Array<[number, number]>> | null =\n     null;\n   let isProfiling: boolean = false;\n@@ -5356,7 +5229,6 @@ export function attach(\n     // (e.g. when a fiber is re-rendered or when a fiber gets removed).\n     displayNamesByRootID = new Map();\n     initialTreeBaseDurationsMap = new Map();\n-    idToContextsMap = new Map();\n \n     hook.getFiberRoots(rendererID).forEach(root => {\n       const rootInstance = rootToFiberInstanceMap.get(root);\n@@ -5373,13 +5245,6 @@ export function attach(\n       const initialTreeBaseDurations: Array<[number, number]> = [];\n       snapshotTreeBaseDurations(rootInstance, initialTreeBaseDurations);\n       (initialTreeBaseDurationsMap: any).set(rootID, initialTreeBaseDurations);\n-\n-      if (shouldRecordChangeDescriptions) {\n-        // Record all contexts at the time profiling is started.\n-        // Fibers only store the current context value,\n-        // so we need to track them separately in order to determine changed keys.\n-        crawlToInitializeContextsMap(root.current);\n-      }\n     });\n \n     isProfiling = true;"
            }
        ]
    },
    {
        "prompt": "issue: [compiler][cleanup] Remove unused enableReactiveScopesInHIR flag | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* #30894\n* #30893\n* #30892\n* __->__ #30891\n\nReactive scopes in HIR has been stable for over 3 months now and is the future direction of react compiler, removing this flag to reduce implementation forks.",
        "completion": [
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Entrypoint/Pipeline.ts",
                "git_diff": "@@ -46,18 +46,13 @@ import {instructionReordering} from '../Optimization/InstructionReordering';\n import {\n   CodegenFunction,\n   alignObjectMethodScopes,\n-  alignReactiveScopesToBlockScopes,\n   assertScopeInstructionsWithinScopes,\n   assertWellFormedBreakTargets,\n-  buildReactiveBlocks,\n   buildReactiveFunction,\n   codegenFunction,\n   extractScopeDeclarationsFromDestructuring,\n-  flattenReactiveLoops,\n-  flattenScopesWithHooksOrUse,\n   inferReactiveScopeVariables,\n   memoizeFbtAndMacroOperandsInSameScope,\n-  mergeOverlappingReactiveScopes,\n   mergeReactiveScopesThatInvalidateTogether,\n   promoteUsedTemporaries,\n   propagateEarlyReturns,\n@@ -300,54 +295,52 @@ function* runWithEnvironment(\n     value: hir,\n   });\n \n-  if (env.config.enableReactiveScopesInHIR) {\n-    pruneUnusedLabelsHIR(hir);\n-    yield log({\n-      kind: 'hir',\n-      name: 'PruneUnusedLabelsHIR',\n-      value: hir,\n-    });\n+  pruneUnusedLabelsHIR(hir);\n+  yield log({\n+    kind: 'hir',\n+    name: 'PruneUnusedLabelsHIR',\n+    value: hir,\n+  });\n \n-    alignReactiveScopesToBlockScopesHIR(hir);\n-    yield log({\n-      kind: 'hir',\n-      name: 'AlignReactiveScopesToBlockScopesHIR',\n-      value: hir,\n-    });\n+  alignReactiveScopesToBlockScopesHIR(hir);\n+  yield log({\n+    kind: 'hir',\n+    name: 'AlignReactiveScopesToBlockScopesHIR',\n+    value: hir,\n+  });\n \n-    mergeOverlappingReactiveScopesHIR(hir);\n-    yield log({\n-      kind: 'hir',\n-      name: 'MergeOverlappingReactiveScopesHIR',\n-      value: hir,\n-    });\n-    assertValidBlockNesting(hir);\n+  mergeOverlappingReactiveScopesHIR(hir);\n+  yield log({\n+    kind: 'hir',\n+    name: 'MergeOverlappingReactiveScopesHIR',\n+    value: hir,\n+  });\n+  assertValidBlockNesting(hir);\n \n-    buildReactiveScopeTerminalsHIR(hir);\n-    yield log({\n-      kind: 'hir',\n-      name: 'BuildReactiveScopeTerminalsHIR',\n-      value: hir,\n-    });\n+  buildReactiveScopeTerminalsHIR(hir);\n+  yield log({\n+    kind: 'hir',\n+    name: 'BuildReactiveScopeTerminalsHIR',\n+    value: hir,\n+  });\n \n-    assertValidBlockNesting(hir);\n+  assertValidBlockNesting(hir);\n \n-    flattenReactiveLoopsHIR(hir);\n-    yield log({\n-      kind: 'hir',\n-      name: 'FlattenReactiveLoopsHIR',\n-      value: hir,\n-    });\n+  flattenReactiveLoopsHIR(hir);\n+  yield log({\n+    kind: 'hir',\n+    name: 'FlattenReactiveLoopsHIR',\n+    value: hir,\n+  });\n \n-    flattenScopesWithHooksOrUseHIR(hir);\n-    yield log({\n-      kind: 'hir',\n-      name: 'FlattenScopesWithHooksOrUseHIR',\n-      value: hir,\n-    });\n-    assertTerminalSuccessorsExist(hir);\n-    assertTerminalPredsExist(hir);\n-  }\n+  flattenScopesWithHooksOrUseHIR(hir);\n+  yield log({\n+    kind: 'hir',\n+    name: 'FlattenScopesWithHooksOrUseHIR',\n+    value: hir,\n+  });\n+  assertTerminalSuccessorsExist(hir);\n+  assertTerminalPredsExist(hir);\n \n   const reactiveFunction = buildReactiveFunction(hir);\n   yield log({\n@@ -364,44 +357,6 @@ function* runWithEnvironment(\n     name: 'PruneUnusedLabels',\n     value: reactiveFunction,\n   });\n-\n-  if (!env.config.enableReactiveScopesInHIR) {\n-    alignReactiveScopesToBlockScopes(reactiveFunction);\n-    yield log({\n-      kind: 'reactive',\n-      name: 'AlignReactiveScopesToBlockScopes',\n-      value: reactiveFunction,\n-    });\n-\n-    mergeOverlappingReactiveScopes(reactiveFunction);\n-    yield log({\n-      kind: 'reactive',\n-      name: 'MergeOverlappingReactiveScopes',\n-      value: reactiveFunction,\n-    });\n-\n-    buildReactiveBlocks(reactiveFunction);\n-    yield log({\n-      kind: 'reactive',\n-      name: 'BuildReactiveBlocks',\n-      value: reactiveFunction,\n-    });\n-\n-    flattenReactiveLoops(reactiveFunction);\n-    yield log({\n-      kind: 'reactive',\n-      name: 'FlattenReactiveLoops',\n-      value: reactiveFunction,\n-    });\n-\n-    flattenScopesWithHooksOrUse(reactiveFunction);\n-    yield log({\n-      kind: 'reactive',\n-      name: 'FlattenScopesWithHooks',\n-      value: reactiveFunction,\n-    });\n-  }\n-\n   assertScopeInstructionsWithinScopes(reactiveFunction);\n \n   propagateScopeDependencies(reactiveFunction);"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts",
                "git_diff": "@@ -222,8 +222,6 @@ const EnvironmentConfigSchema = z.object({\n    */\n   enableUseTypeAnnotations: z.boolean().default(false),\n \n-  enableReactiveScopesInHIR: z.boolean().default(true),\n-\n   /**\n    * Enables inference of optional dependency chains. Without this flag\n    * a property chain such as `props?.items?.foo` will infer as a dep on"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/align-scopes-within-nested-valueblock-in-array.expect.md",
                "git_diff": "@@ -2,8 +2,6 @@\n ## Input\n \n ```javascript\n-// @enableReactiveScopesInHIR:false\n-\n import {Stringify, identity, makeArray, mutate} from 'shared-runtime';\n \n /**\n@@ -37,8 +35,7 @@ export const FIXTURE_ENTRYPOINT = {\n ## Code\n \n ```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-\n+import { c as _c } from \"react/compiler-runtime\";\n import { Stringify, identity, makeArray, mutate } from \"shared-runtime\";\n \n /**\n@@ -52,11 +49,12 @@ import { Stringify, identity, makeArray, mutate } from \"shared-runtime\";\n  * handles this correctly.\n  */\n function Foo(t0) {\n-  const $ = _c(4);\n+  const $ = _c(3);\n   const { cond1, cond2 } = t0;\n-  const arr = makeArray({ a: 2 }, 2, []);\n   let t1;\n-  if ($[0] !== cond1 || $[1] !== cond2 || $[2] !== arr) {\n+  if ($[0] !== cond1 || $[1] !== cond2) {\n+    const arr = makeArray({ a: 2 }, 2, []);\n+\n     t1 = cond1 ? (\n       <>\n         <div>{identity(\"foo\")}</div>\n@@ -65,10 +63,9 @@ function Foo(t0) {\n     ) : null;\n     $[0] = cond1;\n     $[1] = cond2;\n-    $[2] = arr;\n-    $[3] = t1;\n+    $[2] = t1;\n   } else {\n-    t1 = $[3];\n+    t1 = $[2];\n   }\n   return t1;\n }"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/align-scopes-within-nested-valueblock-in-array.tsx",
                "git_diff": "@@ -1,5 +1,3 @@\n-// @enableReactiveScopesInHIR:false\n-\n import {Stringify, identity, makeArray, mutate} from 'shared-runtime';\n \n /**"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/allocating-logical-expression-instruction-scope.expect.md",
                "git_diff": "@@ -1,61 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-\n-/**\n- * This is a weird case as data has type `BuiltInMixedReadonly`.\n- * The only scoped value we currently infer in this program is the\n- * PropertyLoad `data?.toString`.\n- */\n-import {useFragment} from 'shared-runtime';\n-\n-function Foo() {\n-  const data = useFragment();\n-  return [data?.toString() || ''];\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Foo,\n-  params: [],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-\n-/**\n- * This is a weird case as data has type `BuiltInMixedReadonly`.\n- * The only scoped value we currently infer in this program is the\n- * PropertyLoad `data?.toString`.\n- */\n-import { useFragment } from \"shared-runtime\";\n-\n-function Foo() {\n-  const $ = _c(2);\n-  const data = useFragment();\n-  const t0 = data?.toString() || \"\";\n-  let t1;\n-  if ($[0] !== t0) {\n-    t1 = [t0];\n-    $[0] = t0;\n-    $[1] = t1;\n-  } else {\n-    t1 = $[1];\n-  }\n-  return t1;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Foo,\n-  params: [],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) [\"[object Object]\"]\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/allocating-logical-expression-instruction-scope.ts",
                "git_diff": "@@ -1,18 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-\n-/**\n- * This is a weird case as data has type `BuiltInMixedReadonly`.\n- * The only scoped value we currently infer in this program is the\n- * PropertyLoad `data?.toString`.\n- */\n-import {useFragment} from 'shared-runtime';\n-\n-function Foo() {\n-  const data = useFragment();\n-  return [data?.toString() || ''];\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Foo,\n-  params: [],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/bug-hoisted-declaration-with-scope.expect.md",
                "git_diff": "@@ -1,96 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-import {StaticText1, Stringify, identity, useHook} from 'shared-runtime';\n-/**\n- * `button` and `dispatcher` must end up in the same memo block. It would be\n- * invalid for `button` to take a dependency on `dispatcher` as dispatcher\n- * is created later.\n- *\n- * Sprout error:\n- * Found differences in evaluator results\n- * Non-forget (expected):\n- * (kind: ok) \"[[ function params=1 ]]\"\n- * Forget:\n- * (kind: exception) Cannot access 'dispatcher' before initialization\n- */\n-function useFoo({onClose}) {\n-  const button = StaticText1 ?? (\n-    <Stringify\n-      primary={{\n-        label: identity('label'),\n-        onPress: onClose,\n-      }}\n-      secondary={{\n-        onPress: () => {\n-          dispatcher.go('route2');\n-        },\n-      }}\n-    />\n-  );\n-\n-  const dispatcher = useHook();\n-\n-  return button;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{onClose: identity()}],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-import { StaticText1, Stringify, identity, useHook } from \"shared-runtime\";\n-/**\n- * `button` and `dispatcher` must end up in the same memo block. It would be\n- * invalid for `button` to take a dependency on `dispatcher` as dispatcher\n- * is created later.\n- *\n- * Sprout error:\n- * Found differences in evaluator results\n- * Non-forget (expected):\n- * (kind: ok) \"[[ function params=1 ]]\"\n- * Forget:\n- * (kind: exception) Cannot access 'dispatcher' before initialization\n- */\n-function useFoo(t0) {\n-  const $ = _c(3);\n-  const { onClose } = t0;\n-  let t1;\n-  if ($[0] !== onClose || $[1] !== dispatcher) {\n-    t1 = StaticText1 ?? (\n-      <Stringify\n-        primary={{ label: identity(\"label\"), onPress: onClose }}\n-        secondary={{\n-          onPress: () => {\n-            dispatcher.go(\"route2\");\n-          },\n-        }}\n-      />\n-    );\n-    $[0] = onClose;\n-    $[1] = dispatcher;\n-    $[2] = t1;\n-  } else {\n-    t1 = $[2];\n-  }\n-  const button = t1;\n-\n-  const dispatcher = useHook();\n-  return button;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{ onClose: identity() }],\n-};\n-\n-```\n-      \n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/bug-hoisted-declaration-with-scope.tsx",
                "git_diff": "@@ -1,38 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-import {StaticText1, Stringify, identity, useHook} from 'shared-runtime';\n-/**\n- * `button` and `dispatcher` must end up in the same memo block. It would be\n- * invalid for `button` to take a dependency on `dispatcher` as dispatcher\n- * is created later.\n- *\n- * Sprout error:\n- * Found differences in evaluator results\n- * Non-forget (expected):\n- * (kind: ok) \"[[ function params=1 ]]\"\n- * Forget:\n- * (kind: exception) Cannot access 'dispatcher' before initialization\n- */\n-function useFoo({onClose}) {\n-  const button = StaticText1 ?? (\n-    <Stringify\n-      primary={{\n-        label: identity('label'),\n-        onPress: onClose,\n-      }}\n-      secondary={{\n-        onPress: () => {\n-          dispatcher.go('route2');\n-        },\n-      }}\n-    />\n-  );\n-\n-  const dispatcher = useHook();\n-\n-  return button;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{onClose: identity()}],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/bug-nonmutating-capture-in-unsplittable-memo-block.expect.md",
                "git_diff": "@@ -1,137 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-import {identity, mutate} from 'shared-runtime';\n-\n-/**\n- * The root cause of this bug is in `InferReactiveScopeVariables`. Currently,\n- * InferReactiveScopeVariables do not ensure that maybe-aliased values get\n- * assigned the same reactive scope. This is safe only when an already-\n- * constructed value is captured, e.g.\n- * ```js\n- * const x = makeObj();  \u231d mutable range of x\n- * mutate(x);            \u231f\n- *                       <-- after this point, we can produce a canonical version\n- *                           of x for all following aliases\n- * const y = [];\n- * y.push(x);            <-- y captures x\n- * ```\n- *\n- * However, if a value is captured/aliased during its mutable range and the\n- * capturing container is separately memoized, it becomes difficult to guarantee\n- * that all aliases refer to the same value.\n- *\n- * Sprout error:\n- * Found differences in evaluator results\n- * Non-forget (expected):\n- * (kind: ok) [{\"wat0\":\"joe\"},3]\n- * [{\"wat0\":\"joe\"},3]\n- * Forget:\n- * (kind: ok) [{\"wat0\":\"joe\"},3]\n- * [[ (exception in render) Error: oh no! ]]\n- *\n- */\n-function useFoo({a, b}) {\n-  const x = {a};\n-  const y = {};\n-  mutate(x);\n-  const z = [identity(y), b];\n-  mutate(y);\n-\n-  if (z[0] !== y) {\n-    throw new Error('oh no!');\n-  }\n-  return z;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{a: 2, b: 3}],\n-  sequentialRenders: [\n-    {a: 2, b: 3},\n-    {a: 4, b: 3},\n-  ],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-import { identity, mutate } from \"shared-runtime\";\n-\n-/**\n- * The root cause of this bug is in `InferReactiveScopeVariables`. Currently,\n- * InferReactiveScopeVariables do not ensure that maybe-aliased values get\n- * assigned the same reactive scope. This is safe only when an already-\n- * constructed value is captured, e.g.\n- * ```js\n- * const x = makeObj();  \u231d mutable range of x\n- * mutate(x);            \u231f\n- *                       <-- after this point, we can produce a canonical version\n- *                           of x for all following aliases\n- * const y = [];\n- * y.push(x);            <-- y captures x\n- * ```\n- *\n- * However, if a value is captured/aliased during its mutable range and the\n- * capturing container is separately memoized, it becomes difficult to guarantee\n- * that all aliases refer to the same value.\n- *\n- * Sprout error:\n- * Found differences in evaluator results\n- * Non-forget (expected):\n- * (kind: ok) [{\"wat0\":\"joe\"},3]\n- * [{\"wat0\":\"joe\"},3]\n- * Forget:\n- * (kind: ok) [{\"wat0\":\"joe\"},3]\n- * [[ (exception in render) Error: oh no! ]]\n- *\n- */\n-function useFoo(t0) {\n-  const $ = _c(6);\n-  const { a, b } = t0;\n-  let z;\n-  let y;\n-  if ($[0] !== a || $[1] !== b) {\n-    const x = { a };\n-    y = {};\n-    mutate(x);\n-    let t1;\n-    if ($[4] !== b) {\n-      t1 = [identity(y), b];\n-      $[4] = b;\n-      $[5] = t1;\n-    } else {\n-      t1 = $[5];\n-    }\n-    z = t1;\n-    mutate(y);\n-    $[0] = a;\n-    $[1] = b;\n-    $[2] = z;\n-    $[3] = y;\n-  } else {\n-    z = $[2];\n-    y = $[3];\n-  }\n-  if (z[0] !== y) {\n-    throw new Error(\"oh no!\");\n-  }\n-  return z;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{ a: 2, b: 3 }],\n-  sequentialRenders: [\n-    { a: 2, b: 3 },\n-    { a: 4, b: 3 },\n-  ],\n-};\n-\n-```\n-      \n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/bug-nonmutating-capture-in-unsplittable-memo-block.ts",
                "git_diff": "@@ -1,52 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-import {identity, mutate} from 'shared-runtime';\n-\n-/**\n- * The root cause of this bug is in `InferReactiveScopeVariables`. Currently,\n- * InferReactiveScopeVariables do not ensure that maybe-aliased values get\n- * assigned the same reactive scope. This is safe only when an already-\n- * constructed value is captured, e.g.\n- * ```js\n- * const x = makeObj();  \u231d mutable range of x\n- * mutate(x);            \u231f\n- *                       <-- after this point, we can produce a canonical version\n- *                           of x for all following aliases\n- * const y = [];\n- * y.push(x);            <-- y captures x\n- * ```\n- *\n- * However, if a value is captured/aliased during its mutable range and the\n- * capturing container is separately memoized, it becomes difficult to guarantee\n- * that all aliases refer to the same value.\n- *\n- * Sprout error:\n- * Found differences in evaluator results\n- * Non-forget (expected):\n- * (kind: ok) [{\"wat0\":\"joe\"},3]\n- * [{\"wat0\":\"joe\"},3]\n- * Forget:\n- * (kind: ok) [{\"wat0\":\"joe\"},3]\n- * [[ (exception in render) Error: oh no! ]]\n- *\n- */\n-function useFoo({a, b}) {\n-  const x = {a};\n-  const y = {};\n-  mutate(x);\n-  const z = [identity(y), b];\n-  mutate(y);\n-\n-  if (z[0] !== y) {\n-    throw new Error('oh no!');\n-  }\n-  return z;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{a: 2, b: 3}],\n-  sequentialRenders: [\n-    {a: 2, b: 3},\n-    {a: 4, b: 3},\n-  ],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/error.capture-ref-for-later-mutation.expect.md",
                "git_diff": "@@ -1,51 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-import {useRef} from 'react';\n-import {addOne} from 'shared-runtime';\n-\n-function useKeyCommand() {\n-  const currentPosition = useRef(0);\n-  const handleKey = direction => () => {\n-    const position = currentPosition.current;\n-    const nextPosition = direction === 'left' ? addOne(position) : position;\n-    currentPosition.current = nextPosition;\n-  };\n-  const moveLeft = {\n-    handler: handleKey('left'),\n-  };\n-  const moveRight = {\n-    handler: handleKey('right'),\n-  };\n-  return [moveLeft, moveRight];\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useKeyCommand,\n-  params: [],\n-};\n-\n-```\n-\n-\n-## Error\n-\n-```\n-  11 |   };\n-  12 |   const moveLeft = {\n-> 13 |     handler: handleKey('left'),\n-     |              ^^^^^^^^^ InvalidReact: This function accesses a ref value (the `current` property), which may not be accessed during render. (https://react.dev/reference/react/useRef) (13:13)\n-\n-InvalidReact: Ref values (the `current` property) may not be accessed during render. (https://react.dev/reference/react/useRef) (13:13)\n-\n-InvalidReact: This function accesses a ref value (the `current` property), which may not be accessed during render. (https://react.dev/reference/react/useRef) (16:16)\n-\n-InvalidReact: Ref values (the `current` property) may not be accessed during render. (https://react.dev/reference/react/useRef) (16:16)\n-  14 |   };\n-  15 |   const moveRight = {\n-  16 |     handler: handleKey('right'),\n-```\n-          \n-      \n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/error.capture-ref-for-later-mutation.tsx",
                "git_diff": "@@ -1,24 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-import {useRef} from 'react';\n-import {addOne} from 'shared-runtime';\n-\n-function useKeyCommand() {\n-  const currentPosition = useRef(0);\n-  const handleKey = direction => () => {\n-    const position = currentPosition.current;\n-    const nextPosition = direction === 'left' ? addOne(position) : position;\n-    currentPosition.current = nextPosition;\n-  };\n-  const moveLeft = {\n-    handler: handleKey('left'),\n-  };\n-  const moveRight = {\n-    handler: handleKey('right'),\n-  };\n-  return [moveLeft, moveRight];\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useKeyCommand,\n-  params: [],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/invalid-align-scopes-within-nested-valueblock-in-array.expect.md",
                "git_diff": "@@ -1,84 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-\n-import {Stringify, identity, makeArray, mutate} from 'shared-runtime';\n-\n-/**\n- * Here, identity('foo') is an immutable allocating instruction.\n- * `arr` is a mutable value whose mutable range ends at `arr.map`.\n- *\n- * The previous (reactive function) version of alignScopesToBlocks set the range of\n- * both scopes to end at value blocks within the <></> expression.\n- * However, both scope ranges should be aligned to the outer value block\n- * (e.g. `cond1 ? <>: null`). The HIR version of alignScopesToBlocks\n- * handles this correctly.\n- */\n-function Foo({cond1, cond2}) {\n-  const arr = makeArray<any>({a: 2}, 2, []);\n-\n-  return cond1 ? (\n-    <>\n-      <div>{identity('foo')}</div>\n-      <Stringify value={cond2 ? arr.map(mutate) : null} />\n-    </>\n-  ) : null;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Foo,\n-  params: [{cond1: true, cond2: true}],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-\n-import { Stringify, identity, makeArray, mutate } from \"shared-runtime\";\n-\n-/**\n- * Here, identity('foo') is an immutable allocating instruction.\n- * `arr` is a mutable value whose mutable range ends at `arr.map`.\n- *\n- * The previous (reactive function) version of alignScopesToBlocks set the range of\n- * both scopes to end at value blocks within the <></> expression.\n- * However, both scope ranges should be aligned to the outer value block\n- * (e.g. `cond1 ? <>: null`). The HIR version of alignScopesToBlocks\n- * handles this correctly.\n- */\n-function Foo(t0) {\n-  const $ = _c(4);\n-  const { cond1, cond2 } = t0;\n-  const arr = makeArray({ a: 2 }, 2, []);\n-  let t1;\n-  if ($[0] !== cond1 || $[1] !== cond2 || $[2] !== arr) {\n-    t1 = cond1 ? (\n-      <>\n-        <div>{identity(\"foo\")}</div>\n-        <Stringify value={cond2 ? arr.map(mutate) : null} />\n-      </>\n-    ) : null;\n-    $[0] = cond1;\n-    $[1] = cond2;\n-    $[2] = arr;\n-    $[3] = t1;\n-  } else {\n-    t1 = $[3];\n-  }\n-  return t1;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Foo,\n-  params: [{ cond1: true, cond2: true }],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) <div>foo</div><div>{\"value\":[null,null,null]}</div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/invalid-align-scopes-within-nested-valueblock-in-array.tsx",
                "git_diff": "@@ -1,29 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-\n-import {Stringify, identity, makeArray, mutate} from 'shared-runtime';\n-\n-/**\n- * Here, identity('foo') is an immutable allocating instruction.\n- * `arr` is a mutable value whose mutable range ends at `arr.map`.\n- *\n- * The previous (reactive function) version of alignScopesToBlocks set the range of\n- * both scopes to end at value blocks within the <></> expression.\n- * However, both scope ranges should be aligned to the outer value block\n- * (e.g. `cond1 ? <>: null`). The HIR version of alignScopesToBlocks\n- * handles this correctly.\n- */\n-function Foo({cond1, cond2}) {\n-  const arr = makeArray<any>({a: 2}, 2, []);\n-\n-  return cond1 ? (\n-    <>\n-      <div>{identity('foo')}</div>\n-      <Stringify value={cond2 ? arr.map(mutate) : null} />\n-    </>\n-  ) : null;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Foo,\n-  params: [{cond1: true, cond2: true}],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/mutate-outer-scope-within-value-block.expect.md",
                "git_diff": "@@ -1,101 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-import {CONST_TRUE, identity, shallowCopy} from 'shared-runtime';\n-\n-/**\n- * There are three values with their own scopes in this fixture.\n- * - arr, whose mutable range extends to the `mutate(...)` call\n- * - cond, which has a mutable range of exactly 1 (e.g. created but not\n- *   mutated)\n- * - { val: CONST_TRUE }, which is also not mutated after creation. However,\n- *   its scope range becomes extended to the value block.\n- *\n- * After AlignScopesToBlockScopes, our scopes look roughly like this\n- * ```js\n- *  [1] arr = shallowCopy()            \u231d@0\n- *  [2] cond = identity()        <- @1 |\n- *  [3] $0 = Ternary test=cond     \u231d@2 |\n- *  [4]        {val : CONST_TRUE}  |   |\n- *  [5]        mutate(arr)         |   |\n- *  [6] return $0                  \u231f   \u231f\n- * ```\n- *\n- * Observe that instruction 5 mutates scope 0, which means that scopes 0 and 2\n- * should be merged.\n- */\n-function useFoo({input}) {\n-  const arr = shallowCopy(input);\n-\n-  const cond = identity(false);\n-  return cond ? {val: CONST_TRUE} : mutate(arr);\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{input: 3}],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-import { CONST_TRUE, identity, shallowCopy } from \"shared-runtime\";\n-\n-/**\n- * There are three values with their own scopes in this fixture.\n- * - arr, whose mutable range extends to the `mutate(...)` call\n- * - cond, which has a mutable range of exactly 1 (e.g. created but not\n- *   mutated)\n- * - { val: CONST_TRUE }, which is also not mutated after creation. However,\n- *   its scope range becomes extended to the value block.\n- *\n- * After AlignScopesToBlockScopes, our scopes look roughly like this\n- * ```js\n- *  [1] arr = shallowCopy()            \u231d@0\n- *  [2] cond = identity()        <- @1 |\n- *  [3] $0 = Ternary test=cond     \u231d@2 |\n- *  [4]        {val : CONST_TRUE}  |   |\n- *  [5]        mutate(arr)         |   |\n- *  [6] return $0                  \u231f   \u231f\n- * ```\n- *\n- * Observe that instruction 5 mutates scope 0, which means that scopes 0 and 2\n- * should be merged.\n- */\n-function useFoo(t0) {\n-  const $ = _c(3);\n-  const { input } = t0;\n-  const arr = shallowCopy(input);\n-  let t1;\n-  if ($[0] === Symbol.for(\"react.memo_cache_sentinel\")) {\n-    t1 = identity(false);\n-    $[0] = t1;\n-  } else {\n-    t1 = $[0];\n-  }\n-  const cond = t1;\n-  let t2;\n-  if ($[1] !== arr) {\n-    t2 = cond ? { val: CONST_TRUE } : mutate(arr);\n-    $[1] = arr;\n-    $[2] = t2;\n-  } else {\n-    t2 = $[2];\n-  }\n-  return t2;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{ input: 3 }],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: exception) mutate is not defined\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/mutate-outer-scope-within-value-block.ts",
                "git_diff": "@@ -1,35 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-import {CONST_TRUE, identity, shallowCopy} from 'shared-runtime';\n-\n-/**\n- * There are three values with their own scopes in this fixture.\n- * - arr, whose mutable range extends to the `mutate(...)` call\n- * - cond, which has a mutable range of exactly 1 (e.g. created but not\n- *   mutated)\n- * - { val: CONST_TRUE }, which is also not mutated after creation. However,\n- *   its scope range becomes extended to the value block.\n- *\n- * After AlignScopesToBlockScopes, our scopes look roughly like this\n- * ```js\n- *  [1] arr = shallowCopy()            \u231d@0\n- *  [2] cond = identity()        <- @1 |\n- *  [3] $0 = Ternary test=cond     \u231d@2 |\n- *  [4]        {val : CONST_TRUE}  |   |\n- *  [5]        mutate(arr)         |   |\n- *  [6] return $0                  \u231f   \u231f\n- * ```\n- *\n- * Observe that instruction 5 mutates scope 0, which means that scopes 0 and 2\n- * should be merged.\n- */\n-function useFoo({input}) {\n-  const arr = shallowCopy(input);\n-\n-  const cond = identity(false);\n-  return cond ? {val: CONST_TRUE} : mutate(arr);\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{input: 3}],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/mutation-within-capture-and-mutablerange.expect.md",
                "git_diff": "@@ -1,92 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-import {mutate} from 'shared-runtime';\n-\n-/**\n- * This test fixture is similar to mutation-within-jsx. The only difference\n- * is that there is no `freeze` effect here, which means that `z` may be\n- * mutated after its memo block through mutating `y`.\n- *\n- * While this is technically correct (as `z` is a nested memo block), it\n- * is an edge case as we believe that values are not mutated after their\n- * memo blocks (which may lead to 'tearing', i.e. mutating one render's\n- * values in a subsequent render.\n- */\n-function useFoo({a, b}) {\n-  // x and y's scopes start here\n-  const x = {a};\n-  const y = [b];\n-  mutate(x);\n-  // z captures the result of `mutate(y)`, which may be aliased to `y`.\n-  const z = [mutate(y)];\n-  // the following line may also mutate z\n-  mutate(y);\n-  // and end here\n-  return z;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{a: 2, b: 3}],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-import { mutate } from \"shared-runtime\";\n-\n-/**\n- * This test fixture is similar to mutation-within-jsx. The only difference\n- * is that there is no `freeze` effect here, which means that `z` may be\n- * mutated after its memo block through mutating `y`.\n- *\n- * While this is technically correct (as `z` is a nested memo block), it\n- * is an edge case as we believe that values are not mutated after their\n- * memo blocks (which may lead to 'tearing', i.e. mutating one render's\n- * values in a subsequent render.\n- */\n-function useFoo(t0) {\n-  const $ = _c(5);\n-  const { a, b } = t0;\n-  let z;\n-  if ($[0] !== a || $[1] !== b) {\n-    const x = { a };\n-    const y = [b];\n-    mutate(x);\n-\n-    const t1 = mutate(y);\n-    let t2;\n-    if ($[3] !== t1) {\n-      t2 = [t1];\n-      $[3] = t1;\n-      $[4] = t2;\n-    } else {\n-      t2 = $[4];\n-    }\n-    z = t2;\n-\n-    mutate(y);\n-    $[0] = a;\n-    $[1] = b;\n-    $[2] = z;\n-  } else {\n-    z = $[2];\n-  }\n-  return z;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{ a: 2, b: 3 }],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) [null]\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/mutation-within-capture-and-mutablerange.tsx",
                "git_diff": "@@ -1,30 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-import {mutate} from 'shared-runtime';\n-\n-/**\n- * This test fixture is similar to mutation-within-jsx. The only difference\n- * is that there is no `freeze` effect here, which means that `z` may be\n- * mutated after its memo block through mutating `y`.\n- *\n- * While this is technically correct (as `z` is a nested memo block), it\n- * is an edge case as we believe that values are not mutated after their\n- * memo blocks (which may lead to 'tearing', i.e. mutating one render's\n- * values in a subsequent render.\n- */\n-function useFoo({a, b}) {\n-  // x and y's scopes start here\n-  const x = {a};\n-  const y = [b];\n-  mutate(x);\n-  // z captures the result of `mutate(y)`, which may be aliased to `y`.\n-  const z = [mutate(y)];\n-  // the following line may also mutate z\n-  mutate(y);\n-  // and end here\n-  return z;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{a: 2, b: 3}],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/mutation-within-jsx-and-break.expect.md",
                "git_diff": "@@ -1,99 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-import {\n-  Stringify,\n-  makeObject_Primitives,\n-  mutate,\n-  mutateAndReturn,\n-} from 'shared-runtime';\n-\n-function useFoo({data}) {\n-  let obj = null;\n-  let myDiv = null;\n-  label: {\n-    if (data.cond) {\n-      obj = makeObject_Primitives();\n-      if (data.cond1) {\n-        myDiv = <Stringify value={mutateAndReturn(obj)} />;\n-        break label;\n-      }\n-      mutate(obj);\n-    }\n-  }\n-\n-  return myDiv;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{data: {cond: true, cond1: true}}],\n-  sequentialRenders: [\n-    {data: {cond: true, cond1: true}},\n-    {data: {cond: true, cond1: true}},\n-  ],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-import {\n-  Stringify,\n-  makeObject_Primitives,\n-  mutate,\n-  mutateAndReturn,\n-} from \"shared-runtime\";\n-\n-function useFoo(t0) {\n-  const $ = _c(5);\n-  const { data } = t0;\n-  let obj;\n-  let myDiv = null;\n-  bb0: if (data.cond) {\n-    if ($[0] !== data.cond1) {\n-      obj = makeObject_Primitives();\n-      if (data.cond1) {\n-        const t1 = mutateAndReturn(obj);\n-        let t2;\n-        if ($[3] !== t1) {\n-          t2 = <Stringify value={t1} />;\n-          $[3] = t1;\n-          $[4] = t2;\n-        } else {\n-          t2 = $[4];\n-        }\n-        myDiv = t2;\n-        break bb0;\n-      }\n-\n-      mutate(obj);\n-      $[0] = data.cond1;\n-      $[1] = obj;\n-      $[2] = myDiv;\n-    } else {\n-      obj = $[1];\n-      myDiv = $[2];\n-    }\n-  }\n-  return myDiv;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{ data: { cond: true, cond1: true } }],\n-  sequentialRenders: [\n-    { data: { cond: true, cond1: true } },\n-    { data: { cond: true, cond1: true } },\n-  ],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) <div>{\"value\":{\"a\":0,\"b\":\"value1\",\"c\":true,\"wat0\":\"joe\"}}</div>\n-<div>{\"value\":{\"a\":0,\"b\":\"value1\",\"c\":true,\"wat0\":\"joe\"}}</div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/mutation-within-jsx-and-break.tsx",
                "git_diff": "@@ -1,33 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-import {\n-  Stringify,\n-  makeObject_Primitives,\n-  mutate,\n-  mutateAndReturn,\n-} from 'shared-runtime';\n-\n-function useFoo({data}) {\n-  let obj = null;\n-  let myDiv = null;\n-  label: {\n-    if (data.cond) {\n-      obj = makeObject_Primitives();\n-      if (data.cond1) {\n-        myDiv = <Stringify value={mutateAndReturn(obj)} />;\n-        break label;\n-      }\n-      mutate(obj);\n-    }\n-  }\n-\n-  return myDiv;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{data: {cond: true, cond1: true}}],\n-  sequentialRenders: [\n-    {data: {cond: true, cond1: true}},\n-    {data: {cond: true, cond1: true}},\n-  ],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/mutation-within-jsx.expect.md",
                "git_diff": "@@ -1,141 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-import {\n-  Stringify,\n-  makeObject_Primitives,\n-  mutateAndReturn,\n-} from 'shared-runtime';\n-\n-/**\n- * In this example, the `<Stringify ... />` JSX block mutates then captures obj.\n- * As JSX expressions freeze their values, we know that `obj` and `myDiv` cannot\n- * be mutated past this.\n- * This set of mutable range + scopes is an edge case because the JSX expression\n- * references values in two scopes.\n- * - (freeze) the result of `mutateAndReturn`\n- *   this is a mutable value with a mutable range starting at `makeObject()`\n- * - (mutate) the lvalue storing the result of `<Stringify .../>`\n- *   this is a immutable value and so gets assigned a different scope\n- *\n- * obj@0 = makeObj();                        \u231d scope@0\n- * if (cond) {                               |\n- *   $1@0 = mutate(obj@0);                   |\n- *   myDiv@1 = JSX $1@0          <- scope@1  |\n- * }                                         \u231f\n- *\n- * Coincidentally, the range of `obj` is extended by alignScopesToBlocks to *past*\n- * the end of the JSX instruction. As we currently alias identifier mutableRanges to\n- * scope ranges, this `freeze` reference is perceived as occurring during the mutable\n- * range of `obj` (even though it is after the last mutating reference).\n- *\n- * This case is technically safe as `myDiv` correctly takes `obj` as a dependency. As\n- * a result, developers can never observe myDiv can aliasing a different value generation\n- * than `obj` (e.g. the invariant `myDiv.props.value === obj` always holds).\n- */\n-function useFoo({data}) {\n-  let obj = null;\n-  let myDiv = null;\n-  if (data.cond) {\n-    obj = makeObject_Primitives();\n-    if (data.cond1) {\n-      myDiv = <Stringify value={mutateAndReturn(obj)} />;\n-    }\n-  }\n-  return myDiv;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{data: {cond: true, cond1: true}}],\n-  sequentialRenders: [\n-    {data: {cond: true, cond1: true}},\n-    {data: {cond: true, cond1: true}},\n-  ],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-import {\n-  Stringify,\n-  makeObject_Primitives,\n-  mutateAndReturn,\n-} from \"shared-runtime\";\n-\n-/**\n- * In this example, the `<Stringify ... />` JSX block mutates then captures obj.\n- * As JSX expressions freeze their values, we know that `obj` and `myDiv` cannot\n- * be mutated past this.\n- * This set of mutable range + scopes is an edge case because the JSX expression\n- * references values in two scopes.\n- * - (freeze) the result of `mutateAndReturn`\n- *   this is a mutable value with a mutable range starting at `makeObject()`\n- * - (mutate) the lvalue storing the result of `<Stringify .../>`\n- *   this is a immutable value and so gets assigned a different scope\n- *\n- * obj@0 = makeObj();                        \u231d scope@0\n- * if (cond) {                               |\n- *   $1@0 = mutate(obj@0);                   |\n- *   myDiv@1 = JSX $1@0          <- scope@1  |\n- * }                                         \u231f\n- *\n- * Coincidentally, the range of `obj` is extended by alignScopesToBlocks to *past*\n- * the end of the JSX instruction. As we currently alias identifier mutableRanges to\n- * scope ranges, this `freeze` reference is perceived as occurring during the mutable\n- * range of `obj` (even though it is after the last mutating reference).\n- *\n- * This case is technically safe as `myDiv` correctly takes `obj` as a dependency. As\n- * a result, developers can never observe myDiv can aliasing a different value generation\n- * than `obj` (e.g. the invariant `myDiv.props.value === obj` always holds).\n- */\n-function useFoo(t0) {\n-  const $ = _c(5);\n-  const { data } = t0;\n-  let obj;\n-  let myDiv = null;\n-  if (data.cond) {\n-    if ($[0] !== data.cond1) {\n-      obj = makeObject_Primitives();\n-      if (data.cond1) {\n-        const t1 = mutateAndReturn(obj);\n-        let t2;\n-        if ($[3] !== t1) {\n-          t2 = <Stringify value={t1} />;\n-          $[3] = t1;\n-          $[4] = t2;\n-        } else {\n-          t2 = $[4];\n-        }\n-        myDiv = t2;\n-      }\n-      $[0] = data.cond1;\n-      $[1] = obj;\n-      $[2] = myDiv;\n-    } else {\n-      obj = $[1];\n-      myDiv = $[2];\n-    }\n-  }\n-  return myDiv;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{ data: { cond: true, cond1: true } }],\n-  sequentialRenders: [\n-    { data: { cond: true, cond1: true } },\n-    { data: { cond: true, cond1: true } },\n-  ],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) <div>{\"value\":{\"a\":0,\"b\":\"value1\",\"c\":true,\"wat0\":\"joe\"}}</div>\n-<div>{\"value\":{\"a\":0,\"b\":\"value1\",\"c\":true,\"wat0\":\"joe\"}}</div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/mutation-within-jsx.tsx",
                "git_diff": "@@ -1,53 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-import {\n-  Stringify,\n-  makeObject_Primitives,\n-  mutateAndReturn,\n-} from 'shared-runtime';\n-\n-/**\n- * In this example, the `<Stringify ... />` JSX block mutates then captures obj.\n- * As JSX expressions freeze their values, we know that `obj` and `myDiv` cannot\n- * be mutated past this.\n- * This set of mutable range + scopes is an edge case because the JSX expression\n- * references values in two scopes.\n- * - (freeze) the result of `mutateAndReturn`\n- *   this is a mutable value with a mutable range starting at `makeObject()`\n- * - (mutate) the lvalue storing the result of `<Stringify .../>`\n- *   this is a immutable value and so gets assigned a different scope\n- *\n- * obj@0 = makeObj();                        \u231d scope@0\n- * if (cond) {                               |\n- *   $1@0 = mutate(obj@0);                   |\n- *   myDiv@1 = JSX $1@0          <- scope@1  |\n- * }                                         \u231f\n- *\n- * Coincidentally, the range of `obj` is extended by alignScopesToBlocks to *past*\n- * the end of the JSX instruction. As we currently alias identifier mutableRanges to\n- * scope ranges, this `freeze` reference is perceived as occurring during the mutable\n- * range of `obj` (even though it is after the last mutating reference).\n- *\n- * This case is technically safe as `myDiv` correctly takes `obj` as a dependency. As\n- * a result, developers can never observe myDiv can aliasing a different value generation\n- * than `obj` (e.g. the invariant `myDiv.props.value === obj` always holds).\n- */\n-function useFoo({data}) {\n-  let obj = null;\n-  let myDiv = null;\n-  if (data.cond) {\n-    obj = makeObject_Primitives();\n-    if (data.cond1) {\n-      myDiv = <Stringify value={mutateAndReturn(obj)} />;\n-    }\n-  }\n-  return myDiv;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useFoo,\n-  params: [{data: {cond: true, cond1: true}}],\n-  sequentialRenders: [\n-    {data: {cond: true, cond1: true}},\n-    {data: {cond: true, cond1: true}},\n-  ],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/repro-allocating-ternary-test-instruction-scope.expect.md",
                "git_diff": "@@ -1,61 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-// @enableReactiveScopesInHIR:false\n-import {identity, makeObject_Primitives} from 'shared-runtime';\n-\n-function useTest({cond}) {\n-  const val = makeObject_Primitives();\n-\n-  useHook();\n-  /**\n-   * We don't technically need a reactive scope for this ternary as\n-   * it cannot produce newly allocated values.\n-   * While identity(...) may allocate, we can teach the compiler that\n-   * its result is only used as as a test condition\n-   */\n-  const result = identity(cond) ? val : null;\n-  return result;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useTest,\n-  params: [{cond: true}],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\"; // @enableReactiveScopesInHIR:false\n-import { identity, makeObject_Primitives } from \"shared-runtime\";\n-\n-function useTest(t0) {\n-  const $ = _c(1);\n-  const { cond } = t0;\n-  let t1;\n-  if ($[0] === Symbol.for(\"react.memo_cache_sentinel\")) {\n-    t1 = makeObject_Primitives();\n-    $[0] = t1;\n-  } else {\n-    t1 = $[0];\n-  }\n-  const val = t1;\n-\n-  useHook();\n-\n-  const result = identity(cond) ? val : null;\n-  return result;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useTest,\n-  params: [{ cond: true }],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: exception) useHook is not defined\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/original-reactive-scopes-fork/repro-allocating-ternary-test-instruction-scope.ts",
                "git_diff": "@@ -1,21 +0,0 @@\n-// @enableReactiveScopesInHIR:false\n-import {identity, makeObject_Primitives} from 'shared-runtime';\n-\n-function useTest({cond}) {\n-  const val = makeObject_Primitives();\n-\n-  useHook();\n-  /**\n-   * We don't technically need a reactive scope for this ternary as\n-   * it cannot produce newly allocated values.\n-   * While identity(...) may allocate, we can teach the compiler that\n-   * its result is only used as as a test condition\n-   */\n-  const result = identity(cond) ? val : null;\n-  return result;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: useTest,\n-  params: [{cond: true}],\n-};"
            }
        ]
    },
    {
        "prompt": "issue: [DevTools] Handle reordered contexts in Profiler | description: While looking at the Context tracking implementation for other reasons I noticed this bug.\r\n\r\nOriginally it wasn't allowed to have conditional `useContext(context)` (although we did because it's technically possible). With `use(context)` it is officially allowed to be conditional as long as it is within a Hook/Component and not within a try/catch.\r\n\r\nThis means that this loop comparing previous and next contexts need to consider that the Context objects might not line up and so it's possibly comparing apples to oranges. We already bailed if one was longer than the other.\r\n\r\nIf the order of contexts changes later in the component that means something else must have already changed earlier so the reason for the rerender isn't the context so we can just return false in that case.",
        "completion": [
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilingCache-test.js",
                "git_diff": "@@ -1209,6 +1209,106 @@ describe('ProfilingCache', () => {\n     }\n   });\n \n+  // @reactVersion >= 19.0\n+  it('should detect context changes or lack of changes with conditional use()', () => {\n+    const ContextA = React.createContext(0);\n+    const ContextB = React.createContext(1);\n+    let setState = null;\n+\n+    const Component = () => {\n+      // These hooks may change and initiate re-renders.\n+      let state;\n+      [state, setState] = React.useState('abc');\n+\n+      let result = state;\n+\n+      if (state.includes('a')) {\n+        result += React.use(ContextA);\n+      }\n+\n+      result += React.use(ContextB);\n+\n+      return result;\n+    };\n+\n+    utils.act(() =>\n+      render(\n+        <ContextA.Provider value={1}>\n+          <ContextB.Provider value={1}>\n+            <Component />\n+          </ContextB.Provider>\n+        </ContextA.Provider>,\n+      ),\n+    );\n+\n+    utils.act(() => store.profilerStore.startProfiling());\n+\n+    // First render changes Context.\n+    utils.act(() =>\n+      render(\n+        <ContextA.Provider value={0}>\n+          <ContextB.Provider value={1}>\n+            <Component />\n+          </ContextB.Provider>\n+        </ContextA.Provider>,\n+      ),\n+    );\n+\n+    // Second render has no changed Context, only changed state.\n+    utils.act(() => setState('def'));\n+\n+    utils.act(() => store.profilerStore.stopProfiling());\n+\n+    const rootID = store.roots[0];\n+\n+    const changeDescriptions = store.profilerStore\n+      .getDataForRoot(rootID)\n+      .commitData.map(commitData => commitData.changeDescriptions);\n+    expect(changeDescriptions).toHaveLength(2);\n+\n+    // 1st render: Change to Context\n+    expect(changeDescriptions[0]).toMatchInlineSnapshot(`\n+      Map {\n+        4 => {\n+          \"context\": true,\n+          \"didHooksChange\": false,\n+          \"hooks\": [],\n+          \"isFirstMount\": false,\n+          \"props\": [],\n+          \"state\": null,\n+        },\n+      }\n+    `);\n+\n+    // 2nd render: Change to State\n+    expect(changeDescriptions[1]).toMatchInlineSnapshot(`\n+      Map {\n+        4 => {\n+          \"context\": false,\n+          \"didHooksChange\": true,\n+          \"hooks\": [\n+            0,\n+          ],\n+          \"isFirstMount\": false,\n+          \"props\": [],\n+          \"state\": null,\n+        },\n+      }\n+    `);\n+\n+    expect(changeDescriptions).toHaveLength(2);\n+\n+    // Export and re-import profile data and make sure it is retained.\n+    utils.exportImportHelper(bridge, store);\n+\n+    for (let commitIndex = 0; commitIndex < 2; commitIndex++) {\n+      const commitData = store.profilerStore.getCommitData(rootID, commitIndex);\n+      expect(commitData.changeDescriptions).toEqual(\n+        changeDescriptions[commitIndex],\n+      );\n+    }\n+  });\n+\n   // @reactVersion >= 18.0\n   it('should calculate durations based on actual children (not filtered children)', () => {\n     store.componentFilters = [utils.createDisplayNameFilter('^Parent$')];"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -1764,6 +1764,14 @@ export function attach(\n               // For older versions, there's no good way to read the current context value after render has completed.\n               // This is because React maintains a stack of context values during render,\n               // but by the time DevTools is called, render has finished and the stack is empty.\n+              if (prevContext.context !== nextContext.context) {\n+                // If the order of context has changed, then the later context values might have\n+                // changed too but the main reason it rerendered was earlier. Either an earlier\n+                // context changed value but then we would have exited already. If we end up here\n+                // it's because a state or props change caused the order of contexts used to change.\n+                // So the main cause is not the contexts themselves.\n+                return false;\n+              }\n               if (!is(prevContext.memoizedValue, nextContext.memoizedValue)) {\n                 return true;\n               }"
            }
        ]
    },
    {
        "prompt": "issue: [DevTools] Avoid getFiberIDUnsafe in debug() Helper | description: Avoids looking up id from fiber and instead pass the instance to the debug() helper.",
        "completion": [
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -1098,7 +1098,10 @@ export function attach(\n     // even if objects are different\n     const message = formatConsoleArgumentsToSingleString(...args);\n     if (__DEBUG__) {\n-      debug('onErrorOrWarning', fiber, null, `${type}: \"${message}\"`);\n+      const fiberInstance = fiberToFiberInstanceMap.get(fiber);\n+      if (fiberInstance !== undefined) {\n+        debug('onErrorOrWarning', fiberInstance, null, `${type}: \"${message}\"`);\n+      }\n     }\n \n     // Mark this Fiber as needed its warning/error count updated during the next flush.\n@@ -1134,32 +1137,37 @@ export function attach(\n   // It relies on the extension to pass the preference through via the global.\n   patchConsoleUsingWindowValues();\n \n-  const debug = (\n+  function debug(\n     name: string,\n-    fiber: Fiber,\n+    instance: DevToolsInstance,\n     parentInstance: null | DevToolsInstance,\n     extraString: string = '',\n-  ): void => {\n+  ): void {\n     if (__DEBUG__) {\n       const displayName =\n-        fiber.tag + ':' + (getDisplayNameForFiber(fiber) || 'null');\n-\n-      const maybeID = getFiberIDUnsafe(fiber) || '<no id>';\n-\n-      let parentDisplayName;\n-      let maybeParentID;\n-      if (parentInstance !== null && parentInstance.kind === FIBER_INSTANCE) {\n-        const parentFiber = parentInstance.data;\n-        parentDisplayName =\n-          parentFiber.tag +\n-          ':' +\n-          (getDisplayNameForFiber(parentFiber) || 'null');\n-        maybeParentID = String(parentInstance.id);\n-      } else {\n-        // TODO: Handle VirtualInstance\n-        parentDisplayName = '';\n-        maybeParentID = '<no-id>';\n-      }\n+        instance.kind === VIRTUAL_INSTANCE\n+          ? instance.data.name || 'null'\n+          : instance.data.tag +\n+            ':' +\n+            (getDisplayNameForFiber(instance.data) || 'null');\n+\n+      const maybeID =\n+        instance.kind === FILTERED_FIBER_INSTANCE ? '<no id>' : instance.id;\n+\n+      const parentDisplayName =\n+        parentInstance === null\n+          ? ''\n+          : parentInstance.kind === VIRTUAL_INSTANCE\n+            ? parentInstance.data.name || 'null'\n+            : parentInstance.data.tag +\n+              ':' +\n+              (getDisplayNameForFiber(parentInstance.data) || 'null');\n+\n+      const maybeParentID =\n+        parentInstance === null ||\n+        parentInstance.kind === FILTERED_FIBER_INSTANCE\n+          ? '<no id>'\n+          : parentInstance.id;\n \n       console.groupCollapsed(\n         `[renderer] %c${name} %c${displayName} (${maybeID}) %c${\n@@ -1173,7 +1181,7 @@ export function attach(\n       console.log(new Error().stack.split('\\n').slice(1).join('\\n'));\n       console.groupEnd();\n     }\n-  };\n+  }\n \n   // eslint-disable-next-line no-unused-vars\n   function debugTree(instance: DevToolsInstance, indent: number = 0) {\n@@ -1569,9 +1577,6 @@ export function attach(\n   // Removes a Fiber (and its alternate) from the Maps used to track their id.\n   // This method should always be called when a Fiber is unmounting.\n   function untrackFiber(nearestInstance: DevToolsInstance, fiber: Fiber) {\n-    if (__DEBUG__) {\n-      debug('untrackFiber()', fiber, null);\n-    }\n     // TODO: Consider using a WeakMap instead. The only thing where that doesn't work\n     // is React Native Paper which tracks tags but that support is eventually going away\n     // and can use the old findFiberByHostInstance strategy.\n@@ -2245,7 +2250,7 @@ export function attach(\n     const id = fiberInstance.id;\n \n     if (__DEBUG__) {\n-      debug('recordMount()', fiber, parentInstance);\n+      debug('recordMount()', fiberInstance, parentInstance);\n     }\n \n     const isProfilingSupported = fiber.hasOwnProperty('treeBaseDuration');\n@@ -2422,7 +2427,7 @@ export function attach(\n   function recordUnmount(fiberInstance: FiberInstance): void {\n     const fiber = fiberInstance.data;\n     if (__DEBUG__) {\n-      debug('recordUnmount()', fiber, null);\n+      debug('recordUnmount()', fiberInstance, reconcilingParent);\n     }\n \n     if (trackedPathMatchInstance === fiberInstance) {\n@@ -2757,15 +2762,14 @@ export function attach(\n     fiber: Fiber,\n     traceNearestHostComponentUpdate: boolean,\n   ): void {\n-    if (__DEBUG__) {\n-      debug('mountFiberRecursively()', fiber, reconcilingParent);\n-    }\n-\n     const shouldIncludeInTree = !shouldFilterFiber(fiber);\n     let newInstance = null;\n     if (shouldIncludeInTree) {\n       newInstance = recordMount(fiber, reconcilingParent);\n       insertChild(newInstance);\n+      if (__DEBUG__) {\n+        debug('mountFiberRecursively()', newInstance, reconcilingParent);\n+      }\n     } else if (\n       reconcilingParent !== null &&\n       reconcilingParent.kind === VIRTUAL_INSTANCE\n@@ -2785,6 +2789,9 @@ export function attach(\n \n       newInstance = createFilteredFiberInstance(fiber);\n       insertChild(newInstance);\n+      if (__DEBUG__) {\n+        debug('mountFiberRecursively()', newInstance, reconcilingParent);\n+      }\n     }\n \n     // If we have the tree selection from previous reload, try to match this Fiber.\n@@ -2898,9 +2905,7 @@ export function attach(\n   // when we switch from primary to fallback, or deleting a subtree.\n   function unmountInstanceRecursively(instance: DevToolsInstance) {\n     if (__DEBUG__) {\n-      if (instance.kind === FIBER_INSTANCE) {\n-        debug('unmountInstanceRecursively()', instance.data, null);\n-      }\n+      debug('unmountInstanceRecursively()', instance, reconcilingParent);\n     }\n \n     const stashedParent = reconcilingParent;\n@@ -3034,13 +3039,10 @@ export function attach(\n     parentInstance: FiberInstance | VirtualInstance,\n   ) {\n     if (__DEBUG__) {\n-      if (\n-        parentInstance.firstChild !== null &&\n-        parentInstance.firstChild.kind === FIBER_INSTANCE\n-      ) {\n+      if (parentInstance.firstChild !== null) {\n         debug(\n           'recordResetChildren()',\n-          parentInstance.firstChild.data,\n+          parentInstance.firstChild,\n           parentInstance,\n         );\n       }\n@@ -3417,7 +3419,9 @@ export function attach(\n     traceNearestHostComponentUpdate: boolean,\n   ): boolean {\n     if (__DEBUG__) {\n-      debug('updateFiberRecursively()', nextFiber, reconcilingParent);\n+      if (fiberInstance !== null) {\n+        debug('updateFiberRecursively()', fiberInstance, reconcilingParent);\n+      }\n     }\n \n     if (traceUpdatesEnabled) {"
            }
        ]
    },
    {
        "prompt": "issue: [Fiber] Move runWithFiberInDEV from CommitWork to CommitEffects | description: Stacked on #30881.\r\n\r\nMove `runWithFiberInDEV` from the recursive part of the commit phase and instead wrap each call into user space. These should really map 1:1 with where we're using `try/catch` since that's where we're calling into user space.\r\n\r\nThe goal of this is to avoid the extra stack frames added by `enableOwnerStacks` in the recursive parts to avoid stack overflow. This way we only have a couple of extra at the end of the stack instead of a couple of extra at every depth of the tree.",
        "completion": [
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -98,7 +98,6 @@ import {\n   FormReset,\n   Cloned,\n } from './ReactFiberFlags';\n-import {runWithFiberInDEV} from './ReactCurrentFiber';\n import {\n   isCurrentUpdateNested,\n   getCommitTime,\n@@ -289,11 +288,7 @@ function commitBeforeMutationEffects_begin() {\n function commitBeforeMutationEffects_complete() {\n   while (nextEffect !== null) {\n     const fiber = nextEffect;\n-    if (__DEV__) {\n-      runWithFiberInDEV(fiber, commitBeforeMutationEffectsOnFiber, fiber);\n-    } else {\n-      commitBeforeMutationEffectsOnFiber(fiber);\n-    }\n+    commitBeforeMutationEffectsOnFiber(fiber);\n \n     const sibling = fiber.sibling;\n     if (sibling !== null) {\n@@ -1645,17 +1640,7 @@ export function commitMutationEffects(\n   inProgressLanes = committedLanes;\n   inProgressRoot = root;\n \n-  if (__DEV__) {\n-    runWithFiberInDEV(\n-      finishedWork,\n-      commitMutationEffectsOnFiber,\n-      finishedWork,\n-      root,\n-      committedLanes,\n-    );\n-  } else {\n-    commitMutationEffectsOnFiber(finishedWork, root, committedLanes);\n-  }\n+  commitMutationEffectsOnFiber(finishedWork, root, committedLanes);\n \n   inProgressLanes = null;\n   inProgressRoot = null;\n@@ -1682,17 +1667,7 @@ function recursivelyTraverseMutationEffects(\n   ) {\n     let child = parentFiber.child;\n     while (child !== null) {\n-      if (__DEV__) {\n-        runWithFiberInDEV(\n-          child,\n-          commitMutationEffectsOnFiber,\n-          child,\n-          root,\n-          lanes,\n-        );\n-      } else {\n-        commitMutationEffectsOnFiber(child, root, lanes);\n-      }\n+      commitMutationEffectsOnFiber(child, root, lanes);\n       child = child.sibling;\n     }\n   }\n@@ -2235,18 +2210,7 @@ export function commitLayoutEffects(\n   inProgressRoot = root;\n \n   const current = finishedWork.alternate;\n-  if (__DEV__) {\n-    runWithFiberInDEV(\n-      finishedWork,\n-      commitLayoutEffectOnFiber,\n-      root,\n-      current,\n-      finishedWork,\n-      committedLanes,\n-    );\n-  } else {\n-    commitLayoutEffectOnFiber(root, current, finishedWork, committedLanes);\n-  }\n+  commitLayoutEffectOnFiber(root, current, finishedWork, committedLanes);\n \n   inProgressLanes = null;\n   inProgressRoot = null;\n@@ -2261,18 +2225,7 @@ function recursivelyTraverseLayoutEffects(\n     let child = parentFiber.child;\n     while (child !== null) {\n       const current = child.alternate;\n-      if (__DEV__) {\n-        runWithFiberInDEV(\n-          child,\n-          commitLayoutEffectOnFiber,\n-          root,\n-          current,\n-          child,\n-          lanes,\n-        );\n-      } else {\n-        commitLayoutEffectOnFiber(root, current, child, lanes);\n-      }\n+      commitLayoutEffectOnFiber(root, current, child, lanes);\n       child = child.sibling;\n     }\n   }\n@@ -2529,23 +2482,12 @@ function recursivelyTraverseReappearLayoutEffects(\n   let child = parentFiber.child;\n   while (child !== null) {\n     const current = child.alternate;\n-    if (__DEV__) {\n-      runWithFiberInDEV(\n-        child,\n-        reappearLayoutEffects,\n-        finishedRoot,\n-        current,\n-        child,\n-        childShouldIncludeWorkInProgressEffects,\n-      );\n-    } else {\n-      reappearLayoutEffects(\n-        finishedRoot,\n-        current,\n-        child,\n-        childShouldIncludeWorkInProgressEffects,\n-      );\n-    }\n+    reappearLayoutEffects(\n+      finishedRoot,\n+      current,\n+      child,\n+      childShouldIncludeWorkInProgressEffects,\n+    );\n     child = child.sibling;\n   }\n }\n@@ -2696,23 +2638,12 @@ export function commitPassiveMountEffects(\n   committedLanes: Lanes,\n   committedTransitions: Array<Transition> | null,\n ): void {\n-  if (__DEV__) {\n-    runWithFiberInDEV(\n-      finishedWork,\n-      commitPassiveMountOnFiber,\n-      root,\n-      finishedWork,\n-      committedLanes,\n-      committedTransitions,\n-    );\n-  } else {\n-    commitPassiveMountOnFiber(\n-      root,\n-      finishedWork,\n-      committedLanes,\n-      committedTransitions,\n-    );\n-  }\n+  commitPassiveMountOnFiber(\n+    root,\n+    finishedWork,\n+    committedLanes,\n+    committedTransitions,\n+  );\n }\n \n function recursivelyTraversePassiveMountEffects(\n@@ -2724,23 +2655,12 @@ function recursivelyTraversePassiveMountEffects(\n   if (parentFiber.subtreeFlags & PassiveMask) {\n     let child = parentFiber.child;\n     while (child !== null) {\n-      if (__DEV__) {\n-        runWithFiberInDEV(\n-          child,\n-          commitPassiveMountOnFiber,\n-          root,\n-          child,\n-          committedLanes,\n-          committedTransitions,\n-        );\n-      } else {\n-        commitPassiveMountOnFiber(\n-          root,\n-          child,\n-          committedLanes,\n-          committedTransitions,\n-        );\n-      }\n+      commitPassiveMountOnFiber(\n+        root,\n+        child,\n+        committedLanes,\n+        committedTransitions,\n+      );\n       child = child.sibling;\n     }\n   }\n@@ -2982,25 +2902,13 @@ function recursivelyTraverseReconnectPassiveEffects(\n   // TODO (Offscreen) Check: flags & (RefStatic | LayoutStatic)\n   let child = parentFiber.child;\n   while (child !== null) {\n-    if (__DEV__) {\n-      runWithFiberInDEV(\n-        child,\n-        reconnectPassiveEffects,\n-        finishedRoot,\n-        child,\n-        committedLanes,\n-        committedTransitions,\n-        childShouldIncludeWorkInProgressEffects,\n-      );\n-    } else {\n-      reconnectPassiveEffects(\n-        finishedRoot,\n-        child,\n-        committedLanes,\n-        committedTransitions,\n-        childShouldIncludeWorkInProgressEffects,\n-      );\n-    }\n+    reconnectPassiveEffects(\n+      finishedRoot,\n+      child,\n+      committedLanes,\n+      committedTransitions,\n+      childShouldIncludeWorkInProgressEffects,\n+    );\n     child = child.sibling;\n   }\n }\n@@ -3182,23 +3090,12 @@ function recursivelyTraverseAtomicPassiveEffects(\n   if (parentFiber.subtreeFlags & PassiveMask) {\n     let child = parentFiber.child;\n     while (child !== null) {\n-      if (__DEV__) {\n-        runWithFiberInDEV(\n-          child,\n-          commitAtomicPassiveEffects,\n-          finishedRoot,\n-          child,\n-          committedLanes,\n-          committedTransitions,\n-        );\n-      } else {\n-        commitAtomicPassiveEffects(\n-          finishedRoot,\n-          child,\n-          committedLanes,\n-          committedTransitions,\n-        );\n-      }\n+      commitAtomicPassiveEffects(\n+        finishedRoot,\n+        child,\n+        committedLanes,\n+        committedTransitions,\n+      );\n       child = child.sibling;\n     }\n   }\n@@ -3257,11 +3154,7 @@ function commitAtomicPassiveEffects(\n }\n \n export function commitPassiveUnmountEffects(finishedWork: Fiber): void {\n-  if (__DEV__) {\n-    runWithFiberInDEV(finishedWork, commitPassiveUnmountOnFiber, finishedWork);\n-  } else {\n-    commitPassiveUnmountOnFiber(finishedWork);\n-  }\n+  commitPassiveUnmountOnFiber(finishedWork);\n }\n \n // If we're inside a brand new tree, or a tree that was already visible, then we\n@@ -3412,11 +3305,7 @@ function recursivelyTraversePassiveUnmountEffects(parentFiber: Fiber): void {\n   if (parentFiber.subtreeFlags & PassiveMask) {\n     let child = parentFiber.child;\n     while (child !== null) {\n-      if (__DEV__) {\n-        runWithFiberInDEV(child, commitPassiveUnmountOnFiber, child);\n-      } else {\n-        commitPassiveUnmountOnFiber(child);\n-      }\n+      commitPassiveUnmountOnFiber(child);\n       child = child.sibling;\n     }\n   }\n@@ -3493,11 +3382,7 @@ function recursivelyTraverseDisconnectPassiveEffects(parentFiber: Fiber): void {\n   // TODO: Check PassiveStatic flag\n   let child = parentFiber.child;\n   while (child !== null) {\n-    if (__DEV__) {\n-      runWithFiberInDEV(child, disconnectPassiveEffect, child);\n-    } else {\n-      disconnectPassiveEffect(child);\n-    }\n+    disconnectPassiveEffect(child);\n     child = child.sibling;\n   }\n }\n@@ -3544,19 +3429,7 @@ function commitPassiveUnmountEffectsInsideOfDeletedTree_begin(\n \n     // Deletion effects fire in parent -> child order\n     // TODO: Check if fiber has a PassiveStatic flag\n-    if (__DEV__) {\n-      runWithFiberInDEV(\n-        fiber,\n-        commitPassiveUnmountInsideDeletedTreeOnFiber,\n-        fiber,\n-        nearestMountedAncestor,\n-      );\n-    } else {\n-      commitPassiveUnmountInsideDeletedTreeOnFiber(\n-        fiber,\n-        nearestMountedAncestor,\n-      );\n-    }\n+    commitPassiveUnmountInsideDeletedTreeOnFiber(fiber, nearestMountedAncestor);\n \n     const child = fiber.child;\n     // TODO: Only traverse subtree if it has a PassiveStatic flag."
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitHostEffects.js",
                "git_diff": "@@ -52,12 +52,25 @@ import {\n } from './ReactFiberConfig';\n import {captureCommitPhaseError} from './ReactFiberWorkLoop';\n \n+import {runWithFiberInDEV} from './ReactCurrentFiber';\n+\n export function commitHostMount(finishedWork: Fiber) {\n   const type = finishedWork.type;\n   const props = finishedWork.memoizedProps;\n   const instance: Instance = finishedWork.stateNode;\n   try {\n-    commitMount(instance, type, props, finishedWork);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        finishedWork,\n+        commitMount,\n+        instance,\n+        type,\n+        props,\n+        finishedWork,\n+      );\n+    } else {\n+      commitMount(instance, type, props, finishedWork);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -69,13 +82,25 @@ export function commitHostUpdate(\n   oldProps: any,\n ) {\n   try {\n-    commitUpdate(\n-      finishedWork.stateNode,\n-      finishedWork.type,\n-      oldProps,\n-      newProps,\n-      finishedWork,\n-    );\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        finishedWork,\n+        commitUpdate,\n+        finishedWork.stateNode,\n+        finishedWork.type,\n+        oldProps,\n+        newProps,\n+        finishedWork,\n+      );\n+    } else {\n+      commitUpdate(\n+        finishedWork.stateNode,\n+        finishedWork.type,\n+        oldProps,\n+        newProps,\n+        finishedWork,\n+      );\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -88,7 +113,17 @@ export function commitHostTextUpdate(\n ) {\n   const textInstance: TextInstance = finishedWork.stateNode;\n   try {\n-    commitTextUpdate(textInstance, oldText, newText);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        finishedWork,\n+        commitTextUpdate,\n+        textInstance,\n+        oldText,\n+        newText,\n+      );\n+    } else {\n+      commitTextUpdate(textInstance, oldText, newText);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -97,7 +132,11 @@ export function commitHostTextUpdate(\n export function commitHostResetTextContent(finishedWork: Fiber) {\n   const instance: Instance = finishedWork.stateNode;\n   try {\n-    resetTextContent(instance);\n+    if (__DEV__) {\n+      runWithFiberInDEV(finishedWork, resetTextContent, instance);\n+    } else {\n+      resetTextContent(instance);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -107,9 +146,22 @@ export function commitShowHideHostInstance(node: Fiber, isHidden: boolean) {\n   try {\n     const instance = node.stateNode;\n     if (isHidden) {\n-      hideInstance(instance);\n+      if (__DEV__) {\n+        runWithFiberInDEV(node, hideInstance, instance);\n+      } else {\n+        hideInstance(instance);\n+      }\n     } else {\n-      unhideInstance(node.stateNode, node.memoizedProps);\n+      if (__DEV__) {\n+        runWithFiberInDEV(\n+          node,\n+          unhideInstance,\n+          node.stateNode,\n+          node.memoizedProps,\n+        );\n+      } else {\n+        unhideInstance(node.stateNode, node.memoizedProps);\n+      }\n     }\n   } catch (error) {\n     captureCommitPhaseError(node, node.return, error);\n@@ -120,9 +172,22 @@ export function commitShowHideHostTextInstance(node: Fiber, isHidden: boolean) {\n   try {\n     const instance = node.stateNode;\n     if (isHidden) {\n-      hideTextInstance(instance);\n+      if (__DEV__) {\n+        runWithFiberInDEV(node, hideTextInstance, instance);\n+      } else {\n+        hideTextInstance(instance);\n+      }\n     } else {\n-      unhideTextInstance(instance, node.memoizedProps);\n+      if (__DEV__) {\n+        runWithFiberInDEV(\n+          node,\n+          unhideTextInstance,\n+          instance,\n+          node.memoizedProps,\n+        );\n+      } else {\n+        unhideTextInstance(instance, node.memoizedProps);\n+      }\n     }\n   } catch (error) {\n     captureCommitPhaseError(node, node.return, error);\n@@ -332,7 +397,11 @@ function commitPlacement(finishedWork: Fiber): void {\n \n export function commitHostPlacement(finishedWork: Fiber) {\n   try {\n-    commitPlacement(finishedWork);\n+    if (__DEV__) {\n+      runWithFiberInDEV(finishedWork, commitPlacement, finishedWork);\n+    } else {\n+      commitPlacement(finishedWork);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -345,7 +414,16 @@ export function commitHostRemoveChildFromContainer(\n   hostInstance: Instance | TextInstance,\n ) {\n   try {\n-    removeChildFromContainer(parentContainer, hostInstance);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        deletedFiber,\n+        removeChildFromContainer,\n+        parentContainer,\n+        hostInstance,\n+      );\n+    } else {\n+      removeChildFromContainer(parentContainer, hostInstance);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(deletedFiber, nearestMountedAncestor, error);\n   }\n@@ -358,7 +436,16 @@ export function commitHostRemoveChild(\n   hostInstance: Instance | TextInstance,\n ) {\n   try {\n-    removeChild(parentInstance, hostInstance);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        deletedFiber,\n+        removeChild,\n+        parentInstance,\n+        hostInstance,\n+      );\n+    } else {\n+      removeChild(parentInstance, hostInstance);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(deletedFiber, nearestMountedAncestor, error);\n   }\n@@ -371,7 +458,16 @@ export function commitHostRootContainerChildren(\n   const containerInfo = root.containerInfo;\n   const pendingChildren = root.pendingChildren;\n   try {\n-    replaceContainerChildren(containerInfo, pendingChildren);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        finishedWork,\n+        replaceContainerChildren,\n+        containerInfo,\n+        pendingChildren,\n+      );\n+    } else {\n+      replaceContainerChildren(containerInfo, pendingChildren);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -388,7 +484,16 @@ export function commitHostPortalContainerChildren(\n ) {\n   const containerInfo = portal.containerInfo;\n   try {\n-    replaceContainerChildren(containerInfo, pendingChildren);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        finishedWork,\n+        replaceContainerChildren,\n+        containerInfo,\n+        pendingChildren,\n+      );\n+    } else {\n+      replaceContainerChildren(containerInfo, pendingChildren);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -399,7 +504,15 @@ export function commitHostHydratedContainer(\n   finishedWork: Fiber,\n ) {\n   try {\n-    commitHydratedContainer(root.containerInfo);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        finishedWork,\n+        commitHydratedContainer,\n+        root.containerInfo,\n+      );\n+    } else {\n+      commitHydratedContainer(root.containerInfo);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -410,7 +523,15 @@ export function commitHostHydratedSuspense(\n   finishedWork: Fiber,\n ) {\n   try {\n-    commitHydratedSuspenseInstance(suspenseInstance);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        finishedWork,\n+        commitHydratedSuspenseInstance,\n+        suspenseInstance,\n+      );\n+    } else {\n+      commitHydratedSuspenseInstance(suspenseInstance);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n@@ -423,7 +544,23 @@ export function commitHostSingleton(finishedWork: Fiber) {\n   try {\n     // This was a new mount, we need to clear and set initial properties\n     clearSingleton(singleton);\n-    acquireSingletonInstance(finishedWork.type, props, singleton, finishedWork);\n+    if (__DEV__) {\n+      runWithFiberInDEV(\n+        finishedWork,\n+        acquireSingletonInstance,\n+        finishedWork.type,\n+        props,\n+        singleton,\n+        finishedWork,\n+      );\n+    } else {\n+      acquireSingletonInstance(\n+        finishedWork.type,\n+        props,\n+        singleton,\n+        finishedWork,\n+      );\n+    }\n   } catch (error) {\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitEffects.js",
                "git_diff": "@@ -75,6 +75,8 @@ import {\n   callDestroyInDEV,\n } from './ReactFiberCallUserSpace';\n \n+import {runWithFiberInDEV} from './ReactCurrentFiber';\n+\n function shouldProfile(current: Fiber): boolean {\n   return (\n     enableProfilerTimer &&\n@@ -128,7 +130,7 @@ export function commitHookEffectListMount(\n             if ((flags & HookInsertion) !== NoHookEffect) {\n               setIsRunningInsertionEffect(true);\n             }\n-            destroy = callCreateInDEV(effect);\n+            destroy = runWithFiberInDEV(finishedWork, callCreateInDEV, effect);\n             if ((flags & HookInsertion) !== NoHookEffect) {\n               setIsRunningInsertionEffect(false);\n             }\n@@ -330,7 +332,12 @@ export function commitClassLayoutLifecycles(\n     if (shouldProfile(finishedWork)) {\n       startLayoutEffectTimer();\n       if (__DEV__) {\n-        callComponentDidMountInDEV(finishedWork, instance);\n+        runWithFiberInDEV(\n+          finishedWork,\n+          callComponentDidMountInDEV,\n+          finishedWork,\n+          instance,\n+        );\n       } else {\n         try {\n           instance.componentDidMount();\n@@ -341,7 +348,12 @@ export function commitClassLayoutLifecycles(\n       recordLayoutEffectDuration(finishedWork);\n     } else {\n       if (__DEV__) {\n-        callComponentDidMountInDEV(finishedWork, instance);\n+        runWithFiberInDEV(\n+          finishedWork,\n+          callComponentDidMountInDEV,\n+          finishedWork,\n+          instance,\n+        );\n       } else {\n         try {\n           instance.componentDidMount();\n@@ -391,7 +403,9 @@ export function commitClassLayoutLifecycles(\n     if (shouldProfile(finishedWork)) {\n       startLayoutEffectTimer();\n       if (__DEV__) {\n-        callComponentDidUpdateInDEV(\n+        runWithFiberInDEV(\n+          finishedWork,\n+          callComponentDidUpdateInDEV,\n           finishedWork,\n           instance,\n           prevProps,\n@@ -412,7 +426,9 @@ export function commitClassLayoutLifecycles(\n       recordLayoutEffectDuration(finishedWork);\n     } else {\n       if (__DEV__) {\n-        callComponentDidUpdateInDEV(\n+        runWithFiberInDEV(\n+          finishedWork,\n+          callComponentDidUpdateInDEV,\n           finishedWork,\n           instance,\n           prevProps,\n@@ -439,7 +455,12 @@ export function commitClassDidMount(finishedWork: Fiber) {\n   const instance = finishedWork.stateNode;\n   if (typeof instance.componentDidMount === 'function') {\n     if (__DEV__) {\n-      callComponentDidMountInDEV(finishedWork, instance);\n+      runWithFiberInDEV(\n+        finishedWork,\n+        callComponentDidMountInDEV,\n+        finishedWork,\n+        instance,\n+      );\n     } else {\n       try {\n         instance.componentDidMount();\n@@ -619,7 +640,13 @@ export function safelyCallComponentWillUnmount(\n   if (shouldProfile(current)) {\n     startLayoutEffectTimer();\n     if (__DEV__) {\n-      callComponentWillUnmountInDEV(current, nearestMountedAncestor, instance);\n+      runWithFiberInDEV(\n+        current,\n+        callComponentWillUnmountInDEV,\n+        current,\n+        nearestMountedAncestor,\n+        instance,\n+      );\n     } else {\n       try {\n         instance.componentWillUnmount();\n@@ -630,7 +657,13 @@ export function safelyCallComponentWillUnmount(\n     recordLayoutEffectDuration(current);\n   } else {\n     if (__DEV__) {\n-      callComponentWillUnmountInDEV(current, nearestMountedAncestor, instance);\n+      runWithFiberInDEV(\n+        current,\n+        callComponentWillUnmountInDEV,\n+        current,\n+        nearestMountedAncestor,\n+        instance,\n+      );\n     } else {\n       try {\n         instance.componentWillUnmount();\n@@ -761,7 +794,13 @@ export function safelyCallDestroy(\n   destroy: () => void,\n ) {\n   if (__DEV__) {\n-    callDestroyInDEV(current, nearestMountedAncestor, destroy);\n+    runWithFiberInDEV(\n+      current,\n+      callDestroyInDEV,\n+      current,\n+      nearestMountedAncestor,\n+      destroy,\n+    );\n   } else {\n     try {\n       destroy();"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitEffects.js",
                "git_diff": "@@ -510,7 +510,11 @@ export function commitClassCallbacks(finishedWork: Fiber) {\n     // but instead we rely on them being set during last render.\n     // TODO: revisit this when we implement resuming.\n     try {\n-      commitCallbacks(updateQueue, instance);\n+      if (__DEV__) {\n+        runWithFiberInDEV(finishedWork, commitCallbacks, updateQueue, instance);\n+      } else {\n+        commitCallbacks(updateQueue, instance);\n+      }\n     } catch (error) {\n       captureCommitPhaseError(finishedWork, finishedWork.return, error);\n     }\n@@ -525,7 +529,16 @@ export function commitClassHiddenCallbacks(finishedWork: Fiber) {\n   if (updateQueue !== null) {\n     const instance = finishedWork.stateNode;\n     try {\n-      commitHiddenCallbacks(updateQueue, instance);\n+      if (__DEV__) {\n+        runWithFiberInDEV(\n+          finishedWork,\n+          commitHiddenCallbacks,\n+          updateQueue,\n+          instance,\n+        );\n+      } else {\n+        commitHiddenCallbacks(updateQueue, instance);\n+      }\n     } catch (error) {\n       captureCommitPhaseError(finishedWork, finishedWork.return, error);\n     }\n@@ -551,7 +564,11 @@ export function commitRootCallbacks(finishedWork: Fiber) {\n       }\n     }\n     try {\n-      commitCallbacks(updateQueue, instance);\n+      if (__DEV__) {\n+        runWithFiberInDEV(finishedWork, commitCallbacks, updateQueue, instance);\n+      } else {\n+        commitCallbacks(updateQueue, instance);\n+      }\n     } catch (error) {\n       captureCommitPhaseError(finishedWork, finishedWork.return, error);\n     }\n@@ -563,6 +580,14 @@ if (__DEV__) {\n   didWarnAboutUndefinedSnapshotBeforeUpdate = new Set();\n }\n \n+function callGetSnapshotBeforeUpdates(\n+  instance: any,\n+  prevProps: any,\n+  prevState: any,\n+) {\n+  return instance.getSnapshotBeforeUpdate(prevProps, prevState);\n+}\n+\n export function commitClassSnapshot(finishedWork: Fiber, current: Fiber) {\n   const prevProps = current.memoizedProps;\n   const prevState = current.memoizedState;\n@@ -599,15 +624,20 @@ export function commitClassSnapshot(finishedWork: Fiber, current: Fiber) {\n     }\n   }\n   try {\n-    const snapshot = instance.getSnapshotBeforeUpdate(\n-      resolveClassComponentProps(\n-        finishedWork.type,\n-        prevProps,\n-        finishedWork.elementType === finishedWork.type,\n-      ),\n-      prevState,\n+    const resolvedPrevProps = resolveClassComponentProps(\n+      finishedWork.type,\n+      prevProps,\n+      finishedWork.elementType === finishedWork.type,\n     );\n+    let snapshot;\n     if (__DEV__) {\n+      snapshot = runWithFiberInDEV(\n+        finishedWork,\n+        callGetSnapshotBeforeUpdates,\n+        instance,\n+        resolvedPrevProps,\n+        prevState,\n+      );\n       const didWarnSet =\n         ((didWarnAboutUndefinedSnapshotBeforeUpdate: any): Set<mixed>);\n       if (snapshot === undefined && !didWarnSet.has(finishedWork.type)) {\n@@ -618,6 +648,12 @@ export function commitClassSnapshot(finishedWork: Fiber, current: Fiber) {\n           getComponentNameFromFiber(finishedWork),\n         );\n       }\n+    } else {\n+      snapshot = callGetSnapshotBeforeUpdates(\n+        instance,\n+        resolvedPrevProps,\n+        prevState,\n+      );\n     }\n     instance.__reactInternalSnapshotBeforeUpdate = snapshot;\n   } catch (error) {\n@@ -730,7 +766,11 @@ export function safelyAttachRef(\n   nearestMountedAncestor: Fiber | null,\n ) {\n   try {\n-    commitAttachRef(current);\n+    if (__DEV__) {\n+      runWithFiberInDEV(current, commitAttachRef, current);\n+    } else {\n+      commitAttachRef(current);\n+    }\n   } catch (error) {\n     captureCommitPhaseError(current, nearestMountedAncestor, error);\n   }\n@@ -749,12 +789,20 @@ export function safelyDetachRef(\n         if (shouldProfile(current)) {\n           try {\n             startLayoutEffectTimer();\n-            refCleanup();\n+            if (__DEV__) {\n+              runWithFiberInDEV(current, refCleanup);\n+            } else {\n+              refCleanup();\n+            }\n           } finally {\n             recordLayoutEffectDuration(current);\n           }\n         } else {\n-          refCleanup();\n+          if (__DEV__) {\n+            runWithFiberInDEV(current, refCleanup);\n+          } else {\n+            refCleanup();\n+          }\n         }\n       } catch (error) {\n         captureCommitPhaseError(current, nearestMountedAncestor, error);\n@@ -771,12 +819,20 @@ export function safelyDetachRef(\n         if (shouldProfile(current)) {\n           try {\n             startLayoutEffectTimer();\n-            ref(null);\n+            if (__DEV__) {\n+              (runWithFiberInDEV(current, ref, null): void);\n+            } else {\n+              ref(null);\n+            }\n           } finally {\n             recordLayoutEffectDuration(current);\n           }\n         } else {\n-          ref(null);\n+          if (__DEV__) {\n+            (runWithFiberInDEV(current, ref, null): void);\n+          } else {\n+            ref(null);\n+          }\n         }\n       } catch (error) {\n         captureCommitPhaseError(current, nearestMountedAncestor, error);\n@@ -810,6 +866,44 @@ export function safelyCallDestroy(\n   }\n }\n \n+function commitProfiler(\n+  finishedWork: Fiber,\n+  current: Fiber | null,\n+  commitTime: number,\n+  effectDuration: number,\n+) {\n+  const {onCommit, onRender} = finishedWork.memoizedProps;\n+\n+  let phase = current === null ? 'mount' : 'update';\n+  if (enableProfilerNestedUpdatePhase) {\n+    if (isCurrentUpdateNested()) {\n+      phase = 'nested-update';\n+    }\n+  }\n+\n+  if (typeof onRender === 'function') {\n+    onRender(\n+      finishedWork.memoizedProps.id,\n+      phase,\n+      finishedWork.actualDuration,\n+      finishedWork.treeBaseDuration,\n+      finishedWork.actualStartTime,\n+      commitTime,\n+    );\n+  }\n+\n+  if (enableProfilerCommitHooks) {\n+    if (typeof onCommit === 'function') {\n+      onCommit(\n+        finishedWork.memoizedProps.id,\n+        phase,\n+        effectDuration,\n+        commitTime,\n+      );\n+    }\n+  }\n+}\n+\n export function commitProfilerUpdate(\n   finishedWork: Fiber,\n   current: Fiber | null,\n@@ -818,35 +912,17 @@ export function commitProfilerUpdate(\n ) {\n   if (enableProfilerTimer && getExecutionContext() & CommitContext) {\n     try {\n-      const {onCommit, onRender} = finishedWork.memoizedProps;\n-\n-      let phase = current === null ? 'mount' : 'update';\n-      if (enableProfilerNestedUpdatePhase) {\n-        if (isCurrentUpdateNested()) {\n-          phase = 'nested-update';\n-        }\n-      }\n-\n-      if (typeof onRender === 'function') {\n-        onRender(\n-          finishedWork.memoizedProps.id,\n-          phase,\n-          finishedWork.actualDuration,\n-          finishedWork.treeBaseDuration,\n-          finishedWork.actualStartTime,\n+      if (__DEV__) {\n+        runWithFiberInDEV(\n+          finishedWork,\n+          commitProfiler,\n+          finishedWork,\n+          current,\n           commitTime,\n+          effectDuration,\n         );\n-      }\n-\n-      if (enableProfilerCommitHooks) {\n-        if (typeof onCommit === 'function') {\n-          onCommit(\n-            finishedWork.memoizedProps.id,\n-            phase,\n-            effectDuration,\n-            commitTime,\n-          );\n-        }\n+      } else {\n+        commitProfiler(finishedWork, current, commitTime, effectDuration);\n       }\n     } catch (error) {\n       captureCommitPhaseError(finishedWork, finishedWork.return, error);"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitEffects.js",
                "git_diff": "@@ -184,9 +184,16 @@ export function commitHookEffectListMount(\n               } else {\n                 addendum = ' You returned: ' + destroy;\n               }\n-              console.error(\n-                '%s must not return anything besides a function, ' +\n-                  'which is used for clean-up.%s',\n+              runWithFiberInDEV(\n+                finishedWork,\n+                (n, a) => {\n+                  console.error(\n+                    '%s must not return anything besides a function, ' +\n+                      'which is used for clean-up.%s',\n+                    n,\n+                    a,\n+                  );\n+                },\n                 hookName,\n                 addendum,\n               );\n@@ -642,11 +649,13 @@ export function commitClassSnapshot(finishedWork: Fiber, current: Fiber) {\n         ((didWarnAboutUndefinedSnapshotBeforeUpdate: any): Set<mixed>);\n       if (snapshot === undefined && !didWarnSet.has(finishedWork.type)) {\n         didWarnSet.add(finishedWork.type);\n-        console.error(\n-          '%s.getSnapshotBeforeUpdate(): A snapshot value (or null) ' +\n-            'must be returned. You have returned undefined.',\n-          getComponentNameFromFiber(finishedWork),\n-        );\n+        runWithFiberInDEV(finishedWork, () => {\n+          console.error(\n+            '%s.getSnapshotBeforeUpdate(): A snapshot value (or null) ' +\n+              'must be returned. You have returned undefined.',\n+            getComponentNameFromFiber(finishedWork),\n+          );\n+        });\n       }\n     } else {\n       snapshot = callGetSnapshotBeforeUpdates("
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspenseCallback-test.js",
                "git_diff": "@@ -57,9 +57,10 @@ describe('ReactSuspense', () => {\n     );\n \n     ReactNoop.render(elementBadType);\n-    await expect(async () => await waitForAll([])).toErrorDev([\n-      'Unexpected type for suspenseCallback.',\n-    ]);\n+    await expect(async () => await waitForAll([])).toErrorDev(\n+      ['Unexpected type for suspenseCallback.'],\n+      {withoutStack: true},\n+    );\n \n     const elementMissingCallback = (\n       <React.Suspense fallback={'Waiting'}>"
            }
        ]
    },
    {
        "prompt": "issue: [DevTools] Track root instances in a root Map | description: The FiberRoot is a stateful node that can be tracked this way.\r\n\r\nThis is another step that will let us remove the `fiberToFiberInstanceMap`.",
        "completion": [
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -114,7 +114,7 @@ import {getStyleXData} from '../StyleX/utils';\n import {createProfilingHooks} from '../profilingHooks';\n \n import type {GetTimelineData, ToggleProfilingStatus} from '../profilingHooks';\n-import type {Fiber} from 'react-reconciler/src/ReactInternalTypes';\n+import type {Fiber, FiberRoot} from 'react-reconciler/src/ReactInternalTypes';\n import type {\n   ChangeDescription,\n   CommitDataBackend,\n@@ -727,6 +727,9 @@ export function getInternalReactConstants(version: string): {\n // filters at the same time as removing some other filter.\n const knownEnvironmentNames: Set<string> = new Set();\n \n+// Map of FiberRoot to their root FiberInstance.\n+const rootToFiberInstanceMap: Map<FiberRoot, FiberInstance> = new Map();\n+\n // Map of one or more Fibers in a pair to their unique id number.\n // We track both Fibers to support Fast Refresh,\n // which may forcefully replace one of the pair as part of hot reloading.\n@@ -1243,9 +1246,15 @@ export function attach(\n \n     // Recursively unmount all roots.\n     hook.getFiberRoots(rendererID).forEach(root => {\n-      const rootInstance = getFiberInstanceThrows(root.current);\n+      const rootInstance = rootToFiberInstanceMap.get(root);\n+      if (rootInstance === undefined) {\n+        throw new Error(\n+          'Expected the root instance to already exist when applying filters',\n+        );\n+      }\n       currentRootID = rootInstance.id;\n       unmountInstanceRecursively(rootInstance);\n+      rootToFiberInstanceMap.delete(root);\n       flushPendingEvents(root);\n       currentRootID = -1;\n     });\n@@ -1260,6 +1269,7 @@ export function attach(\n       const current = root.current;\n       const alternate = current.alternate;\n       const newRoot = createFiberInstance(current);\n+      rootToFiberInstanceMap.set(root, newRoot);\n       idToDevToolsInstanceMap.set(newRoot.id, newRoot);\n       fiberToFiberInstanceMap.set(current, newRoot);\n       if (alternate) {\n@@ -1479,17 +1489,6 @@ export function attach(\n   // When a mount or update is in progress, this value tracks the root that is being operated on.\n   let currentRootID: number = -1;\n \n-  // Returns a FiberInstance if one has already been generated for the Fiber or throws.\n-  function getFiberInstanceThrows(fiber: Fiber): FiberInstance {\n-    const fiberInstance = getFiberInstanceUnsafe(fiber);\n-    if (fiberInstance !== null) {\n-      return fiberInstance;\n-    }\n-    throw Error(\n-      `Could not find ID for Fiber \"${getDisplayNameForFiber(fiber) || ''}\"`,\n-    );\n-  }\n-\n   function getFiberIDThrows(fiber: Fiber): number {\n     const fiberInstance = getFiberInstanceUnsafe(fiber);\n     if (fiberInstance !== null) {\n@@ -2181,7 +2180,7 @@ export function attach(\n     const isRoot = fiber.tag === HostRoot;\n     let fiberInstance;\n     if (isRoot) {\n-      const entry = fiberToFiberInstanceMap.get(fiber);\n+      const entry = rootToFiberInstanceMap.get(fiber.stateNode);\n       if (entry === undefined) {\n         throw new Error('The root should have been registered at this point');\n       }\n@@ -3591,6 +3590,7 @@ export function attach(\n         const current = root.current;\n         const alternate = current.alternate;\n         const newRoot = createFiberInstance(current);\n+        rootToFiberInstanceMap.set(root, newRoot);\n         idToDevToolsInstanceMap.set(newRoot.id, newRoot);\n         fiberToFiberInstanceMap.set(current, newRoot);\n         if (alternate) {\n@@ -3657,15 +3657,17 @@ export function attach(\n     }\n   }\n \n-  function handleCommitFiberRoot(root: any, priorityLevel: void | number) {\n+  function handleCommitFiberRoot(\n+    root: FiberRoot,\n+    priorityLevel: void | number,\n+  ) {\n     const current = root.current;\n     const alternate = current.alternate;\n \n-    let rootInstance =\n-      fiberToFiberInstanceMap.get(current) ||\n-      (alternate && fiberToFiberInstanceMap.get(alternate));\n+    let rootInstance = rootToFiberInstanceMap.get(root);\n     if (!rootInstance) {\n       rootInstance = createFiberInstance(current);\n+      rootToFiberInstanceMap.set(root, rootInstance);\n       idToDevToolsInstanceMap.set(rootInstance.id, rootInstance);\n       fiberToFiberInstanceMap.set(current, rootInstance);\n       if (alternate) {\n@@ -3730,8 +3732,9 @@ export function attach(\n         updateFiberRecursively(rootInstance, current, alternate, false);\n       } else if (wasMounted && !isMounted) {\n         // Unmount an existing root.\n-        removeRootPseudoKey(currentRootID);\n         unmountInstanceRecursively(rootInstance);\n+        removeRootPseudoKey(currentRootID);\n+        rootToFiberInstanceMap.delete(root);\n       }\n     } else {\n       // Mount a new root.\n@@ -5248,7 +5251,12 @@ export function attach(\n     idToContextsMap = new Map();\n \n     hook.getFiberRoots(rendererID).forEach(root => {\n-      const rootInstance = getFiberInstanceThrows(root.current);\n+      const rootInstance = rootToFiberInstanceMap.get(root);\n+      if (rootInstance === undefined) {\n+        throw new Error(\n+          'Expected the root instance to already exist when starting profiling',\n+        );\n+      }\n       const rootID = rootInstance.id;\n       ((displayNamesByRootID: any): DisplayNamesByRootID).set(\n         rootID,\n@@ -5645,8 +5653,13 @@ export function attach(\n       case HostRoot:\n         // Roots don't have a real displayName, index, or key.\n         // Instead, we'll use the pseudo key (childDisplayName:indexWithThatName).\n-        const id = getFiberIDThrows(fiber);\n-        const pseudoKey = rootPseudoKeys.get(id);\n+        const rootInstance = rootToFiberInstanceMap.get(fiber.stateNode);\n+        if (rootInstance === undefined) {\n+          throw new Error(\n+            'Expected the root instance to exist when computing a path',\n+          );\n+        }\n+        const pseudoKey = rootPseudoKeys.get(rootInstance.id);\n         if (pseudoKey === undefined) {\n           throw new Error('Expected mounted root to have known pseudo key.');\n         }"
            }
        ]
    },
    {
        "prompt": "issue: NO-COMMIT Enable owner stacks for www and fbsource | description: I am just doing this to start build workflow.",
        "completion": [
            {
                "file": "packages/shared/forks/ReactFeatureFlags.native-fb.js",
                "git_diff": "@@ -66,7 +66,7 @@ export const enableLegacyCache = false;\n export const enableLegacyFBSupport = false;\n export const enableLegacyHidden = false;\n export const enableNoCloningMemoCache = false;\n-export const enableOwnerStacks = false;\n+export const enableOwnerStacks = true;\n export const enablePostpone = false;\n export const enableProfilerCommitHooks = __PROFILE__;\n export const enableProfilerNestedUpdatePhase = __PROFILE__;"
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.www.js",
                "git_diff": "@@ -124,7 +124,7 @@ export const disableStringRefs = false;\n export const disableLegacyMode: boolean =\n   __EXPERIMENTAL__ || dynamicFeatureFlags.disableLegacyMode;\n \n-export const enableOwnerStacks = false;\n+export const enableOwnerStacks = true;\n export const enableShallowPropDiffing = false;\n \n // Flow magic to verify the exports of this file match the original version."
            }
        ]
    },
    {
        "prompt": "issue: [Fiber] Extract Functions that Call User Space and Host Configs in Commit to Separate Modules | description: This is mostly just moves and same code extracted into utility functions.\r\n\r\nThis is to help clarify what needs to be wrapped in try/catch and runWithFiberInDEV. I'll do the runWithFiberInDEV changes in a follow up.\r\n\r\nThis leaves ReactCommitWork mostly to do matching on the tag and the recursive loops.\r\n",
        "completion": [
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitEffects.js",
                "git_diff": "@@ -0,0 +1,763 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ *\n+ * @flow\n+ */\n+\n+import type {Fiber} from './ReactInternalTypes';\n+import type {UpdateQueue} from './ReactFiberClassUpdateQueue';\n+import type {FunctionComponentUpdateQueue} from './ReactFiberHooks';\n+import type {HookFlags} from './ReactHookEffectTags';\n+\n+import {\n+  enableProfilerTimer,\n+  enableProfilerCommitHooks,\n+  enableProfilerNestedUpdatePhase,\n+  enableSchedulingProfiler,\n+  enableScopeAPI,\n+  disableStringRefs,\n+} from 'shared/ReactFeatureFlags';\n+import {\n+  HostComponent,\n+  HostHoistable,\n+  HostSingleton,\n+  ScopeComponent,\n+} from './ReactWorkTags';\n+import {NoFlags} from './ReactFiberFlags';\n+import getComponentNameFromFiber from 'react-reconciler/src/getComponentNameFromFiber';\n+import {resolveClassComponentProps} from './ReactFiberClassComponent';\n+import {\n+  recordLayoutEffectDuration,\n+  startLayoutEffectTimer,\n+  recordPassiveEffectDuration,\n+  startPassiveEffectTimer,\n+  isCurrentUpdateNested,\n+} from './ReactProfilerTimer';\n+import {NoMode, ProfileMode} from './ReactTypeOfMode';\n+import {commitCallbacks} from './ReactFiberClassUpdateQueue';\n+import {getPublicInstance} from './ReactFiberConfig';\n+import {\n+  captureCommitPhaseError,\n+  setIsRunningInsertionEffect,\n+  getExecutionContext,\n+  CommitContext,\n+  NoContext,\n+} from './ReactFiberWorkLoop';\n+import {\n+  NoFlags as NoHookEffect,\n+  Layout as HookLayout,\n+  Insertion as HookInsertion,\n+  Passive as HookPassive,\n+} from './ReactHookEffectTags';\n+import {didWarnAboutReassigningProps} from './ReactFiberBeginWork';\n+import {\n+  markComponentPassiveEffectMountStarted,\n+  markComponentPassiveEffectMountStopped,\n+  markComponentPassiveEffectUnmountStarted,\n+  markComponentPassiveEffectUnmountStopped,\n+  markComponentLayoutEffectMountStarted,\n+  markComponentLayoutEffectMountStopped,\n+  markComponentLayoutEffectUnmountStarted,\n+  markComponentLayoutEffectUnmountStopped,\n+} from './ReactFiberDevToolsHook';\n+import {\n+  callComponentDidMountInDEV,\n+  callComponentDidUpdateInDEV,\n+  callComponentWillUnmountInDEV,\n+  callCreateInDEV,\n+  callDestroyInDEV,\n+} from './ReactFiberCallUserSpace';\n+\n+function shouldProfile(current: Fiber): boolean {\n+  return (\n+    enableProfilerTimer &&\n+    enableProfilerCommitHooks &&\n+    (current.mode & ProfileMode) !== NoMode &&\n+    (getExecutionContext() & CommitContext) !== NoContext\n+  );\n+}\n+\n+export function commitHookLayoutEffects(\n+  finishedWork: Fiber,\n+  hookFlags: HookFlags,\n+) {\n+  // At this point layout effects have already been destroyed (during mutation phase).\n+  // This is done to prevent sibling component effects from interfering with each other,\n+  // e.g. a destroy function in one component should never override a ref set\n+  // by a create function in another component during the same commit.\n+  if (shouldProfile(finishedWork)) {\n+    try {\n+      startLayoutEffectTimer();\n+      commitHookEffectListMount(hookFlags, finishedWork);\n+    } catch (error) {\n+      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+    }\n+    recordLayoutEffectDuration(finishedWork);\n+  } else {\n+    try {\n+      commitHookEffectListMount(hookFlags, finishedWork);\n+    } catch (error) {\n+      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+    }\n+  }\n+}\n+\n+export function commitHookEffectListMount(\n+  flags: HookFlags,\n+  finishedWork: Fiber,\n+) {\n+  const updateQueue: FunctionComponentUpdateQueue | null =\n+    (finishedWork.updateQueue: any);\n+  const lastEffect = updateQueue !== null ? updateQueue.lastEffect : null;\n+  if (lastEffect !== null) {\n+    const firstEffect = lastEffect.next;\n+    let effect = firstEffect;\n+    do {\n+      if ((effect.tag & flags) === flags) {\n+        if (enableSchedulingProfiler) {\n+          if ((flags & HookPassive) !== NoHookEffect) {\n+            markComponentPassiveEffectMountStarted(finishedWork);\n+          } else if ((flags & HookLayout) !== NoHookEffect) {\n+            markComponentLayoutEffectMountStarted(finishedWork);\n+          }\n+        }\n+\n+        // Mount\n+        let destroy;\n+        if (__DEV__) {\n+          if ((flags & HookInsertion) !== NoHookEffect) {\n+            setIsRunningInsertionEffect(true);\n+          }\n+          destroy = callCreateInDEV(effect);\n+          if ((flags & HookInsertion) !== NoHookEffect) {\n+            setIsRunningInsertionEffect(false);\n+          }\n+        } else {\n+          const create = effect.create;\n+          const inst = effect.inst;\n+          destroy = create();\n+          inst.destroy = destroy;\n+        }\n+\n+        if (enableSchedulingProfiler) {\n+          if ((flags & HookPassive) !== NoHookEffect) {\n+            markComponentPassiveEffectMountStopped();\n+          } else if ((flags & HookLayout) !== NoHookEffect) {\n+            markComponentLayoutEffectMountStopped();\n+          }\n+        }\n+\n+        if (__DEV__) {\n+          if (destroy !== undefined && typeof destroy !== 'function') {\n+            let hookName;\n+            if ((effect.tag & HookLayout) !== NoFlags) {\n+              hookName = 'useLayoutEffect';\n+            } else if ((effect.tag & HookInsertion) !== NoFlags) {\n+              hookName = 'useInsertionEffect';\n+            } else {\n+              hookName = 'useEffect';\n+            }\n+            let addendum;\n+            if (destroy === null) {\n+              addendum =\n+                ' You returned null. If your effect does not require clean ' +\n+                'up, return undefined (or nothing).';\n+            } else if (typeof destroy.then === 'function') {\n+              addendum =\n+                '\\n\\nIt looks like you wrote ' +\n+                hookName +\n+                '(async () => ...) or returned a Promise. ' +\n+                'Instead, write the async function inside your effect ' +\n+                'and call it immediately:\\n\\n' +\n+                hookName +\n+                '(() => {\\n' +\n+                '  async function fetchData() {\\n' +\n+                '    // You can await here\\n' +\n+                '    const response = await MyAPI.getData(someId);\\n' +\n+                '    // ...\\n' +\n+                '  }\\n' +\n+                '  fetchData();\\n' +\n+                `}, [someId]); // Or [] if effect doesn't need props or state\\n\\n` +\n+                'Learn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching';\n+            } else {\n+              addendum = ' You returned: ' + destroy;\n+            }\n+            console.error(\n+              '%s must not return anything besides a function, ' +\n+                'which is used for clean-up.%s',\n+              hookName,\n+              addendum,\n+            );\n+          }\n+        }\n+      }\n+      effect = effect.next;\n+    } while (effect !== firstEffect);\n+  }\n+}\n+\n+export function commitHookEffectListUnmount(\n+  flags: HookFlags,\n+  finishedWork: Fiber,\n+  nearestMountedAncestor: Fiber | null,\n+) {\n+  const updateQueue: FunctionComponentUpdateQueue | null =\n+    (finishedWork.updateQueue: any);\n+  const lastEffect = updateQueue !== null ? updateQueue.lastEffect : null;\n+  if (lastEffect !== null) {\n+    const firstEffect = lastEffect.next;\n+    let effect = firstEffect;\n+    do {\n+      if ((effect.tag & flags) === flags) {\n+        // Unmount\n+        const inst = effect.inst;\n+        const destroy = inst.destroy;\n+        if (destroy !== undefined) {\n+          inst.destroy = undefined;\n+          if (enableSchedulingProfiler) {\n+            if ((flags & HookPassive) !== NoHookEffect) {\n+              markComponentPassiveEffectUnmountStarted(finishedWork);\n+            } else if ((flags & HookLayout) !== NoHookEffect) {\n+              markComponentLayoutEffectUnmountStarted(finishedWork);\n+            }\n+          }\n+\n+          if (__DEV__) {\n+            if ((flags & HookInsertion) !== NoHookEffect) {\n+              setIsRunningInsertionEffect(true);\n+            }\n+          }\n+          safelyCallDestroy(finishedWork, nearestMountedAncestor, destroy);\n+          if (__DEV__) {\n+            if ((flags & HookInsertion) !== NoHookEffect) {\n+              setIsRunningInsertionEffect(false);\n+            }\n+          }\n+\n+          if (enableSchedulingProfiler) {\n+            if ((flags & HookPassive) !== NoHookEffect) {\n+              markComponentPassiveEffectUnmountStopped();\n+            } else if ((flags & HookLayout) !== NoHookEffect) {\n+              markComponentLayoutEffectUnmountStopped();\n+            }\n+          }\n+        }\n+      }\n+      effect = effect.next;\n+    } while (effect !== firstEffect);\n+  }\n+}\n+\n+export function commitHookPassiveMountEffects(\n+  finishedWork: Fiber,\n+  hookFlags: HookFlags,\n+) {\n+  if (shouldProfile(finishedWork)) {\n+    startPassiveEffectTimer();\n+    try {\n+      commitHookEffectListMount(hookFlags, finishedWork);\n+    } catch (error) {\n+      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+    }\n+    recordPassiveEffectDuration(finishedWork);\n+  } else {\n+    try {\n+      commitHookEffectListMount(hookFlags, finishedWork);\n+    } catch (error) {\n+      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+    }\n+  }\n+}\n+\n+export function commitHookPassiveUnmountEffects(\n+  finishedWork: Fiber,\n+  nearestMountedAncestor: null | Fiber,\n+  hookFlags: HookFlags,\n+) {\n+  if (shouldProfile(finishedWork)) {\n+    startPassiveEffectTimer();\n+    commitHookEffectListUnmount(\n+      hookFlags,\n+      finishedWork,\n+      nearestMountedAncestor,\n+    );\n+    recordPassiveEffectDuration(finishedWork);\n+  } else {\n+    commitHookEffectListUnmount(\n+      hookFlags,\n+      finishedWork,\n+      nearestMountedAncestor,\n+    );\n+  }\n+}\n+\n+export function commitClassLayoutLifecycles(\n+  finishedWork: Fiber,\n+  current: Fiber | null,\n+) {\n+  const instance = finishedWork.stateNode;\n+  if (current === null) {\n+    // We could update instance props and state here,\n+    // but instead we rely on them being set during last render.\n+    // TODO: revisit this when we implement resuming.\n+    if (__DEV__) {\n+      if (\n+        !finishedWork.type.defaultProps &&\n+        !('ref' in finishedWork.memoizedProps) &&\n+        !didWarnAboutReassigningProps\n+      ) {\n+        if (instance.props !== finishedWork.memoizedProps) {\n+          console.error(\n+            'Expected %s props to match memoized props before ' +\n+              'componentDidMount. ' +\n+              'This might either be because of a bug in React, or because ' +\n+              'a component reassigns its own `this.props`. ' +\n+              'Please file an issue.',\n+            getComponentNameFromFiber(finishedWork) || 'instance',\n+          );\n+        }\n+        if (instance.state !== finishedWork.memoizedState) {\n+          console.error(\n+            'Expected %s state to match memoized state before ' +\n+              'componentDidMount. ' +\n+              'This might either be because of a bug in React, or because ' +\n+              'a component reassigns its own `this.state`. ' +\n+              'Please file an issue.',\n+            getComponentNameFromFiber(finishedWork) || 'instance',\n+          );\n+        }\n+      }\n+    }\n+    if (shouldProfile(finishedWork)) {\n+      startLayoutEffectTimer();\n+      if (__DEV__) {\n+        callComponentDidMountInDEV(finishedWork, instance);\n+      } else {\n+        try {\n+          instance.componentDidMount();\n+        } catch (error) {\n+          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+        }\n+      }\n+      recordLayoutEffectDuration(finishedWork);\n+    } else {\n+      if (__DEV__) {\n+        callComponentDidMountInDEV(finishedWork, instance);\n+      } else {\n+        try {\n+          instance.componentDidMount();\n+        } catch (error) {\n+          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+        }\n+      }\n+    }\n+  } else {\n+    const prevProps = resolveClassComponentProps(\n+      finishedWork.type,\n+      current.memoizedProps,\n+      finishedWork.elementType === finishedWork.type,\n+    );\n+    const prevState = current.memoizedState;\n+    // We could update instance props and state here,\n+    // but instead we rely on them being set during last render.\n+    // TODO: revisit this when we implement resuming.\n+    if (__DEV__) {\n+      if (\n+        !finishedWork.type.defaultProps &&\n+        !('ref' in finishedWork.memoizedProps) &&\n+        !didWarnAboutReassigningProps\n+      ) {\n+        if (instance.props !== finishedWork.memoizedProps) {\n+          console.error(\n+            'Expected %s props to match memoized props before ' +\n+              'componentDidUpdate. ' +\n+              'This might either be because of a bug in React, or because ' +\n+              'a component reassigns its own `this.props`. ' +\n+              'Please file an issue.',\n+            getComponentNameFromFiber(finishedWork) || 'instance',\n+          );\n+        }\n+        if (instance.state !== finishedWork.memoizedState) {\n+          console.error(\n+            'Expected %s state to match memoized state before ' +\n+              'componentDidUpdate. ' +\n+              'This might either be because of a bug in React, or because ' +\n+              'a component reassigns its own `this.state`. ' +\n+              'Please file an issue.',\n+            getComponentNameFromFiber(finishedWork) || 'instance',\n+          );\n+        }\n+      }\n+    }\n+    if (shouldProfile(finishedWork)) {\n+      startLayoutEffectTimer();\n+      if (__DEV__) {\n+        callComponentDidUpdateInDEV(\n+          finishedWork,\n+          instance,\n+          prevProps,\n+          prevState,\n+          instance.__reactInternalSnapshotBeforeUpdate,\n+        );\n+      } else {\n+        try {\n+          instance.componentDidUpdate(\n+            prevProps,\n+            prevState,\n+            instance.__reactInternalSnapshotBeforeUpdate,\n+          );\n+        } catch (error) {\n+          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+        }\n+      }\n+      recordLayoutEffectDuration(finishedWork);\n+    } else {\n+      if (__DEV__) {\n+        callComponentDidUpdateInDEV(\n+          finishedWork,\n+          instance,\n+          prevProps,\n+          prevState,\n+          instance.__reactInternalSnapshotBeforeUpdate,\n+        );\n+      } else {\n+        try {\n+          instance.componentDidUpdate(\n+            prevProps,\n+            prevState,\n+            instance.__reactInternalSnapshotBeforeUpdate,\n+          );\n+        } catch (error) {\n+          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+        }\n+      }\n+    }\n+  }\n+}\n+\n+export function commitClassCallbacks(finishedWork: Fiber) {\n+  // TODO: I think this is now always non-null by the time it reaches the\n+  // commit phase. Consider removing the type check.\n+  const updateQueue: UpdateQueue<mixed> | null =\n+    (finishedWork.updateQueue: any);\n+  if (updateQueue !== null) {\n+    const instance = finishedWork.stateNode;\n+    if (__DEV__) {\n+      if (\n+        !finishedWork.type.defaultProps &&\n+        !('ref' in finishedWork.memoizedProps) &&\n+        !didWarnAboutReassigningProps\n+      ) {\n+        if (instance.props !== finishedWork.memoizedProps) {\n+          console.error(\n+            'Expected %s props to match memoized props before ' +\n+              'processing the update queue. ' +\n+              'This might either be because of a bug in React, or because ' +\n+              'a component reassigns its own `this.props`. ' +\n+              'Please file an issue.',\n+            getComponentNameFromFiber(finishedWork) || 'instance',\n+          );\n+        }\n+        if (instance.state !== finishedWork.memoizedState) {\n+          console.error(\n+            'Expected %s state to match memoized state before ' +\n+              'processing the update queue. ' +\n+              'This might either be because of a bug in React, or because ' +\n+              'a component reassigns its own `this.state`. ' +\n+              'Please file an issue.',\n+            getComponentNameFromFiber(finishedWork) || 'instance',\n+          );\n+        }\n+      }\n+    }\n+    // We could update instance props and state here,\n+    // but instead we rely on them being set during last render.\n+    // TODO: revisit this when we implement resuming.\n+    try {\n+      commitCallbacks(updateQueue, instance);\n+    } catch (error) {\n+      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+    }\n+  }\n+}\n+\n+let didWarnAboutUndefinedSnapshotBeforeUpdate: Set<mixed> | null = null;\n+if (__DEV__) {\n+  didWarnAboutUndefinedSnapshotBeforeUpdate = new Set();\n+}\n+\n+export function commitClassSnapshot(finishedWork: Fiber, current: Fiber) {\n+  const prevProps = current.memoizedProps;\n+  const prevState = current.memoizedState;\n+  const instance = finishedWork.stateNode;\n+  // We could update instance props and state here,\n+  // but instead we rely on them being set during last render.\n+  // TODO: revisit this when we implement resuming.\n+  if (__DEV__) {\n+    if (\n+      !finishedWork.type.defaultProps &&\n+      !('ref' in finishedWork.memoizedProps) &&\n+      !didWarnAboutReassigningProps\n+    ) {\n+      if (instance.props !== finishedWork.memoizedProps) {\n+        console.error(\n+          'Expected %s props to match memoized props before ' +\n+            'getSnapshotBeforeUpdate. ' +\n+            'This might either be because of a bug in React, or because ' +\n+            'a component reassigns its own `this.props`. ' +\n+            'Please file an issue.',\n+          getComponentNameFromFiber(finishedWork) || 'instance',\n+        );\n+      }\n+      if (instance.state !== finishedWork.memoizedState) {\n+        console.error(\n+          'Expected %s state to match memoized state before ' +\n+            'getSnapshotBeforeUpdate. ' +\n+            'This might either be because of a bug in React, or because ' +\n+            'a component reassigns its own `this.state`. ' +\n+            'Please file an issue.',\n+          getComponentNameFromFiber(finishedWork) || 'instance',\n+        );\n+      }\n+    }\n+  }\n+  try {\n+    const snapshot = instance.getSnapshotBeforeUpdate(\n+      resolveClassComponentProps(\n+        finishedWork.type,\n+        prevProps,\n+        finishedWork.elementType === finishedWork.type,\n+      ),\n+      prevState,\n+    );\n+    if (__DEV__) {\n+      const didWarnSet =\n+        ((didWarnAboutUndefinedSnapshotBeforeUpdate: any): Set<mixed>);\n+      if (snapshot === undefined && !didWarnSet.has(finishedWork.type)) {\n+        didWarnSet.add(finishedWork.type);\n+        console.error(\n+          '%s.getSnapshotBeforeUpdate(): A snapshot value (or null) ' +\n+            'must be returned. You have returned undefined.',\n+          getComponentNameFromFiber(finishedWork),\n+        );\n+      }\n+    }\n+    instance.__reactInternalSnapshotBeforeUpdate = snapshot;\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+// Capture errors so they don't interrupt unmounting.\n+export function safelyCallComponentWillUnmount(\n+  current: Fiber,\n+  nearestMountedAncestor: Fiber | null,\n+  instance: any,\n+) {\n+  instance.props = resolveClassComponentProps(\n+    current.type,\n+    current.memoizedProps,\n+    current.elementType === current.type,\n+  );\n+  instance.state = current.memoizedState;\n+  if (shouldProfile(current)) {\n+    startLayoutEffectTimer();\n+    if (__DEV__) {\n+      callComponentWillUnmountInDEV(current, nearestMountedAncestor, instance);\n+    } else {\n+      try {\n+        instance.componentWillUnmount();\n+      } catch (error) {\n+        captureCommitPhaseError(current, nearestMountedAncestor, error);\n+      }\n+    }\n+    recordLayoutEffectDuration(current);\n+  } else {\n+    if (__DEV__) {\n+      callComponentWillUnmountInDEV(current, nearestMountedAncestor, instance);\n+    } else {\n+      try {\n+        instance.componentWillUnmount();\n+      } catch (error) {\n+        captureCommitPhaseError(current, nearestMountedAncestor, error);\n+      }\n+    }\n+  }\n+}\n+\n+function commitAttachRef(finishedWork: Fiber) {\n+  const ref = finishedWork.ref;\n+  if (ref !== null) {\n+    const instance = finishedWork.stateNode;\n+    let instanceToUse;\n+    switch (finishedWork.tag) {\n+      case HostHoistable:\n+      case HostSingleton:\n+      case HostComponent:\n+        instanceToUse = getPublicInstance(instance);\n+        break;\n+      default:\n+        instanceToUse = instance;\n+    }\n+    // Moved outside to ensure DCE works with this flag\n+    if (enableScopeAPI && finishedWork.tag === ScopeComponent) {\n+      instanceToUse = instance;\n+    }\n+    if (typeof ref === 'function') {\n+      if (shouldProfile(finishedWork)) {\n+        try {\n+          startLayoutEffectTimer();\n+          finishedWork.refCleanup = ref(instanceToUse);\n+        } finally {\n+          recordLayoutEffectDuration(finishedWork);\n+        }\n+      } else {\n+        finishedWork.refCleanup = ref(instanceToUse);\n+      }\n+    } else {\n+      if (__DEV__) {\n+        // TODO: We should move these warnings to happen during the render\n+        // phase (markRef).\n+        if (disableStringRefs && typeof ref === 'string') {\n+          console.error('String refs are no longer supported.');\n+        } else if (!ref.hasOwnProperty('current')) {\n+          console.error(\n+            'Unexpected ref object provided for %s. ' +\n+              'Use either a ref-setter function or React.createRef().',\n+            getComponentNameFromFiber(finishedWork),\n+          );\n+        }\n+      }\n+\n+      // $FlowFixMe[incompatible-use] unable to narrow type to the non-function case\n+      ref.current = instanceToUse;\n+    }\n+  }\n+}\n+\n+// Capture errors so they don't interrupt mounting.\n+export function safelyAttachRef(\n+  current: Fiber,\n+  nearestMountedAncestor: Fiber | null,\n+) {\n+  try {\n+    commitAttachRef(current);\n+  } catch (error) {\n+    captureCommitPhaseError(current, nearestMountedAncestor, error);\n+  }\n+}\n+\n+export function safelyDetachRef(\n+  current: Fiber,\n+  nearestMountedAncestor: Fiber | null,\n+) {\n+  const ref = current.ref;\n+  const refCleanup = current.refCleanup;\n+\n+  if (ref !== null) {\n+    if (typeof refCleanup === 'function') {\n+      try {\n+        if (shouldProfile(current)) {\n+          try {\n+            startLayoutEffectTimer();\n+            refCleanup();\n+          } finally {\n+            recordLayoutEffectDuration(current);\n+          }\n+        } else {\n+          refCleanup();\n+        }\n+      } catch (error) {\n+        captureCommitPhaseError(current, nearestMountedAncestor, error);\n+      } finally {\n+        // `refCleanup` has been called. Nullify all references to it to prevent double invocation.\n+        current.refCleanup = null;\n+        const finishedWork = current.alternate;\n+        if (finishedWork != null) {\n+          finishedWork.refCleanup = null;\n+        }\n+      }\n+    } else if (typeof ref === 'function') {\n+      try {\n+        if (shouldProfile(current)) {\n+          try {\n+            startLayoutEffectTimer();\n+            ref(null);\n+          } finally {\n+            recordLayoutEffectDuration(current);\n+          }\n+        } else {\n+          ref(null);\n+        }\n+      } catch (error) {\n+        captureCommitPhaseError(current, nearestMountedAncestor, error);\n+      }\n+    } else {\n+      // $FlowFixMe[incompatible-use] unable to narrow type to RefObject\n+      ref.current = null;\n+    }\n+  }\n+}\n+\n+export function safelyCallDestroy(\n+  current: Fiber,\n+  nearestMountedAncestor: Fiber | null,\n+  destroy: () => void,\n+) {\n+  if (__DEV__) {\n+    callDestroyInDEV(current, nearestMountedAncestor, destroy);\n+  } else {\n+    try {\n+      destroy();\n+    } catch (error) {\n+      captureCommitPhaseError(current, nearestMountedAncestor, error);\n+    }\n+  }\n+}\n+\n+export function commitProfilerUpdate(\n+  finishedWork: Fiber,\n+  current: Fiber | null,\n+  commitTime: number,\n+  effectDuration: number,\n+) {\n+  if (enableProfilerTimer && getExecutionContext() & CommitContext) {\n+    try {\n+      const {onCommit, onRender} = finishedWork.memoizedProps;\n+\n+      let phase = current === null ? 'mount' : 'update';\n+      if (enableProfilerNestedUpdatePhase) {\n+        if (isCurrentUpdateNested()) {\n+          phase = 'nested-update';\n+        }\n+      }\n+\n+      if (typeof onRender === 'function') {\n+        onRender(\n+          finishedWork.memoizedProps.id,\n+          phase,\n+          finishedWork.actualDuration,\n+          finishedWork.treeBaseDuration,\n+          finishedWork.actualStartTime,\n+          commitTime,\n+        );\n+      }\n+\n+      if (enableProfilerCommitHooks) {\n+        if (typeof onCommit === 'function') {\n+          onCommit(\n+            finishedWork.memoizedProps.id,\n+            phase,\n+            effectDuration,\n+            commitTime,\n+          );\n+        }\n+      }\n+    } catch (error) {\n+      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+    }\n+  }\n+}"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -30,7 +30,6 @@ import type {\n   OffscreenQueue,\n   OffscreenProps,\n } from './ReactFiberActivityComponent';\n-import type {HookFlags} from './ReactHookEffectTags';\n import type {Cache} from './ReactFiberCacheComponent';\n import type {RootState} from './ReactFiberRoot';\n import type {\n@@ -54,7 +53,6 @@ import {\n   enableTransitionTracing,\n   enableUseEffectEventHook,\n   enableLegacyHidden,\n-  disableStringRefs,\n   disableLegacyMode,\n } from 'shared/ReactFeatureFlags';\n import {\n@@ -101,16 +99,12 @@ import {\n   FormReset,\n   Cloned,\n } from './ReactFiberFlags';\n-import getComponentNameFromFiber from 'react-reconciler/src/getComponentNameFromFiber';\n import {runWithFiberInDEV} from './ReactCurrentFiber';\n-import {resolveClassComponentProps} from './ReactFiberClassComponent';\n import {\n   isCurrentUpdateNested,\n   getCommitTime,\n   recordLayoutEffectDuration,\n   startLayoutEffectTimer,\n-  recordPassiveEffectDuration,\n-  startPassiveEffectTimer,\n } from './ReactProfilerTimer';\n import {ConcurrentMode, NoMode, ProfileMode} from './ReactTypeOfMode';\n import {\n@@ -176,7 +170,6 @@ import {\n   addMarkerProgressCallbackToPendingTransition,\n   addMarkerIncompleteCallbackToPendingTransition,\n   addMarkerCompleteCallbackToPendingTransition,\n-  setIsRunningInsertionEffect,\n   getExecutionContext,\n   CommitContext,\n   NoContext,\n@@ -188,16 +181,9 @@ import {\n   Insertion as HookInsertion,\n   Passive as HookPassive,\n } from './ReactHookEffectTags';\n-import {didWarnAboutReassigningProps} from './ReactFiberBeginWork';\n import {doesFiberContain} from './ReactFiberTreeReflection';\n import {\n   isDevToolsPresent,\n-  markComponentPassiveEffectMountStarted,\n-  markComponentPassiveEffectMountStopped,\n-  markComponentPassiveEffectUnmountStarted,\n-  markComponentPassiveEffectUnmountStopped,\n-  markComponentLayoutEffectMountStarted,\n-  markComponentLayoutEffectMountStopped,\n   markComponentLayoutEffectUnmountStarted,\n   markComponentLayoutEffectUnmountStopped,\n   onCommitUnmount,\n@@ -216,17 +202,20 @@ import {\n import {scheduleUpdateOnFiber} from './ReactFiberWorkLoop';\n import {enqueueConcurrentRenderForLane} from './ReactFiberConcurrentUpdates';\n import {\n-  callComponentDidMountInDEV,\n-  callComponentDidUpdateInDEV,\n-  callComponentWillUnmountInDEV,\n-  callCreateInDEV,\n-  callDestroyInDEV,\n-} from './ReactFiberCallUserSpace';\n-\n-let didWarnAboutUndefinedSnapshotBeforeUpdate: Set<mixed> | null = null;\n-if (__DEV__) {\n-  didWarnAboutUndefinedSnapshotBeforeUpdate = new Set();\n-}\n+  commitHookLayoutEffects,\n+  commitHookEffectListMount,\n+  commitHookEffectListUnmount,\n+  commitHookPassiveMountEffects,\n+  commitHookPassiveUnmountEffects,\n+  commitClassLayoutLifecycles,\n+  commitClassCallbacks,\n+  commitClassSnapshot,\n+  safelyCallComponentWillUnmount,\n+  safelyAttachRef,\n+  safelyDetachRef,\n+  safelyCallDestroy,\n+  commitProfilerUpdate,\n+} from './ReactFiberCommitEffects';\n \n // Used during the commit phase to track the state of the Offscreen component stack.\n // Allows us to avoid traversing the return path to find the nearest Offscreen ancestor.\n@@ -253,117 +242,6 @@ function shouldProfile(current: Fiber): boolean {\n   );\n }\n \n-// Capture errors so they don't interrupt unmounting.\n-function safelyCallComponentWillUnmount(\n-  current: Fiber,\n-  nearestMountedAncestor: Fiber | null,\n-  instance: any,\n-) {\n-  instance.props = resolveClassComponentProps(\n-    current.type,\n-    current.memoizedProps,\n-    current.elementType === current.type,\n-  );\n-  instance.state = current.memoizedState;\n-  if (shouldProfile(current)) {\n-    startLayoutEffectTimer();\n-    if (__DEV__) {\n-      callComponentWillUnmountInDEV(current, nearestMountedAncestor, instance);\n-    } else {\n-      try {\n-        instance.componentWillUnmount();\n-      } catch (error) {\n-        captureCommitPhaseError(current, nearestMountedAncestor, error);\n-      }\n-    }\n-    recordLayoutEffectDuration(current);\n-  } else {\n-    if (__DEV__) {\n-      callComponentWillUnmountInDEV(current, nearestMountedAncestor, instance);\n-    } else {\n-      try {\n-        instance.componentWillUnmount();\n-      } catch (error) {\n-        captureCommitPhaseError(current, nearestMountedAncestor, error);\n-      }\n-    }\n-  }\n-}\n-\n-// Capture errors so they don't interrupt mounting.\n-function safelyAttachRef(current: Fiber, nearestMountedAncestor: Fiber | null) {\n-  try {\n-    commitAttachRef(current);\n-  } catch (error) {\n-    captureCommitPhaseError(current, nearestMountedAncestor, error);\n-  }\n-}\n-\n-function safelyDetachRef(current: Fiber, nearestMountedAncestor: Fiber | null) {\n-  const ref = current.ref;\n-  const refCleanup = current.refCleanup;\n-\n-  if (ref !== null) {\n-    if (typeof refCleanup === 'function') {\n-      try {\n-        if (shouldProfile(current)) {\n-          try {\n-            startLayoutEffectTimer();\n-            refCleanup();\n-          } finally {\n-            recordLayoutEffectDuration(current);\n-          }\n-        } else {\n-          refCleanup();\n-        }\n-      } catch (error) {\n-        captureCommitPhaseError(current, nearestMountedAncestor, error);\n-      } finally {\n-        // `refCleanup` has been called. Nullify all references to it to prevent double invocation.\n-        current.refCleanup = null;\n-        const finishedWork = current.alternate;\n-        if (finishedWork != null) {\n-          finishedWork.refCleanup = null;\n-        }\n-      }\n-    } else if (typeof ref === 'function') {\n-      try {\n-        if (shouldProfile(current)) {\n-          try {\n-            startLayoutEffectTimer();\n-            ref(null);\n-          } finally {\n-            recordLayoutEffectDuration(current);\n-          }\n-        } else {\n-          ref(null);\n-        }\n-      } catch (error) {\n-        captureCommitPhaseError(current, nearestMountedAncestor, error);\n-      }\n-    } else {\n-      // $FlowFixMe[incompatible-use] unable to narrow type to RefObject\n-      ref.current = null;\n-    }\n-  }\n-}\n-\n-function safelyCallDestroy(\n-  current: Fiber,\n-  nearestMountedAncestor: Fiber | null,\n-  destroy: () => void,\n-) {\n-  if (__DEV__) {\n-    callDestroyInDEV(current, nearestMountedAncestor, destroy);\n-  } else {\n-    try {\n-      destroy();\n-    } catch (error) {\n-      captureCommitPhaseError(current, nearestMountedAncestor, error);\n-    }\n-  }\n-}\n-\n let focusedInstanceHandle: null | Fiber = null;\n let shouldFireAfterActiveInstanceBlur: boolean = false;\n \n@@ -417,14 +295,10 @@ function commitBeforeMutationEffects_begin() {\n function commitBeforeMutationEffects_complete() {\n   while (nextEffect !== null) {\n     const fiber = nextEffect;\n-    try {\n-      if (__DEV__) {\n-        runWithFiberInDEV(fiber, commitBeforeMutationEffectsOnFiber, fiber);\n-      } else {\n-        commitBeforeMutationEffectsOnFiber(fiber);\n-      }\n-    } catch (error) {\n-      captureCommitPhaseError(fiber, fiber.return, error);\n+    if (__DEV__) {\n+      runWithFiberInDEV(fiber, commitBeforeMutationEffectsOnFiber, fiber);\n+    } else {\n+      commitBeforeMutationEffectsOnFiber(fiber);\n     }\n \n     const sibling = fiber.sibling;\n@@ -462,7 +336,16 @@ function commitBeforeMutationEffectsOnFiber(finishedWork: Fiber) {\n     case FunctionComponent: {\n       if (enableUseEffectEventHook) {\n         if ((flags & Update) !== NoFlags) {\n-          commitUseEffectEventMount(finishedWork);\n+          const updateQueue: FunctionComponentUpdateQueue | null =\n+            (finishedWork.updateQueue: any);\n+          const eventPayloads =\n+            updateQueue !== null ? updateQueue.events : null;\n+          if (eventPayloads !== null) {\n+            for (let ii = 0; ii < eventPayloads.length; ii++) {\n+              const {ref, nextImpl} = eventPayloads[ii];\n+              ref.impl = nextImpl;\n+            }\n+          }\n         }\n       }\n       break;\n@@ -474,61 +357,7 @@ function commitBeforeMutationEffectsOnFiber(finishedWork: Fiber) {\n     case ClassComponent: {\n       if ((flags & Snapshot) !== NoFlags) {\n         if (current !== null) {\n-          const prevProps = current.memoizedProps;\n-          const prevState = current.memoizedState;\n-          const instance = finishedWork.stateNode;\n-          // We could update instance props and state here,\n-          // but instead we rely on them being set during last render.\n-          // TODO: revisit this when we implement resuming.\n-          if (__DEV__) {\n-            if (\n-              !finishedWork.type.defaultProps &&\n-              !('ref' in finishedWork.memoizedProps) &&\n-              !didWarnAboutReassigningProps\n-            ) {\n-              if (instance.props !== finishedWork.memoizedProps) {\n-                console.error(\n-                  'Expected %s props to match memoized props before ' +\n-                    'getSnapshotBeforeUpdate. ' +\n-                    'This might either be because of a bug in React, or because ' +\n-                    'a component reassigns its own `this.props`. ' +\n-                    'Please file an issue.',\n-                  getComponentNameFromFiber(finishedWork) || 'instance',\n-                );\n-              }\n-              if (instance.state !== finishedWork.memoizedState) {\n-                console.error(\n-                  'Expected %s state to match memoized state before ' +\n-                    'getSnapshotBeforeUpdate. ' +\n-                    'This might either be because of a bug in React, or because ' +\n-                    'a component reassigns its own `this.state`. ' +\n-                    'Please file an issue.',\n-                  getComponentNameFromFiber(finishedWork) || 'instance',\n-                );\n-              }\n-            }\n-          }\n-          const snapshot = instance.getSnapshotBeforeUpdate(\n-            resolveClassComponentProps(\n-              finishedWork.type,\n-              prevProps,\n-              finishedWork.elementType === finishedWork.type,\n-            ),\n-            prevState,\n-          );\n-          if (__DEV__) {\n-            const didWarnSet =\n-              ((didWarnAboutUndefinedSnapshotBeforeUpdate: any): Set<mixed>);\n-            if (snapshot === undefined && !didWarnSet.has(finishedWork.type)) {\n-              didWarnSet.add(finishedWork.type);\n-              console.error(\n-                '%s.getSnapshotBeforeUpdate(): A snapshot value (or null) ' +\n-                  'must be returned. You have returned undefined.',\n-                getComponentNameFromFiber(finishedWork),\n-              );\n-            }\n-          }\n-          instance.__reactInternalSnapshotBeforeUpdate = snapshot;\n+          commitClassSnapshot(finishedWork, current);\n         }\n       }\n       break;\n@@ -574,161 +403,6 @@ function commitBeforeMutationEffectsDeletion(deletion: Fiber) {\n   }\n }\n \n-function commitHookEffectListUnmount(\n-  flags: HookFlags,\n-  finishedWork: Fiber,\n-  nearestMountedAncestor: Fiber | null,\n-) {\n-  const updateQueue: FunctionComponentUpdateQueue | null =\n-    (finishedWork.updateQueue: any);\n-  const lastEffect = updateQueue !== null ? updateQueue.lastEffect : null;\n-  if (lastEffect !== null) {\n-    const firstEffect = lastEffect.next;\n-    let effect = firstEffect;\n-    do {\n-      if ((effect.tag & flags) === flags) {\n-        // Unmount\n-        const inst = effect.inst;\n-        const destroy = inst.destroy;\n-        if (destroy !== undefined) {\n-          inst.destroy = undefined;\n-          if (enableSchedulingProfiler) {\n-            if ((flags & HookPassive) !== NoHookEffect) {\n-              markComponentPassiveEffectUnmountStarted(finishedWork);\n-            } else if ((flags & HookLayout) !== NoHookEffect) {\n-              markComponentLayoutEffectUnmountStarted(finishedWork);\n-            }\n-          }\n-\n-          if (__DEV__) {\n-            if ((flags & HookInsertion) !== NoHookEffect) {\n-              setIsRunningInsertionEffect(true);\n-            }\n-          }\n-          safelyCallDestroy(finishedWork, nearestMountedAncestor, destroy);\n-          if (__DEV__) {\n-            if ((flags & HookInsertion) !== NoHookEffect) {\n-              setIsRunningInsertionEffect(false);\n-            }\n-          }\n-\n-          if (enableSchedulingProfiler) {\n-            if ((flags & HookPassive) !== NoHookEffect) {\n-              markComponentPassiveEffectUnmountStopped();\n-            } else if ((flags & HookLayout) !== NoHookEffect) {\n-              markComponentLayoutEffectUnmountStopped();\n-            }\n-          }\n-        }\n-      }\n-      effect = effect.next;\n-    } while (effect !== firstEffect);\n-  }\n-}\n-\n-function commitHookEffectListMount(flags: HookFlags, finishedWork: Fiber) {\n-  const updateQueue: FunctionComponentUpdateQueue | null =\n-    (finishedWork.updateQueue: any);\n-  const lastEffect = updateQueue !== null ? updateQueue.lastEffect : null;\n-  if (lastEffect !== null) {\n-    const firstEffect = lastEffect.next;\n-    let effect = firstEffect;\n-    do {\n-      if ((effect.tag & flags) === flags) {\n-        if (enableSchedulingProfiler) {\n-          if ((flags & HookPassive) !== NoHookEffect) {\n-            markComponentPassiveEffectMountStarted(finishedWork);\n-          } else if ((flags & HookLayout) !== NoHookEffect) {\n-            markComponentLayoutEffectMountStarted(finishedWork);\n-          }\n-        }\n-\n-        // Mount\n-        let destroy;\n-        if (__DEV__) {\n-          if ((flags & HookInsertion) !== NoHookEffect) {\n-            setIsRunningInsertionEffect(true);\n-          }\n-          destroy = callCreateInDEV(effect);\n-          if ((flags & HookInsertion) !== NoHookEffect) {\n-            setIsRunningInsertionEffect(false);\n-          }\n-        } else {\n-          const create = effect.create;\n-          const inst = effect.inst;\n-          destroy = create();\n-          inst.destroy = destroy;\n-        }\n-\n-        if (enableSchedulingProfiler) {\n-          if ((flags & HookPassive) !== NoHookEffect) {\n-            markComponentPassiveEffectMountStopped();\n-          } else if ((flags & HookLayout) !== NoHookEffect) {\n-            markComponentLayoutEffectMountStopped();\n-          }\n-        }\n-\n-        if (__DEV__) {\n-          if (destroy !== undefined && typeof destroy !== 'function') {\n-            let hookName;\n-            if ((effect.tag & HookLayout) !== NoFlags) {\n-              hookName = 'useLayoutEffect';\n-            } else if ((effect.tag & HookInsertion) !== NoFlags) {\n-              hookName = 'useInsertionEffect';\n-            } else {\n-              hookName = 'useEffect';\n-            }\n-            let addendum;\n-            if (destroy === null) {\n-              addendum =\n-                ' You returned null. If your effect does not require clean ' +\n-                'up, return undefined (or nothing).';\n-            } else if (typeof destroy.then === 'function') {\n-              addendum =\n-                '\\n\\nIt looks like you wrote ' +\n-                hookName +\n-                '(async () => ...) or returned a Promise. ' +\n-                'Instead, write the async function inside your effect ' +\n-                'and call it immediately:\\n\\n' +\n-                hookName +\n-                '(() => {\\n' +\n-                '  async function fetchData() {\\n' +\n-                '    // You can await here\\n' +\n-                '    const response = await MyAPI.getData(someId);\\n' +\n-                '    // ...\\n' +\n-                '  }\\n' +\n-                '  fetchData();\\n' +\n-                `}, [someId]); // Or [] if effect doesn't need props or state\\n\\n` +\n-                'Learn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching';\n-            } else {\n-              addendum = ' You returned: ' + destroy;\n-            }\n-            console.error(\n-              '%s must not return anything besides a function, ' +\n-                'which is used for clean-up.%s',\n-              hookName,\n-              addendum,\n-            );\n-          }\n-        }\n-      }\n-      effect = effect.next;\n-    } while (effect !== firstEffect);\n-  }\n-}\n-\n-function commitUseEffectEventMount(finishedWork: Fiber) {\n-  const updateQueue: FunctionComponentUpdateQueue | null =\n-    (finishedWork.updateQueue: any);\n-  const eventPayloads = updateQueue !== null ? updateQueue.events : null;\n-  if (eventPayloads !== null) {\n-    for (let ii = 0; ii < eventPayloads.length; ii++) {\n-      const {ref, nextImpl} = eventPayloads[ii];\n-      ref.impl = nextImpl;\n-    }\n-  }\n-}\n-\n export function commitPassiveEffectDurations(\n   finishedRoot: FiberRoot,\n   finishedWork: Fiber,\n@@ -785,218 +459,6 @@ export function commitPassiveEffectDurations(\n   }\n }\n \n-function commitHookLayoutEffects(finishedWork: Fiber, hookFlags: HookFlags) {\n-  // At this point layout effects have already been destroyed (during mutation phase).\n-  // This is done to prevent sibling component effects from interfering with each other,\n-  // e.g. a destroy function in one component should never override a ref set\n-  // by a create function in another component during the same commit.\n-  if (shouldProfile(finishedWork)) {\n-    try {\n-      startLayoutEffectTimer();\n-      commitHookEffectListMount(hookFlags, finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n-    recordLayoutEffectDuration(finishedWork);\n-  } else {\n-    try {\n-      commitHookEffectListMount(hookFlags, finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n-  }\n-}\n-\n-function commitClassLayoutLifecycles(\n-  finishedWork: Fiber,\n-  current: Fiber | null,\n-) {\n-  const instance = finishedWork.stateNode;\n-  if (current === null) {\n-    // We could update instance props and state here,\n-    // but instead we rely on them being set during last render.\n-    // TODO: revisit this when we implement resuming.\n-    if (__DEV__) {\n-      if (\n-        !finishedWork.type.defaultProps &&\n-        !('ref' in finishedWork.memoizedProps) &&\n-        !didWarnAboutReassigningProps\n-      ) {\n-        if (instance.props !== finishedWork.memoizedProps) {\n-          console.error(\n-            'Expected %s props to match memoized props before ' +\n-              'componentDidMount. ' +\n-              'This might either be because of a bug in React, or because ' +\n-              'a component reassigns its own `this.props`. ' +\n-              'Please file an issue.',\n-            getComponentNameFromFiber(finishedWork) || 'instance',\n-          );\n-        }\n-        if (instance.state !== finishedWork.memoizedState) {\n-          console.error(\n-            'Expected %s state to match memoized state before ' +\n-              'componentDidMount. ' +\n-              'This might either be because of a bug in React, or because ' +\n-              'a component reassigns its own `this.state`. ' +\n-              'Please file an issue.',\n-            getComponentNameFromFiber(finishedWork) || 'instance',\n-          );\n-        }\n-      }\n-    }\n-    if (shouldProfile(finishedWork)) {\n-      startLayoutEffectTimer();\n-      if (__DEV__) {\n-        callComponentDidMountInDEV(finishedWork, instance);\n-      } else {\n-        try {\n-          instance.componentDidMount();\n-        } catch (error) {\n-          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-        }\n-      }\n-      recordLayoutEffectDuration(finishedWork);\n-    } else {\n-      if (__DEV__) {\n-        callComponentDidMountInDEV(finishedWork, instance);\n-      } else {\n-        try {\n-          instance.componentDidMount();\n-        } catch (error) {\n-          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-        }\n-      }\n-    }\n-  } else {\n-    const prevProps = resolveClassComponentProps(\n-      finishedWork.type,\n-      current.memoizedProps,\n-      finishedWork.elementType === finishedWork.type,\n-    );\n-    const prevState = current.memoizedState;\n-    // We could update instance props and state here,\n-    // but instead we rely on them being set during last render.\n-    // TODO: revisit this when we implement resuming.\n-    if (__DEV__) {\n-      if (\n-        !finishedWork.type.defaultProps &&\n-        !('ref' in finishedWork.memoizedProps) &&\n-        !didWarnAboutReassigningProps\n-      ) {\n-        if (instance.props !== finishedWork.memoizedProps) {\n-          console.error(\n-            'Expected %s props to match memoized props before ' +\n-              'componentDidUpdate. ' +\n-              'This might either be because of a bug in React, or because ' +\n-              'a component reassigns its own `this.props`. ' +\n-              'Please file an issue.',\n-            getComponentNameFromFiber(finishedWork) || 'instance',\n-          );\n-        }\n-        if (instance.state !== finishedWork.memoizedState) {\n-          console.error(\n-            'Expected %s state to match memoized state before ' +\n-              'componentDidUpdate. ' +\n-              'This might either be because of a bug in React, or because ' +\n-              'a component reassigns its own `this.state`. ' +\n-              'Please file an issue.',\n-            getComponentNameFromFiber(finishedWork) || 'instance',\n-          );\n-        }\n-      }\n-    }\n-    if (shouldProfile(finishedWork)) {\n-      startLayoutEffectTimer();\n-      if (__DEV__) {\n-        callComponentDidUpdateInDEV(\n-          finishedWork,\n-          instance,\n-          prevProps,\n-          prevState,\n-          instance.__reactInternalSnapshotBeforeUpdate,\n-        );\n-      } else {\n-        try {\n-          instance.componentDidUpdate(\n-            prevProps,\n-            prevState,\n-            instance.__reactInternalSnapshotBeforeUpdate,\n-          );\n-        } catch (error) {\n-          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-        }\n-      }\n-      recordLayoutEffectDuration(finishedWork);\n-    } else {\n-      if (__DEV__) {\n-        callComponentDidUpdateInDEV(\n-          finishedWork,\n-          instance,\n-          prevProps,\n-          prevState,\n-          instance.__reactInternalSnapshotBeforeUpdate,\n-        );\n-      } else {\n-        try {\n-          instance.componentDidUpdate(\n-            prevProps,\n-            prevState,\n-            instance.__reactInternalSnapshotBeforeUpdate,\n-          );\n-        } catch (error) {\n-          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-        }\n-      }\n-    }\n-  }\n-}\n-\n-function commitClassCallbacks(finishedWork: Fiber) {\n-  // TODO: I think this is now always non-null by the time it reaches the\n-  // commit phase. Consider removing the type check.\n-  const updateQueue: UpdateQueue<mixed> | null =\n-    (finishedWork.updateQueue: any);\n-  if (updateQueue !== null) {\n-    const instance = finishedWork.stateNode;\n-    if (__DEV__) {\n-      if (\n-        !finishedWork.type.defaultProps &&\n-        !('ref' in finishedWork.memoizedProps) &&\n-        !didWarnAboutReassigningProps\n-      ) {\n-        if (instance.props !== finishedWork.memoizedProps) {\n-          console.error(\n-            'Expected %s props to match memoized props before ' +\n-              'processing the update queue. ' +\n-              'This might either be because of a bug in React, or because ' +\n-              'a component reassigns its own `this.props`. ' +\n-              'Please file an issue.',\n-            getComponentNameFromFiber(finishedWork) || 'instance',\n-          );\n-        }\n-        if (instance.state !== finishedWork.memoizedState) {\n-          console.error(\n-            'Expected %s state to match memoized state before ' +\n-              'processing the update queue. ' +\n-              'This might either be because of a bug in React, or because ' +\n-              'a component reassigns its own `this.state`. ' +\n-              'Please file an issue.',\n-            getComponentNameFromFiber(finishedWork) || 'instance',\n-          );\n-        }\n-      }\n-    }\n-    // We could update instance props and state here,\n-    // but instead we rely on them being set during last render.\n-    // TODO: revisit this when we implement resuming.\n-    try {\n-      commitCallbacks(updateQueue, instance);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n-  }\n-}\n-\n function commitHostComponentMount(finishedWork: Fiber) {\n   const type = finishedWork.type;\n   const props = finishedWork.memoizedProps;\n@@ -1008,70 +470,6 @@ function commitHostComponentMount(finishedWork: Fiber) {\n   }\n }\n \n-function commitProfilerUpdate(finishedWork: Fiber, current: Fiber | null) {\n-  if (enableProfilerTimer && getExecutionContext() & CommitContext) {\n-    try {\n-      const {onCommit, onRender} = finishedWork.memoizedProps;\n-      const {effectDuration} = finishedWork.stateNode;\n-\n-      const commitTime = getCommitTime();\n-\n-      let phase = current === null ? 'mount' : 'update';\n-      if (enableProfilerNestedUpdatePhase) {\n-        if (isCurrentUpdateNested()) {\n-          phase = 'nested-update';\n-        }\n-      }\n-\n-      if (typeof onRender === 'function') {\n-        onRender(\n-          finishedWork.memoizedProps.id,\n-          phase,\n-          finishedWork.actualDuration,\n-          finishedWork.treeBaseDuration,\n-          finishedWork.actualStartTime,\n-          commitTime,\n-        );\n-      }\n-\n-      if (enableProfilerCommitHooks) {\n-        if (typeof onCommit === 'function') {\n-          onCommit(\n-            finishedWork.memoizedProps.id,\n-            phase,\n-            effectDuration,\n-            commitTime,\n-          );\n-        }\n-\n-        // Schedule a passive effect for this Profiler to call onPostCommit hooks.\n-        // This effect should be scheduled even if there is no onPostCommit callback for this Profiler,\n-        // because the effect is also where times bubble to parent Profilers.\n-        enqueuePendingPassiveProfilerEffect(finishedWork);\n-\n-        // Propagate layout effect durations to the next nearest Profiler ancestor.\n-        // Do not reset these values until the next render so DevTools has a chance to read them first.\n-        let parentFiber = finishedWork.return;\n-        outer: while (parentFiber !== null) {\n-          switch (parentFiber.tag) {\n-            case HostRoot:\n-              const root = parentFiber.stateNode;\n-              root.effectDuration += effectDuration;\n-              break outer;\n-            case Profiler:\n-              const parentStateNode = parentFiber.stateNode;\n-              parentStateNode.effectDuration += effectDuration;\n-              break outer;\n-          }\n-          parentFiber = parentFiber.return;\n-        }\n-      }\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n-  }\n-}\n-\n function commitLayoutEffectOnFiber(\n   finishedRoot: FiberRoot,\n   current: Fiber | null,\n@@ -1192,7 +590,36 @@ function commitLayoutEffectOnFiber(\n       // TODO: Should this fire inside an offscreen tree? Or should it wait to\n       // fire when the tree becomes visible again.\n       if (flags & Update) {\n-        commitProfilerUpdate(finishedWork, current);\n+        const {effectDuration} = finishedWork.stateNode;\n+\n+        commitProfilerUpdate(\n+          finishedWork,\n+          current,\n+          getCommitTime(),\n+          effectDuration,\n+        );\n+\n+        // Schedule a passive effect for this Profiler to call onPostCommit hooks.\n+        // This effect should be scheduled even if there is no onPostCommit callback for this Profiler,\n+        // because the effect is also where times bubble to parent Profilers.\n+        enqueuePendingPassiveProfilerEffect(finishedWork);\n+\n+        // Propagate layout effect durations to the next nearest Profiler ancestor.\n+        // Do not reset these values until the next render so DevTools has a chance to read them first.\n+        let parentFiber = finishedWork.return;\n+        outer: while (parentFiber !== null) {\n+          switch (parentFiber.tag) {\n+            case HostRoot:\n+              const root = parentFiber.stateNode;\n+              root.effectDuration += effectDuration;\n+              break outer;\n+            case Profiler:\n+              const parentStateNode = parentFiber.stateNode;\n+              parentStateNode.effectDuration += effectDuration;\n+              break outer;\n+          }\n+          parentFiber = parentFiber.return;\n+        }\n       }\n       break;\n     }\n@@ -1621,56 +1048,6 @@ function hideOrUnhideAllChildren(finishedWork: Fiber, isHidden: boolean) {\n   }\n }\n \n-function commitAttachRef(finishedWork: Fiber) {\n-  const ref = finishedWork.ref;\n-  if (ref !== null) {\n-    const instance = finishedWork.stateNode;\n-    let instanceToUse;\n-    switch (finishedWork.tag) {\n-      case HostHoistable:\n-      case HostSingleton:\n-      case HostComponent:\n-        instanceToUse = getPublicInstance(instance);\n-        break;\n-      default:\n-        instanceToUse = instance;\n-    }\n-    // Moved outside to ensure DCE works with this flag\n-    if (enableScopeAPI && finishedWork.tag === ScopeComponent) {\n-      instanceToUse = instance;\n-    }\n-    if (typeof ref === 'function') {\n-      if (shouldProfile(finishedWork)) {\n-        try {\n-          startLayoutEffectTimer();\n-          finishedWork.refCleanup = ref(instanceToUse);\n-        } finally {\n-          recordLayoutEffectDuration(finishedWork);\n-        }\n-      } else {\n-        finishedWork.refCleanup = ref(instanceToUse);\n-      }\n-    } else {\n-      if (__DEV__) {\n-        // TODO: We should move these warnings to happen during the render\n-        // phase (markRef).\n-        if (disableStringRefs && typeof ref === 'string') {\n-          console.error('String refs are no longer supported.');\n-        } else if (!ref.hasOwnProperty('current')) {\n-          console.error(\n-            'Unexpected ref object provided for %s. ' +\n-              'Use either a ref-setter function or React.createRef().',\n-            getComponentNameFromFiber(finishedWork),\n-          );\n-        }\n-      }\n-\n-      // $FlowFixMe[incompatible-use] unable to narrow type to the non-function case\n-      ref.current = instanceToUse;\n-    }\n-  }\n-}\n-\n function detachFiberMutation(fiber: Fiber) {\n   // Cut off the return pointer to disconnect it from the tree.\n   // This enables us to detect and warn against state updates on an unmounted component.\n@@ -2340,7 +1717,7 @@ function commitDeletionEffectsOnFiber(\n   }\n }\n function commitSuspenseCallback(finishedWork: Fiber) {\n-  // TODO: Move this to passive phase\n+  // TODO: Delete this feature. It's not properly covered by DEV features.\n   const newState: SuspenseState | null = finishedWork.memoizedState;\n   if (enableSuspenseCallback && newState !== null) {\n     const suspenseCallback = finishedWork.memoizedProps.suspenseCallback;\n@@ -2375,6 +1752,7 @@ function commitSuspenseHydrationCallbacks(\n           try {\n             commitHydratedSuspenseInstance(suspenseInstance);\n             if (enableSuspenseCallback) {\n+              // TODO: Delete this feature. It's not properly covered by DEV features.\n               const hydrationCallbacks = finishedRoot.hydrationCallbacks;\n               if (hydrationCallbacks !== null) {\n                 const onHydrated = hydrationCallbacks.onHydrated;\n@@ -2499,7 +1877,7 @@ function attachSuspenseRetryListeners(\n // This function detects when a Suspense boundary goes from visible to hidden.\n // It returns false if the boundary is already hidden.\n // TODO: Use an effect tag.\n-export function isSuspenseBoundaryBeingHidden(\n+function isSuspenseBoundaryBeingHidden(\n   current: Fiber | null,\n   finishedWork: Fiber,\n ): boolean {\n@@ -3400,7 +2778,36 @@ export function reappearLayoutEffects(\n       );\n       // TODO: Figure out how Profiler updates should work with Offscreen\n       if (includeWorkInProgressEffects && flags & Update) {\n-        commitProfilerUpdate(finishedWork, current);\n+        const {effectDuration} = finishedWork.stateNode;\n+\n+        commitProfilerUpdate(\n+          finishedWork,\n+          current,\n+          getCommitTime(),\n+          effectDuration,\n+        );\n+\n+        // Schedule a passive effect for this Profiler to call onPostCommit hooks.\n+        // This effect should be scheduled even if there is no onPostCommit callback for this Profiler,\n+        // because the effect is also where times bubble to parent Profilers.\n+        enqueuePendingPassiveProfilerEffect(finishedWork);\n+\n+        // Propagate layout effect durations to the next nearest Profiler ancestor.\n+        // Do not reset these values until the next render so DevTools has a chance to read them first.\n+        let parentFiber = finishedWork.return;\n+        outer: while (parentFiber !== null) {\n+          switch (parentFiber.tag) {\n+            case HostRoot:\n+              const root = parentFiber.stateNode;\n+              root.effectDuration += effectDuration;\n+              break outer;\n+            case Profiler:\n+              const parentStateNode = parentFiber.stateNode;\n+              parentStateNode.effectDuration += effectDuration;\n+              break outer;\n+          }\n+          parentFiber = parentFiber.return;\n+        }\n       }\n       break;\n     }\n@@ -3411,9 +2818,8 @@ export function reappearLayoutEffects(\n         includeWorkInProgressEffects,\n       );\n \n-      // TODO: Figure out how Suspense hydration callbacks should work\n-      // with Offscreen.\n       if (includeWorkInProgressEffects && flags & Update) {\n+        // TODO: Delete this feature.\n         commitSuspenseHydrationCallbacks(finishedRoot, finishedWork);\n       }\n       break;\n@@ -3482,27 +2888,6 @@ function recursivelyTraverseReappearLayoutEffects(\n   }\n }\n \n-function commitHookPassiveMountEffects(\n-  finishedWork: Fiber,\n-  hookFlags: HookFlags,\n-) {\n-  if (shouldProfile(finishedWork)) {\n-    startPassiveEffectTimer();\n-    try {\n-      commitHookEffectListMount(hookFlags, finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n-    recordPassiveEffectDuration(finishedWork);\n-  } else {\n-    try {\n-      commitHookEffectListMount(hookFlags, finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n-  }\n-}\n-\n function commitOffscreenPassiveMountEffects(\n   current: Fiber | null,\n   finishedWork: Fiber,\n@@ -4341,28 +3726,6 @@ function detachAlternateSiblings(parentFiber: Fiber) {\n   }\n }\n \n-function commitHookPassiveUnmountEffects(\n-  finishedWork: Fiber,\n-  nearestMountedAncestor: null | Fiber,\n-  hookFlags: HookFlags,\n-) {\n-  if (shouldProfile(finishedWork)) {\n-    startPassiveEffectTimer();\n-    commitHookEffectListUnmount(\n-      hookFlags,\n-      finishedWork,\n-      nearestMountedAncestor,\n-    );\n-    recordPassiveEffectDuration(finishedWork);\n-  } else {\n-    commitHookEffectListUnmount(\n-      hookFlags,\n-      finishedWork,\n-      nearestMountedAncestor,\n-    );\n-  }\n-}\n-\n function recursivelyTraversePassiveUnmountEffects(parentFiber: Fiber): void {\n   // Deletions effects can be scheduled on any fiber type. They need to happen\n   // before the children effects have fired.\n@@ -4696,7 +4059,7 @@ function commitPassiveUnmountInsideDeletedTreeOnFiber(\n   }\n }\n \n-function invokeLayoutEffectMountInDEV(fiber: Fiber): void {\n+export function invokeLayoutEffectMountInDEV(fiber: Fiber): void {\n   if (__DEV__) {\n     // We don't need to re-check StrictEffectsMode here.\n     // This function is only called if that check has already passed.\n@@ -4726,7 +4089,7 @@ function invokeLayoutEffectMountInDEV(fiber: Fiber): void {\n   }\n }\n \n-function invokePassiveEffectMountInDEV(fiber: Fiber): void {\n+export function invokePassiveEffectMountInDEV(fiber: Fiber): void {\n   if (__DEV__) {\n     // We don't need to re-check StrictEffectsMode here.\n     // This function is only called if that check has already passed.\n@@ -4745,7 +4108,7 @@ function invokePassiveEffectMountInDEV(fiber: Fiber): void {\n   }\n }\n \n-function invokeLayoutEffectUnmountInDEV(fiber: Fiber): void {\n+export function invokeLayoutEffectUnmountInDEV(fiber: Fiber): void {\n   if (__DEV__) {\n     // We don't need to re-check StrictEffectsMode here.\n     // This function is only called if that check has already passed.\n@@ -4775,7 +4138,7 @@ function invokeLayoutEffectUnmountInDEV(fiber: Fiber): void {\n   }\n }\n \n-function invokePassiveEffectUnmountInDEV(fiber: Fiber): void {\n+export function invokePassiveEffectUnmountInDEV(fiber: Fiber): void {\n   if (__DEV__) {\n     // We don't need to re-check StrictEffectsMode here.\n     // This function is only called if that check has already passed.\n@@ -4796,12 +4159,3 @@ function invokePassiveEffectUnmountInDEV(fiber: Fiber): void {\n     }\n   }\n }\n-\n-export {\n-  commitPlacement,\n-  commitAttachRef,\n-  invokeLayoutEffectMountInDEV,\n-  invokeLayoutEffectUnmountInDEV,\n-  invokePassiveEffectMountInDEV,\n-  invokePassiveEffectUnmountInDEV,\n-};"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -1423,6 +1423,7 @@ function commitDeletionEffectsOnFiber(\n   nearestMountedAncestor: Fiber,\n   deletedFiber: Fiber,\n ) {\n+  // TODO: Delete this Hook once new DevTools ships everywhere. No longer needed.\n   onCommitUnmount(deletedFiber);\n \n   // The cases in this outer switch modify the stack before they traverse\n@@ -1926,11 +1927,7 @@ function recursivelyTraverseMutationEffects(\n   if (deletions !== null) {\n     for (let i = 0; i < deletions.length; i++) {\n       const childToDelete = deletions[i];\n-      try {\n-        commitDeletionEffects(root, parentFiber, childToDelete);\n-      } catch (error) {\n-        captureCommitPhaseError(childToDelete, parentFiber, error);\n-      }\n+      commitDeletionEffects(root, parentFiber, childToDelete);\n     }\n   }\n "
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitEffects.js",
                "git_diff": "@@ -21,6 +21,7 @@ import {\n   disableStringRefs,\n } from 'shared/ReactFeatureFlags';\n import {\n+  ClassComponent,\n   HostComponent,\n   HostHoistable,\n   HostSingleton,\n@@ -37,7 +38,10 @@ import {\n   isCurrentUpdateNested,\n } from './ReactProfilerTimer';\n import {NoMode, ProfileMode} from './ReactTypeOfMode';\n-import {commitCallbacks} from './ReactFiberClassUpdateQueue';\n+import {\n+  commitCallbacks,\n+  commitHiddenCallbacks,\n+} from './ReactFiberClassUpdateQueue';\n import {getPublicInstance} from './ReactFiberConfig';\n import {\n   captureCommitPhaseError,\n@@ -438,6 +442,22 @@ export function commitClassLayoutLifecycles(\n   }\n }\n \n+export function commitClassDidMount(finishedWork: Fiber) {\n+  // TODO: Check for LayoutStatic flag\n+  const instance = finishedWork.stateNode;\n+  if (typeof instance.componentDidMount === 'function') {\n+    if (__DEV__) {\n+      callComponentDidMountInDEV(finishedWork, instance);\n+    } else {\n+      try {\n+        instance.componentDidMount();\n+      } catch (error) {\n+        captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+      }\n+    }\n+  }\n+}\n+\n export function commitClassCallbacks(finishedWork: Fiber) {\n   // TODO: I think this is now always non-null by the time it reaches the\n   // commit phase. Consider removing the type check.\n@@ -484,6 +504,47 @@ export function commitClassCallbacks(finishedWork: Fiber) {\n   }\n }\n \n+export function commitClassHiddenCallbacks(finishedWork: Fiber) {\n+  // Commit any callbacks that would have fired while the component\n+  // was hidden.\n+  const updateQueue: UpdateQueue<mixed> | null =\n+    (finishedWork.updateQueue: any);\n+  if (updateQueue !== null) {\n+    const instance = finishedWork.stateNode;\n+    try {\n+      commitHiddenCallbacks(updateQueue, instance);\n+    } catch (error) {\n+      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+    }\n+  }\n+}\n+\n+export function commitRootCallbacks(finishedWork: Fiber) {\n+  // TODO: I think this is now always non-null by the time it reaches the\n+  // commit phase. Consider removing the type check.\n+  const updateQueue: UpdateQueue<mixed> | null =\n+    (finishedWork.updateQueue: any);\n+  if (updateQueue !== null) {\n+    let instance = null;\n+    if (finishedWork.child !== null) {\n+      switch (finishedWork.child.tag) {\n+        case HostSingleton:\n+        case HostComponent:\n+          instance = getPublicInstance(finishedWork.child.stateNode);\n+          break;\n+        case ClassComponent:\n+          instance = finishedWork.child.stateNode;\n+          break;\n+      }\n+    }\n+    try {\n+      commitCallbacks(updateQueue, instance);\n+    } catch (error) {\n+      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+    }\n+  }\n+}\n+\n let didWarnAboutUndefinedSnapshotBeforeUpdate: Set<mixed> | null = null;\n if (__DEV__) {\n   didWarnAboutUndefinedSnapshotBeforeUpdate = new Set();"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -107,13 +107,8 @@ import {\n   startLayoutEffectTimer,\n } from './ReactProfilerTimer';\n import {ConcurrentMode, NoMode, ProfileMode} from './ReactTypeOfMode';\n+import {deferHiddenCallbacks} from './ReactFiberClassUpdateQueue';\n import {\n-  deferHiddenCallbacks,\n-  commitHiddenCallbacks,\n-  commitCallbacks,\n-} from './ReactFiberClassUpdateQueue';\n-import {\n-  getPublicInstance,\n   supportsMutation,\n   supportsPersistence,\n   supportsHydration,\n@@ -208,13 +203,16 @@ import {\n   commitHookPassiveMountEffects,\n   commitHookPassiveUnmountEffects,\n   commitClassLayoutLifecycles,\n+  commitClassDidMount,\n   commitClassCallbacks,\n+  commitClassHiddenCallbacks,\n   commitClassSnapshot,\n   safelyCallComponentWillUnmount,\n   safelyAttachRef,\n   safelyDetachRef,\n   safelyCallDestroy,\n   commitProfilerUpdate,\n+  commitRootCallbacks,\n } from './ReactFiberCommitEffects';\n \n // Used during the commit phase to track the state of the Offscreen component stack.\n@@ -519,29 +517,7 @@ function commitLayoutEffectOnFiber(\n         committedLanes,\n       );\n       if (flags & Callback) {\n-        // TODO: I think this is now always non-null by the time it reaches the\n-        // commit phase. Consider removing the type check.\n-        const updateQueue: UpdateQueue<mixed> | null =\n-          (finishedWork.updateQueue: any);\n-        if (updateQueue !== null) {\n-          let instance = null;\n-          if (finishedWork.child !== null) {\n-            switch (finishedWork.child.tag) {\n-              case HostSingleton:\n-              case HostComponent:\n-                instance = getPublicInstance(finishedWork.child.stateNode);\n-                break;\n-              case ClassComponent:\n-                instance = finishedWork.child.stateNode;\n-                break;\n-            }\n-          }\n-          try {\n-            commitCallbacks(updateQueue, instance);\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n-        }\n+        commitRootCallbacks(finishedWork);\n       }\n       break;\n     }\n@@ -2713,23 +2689,9 @@ export function reappearLayoutEffects(\n         includeWorkInProgressEffects,\n       );\n \n-      // TODO: Check for LayoutStatic flag\n-      const instance = finishedWork.stateNode;\n-      if (typeof instance.componentDidMount === 'function') {\n-        try {\n-          instance.componentDidMount();\n-        } catch (error) {\n-          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-        }\n-      }\n+      commitClassDidMount(finishedWork);\n \n-      // Commit any callbacks that would have fired while the component\n-      // was hidden.\n-      const updateQueue: UpdateQueue<mixed> | null =\n-        (finishedWork.updateQueue: any);\n-      if (updateQueue !== null) {\n-        commitHiddenCallbacks(updateQueue, instance);\n-      }\n+      commitClassHiddenCallbacks(finishedWork);\n \n       // If this is newly finished work, check for setState callbacks\n       if (includeWorkInProgressEffects && flags & Callback) {\n@@ -4072,14 +4034,7 @@ export function invokeLayoutEffectMountInDEV(fiber: Fiber): void {\n         break;\n       }\n       case ClassComponent: {\n-        const instance = fiber.stateNode;\n-        if (typeof instance.componentDidMount === 'function') {\n-          try {\n-            instance.componentDidMount();\n-          } catch (error) {\n-            captureCommitPhaseError(fiber, fiber.return, error);\n-          }\n-        }\n+        commitClassDidMount(fiber);\n         break;\n       }\n     }"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitEffects.js",
                "git_diff": "@@ -93,113 +93,109 @@ export function commitHookLayoutEffects(\n   // e.g. a destroy function in one component should never override a ref set\n   // by a create function in another component during the same commit.\n   if (shouldProfile(finishedWork)) {\n-    try {\n-      startLayoutEffectTimer();\n-      commitHookEffectListMount(hookFlags, finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n+    startLayoutEffectTimer();\n+    commitHookEffectListMount(hookFlags, finishedWork);\n     recordLayoutEffectDuration(finishedWork);\n   } else {\n-    try {\n-      commitHookEffectListMount(hookFlags, finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n+    commitHookEffectListMount(hookFlags, finishedWork);\n   }\n }\n \n export function commitHookEffectListMount(\n   flags: HookFlags,\n   finishedWork: Fiber,\n ) {\n-  const updateQueue: FunctionComponentUpdateQueue | null =\n-    (finishedWork.updateQueue: any);\n-  const lastEffect = updateQueue !== null ? updateQueue.lastEffect : null;\n-  if (lastEffect !== null) {\n-    const firstEffect = lastEffect.next;\n-    let effect = firstEffect;\n-    do {\n-      if ((effect.tag & flags) === flags) {\n-        if (enableSchedulingProfiler) {\n-          if ((flags & HookPassive) !== NoHookEffect) {\n-            markComponentPassiveEffectMountStarted(finishedWork);\n-          } else if ((flags & HookLayout) !== NoHookEffect) {\n-            markComponentLayoutEffectMountStarted(finishedWork);\n+  try {\n+    const updateQueue: FunctionComponentUpdateQueue | null =\n+      (finishedWork.updateQueue: any);\n+    const lastEffect = updateQueue !== null ? updateQueue.lastEffect : null;\n+    if (lastEffect !== null) {\n+      const firstEffect = lastEffect.next;\n+      let effect = firstEffect;\n+      do {\n+        if ((effect.tag & flags) === flags) {\n+          if (enableSchedulingProfiler) {\n+            if ((flags & HookPassive) !== NoHookEffect) {\n+              markComponentPassiveEffectMountStarted(finishedWork);\n+            } else if ((flags & HookLayout) !== NoHookEffect) {\n+              markComponentLayoutEffectMountStarted(finishedWork);\n+            }\n           }\n-        }\n \n-        // Mount\n-        let destroy;\n-        if (__DEV__) {\n-          if ((flags & HookInsertion) !== NoHookEffect) {\n-            setIsRunningInsertionEffect(true);\n-          }\n-          destroy = callCreateInDEV(effect);\n-          if ((flags & HookInsertion) !== NoHookEffect) {\n-            setIsRunningInsertionEffect(false);\n+          // Mount\n+          let destroy;\n+          if (__DEV__) {\n+            if ((flags & HookInsertion) !== NoHookEffect) {\n+              setIsRunningInsertionEffect(true);\n+            }\n+            destroy = callCreateInDEV(effect);\n+            if ((flags & HookInsertion) !== NoHookEffect) {\n+              setIsRunningInsertionEffect(false);\n+            }\n+          } else {\n+            const create = effect.create;\n+            const inst = effect.inst;\n+            destroy = create();\n+            inst.destroy = destroy;\n           }\n-        } else {\n-          const create = effect.create;\n-          const inst = effect.inst;\n-          destroy = create();\n-          inst.destroy = destroy;\n-        }\n \n-        if (enableSchedulingProfiler) {\n-          if ((flags & HookPassive) !== NoHookEffect) {\n-            markComponentPassiveEffectMountStopped();\n-          } else if ((flags & HookLayout) !== NoHookEffect) {\n-            markComponentLayoutEffectMountStopped();\n+          if (enableSchedulingProfiler) {\n+            if ((flags & HookPassive) !== NoHookEffect) {\n+              markComponentPassiveEffectMountStopped();\n+            } else if ((flags & HookLayout) !== NoHookEffect) {\n+              markComponentLayoutEffectMountStopped();\n+            }\n           }\n-        }\n \n-        if (__DEV__) {\n-          if (destroy !== undefined && typeof destroy !== 'function') {\n-            let hookName;\n-            if ((effect.tag & HookLayout) !== NoFlags) {\n-              hookName = 'useLayoutEffect';\n-            } else if ((effect.tag & HookInsertion) !== NoFlags) {\n-              hookName = 'useInsertionEffect';\n-            } else {\n-              hookName = 'useEffect';\n-            }\n-            let addendum;\n-            if (destroy === null) {\n-              addendum =\n-                ' You returned null. If your effect does not require clean ' +\n-                'up, return undefined (or nothing).';\n-            } else if (typeof destroy.then === 'function') {\n-              addendum =\n-                '\\n\\nIt looks like you wrote ' +\n-                hookName +\n-                '(async () => ...) or returned a Promise. ' +\n-                'Instead, write the async function inside your effect ' +\n-                'and call it immediately:\\n\\n' +\n-                hookName +\n-                '(() => {\\n' +\n-                '  async function fetchData() {\\n' +\n-                '    // You can await here\\n' +\n-                '    const response = await MyAPI.getData(someId);\\n' +\n-                '    // ...\\n' +\n-                '  }\\n' +\n-                '  fetchData();\\n' +\n-                `}, [someId]); // Or [] if effect doesn't need props or state\\n\\n` +\n-                'Learn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching';\n-            } else {\n-              addendum = ' You returned: ' + destroy;\n+          if (__DEV__) {\n+            if (destroy !== undefined && typeof destroy !== 'function') {\n+              let hookName;\n+              if ((effect.tag & HookLayout) !== NoFlags) {\n+                hookName = 'useLayoutEffect';\n+              } else if ((effect.tag & HookInsertion) !== NoFlags) {\n+                hookName = 'useInsertionEffect';\n+              } else {\n+                hookName = 'useEffect';\n+              }\n+              let addendum;\n+              if (destroy === null) {\n+                addendum =\n+                  ' You returned null. If your effect does not require clean ' +\n+                  'up, return undefined (or nothing).';\n+              } else if (typeof destroy.then === 'function') {\n+                addendum =\n+                  '\\n\\nIt looks like you wrote ' +\n+                  hookName +\n+                  '(async () => ...) or returned a Promise. ' +\n+                  'Instead, write the async function inside your effect ' +\n+                  'and call it immediately:\\n\\n' +\n+                  hookName +\n+                  '(() => {\\n' +\n+                  '  async function fetchData() {\\n' +\n+                  '    // You can await here\\n' +\n+                  '    const response = await MyAPI.getData(someId);\\n' +\n+                  '    // ...\\n' +\n+                  '  }\\n' +\n+                  '  fetchData();\\n' +\n+                  `}, [someId]); // Or [] if effect doesn't need props or state\\n\\n` +\n+                  'Learn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching';\n+              } else {\n+                addendum = ' You returned: ' + destroy;\n+              }\n+              console.error(\n+                '%s must not return anything besides a function, ' +\n+                  'which is used for clean-up.%s',\n+                hookName,\n+                addendum,\n+              );\n             }\n-            console.error(\n-              '%s must not return anything besides a function, ' +\n-                'which is used for clean-up.%s',\n-              hookName,\n-              addendum,\n-            );\n           }\n         }\n-      }\n-      effect = effect.next;\n-    } while (effect !== firstEffect);\n+        effect = effect.next;\n+      } while (effect !== firstEffect);\n+    }\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n }\n \n@@ -208,50 +204,54 @@ export function commitHookEffectListUnmount(\n   finishedWork: Fiber,\n   nearestMountedAncestor: Fiber | null,\n ) {\n-  const updateQueue: FunctionComponentUpdateQueue | null =\n-    (finishedWork.updateQueue: any);\n-  const lastEffect = updateQueue !== null ? updateQueue.lastEffect : null;\n-  if (lastEffect !== null) {\n-    const firstEffect = lastEffect.next;\n-    let effect = firstEffect;\n-    do {\n-      if ((effect.tag & flags) === flags) {\n-        // Unmount\n-        const inst = effect.inst;\n-        const destroy = inst.destroy;\n-        if (destroy !== undefined) {\n-          inst.destroy = undefined;\n-          if (enableSchedulingProfiler) {\n-            if ((flags & HookPassive) !== NoHookEffect) {\n-              markComponentPassiveEffectUnmountStarted(finishedWork);\n-            } else if ((flags & HookLayout) !== NoHookEffect) {\n-              markComponentLayoutEffectUnmountStarted(finishedWork);\n+  try {\n+    const updateQueue: FunctionComponentUpdateQueue | null =\n+      (finishedWork.updateQueue: any);\n+    const lastEffect = updateQueue !== null ? updateQueue.lastEffect : null;\n+    if (lastEffect !== null) {\n+      const firstEffect = lastEffect.next;\n+      let effect = firstEffect;\n+      do {\n+        if ((effect.tag & flags) === flags) {\n+          // Unmount\n+          const inst = effect.inst;\n+          const destroy = inst.destroy;\n+          if (destroy !== undefined) {\n+            inst.destroy = undefined;\n+            if (enableSchedulingProfiler) {\n+              if ((flags & HookPassive) !== NoHookEffect) {\n+                markComponentPassiveEffectUnmountStarted(finishedWork);\n+              } else if ((flags & HookLayout) !== NoHookEffect) {\n+                markComponentLayoutEffectUnmountStarted(finishedWork);\n+              }\n             }\n-          }\n \n-          if (__DEV__) {\n-            if ((flags & HookInsertion) !== NoHookEffect) {\n-              setIsRunningInsertionEffect(true);\n+            if (__DEV__) {\n+              if ((flags & HookInsertion) !== NoHookEffect) {\n+                setIsRunningInsertionEffect(true);\n+              }\n             }\n-          }\n-          safelyCallDestroy(finishedWork, nearestMountedAncestor, destroy);\n-          if (__DEV__) {\n-            if ((flags & HookInsertion) !== NoHookEffect) {\n-              setIsRunningInsertionEffect(false);\n+            safelyCallDestroy(finishedWork, nearestMountedAncestor, destroy);\n+            if (__DEV__) {\n+              if ((flags & HookInsertion) !== NoHookEffect) {\n+                setIsRunningInsertionEffect(false);\n+              }\n             }\n-          }\n \n-          if (enableSchedulingProfiler) {\n-            if ((flags & HookPassive) !== NoHookEffect) {\n-              markComponentPassiveEffectUnmountStopped();\n-            } else if ((flags & HookLayout) !== NoHookEffect) {\n-              markComponentLayoutEffectUnmountStopped();\n+            if (enableSchedulingProfiler) {\n+              if ((flags & HookPassive) !== NoHookEffect) {\n+                markComponentPassiveEffectUnmountStopped();\n+              } else if ((flags & HookLayout) !== NoHookEffect) {\n+                markComponentLayoutEffectUnmountStopped();\n+              }\n             }\n           }\n         }\n-      }\n-      effect = effect.next;\n-    } while (effect !== firstEffect);\n+        effect = effect.next;\n+      } while (effect !== firstEffect);\n+    }\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n }\n \n@@ -261,18 +261,10 @@ export function commitHookPassiveMountEffects(\n ) {\n   if (shouldProfile(finishedWork)) {\n     startPassiveEffectTimer();\n-    try {\n-      commitHookEffectListMount(hookFlags, finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n+    commitHookEffectListMount(hookFlags, finishedWork);\n     recordPassiveEffectDuration(finishedWork);\n   } else {\n-    try {\n-      commitHookEffectListMount(hookFlags, finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n+    commitHookEffectListMount(hookFlags, finishedWork);\n   }\n }\n "
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -1951,46 +1951,31 @@ function commitMutationEffectsOnFiber(\n       commitReconciliationEffects(finishedWork);\n \n       if (flags & Update) {\n-        try {\n-          commitHookEffectListUnmount(\n-            HookInsertion | HookHasEffect,\n-            finishedWork,\n-            finishedWork.return,\n-          );\n-          commitHookEffectListMount(\n-            HookInsertion | HookHasEffect,\n-            finishedWork,\n-          );\n-        } catch (error) {\n-          captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-        }\n+        commitHookEffectListUnmount(\n+          HookInsertion | HookHasEffect,\n+          finishedWork,\n+          finishedWork.return,\n+        );\n+        commitHookEffectListMount(HookInsertion | HookHasEffect, finishedWork);\n         // Layout effects are destroyed during the mutation phase so that all\n         // destroy functions for all fibers are called before any create functions.\n         // This prevents sibling component effects from interfering with each other,\n         // e.g. a destroy function in one component should never override a ref set\n         // by a create function in another component during the same commit.\n         if (shouldProfile(finishedWork)) {\n-          try {\n-            startLayoutEffectTimer();\n-            commitHookEffectListUnmount(\n-              HookLayout | HookHasEffect,\n-              finishedWork,\n-              finishedWork.return,\n-            );\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n+          startLayoutEffectTimer();\n+          commitHookEffectListUnmount(\n+            HookLayout | HookHasEffect,\n+            finishedWork,\n+            finishedWork.return,\n+          );\n           recordLayoutEffectDuration(finishedWork);\n         } else {\n-          try {\n-            commitHookEffectListUnmount(\n-              HookLayout | HookHasEffect,\n-              finishedWork,\n-              finishedWork.return,\n-            );\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n+          commitHookEffectListUnmount(\n+            HookLayout | HookHasEffect,\n+            finishedWork,\n+            finishedWork.return,\n+          );\n         }\n       }\n       return;\n@@ -4026,11 +4011,7 @@ export function invokeLayoutEffectMountInDEV(fiber: Fiber): void {\n       case FunctionComponent:\n       case ForwardRef:\n       case SimpleMemoComponent: {\n-        try {\n-          commitHookEffectListMount(HookLayout | HookHasEffect, fiber);\n-        } catch (error) {\n-          captureCommitPhaseError(fiber, fiber.return, error);\n-        }\n+        commitHookEffectListMount(HookLayout | HookHasEffect, fiber);\n         break;\n       }\n       case ClassComponent: {\n@@ -4049,11 +4030,7 @@ export function invokePassiveEffectMountInDEV(fiber: Fiber): void {\n       case FunctionComponent:\n       case ForwardRef:\n       case SimpleMemoComponent: {\n-        try {\n-          commitHookEffectListMount(HookPassive | HookHasEffect, fiber);\n-        } catch (error) {\n-          captureCommitPhaseError(fiber, fiber.return, error);\n-        }\n+        commitHookEffectListMount(HookPassive | HookHasEffect, fiber);\n         break;\n       }\n     }\n@@ -4068,15 +4045,11 @@ export function invokeLayoutEffectUnmountInDEV(fiber: Fiber): void {\n       case FunctionComponent:\n       case ForwardRef:\n       case SimpleMemoComponent: {\n-        try {\n-          commitHookEffectListUnmount(\n-            HookLayout | HookHasEffect,\n-            fiber,\n-            fiber.return,\n-          );\n-        } catch (error) {\n-          captureCommitPhaseError(fiber, fiber.return, error);\n-        }\n+        commitHookEffectListUnmount(\n+          HookLayout | HookHasEffect,\n+          fiber,\n+          fiber.return,\n+        );\n         break;\n       }\n       case ClassComponent: {\n@@ -4098,15 +4071,11 @@ export function invokePassiveEffectUnmountInDEV(fiber: Fiber): void {\n       case FunctionComponent:\n       case ForwardRef:\n       case SimpleMemoComponent: {\n-        try {\n-          commitHookEffectListUnmount(\n-            HookPassive | HookHasEffect,\n-            fiber,\n-            fiber.return,\n-          );\n-        } catch (error) {\n-          captureCommitPhaseError(fiber, fiber.return, error);\n-        }\n+        commitHookEffectListUnmount(\n+          HookPassive | HookHasEffect,\n+          fiber,\n+          fiber.return,\n+        );\n       }\n     }\n   }"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitHostEffects.js",
                "git_diff": "@@ -0,0 +1,387 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ *\n+ * @flow\n+ */\n+\n+import type {\n+  Instance,\n+  TextInstance,\n+  SuspenseInstance,\n+  Container,\n+  ChildSet,\n+} from './ReactFiberConfig';\n+import type {Fiber, FiberRoot} from './ReactInternalTypes';\n+\n+import {\n+  HostRoot,\n+  HostComponent,\n+  HostHoistable,\n+  HostSingleton,\n+  HostText,\n+  HostPortal,\n+  DehydratedFragment,\n+} from './ReactWorkTags';\n+import {ContentReset, Placement} from './ReactFiberFlags';\n+import {\n+  supportsMutation,\n+  supportsResources,\n+  supportsSingletons,\n+  commitMount,\n+  commitUpdate,\n+  resetTextContent,\n+  commitTextUpdate,\n+  appendChild,\n+  appendChildToContainer,\n+  insertBefore,\n+  insertInContainerBefore,\n+  replaceContainerChildren,\n+  hideInstance,\n+  hideTextInstance,\n+  unhideInstance,\n+  unhideTextInstance,\n+  commitHydratedContainer,\n+  commitHydratedSuspenseInstance,\n+} from './ReactFiberConfig';\n+import {captureCommitPhaseError} from './ReactFiberWorkLoop';\n+\n+export function commitHostMount(finishedWork: Fiber) {\n+  const type = finishedWork.type;\n+  const props = finishedWork.memoizedProps;\n+  const instance: Instance = finishedWork.stateNode;\n+  try {\n+    commitMount(instance, type, props, finishedWork);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+export function commitHostUpdate(\n+  finishedWork: Fiber,\n+  newProps: any,\n+  oldProps: any,\n+) {\n+  try {\n+    commitUpdate(\n+      finishedWork.stateNode,\n+      finishedWork.type,\n+      oldProps,\n+      newProps,\n+      finishedWork,\n+    );\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+export function commitHostTextUpdate(\n+  finishedWork: Fiber,\n+  newText: string,\n+  oldText: string,\n+) {\n+  const textInstance: TextInstance = finishedWork.stateNode;\n+  try {\n+    commitTextUpdate(textInstance, oldText, newText);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+export function commitHostResetTextContent(finishedWork: Fiber) {\n+  const instance: Instance = finishedWork.stateNode;\n+  try {\n+    resetTextContent(instance);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+export function commitShowHideHostInstance(node: Fiber, isHidden: boolean) {\n+  try {\n+    const instance = node.stateNode;\n+    if (isHidden) {\n+      hideInstance(instance);\n+    } else {\n+      unhideInstance(node.stateNode, node.memoizedProps);\n+    }\n+  } catch (error) {\n+    captureCommitPhaseError(node, node.return, error);\n+  }\n+}\n+\n+export function commitShowHideHostTextInstance(node: Fiber, isHidden: boolean) {\n+  try {\n+    const instance = node.stateNode;\n+    if (isHidden) {\n+      hideTextInstance(instance);\n+    } else {\n+      unhideTextInstance(instance, node.memoizedProps);\n+    }\n+  } catch (error) {\n+    captureCommitPhaseError(node, node.return, error);\n+  }\n+}\n+\n+function getHostParentFiber(fiber: Fiber): Fiber {\n+  let parent = fiber.return;\n+  while (parent !== null) {\n+    if (isHostParent(parent)) {\n+      return parent;\n+    }\n+    parent = parent.return;\n+  }\n+\n+  throw new Error(\n+    'Expected to find a host parent. This error is likely caused by a bug ' +\n+      'in React. Please file an issue.',\n+  );\n+}\n+\n+function isHostParent(fiber: Fiber): boolean {\n+  return (\n+    fiber.tag === HostComponent ||\n+    fiber.tag === HostRoot ||\n+    (supportsResources ? fiber.tag === HostHoistable : false) ||\n+    (supportsSingletons ? fiber.tag === HostSingleton : false) ||\n+    fiber.tag === HostPortal\n+  );\n+}\n+\n+function getHostSibling(fiber: Fiber): ?Instance {\n+  // We're going to search forward into the tree until we find a sibling host\n+  // node. Unfortunately, if multiple insertions are done in a row we have to\n+  // search past them. This leads to exponential search for the next sibling.\n+  // TODO: Find a more efficient way to do this.\n+  let node: Fiber = fiber;\n+  siblings: while (true) {\n+    // If we didn't find anything, let's try the next sibling.\n+    while (node.sibling === null) {\n+      if (node.return === null || isHostParent(node.return)) {\n+        // If we pop out of the root or hit the parent the fiber we are the\n+        // last sibling.\n+        return null;\n+      }\n+      // $FlowFixMe[incompatible-type] found when upgrading Flow\n+      node = node.return;\n+    }\n+    node.sibling.return = node.return;\n+    node = node.sibling;\n+    while (\n+      node.tag !== HostComponent &&\n+      node.tag !== HostText &&\n+      (!supportsSingletons ? true : node.tag !== HostSingleton) &&\n+      node.tag !== DehydratedFragment\n+    ) {\n+      // If it is not host node and, we might have a host node inside it.\n+      // Try to search down until we find one.\n+      if (node.flags & Placement) {\n+        // If we don't have a child, try the siblings instead.\n+        continue siblings;\n+      }\n+      // If we don't have a child, try the siblings instead.\n+      // We also skip portals because they are not part of this host tree.\n+      if (node.child === null || node.tag === HostPortal) {\n+        continue siblings;\n+      } else {\n+        node.child.return = node;\n+        node = node.child;\n+      }\n+    }\n+    // Check if this host node is stable or about to be placed.\n+    if (!(node.flags & Placement)) {\n+      // Found it!\n+      return node.stateNode;\n+    }\n+  }\n+}\n+\n+function insertOrAppendPlacementNodeIntoContainer(\n+  node: Fiber,\n+  before: ?Instance,\n+  parent: Container,\n+): void {\n+  const {tag} = node;\n+  const isHost = tag === HostComponent || tag === HostText;\n+  if (isHost) {\n+    const stateNode = node.stateNode;\n+    if (before) {\n+      insertInContainerBefore(parent, stateNode, before);\n+    } else {\n+      appendChildToContainer(parent, stateNode);\n+    }\n+  } else if (\n+    tag === HostPortal ||\n+    (supportsSingletons ? tag === HostSingleton : false)\n+  ) {\n+    // If the insertion itself is a portal, then we don't want to traverse\n+    // down its children. Instead, we'll get insertions from each child in\n+    // the portal directly.\n+    // If the insertion is a HostSingleton then it will be placed independently\n+  } else {\n+    const child = node.child;\n+    if (child !== null) {\n+      insertOrAppendPlacementNodeIntoContainer(child, before, parent);\n+      let sibling = child.sibling;\n+      while (sibling !== null) {\n+        insertOrAppendPlacementNodeIntoContainer(sibling, before, parent);\n+        sibling = sibling.sibling;\n+      }\n+    }\n+  }\n+}\n+\n+function insertOrAppendPlacementNode(\n+  node: Fiber,\n+  before: ?Instance,\n+  parent: Instance,\n+): void {\n+  const {tag} = node;\n+  const isHost = tag === HostComponent || tag === HostText;\n+  if (isHost) {\n+    const stateNode = node.stateNode;\n+    if (before) {\n+      insertBefore(parent, stateNode, before);\n+    } else {\n+      appendChild(parent, stateNode);\n+    }\n+  } else if (\n+    tag === HostPortal ||\n+    (supportsSingletons ? tag === HostSingleton : false)\n+  ) {\n+    // If the insertion itself is a portal, then we don't want to traverse\n+    // down its children. Instead, we'll get insertions from each child in\n+    // the portal directly.\n+    // If the insertion is a HostSingleton then it will be placed independently\n+  } else {\n+    const child = node.child;\n+    if (child !== null) {\n+      insertOrAppendPlacementNode(child, before, parent);\n+      let sibling = child.sibling;\n+      while (sibling !== null) {\n+        insertOrAppendPlacementNode(sibling, before, parent);\n+        sibling = sibling.sibling;\n+      }\n+    }\n+  }\n+}\n+\n+function commitPlacement(finishedWork: Fiber): void {\n+  if (!supportsMutation) {\n+    return;\n+  }\n+\n+  if (supportsSingletons) {\n+    if (finishedWork.tag === HostSingleton) {\n+      // Singletons are already in the Host and don't need to be placed\n+      // Since they operate somewhat like Portals though their children will\n+      // have Placement and will get placed inside them\n+      return;\n+    }\n+  }\n+  // Recursively insert all host nodes into the parent.\n+  const parentFiber = getHostParentFiber(finishedWork);\n+\n+  switch (parentFiber.tag) {\n+    case HostSingleton: {\n+      if (supportsSingletons) {\n+        const parent: Instance = parentFiber.stateNode;\n+        const before = getHostSibling(finishedWork);\n+        // We only have the top Fiber that was inserted but we need to recurse down its\n+        // children to find all the terminal nodes.\n+        insertOrAppendPlacementNode(finishedWork, before, parent);\n+        break;\n+      }\n+      // Fall through\n+    }\n+    case HostComponent: {\n+      const parent: Instance = parentFiber.stateNode;\n+      if (parentFiber.flags & ContentReset) {\n+        // Reset the text content of the parent before doing any insertions\n+        resetTextContent(parent);\n+        // Clear ContentReset from the effect tag\n+        parentFiber.flags &= ~ContentReset;\n+      }\n+\n+      const before = getHostSibling(finishedWork);\n+      // We only have the top Fiber that was inserted but we need to recurse down its\n+      // children to find all the terminal nodes.\n+      insertOrAppendPlacementNode(finishedWork, before, parent);\n+      break;\n+    }\n+    case HostRoot:\n+    case HostPortal: {\n+      const parent: Container = parentFiber.stateNode.containerInfo;\n+      const before = getHostSibling(finishedWork);\n+      insertOrAppendPlacementNodeIntoContainer(finishedWork, before, parent);\n+      break;\n+    }\n+    default:\n+      throw new Error(\n+        'Invalid host parent fiber. This error is likely caused by a bug ' +\n+          'in React. Please file an issue.',\n+      );\n+  }\n+}\n+\n+export function commitHostPlacement(finishedWork: Fiber) {\n+  try {\n+    commitPlacement(finishedWork);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+export function commitHostRootContainerChildren(\n+  root: FiberRoot,\n+  finishedWork: Fiber,\n+) {\n+  const containerInfo = root.containerInfo;\n+  const pendingChildren = root.pendingChildren;\n+  try {\n+    replaceContainerChildren(containerInfo, pendingChildren);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+export function commitHostPortalContainerChildren(\n+  portal: {\n+    containerInfo: Container,\n+    pendingChildren: ChildSet,\n+    ...\n+  },\n+  finishedWork: Fiber,\n+) {\n+  const containerInfo = portal.containerInfo;\n+  const pendingChildren = portal.pendingChildren;\n+  try {\n+    replaceContainerChildren(containerInfo, pendingChildren);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+export function commitHostHydratedContainer(\n+  root: FiberRoot,\n+  finishedWork: Fiber,\n+) {\n+  try {\n+    commitHydratedContainer(root.containerInfo);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}\n+\n+export function commitHostHydratedSuspense(\n+  suspenseInstance: SuspenseInstance,\n+  finishedWork: Fiber,\n+) {\n+  try {\n+    commitHydratedSuspenseInstance(suspenseInstance);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -114,26 +114,12 @@ import {\n   supportsHydration,\n   supportsResources,\n   supportsSingletons,\n-  commitMount,\n-  commitUpdate,\n-  resetTextContent,\n-  commitTextUpdate,\n-  appendChild,\n-  appendChildToContainer,\n-  insertBefore,\n-  insertInContainerBefore,\n   removeChild,\n   removeChildFromContainer,\n   clearSuspenseBoundary,\n   clearSuspenseBoundaryFromContainer,\n   replaceContainerChildren,\n   createContainerChildSet,\n-  hideInstance,\n-  hideTextInstance,\n-  unhideInstance,\n-  unhideTextInstance,\n-  commitHydratedContainer,\n-  commitHydratedSuspenseInstance,\n   clearContainer,\n   prepareScopeUpdate,\n   prepareForCommit,\n@@ -214,6 +200,19 @@ import {\n   commitProfilerUpdate,\n   commitRootCallbacks,\n } from './ReactFiberCommitEffects';\n+import {\n+  commitHostMount,\n+  commitHostUpdate,\n+  commitHostTextUpdate,\n+  commitHostResetTextContent,\n+  commitShowHideHostInstance,\n+  commitShowHideHostTextInstance,\n+  commitHostPlacement,\n+  commitHostRootContainerChildren,\n+  commitHostPortalContainerChildren,\n+  commitHostHydratedContainer,\n+  commitHostHydratedSuspense,\n+} from './ReactFiberCommitHostEffects';\n \n // Used during the commit phase to track the state of the Offscreen component stack.\n // Allows us to avoid traversing the return path to find the nearest Offscreen ancestor.\n@@ -457,17 +456,6 @@ export function commitPassiveEffectDurations(\n   }\n }\n \n-function commitHostComponentMount(finishedWork: Fiber) {\n-  const type = finishedWork.type;\n-  const props = finishedWork.memoizedProps;\n-  const instance: Instance = finishedWork.stateNode;\n-  try {\n-    commitMount(instance, type, props, finishedWork);\n-  } catch (error) {\n-    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-  }\n-}\n-\n function commitLayoutEffectOnFiber(\n   finishedRoot: FiberRoot,\n   current: Fiber | null,\n@@ -549,7 +537,7 @@ function commitLayoutEffectOnFiber(\n       // These effects should only be committed when components are first mounted,\n       // aka when there is no current/alternate.\n       if (current === null && flags & Update) {\n-        commitHostComponentMount(finishedWork);\n+        commitHostMount(finishedWork);\n       }\n \n       if (flags & Ref) {\n@@ -961,29 +949,11 @@ function hideOrUnhideAllChildren(finishedWork: Fiber, isHidden: boolean) {\n       ) {\n         if (hostSubtreeRoot === null) {\n           hostSubtreeRoot = node;\n-          try {\n-            const instance = node.stateNode;\n-            if (isHidden) {\n-              hideInstance(instance);\n-            } else {\n-              unhideInstance(node.stateNode, node.memoizedProps);\n-            }\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n+          commitShowHideHostInstance(node, isHidden);\n         }\n       } else if (node.tag === HostText) {\n         if (hostSubtreeRoot === null) {\n-          try {\n-            const instance = node.stateNode;\n-            if (isHidden) {\n-              hideTextInstance(instance);\n-            } else {\n-              unhideTextInstance(instance, node.memoizedProps);\n-            }\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n+          commitShowHideHostTextInstance(node, isHidden);\n         }\n       } else if (\n         (node.tag === OffscreenComponent ||\n@@ -1109,207 +1079,6 @@ function emptyPortalContainer(current: Fiber) {\n   replaceContainerChildren(containerInfo, emptyChildSet);\n }\n \n-function getHostParentFiber(fiber: Fiber): Fiber {\n-  let parent = fiber.return;\n-  while (parent !== null) {\n-    if (isHostParent(parent)) {\n-      return parent;\n-    }\n-    parent = parent.return;\n-  }\n-\n-  throw new Error(\n-    'Expected to find a host parent. This error is likely caused by a bug ' +\n-      'in React. Please file an issue.',\n-  );\n-}\n-\n-function isHostParent(fiber: Fiber): boolean {\n-  return (\n-    fiber.tag === HostComponent ||\n-    fiber.tag === HostRoot ||\n-    (supportsResources ? fiber.tag === HostHoistable : false) ||\n-    (supportsSingletons ? fiber.tag === HostSingleton : false) ||\n-    fiber.tag === HostPortal\n-  );\n-}\n-\n-function getHostSibling(fiber: Fiber): ?Instance {\n-  // We're going to search forward into the tree until we find a sibling host\n-  // node. Unfortunately, if multiple insertions are done in a row we have to\n-  // search past them. This leads to exponential search for the next sibling.\n-  // TODO: Find a more efficient way to do this.\n-  let node: Fiber = fiber;\n-  siblings: while (true) {\n-    // If we didn't find anything, let's try the next sibling.\n-    while (node.sibling === null) {\n-      if (node.return === null || isHostParent(node.return)) {\n-        // If we pop out of the root or hit the parent the fiber we are the\n-        // last sibling.\n-        return null;\n-      }\n-      // $FlowFixMe[incompatible-type] found when upgrading Flow\n-      node = node.return;\n-    }\n-    node.sibling.return = node.return;\n-    node = node.sibling;\n-    while (\n-      node.tag !== HostComponent &&\n-      node.tag !== HostText &&\n-      (!supportsSingletons ? true : node.tag !== HostSingleton) &&\n-      node.tag !== DehydratedFragment\n-    ) {\n-      // If it is not host node and, we might have a host node inside it.\n-      // Try to search down until we find one.\n-      if (node.flags & Placement) {\n-        // If we don't have a child, try the siblings instead.\n-        continue siblings;\n-      }\n-      // If we don't have a child, try the siblings instead.\n-      // We also skip portals because they are not part of this host tree.\n-      if (node.child === null || node.tag === HostPortal) {\n-        continue siblings;\n-      } else {\n-        node.child.return = node;\n-        node = node.child;\n-      }\n-    }\n-    // Check if this host node is stable or about to be placed.\n-    if (!(node.flags & Placement)) {\n-      // Found it!\n-      return node.stateNode;\n-    }\n-  }\n-}\n-\n-function commitPlacement(finishedWork: Fiber): void {\n-  if (!supportsMutation) {\n-    return;\n-  }\n-\n-  if (supportsSingletons) {\n-    if (finishedWork.tag === HostSingleton) {\n-      // Singletons are already in the Host and don't need to be placed\n-      // Since they operate somewhat like Portals though their children will\n-      // have Placement and will get placed inside them\n-      return;\n-    }\n-  }\n-  // Recursively insert all host nodes into the parent.\n-  const parentFiber = getHostParentFiber(finishedWork);\n-\n-  switch (parentFiber.tag) {\n-    case HostSingleton: {\n-      if (supportsSingletons) {\n-        const parent: Instance = parentFiber.stateNode;\n-        const before = getHostSibling(finishedWork);\n-        // We only have the top Fiber that was inserted but we need to recurse down its\n-        // children to find all the terminal nodes.\n-        insertOrAppendPlacementNode(finishedWork, before, parent);\n-        break;\n-      }\n-      // Fall through\n-    }\n-    case HostComponent: {\n-      const parent: Instance = parentFiber.stateNode;\n-      if (parentFiber.flags & ContentReset) {\n-        // Reset the text content of the parent before doing any insertions\n-        resetTextContent(parent);\n-        // Clear ContentReset from the effect tag\n-        parentFiber.flags &= ~ContentReset;\n-      }\n-\n-      const before = getHostSibling(finishedWork);\n-      // We only have the top Fiber that was inserted but we need to recurse down its\n-      // children to find all the terminal nodes.\n-      insertOrAppendPlacementNode(finishedWork, before, parent);\n-      break;\n-    }\n-    case HostRoot:\n-    case HostPortal: {\n-      const parent: Container = parentFiber.stateNode.containerInfo;\n-      const before = getHostSibling(finishedWork);\n-      insertOrAppendPlacementNodeIntoContainer(finishedWork, before, parent);\n-      break;\n-    }\n-    default:\n-      throw new Error(\n-        'Invalid host parent fiber. This error is likely caused by a bug ' +\n-          'in React. Please file an issue.',\n-      );\n-  }\n-}\n-\n-function insertOrAppendPlacementNodeIntoContainer(\n-  node: Fiber,\n-  before: ?Instance,\n-  parent: Container,\n-): void {\n-  const {tag} = node;\n-  const isHost = tag === HostComponent || tag === HostText;\n-  if (isHost) {\n-    const stateNode = node.stateNode;\n-    if (before) {\n-      insertInContainerBefore(parent, stateNode, before);\n-    } else {\n-      appendChildToContainer(parent, stateNode);\n-    }\n-  } else if (\n-    tag === HostPortal ||\n-    (supportsSingletons ? tag === HostSingleton : false)\n-  ) {\n-    // If the insertion itself is a portal, then we don't want to traverse\n-    // down its children. Instead, we'll get insertions from each child in\n-    // the portal directly.\n-    // If the insertion is a HostSingleton then it will be placed independently\n-  } else {\n-    const child = node.child;\n-    if (child !== null) {\n-      insertOrAppendPlacementNodeIntoContainer(child, before, parent);\n-      let sibling = child.sibling;\n-      while (sibling !== null) {\n-        insertOrAppendPlacementNodeIntoContainer(sibling, before, parent);\n-        sibling = sibling.sibling;\n-      }\n-    }\n-  }\n-}\n-\n-function insertOrAppendPlacementNode(\n-  node: Fiber,\n-  before: ?Instance,\n-  parent: Instance,\n-): void {\n-  const {tag} = node;\n-  const isHost = tag === HostComponent || tag === HostText;\n-  if (isHost) {\n-    const stateNode = node.stateNode;\n-    if (before) {\n-      insertBefore(parent, stateNode, before);\n-    } else {\n-      appendChild(parent, stateNode);\n-    }\n-  } else if (\n-    tag === HostPortal ||\n-    (supportsSingletons ? tag === HostSingleton : false)\n-  ) {\n-    // If the insertion itself is a portal, then we don't want to traverse\n-    // down its children. Instead, we'll get insertions from each child in\n-    // the portal directly.\n-    // If the insertion is a HostSingleton then it will be placed independently\n-  } else {\n-    const child = node.child;\n-    if (child !== null) {\n-      insertOrAppendPlacementNode(child, before, parent);\n-      let sibling = child.sibling;\n-      while (sibling !== null) {\n-        insertOrAppendPlacementNode(sibling, before, parent);\n-        sibling = sibling.sibling;\n-      }\n-    }\n-  }\n-}\n-\n // These are tracked on the stack as we recursively traverse a\n // deleted subtree.\n // TODO: Update these during the whole mutation phase, not just during\n@@ -1726,9 +1495,9 @@ function commitSuspenseHydrationCallbacks(\n       if (prevState !== null) {\n         const suspenseInstance = prevState.dehydrated;\n         if (suspenseInstance !== null) {\n-          try {\n-            commitHydratedSuspenseInstance(suspenseInstance);\n-            if (enableSuspenseCallback) {\n+          commitHostHydratedSuspense(suspenseInstance, finishedWork);\n+          if (enableSuspenseCallback) {\n+            try {\n               // TODO: Delete this feature. It's not properly covered by DEV features.\n               const hydrationCallbacks = finishedRoot.hydrationCallbacks;\n               if (hydrationCallbacks !== null) {\n@@ -1737,9 +1506,9 @@ function commitSuspenseHydrationCallbacks(\n                   onHydrated(suspenseInstance);\n                 }\n               }\n+            } catch (error) {\n+              captureCommitPhaseError(finishedWork, finishedWork.return, error);\n             }\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n           }\n         }\n       }\n@@ -2066,17 +1835,11 @@ function commitMutationEffectsOnFiber(\n               );\n             }\n           } else if (newResource === null && finishedWork.stateNode !== null) {\n-            try {\n-              commitUpdate(\n-                finishedWork.stateNode,\n-                finishedWork.type,\n-                current.memoizedProps,\n-                finishedWork.memoizedProps,\n-                finishedWork,\n-              );\n-            } catch (error) {\n-              captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-            }\n+            commitHostUpdate(\n+              finishedWork,\n+              finishedWork.memoizedProps,\n+              current.memoizedProps,\n+            );\n           }\n         }\n         return;\n@@ -2120,30 +1883,20 @@ function commitMutationEffectsOnFiber(\n         // rely on mutating the flag during commit. Like by setting a flag\n         // during the render phase instead.\n         if (finishedWork.flags & ContentReset) {\n-          const instance: Instance = finishedWork.stateNode;\n-          try {\n-            resetTextContent(instance);\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n+          commitHostResetTextContent(finishedWork);\n         }\n \n         if (flags & Update) {\n           const instance: Instance = finishedWork.stateNode;\n           if (instance != null) {\n             // Commit the work prepared earlier.\n-            const newProps = finishedWork.memoizedProps;\n             // For hydration we reuse the update path but we treat the oldProps\n             // as the newProps. The updatePayload will contain the real change in\n             // this case.\n+            const newProps = finishedWork.memoizedProps;\n             const oldProps =\n               current !== null ? current.memoizedProps : newProps;\n-            const type = finishedWork.type;\n-            try {\n-              commitUpdate(instance, type, oldProps, newProps, finishedWork);\n-            } catch (error) {\n-              captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-            }\n+            commitHostUpdate(finishedWork, newProps, oldProps);\n           }\n         }\n \n@@ -2176,19 +1929,14 @@ function commitMutationEffectsOnFiber(\n             );\n           }\n \n-          const textInstance: TextInstance = finishedWork.stateNode;\n           const newText: string = finishedWork.memoizedProps;\n           // For hydration we reuse the update path but we treat the oldProps\n           // as the newProps. The updatePayload will contain the real change in\n           // this case.\n           const oldText: string =\n             current !== null ? current.memoizedProps : newText;\n \n-          try {\n-            commitTextUpdate(textInstance, oldText, newText);\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n+          commitHostTextUpdate(finishedWork, newText, oldText);\n         }\n       }\n       return;\n@@ -2214,26 +1962,12 @@ function commitMutationEffectsOnFiber(\n           if (current !== null) {\n             const prevRootState: RootState = current.memoizedState;\n             if (prevRootState.isDehydrated) {\n-              try {\n-                commitHydratedContainer(root.containerInfo);\n-              } catch (error) {\n-                captureCommitPhaseError(\n-                  finishedWork,\n-                  finishedWork.return,\n-                  error,\n-                );\n-              }\n+              commitHostHydratedContainer(root, finishedWork);\n             }\n           }\n         }\n         if (supportsPersistence) {\n-          const containerInfo = root.containerInfo;\n-          const pendingChildren = root.pendingChildren;\n-          try {\n-            replaceContainerChildren(containerInfo, pendingChildren);\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n+          commitHostRootContainerChildren(root, finishedWork);\n         }\n       }\n \n@@ -2269,14 +2003,10 @@ function commitMutationEffectsOnFiber(\n \n       if (flags & Update) {\n         if (supportsPersistence) {\n-          const portal = finishedWork.stateNode;\n-          const containerInfo = portal.containerInfo;\n-          const pendingChildren = portal.pendingChildren;\n-          try {\n-            replaceContainerChildren(containerInfo, pendingChildren);\n-          } catch (error) {\n-            captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-          }\n+          commitHostPortalContainerChildren(\n+            finishedWork.stateNode,\n+            finishedWork,\n+          );\n         }\n       }\n       return;\n@@ -2474,11 +2204,7 @@ function commitReconciliationEffects(finishedWork: Fiber) {\n   // before the effects on this fiber have fired.\n   const flags = finishedWork.flags;\n   if (flags & Placement) {\n-    try {\n-      commitPlacement(finishedWork);\n-    } catch (error) {\n-      captureCommitPhaseError(finishedWork, finishedWork.return, error);\n-    }\n+    commitHostPlacement(finishedWork);\n     // Clear the \"placement\" from effect tag so that we know that this is\n     // inserted, before any life-cycles like componentDidMount gets called.\n     // TODO: findDOMNode doesn't rely on this any more but isMounted does\n@@ -2707,7 +2433,7 @@ export function reappearLayoutEffects(\n       // These effects should only be committed when components are first mounted,\n       // aka when there is no current/alternate.\n       if (includeWorkInProgressEffects && current === null && flags & Update) {\n-        commitHostComponentMount(finishedWork);\n+        commitHostMount(finishedWork);\n       }\n \n       // TODO: Check flags & Ref"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitHostEffects.js",
                "git_diff": "@@ -45,6 +45,8 @@ import {\n   unhideTextInstance,\n   commitHydratedContainer,\n   commitHydratedSuspenseInstance,\n+  removeChildFromContainer,\n+  removeChild,\n } from './ReactFiberConfig';\n import {captureCommitPhaseError} from './ReactFiberWorkLoop';\n \n@@ -334,6 +336,32 @@ export function commitHostPlacement(finishedWork: Fiber) {\n   }\n }\n \n+export function commitHostRemoveChildFromContainer(\n+  deletedFiber: Fiber,\n+  nearestMountedAncestor: Fiber,\n+  parentContainer: Container,\n+  hostInstance: Instance | TextInstance,\n+) {\n+  try {\n+    removeChildFromContainer(parentContainer, hostInstance);\n+  } catch (error) {\n+    captureCommitPhaseError(deletedFiber, nearestMountedAncestor, error);\n+  }\n+}\n+\n+export function commitHostRemoveChild(\n+  deletedFiber: Fiber,\n+  nearestMountedAncestor: Fiber,\n+  parentInstance: Instance,\n+  hostInstance: Instance | TextInstance,\n+) {\n+  try {\n+    removeChild(parentInstance, hostInstance);\n+  } catch (error) {\n+    captureCommitPhaseError(deletedFiber, nearestMountedAncestor, error);\n+  }\n+}\n+\n export function commitHostRootContainerChildren(\n   root: FiberRoot,\n   finishedWork: Fiber,\n@@ -354,9 +382,9 @@ export function commitHostPortalContainerChildren(\n     ...\n   },\n   finishedWork: Fiber,\n+  pendingChildren: ChildSet,\n ) {\n   const containerInfo = portal.containerInfo;\n-  const pendingChildren = portal.pendingChildren;\n   try {\n     replaceContainerChildren(containerInfo, pendingChildren);\n   } catch (error) {"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -12,7 +12,6 @@ import type {\n   TextInstance,\n   SuspenseInstance,\n   Container,\n-  ChildSet,\n   HoistableRoot,\n   FormInstance,\n } from './ReactFiberConfig';\n@@ -114,11 +113,8 @@ import {\n   supportsHydration,\n   supportsResources,\n   supportsSingletons,\n-  removeChild,\n-  removeChildFromContainer,\n   clearSuspenseBoundary,\n   clearSuspenseBoundaryFromContainer,\n-  replaceContainerChildren,\n   createContainerChildSet,\n   clearContainer,\n   prepareScopeUpdate,\n@@ -212,6 +208,8 @@ import {\n   commitHostPortalContainerChildren,\n   commitHostHydratedContainer,\n   commitHostHydratedSuspense,\n+  commitHostRemoveChildFromContainer,\n+  commitHostRemoveChild,\n } from './ReactFiberCommitHostEffects';\n \n // Used during the commit phase to track the state of the Offscreen component stack.\n@@ -1064,21 +1062,6 @@ function detachFiberAfterEffects(fiber: Fiber) {\n   fiber.updateQueue = null;\n }\n \n-function emptyPortalContainer(current: Fiber) {\n-  if (!supportsPersistence) {\n-    return;\n-  }\n-\n-  const portal: {\n-    containerInfo: Container,\n-    pendingChildren: ChildSet,\n-    ...\n-  } = current.stateNode;\n-  const {containerInfo} = portal;\n-  const emptyChildSet = createContainerChildSet();\n-  replaceContainerChildren(containerInfo, emptyChildSet);\n-}\n-\n // These are tracked on the stack as we recursively traverse a\n // deleted subtree.\n // TODO: Update these during the whole mutation phase, not just during\n@@ -1249,12 +1232,16 @@ function commitDeletionEffectsOnFiber(\n           // Now that all the child effects have unmounted, we can remove the\n           // node from the tree.\n           if (hostParentIsContainer) {\n-            removeChildFromContainer(\n+            commitHostRemoveChildFromContainer(\n+              deletedFiber,\n+              nearestMountedAncestor,\n               ((hostParent: any): Container),\n               (deletedFiber.stateNode: Instance | TextInstance),\n             );\n           } else {\n-            removeChild(\n+            commitHostRemoveChild(\n+              deletedFiber,\n+              nearestMountedAncestor,\n               ((hostParent: any): Instance),\n               (deletedFiber.stateNode: Instance | TextInstance),\n             );\n@@ -1273,9 +1260,17 @@ function commitDeletionEffectsOnFiber(\n       if (enableSuspenseCallback) {\n         const hydrationCallbacks = finishedRoot.hydrationCallbacks;\n         if (hydrationCallbacks !== null) {\n-          const onDeleted = hydrationCallbacks.onDeleted;\n-          if (onDeleted) {\n-            onDeleted((deletedFiber.stateNode: SuspenseInstance));\n+          try {\n+            const onDeleted = hydrationCallbacks.onDeleted;\n+            if (onDeleted) {\n+              onDeleted((deletedFiber.stateNode: SuspenseInstance));\n+            }\n+          } catch (error) {\n+            captureCommitPhaseError(\n+              deletedFiber,\n+              nearestMountedAncestor,\n+              error,\n+            );\n           }\n         }\n       }\n@@ -1315,7 +1310,13 @@ function commitDeletionEffectsOnFiber(\n         hostParent = prevHostParent;\n         hostParentIsContainer = prevHostParentIsContainer;\n       } else {\n-        emptyPortalContainer(deletedFiber);\n+        if (supportsPersistence) {\n+          commitHostPortalContainerChildren(\n+            deletedFiber.stateNode,\n+            deletedFiber,\n+            createContainerChildSet(),\n+          );\n+        }\n \n         recursivelyTraverseDeletionEffects(\n           finishedRoot,\n@@ -2006,6 +2007,7 @@ function commitMutationEffectsOnFiber(\n           commitHostPortalContainerChildren(\n             finishedWork.stateNode,\n             finishedWork,\n+            finishedWork.stateNode.pendingChildren,\n           );\n         }\n       }"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitHostEffects.js",
                "git_diff": "@@ -47,6 +47,8 @@ import {\n   commitHydratedSuspenseInstance,\n   removeChildFromContainer,\n   removeChild,\n+  clearSingleton,\n+  acquireSingletonInstance,\n } from './ReactFiberConfig';\n import {captureCommitPhaseError} from './ReactFiberWorkLoop';\n \n@@ -413,3 +415,16 @@ export function commitHostHydratedSuspense(\n     captureCommitPhaseError(finishedWork, finishedWork.return, error);\n   }\n }\n+\n+export function commitHostSingleton(finishedWork: Fiber) {\n+  const singleton = finishedWork.stateNode;\n+  const props = finishedWork.memoizedProps;\n+\n+  try {\n+    // This was a new mount, we need to clear and set initial properties\n+    clearSingleton(singleton);\n+    acquireSingletonInstance(finishedWork.type, props, singleton, finishedWork);\n+  } catch (error) {\n+    captureCommitPhaseError(finishedWork, finishedWork.return, error);\n+  }\n+}"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -121,8 +121,6 @@ import {\n   prepareForCommit,\n   beforeActiveInstanceBlur,\n   detachDeletedInstance,\n-  clearSingleton,\n-  acquireSingletonInstance,\n   releaseSingletonInstance,\n   getHoistableRoot,\n   acquireResource,\n@@ -210,6 +208,7 @@ import {\n   commitHostHydratedSuspense,\n   commitHostRemoveChildFromContainer,\n   commitHostRemoveChild,\n+  commitHostSingleton,\n } from './ReactFiberCommitHostEffects';\n \n // Used during the commit phase to track the state of the Offscreen component stack.\n@@ -1852,16 +1851,7 @@ function commitMutationEffectsOnFiber(\n         if (flags & Update) {\n           const previousWork = finishedWork.alternate;\n           if (previousWork === null) {\n-            const singleton = finishedWork.stateNode;\n-            const props = finishedWork.memoizedProps;\n-            // This was a new mount, we need to clear and set initial properties\n-            clearSingleton(singleton);\n-            acquireSingletonInstance(\n-              finishedWork.type,\n-              props,\n-              singleton,\n-              finishedWork,\n-            );\n+            commitHostSingleton(finishedWork);\n           }\n         }\n       }"
            }
        ]
    },
    {
        "prompt": "issue: Fix useMemoCache with setState in render | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\r\n* __->__ #30889\r\n\r\nFixes the bug that @alexmckenley and @mofeiZ found where setState-in-render can reset useMemoCache and cause an infinite loop. The bug was that renderWithHooksAgain() was not resetting hook state when rerendering (so useMemo values were preserved) but was resetting the updateQueue. This meant that the entire memo cache was cleared on a setState-in-render.\r\n\r\nI initially changed renderWithHooksAgain() to just reset the updateQueue, nulling out properties and setting the memoCache.index back to 0, but not clearing memoCache.data. That fixed the uMC bug, but caused some tests to fail where effect cleanup wasn\u2019t running when a component was in a tree that suspended and showed a fallback.\r\n\r\nTurns out renderWithHooksAgain() is also used to re-render suspended components, and that case depends on the updateQueue being cleared for effects to work correctly. So i updated to clear the updateQueue for the suspense case, reset in the setState-in-render case, and everything works. The result feels pretty clean.\r\n\r\nIn a follow-up we should be able to avoid resetting the memo cache in the replay case as well. There are a few spots in the codebase where we check for `updateQueue === null`, and only do processing in that case \u2014 including some code related to effect cleanup. I think the right thing to do there would be to check for e.g. `updateQueue?.lastEffect == null` (and any other relevant properties from updateQueue), and then it would be safe to always reset the updateQueue instead of clearing it.",
        "completion": [
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -828,7 +828,9 @@ function renderWithHooksAgain<Props, SecondArg>(\n     currentHook = null;\n     workInProgressHook = null;\n \n-    workInProgress.updateQueue = null;\n+    if (workInProgress.updateQueue != null) {\n+      clearFunctionComponentUpdateQueue(workInProgress.updateQueue);\n+    }\n \n     if (__DEV__) {\n       // Also validate hook order for cascading updates.\n@@ -1101,6 +1103,20 @@ if (enableUseMemoCacheHook) {\n   };\n }\n \n+// NOTE: this function intentionally does not reset memoCache. We reuse updateQueue for the memo\n+// cache to avoid increasing the size of fibers that don't need a cache, but we don't want to reset\n+// the cache when other properties are reset.\n+const clearFunctionComponentUpdateQueue = (\n+  updateQueue: FunctionComponentUpdateQueue,\n+) => {\n+  updateQueue.lastEffect = null;\n+  updateQueue.events = null;\n+  updateQueue.stores = null;\n+  if (updateQueue.memoCache != null) {\n+    updateQueue.memoCache.index = 0;\n+  }\n+};\n+\n function useThenable<T>(thenable: Thenable<T>): T {\n   // Track the position of the thenable within this fiber.\n   const index = thenableIndexCounter;"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/useMemoCache-test.js",
                "git_diff": "@@ -667,7 +667,7 @@ describe('useMemoCache()', () => {\n     }\n \n     // Baseline / source code\n-    function useUserMemo(value) {\n+    function useManualMemo(value) {\n       return useMemo(() => [value], [value]);\n     }\n \n@@ -683,24 +683,22 @@ describe('useMemoCache()', () => {\n     }\n \n     /**\n-     * Test case: note that the initial render never completes\n+     * Test with useMemoCache\n      */\n     let root = ReactNoop.createRoot();\n-    const IncorrectInfiniteComponent = makeComponent(useCompilerMemo);\n-    root.render(<IncorrectInfiniteComponent value={2} />);\n-    await waitForThrow(\n-      'Too many re-renders. React limits the number of renders to prevent ' +\n-        'an infinite loop.',\n-    );\n+    const CompilerMemoComponent = makeComponent(useCompilerMemo);\n+    await act(() => {\n+      root.render(<CompilerMemoComponent value={2} />);\n+    });\n+    expect(root).toMatchRenderedOutput(<div>2</div>);\n \n     /**\n-     * Baseline test: initial render is expected to complete after a retry\n-     * (triggered by the setState)\n+     * Test with useMemo\n      */\n     root = ReactNoop.createRoot();\n-    const CorrectComponent = makeComponent(useUserMemo);\n+    const HookMemoComponent = makeComponent(useManualMemo);\n     await act(() => {\n-      root.render(<CorrectComponent value={2} />);\n+      root.render(<HookMemoComponent value={2} />);\n     });\n     expect(root).toMatchRenderedOutput(<div>2</div>);\n   });"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -1103,7 +1103,7 @@ if (enableUseMemoCacheHook) {\n   };\n }\n \n-// NOTE: this function intentionally does not reset memoCache. We reuse updateQueue for the memo\n+// NOTE: this function intentionally does not reset memoCache data. We reuse updateQueue for the memo\n // cache to avoid increasing the size of fibers that don't need a cache, but we don't want to reset\n // the cache when other properties are reset.\n const clearFunctionComponentUpdateQueue = (\n@@ -1112,8 +1112,10 @@ const clearFunctionComponentUpdateQueue = (\n   updateQueue.lastEffect = null;\n   updateQueue.events = null;\n   updateQueue.stores = null;\n-  if (updateQueue.memoCache != null) {\n-    updateQueue.memoCache.index = 0;\n+  if (enableUseMemoCacheHook) {\n+    if (updateQueue.memoCache != null) {\n+      updateQueue.memoCache.index = 0;\n+    }\n   }\n };\n "
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -829,7 +829,7 @@ function renderWithHooksAgain<Props, SecondArg>(\n     workInProgressHook = null;\n \n     if (workInProgress.updateQueue != null) {\n-      clearFunctionComponentUpdateQueue(workInProgress.updateQueue);\n+      resetFunctionComponentUpdateQueue(workInProgress.updateQueue);\n     }\n \n     if (__DEV__) {\n@@ -1103,17 +1103,17 @@ if (enableUseMemoCacheHook) {\n   };\n }\n \n-// NOTE: this function intentionally does not reset memoCache data. We reuse updateQueue for the memo\n-// cache to avoid increasing the size of fibers that don't need a cache, but we don't want to reset\n-// the cache when other properties are reset.\n-const clearFunctionComponentUpdateQueue = (\n+const resetFunctionComponentUpdateQueue = (\n   updateQueue: FunctionComponentUpdateQueue,\n ) => {\n   updateQueue.lastEffect = null;\n   updateQueue.events = null;\n   updateQueue.stores = null;\n   if (enableUseMemoCacheHook) {\n     if (updateQueue.memoCache != null) {\n+      // NOTE: this function intentionally does not reset memoCache data. We reuse updateQueue for the memo\n+      // cache to avoid increasing the size of fibers that don't need a cache, but we don't want to reset\n+      // the cache when other properties are reset.\n       updateQueue.memoCache.index = 0;\n     }\n   }"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -1103,9 +1103,9 @@ if (enableUseMemoCacheHook) {\n   };\n }\n \n-const resetFunctionComponentUpdateQueue = (\n+function resetFunctionComponentUpdateQueue(\n   updateQueue: FunctionComponentUpdateQueue,\n-) => {\n+): void {\n   updateQueue.lastEffect = null;\n   updateQueue.events = null;\n   updateQueue.stores = null;\n@@ -1117,7 +1117,7 @@ const resetFunctionComponentUpdateQueue = (\n       updateQueue.memoCache.index = 0;\n     }\n   }\n-};\n+}\n \n function useThenable<T>(thenable: Thenable<T>): T {\n   // Track the position of the thenable within this fiber."
            },
            {
                "file": "packages/react-reconciler/src/__tests__/useMemoCache-test.js",
                "git_diff": "@@ -16,7 +16,6 @@ let assertLog;\n let useMemo;\n let useState;\n let useMemoCache;\n-let waitForThrow;\n let MemoCacheSentinel;\n let ErrorBoundary;\n \n@@ -32,7 +31,6 @@ describe('useMemoCache()', () => {\n     useMemo = React.useMemo;\n     useMemoCache = require('react/compiler-runtime').c;\n     useState = React.useState;\n-    waitForThrow = require('internal-test-utils').waitForThrow;\n     MemoCacheSentinel = Symbol.for('react.memo_cache_sentinel');\n \n     class _ErrorBoundary extends React.Component {"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/useMemoCache-test.js",
                "git_diff": "@@ -628,18 +628,9 @@ describe('useMemoCache()', () => {\n \n     // Finish loading the data.\n     await act(() => updatedChunkB.resolve('B2'));\n-    if (gate(flags => flags.enableNoCloningMemoCache)) {\n-      // We did not have process the first chunk again. We reused the\n-      // computation from the earlier attempt.\n-      assertLog([]);\n-    } else {\n-      // Because we clone/reset the memo cache after every aborted attempt, we\n-      // must process the first chunk again.\n-      //\n-      // That's three total times we've processed the first chunk, compared to\n-      // just once when enableNoCloningMemoCache is on.\n-      assertLog(['Some expensive processing... [A2]']);\n-    }\n+    // We did not have process the first chunk again. We reused the\n+    // computation from the earlier attempt.\n+    assertLog([]);\n     expect(root).toMatchRenderedOutput(\n       <>\n         <div>Input: hi!</div>"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -522,7 +522,9 @@ export function renderWithHooks<Props, SecondArg>(\n   }\n \n   workInProgress.memoizedState = null;\n-  workInProgress.updateQueue = null;\n+  if (workInProgress.updateQueue != null) {\n+    resetFunctionComponentUpdateQueue(workInProgress.updateQueue);\n+  }\n   workInProgress.lanes = NoLanes;\n \n   // The following should have already been reset"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/useMemoCache-test.js",
                "git_diff": "@@ -575,11 +575,7 @@ describe('useMemoCache()', () => {\n       'Some expensive processing... [A2]',\n       'Suspend! [chunkB]',\n \n-      ...(gate('enableSiblingPrerendering')\n-        ? gate('enableNoCloningMemoCache')\n-          ? ['Suspend! [chunkB]']\n-          : ['Some expensive processing... [A2]', 'Suspend! [chunkB]']\n-        : []),\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [chunkB]'] : []),\n     ]);\n \n     // The second chunk hasn't loaded yet, so we're still showing the\n@@ -598,26 +594,13 @@ describe('useMemoCache()', () => {\n     await act(() => setInput('hi!'));\n \n     // Once the input has updated, we go back to rendering the transition.\n-    if (gate(flags => flags.enableNoCloningMemoCache)) {\n-      // We did not have process the first chunk again. We reused the\n-      // computation from the earlier attempt.\n-      assertLog([\n-        'Suspend! [chunkB]',\n-\n-        ...(gate('enableSiblingPrerendering') ? ['Suspend! [chunkB]'] : []),\n-      ]);\n-    } else {\n-      // Because we clone/reset the memo cache after every aborted attempt, we\n-      // must process the first chunk again.\n-      assertLog([\n-        'Some expensive processing... [A2]',\n-        'Suspend! [chunkB]',\n-\n-        ...(gate('enableSiblingPrerendering')\n-          ? ['Some expensive processing... [A2]', 'Suspend! [chunkB]']\n-          : []),\n-      ]);\n-    }\n+    // We did not have process the first chunk again. We reused the\n+    // computation from the earlier attempt.\n+    assertLog([\n+      'Suspend! [chunkB]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [chunkB]'] : []),\n+    ]);\n \n     expect(root).toMatchRenderedOutput(\n       <>"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -522,9 +522,7 @@ export function renderWithHooks<Props, SecondArg>(\n   }\n \n   workInProgress.memoizedState = null;\n-  if (workInProgress.updateQueue != null) {\n-    resetFunctionComponentUpdateQueue(workInProgress.updateQueue);\n-  }\n+  workInProgress.updateQueue = null;\n   workInProgress.lanes = NoLanes;\n \n   // The following should have already been reset\n@@ -772,6 +770,7 @@ export function replaySuspendedComponentWithHooks<Props, SecondArg>(\n     ignorePreviousDependencies =\n       current !== null && current.type !== workInProgress.type;\n   }\n+  workInProgress.updateQueue = null;\n   const children = renderWithHooksAgain(\n     workInProgress,\n     Component,\n@@ -2516,17 +2515,15 @@ function pushEffect(\n   if (componentUpdateQueue === null) {\n     componentUpdateQueue = createFunctionComponentUpdateQueue();\n     currentlyRenderingFiber.updateQueue = (componentUpdateQueue: any);\n+  }\n+  const lastEffect = componentUpdateQueue.lastEffect;\n+  if (lastEffect === null) {\n     componentUpdateQueue.lastEffect = effect.next = effect;\n   } else {\n-    const lastEffect = componentUpdateQueue.lastEffect;\n-    if (lastEffect === null) {\n-      componentUpdateQueue.lastEffect = effect.next = effect;\n-    } else {\n-      const firstEffect = lastEffect.next;\n-      lastEffect.next = effect;\n-      effect.next = firstEffect;\n-      componentUpdateQueue.lastEffect = effect;\n-    }\n+    const firstEffect = lastEffect.next;\n+    lastEffect.next = effect;\n+    effect.next = firstEffect;\n+    componentUpdateQueue.lastEffect = effect;\n   }\n   return effect;\n }"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/useMemoCache-test.js",
                "git_diff": "@@ -575,7 +575,11 @@ describe('useMemoCache()', () => {\n       'Some expensive processing... [A2]',\n       'Suspend! [chunkB]',\n \n-      ...(gate('enableSiblingPrerendering') ? ['Suspend! [chunkB]'] : []),\n+      ...(gate('enableSiblingPrerendering')\n+        ? gate('enableNoCloningMemoCache')\n+          ? ['Suspend! [chunkB]']\n+          : ['Some expensive processing... [A2]', 'Suspend! [chunkB]']\n+        : []),\n     ]);\n \n     // The second chunk hasn't loaded yet, so we're still showing the\n@@ -596,11 +600,26 @@ describe('useMemoCache()', () => {\n     // Once the input has updated, we go back to rendering the transition.\n     // We did not have process the first chunk again. We reused the\n     // computation from the earlier attempt.\n-    assertLog([\n-      'Suspend! [chunkB]',\n-\n-      ...(gate('enableSiblingPrerendering') ? ['Suspend! [chunkB]'] : []),\n-    ]);\n+    if (gate(flags => flags.enableNoCloningMemoCache)) {\n+      // We did not have process the first chunk again. We reused the\n+      // computation from the earlier attempt.\n+      assertLog([\n+        'Suspend! [chunkB]',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend! [chunkB]'] : []),\n+      ]);\n+    } else {\n+      // Because we clone/reset the memo cache after every aborted attempt, we\n+      // must process the first chunk again.\n+      assertLog([\n+        'Some expensive processing... [A2]',\n+        'Suspend! [chunkB]',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Some expensive processing... [A2]', 'Suspend! [chunkB]']\n+          : []),\n+      ]);\n+    }\n \n     expect(root).toMatchRenderedOutput(\n       <>\n@@ -613,7 +632,18 @@ describe('useMemoCache()', () => {\n     await act(() => updatedChunkB.resolve('B2'));\n     // We did not have process the first chunk again. We reused the\n     // computation from the earlier attempt.\n-    assertLog([]);\n+    if (gate(flags => flags.enableNoCloningMemoCache)) {\n+      // We did not have process the first chunk again. We reused the\n+      // computation from the earlier attempt.\n+      assertLog([]);\n+    } else {\n+      // Because we clone/reset the memo cache after every aborted attempt, we\n+      // must process the first chunk again.\n+      //\n+      // That's three total times we've processed the first chunk, compared to\n+      // just once when enableNoCloningMemoCache is on.\n+      assertLog(['Some expensive processing... [A2]']);\n+    }\n     expect(root).toMatchRenderedOutput(\n       <>\n         <div>Input: hi!</div>"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -770,6 +770,11 @@ export function replaySuspendedComponentWithHooks<Props, SecondArg>(\n     ignorePreviousDependencies =\n       current !== null && current.type !== workInProgress.type;\n   }\n+  // renderWithHooks only resets the updateQueue but does not clear it, since\n+  // it needs to work for both this case (suspense replay) as well as for double\n+  // renders in dev and setState-in-render. However, for the suspense replay case\n+  // we need to reset the updateQueue to correctly handle unmount effects, so we\n+  // clear the queue here\n   workInProgress.updateQueue = null;\n   const children = renderWithHooksAgain(\n     workInProgress,"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/useMemoCache-test.js",
                "git_diff": "@@ -598,8 +598,6 @@ describe('useMemoCache()', () => {\n     await act(() => setInput('hi!'));\n \n     // Once the input has updated, we go back to rendering the transition.\n-    // We did not have process the first chunk again. We reused the\n-    // computation from the earlier attempt.\n     if (gate(flags => flags.enableNoCloningMemoCache)) {\n       // We did not have process the first chunk again. We reused the\n       // computation from the earlier attempt.\n@@ -630,8 +628,6 @@ describe('useMemoCache()', () => {\n \n     // Finish loading the data.\n     await act(() => updatedChunkB.resolve('B2'));\n-    // We did not have process the first chunk again. We reused the\n-    // computation from the earlier attempt.\n     if (gate(flags => flags.enableNoCloningMemoCache)) {\n       // We did not have process the first chunk again. We reused the\n       // computation from the earlier attempt."
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -835,7 +835,7 @@ function renderWithHooksAgain<Props, SecondArg>(\n     workInProgressHook = null;\n \n     if (workInProgress.updateQueue != null) {\n-      resetFunctionComponentUpdateQueue(workInProgress.updateQueue);\n+      resetFunctionComponentUpdateQueue((workInProgress.updateQueue: any));\n     }\n \n     if (__DEV__) {"
            }
        ]
    },
    {
        "prompt": "issue: [compiler] Type inference for tagged template literals | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* #30868\n* __->__ #30869\n\nAt Meta we have a pattern of using tagged template literals for features that are compiled away:\n\n```\n// Relay:\ngraphql`...graphql text...`\n```\n\nIn many cases these tags produce a primitive value, and we can get even more optimal output if we can tell the compiler about these types. The new moduleTypeProvider gives us the ability to declare such types, this PR extends the compiler to use this type information for TaggedTemplateExpression values.",
        "completion": [
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Inference/InferReferenceEffects.ts",
                "git_diff": "@@ -1180,18 +1180,6 @@ function inferBlock(\n         };\n         break;\n       }\n-      case 'TaggedTemplateExpression': {\n-        valueKind = {\n-          kind: ValueKind.Mutable,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n-        };\n-        effect = {\n-          kind: Effect.ConditionallyMutate,\n-          reason: ValueReason.Other,\n-        };\n-        break;\n-      }\n       case 'TemplateLiteral': {\n         /*\n          * template literal (with no tag function) always produces\n@@ -1312,6 +1300,47 @@ function inferBlock(\n         instr.lvalue.effect = Effect.Store;\n         continue;\n       }\n+      case 'TaggedTemplateExpression': {\n+        const operands = [...eachInstructionValueOperand(instrValue)];\n+        if (operands.length !== 1) {\n+          // future-proofing to make sure we update this case when we support interpolation\n+          CompilerError.throwTodo({\n+            reason: 'Support tagged template expressions with interpolations',\n+            loc: instrValue.loc,\n+          });\n+        }\n+        const signature = getFunctionCallSignature(\n+          env,\n+          instrValue.tag.identifier.type,\n+        );\n+        let calleeEffect =\n+          signature?.calleeEffect ?? Effect.ConditionallyMutate;\n+        const returnValueKind: AbstractValue =\n+          signature !== null\n+            ? {\n+                kind: signature.returnValueKind,\n+                reason: new Set([\n+                  signature.returnValueReason ??\n+                    ValueReason.KnownReturnSignature,\n+                ]),\n+                context: new Set(),\n+              }\n+            : {\n+                kind: ValueKind.Mutable,\n+                reason: new Set([ValueReason.Other]),\n+                context: new Set(),\n+              };\n+        state.referenceAndRecordEffects(\n+          instrValue.tag,\n+          calleeEffect,\n+          ValueReason.Other,\n+          functionEffects,\n+        );\n+        state.initialize(instrValue, returnValueKind);\n+        state.define(instr.lvalue, instrValue);\n+        instr.lvalue.effect = Effect.ConditionallyMutate;\n+        continue;\n+      }\n       case 'CallExpression': {\n         const signature = getFunctionCallSignature(\n           env,"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/InferReactiveScopeVariables.ts",
                "git_diff": "@@ -227,6 +227,7 @@ function mayAllocate(env: Environment, instruction: Instruction): boolean {\n     case 'StoreGlobal': {\n       return false;\n     }\n+    case 'TaggedTemplateExpression':\n     case 'CallExpression':\n     case 'MethodCall': {\n       return instruction.lvalue.identifier.type.kind !== 'Primitive';\n@@ -241,8 +242,7 @@ function mayAllocate(env: Environment, instruction: Instruction): boolean {\n     case 'ObjectExpression':\n     case 'UnsupportedNode':\n     case 'ObjectMethod':\n-    case 'FunctionExpression':\n-    case 'TaggedTemplateExpression': {\n+    case 'FunctionExpression': {\n       return true;\n     }\n     default: {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/PruneNonEscapingScopes.ts",
                "git_diff": "@@ -671,12 +671,37 @@ function computeMemoizationInputs(\n         ],\n       };\n     }\n+    case 'TaggedTemplateExpression': {\n+      const signature = getFunctionCallSignature(\n+        env,\n+        value.tag.identifier.type,\n+      );\n+      let lvalues = [];\n+      if (lvalue !== null) {\n+        lvalues.push({place: lvalue, level: MemoizationLevel.Memoized});\n+      }\n+      if (signature?.noAlias === true) {\n+        return {\n+          lvalues,\n+          rvalues: [],\n+        };\n+      }\n+      const operands = [...eachReactiveValueOperand(value)];\n+      lvalues.push(\n+        ...operands\n+          .filter(operand => isMutableEffect(operand.effect, operand.loc))\n+          .map(place => ({place, level: MemoizationLevel.Memoized})),\n+      );\n+      return {\n+        lvalues,\n+        rvalues: operands,\n+      };\n+    }\n     case 'CallExpression': {\n       const signature = getFunctionCallSignature(\n         env,\n         value.callee.identifier.type,\n       );\n-      const operands = [...eachReactiveValueOperand(value)];\n       let lvalues = [];\n       if (lvalue !== null) {\n         lvalues.push({place: lvalue, level: MemoizationLevel.Memoized});\n@@ -687,6 +712,7 @@ function computeMemoizationInputs(\n           rvalues: [],\n         };\n       }\n+      const operands = [...eachReactiveValueOperand(value)];\n       lvalues.push(\n         ...operands\n           .filter(operand => isMutableEffect(operand.effect, operand.loc))\n@@ -702,7 +728,6 @@ function computeMemoizationInputs(\n         env,\n         value.property.identifier.type,\n       );\n-      const operands = [...eachReactiveValueOperand(value)];\n       let lvalues = [];\n       if (lvalue !== null) {\n         lvalues.push({place: lvalue, level: MemoizationLevel.Memoized});\n@@ -713,6 +738,7 @@ function computeMemoizationInputs(\n           rvalues: [],\n         };\n       }\n+      const operands = [...eachReactiveValueOperand(value)];\n       lvalues.push(\n         ...operands\n           .filter(operand => isMutableEffect(operand.effect, operand.loc))\n@@ -726,7 +752,6 @@ function computeMemoizationInputs(\n     case 'RegExpLiteral':\n     case 'ObjectMethod':\n     case 'FunctionExpression':\n-    case 'TaggedTemplateExpression':\n     case 'ArrayExpression':\n     case 'NewExpression':\n     case 'ObjectExpression':"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/TypeInference/InferTypes.ts",
                "git_diff": "@@ -250,6 +250,7 @@ function* generateInstructionTypes(\n     }\n \n     case 'CallExpression': {\n+      const returnType = makeType();\n       /*\n        * TODO: callee could be a hook or a function, so this type equation isn't correct.\n        * We should change Hook to a subtype of Function or change unifier logic.\n@@ -258,8 +259,25 @@ function* generateInstructionTypes(\n       yield equation(value.callee.identifier.type, {\n         kind: 'Function',\n         shapeId: null,\n-        return: left,\n+        return: returnType,\n       });\n+      yield equation(left, returnType);\n+      break;\n+    }\n+\n+    case 'TaggedTemplateExpression': {\n+      const returnType = makeType();\n+      /*\n+       * TODO: callee could be a hook or a function, so this type equation isn't correct.\n+       * We should change Hook to a subtype of Function or change unifier logic.\n+       * (see https://github.com/facebook/react-forget/pull/1427)\n+       */\n+      yield equation(value.tag.identifier.type, {\n+        kind: 'Function',\n+        shapeId: null,\n+        return: returnType,\n+      });\n+      yield equation(left, returnType);\n       break;\n     }\n \n@@ -392,7 +410,6 @@ function* generateInstructionTypes(\n     case 'MetaProperty':\n     case 'ComputedStore':\n     case 'ComputedLoad':\n-    case 'TaggedTemplateExpression':\n     case 'Await':\n     case 'GetIterator':\n     case 'IteratorNext':"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateLocalsNotReassignedAfterRender.ts",
                "git_diff": "@@ -161,6 +161,14 @@ function getContextReassignment(\n             if (signature?.noAlias) {\n               operands = [value.receiver, value.property];\n             }\n+          } else if (value.kind === 'TaggedTemplateExpression') {\n+            const signature = getFunctionCallSignature(\n+              fn.env,\n+              value.tag.identifier.type,\n+            );\n+            if (signature?.noAlias) {\n+              operands = [value.tag];\n+            }\n           }\n           for (const operand of operands) {\n             CompilerError.invariant(operand.effect !== Effect.Unknown, {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/destructuring-mixed-scope-and-local-variables-with-default.expect.md",
                "git_diff": "@@ -63,67 +63,63 @@ function useFragment(_arg1, _arg2) {\n }\n \n function Component(props) {\n-  const $ = _c(9);\n-  let t0;\n-  if ($[0] === Symbol.for(\"react.memo_cache_sentinel\")) {\n-    t0 = graphql`\n+  const $ = _c(8);\n+  const post = useFragment(\n+    graphql`\n       fragment F on T {\n         id\n       }\n-    `;\n-    $[0] = t0;\n-  } else {\n-    t0 = $[0];\n-  }\n-  const post = useFragment(t0, props.post);\n-  let t1;\n-  if ($[1] !== post) {\n+    `,\n+    props.post,\n+  );\n+  let t0;\n+  if ($[0] !== post) {\n     const allUrls = [];\n \n-    const { media: t2, comments: t3, urls: t4 } = post;\n-    const media = t2 === undefined ? null : t2;\n+    const { media: t1, comments: t2, urls: t3 } = post;\n+    const media = t1 === undefined ? null : t1;\n+    let t4;\n+    if ($[2] !== t2) {\n+      t4 = t2 === undefined ? [] : t2;\n+      $[2] = t2;\n+      $[3] = t4;\n+    } else {\n+      t4 = $[3];\n+    }\n+    const comments = t4;\n     let t5;\n-    if ($[3] !== t3) {\n+    if ($[4] !== t3) {\n       t5 = t3 === undefined ? [] : t3;\n-      $[3] = t3;\n-      $[4] = t5;\n+      $[4] = t3;\n+      $[5] = t5;\n     } else {\n-      t5 = $[4];\n+      t5 = $[5];\n     }\n-    const comments = t5;\n+    const urls = t5;\n     let t6;\n-    if ($[5] !== t4) {\n-      t6 = t4 === undefined ? [] : t4;\n-      $[5] = t4;\n-      $[6] = t6;\n-    } else {\n-      t6 = $[6];\n-    }\n-    const urls = t6;\n-    let t7;\n-    if ($[7] !== comments.length) {\n-      t7 = (e) => {\n+    if ($[6] !== comments.length) {\n+      t6 = (e) => {\n         if (!comments.length) {\n           return;\n         }\n \n         console.log(comments.length);\n       };\n-      $[7] = comments.length;\n-      $[8] = t7;\n+      $[6] = comments.length;\n+      $[7] = t6;\n     } else {\n-      t7 = $[8];\n+      t6 = $[7];\n     }\n-    const onClick = t7;\n+    const onClick = t6;\n \n     allUrls.push(...urls);\n-    t1 = <Stringify media={media} allUrls={allUrls} onClick={onClick} />;\n-    $[1] = post;\n-    $[2] = t1;\n+    t0 = <Stringify media={media} allUrls={allUrls} onClick={onClick} />;\n+    $[0] = post;\n+    $[1] = t0;\n   } else {\n-    t1 = $[2];\n+    t0 = $[1];\n   }\n-  return t1;\n+  return t0;\n }\n \n export const FIXTURE_ENTRYPOINT = {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-tagged-template-expression.expect.md",
                "git_diff": "@@ -0,0 +1,106 @@\n+\n+## Input\n+\n+```javascript\n+import {graphql} from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const fragment = graphql`\n+    fragment Foo on User {\n+      name\n+    }\n+  `;\n+  return <div>{fragment}</div>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\";\n+import { graphql } from \"shared-runtime\";\n+\n+export function Component(t0) {\n+  const $ = _c(1);\n+  const fragment = graphql`\n+    fragment Foo on User {\n+      name\n+    }\n+  `;\n+  let t1;\n+  if ($[0] === Symbol.for(\"react.memo_cache_sentinel\")) {\n+    t1 = <div>{fragment}</div>;\n+    $[0] = t1;\n+  } else {\n+    t1 = $[0];\n+  }\n+  return t1;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{ a: 0, b: 0 }],\n+  sequentialRenders: [\n+    { a: 0, b: 0 },\n+    { a: 1, b: 0 },\n+    { a: 1, b: 1 },\n+    { a: 1, b: 2 },\n+    { a: 2, b: 2 },\n+    { a: 3, b: 2 },\n+    { a: 0, b: 0 },\n+  ],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) <div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-tagged-template-expression.js",
                "git_diff": "@@ -0,0 +1,24 @@\n+import {graphql} from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const fragment = graphql`\n+    fragment Foo on User {\n+      name\n+    }\n+  `;\n+  return <div>{fragment}</div>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};"
            },
            {
                "file": "compiler/packages/snap/src/sprout/shared-runtime-type-provider.ts",
                "git_diff": "@@ -32,6 +32,14 @@ export function makeSharedRuntimeTypeProvider({\n           returnType: {kind: 'type', name: 'Primitive'},\n           returnValueKind: ValueKindEnum.Primitive,\n         },\n+        graphql: {\n+          kind: 'function',\n+          calleeEffect: EffectEnum.Read,\n+          positionalParams: [],\n+          restParam: EffectEnum.Read,\n+          returnType: {kind: 'type', name: 'Primitive'},\n+          returnValueKind: ValueKindEnum.Primitive,\n+        },\n         typedArrayPush: {\n           kind: 'function',\n           calleeEffect: EffectEnum.Read,"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts",
                "git_diff": "@@ -33,7 +33,6 @@ import {\n   Type,\n   ValidatedIdentifier,\n   ValueKind,\n-  getHookKindForType,\n   makeBlockId,\n   makeIdentifierId,\n   makeIdentifierName,\n@@ -789,9 +788,14 @@ export class Environment {\n           );\n         } else {\n           const moduleType = this.#resolveModuleType(binding.module, loc);\n-          let propertyType: Type | null = null;\n           if (moduleType !== null) {\n-            propertyType = this.getPropertyType(moduleType, binding.imported);\n+            const importedType = this.getPropertyType(\n+              moduleType,\n+              binding.imported,\n+            );\n+            if (importedType != null) {\n+              return importedType;\n+            }\n           }\n \n           /**\n@@ -802,18 +806,9 @@ export class Environment {\n            * `import {useHook as foo} ...`\n            * `import {foo as useHook} ...`\n            */\n-          const expectHook =\n-            isHookName(binding.imported) || isHookName(binding.name);\n-          if (expectHook) {\n-            if (\n-              propertyType &&\n-              getHookKindForType(this, propertyType) !== null\n-            ) {\n-              return propertyType;\n-            }\n-            return this.#getCustomHookType();\n-          }\n-          return propertyType;\n+          return isHookName(binding.imported) || isHookName(binding.name)\n+            ? this.#getCustomHookType()\n+            : null;\n         }\n       }\n       case 'ImportDefault':\n@@ -826,27 +821,17 @@ export class Environment {\n           );\n         } else {\n           const moduleType = this.#resolveModuleType(binding.module, loc);\n-          let importedType: Type | null = null;\n           if (moduleType !== null) {\n             if (binding.kind === 'ImportDefault') {\n               const defaultType = this.getPropertyType(moduleType, 'default');\n               if (defaultType !== null) {\n-                importedType = defaultType;\n+                return defaultType;\n               }\n             } else {\n-              importedType = moduleType;\n-            }\n-          }\n-          if (isHookName(binding.name)) {\n-            if (\n-              importedType !== null &&\n-              getHookKindForType(this, importedType) !== null\n-            ) {\n-              return importedType;\n+              return moduleType;\n             }\n-            return this.#getCustomHookType();\n           }\n-          return importedType;\n+          return isHookName(binding.name) ? this.#getCustomHookType() : null;\n         }\n       }\n     }"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-hooklike-name-not-typed-as-hook-import.expect.md",
                "git_diff": "@@ -1,123 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-import {useMemo} from 'react';\n-import {\n-  useArrayConcatNotTypedAsHook,\n-  ValidateMemoization,\n-} from 'shared-runtime';\n-\n-export function Component({a, b}) {\n-  const item1 = useMemo(() => [a], [a]);\n-  const item2 = useMemo(() => [b], [b]);\n-  const item3 = useArrayConcatNotTypedAsHook(item1, item2);\n-\n-  return (\n-    <>\n-      <ValidateMemoization inputs={[a, b]} output={item3} />\n-    </>\n-  );\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{a: 0, b: 0}],\n-  sequentialRenders: [\n-    {a: 0, b: 0},\n-    {a: 1, b: 0},\n-    {a: 1, b: 1},\n-    {a: 1, b: 2},\n-    {a: 2, b: 2},\n-    {a: 3, b: 2},\n-    {a: 0, b: 0},\n-  ],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\";\n-import { useMemo } from \"react\";\n-import {\n-  useArrayConcatNotTypedAsHook,\n-  ValidateMemoization,\n-} from \"shared-runtime\";\n-\n-export function Component(t0) {\n-  const $ = _c(10);\n-  const { a, b } = t0;\n-  let t1;\n-  let t2;\n-  if ($[0] !== a) {\n-    t2 = [a];\n-    $[0] = a;\n-    $[1] = t2;\n-  } else {\n-    t2 = $[1];\n-  }\n-  t1 = t2;\n-  const item1 = t1;\n-  let t3;\n-  let t4;\n-  if ($[2] !== b) {\n-    t4 = [b];\n-    $[2] = b;\n-    $[3] = t4;\n-  } else {\n-    t4 = $[3];\n-  }\n-  t3 = t4;\n-  const item2 = t3;\n-  const item3 = useArrayConcatNotTypedAsHook(item1, item2);\n-  let t5;\n-  if ($[4] !== a || $[5] !== b) {\n-    t5 = [a, b];\n-    $[4] = a;\n-    $[5] = b;\n-    $[6] = t5;\n-  } else {\n-    t5 = $[6];\n-  }\n-  let t6;\n-  if ($[7] !== t5 || $[8] !== item3) {\n-    t6 = (\n-      <>\n-        <ValidateMemoization inputs={t5} output={item3} />\n-      </>\n-    );\n-    $[7] = t5;\n-    $[8] = item3;\n-    $[9] = t6;\n-  } else {\n-    t6 = $[9];\n-  }\n-  return t6;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{ a: 0, b: 0 }],\n-  sequentialRenders: [\n-    { a: 0, b: 0 },\n-    { a: 1, b: 0 },\n-    { a: 1, b: 1 },\n-    { a: 1, b: 2 },\n-    { a: 2, b: 2 },\n-    { a: 3, b: 2 },\n-    { a: 0, b: 0 },\n-  ],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) <div>{\"inputs\":[0,0],\"output\":[0,0]}</div>\n-<div>{\"inputs\":[1,0],\"output\":[1,0]}</div>\n-<div>{\"inputs\":[1,1],\"output\":[1,1]}</div>\n-<div>{\"inputs\":[1,2],\"output\":[1,2]}</div>\n-<div>{\"inputs\":[2,2],\"output\":[2,2]}</div>\n-<div>{\"inputs\":[3,2],\"output\":[3,2]}</div>\n-<div>{\"inputs\":[0,0],\"output\":[0,0]}</div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-hooklike-name-not-typed-as-hook-import.tsx",
                "git_diff": "@@ -1,31 +0,0 @@\n-import {useMemo} from 'react';\n-import {\n-  useArrayConcatNotTypedAsHook,\n-  ValidateMemoization,\n-} from 'shared-runtime';\n-\n-export function Component({a, b}) {\n-  const item1 = useMemo(() => [a], [a]);\n-  const item2 = useMemo(() => [b], [b]);\n-  const item3 = useArrayConcatNotTypedAsHook(item1, item2);\n-\n-  return (\n-    <>\n-      <ValidateMemoization inputs={[a, b]} output={item3} />\n-    </>\n-  );\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{a: 0, b: 0}],\n-  sequentialRenders: [\n-    {a: 0, b: 0},\n-    {a: 1, b: 0},\n-    {a: 1, b: 1},\n-    {a: 1, b: 2},\n-    {a: 2, b: 2},\n-    {a: 3, b: 2},\n-    {a: 0, b: 0},\n-  ],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-import-object-typed-module-as-hook-name.expect.md",
                "git_diff": "@@ -1,145 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-import {useMemo} from 'react';\n-import useHook from 'shared-runtime';\n-\n-export function Component({a, b}) {\n-  const item1 = useMemo(() => ({a}), [a]);\n-  const item2 = useMemo(() => ({b}), [b]);\n-  useHook(item1, item2);\n-\n-  return (\n-    <>\n-      <ValidateMemoization inputs={[a]} output={item1} />\n-      <ValidateMemoization inputs={[b]} output={item2} />\n-    </>\n-  );\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{a: 0, b: 0}],\n-  sequentialRenders: [\n-    {a: 0, b: 0},\n-    {a: 1, b: 0},\n-    {a: 1, b: 1},\n-    {a: 1, b: 2},\n-    {a: 2, b: 2},\n-    {a: 3, b: 2},\n-    {a: 0, b: 0},\n-  ],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\";\n-import { useMemo } from \"react\";\n-import useHook from \"shared-runtime\";\n-\n-export function Component(t0) {\n-  const $ = _c(17);\n-  const { a, b } = t0;\n-  let t1;\n-  let t2;\n-  if ($[0] !== a) {\n-    t2 = { a };\n-    $[0] = a;\n-    $[1] = t2;\n-  } else {\n-    t2 = $[1];\n-  }\n-  t1 = t2;\n-  const item1 = t1;\n-  let t3;\n-  let t4;\n-  if ($[2] !== b) {\n-    t4 = { b };\n-    $[2] = b;\n-    $[3] = t4;\n-  } else {\n-    t4 = $[3];\n-  }\n-  t3 = t4;\n-  const item2 = t3;\n-  useHook(item1, item2);\n-  let t5;\n-  if ($[4] !== a) {\n-    t5 = [a];\n-    $[4] = a;\n-    $[5] = t5;\n-  } else {\n-    t5 = $[5];\n-  }\n-  let t6;\n-  if ($[6] !== t5 || $[7] !== item1) {\n-    t6 = <ValidateMemoization inputs={t5} output={item1} />;\n-    $[6] = t5;\n-    $[7] = item1;\n-    $[8] = t6;\n-  } else {\n-    t6 = $[8];\n-  }\n-  let t7;\n-  if ($[9] !== b) {\n-    t7 = [b];\n-    $[9] = b;\n-    $[10] = t7;\n-  } else {\n-    t7 = $[10];\n-  }\n-  let t8;\n-  if ($[11] !== t7 || $[12] !== item2) {\n-    t8 = <ValidateMemoization inputs={t7} output={item2} />;\n-    $[11] = t7;\n-    $[12] = item2;\n-    $[13] = t8;\n-  } else {\n-    t8 = $[13];\n-  }\n-  let t9;\n-  if ($[14] !== t6 || $[15] !== t8) {\n-    t9 = (\n-      <>\n-        {t6}\n-        {t8}\n-      </>\n-    );\n-    $[14] = t6;\n-    $[15] = t8;\n-    $[16] = t9;\n-  } else {\n-    t9 = $[16];\n-  }\n-  return t9;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{ a: 0, b: 0 }],\n-  sequentialRenders: [\n-    { a: 0, b: 0 },\n-    { a: 1, b: 0 },\n-    { a: 1, b: 1 },\n-    { a: 1, b: 2 },\n-    { a: 2, b: 2 },\n-    { a: 3, b: 2 },\n-    { a: 0, b: 0 },\n-  ],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) [[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n-[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n-[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n-[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n-[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n-[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n-[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n-logs: [{ a: 0 },{ b: 0 },{ a: 0 },{ b: 0 },{ a: 1 },{ b: 1 },{ a: 1 },{ b: 2 },{ a: 2 },{ b: 2 },{ a: 3 },{ b: 2 },{ a: 0 },{ b: 0 }]\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-import-object-typed-module-as-hook-name.js",
                "git_diff": "@@ -1,29 +0,0 @@\n-import {useMemo} from 'react';\n-import useHook from 'shared-runtime';\n-\n-export function Component({a, b}) {\n-  const item1 = useMemo(() => ({a}), [a]);\n-  const item2 = useMemo(() => ({b}), [b]);\n-  useHook(item1, item2);\n-\n-  return (\n-    <>\n-      <ValidateMemoization inputs={[a]} output={item1} />\n-      <ValidateMemoization inputs={[b]} output={item2} />\n-    </>\n-  );\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{a: 0, b: 0}],\n-  sequentialRenders: [\n-    {a: 0, b: 0},\n-    {a: 1, b: 0},\n-    {a: 1, b: 1},\n-    {a: 1, b: 2},\n-    {a: 2, b: 2},\n-    {a: 3, b: 2},\n-    {a: 0, b: 0},\n-  ],\n-};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-unknown-import-from-typed-module.expect.md",
                "git_diff": "@@ -1,144 +0,0 @@\n-\n-## Input\n-\n-```javascript\n-import {useMemo} from 'react';\n-import {useHook, ValidateMemoization} from 'shared-runtime';\n-\n-export function Component({a, b}) {\n-  const item1 = useMemo(() => ({a}), [a]);\n-  const item2 = useMemo(() => ({b}), [b]);\n-  useHook(item1, item2);\n-\n-  return (\n-    <>\n-      <ValidateMemoization inputs={[a]} output={item1} />\n-      <ValidateMemoization inputs={[b]} output={item2} />\n-    </>\n-  );\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{a: 0, b: 0}],\n-  sequentialRenders: [\n-    {a: 0, b: 0},\n-    {a: 1, b: 0},\n-    {a: 1, b: 1},\n-    {a: 1, b: 2},\n-    {a: 2, b: 2},\n-    {a: 3, b: 2},\n-    {a: 0, b: 0},\n-  ],\n-};\n-\n-```\n-\n-## Code\n-\n-```javascript\n-import { c as _c } from \"react/compiler-runtime\";\n-import { useMemo } from \"react\";\n-import { useHook, ValidateMemoization } from \"shared-runtime\";\n-\n-export function Component(t0) {\n-  const $ = _c(17);\n-  const { a, b } = t0;\n-  let t1;\n-  let t2;\n-  if ($[0] !== a) {\n-    t2 = { a };\n-    $[0] = a;\n-    $[1] = t2;\n-  } else {\n-    t2 = $[1];\n-  }\n-  t1 = t2;\n-  const item1 = t1;\n-  let t3;\n-  let t4;\n-  if ($[2] !== b) {\n-    t4 = { b };\n-    $[2] = b;\n-    $[3] = t4;\n-  } else {\n-    t4 = $[3];\n-  }\n-  t3 = t4;\n-  const item2 = t3;\n-  useHook(item1, item2);\n-  let t5;\n-  if ($[4] !== a) {\n-    t5 = [a];\n-    $[4] = a;\n-    $[5] = t5;\n-  } else {\n-    t5 = $[5];\n-  }\n-  let t6;\n-  if ($[6] !== t5 || $[7] !== item1) {\n-    t6 = <ValidateMemoization inputs={t5} output={item1} />;\n-    $[6] = t5;\n-    $[7] = item1;\n-    $[8] = t6;\n-  } else {\n-    t6 = $[8];\n-  }\n-  let t7;\n-  if ($[9] !== b) {\n-    t7 = [b];\n-    $[9] = b;\n-    $[10] = t7;\n-  } else {\n-    t7 = $[10];\n-  }\n-  let t8;\n-  if ($[11] !== t7 || $[12] !== item2) {\n-    t8 = <ValidateMemoization inputs={t7} output={item2} />;\n-    $[11] = t7;\n-    $[12] = item2;\n-    $[13] = t8;\n-  } else {\n-    t8 = $[13];\n-  }\n-  let t9;\n-  if ($[14] !== t6 || $[15] !== t8) {\n-    t9 = (\n-      <>\n-        {t6}\n-        {t8}\n-      </>\n-    );\n-    $[14] = t6;\n-    $[15] = t8;\n-    $[16] = t9;\n-  } else {\n-    t9 = $[16];\n-  }\n-  return t9;\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{ a: 0, b: 0 }],\n-  sequentialRenders: [\n-    { a: 0, b: 0 },\n-    { a: 1, b: 0 },\n-    { a: 1, b: 1 },\n-    { a: 1, b: 2 },\n-    { a: 2, b: 2 },\n-    { a: 3, b: 2 },\n-    { a: 0, b: 0 },\n-  ],\n-};\n-\n-```\n-      \n-### Eval output\n-(kind: ok) <div>{\"inputs\":[0],\"output\":{\"a\":0}}</div><div>{\"inputs\":[0],\"output\":{\"b\":0}}</div>\n-<div>{\"inputs\":[1],\"output\":{\"a\":1}}</div><div>{\"inputs\":[0],\"output\":{\"b\":0}}</div>\n-<div>{\"inputs\":[1],\"output\":{\"a\":1}}</div><div>{\"inputs\":[1],\"output\":{\"b\":1}}</div>\n-<div>{\"inputs\":[1],\"output\":{\"a\":1}}</div><div>{\"inputs\":[2],\"output\":{\"b\":2}}</div>\n-<div>{\"inputs\":[2],\"output\":{\"a\":2}}</div><div>{\"inputs\":[2],\"output\":{\"b\":2}}</div>\n-<div>{\"inputs\":[3],\"output\":{\"a\":3}}</div><div>{\"inputs\":[2],\"output\":{\"b\":2}}</div>\n-<div>{\"inputs\":[0],\"output\":{\"a\":0}}</div><div>{\"inputs\":[0],\"output\":{\"b\":0}}</div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-unknown-import-from-typed-module.js",
                "git_diff": "@@ -1,29 +0,0 @@\n-import {useMemo} from 'react';\n-import {useHook, ValidateMemoization} from 'shared-runtime';\n-\n-export function Component({a, b}) {\n-  const item1 = useMemo(() => ({a}), [a]);\n-  const item2 = useMemo(() => ({b}), [b]);\n-  useHook(item1, item2);\n-\n-  return (\n-    <>\n-      <ValidateMemoization inputs={[a]} output={item1} />\n-      <ValidateMemoization inputs={[b]} output={item2} />\n-    </>\n-  );\n-}\n-\n-export const FIXTURE_ENTRYPOINT = {\n-  fn: Component,\n-  params: [{a: 0, b: 0}],\n-  sequentialRenders: [\n-    {a: 0, b: 0},\n-    {a: 1, b: 0},\n-    {a: 1, b: 1},\n-    {a: 1, b: 2},\n-    {a: 2, b: 2},\n-    {a: 3, b: 2},\n-    {a: 0, b: 0},\n-  ],\n-};"
            },
            {
                "file": "compiler/packages/snap/src/sprout/shared-runtime-type-provider.ts",
                "git_diff": "@@ -56,14 +56,6 @@ export function makeSharedRuntimeTypeProvider({\n           returnType: {kind: 'type', name: 'Primitive'},\n           returnValueKind: ValueKindEnum.Primitive,\n         },\n-        useArrayConcatNotTypedAsHook: {\n-          kind: 'function',\n-          calleeEffect: EffectEnum.Read,\n-          positionalParams: [],\n-          restParam: EffectEnum.Capture,\n-          returnType: {kind: 'type', name: 'Array'},\n-          returnValueKind: ValueKindEnum.Primitive,\n-        },\n         useFreeze: {\n           kind: 'hook',\n           returnType: {kind: 'type', name: 'Any'},"
            },
            {
                "file": "compiler/packages/snap/src/sprout/shared-runtime.ts",
                "git_diff": "@@ -6,7 +6,7 @@\n  */\n \n import {IntlVariations, IntlViewerContext, init} from 'fbt';\n-import React, {FunctionComponent, useMemo} from 'react';\n+import React, {FunctionComponent} from 'react';\n \n /**\n  * This file is meant for use by `runner-evaluator` and fixture tests.\n@@ -355,14 +355,4 @@ export function typedArrayPush<T>(array: Array<T>, item: T): void {\n export function typedLog(...values: Array<any>): void {\n   console.log(...values);\n }\n-\n-export function useArrayConcatNotTypedAsHook<T>(\n-  array1: Array<T>,\n-  array2: Array<T>,\n-): Array<T> {\n-  return useMemo(() => {\n-    return [...array1, ...array2];\n-  }, [array1, array2]);\n-}\n-\n export default typedLog;"
            },
            {
                "file": "packages/shared/ReactFeatureFlags.js",
                "git_diff": "@@ -134,7 +134,7 @@ export const alwaysThrottleRetries = true;\n \n export const passChildrenWhenCloningPersistedNodes = false;\n \n-export const enableServerComponentLogs = __EXPERIMENTAL__;\n+export const enableServerComponentLogs = true;\n \n /**\n  * Enables a new Fiber flag used in persisted mode to reduce the number"
            }
        ]
    },
    {
        "prompt": "issue: [DevTools] Refactor Forcing Fallback / Error of Suspense / Error Boundaries | description: First, this basically reverts https://github.com/facebook/react/pull/30517/commits/1f3892ef8cc181218587ddc6accd994890c92ef5 to use a Map/Set to track what is forced to suspend/error again instead of flags on the Instance. The difference is that now the key in the Fiber itself instead of the ID. Critically this avoids the fiberToFiberInstance map to look up whether or not a Fiber should be forced to suspend when asked by the renderer.\r\n\r\nThis also allows us to force suspend/error on filtered instances. It's a bit unclear what should happen when you try to Suspend or Error a child but its parent boundary is filtered. It was also inconsistent between Suspense and Error due to how they were implemented.\r\n\r\nI think conceptually you're trying to simulate what would happen if that Component errored or suspended so it would be misleading if we triggered a different boundary than would happen in real life. So I think we should trigger the nearest unfiltered Fiber, not the nearest Instance. The consequence of this however is that if this instance was filtered, there's no way to undo it without refreshing or removing the filter. This is an edge case though since it's unusual you'd filter these in the first place.\r\n\r\nIt used to be that Suspense walked the store in the frontend and Error walked the Fibers in the backend. They also did this somewhat eagerly. This simplifies and unifies the model by passing the id of what you clicked in the frontend and then we walk the Fiber tree from there in the backend to lazily find the boundary. However I also eagerly walk the tree at first to find whether we have any Suspense or Error boundary parents at all so we can hide the buttons if not.\r\n\r\nThis also implements it to work with VirtualInstances using #30865. I find the nearest Fiber Instance downwards filtered or otherwise. Then from its parent we find the nearest Error or Suspense boundary. That's because VirtualInstance will always have their inner Fiber as an Instance but they might not have their parent since it might be filtered. Which would potentially cause us to skip over a filtered parent Suspense boundary.",
        "completion": [
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -148,11 +148,6 @@ const FIBER_INSTANCE = 0;\n const VIRTUAL_INSTANCE = 1;\n const FILTERED_FIBER_INSTANCE = 2;\n \n-// Flags\n-const FORCE_SUSPENSE_FALLBACK = /*    */ 0b001;\n-const FORCE_ERROR = /*                */ 0b010;\n-const FORCE_ERROR_RESET = /*          */ 0b100;\n-\n // This type represents a stateful instance of a Client Component i.e. a Fiber pair.\n // These instances also let us track stateful DevTools meta data like id and warnings.\n type FiberInstance = {\n@@ -161,7 +156,6 @@ type FiberInstance = {\n   parent: null | DevToolsInstance,\n   firstChild: null | DevToolsInstance,\n   nextSibling: null | DevToolsInstance,\n-  flags: number, // Force Error/Suspense\n   source: null | string | Error | Source, // source location of this component function, or owned child stack\n   errors: null | Map<string, number>, // error messages and count\n   warnings: null | Map<string, number>, // warning messages and count\n@@ -176,7 +170,6 @@ function createFiberInstance(fiber: Fiber): FiberInstance {\n     parent: null,\n     firstChild: null,\n     nextSibling: null,\n-    flags: 0,\n     source: null,\n     errors: null,\n     warnings: null,\n@@ -193,7 +186,6 @@ type FilteredFiberInstance = {\n   parent: null | DevToolsInstance,\n   firstChild: null | DevToolsInstance,\n   nextSibling: null | DevToolsInstance,\n-  flags: number, // Force Error/Suspense\n   source: null | string | Error | Source, // always null here.\n   errors: null, // error messages and count\n   warnings: null, // warning messages and count\n@@ -209,7 +201,6 @@ function createFilteredFiberInstance(fiber: Fiber): FilteredFiberInstance {\n     parent: null,\n     firstChild: null,\n     nextSibling: null,\n-    flags: 0,\n     componentStack: null,\n     errors: null,\n     warnings: null,\n@@ -229,7 +220,6 @@ type VirtualInstance = {\n   parent: null | DevToolsInstance,\n   firstChild: null | DevToolsInstance,\n   nextSibling: null | DevToolsInstance,\n-  flags: number,\n   source: null | string | Error | Source, // source location of this server component, or owned child stack\n   // Errors and Warnings happen per ReactComponentInfo which can appear in\n   // multiple places but we track them per stateful VirtualInstance so\n@@ -251,7 +241,6 @@ function createVirtualInstance(\n     parent: null,\n     firstChild: null,\n     nextSibling: null,\n-    flags: 0,\n     source: null,\n     errors: null,\n     warnings: null,\n@@ -1080,12 +1069,12 @@ export function attach(\n     args: $ReadOnlyArray<any>,\n   ): void {\n     if (type === 'error') {\n-      let fiberInstance = fiberToFiberInstanceMap.get(fiber);\n-      if (fiberInstance === undefined && fiber.alternate !== null) {\n-        fiberInstance = fiberToFiberInstanceMap.get(fiber.alternate);\n-      }\n       // if this is an error simulated by us to trigger error boundary, ignore\n-      if (fiberInstance !== undefined && fiberInstance.flags & FORCE_ERROR) {\n+      if (\n+        forceErrorForFibers.get(fiber) === true ||\n+        (fiber.alternate !== null &&\n+          forceErrorForFibers.get(fiber.alternate) === true)\n+      ) {\n         return;\n       }\n     }\n@@ -1577,6 +1566,26 @@ export function attach(\n   // Removes a Fiber (and its alternate) from the Maps used to track their id.\n   // This method should always be called when a Fiber is unmounting.\n   function untrackFiber(nearestInstance: DevToolsInstance, fiber: Fiber) {\n+    if (forceErrorForFibers.size > 0) {\n+      forceErrorForFibers.delete(fiber);\n+      if (fiber.alternate) {\n+        forceErrorForFibers.delete(fiber.alternate);\n+      }\n+      if (forceErrorForFibers.size === 0 && setErrorHandler != null) {\n+        setErrorHandler(shouldErrorFiberAlwaysNull);\n+      }\n+    }\n+\n+    if (forceFallbackForFibers.size > 0) {\n+      forceFallbackForFibers.delete(fiber);\n+      if (fiber.alternate) {\n+        forceFallbackForFibers.delete(fiber.alternate);\n+      }\n+      if (forceFallbackForFibers.size === 0 && setSuspenseHandler != null) {\n+        setSuspenseHandler(shouldSuspendFiberAlwaysFalse);\n+      }\n+    }\n+\n     // TODO: Consider using a WeakMap instead. The only thing where that doesn't work\n     // is React Native Paper which tracks tags but that support is eventually going away\n     // and can use the old findFiberByHostInstance strategy.\n@@ -2465,21 +2474,6 @@ export function attach(\n       fiberInstance.warnings = null;\n     }\n \n-    if (fiberInstance.flags & FORCE_ERROR) {\n-      fiberInstance.flags &= ~FORCE_ERROR;\n-      forceErrorCount--;\n-      if (forceErrorCount === 0 && setErrorHandler != null) {\n-        setErrorHandler(shouldErrorFiberAlwaysNull);\n-      }\n-    }\n-    if (fiberInstance.flags & FORCE_SUSPENSE_FALLBACK) {\n-      fiberInstance.flags &= ~FORCE_SUSPENSE_FALLBACK;\n-      forceFallbackCount--;\n-      if (forceFallbackCount === 0 && setSuspenseHandler != null) {\n-        setSuspenseHandler(shouldSuspendFiberAlwaysFalse);\n-      }\n-    }\n-\n     if (fiberToFiberInstanceMap.get(fiber) === fiberInstance) {\n       fiberToFiberInstanceMap.delete(fiber);\n     }\n@@ -4428,7 +4422,9 @@ export function attach(\n       const DidCapture = 0b000000000000000000010000000;\n       isErrored =\n         (fiber.flags & DidCapture) !== 0 ||\n-        (fiberInstance.flags & FORCE_ERROR) !== 0;\n+        forceErrorForFibers.get(fiber) === true ||\n+          (fiber.alternate !== null &&\n+            forceErrorForFibers.get(fiber.alternate) === true);\n       targetErrorBoundaryID = isErrored\n         ? fiberInstance.id\n         : getNearestErrorBoundaryID(fiber);\n@@ -4479,7 +4475,9 @@ export function attach(\n         (!isTimedOutSuspense ||\n           // If it's showing fallback because we previously forced it to,\n           // allow toggling it back to remove the fallback override.\n-          (fiberInstance.flags & FORCE_SUSPENSE_FALLBACK) !== 0),\n+          forceFallbackForFibers.has(fiber) ||\n+          (fiber.alternate !== null &&\n+            forceFallbackForFibers.has(fiber.alternate))),\n \n       // Can view component source location.\n       canViewSource,\n@@ -5412,24 +5410,18 @@ export function attach(\n     return null;\n   }\n \n-  let forceErrorCount = 0;\n+  // Map of Fiber and its force error status: true (error), false (toggled off)\n+  const forceErrorForFibers = new Map<Fiber, boolean>();\n \n-  function shouldErrorFiberAccordingToMap(fiber: any): null | boolean {\n+  function shouldErrorFiberAccordingToMap(fiber: any): boolean {\n     if (typeof setErrorHandler !== 'function') {\n       throw new Error(\n         'Expected overrideError() to not get called for earlier React versions.',\n       );\n     }\n \n-    let fiberInstance = fiberToFiberInstanceMap.get(fiber);\n-    if (fiberInstance === undefined && fiber.alternate !== null) {\n-      fiberInstance = fiberToFiberInstanceMap.get(fiber.alternate);\n-    }\n-    if (fiberInstance === undefined) {\n-      return null;\n-    }\n-\n-    if (fiberInstance.flags & FORCE_ERROR_RESET) {\n+    let status = forceErrorForFibers.get(fiber);\n+    if (status === false) {\n       // TRICKY overrideError adds entries to this Map,\n       // so ideally it would be the method that clears them too,\n       // but that would break the functionality of the feature,\n@@ -5439,18 +5431,27 @@ export function attach(\n       // Technically this is premature and we should schedule it for later,\n       // since the render could always fail without committing the updated error boundary,\n       // but since this is a DEV-only feature, the simplicity is worth the trade off.\n-      forceErrorCount--;\n-      fiberInstance.flags &= ~FORCE_ERROR_RESET;\n-      if (forceErrorCount === 0) {\n+      forceErrorForFibers.delete(fiber);\n+      if (forceErrorForFibers.size === 0) {\n         // Last override is gone. Switch React back to fast path.\n         setErrorHandler(shouldErrorFiberAlwaysNull);\n       }\n       return false;\n-    } else if (fiberInstance.flags & FORCE_ERROR) {\n-      return true;\n-    } else {\n-      return null;\n     }\n+    if (status === undefined && fiber.alternate !== null) {\n+      status = forceErrorForFibers.get(fiber.alternate);\n+      if (status === false) {\n+        forceErrorForFibers.delete(fiber.alternate);\n+        if (forceErrorForFibers.size === 0) {\n+          // Last override is gone. Switch React back to fast path.\n+          setErrorHandler(shouldErrorFiberAlwaysNull);\n+        }\n+      }\n+    }\n+    if (status === undefined) {\n+      return false;\n+    }\n+    return status;\n   }\n \n   function overrideError(id: number, forceError: boolean) {\n@@ -5467,18 +5468,17 @@ export function attach(\n     if (devtoolsInstance === undefined) {\n       return;\n     }\n-    if ((devtoolsInstance.flags & (FORCE_ERROR | FORCE_ERROR_RESET)) === 0) {\n-      forceErrorCount++;\n-      if (forceErrorCount === 1) {\n+    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n+      const fiber = devtoolsInstance.data;\n+      forceErrorForFibers.set(fiber, forceError);\n+      if (fiber.alternate !== null) {\n+        // We only need one of the Fibers in the set.\n+        forceErrorForFibers.delete(fiber.alternate);\n+      }\n+      if (forceErrorForFibers.size === 1) {\n         // First override is added. Switch React to slower path.\n         setErrorHandler(shouldErrorFiberAccordingToMap);\n       }\n-    }\n-    devtoolsInstance.flags &= forceError ? ~FORCE_ERROR_RESET : ~FORCE_ERROR;\n-    devtoolsInstance.flags |= forceError ? FORCE_ERROR : FORCE_ERROR_RESET;\n-\n-    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n-      const fiber = devtoolsInstance.data;\n       scheduleUpdate(fiber);\n     } else {\n       // TODO: Handle VirtualInstance.\n@@ -5489,16 +5489,12 @@ export function attach(\n     return false;\n   }\n \n-  let forceFallbackCount = 0;\n+  const forceFallbackForFibers = new Set<Fiber>();\n \n-  function shouldSuspendFiberAccordingToSet(fiber: any) {\n-    let fiberInstance = fiberToFiberInstanceMap.get(fiber);\n-    if (fiberInstance === undefined && fiber.alternate !== null) {\n-      fiberInstance = fiberToFiberInstanceMap.get(fiber.alternate);\n-    }\n+  function shouldSuspendFiberAccordingToSet(fiber: Fiber): boolean {\n     return (\n-      fiberInstance !== undefined &&\n-      (fiberInstance.flags & FORCE_SUSPENSE_FALLBACK) !== 0\n+      forceFallbackForFibers.has(fiber) ||\n+      (fiber.alternate !== null && forceFallbackForFibers.has(fiber.alternate))\n     );\n   }\n \n@@ -5515,29 +5511,25 @@ export function attach(\n     if (devtoolsInstance === undefined) {\n       return;\n     }\n-\n-    if (forceFallback) {\n-      if ((devtoolsInstance.flags & FORCE_SUSPENSE_FALLBACK) === 0) {\n-        devtoolsInstance.flags |= FORCE_SUSPENSE_FALLBACK;\n-        forceFallbackCount++;\n-        if (forceFallbackCount === 1) {\n+    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n+      const fiber = devtoolsInstance.data;\n+      if (fiber.alternate !== null) {\n+        // We only need one of the Fibers in the set.\n+        forceFallbackForFibers.delete(fiber.alternate);\n+      }\n+      if (forceFallback) {\n+        forceFallbackForFibers.add(fiber);\n+        if (forceFallbackForFibers.size === 1) {\n           // First override is added. Switch React to slower path.\n           setSuspenseHandler(shouldSuspendFiberAccordingToSet);\n         }\n-      }\n-    } else {\n-      if ((devtoolsInstance.flags & FORCE_SUSPENSE_FALLBACK) !== 0) {\n-        devtoolsInstance.flags &= ~FORCE_SUSPENSE_FALLBACK;\n-        forceFallbackCount--;\n-        if (forceFallbackCount === 0) {\n+      } else {\n+        forceFallbackForFibers.delete(fiber);\n+        if (forceFallbackForFibers.size === 0) {\n           // Last override is gone. Switch React back to fast path.\n           setSuspenseHandler(shouldSuspendFiberAlwaysFalse);\n         }\n       }\n-    }\n-\n-    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n-      const fiber = devtoolsInstance.data;\n       scheduleUpdate(fiber);\n     } else {\n       // TODO: Handle VirtualInstance."
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/inspectedElement-test.js",
                "git_diff": "@@ -2975,16 +2975,12 @@ describe('InspectedElement', () => {\n       // Inspect <ErrorBoundary /> and see that we cannot toggle error state\n       // on error boundary itself\n       let inspectedElement = await inspect(0);\n-      expect(inspectedElement.canToggleError).toBe(false);\n-      expect(inspectedElement.targetErrorBoundaryID).toBe(null);\n+      expect(inspectedElement.canToggleError).toBe(true);\n \n       // Inspect <Example />\n       inspectedElement = await inspect(1);\n       expect(inspectedElement.canToggleError).toBe(true);\n       expect(inspectedElement.isErrored).toBe(false);\n-      expect(inspectedElement.targetErrorBoundaryID).toBe(\n-        targetErrorBoundaryID,\n-      );\n \n       // Suppress expected error and warning.\n       const consoleErrorMock = jest\n@@ -3009,20 +3005,13 @@ describe('InspectedElement', () => {\n       inspectedElement = await inspect(0);\n       expect(inspectedElement.canToggleError).toBe(true);\n       expect(inspectedElement.isErrored).toBe(true);\n-      // its error boundary ID is itself because it's caught the error\n-      expect(inspectedElement.targetErrorBoundaryID).toBe(\n-        targetErrorBoundaryID,\n-      );\n \n       await toggleError(false);\n \n       // We can now inspect <Example /> with ability to toggle again\n       inspectedElement = await inspect(1);\n       expect(inspectedElement.canToggleError).toBe(true);\n       expect(inspectedElement.isErrored).toBe(false);\n-      expect(inspectedElement.targetErrorBoundaryID).toBe(\n-        targetErrorBoundaryID,\n-      );\n     });\n   });\n "
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -4202,18 +4202,6 @@ export function attach(\n     }\n   }\n \n-  function getNearestErrorBoundaryID(fiber: Fiber): number | null {\n-    let parent = fiber.return;\n-    while (parent !== null) {\n-      if (isErrorBoundary(parent)) {\n-        // TODO: If this boundary is filtered it won't have an ID.\n-        return getFiberIDUnsafe(parent);\n-      }\n-      parent = parent.return;\n-    }\n-    return null;\n-  }\n-\n   function inspectElementRaw(id: number): InspectedElement | null {\n     const devtoolsInstance = idToDevToolsInstanceMap.get(id);\n     if (devtoolsInstance === undefined) {\n@@ -4409,7 +4397,6 @@ export function attach(\n     }\n \n     let isErrored = false;\n-    let targetErrorBoundaryID;\n     if (isErrorBoundary(fiber)) {\n       // if the current inspected element is an error boundary,\n       // either that we want to use it to toggle off error state\n@@ -4423,13 +4410,8 @@ export function attach(\n       isErrored =\n         (fiber.flags & DidCapture) !== 0 ||\n         forceErrorForFibers.get(fiber) === true ||\n-          (fiber.alternate !== null &&\n-            forceErrorForFibers.get(fiber.alternate) === true);\n-      targetErrorBoundaryID = isErrored\n-        ? fiberInstance.id\n-        : getNearestErrorBoundaryID(fiber);\n-    } else {\n-      targetErrorBoundaryID = getNearestErrorBoundaryID(fiber);\n+        (fiber.alternate !== null &&\n+          forceErrorForFibers.get(fiber.alternate) === true);\n     }\n \n     const plugins: Plugins = {\n@@ -4464,10 +4446,9 @@ export function attach(\n       canEditFunctionPropsRenamePaths:\n         typeof overridePropsRenamePath === 'function',\n \n-      canToggleError: supportsTogglingError && targetErrorBoundaryID != null,\n+      canToggleError: supportsTogglingError,\n       // Is this error boundary in error state.\n       isErrored,\n-      targetErrorBoundaryID,\n \n       canToggleSuspense:\n         supportsTogglingSuspense &&\n@@ -4531,11 +4512,9 @@ export function attach(\n       getOwnersListFromInstance(virtualInstance);\n \n     let rootType = null;\n-    let targetErrorBoundaryID = null;\n     let parent = virtualInstance.parent;\n     while (parent !== null) {\n       if (parent.kind !== VIRTUAL_INSTANCE) {\n-        targetErrorBoundaryID = getNearestErrorBoundaryID(parent.data);\n         let current = parent.data;\n         while (current.return !== null) {\n           current = current.return;\n@@ -4564,9 +4543,8 @@ export function attach(\n       canEditFunctionPropsDeletePaths: false,\n       canEditFunctionPropsRenamePaths: false,\n \n-      canToggleError: supportsTogglingError && targetErrorBoundaryID != null,\n+      canToggleError: supportsTogglingError,\n       isErrored: false,\n-      targetErrorBoundaryID,\n \n       canToggleSuspense: supportsTogglingSuspense,\n \n@@ -5469,7 +5447,13 @@ export function attach(\n       return;\n     }\n     if (devtoolsInstance.kind === FIBER_INSTANCE) {\n-      const fiber = devtoolsInstance.data;\n+      let fiber = devtoolsInstance.data;\n+      while (!isErrorBoundary(fiber)) {\n+        if (fiber.return === null) {\n+          return;\n+        }\n+        fiber = fiber.return;\n+      }\n       forceErrorForFibers.set(fiber, forceError);\n       if (fiber.alternate !== null) {\n         // We only need one of the Fibers in the set."
            },
            {
                "file": "packages/react-devtools-shared/src/backend/legacy/renderer.js",
                "git_diff": "@@ -826,7 +826,6 @@ export function attach(\n       // Toggle error boundary did not exist in legacy versions\n       canToggleError: false,\n       isErrored: false,\n-      targetErrorBoundaryID: null,\n \n       // Suspense did not exist in legacy versions\n       canToggleSuspense: false,"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/types.js",
                "git_diff": "@@ -252,7 +252,6 @@ export type InspectedElement = {\n   // Is this Error, and can its value be overridden now?\n   canToggleError: boolean,\n   isErrored: boolean,\n-  targetErrorBoundaryID: ?number,\n \n   // Is this Suspense, and can its value be overridden now?\n   canToggleSuspense: boolean,"
            },
            {
                "file": "packages/react-devtools-shared/src/backendAPI.js",
                "git_diff": "@@ -221,7 +221,6 @@ export function convertInspectedElementBackendToFrontend(\n     canEditHooksAndRenamePaths,\n     canToggleError,\n     isErrored,\n-    targetErrorBoundaryID,\n     canToggleSuspense,\n     canViewSource,\n     hasLegacyContext,\n@@ -251,7 +250,6 @@ export function convertInspectedElementBackendToFrontend(\n     canEditHooksAndRenamePaths,\n     canToggleError,\n     isErrored,\n-    targetErrorBoundaryID,\n     canToggleSuspense,\n     canViewSource,\n     hasLegacyContext,"
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElement.js",
                "git_diff": "@@ -105,8 +105,6 @@ export default function InspectedElementWrapper(_: Props): React.Node {\n   }, [bridge, inspectedElementID, store]);\n \n   const isErrored = inspectedElement != null && inspectedElement.isErrored;\n-  const targetErrorBoundaryID =\n-    inspectedElement != null ? inspectedElement.targetErrorBoundaryID : null;\n \n   const isSuspended =\n     element !== null &&\n@@ -137,29 +135,23 @@ export default function InspectedElementWrapper(_: Props): React.Node {\n   );\n \n   const toggleErrored = useCallback(() => {\n-    if (inspectedElement == null || targetErrorBoundaryID == null) {\n+    if (inspectedElement == null) {\n       return;\n     }\n \n-    const rendererID = store.getRendererIDForElement(targetErrorBoundaryID);\n+    const rendererID = store.getRendererIDForElement(inspectedElement.id);\n     if (rendererID !== null) {\n-      if (targetErrorBoundaryID !== inspectedElement.id) {\n-        // Update tree selection so that if we cause a component to error,\n-        // the nearest error boundary will become the newly selected thing.\n-        dispatch({\n-          type: 'SELECT_ELEMENT_BY_ID',\n-          payload: targetErrorBoundaryID,\n-        });\n-      }\n-\n       // Toggle error.\n+      // Because triggering an error will always delete the children, we'll\n+      // automatically select the nearest still mounted instance which will be\n+      // the error boundary.\n       bridge.send('overrideError', {\n-        id: targetErrorBoundaryID,\n+        id: inspectedElement.id,\n         rendererID,\n         forceError: !isErrored,\n       });\n     }\n-  }, [bridge, dispatch, isErrored, targetErrorBoundaryID]);\n+  }, [bridge, dispatch, isErrored, inspectedElement]);\n \n   // TODO (suspense toggle) Would be nice to eventually use a two setState pattern here as well.\n   const toggleSuspended = useCallback(() => {"
            },
            {
                "file": "packages/react-devtools-shared/src/frontend/types.js",
                "git_diff": "@@ -219,7 +219,6 @@ export type InspectedElement = {\n   // Is this Error, and can its value be overridden now?\n   isErrored: boolean,\n   canToggleError: boolean,\n-  targetErrorBoundaryID: ?number,\n \n   // Is this Suspense, and can its value be overridden now?\n   canToggleSuspense: boolean,"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -5496,7 +5496,14 @@ export function attach(\n       return;\n     }\n     if (devtoolsInstance.kind === FIBER_INSTANCE) {\n-      const fiber = devtoolsInstance.data;\n+      let fiber = devtoolsInstance.data;\n+      while (fiber.tag !== SuspenseComponent) {\n+        if (fiber.return === null) {\n+          return;\n+        }\n+        fiber = fiber.return;\n+      }\n+\n       if (fiber.alternate !== null) {\n         // We only need one of the Fibers in the set.\n         forceFallbackForFibers.delete(fiber.alternate);"
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/CannotSuspendWarningMessage.js",
                "git_diff": "@@ -1,44 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- *\n- * @flow\n- */\n-\n-import * as React from 'react';\n-import {useContext} from 'react';\n-import {StoreContext} from '../context';\n-import {\n-  ComponentFilterElementType,\n-  ElementTypeSuspense,\n-} from 'react-devtools-shared/src/frontend/types';\n-\n-export default function CannotSuspendWarningMessage(): React.Node {\n-  const store = useContext(StoreContext);\n-  const areSuspenseElementsHidden = !!store.componentFilters.find(\n-    filter =>\n-      filter.type === ComponentFilterElementType &&\n-      filter.value === ElementTypeSuspense &&\n-      filter.isEnabled,\n-  );\n-\n-  // Has the user filtered out Suspense nodes from the tree?\n-  // If so, the selected element might actually be in a Suspense tree after all.\n-  if (areSuspenseElementsHidden) {\n-    return (\n-      <div>\n-        Suspended state cannot be toggled while Suspense components are hidden.\n-        Disable the filter and try again.\n-      </div>\n-    );\n-  } else {\n-    return (\n-      <div>\n-        The selected element is not within a Suspense container. Suspending it\n-        would cause an error.\n-      </div>\n-    );\n-  }\n-}"
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElement.js",
                "git_diff": "@@ -9,15 +9,13 @@\n \n import * as React from 'react';\n import {useCallback, useContext, useSyncExternalStore} from 'react';\n-import {TreeDispatcherContext, TreeStateContext} from './TreeContext';\n+import {TreeStateContext} from './TreeContext';\n import {BridgeContext, StoreContext, OptionsContext} from '../context';\n import Button from '../Button';\n import ButtonIcon from '../ButtonIcon';\n import Icon from '../Icon';\n-import {ModalDialogContext} from '../ModalDialog';\n import Toggle from '../Toggle';\n import {ElementTypeSuspense} from 'react-devtools-shared/src/frontend/types';\n-import CannotSuspendWarningMessage from './CannotSuspendWarningMessage';\n import InspectedElementView from './InspectedElementView';\n import {InspectedElementContext} from './InspectedElementContext';\n import {getOpenInEditorURL} from '../../../utils';\n@@ -38,7 +36,6 @@ export type Props = {};\n \n export default function InspectedElementWrapper(_: Props): React.Node {\n   const {inspectedElementID} = useContext(TreeStateContext);\n-  const dispatch = useContext(TreeDispatcherContext);\n   const bridge = useContext(BridgeContext);\n   const store = useContext(StoreContext);\n   const {\n@@ -47,7 +44,6 @@ export default function InspectedElementWrapper(_: Props): React.Node {\n     hideLogAction,\n     hideViewSourceAction,\n   } = useContext(OptionsContext);\n-  const {dispatch: modalDialogDispatch} = useContext(ModalDialogContext);\n \n   const {hookNames, inspectedElement, parseHookNames, toggleParseHookNames} =\n     useContext(InspectedElementContext);\n@@ -151,57 +147,27 @@ export default function InspectedElementWrapper(_: Props): React.Node {\n         forceError: !isErrored,\n       });\n     }\n-  }, [bridge, dispatch, isErrored, inspectedElement]);\n+  }, [bridge, store, isErrored, inspectedElement]);\n \n   // TODO (suspense toggle) Would be nice to eventually use a two setState pattern here as well.\n   const toggleSuspended = useCallback(() => {\n-    let nearestSuspenseElement = null;\n-    let currentElement = element;\n-    while (currentElement !== null) {\n-      if (currentElement.type === ElementTypeSuspense) {\n-        nearestSuspenseElement = currentElement;\n-        break;\n-      } else if (currentElement.parentID > 0) {\n-        currentElement = store.getElementByID(currentElement.parentID);\n-      } else {\n-        currentElement = null;\n-      }\n+    if (inspectedElement == null) {\n+      return;\n     }\n \n-    // If we didn't find a Suspense ancestor, we can't suspend.\n-    // Instead we can show a warning to the user.\n-    if (nearestSuspenseElement === null) {\n-      modalDialogDispatch({\n-        id: 'InspectedElement',\n-        type: 'SHOW',\n-        content: <CannotSuspendWarningMessage />,\n-      });\n-    } else {\n-      const nearestSuspenseElementID = nearestSuspenseElement.id;\n-\n-      // If we're suspending from an arbitrary (non-Suspense) component, select the nearest Suspense element in the Tree.\n-      // This way when the fallback UI is shown and the current element is hidden, something meaningful is selected.\n-      if (nearestSuspenseElement !== element) {\n-        dispatch({\n-          type: 'SELECT_ELEMENT_BY_ID',\n-          payload: nearestSuspenseElementID,\n-        });\n-      }\n-\n-      const rendererID = store.getRendererIDForElement(\n-        nearestSuspenseElementID,\n-      );\n-\n+    const rendererID = store.getRendererIDForElement(inspectedElement.id);\n+    if (rendererID !== null) {\n       // Toggle suspended\n-      if (rendererID !== null) {\n-        bridge.send('overrideSuspense', {\n-          id: nearestSuspenseElementID,\n-          rendererID,\n-          forceFallback: !isSuspended,\n-        });\n-      }\n+      // Because suspending or unsuspending always delete the children or fallback,\n+      // we'll automatically select the nearest still mounted instance which will be\n+      // the Suspense boundary.\n+      bridge.send('overrideSuspense', {\n+        id: inspectedElement.id,\n+        rendererID,\n+        forceFallback: !isSuspended,\n+      });\n     }\n-  }, [bridge, dispatch, element, isSuspended, modalDialogDispatch, store]);\n+  }, [bridge, store, isSuspended, inspectedElement]);\n \n   if (element === null) {\n     return ("
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -5382,6 +5382,25 @@ export function attach(\n     );\n   }\n \n+  function getNearestFiber(devtoolsInstance: DevToolsInstance): null | Fiber {\n+    if (devtoolsInstance.kind === VIRTUAL_INSTANCE) {\n+      let inst: DevToolsInstance = devtoolsInstance;\n+      while (inst.kind === VIRTUAL_INSTANCE) {\n+        // For virtual instances, we search deeper until we find a Fiber instance.\n+        // Then we search upwards from that Fiber. That's because Virtual Instances\n+        // will always have an Fiber child filtered or not. If we searched its parents\n+        // we might skip through a filtered Error Boundary before we hit a FiberInstance.\n+        if (inst.firstChild === null) {\n+          return null;\n+        }\n+        inst = inst.firstChild;\n+      }\n+      return inst.data.return;\n+    } else {\n+      return devtoolsInstance.data;\n+    }\n+  }\n+\n   // React will switch between these implementations depending on whether\n   // we have any manually suspended/errored-out Fibers or not.\n   function shouldErrorFiberAlwaysNull() {\n@@ -5446,27 +5465,27 @@ export function attach(\n     if (devtoolsInstance === undefined) {\n       return;\n     }\n-    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n-      let fiber = devtoolsInstance.data;\n-      while (!isErrorBoundary(fiber)) {\n-        if (fiber.return === null) {\n-          return;\n-        }\n-        fiber = fiber.return;\n-      }\n-      forceErrorForFibers.set(fiber, forceError);\n-      if (fiber.alternate !== null) {\n-        // We only need one of the Fibers in the set.\n-        forceErrorForFibers.delete(fiber.alternate);\n-      }\n-      if (forceErrorForFibers.size === 1) {\n-        // First override is added. Switch React to slower path.\n-        setErrorHandler(shouldErrorFiberAccordingToMap);\n+    const nearestFiber = getNearestFiber(devtoolsInstance);\n+    if (nearestFiber === null) {\n+      return;\n+    }\n+    let fiber = nearestFiber;\n+    while (!isErrorBoundary(fiber)) {\n+      if (fiber.return === null) {\n+        return;\n       }\n-      scheduleUpdate(fiber);\n-    } else {\n-      // TODO: Handle VirtualInstance.\n+      fiber = fiber.return;\n+    }\n+    forceErrorForFibers.set(fiber, forceError);\n+    if (fiber.alternate !== null) {\n+      // We only need one of the Fibers in the set.\n+      forceErrorForFibers.delete(fiber.alternate);\n     }\n+    if (forceErrorForFibers.size === 1) {\n+      // First override is added. Switch React to slower path.\n+      setErrorHandler(shouldErrorFiberAccordingToMap);\n+    }\n+    scheduleUpdate(fiber);\n   }\n \n   function shouldSuspendFiberAlwaysFalse() {\n@@ -5495,36 +5514,36 @@ export function attach(\n     if (devtoolsInstance === undefined) {\n       return;\n     }\n-    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n-      let fiber = devtoolsInstance.data;\n-      while (fiber.tag !== SuspenseComponent) {\n-        if (fiber.return === null) {\n-          return;\n-        }\n-        fiber = fiber.return;\n+    const nearestFiber = getNearestFiber(devtoolsInstance);\n+    if (nearestFiber === null) {\n+      return;\n+    }\n+    let fiber = nearestFiber;\n+    while (fiber.tag !== SuspenseComponent) {\n+      if (fiber.return === null) {\n+        return;\n       }\n+      fiber = fiber.return;\n+    }\n \n-      if (fiber.alternate !== null) {\n-        // We only need one of the Fibers in the set.\n-        forceFallbackForFibers.delete(fiber.alternate);\n-      }\n-      if (forceFallback) {\n-        forceFallbackForFibers.add(fiber);\n-        if (forceFallbackForFibers.size === 1) {\n-          // First override is added. Switch React to slower path.\n-          setSuspenseHandler(shouldSuspendFiberAccordingToSet);\n-        }\n-      } else {\n-        forceFallbackForFibers.delete(fiber);\n-        if (forceFallbackForFibers.size === 0) {\n-          // Last override is gone. Switch React back to fast path.\n-          setSuspenseHandler(shouldSuspendFiberAlwaysFalse);\n-        }\n+    if (fiber.alternate !== null) {\n+      // We only need one of the Fibers in the set.\n+      forceFallbackForFibers.delete(fiber.alternate);\n+    }\n+    if (forceFallback) {\n+      forceFallbackForFibers.add(fiber);\n+      if (forceFallbackForFibers.size === 1) {\n+        // First override is added. Switch React to slower path.\n+        setSuspenseHandler(shouldSuspendFiberAccordingToSet);\n       }\n-      scheduleUpdate(fiber);\n     } else {\n-      // TODO: Handle VirtualInstance.\n+      forceFallbackForFibers.delete(fiber);\n+      if (forceFallbackForFibers.size === 0) {\n+        // Last override is gone. Switch React back to fast path.\n+        setSuspenseHandler(shouldSuspendFiberAlwaysFalse);\n+      }\n     }\n+    scheduleUpdate(fiber);\n   }\n \n   // Remember if we're trying to restore the selection after reload."
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -4356,9 +4356,6 @@ export function attach(\n     const owners: null | Array<SerializedElement> =\n       getOwnersListFromInstance(fiberInstance);\n \n-    const isTimedOutSuspense =\n-      tag === SuspenseComponent && memoizedState !== null;\n-\n     let hooks = null;\n     if (usesHooks) {\n       const originalConsoleMethods: {[string]: $FlowFixMe} = {};\n@@ -4388,14 +4385,25 @@ export function attach(\n \n     let rootType = null;\n     let current = fiber;\n+    let hasErrorBoundary = false;\n+    let hasSuspenseBoundary = false;\n     while (current.return !== null) {\n+      const temp = current;\n       current = current.return;\n+      if (temp.tag === SuspenseComponent) {\n+        hasSuspenseBoundary = true;\n+      } else if (isErrorBoundary(temp)) {\n+        hasErrorBoundary = true;\n+      }\n     }\n     const fiberRoot = current.stateNode;\n     if (fiberRoot != null && fiberRoot._debugRootType !== null) {\n       rootType = fiberRoot._debugRootType;\n     }\n \n+    const isTimedOutSuspense =\n+      tag === SuspenseComponent && memoizedState !== null;\n+\n     let isErrored = false;\n     if (isErrorBoundary(fiber)) {\n       // if the current inspected element is an error boundary,\n@@ -4446,12 +4454,13 @@ export function attach(\n       canEditFunctionPropsRenamePaths:\n         typeof overridePropsRenamePath === 'function',\n \n-      canToggleError: supportsTogglingError,\n+      canToggleError: supportsTogglingError && hasErrorBoundary,\n       // Is this error boundary in error state.\n       isErrored,\n \n       canToggleSuspense:\n         supportsTogglingSuspense &&\n+        hasSuspenseBoundary &&\n         // If it's showing the real content, we can always flip fallback.\n         (!isTimedOutSuspense ||\n           // If it's showing fallback because we previously forced it to,\n@@ -4512,20 +4521,24 @@ export function attach(\n       getOwnersListFromInstance(virtualInstance);\n \n     let rootType = null;\n-    let parent = virtualInstance.parent;\n-    while (parent !== null) {\n-      if (parent.kind !== VIRTUAL_INSTANCE) {\n-        let current = parent.data;\n-        while (current.return !== null) {\n-          current = current.return;\n-        }\n-        const fiberRoot = current.stateNode;\n-        if (fiberRoot != null && fiberRoot._debugRootType !== null) {\n-          rootType = fiberRoot._debugRootType;\n+    let hasErrorBoundary = false;\n+    let hasSuspenseBoundary = false;\n+    const nearestFiber = getNearestFiber(virtualInstance);\n+    if (nearestFiber !== null) {\n+      let current = nearestFiber;\n+      while (current.return !== null) {\n+        const temp = current;\n+        current = current.return;\n+        if (temp.tag === SuspenseComponent) {\n+          hasSuspenseBoundary = true;\n+        } else if (isErrorBoundary(temp)) {\n+          hasErrorBoundary = true;\n         }\n-        break;\n       }\n-      parent = parent.parent;\n+      const fiberRoot = current.stateNode;\n+      if (fiberRoot != null && fiberRoot._debugRootType !== null) {\n+        rootType = fiberRoot._debugRootType;\n+      }\n     }\n \n     const plugins: Plugins = {\n@@ -4543,10 +4556,10 @@ export function attach(\n       canEditFunctionPropsDeletePaths: false,\n       canEditFunctionPropsRenamePaths: false,\n \n-      canToggleError: supportsTogglingError,\n+      canToggleError: supportsTogglingError && hasErrorBoundary,\n       isErrored: false,\n \n-      canToggleSuspense: supportsTogglingSuspense,\n+      canToggleSuspense: supportsTogglingSuspense && hasSuspenseBoundary,\n \n       // Can view component source location.\n       canViewSource,"
            }
        ]
    },
    {
        "prompt": "issue: [Fiber] Stash ThenableState on the Dependencies Object for Use By DevTools | description: This lets us track what a Component might suspend on from DevTools. We could already collect this by replaying a component's Hooks but that would be expensive to collect from a whole tree.\r\n\r\nThe thenables themselves might contain useful information but mainly we'd want access to the `_debugInfo` on the thenables which might contain additional information from the server. \r\n\r\nhttps://github.com/facebook/react/blob/19bd26beb689e554fceb0b929dc5199be8cba594/packages/shared/ReactTypes.js#L114\r\n\r\nIn a follow up we should really do something similar in Flight to transfer `use()` on the debugInfo of that Server Component.",
        "completion": [
            {
                "file": "packages/react-reconciler/src/ReactFiber.js",
                "git_diff": "@@ -404,10 +404,16 @@ export function createWorkInProgress(current: Fiber, pendingProps: any): Fiber {\n   workInProgress.dependencies =\n     currentDependencies === null\n       ? null\n-      : {\n-          lanes: currentDependencies.lanes,\n-          firstContext: currentDependencies.firstContext,\n-        };\n+      : __DEV__\n+        ? {\n+            lanes: currentDependencies.lanes,\n+            firstContext: currentDependencies.firstContext,\n+            _debugThenableState: currentDependencies._debugThenableState,\n+          }\n+        : {\n+            lanes: currentDependencies.lanes,\n+            firstContext: currentDependencies.firstContext,\n+          };\n \n   // These will be overridden during the parent's reconciliation\n   workInProgress.sibling = current.sibling;\n@@ -503,10 +509,16 @@ export function resetWorkInProgress(\n     workInProgress.dependencies =\n       currentDependencies === null\n         ? null\n-        : {\n-            lanes: currentDependencies.lanes,\n-            firstContext: currentDependencies.firstContext,\n-          };\n+        : __DEV__\n+          ? {\n+              lanes: currentDependencies.lanes,\n+              firstContext: currentDependencies.firstContext,\n+              _debugThenableState: currentDependencies._debugThenableState,\n+            }\n+          : {\n+              lanes: currentDependencies.lanes,\n+              firstContext: currentDependencies.firstContext,\n+            };\n \n     if (enableProfilerTimer) {\n       // Note: We don't reset the actualTime counts. It's useful to accumulate"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -637,6 +637,18 @@ function finishRenderingHooks<Props, SecondArg>(\n ): void {\n   if (__DEV__) {\n     workInProgress._debugHookTypes = hookTypesDev;\n+    // Stash the thenable state for use by DevTools.\n+    if (workInProgress.dependencies === null) {\n+      if (thenableState !== null) {\n+        workInProgress.dependencies = {\n+          lanes: NoLanes,\n+          firstContext: null,\n+          _debugThenableState: thenableState,\n+        };\n+      }\n+    } else {\n+      workInProgress.dependencies._debugThenableState = thenableState;\n+    }\n   }\n \n   // We can assume the previous dispatcher is always this one, since we set it"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberNewContext.js",
                "git_diff": "@@ -825,10 +825,16 @@ function readContextForConsumer_withSelect<C>(\n \n       // This is the first dependency for this component. Create a new list.\n       lastContextDependency = contextItem;\n-      consumer.dependencies = {\n-        lanes: NoLanes,\n-        firstContext: contextItem,\n-      };\n+      consumer.dependencies = __DEV__\n+        ? {\n+            lanes: NoLanes,\n+            firstContext: contextItem,\n+            _debugThenableState: null,\n+          }\n+        : {\n+            lanes: NoLanes,\n+            firstContext: contextItem,\n+          };\n       if (enableLazyContextPropagation) {\n         consumer.flags |= NeedsPropagation;\n       }\n@@ -869,10 +875,16 @@ function readContextForConsumer<C>(\n \n       // This is the first dependency for this component. Create a new list.\n       lastContextDependency = contextItem;\n-      consumer.dependencies = {\n-        lanes: NoLanes,\n-        firstContext: contextItem,\n-      };\n+      consumer.dependencies = __DEV__\n+        ? {\n+            lanes: NoLanes,\n+            firstContext: contextItem,\n+            _debugThenableState: null,\n+          }\n+        : {\n+            lanes: NoLanes,\n+            firstContext: contextItem,\n+          };\n       if (enableLazyContextPropagation) {\n         consumer.flags |= NeedsPropagation;\n       }"
            },
            {
                "file": "packages/react-reconciler/src/ReactInternalTypes.js",
                "git_diff": "@@ -37,6 +37,7 @@ import type {\n } from './ReactFiberTracingMarkerComponent';\n import type {ConcurrentUpdate} from './ReactFiberConcurrentUpdates';\n import type {ComponentStackNode} from 'react-server/src/ReactFizzComponentStack';\n+import type {ThenableState} from './ReactFiberThenable';\n \n // Unwind Circular: moved from ReactFiberHooks.old\n export type HookType =\n@@ -81,7 +82,7 @@ export type Dependencies = {\n     | ContextDependency<mixed>\n     | ContextDependencyWithSelect<mixed>\n     | null,\n-  ...\n+  _debugThenableState?: null | ThenableState, // DEV-only\n };\n \n export type MemoCache = {"
            }
        ]
    },
    {
        "prompt": "issue: [DevTools] Include some Filtered Fiber Instances | description: When we filter Fiber Instances where have no way to recover our position in the Fiber tree. The extreme form of this is if you filter out all the Fibers and keep only Server Components.\r\n\r\nThis affects operations that are performed against fibers such as collecting Host Instances for highlighting or emulating suspending/erroring.\r\n\r\nConceptually we don't need to add this into the DevToolsInstance tree because we only need to get to some Fibers from a VirtualInstance. A Virtual Instance can contain more than one conceptual child Fiber. It would be easier if we didn't include them in the tree on one hand because we could just traverse the tree and assume it looks like the one on the frontend. But it's also tricky to manage the lifetime. So I went with a special FilteredFiberInstance node in the tree.\r\n\r\nCurrently I only add it if its parent would've been a VirtualInstance since we don't need it in any other cases. If the parent was another FiberInstance it already has a Fiber.\r\n\r\nThere might be need for always tracking all Instances whether they're filtered or not or just moving filtering to the frontend but for now I'm keeping the general architecture as is.",
        "completion": [
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -146,6 +146,7 @@ import {formatOwnerStack} from '../shared/DevToolsOwnerStack';\n // Kinds\n const FIBER_INSTANCE = 0;\n const VIRTUAL_INSTANCE = 1;\n+const FILTERED_FIBER_INSTANCE = 2;\n \n // Flags\n const FORCE_SUSPENSE_FALLBACK = /*    */ 0b001;\n@@ -157,9 +158,9 @@ const FORCE_ERROR_RESET = /*          */ 0b100;\n type FiberInstance = {\n   kind: 0,\n   id: number,\n-  parent: null | DevToolsInstance, // filtered parent, including virtual\n-  firstChild: null | DevToolsInstance, // filtered first child, including virtual\n-  nextSibling: null | DevToolsInstance, // filtered next sibling, including virtual\n+  parent: null | DevToolsInstance,\n+  firstChild: null | DevToolsInstance,\n+  nextSibling: null | DevToolsInstance,\n   flags: number, // Force Error/Suspense\n   source: null | string | Error | Source, // source location of this component function, or owned child stack\n   errors: null | Map<string, number>, // error messages and count\n@@ -184,6 +185,39 @@ function createFiberInstance(fiber: Fiber): FiberInstance {\n   };\n }\n \n+type FilteredFiberInstance = {\n+  kind: 2,\n+  // We exclude id from the type to get errors if we try to access it.\n+  // However it is still in the object to preserve hidden class.\n+  // id: number,\n+  parent: null | DevToolsInstance,\n+  firstChild: null | DevToolsInstance,\n+  nextSibling: null | DevToolsInstance,\n+  flags: number, // Force Error/Suspense\n+  source: null | string | Error | Source, // always null here.\n+  errors: null, // error messages and count\n+  warnings: null, // warning messages and count\n+  treeBaseDuration: number, // the profiled time of the last render of this subtree\n+  data: Fiber, // one of a Fiber pair\n+};\n+\n+// This is used to represent a filtered Fiber but still lets us find its host instance.\n+function createFilteredFiberInstance(fiber: Fiber): FilteredFiberInstance {\n+  return ({\n+    kind: FILTERED_FIBER_INSTANCE,\n+    id: 0,\n+    parent: null,\n+    firstChild: null,\n+    nextSibling: null,\n+    flags: 0,\n+    componentStack: null,\n+    errors: null,\n+    warnings: null,\n+    treeBaseDuration: 0,\n+    data: fiber,\n+  }: any);\n+}\n+\n // This type represents a stateful instance of a Server Component or a Component\n // that gets optimized away - e.g. call-through without creating a Fiber.\n // It's basically a virtual Fiber. This is not a semantic concept in React.\n@@ -192,9 +226,9 @@ function createFiberInstance(fiber: Fiber): FiberInstance {\n type VirtualInstance = {\n   kind: 1,\n   id: number,\n-  parent: null | DevToolsInstance, // filtered parent, including virtual\n-  firstChild: null | DevToolsInstance, // filtered first child, including virtual\n-  nextSibling: null | DevToolsInstance, // filtered next sibling, including virtual\n+  parent: null | DevToolsInstance,\n+  firstChild: null | DevToolsInstance,\n+  nextSibling: null | DevToolsInstance,\n   flags: number,\n   source: null | string | Error | Source, // source location of this server component, or owned child stack\n   // Errors and Warnings happen per ReactComponentInfo which can appear in\n@@ -226,7 +260,7 @@ function createVirtualInstance(\n   };\n }\n \n-type DevToolsInstance = FiberInstance | VirtualInstance;\n+type DevToolsInstance = FiberInstance | VirtualInstance | FilteredFiberInstance;\n \n type getDisplayNameForFiberType = (fiber: Fiber) => string | null;\n type getTypeSymbolType = (type: any) => symbol | number;\n@@ -736,7 +770,8 @@ const fiberToFiberInstanceMap: Map<Fiber, FiberInstance> = new Map();\n // Map of id to one (arbitrary) Fiber in a pair.\n // This Map is used to e.g. get the display name for a Fiber or schedule an update,\n // operations that should be the same whether the current and work-in-progress Fiber is used.\n-const idToDevToolsInstanceMap: Map<number, DevToolsInstance> = new Map();\n+const idToDevToolsInstanceMap: Map<number, FiberInstance | VirtualInstance> =\n+  new Map();\n \n // Map of canonical HostInstances to the nearest parent DevToolsInstance.\n const publicInstanceToDevToolsInstanceMap: Map<HostInstance, DevToolsInstance> =\n@@ -1141,13 +1176,22 @@ export function attach(\n   function debugTree(instance: DevToolsInstance, indent: number = 0) {\n     if (__DEBUG__) {\n       const name =\n-        (instance.kind === FIBER_INSTANCE\n+        (instance.kind !== VIRTUAL_INSTANCE\n           ? getDisplayNameForFiber(instance.data)\n           : instance.data.name) || '';\n       console.log(\n-        '  '.repeat(indent) + '- ' + instance.id + ' (' + name + ')',\n+        '  '.repeat(indent) +\n+          '- ' +\n+          (instance.kind === FILTERED_FIBER_INSTANCE ? 0 : instance.id) +\n+          ' (' +\n+          name +\n+          ')',\n         'parent',\n-        instance.parent === null ? ' ' : instance.parent.id,\n+        instance.parent === null\n+          ? ' '\n+          : instance.parent.kind === FILTERED_FIBER_INSTANCE\n+            ? 0\n+            : instance.parent.id,\n         'next',\n         instance.nextSibling === null ? ' ' : instance.nextSibling.id,\n       );\n@@ -2264,7 +2308,12 @@ export function attach(\n         ownerInstance.source = fiber._debugStack;\n       }\n       const ownerID = ownerInstance === null ? 0 : ownerInstance.id;\n-      const parentID = parentInstance ? parentInstance.id : 0;\n+      const parentID = parentInstance\n+        ? parentInstance.kind === FILTERED_FIBER_INSTANCE\n+          ? // A Filtered Fiber Instance will always have a Virtual Instance as a parent.\n+            ((parentInstance.parent: any): VirtualInstance).id\n+          : parentInstance.id\n+        : 0;\n \n       const displayNameStringID = getStringID(displayName);\n \n@@ -2348,7 +2397,12 @@ export function attach(\n       ownerInstance.source = componentInfo.debugStack;\n     }\n     const ownerID = ownerInstance === null ? 0 : ownerInstance.id;\n-    const parentID = parentInstance ? parentInstance.id : 0;\n+    const parentID = parentInstance\n+      ? parentInstance.kind === FILTERED_FIBER_INSTANCE\n+        ? // A Filtered Fiber Instance will always have a Virtual Instance as a parent.\n+          ((parentInstance.parent: any): VirtualInstance).id\n+        : parentInstance.id\n+      : 0;\n \n     const displayNameStringID = getStringID(displayName);\n \n@@ -2713,6 +2767,14 @@ export function attach(\n     if (shouldIncludeInTree) {\n       newInstance = recordMount(fiber, reconcilingParent);\n       insertChild(newInstance);\n+    } else if (\n+      reconcilingParent !== null &&\n+      reconcilingParent.kind === VIRTUAL_INSTANCE\n+    ) {\n+      // If the parent is a Virtual Instance and we filtered this Fiber we include a\n+      // hidden node.\n+      newInstance = createFilteredFiberInstance(fiber);\n+      insertChild(newInstance);\n     }\n \n     // If we have the tree selection from previous reload, try to match this Fiber.\n@@ -2725,7 +2787,7 @@ export function attach(\n     const stashedParent = reconcilingParent;\n     const stashedPrevious = previouslyReconciledSibling;\n     const stashedRemaining = remainingReconcilingChildren;\n-    if (shouldIncludeInTree) {\n+    if (newInstance !== null) {\n       // Push a new DevTools instance parent while reconciling this subtree.\n       reconcilingParent = newInstance;\n       previouslyReconciledSibling = null;\n@@ -2810,7 +2872,7 @@ export function attach(\n         }\n       }\n     } finally {\n-      if (shouldIncludeInTree) {\n+      if (newInstance !== null) {\n         reconcilingParent = stashedParent;\n         previouslyReconciledSibling = stashedPrevious;\n         remainingReconcilingChildren = stashedRemaining;\n@@ -2850,8 +2912,10 @@ export function attach(\n     }\n     if (instance.kind === FIBER_INSTANCE) {\n       recordUnmount(instance);\n-    } else {\n+    } else if (instance.kind === VIRTUAL_INSTANCE) {\n       recordVirtualUnmount(instance);\n+    } else {\n+      untrackFiber(instance, instance.data);\n     }\n     removeChild(instance, null);\n   }\n@@ -2956,7 +3020,9 @@ export function attach(\n     virtualInstance.treeBaseDuration = treeBaseDuration;\n   }\n \n-  function recordResetChildren(parentInstance: DevToolsInstance) {\n+  function recordResetChildren(\n+    parentInstance: FiberInstance | VirtualInstance,\n+  ) {\n     if (__DEBUG__) {\n       if (\n         parentInstance.firstChild !== null &&\n@@ -2976,7 +3042,17 @@ export function attach(\n \n     let child: null | DevToolsInstance = parentInstance.firstChild;\n     while (child !== null) {\n-      nextChildren.push(child.id);\n+      if (child.kind === FILTERED_FIBER_INSTANCE) {\n+        for (\n+          let innerChild: null | DevToolsInstance = parentInstance.firstChild;\n+          innerChild !== null;\n+          innerChild = innerChild.nextSibling\n+        ) {\n+          nextChildren.push((innerChild: any).id);\n+        }\n+      } else {\n+        nextChildren.push(child.id);\n+      }\n       child = child.nextSibling;\n     }\n \n@@ -3788,7 +3864,7 @@ export function attach(\n     devtoolsInstance: DevToolsInstance,\n     hostInstances: Array<HostInstance>,\n   ) {\n-    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n+    if (devtoolsInstance.kind !== VIRTUAL_INSTANCE) {\n       const fiber = devtoolsInstance.data;\n       appendHostInstancesByFiber(fiber, hostInstances);\n       return;\n@@ -3889,6 +3965,10 @@ export function attach(\n   ): number | null {\n     const instance = publicInstanceToDevToolsInstanceMap.get(publicInstance);\n     if (instance !== undefined) {\n+      if (instance.kind === FILTERED_FIBER_INSTANCE) {\n+        // A Filtered Fiber Instance will always have a Virtual Instance as a parent.\n+        return ((instance.parent: any): VirtualInstance).id;\n+      }\n       return instance.id;\n     }\n     return null;\n@@ -3941,7 +4021,7 @@ export function attach(\n   }\n \n   function instanceToSerializedElement(\n-    instance: DevToolsInstance,\n+    instance: FiberInstance | VirtualInstance,\n   ): SerializedElement {\n     if (instance.kind === FIBER_INSTANCE) {\n       const fiber = instance.data;\n@@ -4036,7 +4116,7 @@ export function attach(\n   function findNearestOwnerInstance(\n     parentInstance: null | DevToolsInstance,\n     owner: void | null | ReactComponentInfo | Fiber,\n-  ): null | DevToolsInstance {\n+  ): null | FiberInstance | VirtualInstance {\n     if (owner == null) {\n       return null;\n     }\n@@ -4051,6 +4131,9 @@ export function attach(\n         // needs a duck type check anyway.\n         parentInstance.data === (owner: any).alternate\n       ) {\n+        if (parentInstance.kind === FILTERED_FIBER_INSTANCE) {\n+          return null;\n+        }\n         return parentInstance;\n       }\n       parentInstance = parentInstance.parent;\n@@ -4128,7 +4211,11 @@ export function attach(\n     if (devtoolsInstance.kind === VIRTUAL_INSTANCE) {\n       return inspectVirtualInstanceRaw(devtoolsInstance);\n     }\n-    return inspectFiberInstanceRaw(devtoolsInstance);\n+    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n+      return inspectFiberInstanceRaw(devtoolsInstance);\n+    }\n+    (devtoolsInstance: FilteredFiberInstance); // assert exhaustive\n+    throw new Error('Unsupported instance kind');\n   }\n \n   function inspectFiberInstanceRaw(\n@@ -4431,7 +4518,7 @@ export function attach(\n     let targetErrorBoundaryID = null;\n     let parent = virtualInstance.parent;\n     while (parent !== null) {\n-      if (parent.kind === FIBER_INSTANCE) {\n+      if (parent.kind !== VIRTUAL_INSTANCE) {\n         targetErrorBoundaryID = getNearestErrorBoundaryID(parent.data);\n         let current = parent.data;\n         while (current.return !== null) {\n@@ -5222,7 +5309,9 @@ export function attach(\n   ) {\n     // We don't need to convert milliseconds to microseconds in this case,\n     // because the profiling summary is JSON serialized.\n-    target.push([instance.id, instance.treeBaseDuration]);\n+    if (instance.kind !== FILTERED_FIBER_INSTANCE) {\n+      target.push([instance.id, instance.treeBaseDuration]);\n+    }\n     for (\n       let child = instance.firstChild;\n       child !== null;\n@@ -5436,7 +5525,7 @@ export function attach(\n   // In that case, we'll do some extra checks for matching mounts.\n   let trackedPath: Array<PathFrame> | null = null;\n   let trackedPathMatchFiber: Fiber | null = null; // This is the deepest unfiltered match of a Fiber.\n-  let trackedPathMatchInstance: DevToolsInstance | null = null; // This is the deepest matched filtered Instance.\n+  let trackedPathMatchInstance: FiberInstance | VirtualInstance | null = null; // This is the deepest matched filtered Instance.\n   let trackedPathMatchDepth = -1;\n   let mightBeOnTrackedPath = false;\n \n@@ -5455,7 +5544,7 @@ export function attach(\n   // The return value signals whether we should keep matching siblings or not.\n   function updateTrackedPathStateBeforeMount(\n     fiber: Fiber,\n-    fiberInstance: null | FiberInstance,\n+    fiberInstance: null | FiberInstance | FilteredFiberInstance,\n   ): boolean {\n     if (trackedPath === null || !mightBeOnTrackedPath) {\n       // Fast path: there's nothing to track so do nothing and ignore siblings.\n@@ -5484,7 +5573,7 @@ export function attach(\n       ) {\n         // We have our next match.\n         trackedPathMatchFiber = fiber;\n-        if (fiberInstance !== null) {\n+        if (fiberInstance !== null && fiberInstance.kind === FIBER_INSTANCE) {\n           trackedPathMatchInstance = fiberInstance;\n         }\n         trackedPathMatchDepth++;"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -2773,6 +2773,17 @@ export function attach(\n     ) {\n       // If the parent is a Virtual Instance and we filtered this Fiber we include a\n       // hidden node.\n+\n+      if (\n+        reconcilingParent.data === fiber._debugOwner &&\n+        fiber._debugStack != null &&\n+        reconcilingParent.source === null\n+      ) {\n+        // The new Fiber is directly owned by the parent. Therefore somewhere on the\n+        // debugStack will be a stack frame inside parent that we can use as its soruce.\n+        reconcilingParent.source = fiber._debugStack;\n+      }\n+\n       newInstance = createFilteredFiberInstance(fiber);\n       insertChild(newInstance);\n     }"
            }
        ]
    },
    {
        "prompt": "issue: You declared it const but didn't assign it to a variable. | description: You declared it const but didn't assign it to a variable.\r\nSo I changed the way to declare variables with let.",
        "completion": [
            {
                "file": "scripts/flow/react-native-host-hooks.js",
                "git_diff": "@@ -47,21 +47,21 @@ declare module 'react-native/Libraries/ReactPrivate/ReactNativePrivateInterface'\n   ): boolean;\n   declare export function deepFreezeAndThrowOnMutationInDev<T>(obj: T): T;\n   declare export function flattenStyle(style: any): any;\n-  declare export const RCTEventEmitter: {\n+  declare export let RCTEventEmitter: {\n     register: (eventEmitter: mixed) => void,\n     ...\n   };\n-  declare export const TextInputState: {\n+  declare export let TextInputState: {\n     blurTextInput: (object: any) => void,\n     focusTextInput: (object: any) => void,\n     ...\n   };\n-  declare export const ReactFiberErrorDialog: {\n+  declare export let ReactFiberErrorDialog: {\n     showErrorDialog: (error: __CapturedError) => boolean,\n     ...\n   };\n-  declare export const Platform: {OS: string, ...};\n-  declare export const UIManager: {\n+  declare export let Platform: {OS: string, ...};\n+  declare export let UIManager: {\n     customBubblingEventTypes: Object,\n     customDirectEventTypes: Object,\n     createView: (\n@@ -121,23 +121,23 @@ declare module 'react-native/Libraries/ReactPrivate/ReactNativePrivateInterface'\n     ) => void,\n     ...\n   };\n-  declare export const legacySendAccessibilityEvent: (\n+  declare export let legacySendAccessibilityEvent: (\n     reactTag: number,\n     eventTypeName: string,\n   ) => void;\n-  declare export const BatchedBridge: {\n+  declare export let BatchedBridge: {\n     registerCallableModule: (name: string, module: Object) => void,\n     ...\n   };\n-  declare export const ReactNativeViewConfigRegistry: {\n+  declare export let ReactNativeViewConfigRegistry: {\n     customBubblingEventTypes: Object,\n     customDirectEventTypes: Object,\n \n     register: (name: string, callback: __ViewConfigGetter) => string,\n     get: (name: string) => __ReactNativeBaseComponentViewConfig,\n     ...\n   };\n-  declare export const RawEventEmitter: {\n+  declare export let RawEventEmitter: {\n     emit: (channel: string, event: RawEventEmitterEvent) => string,\n     ...\n   };\n@@ -166,12 +166,12 @@ declare module 'react-native/Libraries/ReactPrivate/ReactNativePrivateInitialize\n }\n \n // eslint-disable-next-line no-unused-vars\n-declare const RN$enableMicrotasksInReact: boolean;\n+declare let RN$enableMicrotasksInReact: boolean;\n \n // This is needed for a short term solution.\n // See https://github.com/facebook/react/pull/15490 for more info\n // eslint-disable-next-line no-unused-vars\n-declare const nativeFabricUIManager: {\n+declare let nativeFabricUIManager: {\n   createNode: (\n     reactTag: number,\n     viewName: string,"
            }
        ]
    },
    {
        "prompt": "issue: [compiler] Override type provider for hook-like names | description: Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom):\n* __->__ #30868\n\nIf an imported name is hook-like but a type provider provides a non-hook type, we now override the returned value and treat it as a generic custom hook. This is meant as an extra check to prevent miscompilation.",
        "completion": [
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts",
                "git_diff": "@@ -33,6 +33,8 @@ import {\n   Type,\n   ValidatedIdentifier,\n   ValueKind,\n+  getHookKind,\n+  getHookKindForType,\n   makeBlockId,\n   makeIdentifierId,\n   makeIdentifierName,\n@@ -788,14 +790,9 @@ export class Environment {\n           );\n         } else {\n           const moduleType = this.#resolveModuleType(binding.module, loc);\n+          let propertyType: Type | null = null;\n           if (moduleType !== null) {\n-            const importedType = this.getPropertyType(\n-              moduleType,\n-              binding.imported,\n-            );\n-            if (importedType != null) {\n-              return importedType;\n-            }\n+            propertyType = this.getPropertyType(moduleType, binding.imported);\n           }\n \n           /**\n@@ -806,9 +803,18 @@ export class Environment {\n            * `import {useHook as foo} ...`\n            * `import {foo as useHook} ...`\n            */\n-          return isHookName(binding.imported) || isHookName(binding.name)\n-            ? this.#getCustomHookType()\n-            : null;\n+          const expectHook =\n+            isHookName(binding.imported) || isHookName(binding.name);\n+          if (expectHook) {\n+            if (\n+              propertyType &&\n+              getHookKindForType(this, propertyType) !== null\n+            ) {\n+              return propertyType;\n+            }\n+            return this.#getCustomHookType();\n+          }\n+          return propertyType;\n         }\n       }\n       case 'ImportDefault':\n@@ -821,17 +827,27 @@ export class Environment {\n           );\n         } else {\n           const moduleType = this.#resolveModuleType(binding.module, loc);\n+          let importedType: Type | null = null;\n           if (moduleType !== null) {\n             if (binding.kind === 'ImportDefault') {\n               const defaultType = this.getPropertyType(moduleType, 'default');\n               if (defaultType !== null) {\n-                return defaultType;\n+                importedType = defaultType;\n               }\n             } else {\n-              return moduleType;\n+              importedType = moduleType;\n+            }\n+          }\n+          if (isHookName(binding.name)) {\n+            if (\n+              importedType !== null &&\n+              getHookKindForType(this, importedType) !== null\n+            ) {\n+              return importedType;\n             }\n+            return this.#getCustomHookType();\n           }\n-          return isHookName(binding.name) ? this.#getCustomHookType() : null;\n+          return importedType;\n         }\n       }\n     }"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-hooklike-name-not-typed-as-hook-import.expect.md",
                "git_diff": "@@ -0,0 +1,123 @@\n+\n+## Input\n+\n+```javascript\n+import {useMemo} from 'react';\n+import {\n+  useArrayConcatNotTypedAsHook,\n+  ValidateMemoization,\n+} from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const item1 = useMemo(() => [a], [a]);\n+  const item2 = useMemo(() => [b], [b]);\n+  const item3 = useArrayConcatNotTypedAsHook(item1, item2);\n+\n+  return (\n+    <>\n+      <ValidateMemoization inputs={[a, b]} output={item3} />\n+    </>\n+  );\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\";\n+import { useMemo } from \"react\";\n+import {\n+  useArrayConcatNotTypedAsHook,\n+  ValidateMemoization,\n+} from \"shared-runtime\";\n+\n+export function Component(t0) {\n+  const $ = _c(10);\n+  const { a, b } = t0;\n+  let t1;\n+  let t2;\n+  if ($[0] !== a) {\n+    t2 = [a];\n+    $[0] = a;\n+    $[1] = t2;\n+  } else {\n+    t2 = $[1];\n+  }\n+  t1 = t2;\n+  const item1 = t1;\n+  let t3;\n+  let t4;\n+  if ($[2] !== b) {\n+    t4 = [b];\n+    $[2] = b;\n+    $[3] = t4;\n+  } else {\n+    t4 = $[3];\n+  }\n+  t3 = t4;\n+  const item2 = t3;\n+  const item3 = useArrayConcatNotTypedAsHook(item1, item2);\n+  let t5;\n+  if ($[4] !== a || $[5] !== b) {\n+    t5 = [a, b];\n+    $[4] = a;\n+    $[5] = b;\n+    $[6] = t5;\n+  } else {\n+    t5 = $[6];\n+  }\n+  let t6;\n+  if ($[7] !== t5 || $[8] !== item3) {\n+    t6 = (\n+      <>\n+        <ValidateMemoization inputs={t5} output={item3} />\n+      </>\n+    );\n+    $[7] = t5;\n+    $[8] = item3;\n+    $[9] = t6;\n+  } else {\n+    t6 = $[9];\n+  }\n+  return t6;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{ a: 0, b: 0 }],\n+  sequentialRenders: [\n+    { a: 0, b: 0 },\n+    { a: 1, b: 0 },\n+    { a: 1, b: 1 },\n+    { a: 1, b: 2 },\n+    { a: 2, b: 2 },\n+    { a: 3, b: 2 },\n+    { a: 0, b: 0 },\n+  ],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) <div>{\"inputs\":[0,0],\"output\":[0,0]}</div>\n+<div>{\"inputs\":[1,0],\"output\":[1,0]}</div>\n+<div>{\"inputs\":[1,1],\"output\":[1,1]}</div>\n+<div>{\"inputs\":[1,2],\"output\":[1,2]}</div>\n+<div>{\"inputs\":[2,2],\"output\":[2,2]}</div>\n+<div>{\"inputs\":[3,2],\"output\":[3,2]}</div>\n+<div>{\"inputs\":[0,0],\"output\":[0,0]}</div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-hooklike-name-not-typed-as-hook-import.tsx",
                "git_diff": "@@ -0,0 +1,31 @@\n+import {useMemo} from 'react';\n+import {\n+  useArrayConcatNotTypedAsHook,\n+  ValidateMemoization,\n+} from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const item1 = useMemo(() => [a], [a]);\n+  const item2 = useMemo(() => [b], [b]);\n+  const item3 = useArrayConcatNotTypedAsHook(item1, item2);\n+\n+  return (\n+    <>\n+      <ValidateMemoization inputs={[a, b]} output={item3} />\n+    </>\n+  );\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-import-object-typed-module-as-hook-name.expect.md",
                "git_diff": "@@ -0,0 +1,110 @@\n+\n+## Input\n+\n+```javascript\n+import {useMemo} from 'react';\n+import useHook from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const item1 = useMemo(() => ({a}), [a]);\n+  const item2 = useMemo(() => ({b}), [b]);\n+  useHook(item1, item2);\n+\n+  return (\n+    <>\n+      <ValidateMemoization inputs={[a]} output={item1} />\n+      <ValidateMemoization inputs={[b]} output={item2} />\n+    </>\n+  );\n+}\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\";\n+import { useMemo } from \"react\";\n+import useHook from \"shared-runtime\";\n+\n+export function Component(t0) {\n+  const $ = _c(17);\n+  const { a, b } = t0;\n+  let t1;\n+  let t2;\n+  if ($[0] !== a) {\n+    t2 = { a };\n+    $[0] = a;\n+    $[1] = t2;\n+  } else {\n+    t2 = $[1];\n+  }\n+  t1 = t2;\n+  const item1 = t1;\n+  let t3;\n+  let t4;\n+  if ($[2] !== b) {\n+    t4 = { b };\n+    $[2] = b;\n+    $[3] = t4;\n+  } else {\n+    t4 = $[3];\n+  }\n+  t3 = t4;\n+  const item2 = t3;\n+  useHook(item1, item2);\n+  let t5;\n+  if ($[4] !== a) {\n+    t5 = [a];\n+    $[4] = a;\n+    $[5] = t5;\n+  } else {\n+    t5 = $[5];\n+  }\n+  let t6;\n+  if ($[6] !== t5 || $[7] !== item1) {\n+    t6 = <ValidateMemoization inputs={t5} output={item1} />;\n+    $[6] = t5;\n+    $[7] = item1;\n+    $[8] = t6;\n+  } else {\n+    t6 = $[8];\n+  }\n+  let t7;\n+  if ($[9] !== b) {\n+    t7 = [b];\n+    $[9] = b;\n+    $[10] = t7;\n+  } else {\n+    t7 = $[10];\n+  }\n+  let t8;\n+  if ($[11] !== t7 || $[12] !== item2) {\n+    t8 = <ValidateMemoization inputs={t7} output={item2} />;\n+    $[11] = t7;\n+    $[12] = item2;\n+    $[13] = t8;\n+  } else {\n+    t8 = $[13];\n+  }\n+  let t9;\n+  if ($[14] !== t6 || $[15] !== t8) {\n+    t9 = (\n+      <>\n+        {t6}\n+        {t8}\n+      </>\n+    );\n+    $[14] = t6;\n+    $[15] = t8;\n+    $[16] = t9;\n+  } else {\n+    t9 = $[16];\n+  }\n+  return t9;\n+}\n+\n+```\n+      \n+### Eval output\n+(kind: exception) Fixture not implemented\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-import-object-typed-module-as-hook-name.js",
                "git_diff": "@@ -0,0 +1,15 @@\n+import {useMemo} from 'react';\n+import useHook from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const item1 = useMemo(() => ({a}), [a]);\n+  const item2 = useMemo(() => ({b}), [b]);\n+  useHook(item1, item2);\n+\n+  return (\n+    <>\n+      <ValidateMemoization inputs={[a]} output={item1} />\n+      <ValidateMemoization inputs={[b]} output={item2} />\n+    </>\n+  );\n+}"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-unknown-import-from-typed-module.expect.md",
                "git_diff": "@@ -0,0 +1,144 @@\n+\n+## Input\n+\n+```javascript\n+import {useMemo} from 'react';\n+import {useHoook, ValidateMemoization} from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const item1 = useMemo(() => ({a}), [a]);\n+  const item2 = useMemo(() => ({b}), [b]);\n+  useHook(item1, item2);\n+\n+  return (\n+    <>\n+      <ValidateMemoization inputs={[a]} output={item1} />\n+      <ValidateMemoization inputs={[b]} output={item2} />\n+    </>\n+  );\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\";\n+import { useMemo } from \"react\";\n+import { useHoook, ValidateMemoization } from \"shared-runtime\";\n+\n+export function Component(t0) {\n+  const $ = _c(17);\n+  const { a, b } = t0;\n+  let t1;\n+  let t2;\n+  if ($[0] !== a) {\n+    t2 = { a };\n+    $[0] = a;\n+    $[1] = t2;\n+  } else {\n+    t2 = $[1];\n+  }\n+  t1 = t2;\n+  const item1 = t1;\n+  let t3;\n+  let t4;\n+  if ($[2] !== b) {\n+    t4 = { b };\n+    $[2] = b;\n+    $[3] = t4;\n+  } else {\n+    t4 = $[3];\n+  }\n+  t3 = t4;\n+  const item2 = t3;\n+  useHook(item1, item2);\n+  let t5;\n+  if ($[4] !== a) {\n+    t5 = [a];\n+    $[4] = a;\n+    $[5] = t5;\n+  } else {\n+    t5 = $[5];\n+  }\n+  let t6;\n+  if ($[6] !== t5 || $[7] !== item1) {\n+    t6 = <ValidateMemoization inputs={t5} output={item1} />;\n+    $[6] = t5;\n+    $[7] = item1;\n+    $[8] = t6;\n+  } else {\n+    t6 = $[8];\n+  }\n+  let t7;\n+  if ($[9] !== b) {\n+    t7 = [b];\n+    $[9] = b;\n+    $[10] = t7;\n+  } else {\n+    t7 = $[10];\n+  }\n+  let t8;\n+  if ($[11] !== t7 || $[12] !== item2) {\n+    t8 = <ValidateMemoization inputs={t7} output={item2} />;\n+    $[11] = t7;\n+    $[12] = item2;\n+    $[13] = t8;\n+  } else {\n+    t8 = $[13];\n+  }\n+  let t9;\n+  if ($[14] !== t6 || $[15] !== t8) {\n+    t9 = (\n+      <>\n+        {t6}\n+        {t8}\n+      </>\n+    );\n+    $[14] = t6;\n+    $[15] = t8;\n+    $[16] = t9;\n+  } else {\n+    t9 = $[16];\n+  }\n+  return t9;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{ a: 0, b: 0 }],\n+  sequentialRenders: [\n+    { a: 0, b: 0 },\n+    { a: 1, b: 0 },\n+    { a: 1, b: 1 },\n+    { a: 1, b: 2 },\n+    { a: 2, b: 2 },\n+    { a: 3, b: 2 },\n+    { a: 0, b: 0 },\n+  ],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) [[ (exception in render) ReferenceError: useHook is not defined ]]\n+[[ (exception in render) ReferenceError: useHook is not defined ]]\n+[[ (exception in render) ReferenceError: useHook is not defined ]]\n+[[ (exception in render) ReferenceError: useHook is not defined ]]\n+[[ (exception in render) ReferenceError: useHook is not defined ]]\n+[[ (exception in render) ReferenceError: useHook is not defined ]]\n+[[ (exception in render) ReferenceError: useHook is not defined ]]\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-unknown-import-from-typed-module.js",
                "git_diff": "@@ -0,0 +1,29 @@\n+import {useMemo} from 'react';\n+import {useHoook, ValidateMemoization} from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const item1 = useMemo(() => ({a}), [a]);\n+  const item2 = useMemo(() => ({b}), [b]);\n+  useHook(item1, item2);\n+\n+  return (\n+    <>\n+      <ValidateMemoization inputs={[a]} output={item1} />\n+      <ValidateMemoization inputs={[b]} output={item2} />\n+    </>\n+  );\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};"
            },
            {
                "file": "compiler/packages/snap/src/sprout/shared-runtime-type-provider.ts",
                "git_diff": "@@ -48,6 +48,14 @@ export function makeSharedRuntimeTypeProvider({\n           returnType: {kind: 'type', name: 'Primitive'},\n           returnValueKind: ValueKindEnum.Primitive,\n         },\n+        useArrayConcatNotTypedAsHook: {\n+          kind: 'function',\n+          calleeEffect: EffectEnum.Read,\n+          positionalParams: [],\n+          restParam: EffectEnum.Capture,\n+          returnType: {kind: 'type', name: 'Array'},\n+          returnValueKind: ValueKindEnum.Primitive,\n+        },\n         useFreeze: {\n           kind: 'hook',\n           returnType: {kind: 'type', name: 'Any'},"
            },
            {
                "file": "compiler/packages/snap/src/sprout/shared-runtime.ts",
                "git_diff": "@@ -6,7 +6,7 @@\n  */\n \n import {IntlVariations, IntlViewerContext, init} from 'fbt';\n-import React, {FunctionComponent} from 'react';\n+import React, {FunctionComponent, useMemo} from 'react';\n \n /**\n  * This file is meant for use by `runner-evaluator` and fixture tests.\n@@ -355,4 +355,14 @@ export function typedArrayPush<T>(array: Array<T>, item: T): void {\n export function typedLog(...values: Array<any>): void {\n   console.log(...values);\n }\n+\n+export function useArrayConcatNotTypedAsHook<T>(\n+  array1: Array<T>,\n+  array2: Array<T>,\n+): Array<T> {\n+  return useMemo(() => {\n+    return [...array1, ...array2];\n+  }, [array1, array2]);\n+}\n+\n export default typedLog;"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/HIR/Environment.ts",
                "git_diff": "@@ -33,7 +33,6 @@ import {\n   Type,\n   ValidatedIdentifier,\n   ValueKind,\n-  getHookKind,\n   getHookKindForType,\n   makeBlockId,\n   makeIdentifierId,"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-import-object-typed-module-as-hook-name.expect.md",
                "git_diff": "@@ -18,6 +18,20 @@ export function Component({a, b}) {\n   );\n }\n \n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};\n+\n ```\n \n ## Code\n@@ -104,7 +118,28 @@ export function Component(t0) {\n   return t9;\n }\n \n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{ a: 0, b: 0 }],\n+  sequentialRenders: [\n+    { a: 0, b: 0 },\n+    { a: 1, b: 0 },\n+    { a: 1, b: 1 },\n+    { a: 1, b: 2 },\n+    { a: 2, b: 2 },\n+    { a: 3, b: 2 },\n+    { a: 0, b: 0 },\n+  ],\n+};\n+\n ```\n       \n ### Eval output\n-(kind: exception) Fixture not implemented\n\\ No newline at end of file\n+(kind: ok) [[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n+[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n+[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n+[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n+[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n+[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n+[[ (exception in render) ReferenceError: ValidateMemoization is not defined ]]\n+logs: [{ a: 0 },{ b: 0 },{ a: 0 },{ b: 0 },{ a: 1 },{ b: 1 },{ a: 1 },{ b: 2 },{ a: 2 },{ b: 2 },{ a: 3 },{ b: 2 },{ a: 0 },{ b: 0 }]\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-import-object-typed-module-as-hook-name.js",
                "git_diff": "@@ -13,3 +13,17 @@ export function Component({a, b}) {\n     </>\n   );\n }\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-unknown-import-from-typed-module.expect.md",
                "git_diff": "@@ -3,7 +3,7 @@\n \n ```javascript\n import {useMemo} from 'react';\n-import {useHoook, ValidateMemoization} from 'shared-runtime';\n+import {useHook, ValidateMemoization} from 'shared-runtime';\n \n export function Component({a, b}) {\n   const item1 = useMemo(() => ({a}), [a]);\n@@ -39,7 +39,7 @@ export const FIXTURE_ENTRYPOINT = {\n ```javascript\n import { c as _c } from \"react/compiler-runtime\";\n import { useMemo } from \"react\";\n-import { useHoook, ValidateMemoization } from \"shared-runtime\";\n+import { useHook, ValidateMemoization } from \"shared-runtime\";\n \n export function Component(t0) {\n   const $ = _c(17);\n@@ -135,10 +135,10 @@ export const FIXTURE_ENTRYPOINT = {\n ```\n       \n ### Eval output\n-(kind: ok) [[ (exception in render) ReferenceError: useHook is not defined ]]\n-[[ (exception in render) ReferenceError: useHook is not defined ]]\n-[[ (exception in render) ReferenceError: useHook is not defined ]]\n-[[ (exception in render) ReferenceError: useHook is not defined ]]\n-[[ (exception in render) ReferenceError: useHook is not defined ]]\n-[[ (exception in render) ReferenceError: useHook is not defined ]]\n-[[ (exception in render) ReferenceError: useHook is not defined ]]\n\\ No newline at end of file\n+(kind: ok) <div>{\"inputs\":[0],\"output\":{\"a\":0}}</div><div>{\"inputs\":[0],\"output\":{\"b\":0}}</div>\n+<div>{\"inputs\":[1],\"output\":{\"a\":1}}</div><div>{\"inputs\":[0],\"output\":{\"b\":0}}</div>\n+<div>{\"inputs\":[1],\"output\":{\"a\":1}}</div><div>{\"inputs\":[1],\"output\":{\"b\":1}}</div>\n+<div>{\"inputs\":[1],\"output\":{\"a\":1}}</div><div>{\"inputs\":[2],\"output\":{\"b\":2}}</div>\n+<div>{\"inputs\":[2],\"output\":{\"a\":2}}</div><div>{\"inputs\":[2],\"output\":{\"b\":2}}</div>\n+<div>{\"inputs\":[3],\"output\":{\"a\":3}}</div><div>{\"inputs\":[2],\"output\":{\"b\":2}}</div>\n+<div>{\"inputs\":[0],\"output\":{\"a\":0}}</div><div>{\"inputs\":[0],\"output\":{\"b\":0}}</div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-unknown-import-from-typed-module.js",
                "git_diff": "@@ -1,5 +1,5 @@\n import {useMemo} from 'react';\n-import {useHoook, ValidateMemoization} from 'shared-runtime';\n+import {useHook, ValidateMemoization} from 'shared-runtime';\n \n export function Component({a, b}) {\n   const item1 = useMemo(() => ({a}), [a]);"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Inference/InferReferenceEffects.ts",
                "git_diff": "@@ -1180,18 +1180,6 @@ function inferBlock(\n         };\n         break;\n       }\n-      case 'TaggedTemplateExpression': {\n-        valueKind = {\n-          kind: ValueKind.Mutable,\n-          reason: new Set([ValueReason.Other]),\n-          context: new Set(),\n-        };\n-        effect = {\n-          kind: Effect.ConditionallyMutate,\n-          reason: ValueReason.Other,\n-        };\n-        break;\n-      }\n       case 'TemplateLiteral': {\n         /*\n          * template literal (with no tag function) always produces\n@@ -1312,6 +1300,47 @@ function inferBlock(\n         instr.lvalue.effect = Effect.Store;\n         continue;\n       }\n+      case 'TaggedTemplateExpression': {\n+        const operands = [...eachInstructionValueOperand(instrValue)];\n+        if (operands.length !== 1) {\n+          // future-proofing to make sure we update this case when we support interpolation\n+          CompilerError.throwTodo({\n+            reason: 'Support tagged template expressions with interpolations',\n+            loc: instrValue.loc,\n+          });\n+        }\n+        const signature = getFunctionCallSignature(\n+          env,\n+          instrValue.tag.identifier.type,\n+        );\n+        let calleeEffect =\n+          signature?.calleeEffect ?? Effect.ConditionallyMutate;\n+        const returnValueKind: AbstractValue =\n+          signature !== null\n+            ? {\n+                kind: signature.returnValueKind,\n+                reason: new Set([\n+                  signature.returnValueReason ??\n+                    ValueReason.KnownReturnSignature,\n+                ]),\n+                context: new Set(),\n+              }\n+            : {\n+                kind: ValueKind.Mutable,\n+                reason: new Set([ValueReason.Other]),\n+                context: new Set(),\n+              };\n+        state.referenceAndRecordEffects(\n+          instrValue.tag,\n+          calleeEffect,\n+          ValueReason.Other,\n+          functionEffects,\n+        );\n+        state.initialize(instrValue, returnValueKind);\n+        state.define(instr.lvalue, instrValue);\n+        instr.lvalue.effect = Effect.ConditionallyMutate;\n+        continue;\n+      }\n       case 'CallExpression': {\n         const signature = getFunctionCallSignature(\n           env,"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/InferReactiveScopeVariables.ts",
                "git_diff": "@@ -227,6 +227,7 @@ function mayAllocate(env: Environment, instruction: Instruction): boolean {\n     case 'StoreGlobal': {\n       return false;\n     }\n+    case 'TaggedTemplateExpression':\n     case 'CallExpression':\n     case 'MethodCall': {\n       return instruction.lvalue.identifier.type.kind !== 'Primitive';\n@@ -241,8 +242,7 @@ function mayAllocate(env: Environment, instruction: Instruction): boolean {\n     case 'ObjectExpression':\n     case 'UnsupportedNode':\n     case 'ObjectMethod':\n-    case 'FunctionExpression':\n-    case 'TaggedTemplateExpression': {\n+    case 'FunctionExpression': {\n       return true;\n     }\n     default: {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/ReactiveScopes/PruneNonEscapingScopes.ts",
                "git_diff": "@@ -671,12 +671,37 @@ function computeMemoizationInputs(\n         ],\n       };\n     }\n+    case 'TaggedTemplateExpression': {\n+      const signature = getFunctionCallSignature(\n+        env,\n+        value.tag.identifier.type,\n+      );\n+      let lvalues = [];\n+      if (lvalue !== null) {\n+        lvalues.push({place: lvalue, level: MemoizationLevel.Memoized});\n+      }\n+      if (signature?.noAlias === true) {\n+        return {\n+          lvalues,\n+          rvalues: [],\n+        };\n+      }\n+      const operands = [...eachReactiveValueOperand(value)];\n+      lvalues.push(\n+        ...operands\n+          .filter(operand => isMutableEffect(operand.effect, operand.loc))\n+          .map(place => ({place, level: MemoizationLevel.Memoized})),\n+      );\n+      return {\n+        lvalues,\n+        rvalues: operands,\n+      };\n+    }\n     case 'CallExpression': {\n       const signature = getFunctionCallSignature(\n         env,\n         value.callee.identifier.type,\n       );\n-      const operands = [...eachReactiveValueOperand(value)];\n       let lvalues = [];\n       if (lvalue !== null) {\n         lvalues.push({place: lvalue, level: MemoizationLevel.Memoized});\n@@ -687,6 +712,7 @@ function computeMemoizationInputs(\n           rvalues: [],\n         };\n       }\n+      const operands = [...eachReactiveValueOperand(value)];\n       lvalues.push(\n         ...operands\n           .filter(operand => isMutableEffect(operand.effect, operand.loc))\n@@ -702,7 +728,6 @@ function computeMemoizationInputs(\n         env,\n         value.property.identifier.type,\n       );\n-      const operands = [...eachReactiveValueOperand(value)];\n       let lvalues = [];\n       if (lvalue !== null) {\n         lvalues.push({place: lvalue, level: MemoizationLevel.Memoized});\n@@ -713,6 +738,7 @@ function computeMemoizationInputs(\n           rvalues: [],\n         };\n       }\n+      const operands = [...eachReactiveValueOperand(value)];\n       lvalues.push(\n         ...operands\n           .filter(operand => isMutableEffect(operand.effect, operand.loc))\n@@ -726,7 +752,6 @@ function computeMemoizationInputs(\n     case 'RegExpLiteral':\n     case 'ObjectMethod':\n     case 'FunctionExpression':\n-    case 'TaggedTemplateExpression':\n     case 'ArrayExpression':\n     case 'NewExpression':\n     case 'ObjectExpression':"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/TypeInference/InferTypes.ts",
                "git_diff": "@@ -250,6 +250,7 @@ function* generateInstructionTypes(\n     }\n \n     case 'CallExpression': {\n+      const returnType = makeType();\n       /*\n        * TODO: callee could be a hook or a function, so this type equation isn't correct.\n        * We should change Hook to a subtype of Function or change unifier logic.\n@@ -258,8 +259,25 @@ function* generateInstructionTypes(\n       yield equation(value.callee.identifier.type, {\n         kind: 'Function',\n         shapeId: null,\n-        return: left,\n+        return: returnType,\n       });\n+      yield equation(left, returnType);\n+      break;\n+    }\n+\n+    case 'TaggedTemplateExpression': {\n+      const returnType = makeType();\n+      /*\n+       * TODO: callee could be a hook or a function, so this type equation isn't correct.\n+       * We should change Hook to a subtype of Function or change unifier logic.\n+       * (see https://github.com/facebook/react-forget/pull/1427)\n+       */\n+      yield equation(value.tag.identifier.type, {\n+        kind: 'Function',\n+        shapeId: null,\n+        return: returnType,\n+      });\n+      yield equation(left, returnType);\n       break;\n     }\n \n@@ -392,7 +410,6 @@ function* generateInstructionTypes(\n     case 'MetaProperty':\n     case 'ComputedStore':\n     case 'ComputedLoad':\n-    case 'TaggedTemplateExpression':\n     case 'Await':\n     case 'GetIterator':\n     case 'IteratorNext':"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/Validation/ValidateLocalsNotReassignedAfterRender.ts",
                "git_diff": "@@ -161,6 +161,14 @@ function getContextReassignment(\n             if (signature?.noAlias) {\n               operands = [value.receiver, value.property];\n             }\n+          } else if (value.kind === 'TaggedTemplateExpression') {\n+            const signature = getFunctionCallSignature(\n+              fn.env,\n+              value.tag.identifier.type,\n+            );\n+            if (signature?.noAlias) {\n+              operands = [value.tag];\n+            }\n           }\n           for (const operand of operands) {\n             CompilerError.invariant(operand.effect !== Effect.Unknown, {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/destructuring-mixed-scope-and-local-variables-with-default.expect.md",
                "git_diff": "@@ -63,67 +63,63 @@ function useFragment(_arg1, _arg2) {\n }\n \n function Component(props) {\n-  const $ = _c(9);\n-  let t0;\n-  if ($[0] === Symbol.for(\"react.memo_cache_sentinel\")) {\n-    t0 = graphql`\n+  const $ = _c(8);\n+  const post = useFragment(\n+    graphql`\n       fragment F on T {\n         id\n       }\n-    `;\n-    $[0] = t0;\n-  } else {\n-    t0 = $[0];\n-  }\n-  const post = useFragment(t0, props.post);\n-  let t1;\n-  if ($[1] !== post) {\n+    `,\n+    props.post,\n+  );\n+  let t0;\n+  if ($[0] !== post) {\n     const allUrls = [];\n \n-    const { media: t2, comments: t3, urls: t4 } = post;\n-    const media = t2 === undefined ? null : t2;\n+    const { media: t1, comments: t2, urls: t3 } = post;\n+    const media = t1 === undefined ? null : t1;\n+    let t4;\n+    if ($[2] !== t2) {\n+      t4 = t2 === undefined ? [] : t2;\n+      $[2] = t2;\n+      $[3] = t4;\n+    } else {\n+      t4 = $[3];\n+    }\n+    const comments = t4;\n     let t5;\n-    if ($[3] !== t3) {\n+    if ($[4] !== t3) {\n       t5 = t3 === undefined ? [] : t3;\n-      $[3] = t3;\n-      $[4] = t5;\n+      $[4] = t3;\n+      $[5] = t5;\n     } else {\n-      t5 = $[4];\n+      t5 = $[5];\n     }\n-    const comments = t5;\n+    const urls = t5;\n     let t6;\n-    if ($[5] !== t4) {\n-      t6 = t4 === undefined ? [] : t4;\n-      $[5] = t4;\n-      $[6] = t6;\n-    } else {\n-      t6 = $[6];\n-    }\n-    const urls = t6;\n-    let t7;\n-    if ($[7] !== comments.length) {\n-      t7 = (e) => {\n+    if ($[6] !== comments.length) {\n+      t6 = (e) => {\n         if (!comments.length) {\n           return;\n         }\n \n         console.log(comments.length);\n       };\n-      $[7] = comments.length;\n-      $[8] = t7;\n+      $[6] = comments.length;\n+      $[7] = t6;\n     } else {\n-      t7 = $[8];\n+      t6 = $[7];\n     }\n-    const onClick = t7;\n+    const onClick = t6;\n \n     allUrls.push(...urls);\n-    t1 = <Stringify media={media} allUrls={allUrls} onClick={onClick} />;\n-    $[1] = post;\n-    $[2] = t1;\n+    t0 = <Stringify media={media} allUrls={allUrls} onClick={onClick} />;\n+    $[0] = post;\n+    $[1] = t0;\n   } else {\n-    t1 = $[2];\n+    t0 = $[1];\n   }\n-  return t1;\n+  return t0;\n }\n \n export const FIXTURE_ENTRYPOINT = {"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-tagged-template-expression.expect.md",
                "git_diff": "@@ -0,0 +1,106 @@\n+\n+## Input\n+\n+```javascript\n+import {graphql} from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const fragment = graphql`\n+    fragment Foo on User {\n+      name\n+    }\n+  `;\n+  return <div>{fragment}</div>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};\n+\n+```\n+\n+## Code\n+\n+```javascript\n+import { c as _c } from \"react/compiler-runtime\";\n+import { graphql } from \"shared-runtime\";\n+\n+export function Component(t0) {\n+  const $ = _c(1);\n+  const fragment = graphql`\n+    fragment Foo on User {\n+      name\n+    }\n+  `;\n+  let t1;\n+  if ($[0] === Symbol.for(\"react.memo_cache_sentinel\")) {\n+    t1 = <div>{fragment}</div>;\n+    $[0] = t1;\n+  } else {\n+    t1 = $[0];\n+  }\n+  return t1;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{ a: 0, b: 0 }],\n+  sequentialRenders: [\n+    { a: 0, b: 0 },\n+    { a: 1, b: 0 },\n+    { a: 1, b: 1 },\n+    { a: 1, b: 2 },\n+    { a: 2, b: 2 },\n+    { a: 3, b: 2 },\n+    { a: 0, b: 0 },\n+  ],\n+};\n+\n+```\n+      \n+### Eval output\n+(kind: ok) <div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n+<div>\n+    fragment Foo on User {\n+      name\n+    }\n+  </div>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/type-provider-tagged-template-expression.js",
                "git_diff": "@@ -0,0 +1,24 @@\n+import {graphql} from 'shared-runtime';\n+\n+export function Component({a, b}) {\n+  const fragment = graphql`\n+    fragment Foo on User {\n+      name\n+    }\n+  `;\n+  return <div>{fragment}</div>;\n+}\n+\n+export const FIXTURE_ENTRYPOINT = {\n+  fn: Component,\n+  params: [{a: 0, b: 0}],\n+  sequentialRenders: [\n+    {a: 0, b: 0},\n+    {a: 1, b: 0},\n+    {a: 1, b: 1},\n+    {a: 1, b: 2},\n+    {a: 2, b: 2},\n+    {a: 3, b: 2},\n+    {a: 0, b: 0},\n+  ],\n+};"
            },
            {
                "file": "compiler/packages/snap/src/sprout/shared-runtime-type-provider.ts",
                "git_diff": "@@ -32,6 +32,14 @@ export function makeSharedRuntimeTypeProvider({\n           returnType: {kind: 'type', name: 'Primitive'},\n           returnValueKind: ValueKindEnum.Primitive,\n         },\n+        graphql: {\n+          kind: 'function',\n+          calleeEffect: EffectEnum.Read,\n+          positionalParams: [],\n+          restParam: EffectEnum.Read,\n+          returnType: {kind: 'type', name: 'Primitive'},\n+          returnValueKind: ValueKindEnum.Primitive,\n+        },\n         typedArrayPush: {\n           kind: 'function',\n           calleeEffect: EffectEnum.Read,"
            },
            {
                "file": "packages/shared/ReactFeatureFlags.js",
                "git_diff": "@@ -134,7 +134,7 @@ export const alwaysThrottleRetries = true;\n \n export const passChildrenWhenCloningPersistedNodes = false;\n \n-export const enableServerComponentLogs = __EXPERIMENTAL__;\n+export const enableServerComponentLogs = true;\n \n /**\n  * Enables a new Fiber flag used in persisted mode to reduce the number"
            },
            {
                "file": "packages/react-cache/src/__tests__/ReactCacheOld-test.internal.js",
                "git_diff": "@@ -148,7 +148,15 @@ describe('ReactCache', () => {\n       error = e;\n     }\n     expect(error.message).toMatch('Failed to load: Hi');\n-    assertLog(['Promise rejected [Hi]', 'Error! [Hi]', 'Error! [Hi]']);\n+    assertLog([\n+      'Promise rejected [Hi]',\n+      'Error! [Hi]',\n+      'Error! [Hi]',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Error! [Hi]', 'Error! [Hi]']\n+        : []),\n+    ]);\n \n     // Should throw again on a subsequent read\n     root.render(<App />);\n@@ -191,6 +199,7 @@ describe('ReactCache', () => {\n     }\n   });\n \n+  // @gate enableSiblingPrerendering\n   it('evicts least recently used values', async () => {\n     ReactCache.unstable_setGlobalCacheLimit(3);\n \n@@ -206,15 +215,13 @@ describe('ReactCache', () => {\n     await waitForAll(['Suspend! [1]', 'Loading...']);\n     jest.advanceTimersByTime(100);\n     assertLog(['Promise resolved [1]']);\n-    await waitForAll([1, 'Suspend! [2]']);\n+    await waitForAll([1, 'Suspend! [2]', 1, 'Suspend! [2]', 'Suspend! [3]']);\n \n     jest.advanceTimersByTime(100);\n-    assertLog(['Promise resolved [2]']);\n-    await waitForAll([1, 2, 'Suspend! [3]']);\n+    assertLog(['Promise resolved [2]', 'Promise resolved [3]']);\n+    await waitForAll([1, 2, 3]);\n \n     await act(() => jest.advanceTimersByTime(100));\n-    assertLog(['Promise resolved [3]', 1, 2, 3]);\n-\n     expect(root).toMatchRenderedOutput('123');\n \n     // Render 1, 4, 5\n@@ -234,6 +241,9 @@ describe('ReactCache', () => {\n       1,\n       4,\n       'Suspend! [5]',\n+      1,\n+      4,\n+      'Suspend! [5]',\n       'Promise resolved [5]',\n       1,\n       4,\n@@ -267,6 +277,9 @@ describe('ReactCache', () => {\n       1,\n       2,\n       'Suspend! [3]',\n+      1,\n+      2,\n+      'Suspend! [3]',\n       'Promise resolved [3]',\n       1,\n       2,"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/utils.js",
                "git_diff": "@@ -284,6 +284,19 @@ export function createHOCFilter(isEnabled: boolean = true) {\n   };\n }\n \n+export function createEnvironmentNameFilter(\n+  env: string,\n+  isEnabled: boolean = true,\n+) {\n+  const Types = require('react-devtools-shared/src/frontend/types');\n+  return {\n+    type: Types.ComponentFilterEnvironmentName,\n+    isEnabled,\n+    isValid: true,\n+    value: env,\n+  };\n+}\n+\n export function createElementTypeFilter(\n   elementType: ElementType,\n   isEnabled: boolean = true,"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/agent.js",
                "git_diff": "@@ -220,6 +220,7 @@ export default class Agent extends EventEmitter<{\n       this.updateConsolePatchSettings,\n     );\n     bridge.addListener('updateComponentFilters', this.updateComponentFilters);\n+    bridge.addListener('getEnvironmentNames', this.getEnvironmentNames);\n \n     // Temporarily support older standalone front-ends sending commands to newer embedded backends.\n     // We do this because React Native embeds the React DevTools backend,\n@@ -341,84 +342,123 @@ export default class Agent extends EventEmitter<{\n   }\n \n   getIDForHostInstance(target: HostInstance): number | null {\n-    let bestMatch: null | HostInstance = null;\n-    let bestRenderer: null | RendererInterface = null;\n-    // Find the nearest ancestor which is mounted by a React.\n-    for (const rendererID in this._rendererInterfaces) {\n-      const renderer = ((this._rendererInterfaces[\n-        (rendererID: any)\n-      ]: any): RendererInterface);\n-      const nearestNode: null = renderer.getNearestMountedHostInstance(target);\n-      if (nearestNode !== null) {\n-        if (nearestNode === target) {\n-          // Exact match we can exit early.\n-          bestMatch = nearestNode;\n-          bestRenderer = renderer;\n-          break;\n+    if (isReactNativeEnvironment() || typeof target.nodeType !== 'number') {\n+      // In React Native or non-DOM we simply pick any renderer that has a match.\n+      for (const rendererID in this._rendererInterfaces) {\n+        const renderer = ((this._rendererInterfaces[\n+          (rendererID: any)\n+        ]: any): RendererInterface);\n+        try {\n+          const match = renderer.getElementIDForHostInstance(target);\n+          if (match != null) {\n+            return match;\n+          }\n+        } catch (error) {\n+          // Some old React versions might throw if they can't find a match.\n+          // If so we should ignore it...\n         }\n-        if (\n-          bestMatch === null ||\n-          (!isReactNativeEnvironment() && bestMatch.contains(nearestNode))\n-        ) {\n-          // If this is the first match or the previous match contains the new match,\n-          // so the new match is a deeper and therefore better match.\n-          bestMatch = nearestNode;\n-          bestRenderer = renderer;\n+      }\n+      return null;\n+    } else {\n+      // In the DOM we use a smarter mechanism to find the deepest a DOM node\n+      // that is registered if there isn't an exact match.\n+      let bestMatch: null | Element = null;\n+      let bestRenderer: null | RendererInterface = null;\n+      // Find the nearest ancestor which is mounted by a React.\n+      for (const rendererID in this._rendererInterfaces) {\n+        const renderer = ((this._rendererInterfaces[\n+          (rendererID: any)\n+        ]: any): RendererInterface);\n+        const nearestNode: null | Element = renderer.getNearestMountedDOMNode(\n+          (target: any),\n+        );\n+        if (nearestNode !== null) {\n+          if (nearestNode === target) {\n+            // Exact match we can exit early.\n+            bestMatch = nearestNode;\n+            bestRenderer = renderer;\n+            break;\n+          }\n+          if (bestMatch === null || bestMatch.contains(nearestNode)) {\n+            // If this is the first match or the previous match contains the new match,\n+            // so the new match is a deeper and therefore better match.\n+            bestMatch = nearestNode;\n+            bestRenderer = renderer;\n+          }\n         }\n       }\n-    }\n-    if (bestRenderer != null && bestMatch != null) {\n-      try {\n-        return bestRenderer.getElementIDForHostInstance(bestMatch, true);\n-      } catch (error) {\n-        // Some old React versions might throw if they can't find a match.\n-        // If so we should ignore it...\n+      if (bestRenderer != null && bestMatch != null) {\n+        try {\n+          return bestRenderer.getElementIDForHostInstance(bestMatch);\n+        } catch (error) {\n+          // Some old React versions might throw if they can't find a match.\n+          // If so we should ignore it...\n+        }\n       }\n+      return null;\n     }\n-    return null;\n   }\n \n   getComponentNameForHostInstance(target: HostInstance): string | null {\n     // We duplicate this code from getIDForHostInstance to avoid an object allocation.\n-    let bestMatch: null | HostInstance = null;\n-    let bestRenderer: null | RendererInterface = null;\n-    // Find the nearest ancestor which is mounted by a React.\n-    for (const rendererID in this._rendererInterfaces) {\n-      const renderer = ((this._rendererInterfaces[\n-        (rendererID: any)\n-      ]: any): RendererInterface);\n-      const nearestNode = renderer.getNearestMountedHostInstance(target);\n-      if (nearestNode !== null) {\n-        if (nearestNode === target) {\n-          // Exact match we can exit early.\n-          bestMatch = nearestNode;\n-          bestRenderer = renderer;\n-          break;\n+    if (isReactNativeEnvironment() || typeof target.nodeType !== 'number') {\n+      // In React Native or non-DOM we simply pick any renderer that has a match.\n+      for (const rendererID in this._rendererInterfaces) {\n+        const renderer = ((this._rendererInterfaces[\n+          (rendererID: any)\n+        ]: any): RendererInterface);\n+        try {\n+          const id = renderer.getElementIDForHostInstance(target);\n+          if (id) {\n+            return renderer.getDisplayNameForElementID(id);\n+          }\n+        } catch (error) {\n+          // Some old React versions might throw if they can't find a match.\n+          // If so we should ignore it...\n         }\n-        if (\n-          bestMatch === null ||\n-          (!isReactNativeEnvironment() && bestMatch.contains(nearestNode))\n-        ) {\n-          // If this is the first match or the previous match contains the new match,\n-          // so the new match is a deeper and therefore better match.\n-          bestMatch = nearestNode;\n-          bestRenderer = renderer;\n+      }\n+      return null;\n+    } else {\n+      // In the DOM we use a smarter mechanism to find the deepest a DOM node\n+      // that is registered if there isn't an exact match.\n+      let bestMatch: null | Element = null;\n+      let bestRenderer: null | RendererInterface = null;\n+      // Find the nearest ancestor which is mounted by a React.\n+      for (const rendererID in this._rendererInterfaces) {\n+        const renderer = ((this._rendererInterfaces[\n+          (rendererID: any)\n+        ]: any): RendererInterface);\n+        const nearestNode: null | Element = renderer.getNearestMountedDOMNode(\n+          (target: any),\n+        );\n+        if (nearestNode !== null) {\n+          if (nearestNode === target) {\n+            // Exact match we can exit early.\n+            bestMatch = nearestNode;\n+            bestRenderer = renderer;\n+            break;\n+          }\n+          if (bestMatch === null || bestMatch.contains(nearestNode)) {\n+            // If this is the first match or the previous match contains the new match,\n+            // so the new match is a deeper and therefore better match.\n+            bestMatch = nearestNode;\n+            bestRenderer = renderer;\n+          }\n         }\n       }\n-    }\n-\n-    if (bestRenderer != null && bestMatch != null) {\n-      try {\n-        const id = bestRenderer.getElementIDForHostInstance(bestMatch, true);\n-        if (id) {\n-          return bestRenderer.getDisplayNameForElementID(id);\n+      if (bestRenderer != null && bestMatch != null) {\n+        try {\n+          const id = bestRenderer.getElementIDForHostInstance(bestMatch);\n+          if (id) {\n+            return bestRenderer.getDisplayNameForElementID(id);\n+          }\n+        } catch (error) {\n+          // Some old React versions might throw if they can't find a match.\n+          // If so we should ignore it...\n         }\n-      } catch (error) {\n-        // Some old React versions might throw if they can't find a match.\n-        // If so we should ignore it...\n       }\n+      return null;\n     }\n-    return null;\n   }\n \n   getBackendVersion: () => void = () => {\n@@ -814,6 +854,24 @@ export default class Agent extends EventEmitter<{\n       }\n     };\n \n+  getEnvironmentNames: () => void = () => {\n+    let accumulatedNames = null;\n+    for (const rendererID in this._rendererInterfaces) {\n+      const renderer = this._rendererInterfaces[+rendererID];\n+      const names = renderer.getEnvironmentNames();\n+      if (accumulatedNames === null) {\n+        accumulatedNames = names;\n+      } else {\n+        for (let i = 0; i < names.length; i++) {\n+          if (accumulatedNames.indexOf(names[i]) === -1) {\n+            accumulatedNames.push(names[i]);\n+          }\n+        }\n+      }\n+    }\n+    this._bridge.send('environmentNames', accumulatedNames || []);\n+  };\n+\n   onTraceUpdates: (nodes: Set<HostInstance>) => void = nodes => {\n     this.emit('traceUpdates', nodes);\n   };"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/console.js",
                "git_diff": "@@ -135,17 +135,7 @@ export function registerRenderer(\n   renderer: ReactRenderer,\n   onErrorOrWarning?: OnErrorOrWarning,\n ): void {\n-  const {\n-    currentDispatcherRef,\n-    getCurrentFiber,\n-    findFiberByHostInstance,\n-    version,\n-  } = renderer;\n-\n-  // Ignore React v15 and older because they don't expose a component stack anyway.\n-  if (typeof findFiberByHostInstance !== 'function') {\n-    return;\n-  }\n+  const {currentDispatcherRef, getCurrentFiber, version} = renderer;\n \n   // currentDispatcherRef gets injected for v16.8+ to support hooks inspection.\n   // getCurrentFiber gets injected for v16.9+."
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -14,6 +14,7 @@ import {\n   ComponentFilterElementType,\n   ComponentFilterHOC,\n   ComponentFilterLocation,\n+  ComponentFilterEnvironmentName,\n   ElementTypeClass,\n   ElementTypeContext,\n   ElementTypeFunction,\n@@ -113,7 +114,7 @@ import {getStyleXData} from '../StyleX/utils';\n import {createProfilingHooks} from '../profilingHooks';\n \n import type {GetTimelineData, ToggleProfilingStatus} from '../profilingHooks';\n-import type {Fiber} from 'react-reconciler/src/ReactInternalTypes';\n+import type {Fiber, FiberRoot} from 'react-reconciler/src/ReactInternalTypes';\n import type {\n   ChangeDescription,\n   CommitDataBackend,\n@@ -145,6 +146,7 @@ import {formatOwnerStack} from '../shared/DevToolsOwnerStack';\n // Kinds\n const FIBER_INSTANCE = 0;\n const VIRTUAL_INSTANCE = 1;\n+const FILTERED_FIBER_INSTANCE = 2;\n \n // Flags\n const FORCE_SUSPENSE_FALLBACK = /*    */ 0b001;\n@@ -156,9 +158,9 @@ const FORCE_ERROR_RESET = /*          */ 0b100;\n type FiberInstance = {\n   kind: 0,\n   id: number,\n-  parent: null | DevToolsInstance, // filtered parent, including virtual\n-  firstChild: null | DevToolsInstance, // filtered first child, including virtual\n-  nextSibling: null | DevToolsInstance, // filtered next sibling, including virtual\n+  parent: null | DevToolsInstance,\n+  firstChild: null | DevToolsInstance,\n+  nextSibling: null | DevToolsInstance,\n   flags: number, // Force Error/Suspense\n   source: null | string | Error | Source, // source location of this component function, or owned child stack\n   errors: null | Map<string, number>, // error messages and count\n@@ -183,6 +185,39 @@ function createFiberInstance(fiber: Fiber): FiberInstance {\n   };\n }\n \n+type FilteredFiberInstance = {\n+  kind: 2,\n+  // We exclude id from the type to get errors if we try to access it.\n+  // However it is still in the object to preserve hidden class.\n+  // id: number,\n+  parent: null | DevToolsInstance,\n+  firstChild: null | DevToolsInstance,\n+  nextSibling: null | DevToolsInstance,\n+  flags: number, // Force Error/Suspense\n+  source: null | string | Error | Source, // always null here.\n+  errors: null, // error messages and count\n+  warnings: null, // warning messages and count\n+  treeBaseDuration: number, // the profiled time of the last render of this subtree\n+  data: Fiber, // one of a Fiber pair\n+};\n+\n+// This is used to represent a filtered Fiber but still lets us find its host instance.\n+function createFilteredFiberInstance(fiber: Fiber): FilteredFiberInstance {\n+  return ({\n+    kind: FILTERED_FIBER_INSTANCE,\n+    id: 0,\n+    parent: null,\n+    firstChild: null,\n+    nextSibling: null,\n+    flags: 0,\n+    componentStack: null,\n+    errors: null,\n+    warnings: null,\n+    treeBaseDuration: 0,\n+    data: fiber,\n+  }: any);\n+}\n+\n // This type represents a stateful instance of a Server Component or a Component\n // that gets optimized away - e.g. call-through without creating a Fiber.\n // It's basically a virtual Fiber. This is not a semantic concept in React.\n@@ -191,9 +226,9 @@ function createFiberInstance(fiber: Fiber): FiberInstance {\n type VirtualInstance = {\n   kind: 1,\n   id: number,\n-  parent: null | DevToolsInstance, // filtered parent, including virtual\n-  firstChild: null | DevToolsInstance, // filtered first child, including virtual\n-  nextSibling: null | DevToolsInstance, // filtered next sibling, including virtual\n+  parent: null | DevToolsInstance,\n+  firstChild: null | DevToolsInstance,\n+  nextSibling: null | DevToolsInstance,\n   flags: number,\n   source: null | string | Error | Source, // source location of this server component, or owned child stack\n   // Errors and Warnings happen per ReactComponentInfo which can appear in\n@@ -225,7 +260,7 @@ function createVirtualInstance(\n   };\n }\n \n-type DevToolsInstance = FiberInstance | VirtualInstance;\n+type DevToolsInstance = FiberInstance | VirtualInstance | FilteredFiberInstance;\n \n type getDisplayNameForFiberType = (fiber: Fiber) => string | null;\n type getTypeSymbolType = (type: any) => symbol | number;\n@@ -721,6 +756,14 @@ export function getInternalReactConstants(version: string): {\n   };\n }\n \n+// All environment names we've seen so far. This lets us create a list of filters to apply.\n+// This should ideally include env of filtered Components too so that you can add those as\n+// filters at the same time as removing some other filter.\n+const knownEnvironmentNames: Set<string> = new Set();\n+\n+// Map of FiberRoot to their root FiberInstance.\n+const rootToFiberInstanceMap: Map<FiberRoot, FiberInstance> = new Map();\n+\n // Map of one or more Fibers in a pair to their unique id number.\n // We track both Fibers to support Fast Refresh,\n // which may forcefully replace one of the pair as part of hot reloading.\n@@ -730,37 +773,96 @@ const fiberToFiberInstanceMap: Map<Fiber, FiberInstance> = new Map();\n // Map of id to one (arbitrary) Fiber in a pair.\n // This Map is used to e.g. get the display name for a Fiber or schedule an update,\n // operations that should be the same whether the current and work-in-progress Fiber is used.\n-const idToDevToolsInstanceMap: Map<number, DevToolsInstance> = new Map();\n+const idToDevToolsInstanceMap: Map<number, FiberInstance | VirtualInstance> =\n+  new Map();\n+\n+// Map of canonical HostInstances to the nearest parent DevToolsInstance.\n+const publicInstanceToDevToolsInstanceMap: Map<HostInstance, DevToolsInstance> =\n+  new Map();\n+// Map of resource DOM nodes to all the nearest DevToolsInstances that depend on it.\n+const hostResourceToDevToolsInstanceMap: Map<\n+  HostInstance,\n+  Set<DevToolsInstance>,\n+> = new Map();\n+\n+function getPublicInstance(instance: HostInstance): HostInstance {\n+  // Typically the PublicInstance and HostInstance is the same thing but not in Fabric.\n+  // So we need to detect this and use that as the public instance.\n+  return typeof instance === 'object' &&\n+    instance !== null &&\n+    typeof instance.canonical === 'object'\n+    ? (instance.canonical: any)\n+    : typeof instance._nativeTag === 'number'\n+      ? instance._nativeTag\n+      : instance;\n+}\n+\n+function aquireHostInstance(\n+  nearestInstance: DevToolsInstance,\n+  hostInstance: HostInstance,\n+): void {\n+  const publicInstance = getPublicInstance(hostInstance);\n+  publicInstanceToDevToolsInstanceMap.set(publicInstance, nearestInstance);\n+}\n \n-// Map of resource DOM nodes to all the Fibers that depend on it.\n-const hostResourceToFiberMap: Map<HostInstance, Set<Fiber>> = new Map();\n+function releaseHostInstance(\n+  nearestInstance: DevToolsInstance,\n+  hostInstance: HostInstance,\n+): void {\n+  const publicInstance = getPublicInstance(hostInstance);\n+  if (\n+    publicInstanceToDevToolsInstanceMap.get(publicInstance) === nearestInstance\n+  ) {\n+    publicInstanceToDevToolsInstanceMap.delete(publicInstance);\n+  }\n+}\n \n function aquireHostResource(\n-  fiber: Fiber,\n+  nearestInstance: DevToolsInstance,\n   resource: ?{instance?: HostInstance},\n ): void {\n   const hostInstance = resource && resource.instance;\n   if (hostInstance) {\n-    let resourceFibers = hostResourceToFiberMap.get(hostInstance);\n-    if (resourceFibers === undefined) {\n-      resourceFibers = new Set();\n-      hostResourceToFiberMap.set(hostInstance, resourceFibers);\n+    const publicInstance = getPublicInstance(hostInstance);\n+    let resourceInstances =\n+      hostResourceToDevToolsInstanceMap.get(publicInstance);\n+    if (resourceInstances === undefined) {\n+      resourceInstances = new Set();\n+      hostResourceToDevToolsInstanceMap.set(publicInstance, resourceInstances);\n+      // Store the first match in the main map for quick access when selecting DOM node.\n+      publicInstanceToDevToolsInstanceMap.set(publicInstance, nearestInstance);\n     }\n-    resourceFibers.add(fiber);\n+    resourceInstances.add(nearestInstance);\n   }\n }\n \n function releaseHostResource(\n-  fiber: Fiber,\n+  nearestInstance: DevToolsInstance,\n   resource: ?{instance?: HostInstance},\n ): void {\n   const hostInstance = resource && resource.instance;\n   if (hostInstance) {\n-    const resourceFibers = hostResourceToFiberMap.get(hostInstance);\n-    if (resourceFibers !== undefined) {\n-      resourceFibers.delete(fiber);\n-      if (resourceFibers.size === 0) {\n-        hostResourceToFiberMap.delete(hostInstance);\n+    const publicInstance = getPublicInstance(hostInstance);\n+    const resourceInstances =\n+      hostResourceToDevToolsInstanceMap.get(publicInstance);\n+    if (resourceInstances !== undefined) {\n+      resourceInstances.delete(nearestInstance);\n+      if (resourceInstances.size === 0) {\n+        hostResourceToDevToolsInstanceMap.delete(publicInstance);\n+        publicInstanceToDevToolsInstanceMap.delete(publicInstance);\n+      } else if (\n+        publicInstanceToDevToolsInstanceMap.get(publicInstance) ===\n+        nearestInstance\n+      ) {\n+        // This was the first one. Store the next first one in the main map for easy access.\n+        // eslint-disable-next-line no-for-of-loops/no-for-of-loops\n+        for (const firstInstance of resourceInstances) {\n+          publicInstanceToDevToolsInstanceMap.set(\n+            firstInstance,\n+            nearestInstance,\n+          );\n+          break;\n+        }\n       }\n     }\n   }\n@@ -996,7 +1098,10 @@ export function attach(\n     // even if objects are different\n     const message = formatConsoleArgumentsToSingleString(...args);\n     if (__DEBUG__) {\n-      debug('onErrorOrWarning', fiber, null, `${type}: \"${message}\"`);\n+      const fiberInstance = fiberToFiberInstanceMap.get(fiber);\n+      if (fiberInstance !== undefined) {\n+        debug('onErrorOrWarning', fiberInstance, null, `${type}: \"${message}\"`);\n+      }\n     }\n \n     // Mark this Fiber as needed its warning/error count updated during the next flush.\n@@ -1032,32 +1137,37 @@ export function attach(\n   // It relies on the extension to pass the preference through via the global.\n   patchConsoleUsingWindowValues();\n \n-  const debug = (\n+  function debug(\n     name: string,\n-    fiber: Fiber,\n+    instance: DevToolsInstance,\n     parentInstance: null | DevToolsInstance,\n     extraString: string = '',\n-  ): void => {\n+  ): void {\n     if (__DEBUG__) {\n       const displayName =\n-        fiber.tag + ':' + (getDisplayNameForFiber(fiber) || 'null');\n-\n-      const maybeID = getFiberIDUnsafe(fiber) || '<no id>';\n-\n-      let parentDisplayName;\n-      let maybeParentID;\n-      if (parentInstance !== null && parentInstance.kind === FIBER_INSTANCE) {\n-        const parentFiber = parentInstance.data;\n-        parentDisplayName =\n-          parentFiber.tag +\n-          ':' +\n-          (getDisplayNameForFiber(parentFiber) || 'null');\n-        maybeParentID = String(parentInstance.id);\n-      } else {\n-        // TODO: Handle VirtualInstance\n-        parentDisplayName = '';\n-        maybeParentID = '<no-id>';\n-      }\n+        instance.kind === VIRTUAL_INSTANCE\n+          ? instance.data.name || 'null'\n+          : instance.data.tag +\n+            ':' +\n+            (getDisplayNameForFiber(instance.data) || 'null');\n+\n+      const maybeID =\n+        instance.kind === FILTERED_FIBER_INSTANCE ? '<no id>' : instance.id;\n+\n+      const parentDisplayName =\n+        parentInstance === null\n+          ? ''\n+          : parentInstance.kind === VIRTUAL_INSTANCE\n+            ? parentInstance.data.name || 'null'\n+            : parentInstance.data.tag +\n+              ':' +\n+              (getDisplayNameForFiber(parentInstance.data) || 'null');\n+\n+      const maybeParentID =\n+        parentInstance === null ||\n+        parentInstance.kind === FILTERED_FIBER_INSTANCE\n+          ? '<no id>'\n+          : parentInstance.id;\n \n       console.groupCollapsed(\n         `[renderer] %c${name} %c${displayName} (${maybeID}) %c${\n@@ -1071,19 +1181,28 @@ export function attach(\n       console.log(new Error().stack.split('\\n').slice(1).join('\\n'));\n       console.groupEnd();\n     }\n-  };\n+  }\n \n   // eslint-disable-next-line no-unused-vars\n   function debugTree(instance: DevToolsInstance, indent: number = 0) {\n     if (__DEBUG__) {\n       const name =\n-        (instance.kind === FIBER_INSTANCE\n+        (instance.kind !== VIRTUAL_INSTANCE\n           ? getDisplayNameForFiber(instance.data)\n           : instance.data.name) || '';\n       console.log(\n-        '  '.repeat(indent) + '- ' + instance.id + ' (' + name + ')',\n+        '  '.repeat(indent) +\n+          '- ' +\n+          (instance.kind === FILTERED_FIBER_INSTANCE ? 0 : instance.id) +\n+          ' (' +\n+          name +\n+          ')',\n         'parent',\n-        instance.parent === null ? ' ' : instance.parent.id,\n+        instance.parent === null\n+          ? ' '\n+          : instance.parent.kind === FILTERED_FIBER_INSTANCE\n+            ? 0\n+            : instance.parent.id,\n         'next',\n         instance.nextSibling === null ? ' ' : instance.nextSibling.id,\n       );\n@@ -1099,6 +1218,7 @@ export function attach(\n   const hideElementsWithDisplayNames: Set<RegExp> = new Set();\n   const hideElementsWithPaths: Set<RegExp> = new Set();\n   const hideElementsWithTypes: Set<ElementType> = new Set();\n+  const hideElementsWithEnvs: Set<string> = new Set();\n \n   // Highlight updates\n   let traceUpdatesEnabled: boolean = false;\n@@ -1108,6 +1228,7 @@ export function attach(\n     hideElementsWithTypes.clear();\n     hideElementsWithDisplayNames.clear();\n     hideElementsWithPaths.clear();\n+    hideElementsWithEnvs.clear();\n \n     componentFilters.forEach(componentFilter => {\n       if (!componentFilter.isEnabled) {\n@@ -1133,6 +1254,9 @@ export function attach(\n         case ComponentFilterHOC:\n           hideElementsWithDisplayNames.add(new RegExp('\\\\('));\n           break;\n+        case ComponentFilterEnvironmentName:\n+          hideElementsWithEnvs.add(componentFilter.value);\n+          break;\n         default:\n           console.warn(\n             `Invalid component filter type \"${componentFilter.type}\"`,\n@@ -1174,9 +1298,15 @@ export function attach(\n \n     // Recursively unmount all roots.\n     hook.getFiberRoots(rendererID).forEach(root => {\n-      const rootInstance = getFiberInstanceThrows(root.current);\n+      const rootInstance = rootToFiberInstanceMap.get(root);\n+      if (rootInstance === undefined) {\n+        throw new Error(\n+          'Expected the root instance to already exist when applying filters',\n+        );\n+      }\n       currentRootID = rootInstance.id;\n       unmountInstanceRecursively(rootInstance);\n+      rootToFiberInstanceMap.delete(root);\n       flushPendingEvents(root);\n       currentRootID = -1;\n     });\n@@ -1191,6 +1321,7 @@ export function attach(\n       const current = root.current;\n       const alternate = current.alternate;\n       const newRoot = createFiberInstance(current);\n+      rootToFiberInstanceMap.set(root, newRoot);\n       idToDevToolsInstanceMap.set(newRoot.id, newRoot);\n       fiberToFiberInstanceMap.set(current, newRoot);\n       if (alternate) {\n@@ -1215,7 +1346,14 @@ export function attach(\n     flushPendingEvents();\n   }\n \n-  function shouldFilterVirtual(data: ReactComponentInfo): boolean {\n+  function getEnvironmentNames(): Array<string> {\n+    return Array.from(knownEnvironmentNames);\n+  }\n+\n+  function shouldFilterVirtual(\n+    data: ReactComponentInfo,\n+    secondaryEnv: null | string,\n+  ): boolean {\n     // For purposes of filtering Server Components are always Function Components.\n     // Environment will be used to filter Server vs Client.\n     // Technically they can be forwardRef and memo too but those filters will go away\n@@ -1236,6 +1374,14 @@ export function attach(\n       }\n     }\n \n+    if (\n+      (data.env == null || hideElementsWithEnvs.has(data.env)) &&\n+      (secondaryEnv === null || hideElementsWithEnvs.has(secondaryEnv))\n+    ) {\n+      // If a Component has two environments, you have to filter both for it not to appear.\n+      return true;\n+    }\n+\n     return false;\n   }\n \n@@ -1294,6 +1440,26 @@ export function attach(\n       }\n     }\n \n+    if (hideElementsWithEnvs.has('Client')) {\n+      // If we're filtering out the Client environment we should filter out all\n+      // \"Client Components\". Technically that also includes the built-ins but\n+      // since that doesn't actually include any additional code loading it's\n+      // useful to not filter out the built-ins. Those can be filtered separately.\n+      // There's no other way to filter out just Function components on the Client.\n+      // Therefore, this only filters Class and Function components.\n+      switch (tag) {\n+        case ClassComponent:\n+        case IncompleteClassComponent:\n+        case IncompleteFunctionComponent:\n+        case FunctionComponent:\n+        case IndeterminateComponent:\n+        case ForwardRef:\n+        case MemoComponent:\n+        case SimpleMemoComponent:\n+          return true;\n+      }\n+    }\n+\n     /* DISABLED: https://github.com/facebook/react/pull/28417\n     if (hideElementsWithPaths.size > 0) {\n       const source = getSourceForFiber(fiber);\n@@ -1375,17 +1541,6 @@ export function attach(\n   // When a mount or update is in progress, this value tracks the root that is being operated on.\n   let currentRootID: number = -1;\n \n-  // Returns a FiberInstance if one has already been generated for the Fiber or throws.\n-  function getFiberInstanceThrows(fiber: Fiber): FiberInstance {\n-    const fiberInstance = getFiberInstanceUnsafe(fiber);\n-    if (fiberInstance !== null) {\n-      return fiberInstance;\n-    }\n-    throw Error(\n-      `Could not find ID for Fiber \"${getDisplayNameForFiber(fiber) || ''}\"`,\n-    );\n-  }\n-\n   function getFiberIDThrows(fiber: Fiber): number {\n     const fiberInstance = getFiberInstanceUnsafe(fiber);\n     if (fiberInstance !== null) {\n@@ -1421,50 +1576,26 @@ export function attach(\n \n   // Removes a Fiber (and its alternate) from the Maps used to track their id.\n   // This method should always be called when a Fiber is unmounting.\n-  function untrackFiber(fiberInstance: FiberInstance) {\n-    if (__DEBUG__) {\n-      debug('untrackFiber()', fiberInstance.data, null);\n-    }\n-\n-    idToDevToolsInstanceMap.delete(fiberInstance.id);\n-\n-    const fiber = fiberInstance.data;\n-\n-    // Restore any errors/warnings associated with this fiber to the pending\n-    // map. I.e. treat it as before we tracked the instances. This lets us\n-    // restore them if we remount the same Fibers later. Otherwise we rely\n-    // on the GC of the Fibers to clean them up.\n-    if (fiberInstance.errors !== null) {\n-      pendingFiberToErrorsMap.set(fiber, fiberInstance.errors);\n-      fiberInstance.errors = null;\n-    }\n-    if (fiberInstance.warnings !== null) {\n-      pendingFiberToWarningsMap.set(fiber, fiberInstance.warnings);\n-      fiberInstance.warnings = null;\n-    }\n+  function untrackFiber(nearestInstance: DevToolsInstance, fiber: Fiber) {\n+    // TODO: Consider using a WeakMap instead. The only thing where that doesn't work\n+    // is React Native Paper which tracks tags but that support is eventually going away\n+    // and can use the old findFiberByHostInstance strategy.\n \n-    if (fiberInstance.flags & FORCE_ERROR) {\n-      fiberInstance.flags &= ~FORCE_ERROR;\n-      forceErrorCount--;\n-      if (forceErrorCount === 0 && setErrorHandler != null) {\n-        setErrorHandler(shouldErrorFiberAlwaysNull);\n-      }\n-    }\n-    if (fiberInstance.flags & FORCE_SUSPENSE_FALLBACK) {\n-      fiberInstance.flags &= ~FORCE_SUSPENSE_FALLBACK;\n-      forceFallbackCount--;\n-      if (forceFallbackCount === 0 && setSuspenseHandler != null) {\n-        setSuspenseHandler(shouldSuspendFiberAlwaysFalse);\n-      }\n+    if (fiber.tag === HostHoistable) {\n+      releaseHostResource(nearestInstance, fiber.memoizedState);\n+    } else if (\n+      fiber.tag === HostComponent ||\n+      fiber.tag === HostText ||\n+      fiber.tag === HostSingleton\n+    ) {\n+      releaseHostInstance(nearestInstance, fiber.stateNode);\n     }\n \n-    if (fiberToFiberInstanceMap.get(fiber) === fiberInstance) {\n-      fiberToFiberInstanceMap.delete(fiber);\n-    }\n-    const {alternate} = fiber;\n-    if (alternate !== null) {\n-      if (fiberToFiberInstanceMap.get(alternate) === fiberInstance) {\n-        fiberToFiberInstanceMap.delete(alternate);\n+    // Recursively clean up any filtered Fibers below this one as well since\n+    // we won't recordUnmount on those.\n+    for (let child = fiber.child; child !== null; child = child.sibling) {\n+      if (shouldFilterFiber(child)) {\n+        untrackFiber(nearestInstance, child);\n       }\n     }\n   }\n@@ -2098,7 +2229,7 @@ export function attach(\n     const isRoot = fiber.tag === HostRoot;\n     let fiberInstance;\n     if (isRoot) {\n-      const entry = fiberToFiberInstanceMap.get(fiber);\n+      const entry = rootToFiberInstanceMap.get(fiber.stateNode);\n       if (entry === undefined) {\n         throw new Error('The root should have been registered at this point');\n       }\n@@ -2119,7 +2250,7 @@ export function attach(\n     const id = fiberInstance.id;\n \n     if (__DEBUG__) {\n-      debug('recordMount()', fiber, parentInstance);\n+      debug('recordMount()', fiberInstance, parentInstance);\n     }\n \n     const isProfilingSupported = fiber.hasOwnProperty('treeBaseDuration');\n@@ -2181,7 +2312,12 @@ export function attach(\n         ownerInstance.source = fiber._debugStack;\n       }\n       const ownerID = ownerInstance === null ? 0 : ownerInstance.id;\n-      const parentID = parentInstance ? parentInstance.id : 0;\n+      const parentID = parentInstance\n+        ? parentInstance.kind === FILTERED_FIBER_INSTANCE\n+          ? // A Filtered Fiber Instance will always have a Virtual Instance as a parent.\n+            ((parentInstance.parent: any): VirtualInstance).id\n+          : parentInstance.id\n+        : 0;\n \n       const displayNameStringID = getStringID(displayName);\n \n@@ -2265,7 +2401,12 @@ export function attach(\n       ownerInstance.source = componentInfo.debugStack;\n     }\n     const ownerID = ownerInstance === null ? 0 : ownerInstance.id;\n-    const parentID = parentInstance ? parentInstance.id : 0;\n+    const parentID = parentInstance\n+      ? parentInstance.kind === FILTERED_FIBER_INSTANCE\n+        ? // A Filtered Fiber Instance will always have a Virtual Instance as a parent.\n+          ((parentInstance.parent: any): VirtualInstance).id\n+        : parentInstance.id\n+      : 0;\n \n     const displayNameStringID = getStringID(displayName);\n \n@@ -2286,7 +2427,7 @@ export function attach(\n   function recordUnmount(fiberInstance: FiberInstance): void {\n     const fiber = fiberInstance.data;\n     if (__DEBUG__) {\n-      debug('recordUnmount()', fiber, null);\n+      debug('recordUnmount()', fiberInstance, reconcilingParent);\n     }\n \n     if (trackedPathMatchInstance === fiberInstance) {\n@@ -2309,7 +2450,47 @@ export function attach(\n       pendingRealUnmountedIDs.push(id);\n     }\n \n-    untrackFiber(fiberInstance);\n+    idToDevToolsInstanceMap.delete(fiberInstance.id);\n+\n+    // Restore any errors/warnings associated with this fiber to the pending\n+    // map. I.e. treat it as before we tracked the instances. This lets us\n+    // restore them if we remount the same Fibers later. Otherwise we rely\n+    // on the GC of the Fibers to clean them up.\n+    if (fiberInstance.errors !== null) {\n+      pendingFiberToErrorsMap.set(fiber, fiberInstance.errors);\n+      fiberInstance.errors = null;\n+    }\n+    if (fiberInstance.warnings !== null) {\n+      pendingFiberToWarningsMap.set(fiber, fiberInstance.warnings);\n+      fiberInstance.warnings = null;\n+    }\n+\n+    if (fiberInstance.flags & FORCE_ERROR) {\n+      fiberInstance.flags &= ~FORCE_ERROR;\n+      forceErrorCount--;\n+      if (forceErrorCount === 0 && setErrorHandler != null) {\n+        setErrorHandler(shouldErrorFiberAlwaysNull);\n+      }\n+    }\n+    if (fiberInstance.flags & FORCE_SUSPENSE_FALLBACK) {\n+      fiberInstance.flags &= ~FORCE_SUSPENSE_FALLBACK;\n+      forceFallbackCount--;\n+      if (forceFallbackCount === 0 && setSuspenseHandler != null) {\n+        setSuspenseHandler(shouldSuspendFiberAlwaysFalse);\n+      }\n+    }\n+\n+    if (fiberToFiberInstanceMap.get(fiber) === fiberInstance) {\n+      fiberToFiberInstanceMap.delete(fiber);\n+    }\n+    const {alternate} = fiber;\n+    if (alternate !== null) {\n+      if (fiberToFiberInstanceMap.get(alternate) === fiberInstance) {\n+        fiberToFiberInstanceMap.delete(alternate);\n+      }\n+    }\n+\n+    untrackFiber(fiberInstance, fiber);\n   }\n \n   // Running state of the remaining children from the previous version of this parent that\n@@ -2489,7 +2670,14 @@ export function attach(\n           }\n           // Scan up until the next Component to see if this component changed environment.\n           const componentInfo: ReactComponentInfo = (debugEntry: any);\n-          if (shouldFilterVirtual(componentInfo)) {\n+          const secondaryEnv = getSecondaryEnvironmentName(fiber._debugInfo, i);\n+          if (componentInfo.env != null) {\n+            knownEnvironmentNames.add(componentInfo.env);\n+          }\n+          if (secondaryEnv !== null) {\n+            knownEnvironmentNames.add(secondaryEnv);\n+          }\n+          if (shouldFilterVirtual(componentInfo, secondaryEnv)) {\n             // Skip.\n             continue;\n           }\n@@ -2511,10 +2699,6 @@ export function attach(\n                 );\n               }\n               previousVirtualInstance = createVirtualInstance(componentInfo);\n-              const secondaryEnv = getSecondaryEnvironmentName(\n-                fiber._debugInfo,\n-                i,\n-              );\n               recordVirtualMount(\n                 previousVirtualInstance,\n                 reconcilingParent,\n@@ -2578,15 +2762,36 @@ export function attach(\n     fiber: Fiber,\n     traceNearestHostComponentUpdate: boolean,\n   ): void {\n-    if (__DEBUG__) {\n-      debug('mountFiberRecursively()', fiber, reconcilingParent);\n-    }\n-\n     const shouldIncludeInTree = !shouldFilterFiber(fiber);\n     let newInstance = null;\n     if (shouldIncludeInTree) {\n       newInstance = recordMount(fiber, reconcilingParent);\n       insertChild(newInstance);\n+      if (__DEBUG__) {\n+        debug('mountFiberRecursively()', newInstance, reconcilingParent);\n+      }\n+    } else if (\n+      reconcilingParent !== null &&\n+      reconcilingParent.kind === VIRTUAL_INSTANCE\n+    ) {\n+      // If the parent is a Virtual Instance and we filtered this Fiber we include a\n+      // hidden node.\n+\n+      if (\n+        reconcilingParent.data === fiber._debugOwner &&\n+        fiber._debugStack != null &&\n+        reconcilingParent.source === null\n+      ) {\n+        // The new Fiber is directly owned by the parent. Therefore somewhere on the\n+        // debugStack will be a stack frame inside parent that we can use as its soruce.\n+        reconcilingParent.source = fiber._debugStack;\n+      }\n+\n+      newInstance = createFilteredFiberInstance(fiber);\n+      insertChild(newInstance);\n+      if (__DEBUG__) {\n+        debug('mountFiberRecursively()', newInstance, reconcilingParent);\n+      }\n     }\n \n     // If we have the tree selection from previous reload, try to match this Fiber.\n@@ -2599,7 +2804,7 @@ export function attach(\n     const stashedParent = reconcilingParent;\n     const stashedPrevious = previouslyReconciledSibling;\n     const stashedRemaining = remainingReconcilingChildren;\n-    if (shouldIncludeInTree) {\n+    if (newInstance !== null) {\n       // Push a new DevTools instance parent while reconciling this subtree.\n       reconcilingParent = newInstance;\n       previouslyReconciledSibling = null;\n@@ -2621,7 +2826,21 @@ export function attach(\n       }\n \n       if (fiber.tag === HostHoistable) {\n-        aquireHostResource(fiber, fiber.memoizedState);\n+        const nearestInstance = reconcilingParent;\n+        if (nearestInstance === null) {\n+          throw new Error('Did not expect a host hoistable to be the root');\n+        }\n+        aquireHostResource(nearestInstance, fiber.memoizedState);\n+      } else if (\n+        fiber.tag === HostComponent ||\n+        fiber.tag === HostText ||\n+        fiber.tag === HostSingleton\n+      ) {\n+        const nearestInstance = reconcilingParent;\n+        if (nearestInstance === null) {\n+          throw new Error('Did not expect a host hoistable to be the root');\n+        }\n+        aquireHostInstance(nearestInstance, fiber.stateNode);\n       }\n \n       if (fiber.tag === SuspenseComponent) {\n@@ -2670,7 +2889,7 @@ export function attach(\n         }\n       }\n     } finally {\n-      if (shouldIncludeInTree) {\n+      if (newInstance !== null) {\n         reconcilingParent = stashedParent;\n         previouslyReconciledSibling = stashedPrevious;\n         remainingReconcilingChildren = stashedRemaining;\n@@ -2686,9 +2905,7 @@ export function attach(\n   // when we switch from primary to fallback, or deleting a subtree.\n   function unmountInstanceRecursively(instance: DevToolsInstance) {\n     if (__DEBUG__) {\n-      if (instance.kind === FIBER_INSTANCE) {\n-        debug('unmountInstanceRecursively()', instance.data, null);\n-      }\n+      debug('unmountInstanceRecursively()', instance, reconcilingParent);\n     }\n \n     const stashedParent = reconcilingParent;\n@@ -2710,8 +2927,10 @@ export function attach(\n     }\n     if (instance.kind === FIBER_INSTANCE) {\n       recordUnmount(instance);\n-    } else {\n+    } else if (instance.kind === VIRTUAL_INSTANCE) {\n       recordVirtualUnmount(instance);\n+    } else {\n+      untrackFiber(instance, instance.data);\n     }\n     removeChild(instance, null);\n   }\n@@ -2816,15 +3035,14 @@ export function attach(\n     virtualInstance.treeBaseDuration = treeBaseDuration;\n   }\n \n-  function recordResetChildren(parentInstance: DevToolsInstance) {\n+  function recordResetChildren(\n+    parentInstance: FiberInstance | VirtualInstance,\n+  ) {\n     if (__DEBUG__) {\n-      if (\n-        parentInstance.firstChild !== null &&\n-        parentInstance.firstChild.kind === FIBER_INSTANCE\n-      ) {\n+      if (parentInstance.firstChild !== null) {\n         debug(\n           'recordResetChildren()',\n-          parentInstance.firstChild.data,\n+          parentInstance.firstChild,\n           parentInstance,\n         );\n       }\n@@ -2836,7 +3054,17 @@ export function attach(\n \n     let child: null | DevToolsInstance = parentInstance.firstChild;\n     while (child !== null) {\n-      nextChildren.push(child.id);\n+      if (child.kind === FILTERED_FIBER_INSTANCE) {\n+        for (\n+          let innerChild: null | DevToolsInstance = parentInstance.firstChild;\n+          innerChild !== null;\n+          innerChild = innerChild.nextSibling\n+        ) {\n+          nextChildren.push((innerChild: any).id);\n+        }\n+      } else {\n+        nextChildren.push(child.id);\n+      }\n       child = child.nextSibling;\n     }\n \n@@ -2919,7 +3147,17 @@ export function attach(\n             continue;\n           }\n           const componentInfo: ReactComponentInfo = (debugEntry: any);\n-          if (shouldFilterVirtual(componentInfo)) {\n+          const secondaryEnv = getSecondaryEnvironmentName(\n+            nextChild._debugInfo,\n+            i,\n+          );\n+          if (componentInfo.env != null) {\n+            knownEnvironmentNames.add(componentInfo.env);\n+          }\n+          if (secondaryEnv !== null) {\n+            knownEnvironmentNames.add(secondaryEnv);\n+          }\n+          if (shouldFilterVirtual(componentInfo, secondaryEnv)) {\n             continue;\n           }\n           if (level === virtualLevel) {\n@@ -2983,10 +3221,6 @@ export function attach(\n               } else {\n                 // Otherwise we create a new instance.\n                 const newVirtualInstance = createVirtualInstance(componentInfo);\n-                const secondaryEnv = getSecondaryEnvironmentName(\n-                  nextChild._debugInfo,\n-                  i,\n-                );\n                 recordVirtualMount(\n                   newVirtualInstance,\n                   reconcilingParent,\n@@ -3185,7 +3419,9 @@ export function attach(\n     traceNearestHostComponentUpdate: boolean,\n   ): boolean {\n     if (__DEBUG__) {\n-      debug('updateFiberRecursively()', nextFiber, reconcilingParent);\n+      if (fiberInstance !== null) {\n+        debug('updateFiberRecursively()', fiberInstance, reconcilingParent);\n+      }\n     }\n \n     if (traceUpdatesEnabled) {\n@@ -3236,8 +3472,12 @@ export function attach(\n     }\n     try {\n       if (nextFiber.tag === HostHoistable) {\n-        releaseHostResource(prevFiber, prevFiber.memoizedState);\n-        aquireHostResource(nextFiber, nextFiber.memoizedState);\n+        const nearestInstance = reconcilingParent;\n+        if (nearestInstance === null) {\n+          throw new Error('Did not expect a host hoistable to be the root');\n+        }\n+        releaseHostResource(nearestInstance, prevFiber.memoizedState);\n+        aquireHostResource(nearestInstance, nextFiber.memoizedState);\n       }\n \n       const isSuspense = nextFiber.tag === SuspenseComponent;\n@@ -3338,6 +3578,18 @@ export function attach(\n             // I.e. we just restore them by undoing what we did above.\n             fiberInstance.firstChild = remainingReconcilingChildren;\n             remainingReconcilingChildren = null;\n+\n+            if (traceUpdatesEnabled) {\n+              // If we're tracing updates and we've bailed out before reaching a host node,\n+              // we should fall back to recursively marking the nearest host descendants for highlight.\n+              if (traceNearestHostComponentUpdate) {\n+                const hostInstances =\n+                  findAllCurrentHostInstances(fiberInstance);\n+                hostInstances.forEach(hostInstance => {\n+                  traceUpdatesForNodes.add(hostInstance);\n+                });\n+              }\n+            }\n           } else {\n             // If this fiber is filtered there might be changes to this set elsewhere so we have\n             // to visit each child to place it back in the set. We let the child bail out instead.\n@@ -3349,19 +3601,6 @@ export function attach(\n               );\n             }\n           }\n-\n-          if (traceUpdatesEnabled) {\n-            // If we're tracing updates and we've bailed out before reaching a host node,\n-            // we should fall back to recursively marking the nearest host descendants for highlight.\n-            if (traceNearestHostComponentUpdate) {\n-              const hostInstances = findAllCurrentHostInstances(\n-                getFiberInstanceThrows(nextFiber),\n-              );\n-              hostInstances.forEach(hostInstance => {\n-                traceUpdatesForNodes.add(hostInstance);\n-              });\n-            }\n-          }\n         }\n       }\n \n@@ -3442,6 +3681,7 @@ export function attach(\n         const current = root.current;\n         const alternate = current.alternate;\n         const newRoot = createFiberInstance(current);\n+        rootToFiberInstanceMap.set(root, newRoot);\n         idToDevToolsInstanceMap.set(newRoot.id, newRoot);\n         fiberToFiberInstanceMap.set(current, newRoot);\n         if (alternate) {\n@@ -3508,15 +3748,17 @@ export function attach(\n     }\n   }\n \n-  function handleCommitFiberRoot(root: any, priorityLevel: void | number) {\n+  function handleCommitFiberRoot(\n+    root: FiberRoot,\n+    priorityLevel: void | number,\n+  ) {\n     const current = root.current;\n     const alternate = current.alternate;\n \n-    let rootInstance =\n-      fiberToFiberInstanceMap.get(current) ||\n-      (alternate && fiberToFiberInstanceMap.get(alternate));\n+    let rootInstance = rootToFiberInstanceMap.get(root);\n     if (!rootInstance) {\n       rootInstance = createFiberInstance(current);\n+      rootToFiberInstanceMap.set(root, rootInstance);\n       idToDevToolsInstanceMap.set(rootInstance.id, rootInstance);\n       fiberToFiberInstanceMap.set(current, rootInstance);\n       if (alternate) {\n@@ -3581,8 +3823,9 @@ export function attach(\n         updateFiberRecursively(rootInstance, current, alternate, false);\n       } else if (wasMounted && !isMounted) {\n         // Unmount an existing root.\n-        removeRootPseudoKey(currentRootID);\n         unmountInstanceRecursively(rootInstance);\n+        removeRootPseudoKey(currentRootID);\n+        rootToFiberInstanceMap.delete(root);\n       }\n     } else {\n       // Mount a new root.\n@@ -3635,15 +3878,31 @@ export function attach(\n     return null;\n   }\n \n-  function findAllCurrentHostInstances(\n-    fiberInstance: FiberInstance,\n-  ): $ReadOnlyArray<HostInstance> {\n-    const hostInstances = [];\n-    const fiber = fiberInstance.data;\n-    if (!fiber) {\n-      return hostInstances;\n+  function appendHostInstancesByDevToolsInstance(\n+    devtoolsInstance: DevToolsInstance,\n+    hostInstances: Array<HostInstance>,\n+  ) {\n+    if (devtoolsInstance.kind !== VIRTUAL_INSTANCE) {\n+      const fiber = devtoolsInstance.data;\n+      appendHostInstancesByFiber(fiber, hostInstances);\n+      return;\n+    }\n+    // Search the tree for the nearest child Fiber and add all its host instances.\n+    // TODO: If the true nearest Fiber is filtered, we might skip it and instead include all\n+    // the children below it. In the extreme case, searching the whole tree.\n+    for (\n+      let child = devtoolsInstance.firstChild;\n+      child !== null;\n+      child = child.nextSibling\n+    ) {\n+      appendHostInstancesByDevToolsInstance(child, hostInstances);\n     }\n+  }\n \n+  function appendHostInstancesByFiber(\n+    fiber: Fiber,\n+    hostInstances: Array<HostInstance>,\n+  ): void {\n     // Next we'll drill down this component to find all HostComponent/Text.\n     let node: Fiber = fiber;\n     while (true) {\n@@ -3663,19 +3922,24 @@ export function attach(\n         continue;\n       }\n       if (node === fiber) {\n-        return hostInstances;\n+        return;\n       }\n       while (!node.sibling) {\n         if (!node.return || node.return === fiber) {\n-          return hostInstances;\n+          return;\n         }\n         node = node.return;\n       }\n       node.sibling.return = node.return;\n       node = node.sibling;\n     }\n-    // Flow needs the return here, but ESLint complains about it.\n-    // eslint-disable-next-line no-unreachable\n+  }\n+\n+  function findAllCurrentHostInstances(\n+    devtoolsInstance: DevToolsInstance,\n+  ): $ReadOnlyArray<HostInstance> {\n+    const hostInstances: Array<HostInstance> = [];\n+    appendHostInstancesByDevToolsInstance(devtoolsInstance, hostInstances);\n     return hostInstances;\n   }\n \n@@ -3686,17 +3950,7 @@ export function attach(\n         console.warn(`Could not find DevToolsInstance with id \"${id}\"`);\n         return null;\n       }\n-      if (devtoolsInstance.kind !== FIBER_INSTANCE) {\n-        // TODO: Handle VirtualInstance.\n-        return null;\n-      }\n-      const fiber = devtoolsInstance.data;\n-      if (fiber === null) {\n-        return null;\n-      }\n-\n-      const hostInstances = findAllCurrentHostInstances(devtoolsInstance);\n-      return hostInstances;\n+      return findAllCurrentHostInstances(devtoolsInstance);\n     } catch (err) {\n       // The fiber might have unmounted by now.\n       return null;\n@@ -3715,82 +3969,25 @@ export function attach(\n     }\n   }\n \n-  function getNearestMountedHostInstance(\n-    hostInstance: HostInstance,\n-  ): null | HostInstance {\n-    const mountedFiber = renderer.findFiberByHostInstance(hostInstance);\n-    if (mountedFiber != null) {\n-      if (mountedFiber.stateNode !== hostInstance) {\n-        // If it's not a perfect match the specific one might be a resource.\n-        // We don't need to look at any parents because host resources don't have\n-        // children so it won't be in any parent if it's not this one.\n-        if (hostResourceToFiberMap.has(hostInstance)) {\n-          return hostInstance;\n-        }\n-      }\n-      return mountedFiber.stateNode;\n-    }\n-    if (hostResourceToFiberMap.has(hostInstance)) {\n-      return hostInstance;\n+  function getNearestMountedDOMNode(publicInstance: Element): null | Element {\n+    let domNode: null | Element = publicInstance;\n+    while (domNode && !publicInstanceToDevToolsInstanceMap.has(domNode)) {\n+      // $FlowFixMe: In practice this is either null or Element.\n+      domNode = domNode.parentNode;\n     }\n-    return null;\n-  }\n-\n-  function findNearestUnfilteredElementID(searchFiber: Fiber) {\n-    let fiber: null | Fiber = searchFiber;\n-    while (fiber !== null) {\n-      const fiberInstance = getFiberInstanceUnsafe(fiber);\n-      if (fiberInstance !== null) {\n-        // TODO: Ideally we would not have any filtered FiberInstances which\n-        // would make this logic much simpler. Unfortunately, we sometimes\n-        // eagerly add to the map and some times don't eagerly clean it up.\n-        // TODO: If the fiber is filtered, the FiberInstance wouldn't really\n-        // exist which would mean that we also don't have a way to get to the\n-        // VirtualInstances.\n-        if (!shouldFilterFiber(fiberInstance.data)) {\n-          return fiberInstance.id;\n-        }\n-        // We couldn't use this Fiber but we might have a VirtualInstance\n-        // that is the nearest unfiltered instance.\n-        const parentInstance = fiberInstance.parent;\n-        if (\n-          parentInstance !== null &&\n-          parentInstance.kind === VIRTUAL_INSTANCE\n-        ) {\n-          // Virtual Instances only exist if they're unfiltered.\n-          return parentInstance.id;\n-        }\n-        // If we find a parent Fiber, it might not be the nearest parent\n-        // so we break out and continue walking the Fiber tree instead.\n-      }\n-      fiber = fiber.return;\n-    }\n-    return null;\n+    return domNode;\n   }\n \n   function getElementIDForHostInstance(\n-    hostInstance: HostInstance,\n-    findNearestUnfilteredAncestor: boolean = false,\n+    publicInstance: HostInstance,\n   ): number | null {\n-    const resourceFibers = hostResourceToFiberMap.get(hostInstance);\n-    if (resourceFibers !== undefined) {\n-      // This is a resource. Find the first unfiltered instance.\n-      // eslint-disable-next-line no-for-of-loops/no-for-of-loops\n-      for (const resourceFiber of resourceFibers) {\n-        const elementID = findNearestUnfilteredElementID(resourceFiber);\n-        if (elementID !== null) {\n-          return elementID;\n-        }\n-      }\n-      // If we don't find one, fallthrough to select the parent instead.\n-    }\n-    const fiber = renderer.findFiberByHostInstance(hostInstance);\n-    if (fiber != null) {\n-      if (!findNearestUnfilteredAncestor) {\n-        // TODO: Remove this option. It's not used.\n-        return getFiberIDThrows(fiber);\n+    const instance = publicInstanceToDevToolsInstanceMap.get(publicInstance);\n+    if (instance !== undefined) {\n+      if (instance.kind === FILTERED_FIBER_INSTANCE) {\n+        // A Filtered Fiber Instance will always have a Virtual Instance as a parent.\n+        return ((instance.parent: any): VirtualInstance).id;\n       }\n-      return findNearestUnfilteredElementID(fiber);\n+      return instance.id;\n     }\n     return null;\n   }\n@@ -3842,7 +4039,7 @@ export function attach(\n   }\n \n   function instanceToSerializedElement(\n-    instance: DevToolsInstance,\n+    instance: FiberInstance | VirtualInstance,\n   ): SerializedElement {\n     if (instance.kind === FIBER_INSTANCE) {\n       const fiber = instance.data;\n@@ -3925,7 +4122,7 @@ export function attach(\n         owner = ownerFiber._debugOwner;\n       } else {\n         const ownerInfo: ReactComponentInfo = (owner: any); // Refined\n-        if (!shouldFilterVirtual(ownerInfo)) {\n+        if (!shouldFilterVirtual(ownerInfo, null)) {\n           return ownerInfo;\n         }\n         owner = ownerInfo.owner;\n@@ -3937,7 +4134,7 @@ export function attach(\n   function findNearestOwnerInstance(\n     parentInstance: null | DevToolsInstance,\n     owner: void | null | ReactComponentInfo | Fiber,\n-  ): null | DevToolsInstance {\n+  ): null | FiberInstance | VirtualInstance {\n     if (owner == null) {\n       return null;\n     }\n@@ -3952,6 +4149,9 @@ export function attach(\n         // needs a duck type check anyway.\n         parentInstance.data === (owner: any).alternate\n       ) {\n+        if (parentInstance.kind === FILTERED_FIBER_INSTANCE) {\n+          return null;\n+        }\n         return parentInstance;\n       }\n       parentInstance = parentInstance.parent;\n@@ -4029,7 +4229,11 @@ export function attach(\n     if (devtoolsInstance.kind === VIRTUAL_INSTANCE) {\n       return inspectVirtualInstanceRaw(devtoolsInstance);\n     }\n-    return inspectFiberInstanceRaw(devtoolsInstance);\n+    if (devtoolsInstance.kind === FIBER_INSTANCE) {\n+      return inspectFiberInstanceRaw(devtoolsInstance);\n+    }\n+    (devtoolsInstance: FilteredFiberInstance); // assert exhaustive\n+    throw new Error('Unsupported instance kind');\n   }\n \n   function inspectFiberInstanceRaw(\n@@ -4332,7 +4536,7 @@ export function attach(\n     let targetErrorBoundaryID = null;\n     let parent = virtualInstance.parent;\n     while (parent !== null) {\n-      if (parent.kind === FIBER_INSTANCE) {\n+      if (parent.kind !== VIRTUAL_INSTANCE) {\n         targetErrorBoundaryID = getNearestErrorBoundaryID(parent.data);\n         let current = parent.data;\n         while (current.return !== null) {\n@@ -5123,7 +5327,9 @@ export function attach(\n   ) {\n     // We don't need to convert milliseconds to microseconds in this case,\n     // because the profiling summary is JSON serialized.\n-    target.push([instance.id, instance.treeBaseDuration]);\n+    if (instance.kind !== FILTERED_FIBER_INSTANCE) {\n+      target.push([instance.id, instance.treeBaseDuration]);\n+    }\n     for (\n       let child = instance.firstChild;\n       child !== null;\n@@ -5149,7 +5355,12 @@ export function attach(\n     idToContextsMap = new Map();\n \n     hook.getFiberRoots(rendererID).forEach(root => {\n-      const rootInstance = getFiberInstanceThrows(root.current);\n+      const rootInstance = rootToFiberInstanceMap.get(root);\n+      if (rootInstance === undefined) {\n+        throw new Error(\n+          'Expected the root instance to already exist when starting profiling',\n+        );\n+      }\n       const rootID = rootInstance.id;\n       ((displayNamesByRootID: any): DisplayNamesByRootID).set(\n         rootID,\n@@ -5337,7 +5548,7 @@ export function attach(\n   // In that case, we'll do some extra checks for matching mounts.\n   let trackedPath: Array<PathFrame> | null = null;\n   let trackedPathMatchFiber: Fiber | null = null; // This is the deepest unfiltered match of a Fiber.\n-  let trackedPathMatchInstance: DevToolsInstance | null = null; // This is the deepest matched filtered Instance.\n+  let trackedPathMatchInstance: FiberInstance | VirtualInstance | null = null; // This is the deepest matched filtered Instance.\n   let trackedPathMatchDepth = -1;\n   let mightBeOnTrackedPath = false;\n \n@@ -5356,7 +5567,7 @@ export function attach(\n   // The return value signals whether we should keep matching siblings or not.\n   function updateTrackedPathStateBeforeMount(\n     fiber: Fiber,\n-    fiberInstance: null | FiberInstance,\n+    fiberInstance: null | FiberInstance | FilteredFiberInstance,\n   ): boolean {\n     if (trackedPath === null || !mightBeOnTrackedPath) {\n       // Fast path: there's nothing to track so do nothing and ignore siblings.\n@@ -5385,7 +5596,7 @@ export function attach(\n       ) {\n         // We have our next match.\n         trackedPathMatchFiber = fiber;\n-        if (fiberInstance !== null) {\n+        if (fiberInstance !== null && fiberInstance.kind === FIBER_INSTANCE) {\n           trackedPathMatchInstance = fiberInstance;\n         }\n         trackedPathMatchDepth++;\n@@ -5546,8 +5757,13 @@ export function attach(\n       case HostRoot:\n         // Roots don't have a real displayName, index, or key.\n         // Instead, we'll use the pseudo key (childDisplayName:indexWithThatName).\n-        const id = getFiberIDThrows(fiber);\n-        const pseudoKey = rootPseudoKeys.get(id);\n+        const rootInstance = rootToFiberInstanceMap.get(fiber.stateNode);\n+        if (rootInstance === undefined) {\n+          throw new Error(\n+            'Expected the root instance to exist when computing a path',\n+          );\n+        }\n+        const pseudoKey = rootPseudoKeys.get(rootInstance.id);\n         if (pseudoKey === undefined) {\n           throw new Error('Expected mounted root to have known pseudo key.');\n         }\n@@ -5723,7 +5939,7 @@ export function attach(\n     flushInitialOperations,\n     getBestMatchForTrackedPath,\n     getDisplayNameForElementID,\n-    getNearestMountedHostInstance,\n+    getNearestMountedDOMNode,\n     getElementIDForHostInstance,\n     getInstanceAndStyle,\n     getOwnersList,\n@@ -5750,5 +5966,6 @@ export function attach(\n     storeAsGlobal,\n     unpatchConsoleForStrictMode,\n     updateComponentFilters,\n+    getEnvironmentNames,\n   };\n }"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/index.js",
                "git_diff": "@@ -73,7 +73,12 @@ export function initBackend(\n \n     // Inject any not-yet-injected renderers (if we didn't reload-and-profile)\n     if (rendererInterface == null) {\n-      if (typeof renderer.findFiberByHostInstance === 'function') {\n+      if (\n+        // v16-19\n+        typeof renderer.findFiberByHostInstance === 'function' ||\n+        // v16.8+\n+        renderer.currentDispatcherRef != null\n+      ) {\n         // react-reconciler v16+\n         rendererInterface = attach(hook, id, renderer, global);\n       } else if (renderer.ComponentTree) {"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/legacy/renderer.js",
                "git_diff": "@@ -145,15 +145,13 @@ export function attach(\n   let getElementIDForHostInstance: GetElementIDForHostInstance =\n     ((null: any): GetElementIDForHostInstance);\n   let findHostInstanceForInternalID: (id: number) => ?HostInstance;\n-  let getNearestMountedHostInstance = (\n-    node: HostInstance,\n-  ): null | HostInstance => {\n+  let getNearestMountedDOMNode = (node: Element): null | Element => {\n     // Not implemented.\n     return null;\n   };\n \n   if (renderer.ComponentTree) {\n-    getElementIDForHostInstance = (node, findNearestUnfilteredAncestor) => {\n+    getElementIDForHostInstance = node => {\n       const internalInstance =\n         renderer.ComponentTree.getClosestInstanceFromNode(node);\n       return internalInstanceToIDMap.get(internalInstance) || null;\n@@ -162,9 +160,7 @@ export function attach(\n       const internalInstance = idToInternalInstanceMap.get(id);\n       return renderer.ComponentTree.getNodeFromInstance(internalInstance);\n     };\n-    getNearestMountedHostInstance = (\n-      node: HostInstance,\n-    ): null | HostInstance => {\n+    getNearestMountedDOMNode = (node: Element): null | Element => {\n       const internalInstance =\n         renderer.ComponentTree.getClosestInstanceFromNode(node);\n       if (internalInstance != null) {\n@@ -173,7 +169,7 @@ export function attach(\n       return null;\n     };\n   } else if (renderer.Mount.getID && renderer.Mount.getNode) {\n-    getElementIDForHostInstance = (node, findNearestUnfilteredAncestor) => {\n+    getElementIDForHostInstance = node => {\n       // Not implemented.\n       return null;\n     };\n@@ -1078,6 +1074,11 @@ export function attach(\n     // Not implemented.\n   }\n \n+  function getEnvironmentNames(): Array<string> {\n+    // No RSC support.\n+    return [];\n+  }\n+\n   function setTraceUpdatesEnabled(enabled: boolean) {\n     // Not implemented.\n   }\n@@ -1121,7 +1122,7 @@ export function attach(\n     flushInitialOperations,\n     getBestMatchForTrackedPath,\n     getDisplayNameForElementID,\n-    getNearestMountedHostInstance,\n+    getNearestMountedDOMNode,\n     getElementIDForHostInstance,\n     getInstanceAndStyle,\n     findHostInstancesForElementID: (id: number) => {\n@@ -1152,5 +1153,6 @@ export function attach(\n     storeAsGlobal,\n     unpatchConsoleForStrictMode,\n     updateComponentFilters,\n+    getEnvironmentNames,\n   };\n }"
            },
            {
                "file": "packages/react-devtools-shared/src/backend/types.js",
                "git_diff": "@@ -90,7 +90,6 @@ export type GetDisplayNameForElementID = (id: number) => string | null;\n \n export type GetElementIDForHostInstance = (\n   component: HostInstance,\n-  findNearestUnfilteredAncestor?: boolean,\n ) => number | null;\n export type FindHostInstancesForElementID = (\n   id: number,\n@@ -106,10 +105,11 @@ export type Lane = number;\n export type Lanes = number;\n \n export type ReactRenderer = {\n-  findFiberByHostInstance: (hostInstance: HostInstance) => Fiber | null,\n   version: string,\n   rendererPackageName: string,\n   bundleType: BundleType,\n+  // 16.0+ - To be removed in future versions.\n+  findFiberByHostInstance?: (hostInstance: HostInstance) => Fiber | null,\n   // 16.9+\n   overrideHookState?: ?(\n     fiber: Object,\n@@ -358,9 +358,7 @@ export type RendererInterface = {\n   findHostInstancesForElementID: FindHostInstancesForElementID,\n   flushInitialOperations: () => void,\n   getBestMatchForTrackedPath: () => PathMatch | null,\n-  getNearestMountedHostInstance: (\n-    component: HostInstance,\n-  ) => HostInstance | null,\n+  getNearestMountedDOMNode: (component: Element) => Element | null,\n   getElementIDForHostInstance: GetElementIDForHostInstance,\n   getDisplayNameForElementID: GetDisplayNameForElementID,\n   getInstanceAndStyle(id: number): InstanceAndStyle,\n@@ -416,6 +414,7 @@ export type RendererInterface = {\n   ) => void,\n   unpatchConsoleForStrictMode: () => void,\n   updateComponentFilters: (componentFilters: Array<ComponentFilter>) => void,\n+  getEnvironmentNames: () => Array<string>,\n \n   // Timeline profiler interface\n "
            },
            {
                "file": "packages/react-devtools-shared/src/bridge.js",
                "git_diff": "@@ -189,6 +189,7 @@ export type BackendEvents = {\n   operations: [Array<number>],\n   ownersList: [OwnersList],\n   overrideComponentFilters: [Array<ComponentFilter>],\n+  environmentNames: [Array<string>],\n   profilingData: [ProfilingDataBackend],\n   profilingStatus: [boolean],\n   reloadAppForProfiling: [],\n@@ -237,6 +238,7 @@ type FrontendEvents = {\n   stopProfiling: [],\n   storeAsGlobal: [StoreAsGlobalParams],\n   updateComponentFilters: [Array<ComponentFilter>],\n+  getEnvironmentNames: [],\n   updateConsolePatchSettings: [ConsolePatchSettings],\n   viewAttributeSource: [ViewAttributeSourceParams],\n   viewElementSource: [ElementAndRendererID],"
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Settings/ComponentsSettings.js",
                "git_diff": "@@ -15,6 +15,7 @@ import {\n   useMemo,\n   useRef,\n   useState,\n+  use,\n } from 'react';\n import {\n   LOCAL_STORAGE_OPEN_IN_EDITOR_URL,\n@@ -31,6 +32,7 @@ import {\n   ComponentFilterElementType,\n   ComponentFilterHOC,\n   ComponentFilterLocation,\n+  ComponentFilterEnvironmentName,\n   ElementTypeClass,\n   ElementTypeContext,\n   ElementTypeFunction,\n@@ -52,11 +54,16 @@ import type {\n   ElementType,\n   ElementTypeComponentFilter,\n   RegExpComponentFilter,\n+  EnvironmentNameComponentFilter,\n } from 'react-devtools-shared/src/frontend/types';\n \n const vscodeFilepath = 'vscode://file/{path}:{line}';\n \n-export default function ComponentsSettings(_: {}): React.Node {\n+export default function ComponentsSettings({\n+  environmentNames,\n+}: {\n+  environmentNames: Promise<Array<string>>,\n+}): React.Node {\n   const store = useContext(StoreContext);\n   const {parseHookNames, setParseHookNames} = useContext(SettingsContext);\n \n@@ -101,6 +108,30 @@ export default function ComponentsSettings(_: {}): React.Node {\n     Array<ComponentFilter>,\n   >(() => [...store.componentFilters]);\n \n+  const usedEnvironmentNames = use(environmentNames);\n+\n+  const resolvedEnvironmentNames = useMemo(() => {\n+    const set = new Set(usedEnvironmentNames);\n+    // If there are other filters already specified but are not currently\n+    // on the page, we still allow them as options.\n+    for (let i = 0; i < componentFilters.length; i++) {\n+      const filter = componentFilters[i];\n+      if (filter.type === ComponentFilterEnvironmentName) {\n+        set.add(filter.value);\n+      }\n+    }\n+    // Client is special and is always available as a default.\n+    if (set.size > 0) {\n+      // Only show any options at all if there's any other option already\n+      // used by a filter or if any environments are used by the page.\n+      // Note that \"Client\" can have been added above which would mean\n+      // that we should show it as an option regardless if it's the only\n+      // option.\n+      set.add('Client');\n+    }\n+    return Array.from(set).sort();\n+  }, [usedEnvironmentNames, componentFilters]);\n+\n   const addFilter = useCallback(() => {\n     setComponentFilters(prevComponentFilters => {\n       return [\n@@ -146,6 +177,13 @@ export default function ComponentsSettings(_: {}): React.Node {\n               isEnabled: componentFilter.isEnabled,\n               isValid: true,\n             };\n+          } else if (type === ComponentFilterEnvironmentName) {\n+            cloned[index] = {\n+              type: ComponentFilterEnvironmentName,\n+              isEnabled: componentFilter.isEnabled,\n+              isValid: true,\n+              value: 'Client',\n+            };\n           }\n         }\n         return cloned;\n@@ -210,6 +248,29 @@ export default function ComponentsSettings(_: {}): React.Node {\n     [],\n   );\n \n+  const updateFilterValueEnvironmentName = useCallback(\n+    (componentFilter: ComponentFilter, value: string) => {\n+      if (componentFilter.type !== ComponentFilterEnvironmentName) {\n+        throw Error('Invalid value for environment name filter');\n+      }\n+\n+      setComponentFilters(prevComponentFilters => {\n+        const cloned: Array<ComponentFilter> = [...prevComponentFilters];\n+        if (componentFilter.type === ComponentFilterEnvironmentName) {\n+          const index = prevComponentFilters.indexOf(componentFilter);\n+          if (index >= 0) {\n+            cloned[index] = {\n+              ...componentFilter,\n+              value,\n+            };\n+          }\n+        }\n+        return cloned;\n+      });\n+    },\n+    [],\n+  );\n+\n   const removeFilter = useCallback((index: number) => {\n     setComponentFilters(prevComponentFilters => {\n       const cloned: Array<ComponentFilter> = [...prevComponentFilters];\n@@ -246,6 +307,11 @@ export default function ComponentsSettings(_: {}): React.Node {\n               ...((cloned[index]: any): BooleanComponentFilter),\n               isEnabled,\n             };\n+          } else if (componentFilter.type === ComponentFilterEnvironmentName) {\n+            cloned[index] = {\n+              ...((cloned[index]: any): EnvironmentNameComponentFilter),\n+              isEnabled,\n+            };\n           }\n         }\n         return cloned;\n@@ -380,10 +446,16 @@ export default function ComponentsSettings(_: {}): React.Node {\n                   <option value={ComponentFilterDisplayName}>name</option>\n                   <option value={ComponentFilterElementType}>type</option>\n                   <option value={ComponentFilterHOC}>hoc</option>\n+                  {resolvedEnvironmentNames.length > 0 && (\n+                    <option value={ComponentFilterEnvironmentName}>\n+                      environment\n+                    </option>\n+                  )}\n                 </select>\n               </td>\n               <td className={styles.TableCell}>\n-                {componentFilter.type === ComponentFilterElementType &&\n+                {(componentFilter.type === ComponentFilterElementType ||\n+                  componentFilter.type === ComponentFilterEnvironmentName) &&\n                   'equals'}\n                 {(componentFilter.type === ComponentFilterLocation ||\n                   componentFilter.type === ComponentFilterDisplayName) &&\n@@ -428,6 +500,23 @@ export default function ComponentsSettings(_: {}): React.Node {\n                     value={componentFilter.value}\n                   />\n                 )}\n+                {componentFilter.type === ComponentFilterEnvironmentName && (\n+                  <select\n+                    className={styles.Select}\n+                    value={componentFilter.value}\n+                    onChange={({currentTarget}) =>\n+                      updateFilterValueEnvironmentName(\n+                        componentFilter,\n+                        currentTarget.value,\n+                      )\n+                    }>\n+                    {resolvedEnvironmentNames.map(name => (\n+                      <option key={name} value={name}>\n+                        {name}\n+                      </option>\n+                    ))}\n+                  </select>\n+                )}\n               </td>\n               <td className={styles.TableCell}>\n                 <Button"
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Settings/SettingsModal.js",
                "git_diff": "@@ -58,7 +58,8 @@ export default function SettingsModal(_: {}): React.Node {\n }\n \n function SettingsModalImpl(_: {}) {\n-  const {setIsModalShowing} = useContext(SettingsModalContext);\n+  const {setIsModalShowing, environmentNames} =\n+    useContext(SettingsModalContext);\n   const dismissModal = useCallback(\n     () => setIsModalShowing(false),\n     [setIsModalShowing],\n@@ -81,7 +82,7 @@ function SettingsModalImpl(_: {}) {\n   let view = null;\n   switch (selectedTabID) {\n     case 'components':\n-      view = <ComponentsSettings />;\n+      view = <ComponentsSettings environmentNames={environmentNames} />;\n       break;\n     // $FlowFixMe[incompatible-type] is this missing in TabID?\n     case 'debugging':"
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Settings/SettingsModalContext.js",
                "git_diff": "@@ -10,36 +10,67 @@\n import type {ReactContext} from 'shared/ReactTypes';\n \n import * as React from 'react';\n-import {createContext, useMemo, useState} from 'react';\n+import {\n+  createContext,\n+  useContext,\n+  useCallback,\n+  useState,\n+  startTransition,\n+} from 'react';\n+\n+import {BridgeContext} from '../context';\n+import type {FrontendBridge} from '../../../bridge';\n \n export type DisplayDensity = 'comfortable' | 'compact';\n export type Theme = 'auto' | 'light' | 'dark';\n \n type Context = {\n   isModalShowing: boolean,\n   setIsModalShowing: (value: boolean) => void,\n-  ...\n+  environmentNames: null | Promise<Array<string>>,\n };\n \n const SettingsModalContext: ReactContext<Context> = createContext<Context>(\n   ((null: any): Context),\n );\n SettingsModalContext.displayName = 'SettingsModalContext';\n \n+function fetchEnvironmentNames(bridge: FrontendBridge): Promise<Array<string>> {\n+  return new Promise(resolve => {\n+    function onEnvironmentNames(names: Array<string>) {\n+      bridge.removeListener('environmentNames', onEnvironmentNames);\n+      resolve(names);\n+    }\n+    bridge.addListener('environmentNames', onEnvironmentNames);\n+    bridge.send('getEnvironmentNames');\n+  });\n+}\n+\n function SettingsModalContextController({\n   children,\n }: {\n   children: React$Node,\n }): React.Node {\n-  const [isModalShowing, setIsModalShowing] = useState<boolean>(false);\n+  const bridge = useContext(BridgeContext);\n \n-  const value = useMemo(\n-    () => ({isModalShowing, setIsModalShowing}),\n-    [isModalShowing, setIsModalShowing],\n-  );\n+  const setIsModalShowing: boolean => void = useCallback((value: boolean) => {\n+    startTransition(() => {\n+      setContext({\n+        isModalShowing: value,\n+        setIsModalShowing,\n+        environmentNames: value ? fetchEnvironmentNames(bridge) : null,\n+      });\n+    });\n+  });\n+\n+  const [currentContext, setContext] = useState<Context>({\n+    isModalShowing: false,\n+    setIsModalShowing,\n+    environmentNames: null,\n+  });\n \n   return (\n-    <SettingsModalContext.Provider value={value}>\n+    <SettingsModalContext.Provider value={currentContext}>\n       {children}\n     </SettingsModalContext.Provider>\n   );"
            },
            {
                "file": "packages/react-devtools-shared/src/frontend/types.js",
                "git_diff": "@@ -76,8 +76,9 @@ export const ComponentFilterElementType = 1;\n export const ComponentFilterDisplayName = 2;\n export const ComponentFilterLocation = 3;\n export const ComponentFilterHOC = 4;\n+export const ComponentFilterEnvironmentName = 5;\n \n-export type ComponentFilterType = 1 | 2 | 3 | 4;\n+export type ComponentFilterType = 1 | 2 | 3 | 4 | 5;\n \n // Hide all elements of types in this Set.\n // We hide host components only by default.\n@@ -102,10 +103,18 @@ export type BooleanComponentFilter = {\n   type: 4,\n };\n \n+export type EnvironmentNameComponentFilter = {\n+  isEnabled: boolean,\n+  isValid: boolean,\n+  type: 5,\n+  value: string,\n+};\n+\n export type ComponentFilter =\n   | BooleanComponentFilter\n   | ElementTypeComponentFilter\n-  | RegExpComponentFilter;\n+  | RegExpComponentFilter\n+  | EnvironmentNameComponentFilter;\n \n export type HookName = string | null;\n // Map of hook source (\"<filename>:<line-number>:<column-number>\") to name."
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMFiberAsync-test.js",
                "git_diff": "@@ -744,7 +744,7 @@ describe('ReactDOMFiberAsync', () => {\n       // Because it suspended, it remains on the current path\n       expect(div.textContent).toBe('/path/a');\n     });\n-    assertLog([]);\n+    assertLog(gate('enableSiblingPrerendering') ? ['Suspend! [/path/b]'] : []);\n \n     await act(async () => {\n       resolvePromise();"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMForm-test.js",
                "git_diff": "@@ -699,7 +699,15 @@ describe('ReactDOMForm', () => {\n     // This should suspend because form actions are implicitly wrapped\n     // in startTransition.\n     await submit(formRef.current);\n-    assertLog(['Pending...', 'Suspend! [Updated]', 'Loading...']);\n+    assertLog([\n+      'Pending...',\n+      'Suspend! [Updated]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [Updated]', 'Loading...']\n+        : []),\n+    ]);\n     expect(container.textContent).toBe('Pending...Initial');\n \n     await act(() => resolveText('Updated'));\n@@ -736,7 +744,15 @@ describe('ReactDOMForm', () => {\n \n     // Update\n     await submit(formRef.current);\n-    assertLog(['Pending...', 'Suspend! [Count: 1]', 'Loading...']);\n+    assertLog([\n+      'Pending...',\n+      'Suspend! [Count: 1]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [Count: 1]', 'Loading...']\n+        : []),\n+    ]);\n     expect(container.textContent).toBe('Pending...Count: 0');\n \n     await act(() => resolveText('Count: 1'));\n@@ -745,7 +761,15 @@ describe('ReactDOMForm', () => {\n \n     // Update again\n     await submit(formRef.current);\n-    assertLog(['Pending...', 'Suspend! [Count: 2]', 'Loading...']);\n+    assertLog([\n+      'Pending...',\n+      'Suspend! [Count: 2]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [Count: 2]', 'Loading...']\n+        : []),\n+    ]);\n     expect(container.textContent).toBe('Pending...Count: 1');\n \n     await act(() => resolveText('Count: 2'));\n@@ -789,7 +813,14 @@ describe('ReactDOMForm', () => {\n     assertLog(['Async action started', 'Pending...']);\n \n     await act(() => resolveText('Wait'));\n-    assertLog(['Suspend! [Updated]', 'Loading...']);\n+    assertLog([\n+      'Suspend! [Updated]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [Updated]', 'Loading...']\n+        : []),\n+    ]);\n     expect(container.textContent).toBe('Pending...Initial');\n \n     await act(() => resolveText('Updated'));\n@@ -1475,7 +1506,15 @@ describe('ReactDOMForm', () => {\n     // Now dispatch inside of a transition. This one does not trigger a\n     // loading state.\n     await act(() => startTransition(() => dispatch()));\n-    assertLog(['Count: 1', 'Suspend! [Count: 2]', 'Loading...']);\n+    assertLog([\n+      'Count: 1',\n+      'Suspend! [Count: 2]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [Count: 2]', 'Loading...']\n+        : []),\n+    ]);\n     expect(container.textContent).toBe('Count: 1');\n \n     await act(() => resolveText('Count: 2'));\n@@ -1495,7 +1534,11 @@ describe('ReactDOMForm', () => {\n \n     const root = ReactDOMClient.createRoot(container);\n     await act(() => root.render(<App />));\n-    assertLog(['Suspend! [Count: 0]']);\n+    assertLog([\n+      'Suspend! [Count: 0]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [Count: 0]'] : []),\n+    ]);\n     await act(() => resolveText('Count: 0'));\n     assertLog(['Count: 0']);\n \n@@ -1508,7 +1551,11 @@ describe('ReactDOMForm', () => {\n         {withoutStack: true},\n       ],\n     ]);\n-    assertLog(['Suspend! [Count: 1]']);\n+    assertLog([\n+      'Suspend! [Count: 1]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [Count: 1]'] : []),\n+    ]);\n     expect(container.textContent).toBe('Count: 0');\n   });\n "
            },
            {
                "file": "packages/react-reconciler/src/ReactFiber.js",
                "git_diff": "@@ -404,10 +404,16 @@ export function createWorkInProgress(current: Fiber, pendingProps: any): Fiber {\n   workInProgress.dependencies =\n     currentDependencies === null\n       ? null\n-      : {\n-          lanes: currentDependencies.lanes,\n-          firstContext: currentDependencies.firstContext,\n-        };\n+      : __DEV__\n+        ? {\n+            lanes: currentDependencies.lanes,\n+            firstContext: currentDependencies.firstContext,\n+            _debugThenableState: currentDependencies._debugThenableState,\n+          }\n+        : {\n+            lanes: currentDependencies.lanes,\n+            firstContext: currentDependencies.firstContext,\n+          };\n \n   // These will be overridden during the parent's reconciliation\n   workInProgress.sibling = current.sibling;\n@@ -503,10 +509,16 @@ export function resetWorkInProgress(\n     workInProgress.dependencies =\n       currentDependencies === null\n         ? null\n-        : {\n-            lanes: currentDependencies.lanes,\n-            firstContext: currentDependencies.firstContext,\n-          };\n+        : __DEV__\n+          ? {\n+              lanes: currentDependencies.lanes,\n+              firstContext: currentDependencies.firstContext,\n+              _debugThenableState: currentDependencies._debugThenableState,\n+            }\n+          : {\n+              lanes: currentDependencies.lanes,\n+              firstContext: currentDependencies.firstContext,\n+            };\n \n     if (enableProfilerTimer) {\n       // Note: We don't reset the actualTime counts. It's useful to accumulate"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -637,6 +637,18 @@ function finishRenderingHooks<Props, SecondArg>(\n ): void {\n   if (__DEV__) {\n     workInProgress._debugHookTypes = hookTypesDev;\n+    // Stash the thenable state for use by DevTools.\n+    if (workInProgress.dependencies === null) {\n+      if (thenableState !== null) {\n+        workInProgress.dependencies = {\n+          lanes: NoLanes,\n+          firstContext: null,\n+          _debugThenableState: thenableState,\n+        };\n+      }\n+    } else {\n+      workInProgress.dependencies._debugThenableState = thenableState;\n+    }\n   }\n \n   // We can assume the previous dispatcher is always this one, since we set it"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberLane.js",
                "git_diff": "@@ -229,28 +229,49 @@ export function getNextLanes(root: FiberRoot, wipLanes: Lanes): Lanes {\n \n   const suspendedLanes = root.suspendedLanes;\n   const pingedLanes = root.pingedLanes;\n+  const warmLanes = root.warmLanes;\n \n   // Do not work on any idle work until all the non-idle work has finished,\n   // even if the work is suspended.\n   const nonIdlePendingLanes = pendingLanes & NonIdleLanes;\n   if (nonIdlePendingLanes !== NoLanes) {\n+    // First check for fresh updates.\n     const nonIdleUnblockedLanes = nonIdlePendingLanes & ~suspendedLanes;\n     if (nonIdleUnblockedLanes !== NoLanes) {\n       nextLanes = getHighestPriorityLanes(nonIdleUnblockedLanes);\n     } else {\n+      // No fresh updates. Check if suspended work has been pinged.\n       const nonIdlePingedLanes = nonIdlePendingLanes & pingedLanes;\n       if (nonIdlePingedLanes !== NoLanes) {\n         nextLanes = getHighestPriorityLanes(nonIdlePingedLanes);\n+      } else {\n+        // Nothing has been pinged. Check for lanes that need to be prewarmed.\n+        const lanesToPrewarm = nonIdlePendingLanes & ~warmLanes;\n+        if (lanesToPrewarm !== NoLanes) {\n+          nextLanes = getHighestPriorityLanes(lanesToPrewarm);\n+        }\n       }\n     }\n   } else {\n     // The only remaining work is Idle.\n+    // TODO: Idle isn't really used anywhere, and the thinking around\n+    // speculative rendering has evolved since this was implemented. Consider\n+    // removing until we've thought about this again.\n+\n+    // First check for fresh updates.\n     const unblockedLanes = pendingLanes & ~suspendedLanes;\n     if (unblockedLanes !== NoLanes) {\n       nextLanes = getHighestPriorityLanes(unblockedLanes);\n     } else {\n+      // No fresh updates. Check if suspended work has been pinged.\n       if (pingedLanes !== NoLanes) {\n         nextLanes = getHighestPriorityLanes(pingedLanes);\n+      } else {\n+        // Nothing has been pinged. Check for lanes that need to be prewarmed.\n+        const lanesToPrewarm = pendingLanes & ~warmLanes;\n+        if (lanesToPrewarm !== NoLanes) {\n+          nextLanes = getHighestPriorityLanes(lanesToPrewarm);\n+        }\n       }\n     }\n   }\n@@ -335,6 +356,21 @@ export function getNextLanesToFlushSync(\n   return NoLanes;\n }\n \n+export function checkIfRootIsPrerendering(\n+  root: FiberRoot,\n+  renderLanes: Lanes,\n+): boolean {\n+  const pendingLanes = root.pendingLanes;\n+  const suspendedLanes = root.suspendedLanes;\n+  const pingedLanes = root.pingedLanes;\n+  // Remove lanes that are suspended (but not pinged)\n+  const unblockedLanes = pendingLanes & ~(suspendedLanes & ~pingedLanes);\n+\n+  // If there are no unsuspended or pinged lanes, that implies that we're\n+  // performing a prerender.\n+  return (unblockedLanes & renderLanes) === 0;\n+}\n+\n export function getEntangledLanes(root: FiberRoot, renderLanes: Lanes): Lanes {\n   let entangledLanes = renderLanes;\n \n@@ -670,17 +706,27 @@ export function markRootUpdated(root: FiberRoot, updateLane: Lane) {\n   if (updateLane !== IdleLane) {\n     root.suspendedLanes = NoLanes;\n     root.pingedLanes = NoLanes;\n+    root.warmLanes = NoLanes;\n   }\n }\n \n export function markRootSuspended(\n   root: FiberRoot,\n   suspendedLanes: Lanes,\n   spawnedLane: Lane,\n+  didSkipSuspendedSiblings: boolean,\n ) {\n   root.suspendedLanes |= suspendedLanes;\n   root.pingedLanes &= ~suspendedLanes;\n \n+  if (!didSkipSuspendedSiblings) {\n+    // Mark these lanes as warm so we know there's nothing else to work on.\n+    root.warmLanes |= suspendedLanes;\n+  } else {\n+    // Render unwound without attempting all the siblings. Do no mark the lanes\n+    // as warm. This will cause a prewarm render to be scheduled.\n+  }\n+\n   // The suspended lanes are no longer CPU-bound. Clear their expiration times.\n   const expirationTimes = root.expirationTimes;\n   let lanes = suspendedLanes;\n@@ -700,6 +746,9 @@ export function markRootSuspended(\n \n export function markRootPinged(root: FiberRoot, pingedLanes: Lanes) {\n   root.pingedLanes |= root.suspendedLanes & pingedLanes;\n+  // The data that just resolved could have unblocked additional children, which\n+  // will also need to be prewarmed if something suspends again.\n+  root.warmLanes &= ~pingedLanes;\n }\n \n export function markRootFinished(\n@@ -714,6 +763,7 @@ export function markRootFinished(\n   // Let's try everything again\n   root.suspendedLanes = NoLanes;\n   root.pingedLanes = NoLanes;\n+  root.warmLanes = NoLanes;\n \n   root.expiredLanes &= remainingLanes;\n "
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberNewContext.js",
                "git_diff": "@@ -825,10 +825,16 @@ function readContextForConsumer_withSelect<C>(\n \n       // This is the first dependency for this component. Create a new list.\n       lastContextDependency = contextItem;\n-      consumer.dependencies = {\n-        lanes: NoLanes,\n-        firstContext: contextItem,\n-      };\n+      consumer.dependencies = __DEV__\n+        ? {\n+            lanes: NoLanes,\n+            firstContext: contextItem,\n+            _debugThenableState: null,\n+          }\n+        : {\n+            lanes: NoLanes,\n+            firstContext: contextItem,\n+          };\n       if (enableLazyContextPropagation) {\n         consumer.flags |= NeedsPropagation;\n       }\n@@ -869,10 +875,16 @@ function readContextForConsumer<C>(\n \n       // This is the first dependency for this component. Create a new list.\n       lastContextDependency = contextItem;\n-      consumer.dependencies = {\n-        lanes: NoLanes,\n-        firstContext: contextItem,\n-      };\n+      consumer.dependencies = __DEV__\n+        ? {\n+            lanes: NoLanes,\n+            firstContext: contextItem,\n+            _debugThenableState: null,\n+          }\n+        : {\n+            lanes: NoLanes,\n+            firstContext: contextItem,\n+          };\n       if (enableLazyContextPropagation) {\n         consumer.flags |= NeedsPropagation;\n       }"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberRoot.js",
                "git_diff": "@@ -75,6 +75,7 @@ function FiberRootNode(\n   this.pendingLanes = NoLanes;\n   this.suspendedLanes = NoLanes;\n   this.pingedLanes = NoLanes;\n+  this.warmLanes = NoLanes;\n   this.expiredLanes = NoLanes;\n   this.finishedLanes = NoLanes;\n   this.errorRecoveryDisabledLanes = NoLanes;"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberWorkLoop.js",
                "git_diff": "@@ -43,6 +43,7 @@ import {\n   disableLegacyMode,\n   disableDefaultPropsExceptForClasses,\n   disableStringRefs,\n+  enableSiblingPrerendering,\n } from 'shared/ReactFeatureFlags';\n import ReactSharedInternals from 'shared/ReactSharedInternals';\n import is from 'shared/objectIs';\n@@ -160,6 +161,7 @@ import {\n   SyncUpdateLanes,\n   UpdateLanes,\n   claimNextTransitionLane,\n+  checkIfRootIsPrerendering,\n } from './ReactFiberLane';\n import {\n   DiscreteEventPriority,\n@@ -328,6 +330,15 @@ const SuspendedOnHydration: SuspendedReason = 8;\n let workInProgressSuspendedReason: SuspendedReason = NotSuspended;\n let workInProgressThrownValue: mixed = null;\n \n+// Tracks whether any siblings were skipped during the unwind phase after\n+// something suspends. Used to determine whether to schedule another render\n+// to prewarm the skipped siblings.\n+let workInProgressRootDidSkipSuspendedSiblings: boolean = false;\n+// Whether the work-in-progress render is the result of a prewarm/prerender.\n+// This tells us whether or not we should render the siblings after\n+// something suspends.\n+let workInProgressRootIsPrerendering: boolean = false;\n+\n // Whether a ping listener was attached during this render. This is slightly\n // different that whether something suspended, because we don't add multiple\n // listeners to a promise we've already seen (per root and lane).\n@@ -730,6 +741,7 @@ export function scheduleUpdateOnFiber(\n       root,\n       workInProgressRootRenderLanes,\n       workInProgressDeferredLane,\n+      workInProgressRootDidSkipSuspendedSiblings,\n     );\n   }\n \n@@ -796,6 +808,7 @@ export function scheduleUpdateOnFiber(\n           root,\n           workInProgressRootRenderLanes,\n           workInProgressDeferredLane,\n+          workInProgressRootDidSkipSuspendedSiblings,\n         );\n       }\n     }\n@@ -908,7 +921,12 @@ export function performConcurrentWorkOnRoot(\n         // The render unwound without completing the tree. This happens in special\n         // cases where need to exit the current render without producing a\n         // consistent tree or committing.\n-        markRootSuspended(root, lanes, NoLane);\n+        markRootSuspended(\n+          root,\n+          lanes,\n+          NoLane,\n+          workInProgressRootDidSkipSuspendedSiblings,\n+        );\n       } else {\n         // The render completed.\n \n@@ -964,7 +982,12 @@ export function performConcurrentWorkOnRoot(\n         }\n         if (exitStatus === RootFatalErrored) {\n           prepareFreshStack(root, NoLanes);\n-          markRootSuspended(root, lanes, NoLane);\n+          markRootSuspended(\n+            root,\n+            lanes,\n+            NoLane,\n+            workInProgressRootDidSkipSuspendedSiblings,\n+          );\n           break;\n         }\n \n@@ -1087,7 +1110,12 @@ function finishConcurrentRender(\n         // This is a transition, so we should exit without committing a\n         // placeholder and without scheduling a timeout. Delay indefinitely\n         // until we receive more data.\n-        markRootSuspended(root, lanes, workInProgressDeferredLane);\n+        markRootSuspended(\n+          root,\n+          lanes,\n+          workInProgressDeferredLane,\n+          workInProgressRootDidSkipSuspendedSiblings,\n+        );\n         return;\n       }\n       // Commit the placeholder.\n@@ -1131,7 +1159,12 @@ function finishConcurrentRender(\n \n       // Don't bother with a very short suspense time.\n       if (msUntilTimeout > 10) {\n-        markRootSuspended(root, lanes, workInProgressDeferredLane);\n+        markRootSuspended(\n+          root,\n+          lanes,\n+          workInProgressDeferredLane,\n+          workInProgressRootDidSkipSuspendedSiblings,\n+        );\n \n         const nextLanes = getNextLanes(root, NoLanes);\n         if (nextLanes !== NoLanes) {\n@@ -1155,6 +1188,7 @@ function finishConcurrentRender(\n             workInProgressRootDidIncludeRecursiveRenderUpdate,\n             lanes,\n             workInProgressDeferredLane,\n+            workInProgressRootDidSkipSuspendedSiblings,\n           ),\n           msUntilTimeout,\n         );\n@@ -1169,6 +1203,7 @@ function finishConcurrentRender(\n       workInProgressRootDidIncludeRecursiveRenderUpdate,\n       lanes,\n       workInProgressDeferredLane,\n+      workInProgressRootDidSkipSuspendedSiblings,\n     );\n   }\n }\n@@ -1181,6 +1216,7 @@ function commitRootWhenReady(\n   didIncludeRenderPhaseUpdate: boolean,\n   lanes: Lanes,\n   spawnedLane: Lane,\n+  didSkipSuspendedSiblings: boolean,\n ) {\n   // TODO: Combine retry throttling with Suspensey commits. Right now they run\n   // one after the other.\n@@ -1220,7 +1256,7 @@ function commitRootWhenReady(\n           didIncludeRenderPhaseUpdate,\n         ),\n       );\n-      markRootSuspended(root, lanes, spawnedLane);\n+      markRootSuspended(root, lanes, spawnedLane, didSkipSuspendedSiblings);\n       return;\n     }\n   }\n@@ -1332,6 +1368,7 @@ function markRootSuspended(\n   root: FiberRoot,\n   suspendedLanes: Lanes,\n   spawnedLane: Lane,\n+  didSkipSuspendedSiblings: boolean,\n ) {\n   // When suspending, we should always exclude lanes that were pinged or (more\n   // rarely, since we try to avoid it) updated during the render phase.\n@@ -1340,7 +1377,12 @@ function markRootSuspended(\n     suspendedLanes,\n     workInProgressRootInterleavedUpdatedLanes,\n   );\n-  _markRootSuspended(root, suspendedLanes, spawnedLane);\n+  _markRootSuspended(\n+    root,\n+    suspendedLanes,\n+    spawnedLane,\n+    didSkipSuspendedSiblings,\n+  );\n }\n \n // This is the entry point for synchronous tasks that don't go\n@@ -1392,7 +1434,7 @@ export function performSyncWorkOnRoot(root: FiberRoot, lanes: Lanes): null {\n \n   if (exitStatus === RootFatalErrored) {\n     prepareFreshStack(root, NoLanes);\n-    markRootSuspended(root, lanes, NoLane);\n+    markRootSuspended(root, lanes, NoLane, false);\n     ensureRootIsScheduled(root);\n     return null;\n   }\n@@ -1401,7 +1443,12 @@ export function performSyncWorkOnRoot(root: FiberRoot, lanes: Lanes): null {\n     // The render unwound without completing the tree. This happens in special\n     // cases where need to exit the current render without producing a\n     // consistent tree or committing.\n-    markRootSuspended(root, lanes, workInProgressDeferredLane);\n+    markRootSuspended(\n+      root,\n+      lanes,\n+      workInProgressDeferredLane,\n+      workInProgressRootDidSkipSuspendedSiblings,\n+    );\n     ensureRootIsScheduled(root);\n     return null;\n   }\n@@ -1635,6 +1682,8 @@ function prepareFreshStack(root: FiberRoot, lanes: Lanes): Fiber {\n   workInProgressRootRenderLanes = lanes;\n   workInProgressSuspendedReason = NotSuspended;\n   workInProgressThrownValue = null;\n+  workInProgressRootDidSkipSuspendedSiblings = false;\n+  workInProgressRootIsPrerendering = checkIfRootIsPrerendering(root, lanes);\n   workInProgressRootDidAttachPingListener = false;\n   workInProgressRootExitStatus = RootInProgress;\n   workInProgressRootSkippedLanes = NoLanes;\n@@ -1700,6 +1749,10 @@ function handleThrow(root: FiberRoot, thrownValue: any): void {\n     // deprecate the old API in favor of `use`.\n     thrownValue = getSuspendedThenable();\n     workInProgressSuspendedReason =\n+      // TODO: Suspending the work loop during the render phase is\n+      // currently not compatible with sibling prerendering. We will add\n+      // this optimization back in a later step.\n+      !enableSiblingPrerendering &&\n       shouldRemainOnPreviousScreen() &&\n       // Check if there are other pending updates that might possibly unblock this\n       // component from suspending. This mirrors the check in\n@@ -1935,6 +1988,7 @@ export function renderDidSuspendDelayIfPossible(): void {\n       workInProgressRoot,\n       workInProgressRootRenderLanes,\n       workInProgressDeferredLane,\n+      workInProgressRootDidSkipSuspendedSiblings,\n     );\n   }\n }\n@@ -2584,7 +2638,30 @@ function throwAndUnwindWorkLoop(\n \n   if (unitOfWork.flags & Incomplete) {\n     // Unwind the stack until we reach the nearest boundary.\n-    unwindUnitOfWork(unitOfWork);\n+    let skipSiblings;\n+    if (!enableSiblingPrerendering) {\n+      skipSiblings = true;\n+    } else {\n+      if (\n+        // The current algorithm for both hydration and error handling assumes\n+        // that the tree is rendered sequentially. So we always skip the siblings.\n+        getIsHydrating() ||\n+        workInProgressSuspendedReason === SuspendedOnError\n+      ) {\n+        skipSiblings = true;\n+        // We intentionally don't set workInProgressRootDidSkipSuspendedSiblings,\n+        // because we don't want to trigger another prerender attempt.\n+      } else if (!workInProgressRootIsPrerendering) {\n+        // This is not a prerender. Skip the siblings during this render. A\n+        // separate prerender will be scheduled for later.\n+        skipSiblings = true;\n+        workInProgressRootDidSkipSuspendedSiblings = true;\n+      } else {\n+        // This is a prerender. Don't skip the siblings.\n+        skipSiblings = false;\n+      }\n+    }\n+    unwindUnitOfWork(unitOfWork, skipSiblings);\n   } else {\n     // Although the fiber suspended, we're intentionally going to commit it in\n     // an inconsistent state. We can do this safely in cases where we know the\n@@ -2620,15 +2697,16 @@ function completeUnitOfWork(unitOfWork: Fiber): void {\n   // sibling. If there are no more siblings, return to the parent fiber.\n   let completedWork: Fiber = unitOfWork;\n   do {\n-    if (__DEV__) {\n-      if ((completedWork.flags & Incomplete) !== NoFlags) {\n-        // NOTE: If we re-enable sibling prerendering in some cases, this branch\n-        // is where we would switch to the unwinding path.\n-        console.error(\n-          'Internal React error: Expected this fiber to be complete, but ' +\n-            \"it isn't. It should have been unwound. This is a bug in React.\",\n-        );\n-      }\n+    if ((completedWork.flags & Incomplete) !== NoFlags) {\n+      // This fiber did not complete, because one of its children did not\n+      // complete. Switch to unwinding the stack instead of completing it.\n+      //\n+      // The reason \"unwind\" and \"complete\" is interleaved is because when\n+      // something suspends, we continue rendering the siblings even though\n+      // they will be replaced by a fallback.\n+      const skipSiblings = workInProgressRootDidSkipSuspendedSiblings;\n+      unwindUnitOfWork(completedWork, skipSiblings);\n+      return;\n     }\n \n     // The current, flushed, state of this fiber is the alternate. Ideally\n@@ -2692,7 +2770,7 @@ function completeUnitOfWork(unitOfWork: Fiber): void {\n   }\n }\n \n-function unwindUnitOfWork(unitOfWork: Fiber): void {\n+function unwindUnitOfWork(unitOfWork: Fiber, skipSiblings: boolean): void {\n   let incompleteWork: Fiber = unitOfWork;\n   do {\n     // The current, flushed, state of this fiber is the alternate. Ideally\n@@ -2749,9 +2827,14 @@ function unwindUnitOfWork(unitOfWork: Fiber): void {\n       returnFiber.deletions = null;\n     }\n \n-    // NOTE: If we re-enable sibling prerendering in some cases, here we\n-    // would switch to the normal completion path: check if a sibling\n-    // exists, and if so, begin work on it.\n+    if (!skipSiblings) {\n+      const siblingFiber = incompleteWork.sibling;\n+      if (siblingFiber !== null) {\n+        // This branch will return us to the normal work loop.\n+        workInProgress = siblingFiber;\n+        return;\n+      }\n+    }\n \n     // Otherwise, return to the parent\n     // $FlowFixMe[incompatible-type] we bail out when we get a null"
            },
            {
                "file": "packages/react-reconciler/src/ReactInternalTypes.js",
                "git_diff": "@@ -37,6 +37,7 @@ import type {\n } from './ReactFiberTracingMarkerComponent';\n import type {ConcurrentUpdate} from './ReactFiberConcurrentUpdates';\n import type {ComponentStackNode} from 'react-server/src/ReactFizzComponentStack';\n+import type {ThenableState} from './ReactFiberThenable';\n \n // Unwind Circular: moved from ReactFiberHooks.old\n export type HookType =\n@@ -81,7 +82,7 @@ export type Dependencies = {\n     | ContextDependency<mixed>\n     | ContextDependencyWithSelect<mixed>\n     | null,\n-  ...\n+  _debugThenableState?: null | ThenableState, // DEV-only\n };\n \n export type MemoCache = {\n@@ -255,6 +256,7 @@ type BaseFiberRootProperties = {\n   pendingLanes: Lanes,\n   suspendedLanes: Lanes,\n   pingedLanes: Lanes,\n+  warmLanes: Lanes,\n   expiredLanes: Lanes,\n   errorRecoveryDisabledLanes: Lanes,\n   shellSuspendCounter: number,"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ActivitySuspense-test.js",
                "git_diff": "@@ -215,7 +215,15 @@ describe('Activity Suspense', () => {\n         );\n       });\n     });\n-    assertLog(['Open', 'Suspend! [Async]', 'Loading...']);\n+    assertLog([\n+      'Open',\n+      'Suspend! [Async]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Open', 'Suspend! [Async]', 'Loading...']\n+        : []),\n+    ]);\n     // It should suspend with delay to prevent the already-visible Suspense\n     // boundary from switching to a fallback\n     expect(root).toMatchRenderedOutput(<span>Closed</span>);\n@@ -276,7 +284,15 @@ describe('Activity Suspense', () => {\n         );\n       });\n     });\n-    assertLog(['Open', 'Suspend! [Async]', 'Loading...']);\n+    assertLog([\n+      'Open',\n+      'Suspend! [Async]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Open', 'Suspend! [Async]', 'Loading...']\n+        : []),\n+    ]);\n     // It should suspend with delay to prevent the already-visible Suspense\n     // boundary from switching to a fallback\n     expect(root).toMatchRenderedOutput("
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactActWarnings-test.js",
                "git_diff": "@@ -349,7 +349,14 @@ describe('act warnings', () => {\n           root.render(<App showMore={true} />);\n         });\n       });\n-      assertLog(['Suspend! [Async]', 'Loading...']);\n+      assertLog([\n+        'Suspend! [Async]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [Async]', 'Loading...']\n+          : []),\n+      ]);\n       expect(root).toMatchRenderedOutput('(empty)');\n \n       // This is a ping, not a retry, because no fallback is showing."
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactAsyncActions-test.js",
                "git_diff": "@@ -297,7 +297,15 @@ describe('ReactAsyncActions', () => {\n     // This will schedule an update on C, and also the async action scope\n     // will end. This will allow React to attempt to render the updates.\n     await act(() => resolveText('Wait before updating C'));\n-    assertLog(['Async action ended', 'Pending: false', 'Suspend! [A1]']);\n+    assertLog([\n+      'Async action ended',\n+      'Pending: false',\n+      'Suspend! [A1]',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Pending: false', 'Suspend! [A1]', 'Suspend! [B1]', 'Suspend! [C1]']\n+        : []),\n+    ]);\n     expect(root).toMatchRenderedOutput(\n       <>\n         <span>Pending: true</span>\n@@ -309,15 +317,32 @@ describe('ReactAsyncActions', () => {\n     // together, only when the all of A, B, and C updates are unblocked is the\n     // render allowed to proceed.\n     await act(() => resolveText('A1'));\n-    assertLog(['Pending: false', 'A1', 'Suspend! [B1]']);\n+    assertLog([\n+      'Pending: false',\n+      'A1',\n+      'Suspend! [B1]',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Pending: false', 'A1', 'Suspend! [B1]', 'Suspend! [C1]']\n+        : []),\n+    ]);\n     expect(root).toMatchRenderedOutput(\n       <>\n         <span>Pending: true</span>\n         <span>A0, B0, C0</span>\n       </>,\n     );\n     await act(() => resolveText('B1'));\n-    assertLog(['Pending: false', 'A1', 'B1', 'Suspend! [C1]']);\n+    assertLog([\n+      'Pending: false',\n+      'A1',\n+      'B1',\n+      'Suspend! [C1]',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Pending: false', 'A1', 'B1', 'Suspend! [C1]']\n+        : []),\n+    ]);\n     expect(root).toMatchRenderedOutput(\n       <>\n         <span>Pending: true</span>\n@@ -690,6 +715,10 @@ describe('ReactAsyncActions', () => {\n       // automatically reverted.\n       'Pending: false',\n       'Suspend! [B]',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Pending: false', 'Suspend! [B]']\n+        : []),\n     ]);\n \n     // Resolve the transition"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactCPUSuspense-test.js",
                "git_diff": "@@ -231,7 +231,11 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       );\n     });\n     // Inner contents suspended, so we continue showing a fallback.\n-    assertLog(['Suspend! [Inner]']);\n+    assertLog([\n+      'Suspend! [Inner]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [Inner]'] : []),\n+    ]);\n     expect(root).toMatchRenderedOutput(\n       <>\n         Outer"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactConcurrentErrorRecovery-test.js",
                "git_diff": "@@ -209,7 +209,16 @@ describe('ReactConcurrentErrorRecovery', () => {\n         root.render(<App step={2} />);\n       });\n     });\n-    assertLog(['Suspend! [A2]', 'Loading...', 'Suspend! [B2]', 'Loading...']);\n+    assertLog([\n+      'Suspend! [A2]',\n+      'Loading...',\n+      'Suspend! [B2]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [A2]', 'Loading...', 'Suspend! [B2]', 'Loading...']\n+        : []),\n+    ]);\n     // Because this is a refresh, we don't switch to a fallback\n     expect(root).toMatchRenderedOutput('A1B1');\n \n@@ -220,7 +229,16 @@ describe('ReactConcurrentErrorRecovery', () => {\n \n     // Because we're still suspended on A, we can't show an error boundary. We\n     // should wait for A to resolve.\n-    assertLog(['Suspend! [A2]', 'Loading...', 'Error! [B2]', 'Oops!']);\n+    assertLog([\n+      'Suspend! [A2]',\n+      'Loading...',\n+      'Error! [B2]',\n+      'Oops!',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [A2]', 'Loading...', 'Error! [B2]', 'Oops!']\n+        : []),\n+    ]);\n     // Remain on previous screen.\n     expect(root).toMatchRenderedOutput('A1B1');\n \n@@ -281,7 +299,16 @@ describe('ReactConcurrentErrorRecovery', () => {\n         root.render(<App step={2} />);\n       });\n     });\n-    assertLog(['Suspend! [A2]', 'Loading...', 'Suspend! [B2]', 'Loading...']);\n+    assertLog([\n+      'Suspend! [A2]',\n+      'Loading...',\n+      'Suspend! [B2]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [A2]', 'Loading...', 'Suspend! [B2]', 'Loading...']\n+        : []),\n+    ]);\n     // Because this is a refresh, we don't switch to a fallback\n     expect(root).toMatchRenderedOutput('A1B1');\n \n@@ -292,7 +319,16 @@ describe('ReactConcurrentErrorRecovery', () => {\n \n     // Because we're still suspended on B, we can't show an error boundary. We\n     // should wait for B to resolve.\n-    assertLog(['Error! [A2]', 'Oops!', 'Suspend! [B2]', 'Loading...']);\n+    assertLog([\n+      'Error! [A2]',\n+      'Oops!',\n+      'Suspend! [B2]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Error! [A2]', 'Oops!', 'Suspend! [B2]', 'Loading...']\n+        : []),\n+    ]);\n     // Remain on previous screen.\n     expect(root).toMatchRenderedOutput('A1B1');\n \n@@ -328,7 +364,11 @@ describe('ReactConcurrentErrorRecovery', () => {\n         root.render(<AsyncText text=\"Async\" />);\n       });\n     });\n-    assertLog(['Suspend! [Async]']);\n+    assertLog([\n+      'Suspend! [Async]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [Async]'] : []),\n+    ]);\n     expect(root).toMatchRenderedOutput(null);\n \n     // This also works if the suspended component is wrapped with an error\n@@ -344,7 +384,11 @@ describe('ReactConcurrentErrorRecovery', () => {\n         );\n       });\n     });\n-    assertLog(['Suspend! [Async]']);\n+    assertLog([\n+      'Suspend! [Async]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [Async]'] : []),\n+    ]);\n     expect(root).toMatchRenderedOutput(null);\n \n     // Continues rendering once data resolves\n@@ -397,8 +441,14 @@ describe('ReactConcurrentErrorRecovery', () => {\n           );\n         });\n       });\n-      assertLog(['Suspend! [Async]']);\n-      // The render suspended without committing or surfacing the error.\n+      assertLog([\n+        'Suspend! [Async]',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [Async]', 'Caught an error: Oops!']\n+          : []),\n+      ]);\n+      // The render suspended without committing the error.\n       expect(root).toMatchRenderedOutput(null);\n \n       // Try the reverse order, too: throw then suspend\n@@ -414,7 +464,13 @@ describe('ReactConcurrentErrorRecovery', () => {\n           );\n         });\n       });\n-      assertLog(['Suspend! [Async]']);\n+      assertLog([\n+        'Suspend! [Async]',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [Async]', 'Caught an error: Oops!']\n+          : []),\n+      ]);\n       expect(root).toMatchRenderedOutput(null);\n \n       await act(async () => {"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactDeferredValue-test.js",
                "git_diff": "@@ -420,6 +420,8 @@ describe('ReactDeferredValue', () => {\n         // The initial value suspended, so we attempt the final value, which\n         // also suspends.\n         'Suspend! [Final]',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend! [Final]'] : []),\n       ]);\n       expect(root).toMatchRenderedOutput(null);\n \n@@ -459,6 +461,8 @@ describe('ReactDeferredValue', () => {\n         // The initial value suspended, so we attempt the final value, which\n         // also suspends.\n         'Suspend! [Final]',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend! [Final]'] : []),\n       ]);\n       expect(root).toMatchRenderedOutput(null);\n \n@@ -531,6 +535,8 @@ describe('ReactDeferredValue', () => {\n         // The initial value suspended, so we attempt the final value, which\n         // also suspends.\n         'Suspend! [Final]',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend! [Final]'] : []),\n       ]);\n       expect(root).toMatchRenderedOutput(null);\n \n@@ -540,6 +546,8 @@ describe('ReactDeferredValue', () => {\n         'Loading...',\n         // Still waiting for the final value.\n         'Suspend! [Final]',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend! [Final]'] : []),\n       ]);\n       expect(root).toMatchRenderedOutput('Loading...');\n \n@@ -584,6 +592,8 @@ describe('ReactDeferredValue', () => {\n         // boundaries work, where we always prefer to show the innermost\n         // loading state.)\n         'Suspend! [Content]',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend! [Content]'] : []),\n       ]);\n       // Still showing the App preview state because the inner\n       // content suspended."
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactExpiration-test.js",
                "git_diff": "@@ -652,7 +652,14 @@ describe('ReactExpiration', () => {\n       React.startTransition(() => {\n         root.render(<App step={1} />);\n       });\n-      await waitForAll(['Suspend! [A1]', 'Loading...']);\n+      await waitForAll([\n+        'Suspend! [A1]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [A1]', 'B', 'C', 'Loading...']\n+          : []),\n+      ]);\n \n       // Lots of time elapses before the promise resolves\n       Scheduler.unstable_advanceTime(10000);"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactHooksWithNoopRenderer-test.js",
                "git_diff": "@@ -652,14 +652,22 @@ describe('ReactHooksWithNoopRenderer', () => {\n       React.startTransition(() => {\n         root.render(<Foo signal={false} />);\n       });\n-      await waitForAll(['Suspend!']);\n+      await waitForAll([\n+        'Suspend!',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend!'] : []),\n+      ]);\n       expect(root).toMatchRenderedOutput(<span prop={0} />);\n \n       // Rendering again should suspend again.\n       React.startTransition(() => {\n         root.render(<Foo signal={false} />);\n       });\n-      await waitForAll(['Suspend!']);\n+      await waitForAll([\n+        'Suspend!',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend!'] : []),\n+      ]);\n     });\n \n     it('discards render phase updates if something suspends, but not other updates in the same component', async () => {\n@@ -709,14 +717,22 @@ describe('ReactHooksWithNoopRenderer', () => {\n           setLabel('B');\n         });\n \n-        await waitForAll(['Suspend!']);\n+        await waitForAll([\n+          'Suspend!',\n+\n+          ...(gate('enableSiblingPrerendering') ? ['Suspend!'] : []),\n+        ]);\n         expect(root).toMatchRenderedOutput(<span prop=\"A:0\" />);\n \n         // Rendering again should suspend again.\n         React.startTransition(() => {\n           root.render(<Foo signal={false} />);\n         });\n-        await waitForAll(['Suspend!']);\n+        await waitForAll([\n+          'Suspend!',\n+\n+          ...(gate('enableSiblingPrerendering') ? ['Suspend!'] : []),\n+        ]);\n \n         // Flip the signal back to \"cancel\" the update. However, the update to\n         // label should still proceed. It shouldn't have been dropped.\n@@ -3495,6 +3511,13 @@ describe('ReactHooksWithNoopRenderer', () => {\n           'Before... Pending: true',\n           'Suspend! [After... Pending: false]',\n           'Loading... Pending: false',\n+\n+          ...(gate('enableSiblingPrerendering')\n+            ? [\n+                'Suspend! [After... Pending: false]',\n+                'Loading... Pending: false',\n+              ]\n+            : []),\n         ]);\n         expect(ReactNoop).toMatchRenderedOutput(\n           <span prop=\"Before... Pending: true\" />,\n@@ -3563,7 +3586,17 @@ describe('ReactHooksWithNoopRenderer', () => {\n \n       await act(async () => {\n         _setText('B');\n-        await waitForAll(['B', 'A', 'B', 'Suspend! [B]', 'Loading']);\n+        await waitForAll([\n+          'B',\n+          'A',\n+          'B',\n+          'Suspend! [B]',\n+          'Loading',\n+\n+          ...(gate('enableSiblingPrerendering')\n+            ? ['B', 'Suspend! [B]', 'Loading']\n+            : []),\n+        ]);\n         await waitForAll([]);\n         expect(ReactNoop).toMatchRenderedOutput(\n           <>\n@@ -4201,7 +4234,13 @@ describe('ReactHooksWithNoopRenderer', () => {\n     await act(async () => {\n       await resolveText('A');\n     });\n-    assertLog(['Promise resolved [A]', 'A', 'Suspend! [B]']);\n+    assertLog([\n+      'Promise resolved [A]',\n+      'A',\n+      'Suspend! [B]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['A', 'Suspend! [B]'] : []),\n+    ]);\n \n     await act(() => {\n       root.render(null);"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactLazy-test.internal.js",
                "git_diff": "@@ -198,7 +198,11 @@ describe('ReactLazy', () => {\n \n     await resolveFakeImport(Foo);\n \n-    await waitForAll(['Foo']);\n+    await waitForAll([\n+      'Foo',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Foo'] : []),\n+    ]);\n     expect(root).not.toMatchRenderedOutput('FooBar');\n \n     await act(() => resolveFakeImport(Bar));\n@@ -235,6 +239,13 @@ describe('ReactLazy', () => {\n     assertConsoleErrorDev([\n       'Expected the result of a dynamic import() call',\n       'Expected the result of a dynamic import() call',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? [\n+            'Expected the result of a dynamic import() call',\n+            'Expected the result of a dynamic import() call',\n+          ]\n+        : []),\n     ]);\n     expect(root).not.toMatchRenderedOutput('Hi');\n   });\n@@ -1072,7 +1083,7 @@ describe('ReactLazy', () => {\n     expect(ref.current).toBe(null);\n \n     await act(() => resolveFakeImport(Foo));\n-    assertLog(['Foo']);\n+    assertLog(['Foo', ...(gate('enableSiblingPrerendering') ? ['Foo'] : [])]);\n \n     await act(() => resolveFakeImport(ForwardRefBar));\n     assertLog(['Foo', 'forwardRef', 'Bar']);\n@@ -1388,7 +1399,12 @@ describe('ReactLazy', () => {\n     expect(root).not.toMatchRenderedOutput('AB');\n \n     await act(() => resolveFakeImport(ChildA));\n-    assertLog(['A', 'Init B']);\n+    assertLog([\n+      'A',\n+      'Init B',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['A'] : []),\n+    ]);\n \n     await act(() => resolveFakeImport(ChildB));\n     assertLog(['A', 'B', 'Did mount: A', 'Did mount: B']);\n@@ -1472,10 +1488,20 @@ describe('ReactLazy', () => {\n     React.startTransition(() => {\n       root.update(<Parent swap={true} />);\n     });\n-    await waitForAll(['Init B2', 'Loading...']);\n+    await waitForAll([\n+      'Init B2',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Loading...'] : []),\n+    ]);\n     await act(() => resolveFakeImport(ChildB2));\n     // We need to flush to trigger the second one to load.\n-    assertLog(['Init A2', 'Loading...']);\n+    assertLog([\n+      'Init A2',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Loading...'] : []),\n+    ]);\n     await act(() => resolveFakeImport(ChildA2));\n     assertLog(['b', 'a', 'Did update: b', 'Did update: a']);\n     expect(root).toMatchRenderedOutput('ba');"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspense-test.internal.js",
                "git_diff": "@@ -136,6 +136,10 @@ describe('ReactSuspense', () => {\n       // A suspends\n       'Suspend! [A]',\n       'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Foo', 'Bar', 'Suspend! [A]', 'B', 'Loading...']\n+        : []),\n     ]);\n     expect(container.textContent).toEqual('');\n \n@@ -275,7 +279,15 @@ describe('ReactSuspense', () => {\n     expect(container.textContent).toEqual('Loading...');\n \n     await resolveText('A');\n-    await waitForAll(['A', 'Suspend! [B]', 'Loading more...']);\n+    await waitForAll([\n+      'A',\n+      'Suspend! [B]',\n+      'Loading more...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A', 'Suspend! [B]', 'Loading more...']\n+        : []),\n+    ]);\n \n     // By this point, we have enough info to show \"A\" and \"Loading more...\"\n     // However, we've just shown the outer fallback. So we'll delay\n@@ -327,7 +339,14 @@ describe('ReactSuspense', () => {\n     // B starts loading. Parent boundary is in throttle.\n     // Still shows parent loading under throttle\n     jest.advanceTimersByTime(10);\n-    await waitForAll(['Suspend! [B]', 'Loading more...']);\n+    await waitForAll([\n+      'Suspend! [B]',\n+      'Loading more...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A', 'Suspend! [B]', 'Loading more...']\n+        : []),\n+    ]);\n     expect(container.textContent).toEqual('Loading...');\n \n     // !! B could have finished before the throttle, but we show a fallback.\n@@ -361,7 +380,15 @@ describe('ReactSuspense', () => {\n     expect(container.textContent).toEqual('Loading...');\n \n     await resolveText('A');\n-    await waitForAll(['A', 'Suspend! [B]', 'Loading more...']);\n+    await waitForAll([\n+      'A',\n+      'Suspend! [B]',\n+      'Loading more...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A', 'Suspend! [B]', 'Loading more...']\n+        : []),\n+    ]);\n \n     // By this point, we have enough info to show \"A\" and \"Loading more...\"\n     // However, we've just shown the outer fallback. So we'll delay\n@@ -655,7 +682,14 @@ describe('ReactSuspense', () => {\n \n     assertLog(['Suspend! [Child 1]', 'Loading...']);\n     await resolveText('Child 1');\n-    await waitForAll(['Child 1', 'Suspend! [Child 2]']);\n+    await waitForAll([\n+      'Child 1',\n+      'Suspend! [Child 2]',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Child 1', 'Suspend! [Child 2]']\n+        : []),\n+    ]);\n \n     jest.advanceTimersByTime(6000);\n "
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspenseEffectsSemantics-test.js",
                "git_diff": "@@ -1150,7 +1150,19 @@ describe('ReactSuspenseEffectsSemantics', () => {\n       await act(async () => {\n         await resolveText('InnerAsync_1');\n       });\n-      assertLog(['Text:Outer render', 'Suspend:OuterAsync_1']);\n+      assertLog([\n+        'Text:Outer render',\n+        'Suspend:OuterAsync_1',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? [\n+              'Text:Outer render',\n+              'Suspend:OuterAsync_1',\n+              'Text:Inner render',\n+              'AsyncText:InnerAsync_1 render',\n+            ]\n+          : []),\n+      ]);\n       expect(ReactNoop).toMatchRenderedOutput(\n         <>\n           <span prop=\"Outer\" hidden={true} />\n@@ -1194,6 +1206,17 @@ describe('ReactSuspenseEffectsSemantics', () => {\n         'Text:Inner render',\n         'Suspend:InnerAsync_2',\n         'Text:InnerFallback render',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? [\n+              'Text:Outer render',\n+              'AsyncText:OuterAsync_1 render',\n+              'Text:Inner render',\n+              'Suspend:InnerAsync_2',\n+              'Text:InnerFallback render',\n+            ]\n+          : []),\n+\n         'Text:OuterFallback destroy layout',\n         'Text:Outer create layout',\n         'AsyncText:OuterAsync_1 create layout',\n@@ -2305,6 +2328,15 @@ describe('ReactSuspenseEffectsSemantics', () => {\n         'Text:Function render',\n         'AsyncText:Async_1 render',\n         'Suspend:Async_2',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? [\n+              'Text:Function render',\n+              'AsyncText:Async_1 render',\n+              'Suspend:Async_2',\n+              'ClassText:Class render',\n+            ]\n+          : []),\n       ]);\n       expect(ReactNoop).toMatchRenderedOutput(\n         <>\n@@ -2443,7 +2475,20 @@ describe('ReactSuspenseEffectsSemantics', () => {\n       await act(async () => {\n         await resolveText('A');\n       });\n-      assertLog(['Text:Function render', 'Suspender \"B\" render', 'Suspend:B']);\n+      assertLog([\n+        'Text:Function render',\n+        'Suspender \"B\" render',\n+        'Suspend:B',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? [\n+              'Text:Function render',\n+              'Suspender \"B\" render',\n+              'Suspend:B',\n+              'ClassText:Class render',\n+            ]\n+          : []),\n+      ]);\n       expect(ReactNoop).toMatchRenderedOutput(\n         <>\n           <span prop=\"Function\" hidden={true} />"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspenseList-test.js",
                "git_diff": "@@ -383,7 +383,13 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => B.resolve());\n-    assertLog(['A', 'B', 'Suspend! [C]']);\n+    assertLog([\n+      'A',\n+      'B',\n+      'Suspend! [C]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['A', 'B', 'Suspend! [C]'] : []),\n+    ]);\n \n     expect(ReactNoop).toMatchRenderedOutput(\n       <>\n@@ -459,7 +465,13 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => B.resolve());\n-    assertLog(['A', 'B', 'Suspend! [C]']);\n+    assertLog([\n+      'A',\n+      'B',\n+      'Suspend! [C]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['A', 'B', 'Suspend! [C]'] : []),\n+    ]);\n \n     expect(ReactNoop).toMatchRenderedOutput(\n       <>\n@@ -767,7 +779,12 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => B.resolve());\n-    assertLog(['B', 'Suspend! [C]']);\n+    assertLog([\n+      'B',\n+      'Suspend! [C]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['B', 'Suspend! [C]'] : []),\n+    ]);\n \n     // Even though we could now show B, we're still waiting on C.\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -854,7 +871,12 @@ describe('ReactSuspenseList', () => {\n     expect(ReactNoop).toMatchRenderedOutput(<span>A</span>);\n \n     await act(() => B.resolve());\n-    assertLog(['B', 'Suspend! [C]']);\n+    assertLog([\n+      'B',\n+      'Suspend! [C]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['B', 'Suspend! [C]'] : []),\n+    ]);\n \n     // Even though we could now show B, we're still waiting on C.\n     expect(ReactNoop).toMatchRenderedOutput(<span>A</span>);\n@@ -908,7 +930,12 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => A.resolve());\n-    assertLog(['A', 'Suspend! [B]']);\n+    assertLog([\n+      'A',\n+      'Suspend! [B]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['A', 'Suspend! [B]'] : []),\n+    ]);\n \n     expect(ReactNoop).toMatchRenderedOutput(\n       <>\n@@ -967,7 +994,12 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => C.resolve());\n-    assertLog(['C', 'Suspend! [B]']);\n+    assertLog([\n+      'C',\n+      'Suspend! [B]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['C', 'Suspend! [B]'] : []),\n+    ]);\n \n     expect(ReactNoop).toMatchRenderedOutput(\n       <>\n@@ -1072,7 +1104,12 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => A.resolve());\n-    assertLog(['A', 'Suspend! [C]']);\n+    assertLog([\n+      'A',\n+      'Suspend! [C]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['A', 'Suspend! [C]'] : []),\n+    ]);\n \n     // Even though we could show A, it is still in a fallback state because\n     // C is not yet resolved. We need to resolve everything in the head first.\n@@ -1088,7 +1125,13 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => C.resolve());\n-    assertLog(['A', 'C', 'Suspend! [E]']);\n+    assertLog([\n+      'A',\n+      'C',\n+      'Suspend! [E]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['A', 'C', 'Suspend! [E]'] : []),\n+    ]);\n \n     // We can now resolve the full head.\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -1103,7 +1146,12 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => E.resolve());\n-    assertLog(['E', 'Suspend! [F]']);\n+    assertLog([\n+      'E',\n+      'Suspend! [F]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['E', 'Suspend! [F]'] : []),\n+    ]);\n \n     // In the tail we can resolve one-by-one.\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -1267,7 +1315,12 @@ describe('ReactSuspenseList', () => {\n \n     await F.resolve();\n \n-    await waitForAll(['Suspend! [D]', 'F']);\n+    await waitForAll([\n+      'Suspend! [D]',\n+      'F',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [D]', 'F'] : []),\n+    ]);\n \n     // Even though we could show F, it is still in a fallback state because\n     // E is not yet resolved. We need to resolve everything in the head first.\n@@ -1287,7 +1340,13 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => D.resolve());\n-    assertLog(['D', 'F', 'Suspend! [B]']);\n+    assertLog([\n+      'D',\n+      'F',\n+      'Suspend! [B]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['D', 'F', 'Suspend! [B]'] : []),\n+    ]);\n \n     // We can now resolve the full head.\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -1304,7 +1363,12 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => B.resolve());\n-    assertLog(['B', 'Suspend! [A]']);\n+    assertLog([\n+      'B',\n+      'Suspend! [A]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['B', 'Suspend! [A]'] : []),\n+    ]);\n \n     // In the tail we can resolve one-by-one.\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -1429,7 +1493,15 @@ describe('ReactSuspenseList', () => {\n \n     await A.resolve();\n \n-    await waitForAll(['A', 'Suspend! [B]', 'Loading B']);\n+    await waitForAll([\n+      'A',\n+      'Suspend! [B]',\n+      'Loading B',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A', 'Suspend! [B]', 'Loading B']\n+        : []),\n+    ]);\n \n     // Incremental loading is suspended.\n     jest.advanceTimersByTime(500);\n@@ -1443,7 +1515,15 @@ describe('ReactSuspenseList', () => {\n \n     await B.resolve();\n \n-    await waitForAll(['B', 'Suspend! [C]', 'Loading C']);\n+    await waitForAll([\n+      'B',\n+      'Suspend! [C]',\n+      'Loading C',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['B', 'Suspend! [C]', 'Loading C']\n+        : []),\n+    ]);\n \n     // Incremental loading is suspended.\n     jest.advanceTimersByTime(500);\n@@ -1667,7 +1747,12 @@ describe('ReactSuspenseList', () => {\n \n     await B.resolve();\n \n-    await waitForAll(['B', 'Suspend! [C]']);\n+    await waitForAll([\n+      'B',\n+      'Suspend! [C]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['B', 'Suspend! [C]'] : []),\n+    ]);\n \n     // Incremental loading is suspended.\n     jest.advanceTimersByTime(500);\n@@ -1687,7 +1772,17 @@ describe('ReactSuspenseList', () => {\n     await C.resolve();\n     await E.resolve();\n \n-    await waitForAll(['B', 'C', 'E', 'Suspend! [F]', 'Loading F']);\n+    await waitForAll([\n+      'B',\n+      'C',\n+      'E',\n+      'Suspend! [F]',\n+      'Loading F',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['B', 'C', 'E', 'Suspend! [F]', 'Loading F']\n+        : []),\n+    ]);\n \n     jest.advanceTimersByTime(500);\n \n@@ -1804,7 +1899,12 @@ describe('ReactSuspenseList', () => {\n \n     await D.resolve();\n \n-    await waitForAll(['D', 'Suspend! [E]']);\n+    await waitForAll([\n+      'D',\n+      'Suspend! [E]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['D', 'Suspend! [E]'] : []),\n+    ]);\n \n     // Incremental loading is suspended.\n     jest.advanceTimersByTime(500);\n@@ -1829,7 +1929,17 @@ describe('ReactSuspenseList', () => {\n     await D.resolve();\n     await E.resolve();\n \n-    await waitForAll(['D', 'E', 'B', 'Suspend! [A]', 'Loading A']);\n+    await waitForAll([\n+      'D',\n+      'E',\n+      'B',\n+      'Suspend! [A]',\n+      'Loading A',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['D', 'E', 'B', 'Suspend! [A]', 'Loading A']\n+        : []),\n+    ]);\n \n     jest.advanceTimersByTime(500);\n \n@@ -1958,7 +2068,12 @@ describe('ReactSuspenseList', () => {\n \n     await B.resolve();\n \n-    await waitForAll(['B', 'Suspend! [C]']);\n+    await waitForAll([\n+      'B',\n+      'Suspend! [C]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['B', 'Suspend! [C]'] : []),\n+    ]);\n \n     // Incremental loading is suspended.\n     jest.advanceTimersByTime(500);\n@@ -1981,7 +2096,17 @@ describe('ReactSuspenseList', () => {\n     await D.resolve();\n     await E.resolve();\n \n-    await waitForAll(['C', 'D', 'E', 'Suspend! [F]', 'Loading F']);\n+    await waitForAll([\n+      'C',\n+      'D',\n+      'E',\n+      'Suspend! [F]',\n+      'Loading F',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['C', 'D', 'E', 'Suspend! [F]', 'Loading F']\n+        : []),\n+    ]);\n \n     jest.advanceTimersByTime(500);\n \n@@ -2044,15 +2169,31 @@ describe('ReactSuspenseList', () => {\n \n     await A.resolve();\n \n-    await waitForAll(['A', 'Suspend! [B]', 'Loading B']);\n+    await waitForAll([\n+      'A',\n+      'Suspend! [B]',\n+      'Loading B',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A', 'Suspend! [B]', 'Loading B']\n+        : []),\n+    ]);\n \n     // Incremental loading is suspended.\n     jest.advanceTimersByTime(500);\n \n     expect(ReactNoop).toMatchRenderedOutput(<span>A</span>);\n \n     await act(() => B.resolve());\n-    assertLog(['B', 'Suspend! [C]', 'Loading C']);\n+    assertLog([\n+      'B',\n+      'Suspend! [C]',\n+      'Loading C',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['B', 'Suspend! [C]', 'Loading C']\n+        : []),\n+    ]);\n \n     // Incremental loading is suspended.\n     jest.advanceTimersByTime(500);\n@@ -2787,7 +2928,12 @@ describe('ReactSuspenseList', () => {\n     expect(onRender.mock.calls[2][3]).toBe(1 + 4 + 3 + 3);\n \n     await act(() => C.resolve());\n-    assertLog(['C', 'Suspend! [D]']);\n+    assertLog([\n+      'C',\n+      'Suspend! [D]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['C', 'Suspend! [D]'] : []),\n+    ]);\n     expect(ReactNoop).toMatchRenderedOutput(\n       <>\n         <span>A</span>\n@@ -2873,7 +3019,12 @@ describe('ReactSuspenseList', () => {\n     );\n \n     await act(() => A.resolve());\n-    assertLog(['A', 'Suspend! [B]']);\n+    assertLog([\n+      'A',\n+      'Suspend! [B]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['A', 'Suspend! [B]'] : []),\n+    ]);\n     expect(ReactNoop).toMatchRenderedOutput(\n       <>\n         <span>A</span>"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspenseWithNoopRenderer-test.js",
                "git_diff": "@@ -298,6 +298,19 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       // We immediately unwind and switch to a fallback without\n       // rendering siblings.\n       'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? [\n+            'Foo',\n+            'Bar',\n+            // A suspends\n+            'Suspend! [A]',\n+            'B',\n+            // We immediately unwind and switch to a fallback without\n+            // rendering siblings.\n+            'Loading...',\n+          ]\n+        : []),\n     ]);\n     expect(ReactNoop).toMatchRenderedOutput(null);\n \n@@ -379,7 +392,15 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     });\n \n     // B suspends. Render a fallback\n-    await waitForAll(['A', 'Suspend! [B]', 'Loading...']);\n+    await waitForAll([\n+      'A',\n+      'Suspend! [B]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A', 'Suspend! [B]', 'C', 'D', 'Loading...']\n+        : []),\n+    ]);\n     // Did not commit yet.\n     expect(ReactNoop).toMatchRenderedOutput(null);\n \n@@ -436,7 +457,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     React.startTransition(() => {\n       ReactNoop.render(<App renderContent={true} />);\n     });\n-    await waitForAll(['Suspend! [Result]', 'Loading...']);\n+    await waitForAll([\n+      'Suspend! [Result]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [Result]', 'Loading...']\n+        : []),\n+    ]);\n     expect(ReactNoop).toMatchRenderedOutput(null);\n \n     await rejectText('Result', new Error('Failed to load: Result'));\n@@ -496,6 +524,10 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       // React retries one more time\n       'Error! [Result]',\n \n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Error! [Result]', 'Error! [Result]']\n+        : []),\n+\n       // Errored again on retry. Now handle it.\n       'Caught error: Failed to load: Result',\n     ]);\n@@ -547,7 +579,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     // Update the low-pri text\n     await act(() => startTransition(() => setLowPri('2')));\n     // Suspends\n-    assertLog(['Suspend! [2]', 'Loading...']);\n+    assertLog([\n+      'Suspend! [2]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [2]', 'Loading...']\n+        : []),\n+    ]);\n \n     // While we're still waiting for the low-pri update to complete, update the\n     // high-pri text at high priority.\n@@ -592,13 +631,27 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     React.startTransition(() => {\n       ReactNoop.render(<App showA={true} showB={false} />);\n     });\n-    await waitForAll(['Suspend! [A]', 'Loading...']);\n+    await waitForAll([\n+      'Suspend! [A]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [A]', 'Loading...']\n+        : []),\n+    ]);\n     expect(ReactNoop).toMatchRenderedOutput(null);\n \n     React.startTransition(() => {\n       ReactNoop.render(<App showA={true} showB={true} />);\n     });\n-    await waitForAll(['Suspend! [A]', 'Loading...']);\n+    await waitForAll([\n+      'Suspend! [A]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [A]', 'B', 'Loading...']\n+        : []),\n+    ]);\n     expect(ReactNoop).toMatchRenderedOutput(null);\n \n     await resolveText('A');\n@@ -743,6 +796,10 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       'Outer content',\n       'Suspend! [Inner content]',\n       'Loading inner...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Outer content', 'Suspend! [Inner content]', 'Loading inner...']\n+        : []),\n     ]);\n     // Don't commit the inner placeholder yet.\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -932,7 +989,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n         </Suspense>,\n       );\n     });\n-    await waitForAll(['Suspend! [Async]', 'Loading...']);\n+    await waitForAll([\n+      'Suspend! [Async]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [Async]', 'Loading...']\n+        : []),\n+    ]);\n     expect(ReactNoop).toMatchRenderedOutput(null);\n \n     // Resolve the promise\n@@ -964,7 +1028,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     // Schedule an update, and suspend for up to 5 seconds.\n     React.startTransition(() => ReactNoop.render(<App text=\"A\" />));\n     // The update should suspend.\n-    await waitForAll(['Suspend! [A]', 'Loading...']);\n+    await waitForAll([\n+      'Suspend! [A]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [A]', 'Loading...']\n+        : []),\n+    ]);\n     expect(ReactNoop).toMatchRenderedOutput(<span prop=\"S\" />);\n \n     // Advance time until right before it expires.\n@@ -976,7 +1047,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     // Schedule another low priority update.\n     React.startTransition(() => ReactNoop.render(<App text=\"B\" />));\n     // This update should also suspend.\n-    await waitForAll(['Suspend! [B]', 'Loading...']);\n+    await waitForAll([\n+      'Suspend! [B]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [B]', 'Loading...']\n+        : []),\n+    ]);\n     expect(ReactNoop).toMatchRenderedOutput(<span prop=\"S\" />);\n \n     // Schedule a regular update. Its expiration time will fall between\n@@ -1747,6 +1825,10 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n         // B suspends\n         'Suspend! [B]',\n         'Loading more...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['A', 'Suspend! [B]', 'Loading more...']\n+          : []),\n       ]);\n       // Because we've already been waiting for so long we can\n       // wait a bit longer. Still nothing...\n@@ -2238,7 +2320,16 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       ReactNoop.render(<Foo showB={true} />);\n     });\n \n-    await waitForAll(['Foo', 'A', 'Suspend! [B]', 'Loading B...']);\n+    await waitForAll([\n+      'Foo',\n+      'A',\n+      'Suspend! [B]',\n+      'Loading B...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Foo', 'A', 'Suspend! [B]', 'Loading B...']\n+        : []),\n+    ]);\n \n     // Transitions never fall back.\n     expect(ReactNoop).toMatchRenderedOutput(<span prop=\"A\" />);\n@@ -2314,7 +2405,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       // Start transition.\n       React.startTransition(() => ReactNoop.render(<App page=\"B\" />));\n \n-      await waitForAll(['Suspend! [B]', 'Loading...']);\n+      await waitForAll([\n+        'Suspend! [B]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [B]', 'Loading...']\n+          : []),\n+      ]);\n       Scheduler.unstable_advanceTime(100000);\n       await advanceTimers(100000);\n       // Even after lots of time has passed, we have still not yet flushed the\n@@ -2365,7 +2463,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       await act(async () => {\n         React.startTransition(() => transitionToPage('B'));\n \n-        await waitForAll(['Suspend! [B]', 'Loading...']);\n+        await waitForAll([\n+          'Suspend! [B]',\n+          'Loading...',\n+\n+          ...(gate('enableSiblingPrerendering')\n+            ? ['Suspend! [B]', 'Loading...']\n+            : []),\n+        ]);\n         Scheduler.unstable_advanceTime(100000);\n         await advanceTimers(100000);\n         // Even after lots of time has passed, we have still not yet flushed the\n@@ -2420,7 +2525,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       await act(async () => {\n         React.startTransition(() => transitionToPage('B'));\n \n-        await waitForAll(['Suspend! [B]', 'Loading...']);\n+        await waitForAll([\n+          'Suspend! [B]',\n+          'Loading...',\n+\n+          ...(gate('enableSiblingPrerendering')\n+            ? ['Suspend! [B]', 'Loading...']\n+            : []),\n+        ]);\n         Scheduler.unstable_advanceTime(100000);\n         await advanceTimers(100000);\n         // Even after lots of time has passed, we have still not yet flushed the\n@@ -2462,7 +2574,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       // Start transition.\n       React.startTransition(() => ReactNoop.render(<App page=\"B\" />));\n \n-      await waitForAll(['Suspend! [B]', 'Loading...']);\n+      await waitForAll([\n+        'Suspend! [B]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [B]', 'Loading...']\n+          : []),\n+      ]);\n       Scheduler.unstable_advanceTime(2999);\n       await advanceTimers(2999);\n       // Since the timeout is infinite (or effectively infinite),\n@@ -2476,7 +2595,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n \n       // Start a long (infinite) transition.\n       React.startTransition(() => ReactNoop.render(<App page=\"C\" />));\n-      await waitForAll(['Suspend! [C]', 'Loading...']);\n+      await waitForAll([\n+        'Suspend! [C]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [C]', 'Loading...']\n+          : []),\n+      ]);\n \n       // Even after lots of time has passed, we have still not yet flushed the\n       // loading state.\n@@ -2524,7 +2650,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       await act(async () => {\n         React.startTransition(() => transitionToPage('B'));\n \n-        await waitForAll(['Suspend! [B]', 'Loading...']);\n+        await waitForAll([\n+          'Suspend! [B]',\n+          'Loading...',\n+\n+          ...(gate('enableSiblingPrerendering')\n+            ? ['Suspend! [B]', 'Loading...']\n+            : []),\n+        ]);\n \n         Scheduler.unstable_advanceTime(2999);\n         await advanceTimers(2999);\n@@ -2542,7 +2675,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       await act(async () => {\n         React.startTransition(() => transitionToPage('C'));\n \n-        await waitForAll(['Suspend! [C]', 'Loading...']);\n+        await waitForAll([\n+          'Suspend! [C]',\n+          'Loading...',\n+\n+          ...(gate('enableSiblingPrerendering')\n+            ? ['Suspend! [C]', 'Loading...']\n+            : []),\n+        ]);\n \n         // Even after lots of time has passed, we have still not yet flushed the\n         // loading state.\n@@ -2594,7 +2734,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       await act(async () => {\n         React.startTransition(() => transitionToPage('B'));\n \n-        await waitForAll(['Suspend! [B]', 'Loading...']);\n+        await waitForAll([\n+          'Suspend! [B]',\n+          'Loading...',\n+\n+          ...(gate('enableSiblingPrerendering')\n+            ? ['Suspend! [B]', 'Loading...']\n+            : []),\n+        ]);\n         Scheduler.unstable_advanceTime(2999);\n         await advanceTimers(2999);\n         // Since the timeout is infinite (or effectively infinite),\n@@ -2611,7 +2758,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       await act(async () => {\n         React.startTransition(() => transitionToPage('C'));\n \n-        await waitForAll(['Suspend! [C]', 'Loading...']);\n+        await waitForAll([\n+          'Suspend! [C]',\n+          'Loading...',\n+\n+          ...(gate('enableSiblingPrerendering')\n+            ? ['Suspend! [C]', 'Loading...']\n+            : []),\n+        ]);\n \n         // Even after lots of time has passed, we have still not yet flushed the\n         // loading state.\n@@ -2652,7 +2806,15 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     // Start transition.\n     React.startTransition(() => ReactNoop.render(<App page=\"B\" />));\n \n-    await waitForAll(['Hi!', 'Suspend! [B]', 'Loading B...']);\n+    await waitForAll([\n+      'Hi!',\n+      'Suspend! [B]',\n+      'Loading B...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Hi!', 'Suspend! [B]', 'Loading B...']\n+        : []),\n+    ]);\n \n     // Suspended\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -2713,7 +2875,15 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     // Start transition.\n     React.startTransition(() => ReactNoop.render(<App page=\"B\" />));\n \n-    await waitForAll(['Hi!', 'Suspend! [B]', 'Loading B...']);\n+    await waitForAll([\n+      'Hi!',\n+      'Suspend! [B]',\n+      'Loading B...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Hi!', 'Suspend! [B]', 'Loading B...']\n+        : []),\n+    ]);\n \n     // Suspended\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -2827,7 +2997,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       ReactNoop.render(<App showContent={true} />);\n     });\n \n-    await waitForAll(['Suspend! [A]', 'Loading...']);\n+    await waitForAll([\n+      'Suspend! [A]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [A]', 'Loading...']\n+        : []),\n+    ]);\n     await resolveText('A');\n     await waitFor(['A', 'Commit']);\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -2879,7 +3056,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n       ReactNoop.render(<App showContent={true} />);\n     });\n \n-    await waitForAll(['Suspend! [A]', 'Loading...']);\n+    await waitForAll([\n+      'Suspend! [A]',\n+      'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [A]', 'Loading...']\n+        : []),\n+    ]);\n     await resolveText('A');\n     await waitFor(['A', 'Commit']);\n     expect(ReactNoop).toMatchRenderedOutput(\n@@ -3492,6 +3676,10 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     );\n   });\n \n+  // This regression test relies on subtle implementation details that happen to\n+  // rely on sibling prerendering being disabled. Not going to bother to rewrite\n+  // it for now; maybe once we land the experiment.\n+  // @gate !enableSiblingPrerendering\n   // @gate enableLegacyCache\n   it('regression: ping at high priority causes update to be dropped', async () => {\n     const {useState, useTransition} = React;\n@@ -3654,7 +3842,16 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     // Update to \"a\". That will suspend.\n     await act(async () => {\n       setTextWithShortTransition('a');\n-      await waitForAll(['Pending...', '', 'Suspend! [a]', 'Loading...']);\n+      await waitForAll([\n+        'Pending...',\n+        '',\n+        'Suspend! [a]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [a]', 'Loading...']\n+          : []),\n+      ]);\n     });\n     assertLog([]);\n     expect(root).toMatchRenderedOutput(\n@@ -3673,6 +3870,10 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n         '',\n         'Suspend! [b]',\n         'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [b]', 'Loading...']\n+          : []),\n       ]);\n     });\n     assertLog([]);\n@@ -3687,7 +3888,14 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n     await act(async () => {\n       await resolveText('a');\n \n-      await waitForAll(['Suspend! [b]', 'Loading...']);\n+      await waitForAll([\n+        'Suspend! [b]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [b]', 'Loading...']\n+          : []),\n+      ]);\n       expect(root).toMatchRenderedOutput(\n         <>\n           <span prop=\"Pending...\" />"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactTransition-test.js",
                "git_diff": "@@ -199,6 +199,10 @@ describe('ReactTransition', () => {\n         '(empty)',\n         'Suspend! [Async]',\n         'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [Async]', 'Loading...']\n+          : []),\n       ]);\n \n       expect(root).toMatchRenderedOutput('Pending...(empty)');\n@@ -269,6 +273,10 @@ describe('ReactTransition', () => {\n         'B label',\n         'Suspend! [B content]',\n         'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['B label', 'Suspend! [B content]', 'Loading...']\n+          : []),\n       ]);\n       // This is a refresh transition so it shouldn't show a fallback\n       expect(root).toMatchRenderedOutput(\n@@ -290,6 +298,10 @@ describe('ReactTransition', () => {\n         'C label',\n         'Suspend! [C content]',\n         'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['C label', 'Suspend! [C content]', 'Loading...']\n+          : []),\n       ]);\n       expect(root).toMatchRenderedOutput(\n         <>\n@@ -307,6 +319,10 @@ describe('ReactTransition', () => {\n         'C label',\n         'Suspend! [C content]',\n         'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['C label', 'Suspend! [C content]', 'Loading...']\n+          : []),\n       ]);\n       expect(root).toMatchRenderedOutput(\n         <>\n@@ -394,6 +410,10 @@ describe('ReactTransition', () => {\n         'B label',\n         'Suspend! [B content]',\n         'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['B label', 'Suspend! [B content]', 'Loading...']\n+          : []),\n       ]);\n       // This is a refresh transition so it shouldn't show a fallback\n       expect(root).toMatchRenderedOutput(\n@@ -415,6 +435,10 @@ describe('ReactTransition', () => {\n         'C label',\n         'Suspend! [C content]',\n         'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['C label', 'Suspend! [C content]', 'Loading...']\n+          : []),\n       ]);\n       expect(root).toMatchRenderedOutput(\n         <>\n@@ -432,6 +456,10 @@ describe('ReactTransition', () => {\n         'C label',\n         'Suspend! [C content]',\n         'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['C label', 'Suspend! [C content]', 'Loading...']\n+          : []),\n       ]);\n       expect(root).toMatchRenderedOutput(\n         <>\n@@ -500,7 +528,14 @@ describe('ReactTransition', () => {\n           setShowA(true);\n         });\n       });\n-      assertLog(['Suspend! [A]', 'Loading...']);\n+      assertLog([\n+        'Suspend! [A]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [A]', 'Loading...']\n+          : []),\n+      ]);\n       expect(root).toMatchRenderedOutput(null);\n \n       // Before A loads, switch to B. This should entangle A with B.\n@@ -510,7 +545,14 @@ describe('ReactTransition', () => {\n           setShowB(true);\n         });\n       });\n-      assertLog(['Suspend! [B]', 'Loading...']);\n+      assertLog([\n+        'Suspend! [B]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [B]', 'Loading...']\n+          : []),\n+      ]);\n       expect(root).toMatchRenderedOutput(null);\n \n       // Before A or B loads, switch to C. This should entangle C with B, and\n@@ -521,7 +563,14 @@ describe('ReactTransition', () => {\n           setShowC(true);\n         });\n       });\n-      assertLog(['Suspend! [C]', 'Loading...']);\n+      assertLog([\n+        'Suspend! [C]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [C]', 'Loading...']\n+          : []),\n+      ]);\n       expect(root).toMatchRenderedOutput(null);\n \n       // Now the data starts resolving out of order.\n@@ -533,7 +582,14 @@ describe('ReactTransition', () => {\n           resolveText('B');\n         });\n       });\n-      assertLog(['Suspend! [C]', 'Loading...']);\n+      assertLog([\n+        'Suspend! [C]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [C]', 'Loading...']\n+          : []),\n+      ]);\n       expect(root).toMatchRenderedOutput(null);\n \n       // Now resolve A. Again, this will attempt to render C, since everything\n@@ -543,7 +599,14 @@ describe('ReactTransition', () => {\n           resolveText('A');\n         });\n       });\n-      assertLog(['Suspend! [C]', 'Loading...']);\n+      assertLog([\n+        'Suspend! [C]',\n+        'Loading...',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend! [C]', 'Loading...']\n+          : []),\n+      ]);\n       expect(root).toMatchRenderedOutput(null);\n \n       // Finally, resolve C. This time we can finish.\n@@ -861,6 +924,10 @@ describe('ReactTransition', () => {\n       // Suspend.\n       'Suspend! [Async]',\n       'Loading...',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['Suspend! [Async]', 'Normal pri: 0', 'Loading...']\n+        : []),\n     ]);\n     expect(root).toMatchRenderedOutput('(empty), Normal pri: 0');\n "
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactUse-test.js",
                "git_diff": "@@ -558,6 +558,7 @@ describe('ReactUse', () => {\n     }\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('during a transition, can unwrap async operations even if nothing is cached', async () => {\n     function App() {\n       return <Text text={use(getAsyncText('Async'))} />;\n@@ -593,6 +594,7 @@ describe('ReactUse', () => {\n     expect(root).toMatchRenderedOutput('Async');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it(\"does not prevent a Suspense fallback from showing if it's a new boundary, even during a transition\", async () => {\n     function App() {\n       return <Text text={use(getAsyncText('Async'))} />;\n@@ -635,6 +637,7 @@ describe('ReactUse', () => {\n     expect(root).toMatchRenderedOutput('Async');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('when waiting for data to resolve, a fresh update will trigger a restart', async () => {\n     function App() {\n       return <Text text={use(getAsyncText('Will never resolve'))} />;\n@@ -666,6 +669,7 @@ describe('ReactUse', () => {\n     assertLog(['Something different']);\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('when waiting for data to resolve, an update on a different root does not cause work to be dropped', async () => {\n     const promise = getAsyncText('Hi');\n \n@@ -708,6 +712,7 @@ describe('ReactUse', () => {\n     expect(root1).toMatchRenderedOutput('Hi');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('while suspended, hooks cannot be called (i.e. current dispatcher is unset correctly)', async () => {\n     function App() {\n       return <Text text={use(getAsyncText('Will never resolve'))} />;\n@@ -845,6 +850,7 @@ describe('ReactUse', () => {\n     expect(root).toMatchRenderedOutput('(empty)');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('when replaying a suspended component, reuses the hooks computed during the previous attempt (Memo)', async () => {\n     function ExcitingText({text}) {\n       // This computes the uppercased version of some text. Pretend it's an\n@@ -894,6 +900,7 @@ describe('ReactUse', () => {\n     ]);\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('when replaying a suspended component, reuses the hooks computed during the previous attempt (State)', async () => {\n     let _setFruit;\n     let _setVegetable;\n@@ -950,6 +957,7 @@ describe('ReactUse', () => {\n     expect(root).toMatchRenderedOutput('banana dill');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('when replaying a suspended component, reuses the hooks computed during the previous attempt (DebugValue+State)', async () => {\n     // Make sure we don't get a Hook mismatch warning on updates if there were non-stateful Hooks before the use().\n     let _setLawyer;\n@@ -991,6 +999,7 @@ describe('ReactUse', () => {\n     expect(root).toMatchRenderedOutput('aguacate avocat');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it(\n     'wrap an async function with useMemo to skip running the function ' +\n       'twice when loading new data',\n@@ -1057,13 +1066,25 @@ describe('ReactUse', () => {\n     await act(() => {\n       resolveTextRequests('A');\n     });\n-    assertLog(['A', '(Loading B...)']);\n+    assertLog([\n+      'A',\n+      '(Loading B...)',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A', '(Loading C...)', '(Loading B...)']\n+        : []),\n+    ]);\n     expect(root).toMatchRenderedOutput('A(Loading B...)');\n \n     await act(() => {\n       resolveTextRequests('B');\n     });\n-    assertLog(['B', '(Loading C...)']);\n+    assertLog([\n+      'B',\n+      '(Loading C...)',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['B', '(Loading C...)'] : []),\n+    ]);\n     expect(root).toMatchRenderedOutput('AB(Loading C...)');\n \n     await act(() => {\n@@ -1073,6 +1094,7 @@ describe('ReactUse', () => {\n     expect(root).toMatchRenderedOutput('ABC');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('load multiple nested Suspense boundaries (uncached requests)', async () => {\n     // This the same as the previous test, except the requests are not cached.\n     // The tree should still eventually resolve, despite the\n@@ -1196,6 +1218,7 @@ describe('ReactUse', () => {\n     expect(root).toMatchRenderedOutput('Hi');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('basic async component', async () => {\n     async function App() {\n       await getAsyncText('Hi');\n@@ -1220,6 +1243,7 @@ describe('ReactUse', () => {\n     expect(root).toMatchRenderedOutput('Hi');\n   });\n \n+  // @gate enableSuspendingDuringWorkLoop\n   it('async child of a non-function component (e.g. a class)', async () => {\n     class App extends React.Component {\n       async render() {\n@@ -1856,16 +1880,26 @@ describe('ReactUse', () => {\n \n     await expect(async () => {\n       await act(() => resolveTextRequests('Hi'));\n-    }).toErrorDev(\n+    }).toErrorDev([\n       // We get this warning because the generator's promise themselves are not cached.\n       'A component was suspended by an uncached promise. Creating ' +\n         'promises inside a Client Component or hook is not yet ' +\n         'supported, except via a Suspense-compatible library or framework.',\n-    );\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A component was suspended by an uncached promise.']\n+        : []),\n+    ]);\n \n     assertLog(['Async text requested [World]']);\n \n-    await act(() => resolveTextRequests('World'));\n+    if (gate('enableSiblingPrerendering')) {\n+      await expect(async () => {\n+        await act(() => resolveTextRequests('World'));\n+      }).toErrorDev(['A component was suspended by an uncached promise.']);\n+    } else {\n+      await act(() => resolveTextRequests('World'));\n+    }\n \n     assertLog(['Hi', 'World']);\n     expect(root).toMatchRenderedOutput('Hi World');\n@@ -1901,16 +1935,26 @@ describe('ReactUse', () => {\n \n     await expect(async () => {\n       await act(() => resolveTextRequests('Hi'));\n-    }).toErrorDev(\n+    }).toErrorDev([\n       // We get this warning because the generator's promise themselves are not cached.\n       'A component was suspended by an uncached promise. Creating ' +\n         'promises inside a Client Component or hook is not yet ' +\n         'supported, except via a Suspense-compatible library or framework.',\n-    );\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? ['A component was suspended by an uncached promise.']\n+        : []),\n+    ]);\n \n     assertLog(['Async text requested [World]']);\n \n-    await act(() => resolveTextRequests('World'));\n+    if (gate('enableSiblingPrerendering')) {\n+      await expect(async () => {\n+        await act(() => resolveTextRequests('World'));\n+      }).toErrorDev(['A component was suspended by an uncached promise.']);\n+    } else {\n+      await act(() => resolveTextRequests('World'));\n+    }\n \n     assertLog(['Hi', 'World']);\n     expect(root).toMatchRenderedOutput(<div>Hi World</div>);"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/useMemoCache-test.js",
                "git_diff": "@@ -559,13 +559,26 @@ describe('useMemoCache()', () => {\n         root.render(<App chunkA={updatedChunkA} chunkB={updatedChunkB} />);\n       });\n     });\n-    assertLog(['Suspend! [chunkA]']);\n+    assertLog([\n+      'Suspend! [chunkA]',\n+\n+      ...(gate('enableSiblingPrerendering') ? ['Suspend! [chunkA]'] : []),\n+    ]);\n \n     // The data starts to stream in. Loading the data in the first chunk\n     // triggers an expensive computation in the UI. Later, we'll test whether\n     // this computation is reused.\n     await act(() => updatedChunkA.resolve('A2'));\n-    assertLog(['Some expensive processing... [A2]', 'Suspend! [chunkB]']);\n+    assertLog([\n+      'Some expensive processing... [A2]',\n+      'Suspend! [chunkB]',\n+\n+      ...(gate('enableSiblingPrerendering')\n+        ? gate('enableNoCloningMemoCache')\n+          ? ['Suspend! [chunkB]']\n+          : ['Some expensive processing... [A2]', 'Suspend! [chunkB]']\n+        : []),\n+    ]);\n \n     // The second chunk hasn't loaded yet, so we're still showing the\n     // initial UI.\n@@ -586,11 +599,22 @@ describe('useMemoCache()', () => {\n     if (gate(flags => flags.enableNoCloningMemoCache)) {\n       // We did not have process the first chunk again. We reused the\n       // computation from the earlier attempt.\n-      assertLog(['Suspend! [chunkB]']);\n+      assertLog([\n+        'Suspend! [chunkB]',\n+\n+        ...(gate('enableSiblingPrerendering') ? ['Suspend! [chunkB]'] : []),\n+      ]);\n     } else {\n       // Because we clone/reset the memo cache after every aborted attempt, we\n       // must process the first chunk again.\n-      assertLog(['Some expensive processing... [A2]', 'Suspend! [chunkB]']);\n+      assertLog([\n+        'Some expensive processing... [A2]',\n+        'Suspend! [chunkB]',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Some expensive processing... [A2]', 'Suspend! [chunkB]']\n+          : []),\n+      ]);\n     }\n \n     expect(root).toMatchRenderedOutput("
            },
            {
                "file": "packages/react-reconciler/src/__tests__/useSyncExternalStore-test.js",
                "git_diff": "@@ -274,6 +274,10 @@ describe('useSyncExternalStore', () => {\n         // This should a synchronous re-render of A using the updated value. In\n         // this test, this causes A to suspend.\n         'Suspend A',\n+\n+        ...(gate('enableSiblingPrerendering')\n+          ? ['Suspend A', 'B: Updated']\n+          : []),\n       ]);\n       // Nothing has committed, because A suspended and no fallback\n       // was provided."
            },
            {
                "file": "scripts/jest/TestFlags.js",
                "git_diff": "@@ -83,6 +83,10 @@ function getTestFlags() {\n       enableActivity: releaseChannel === 'experimental' || www || xplat,\n       enableSuspenseList: releaseChannel === 'experimental' || www || xplat,\n       enableLegacyHidden: www,\n+      // TODO: Suspending the work loop during the render phase is currently\n+      // not compatible with sibling prerendering. We will add this optimization\n+      // back in a later step.\n+      enableSuspendingDuringWorkLoop: !featureFlags.enableSiblingPrerendering,\n \n       // This flag is used to determine whether we should run Fizz tests using\n       // the external runtime or the inline script runtime."
            }
        ]
    },
    {
        "prompt": "issue: Updates | description: <!--\r\n  Thanks for submitting a pull request!\r\n  We appreciate you spending the time to work on these changes. Please provide enough information so that others can review your pull request. The three fields below are mandatory.\r\n\r\n  Before submitting a pull request, please make sure the following is done:\r\n\r\n  1. Fork [the repository](https://github.com/facebook/react) and create your branch from `main`.\r\n  2. Run `yarn` in the repository root.\r\n  3. If you've fixed a bug or added code that should be tested, add tests!\r\n  4. Ensure the test suite passes (`yarn test`). Tip: `yarn test --watch TestName` is helpful in development.\r\n  5. Run `yarn test --prod` to test in the production environment. It supports the same options as `yarn test`.\r\n  6. If you need a debugger, run `yarn test --debug --watch TestName`, open `chrome://inspect`, and press \"Inspect\".\r\n  7. Format your code with [prettier](https://github.com/prettier/prettier) (`yarn prettier`).\r\n  8. Make sure your code lints (`yarn lint`). Tip: `yarn linc` to only check changed files.\r\n  9. Run the [Flow](https://flowtype.org/) type checks (`yarn flow`).\r\n  10. If you haven't already, complete the CLA.\r\n\r\n  Learn more about contributing: https://reactjs.org/docs/how-to-contribute.html\r\n-->\r\n\r\n## Summary\r\n\r\n<!--\r\n Explain the **motivation** for making this change. What existing problem does the pull request solve?\r\n-->\r\n\r\n## How did you test this change?\r\n\r\n<!--\r\n  Demonstrate the code is solid. Example: The exact commands you ran and their output, screenshots / videos if the pull request changes the user interface.\r\n  How exactly did you verify that your PR solves the issue you wanted to solve?\r\n  If you leave this empty, your PR will very likely be closed.\r\n-->\r\n",
        "completion": [
            {
                "file": "scripts/bench/package.json",
                "git_diff": "@@ -7,7 +7,7 @@\n   },\n   \"dependencies\": {\n     \"chalk\": \"^2.1.0\",\n-    \"chrome-launcher\": \"^0.10.5\",\n+    \"chrome-launcher\": \"^0.13.2\",\n     \"cli-table\": \"^0.3.1\",\n     \"http-server\": \"^0.10.0\",\n     \"http2\": \"^3.3.6\","
            },
            {
                "file": "scripts/bench/yarn.lock",
                "git_diff": "@@ -244,6 +244,18 @@ chrome-launcher@^0.10.5:\n     mkdirp \"0.5.1\"\n     rimraf \"^2.6.1\"\n \n+chrome-launcher@^0.13.2:\n+  version \"0.13.4\"\n+  resolved \"https://registry.yarnpkg.com/chrome-launcher/-/chrome-launcher-0.13.4.tgz#4c7d81333c98282899c4e38256da23e00ed32f73\"\n+  integrity sha512-nnzXiDbGKjDSK6t2I+35OAPBy5Pw/39bgkb/ZAFwMhwJbdYBp6aH+vW28ZgtjdU890Q7D+3wN/tB8N66q5Gi2A==\n+  dependencies:\n+    \"@types/node\" \"*\"\n+    escape-string-regexp \"^1.0.5\"\n+    is-wsl \"^2.2.0\"\n+    lighthouse-logger \"^1.0.0\"\n+    mkdirp \"^0.5.3\"\n+    rimraf \"^3.0.2\"\n+\n cli-boxes@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/cli-boxes/-/cli-boxes-1.0.0.tgz#4fa917c3e59c94a004cd61f8ee509da651687143\"\n@@ -581,6 +593,18 @@ glob@^7.0.3, glob@^7.0.5:\n     once \"^1.3.0\"\n     path-is-absolute \"^1.0.0\"\n \n+glob@^7.1.3:\n+  version \"7.2.3\"\n+  resolved \"https://registry.yarnpkg.com/glob/-/glob-7.2.3.tgz#b8df0fb802bbfa8e89bd1d938b4e16578ed44f2b\"\n+  integrity sha512-nFR0zLpU2YCaRxwoCJvL6UvCH2JFyFVIvwTLsIf21AuHlMskA1hhTdk+LlYJtOlYt9v6dvszD2BGRqBL+iQK9Q==\n+  dependencies:\n+    fs.realpath \"^1.0.0\"\n+    inflight \"^1.0.4\"\n+    inherits \"2\"\n+    minimatch \"^3.1.1\"\n+    once \"^1.3.0\"\n+    path-is-absolute \"^1.0.0\"\n+\n got@^6.7.1:\n   version \"6.7.1\"\n   resolved \"https://registry.yarnpkg.com/got/-/got-6.7.1.tgz#240cd05785a9a18e561dc1b44b41c763ef1e8db0\"\n@@ -761,6 +785,11 @@ is-buffer@~1.1.1:\n   resolved \"https://registry.yarnpkg.com/is-buffer/-/is-buffer-1.1.6.tgz#efaa2ea9daa0d7ab2ea13a97b2b8ad51fefbe8be\"\n   integrity sha512-NcdALwpXkTm5Zvvbk7owOUSvVvBKDgKP5/ewfXEznmQFfs4ZRmanOeKBTjRVjka3QFoN6XJ+9F3USqfHqTaU5w==\n \n+is-docker@^2.0.0:\n+  version \"2.2.1\"\n+  resolved \"https://registry.yarnpkg.com/is-docker/-/is-docker-2.2.1.tgz#33eeabe23cfe86f14bde4408a02c0cfb853acdaa\"\n+  integrity sha512-F+i2BKsFrH66iaUFc0woD8sLy8getkwTwtOBjvs56Cx4CgJDeKQeqfz8wAYiSb8JOprWhHH5p77PbmYCvvUuXQ==\n+\n is-fullwidth-code-point@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-fullwidth-code-point/-/is-fullwidth-code-point-1.0.0.tgz#ef9e31386f031a7f0d643af82fde50c457ef00cb\"\n@@ -805,6 +834,13 @@ is-wsl@^1.1.0:\n   resolved \"https://registry.yarnpkg.com/is-wsl/-/is-wsl-1.1.0.tgz#1f16e4aa22b04d1336b66188a66af3c600c3a66d\"\n   integrity sha1-HxbkqiKwTRM2tmGIpmrzxgDDpm0=\n \n+is-wsl@^2.2.0:\n+  version \"2.2.0\"\n+  resolved \"https://registry.yarnpkg.com/is-wsl/-/is-wsl-2.2.0.tgz#74a4c76e77ca9fd3f932f290c17ea326cd157271\"\n+  integrity sha512-fKzAra0rGJUUBwGBgNkHZuToZcn+TtXHpeCgmkMJMMYx1sQDYaCSyjJBSCa2nH1DGm7s3n1oBnohoVTBaN7Lww==\n+  dependencies:\n+    is-docker \"^2.0.0\"\n+\n isarray@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/isarray/-/isarray-1.0.0.tgz#bb935d48582cba168c06834957a54a3e07124f11\"\n@@ -1005,6 +1041,13 @@ minimatch@^3.0.0, minimatch@^3.0.2, minimatch@^3.0.4:\n   dependencies:\n     brace-expansion \"^1.1.7\"\n \n+minimatch@^3.1.1:\n+  version \"3.1.2\"\n+  resolved \"https://registry.yarnpkg.com/minimatch/-/minimatch-3.1.2.tgz#19cd194bfd3e428f049a70817c038d89ab4be35b\"\n+  integrity sha512-J7p63hRiAjw1NDEww1W7i37+ByIrOWO5XQQAzZ3VOcL0PNybwpfmV/N05zFAzwQ9USyEcX6t3UO+K5aqBQOIHw==\n+  dependencies:\n+    brace-expansion \"^1.1.7\"\n+\n minimist@0.0.8:\n   version \"0.0.8\"\n   resolved \"https://registry.yarnpkg.com/minimist/-/minimist-0.0.8.tgz#857fcabfc3397d2625b8228262e86aa7a011b05d\"\n@@ -1014,6 +1057,11 @@ minimist@^1.1.0, minimist@^1.2.0, minimist@^1.2.3:\n   resolved \"https://registry.yarnpkg.com/minimist/-/minimist-1.2.5.tgz#67d66014b66a6a8aaa0c083c5fd58df4e4e97602\"\n   integrity sha512-FM9nNUYrRBAELZQT3xeZQ7fmMOBg6nWNmJKTcgsJeaLstP/UODVpGsr5OhXhhXg6f+qtJ8uiZ+PUxkDWcgIXLw==\n \n+minimist@^1.2.6:\n+  version \"1.2.8\"\n+  resolved \"https://registry.yarnpkg.com/minimist/-/minimist-1.2.8.tgz#c1a464e7693302e082a075cee0c057741ac4772c\"\n+  integrity sha512-2yyAR8qBkN3YuheJanUpWC5U3bb5osDywNB8RzDVlDwDHbocAJveqqj1u8+SVD7jkWT4yvsHCpWqqWqAxb0zCA==\n+\n minimist@~0.0.1:\n   version \"0.0.10\"\n   resolved \"https://registry.yarnpkg.com/minimist/-/minimist-0.0.10.tgz#de3f98543dbf96082be48ad1a0c7cda836301dcf\"\n@@ -1024,6 +1072,13 @@ mkdirp@0.5.1, mkdirp@0.5.x, \"mkdirp@>=0.5 0\", mkdirp@^0.5.0, mkdirp@^0.5.1:\n   dependencies:\n     minimist \"0.0.8\"\n \n+mkdirp@^0.5.3:\n+  version \"0.5.6\"\n+  resolved \"https://registry.yarnpkg.com/mkdirp/-/mkdirp-0.5.6.tgz#7def03d2432dcae4ba1d611445c48396062255f6\"\n+  integrity sha512-FP+p8RB8OWpF3YZBCrP5gtADmtXApB5AMLn+vdyA+PyxCjrCs00mjyUozssO33cwDeT3wNGdLxJ5M//YqtHAJw==\n+  dependencies:\n+    minimist \"^1.2.6\"\n+\n ms@2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/ms/-/ms-2.0.0.tgz#5608aeadfc00be6c2901df5f9861788de0d597c8\"\n@@ -1358,6 +1413,13 @@ rimraf@2, rimraf@^2.2.8, rimraf@^2.5.1, rimraf@^2.6.1:\n   dependencies:\n     glob \"^7.0.5\"\n \n+rimraf@^3.0.2:\n+  version \"3.0.2\"\n+  resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-3.0.2.tgz#f1a5402ba6220ad52cc1282bac1ae3aa49fd061a\"\n+  integrity sha512-JZkJMZkAGFFPP2YqXZXPbMlMBgsxzE8ILs4lMIX/2o0L9UBw9O/Y3o6wFw/i9YLapcUJWwqbi3kdxIPdC62TIA==\n+  dependencies:\n+    glob \"^7.1.3\"\n+\n robots-parser@^2.0.1:\n   version \"2.1.0\"\n   resolved \"https://registry.yarnpkg.com/robots-parser/-/robots-parser-2.1.0.tgz#d16b78ce34e861ab6afbbf0aac65974dbe01566e\""
            },
            {
                "file": ".circleci/config.yml",
                "git_diff": "@@ -97,6 +97,16 @@ jobs:\n       - setup_node_modules\n       - run: node ./scripts/tasks/flow-ci\n \n+\n+  yarn_flags:\n+    docker: *docker\n+    environment: *environment\n+\n+    steps:\n+      - checkout\n+      - setup_node_modules\n+      - run: yarn flags\n+\n   scrape_warning_messages:\n     docker: *docker\n     environment: *environment\n@@ -236,6 +246,53 @@ jobs:\n             RELEASE_CHANNEL: experimental\n           command: ./scripts/circleci/run_devtools_e2e_tests.js\n \n+  run_fixtures_flight_tests:\n+    docker:\n+      - image: cimg/openjdk:20.0-node\n+    environment: *environment\n+    steps:\n+      - checkout\n+      - attach_workspace:\n+          at: .\n+      # Fixture copies some built packages from the workroot after install.\n+      # That means dependencies of the built packages are not installed.\n+      # We need to install dependencies of the workroot to fulfill all dependency constraints\n+      - setup_node_modules\n+      - restore_cache:\n+          name: Restore yarn cache of fixture\n+          keys:\n+            - v2-yarn_cache_fixtures_flight-{{ arch }}-{{ checksum \"yarn.lock\" }}\n+      - run:\n+          name: Install fixture dependencies\n+          working_directory: fixtures/flight\n+          command: |\n+            yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n+            if [ $? -ne 0 ]; then\n+              yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n+            fi\n+      - save_cache:\n+          name: Save yarn cache of fixture\n+          key: v2-yarn_cache_fixtures_flight-{{ arch }}-{{ checksum \"yarn.lock\" }}\n+          paths:\n+            - ~/.cache/yarn\n+      - run:\n+          working_directory: fixtures/flight\n+          name: Playwright install deps\n+          command: |\n+            npx playwright install\n+            sudo npx playwright install-deps\n+      - run:\n+          name: Run tests\n+          working_directory: fixtures/flight\n+          command: yarn test\n+          environment:\n+          # Otherwise the webserver is a blackbox\n+            DEBUG: pw:webserver\n+      - store_artifacts:\n+          path: fixtures/flight/playwright-report\n+      - store_artifacts:\n+          path: fixtures/flight/test-results\n+\n   run_devtools_tests_for_versions:\n     docker: *docker\n     environment: *environment\n@@ -400,6 +457,11 @@ workflows:\n   build_and_test:\n     unless: << pipeline.parameters.prerelease_commit_sha >>\n     jobs:\n+      - yarn_flags:\n+          filters:\n+            branches:\n+              ignore:\n+                - builds/facebook-www\n       - yarn_flow:\n           filters:\n             branches:\n@@ -516,6 +578,9 @@ workflows:\n       - run_devtools_e2e_tests:\n           requires:\n             - build_devtools_and_process_artifacts\n+      - run_fixtures_flight_tests:\n+          requires:\n+            - yarn_build\n \n   devtools_regression_tests:\n     unless: << pipeline.parameters.prerelease_commit_sha >>"
            },
            {
                "file": ".eslintrc.js",
                "git_diff": "@@ -381,6 +381,13 @@ module.exports = {\n         'jest/valid-expect-in-promise': ERROR,\n       },\n     },\n+    {\n+      // disable no focused tests for test setup helper files even if they are inside __tests__ directory\n+      files: ['**/setupTests.js'],\n+      rules: {\n+        'jest/no-focused-tests': OFF,\n+      },\n+    },\n     {\n       files: [\n         '**/__tests__/**/*.js',\n@@ -448,6 +455,13 @@ module.exports = {\n         __IS_CHROME__: 'readonly',\n         __IS_FIREFOX__: 'readonly',\n         __IS_EDGE__: 'readonly',\n+        __IS_INTERNAL_VERSION__: 'readonly',\n+      },\n+    },\n+    {\n+      files: ['packages/react-devtools-shared/**/*.js'],\n+      globals: {\n+        __IS_INTERNAL_VERSION__: 'readonly',\n       },\n     },\n   ],"
            },
            {
                "file": ".github/ISSUE_TEMPLATE/config.yml",
                "git_diff": "@@ -1,6 +1,6 @@\n contact_links:\n     - name: \ud83d\udcc3 Documentation Issue\n-      url: https://github.com/reactjs/reactjs.org/issues/new\n+      url: https://github.com/reactjs/react.dev/issues/new/choose\n       about: This issue tracker is not for documentation issues. Please file documentation issues here.\n     - name: \ud83e\udd14 Questions and Help\n       url: https://reactjs.org/community/support.html"
            },
            {
                "file": ".github/dependabot.yml",
                "git_diff": "@@ -0,0 +1,107 @@\n+version: 2\n+updates:\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/art\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/attribute-behavior\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/concurrent\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/devtools\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/dom\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/eslint\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/expiration\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/fiber-debugger\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/fiber-triangle\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/fizz\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/fizz-ssr-browser\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/flight\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/flight-browser\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/flight-esm\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/legacy-jsx-runtimes\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/nesting\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/packaging\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/scheduler\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/ssr\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/ssr-2\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0\n+  - package-ecosystem: \"npm\"\n+    directory: \"/fixtures/stacks\"\n+    schedule:\n+      interval: \"weekly\"\n+    open-pull-requests-limit: 0"
            },
            {
                "file": ".github/workflows/commit_artifacts.yml",
                "git_diff": "@@ -11,7 +11,7 @@ jobs:\n       www_branch_count: ${{ steps.check_branches.outputs.www_branch_count }}\n       fbsource_branch_count: ${{ steps.check_branches.outputs.fbsource_branch_count }}\n     steps:\n-      - uses: actions/checkout@v3\n+      - uses: actions/checkout@v4\n       - name: \"Check branches\"\n         id: check_branches\n         run: |\n@@ -179,7 +179,7 @@ jobs:\n     if: ${{ (github.ref == 'refs/heads/main' && needs.download_artifacts.outputs.www_branch_count == '0') || github.ref == 'refs/heads/meta-www' }}\n     runs-on: ubuntu-latest\n     steps:\n-      - uses: actions/checkout@v3\n+      - uses: actions/checkout@v4\n         with:\n           ref: builds/facebook-www\n       - name: Ensure clean directory\n@@ -215,7 +215,7 @@ jobs:\n     runs-on: ubuntu-latest\n     if: ${{ (github.ref == 'refs/heads/main' && needs.download_artifacts.outputs.fbsource_branch_count == '0') || github.ref == 'refs/heads/meta-fbsource' }}\n     steps:\n-      - uses: actions/checkout@v3\n+      - uses: actions/checkout@v4\n         with:\n           ref: main\n           repository: facebook/react-fbsource-import"
            },
            {
                "file": "README.md",
                "git_diff": "@@ -36,7 +36,7 @@ The documentation is divided into several sections:\n * [Where to Get Support](https://react.dev/community)\n * [Contributing Guide](https://legacy.reactjs.org/docs/how-to-contribute.html)\n \n-You can improve it by sending pull requests to [this repository](https://github.com/reactjs/reactjs.org).\n+You can improve it by sending pull requests to [this repository](https://github.com/reactjs/react.dev).\n \n ## Examples\n "
            },
            {
                "file": "babel.config.js",
                "git_diff": "@@ -3,7 +3,6 @@\n module.exports = {\n   plugins: [\n     '@babel/plugin-syntax-jsx',\n-    '@babel/plugin-transform-react-jsx',\n     '@babel/plugin-transform-flow-strip-types',\n     ['@babel/plugin-proposal-class-properties', {loose: true}],\n     'syntax-trailing-function-commas',"
            },
            {
                "file": "fixtures/attribute-behavior/.gitignore",
                "git_diff": "@@ -10,7 +10,7 @@\n /build\n /public/react.development.js\n /public/react-dom.development.js\n-/public/react-dom-server-legacy.browser.development.js\n+/public/react-dom-server.browser.development.js\n \n # misc\n .DS_Store"
            },
            {
                "file": "fixtures/attribute-behavior/AttributeTableSnapshot.md",
                "git_diff": "@@ -294,7 +294,7 @@\n | `action=(string 'on')`| (changed)| `\"http://localhost:3000/on\"` |\n | `action=(string 'off')`| (changed)| `\"http://localhost:3000/off\"` |\n | `action=(symbol)`| (initial, warning)| `\"http://localhost:3000/\"` |\n-| `action=(function)`| (initial, warning)| `\"http://localhost:3000/\"` |\n+| `action=(function)`| (changed, ssr error, ssr mismatch)| `\"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')\"` |\n | `action=(null)`| (initial)| `\"http://localhost:3000/\"` |\n | `action=(undefined)`| (initial)| `\"http://localhost:3000/\"` |\n \n@@ -648,6 +648,31 @@\n | `aria-=(null)`| (initial, warning)| `<null>` |\n | `aria-=(undefined)`| (initial, warning)| `<null>` |\n \n+## `aria-hidden` (on `<div>` inside `<div>`)\n+| Test Case | Flags | Result |\n+| --- | --- | --- |\n+| `aria-hidden=(string)`| (changed)| `\"a string\"` |\n+| `aria-hidden=(empty string)`| (changed)| `<empty string>` |\n+| `aria-hidden=(array with string)`| (changed)| `\"string\"` |\n+| `aria-hidden=(empty array)`| (changed)| `<empty string>` |\n+| `aria-hidden=(object)`| (changed)| `\"result of toString()\"` |\n+| `aria-hidden=(numeric string)`| (changed)| `\"42\"` |\n+| `aria-hidden=(-1)`| (changed)| `\"-1\"` |\n+| `aria-hidden=(0)`| (changed)| `\"0\"` |\n+| `aria-hidden=(integer)`| (changed)| `\"1\"` |\n+| `aria-hidden=(NaN)`| (changed)| `\"NaN\"` |\n+| `aria-hidden=(float)`| (changed)| `\"99.99\"` |\n+| `aria-hidden=(true)`| (changed)| `\"true\"` |\n+| `aria-hidden=(false)`| (changed)| `\"false\"` |\n+| `aria-hidden=(string 'true')`| (changed)| `\"true\"` |\n+| `aria-hidden=(string 'false')`| (changed)| `\"false\"` |\n+| `aria-hidden=(string 'on')`| (changed)| `\"on\"` |\n+| `aria-hidden=(string 'off')`| (changed)| `\"off\"` |\n+| `aria-hidden=(symbol)`| (initial)| `<null>` |\n+| `aria-hidden=(function)`| (initial)| `<null>` |\n+| `aria-hidden=(null)`| (initial)| `<null>` |\n+| `aria-hidden=(undefined)`| (initial)| `<null>` |\n+\n ## `aria-invalidattribute` (on `<div>` inside `<div>`)\n | Test Case | Flags | Result |\n | --- | --- | --- |\n@@ -2568,8 +2593,8 @@\n | `defaultChecked=(string 'false')`| (changed)| `<boolean: true>` |\n | `defaultChecked=(string 'on')`| (changed)| `<boolean: true>` |\n | `defaultChecked=(string 'off')`| (changed)| `<boolean: true>` |\n-| `defaultChecked=(symbol)`| (changed, ssr mismatch)| `<boolean: true>` |\n-| `defaultChecked=(function)`| (changed, ssr mismatch)| `<boolean: true>` |\n+| `defaultChecked=(symbol)`| (initial)| `<boolean: false>` |\n+| `defaultChecked=(function)`| (initial)| `<boolean: false>` |\n | `defaultChecked=(null)`| (initial)| `<boolean: false>` |\n | `defaultChecked=(undefined)`| (initial)| `<boolean: false>` |\n \n@@ -4176,25 +4201,25 @@\n ## `formAction` (on `<input>` inside `<div>`)\n | Test Case | Flags | Result |\n | --- | --- | --- |\n-| `formAction=(string)`| (changed)| `\"https://reactjs.com/\"` |\n-| `formAction=(empty string)`| (initial)| `\"http://localhost:3000/\"` |\n-| `formAction=(array with string)`| (changed)| `\"https://reactjs.com/\"` |\n-| `formAction=(empty array)`| (initial)| `\"http://localhost:3000/\"` |\n-| `formAction=(object)`| (changed)| `\"http://localhost:3000/result%20of%20toString()\"` |\n-| `formAction=(numeric string)`| (changed)| `\"http://localhost:3000/42\"` |\n-| `formAction=(-1)`| (changed)| `\"http://localhost:3000/-1\"` |\n-| `formAction=(0)`| (changed)| `\"http://localhost:3000/0\"` |\n-| `formAction=(integer)`| (changed)| `\"http://localhost:3000/1\"` |\n+| `formAction=(string)`| (changed, warning)| `\"https://reactjs.com/\"` |\n+| `formAction=(empty string)`| (initial, warning)| `\"http://localhost:3000/\"` |\n+| `formAction=(array with string)`| (changed, warning)| `\"https://reactjs.com/\"` |\n+| `formAction=(empty array)`| (initial, warning)| `\"http://localhost:3000/\"` |\n+| `formAction=(object)`| (changed, warning)| `\"http://localhost:3000/result%20of%20toString()\"` |\n+| `formAction=(numeric string)`| (changed, warning)| `\"http://localhost:3000/42\"` |\n+| `formAction=(-1)`| (changed, warning)| `\"http://localhost:3000/-1\"` |\n+| `formAction=(0)`| (changed, warning)| `\"http://localhost:3000/0\"` |\n+| `formAction=(integer)`| (changed, warning)| `\"http://localhost:3000/1\"` |\n | `formAction=(NaN)`| (changed, warning)| `\"http://localhost:3000/NaN\"` |\n-| `formAction=(float)`| (changed)| `\"http://localhost:3000/99.99\"` |\n+| `formAction=(float)`| (changed, warning)| `\"http://localhost:3000/99.99\"` |\n | `formAction=(true)`| (initial, warning)| `\"http://localhost:3000/\"` |\n | `formAction=(false)`| (initial, warning)| `\"http://localhost:3000/\"` |\n-| `formAction=(string 'true')`| (changed)| `\"http://localhost:3000/true\"` |\n-| `formAction=(string 'false')`| (changed)| `\"http://localhost:3000/false\"` |\n-| `formAction=(string 'on')`| (changed)| `\"http://localhost:3000/on\"` |\n-| `formAction=(string 'off')`| (changed)| `\"http://localhost:3000/off\"` |\n+| `formAction=(string 'true')`| (changed, warning)| `\"http://localhost:3000/true\"` |\n+| `formAction=(string 'false')`| (changed, warning)| `\"http://localhost:3000/false\"` |\n+| `formAction=(string 'on')`| (changed, warning)| `\"http://localhost:3000/on\"` |\n+| `formAction=(string 'off')`| (changed, warning)| `\"http://localhost:3000/off\"` |\n | `formAction=(symbol)`| (initial, warning)| `\"http://localhost:3000/\"` |\n-| `formAction=(function)`| (initial, warning)| `\"http://localhost:3000/\"` |\n+| `formAction=(function)`| (changed, warning, ssr error, ssr mismatch)| `\"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')\"` |\n | `formAction=(null)`| (initial)| `\"http://localhost:3000/\"` |\n | `formAction=(undefined)`| (initial)| `\"http://localhost:3000/\"` |\n \n@@ -5398,6 +5423,31 @@\n | `in=(null)`| (initial)| `<null>` |\n | `in=(undefined)`| (initial)| `<null>` |\n \n+## `inert` (on `<div>` inside `<div>`)\n+| Test Case | Flags | Result |\n+| --- | --- | --- |\n+| `inert=(string)`| (changed)| `<boolean: true>` |\n+| `inert=(empty string)`| (changed)| `<boolean: true>` |\n+| `inert=(array with string)`| (changed)| `<boolean: true>` |\n+| `inert=(empty array)`| (changed)| `<boolean: true>` |\n+| `inert=(object)`| (changed)| `<boolean: true>` |\n+| `inert=(numeric string)`| (changed)| `<boolean: true>` |\n+| `inert=(-1)`| (changed)| `<boolean: true>` |\n+| `inert=(0)`| (changed)| `<boolean: true>` |\n+| `inert=(integer)`| (changed)| `<boolean: true>` |\n+| `inert=(NaN)`| (changed, warning)| `<boolean: true>` |\n+| `inert=(float)`| (changed)| `<boolean: true>` |\n+| `inert=(true)`| (initial, warning)| `<boolean: false>` |\n+| `inert=(false)`| (initial, warning)| `<boolean: false>` |\n+| `inert=(string 'true')`| (changed)| `<boolean: true>` |\n+| `inert=(string 'false')`| (changed)| `<boolean: true>` |\n+| `inert=(string 'on')`| (changed)| `<boolean: true>` |\n+| `inert=(string 'off')`| (changed)| `<boolean: true>` |\n+| `inert=(symbol)`| (initial, warning)| `<boolean: false>` |\n+| `inert=(function)`| (initial, warning)| `<boolean: false>` |\n+| `inert=(null)`| (initial)| `<boolean: false>` |\n+| `inert=(undefined)`| (initial)| `<boolean: false>` |\n+\n ## `in2` (on `<feBlend>` inside `<svg>`)\n | Test Case | Flags | Result |\n | --- | --- | --- |\n@@ -5501,27 +5551,27 @@\n ## `inputMode` (on `<input>` inside `<div>`)\n | Test Case | Flags | Result |\n | --- | --- | --- |\n-| `inputMode=(string)`| (changed)| `\"a string\"` |\n-| `inputMode=(empty string)`| (changed)| `<empty string>` |\n-| `inputMode=(array with string)`| (changed)| `\"string\"` |\n-| `inputMode=(empty array)`| (changed)| `<empty string>` |\n-| `inputMode=(object)`| (changed)| `\"result of toString()\"` |\n-| `inputMode=(numeric string)`| (changed)| `\"42\"` |\n-| `inputMode=(-1)`| (changed)| `\"-1\"` |\n-| `inputMode=(0)`| (changed)| `\"0\"` |\n-| `inputMode=(integer)`| (changed)| `\"1\"` |\n-| `inputMode=(NaN)`| (changed, warning)| `\"NaN\"` |\n-| `inputMode=(float)`| (changed)| `\"99.99\"` |\n-| `inputMode=(true)`| (initial, warning)| `<null>` |\n-| `inputMode=(false)`| (initial, warning)| `<null>` |\n-| `inputMode=(string 'true')`| (changed)| `\"true\"` |\n-| `inputMode=(string 'false')`| (changed)| `\"false\"` |\n-| `inputMode=(string 'on')`| (changed)| `\"on\"` |\n-| `inputMode=(string 'off')`| (changed)| `\"off\"` |\n-| `inputMode=(symbol)`| (initial, warning)| `<null>` |\n-| `inputMode=(function)`| (initial, warning)| `<null>` |\n-| `inputMode=(null)`| (initial)| `<null>` |\n-| `inputMode=(undefined)`| (initial)| `<null>` |\n+| `inputMode=(string)`| (initial)| `<empty string>` |\n+| `inputMode=(empty string)`| (initial)| `<empty string>` |\n+| `inputMode=(array with string)`| (initial)| `<empty string>` |\n+| `inputMode=(empty array)`| (initial)| `<empty string>` |\n+| `inputMode=(object)`| (initial)| `<empty string>` |\n+| `inputMode=(numeric string)`| (initial)| `<empty string>` |\n+| `inputMode=(-1)`| (initial)| `<empty string>` |\n+| `inputMode=(0)`| (initial)| `<empty string>` |\n+| `inputMode=(integer)`| (initial)| `<empty string>` |\n+| `inputMode=(NaN)`| (initial, warning)| `<empty string>` |\n+| `inputMode=(float)`| (initial)| `<empty string>` |\n+| `inputMode=(true)`| (initial, warning)| `<empty string>` |\n+| `inputMode=(false)`| (initial, warning)| `<empty string>` |\n+| `inputMode=(string 'true')`| (initial)| `<empty string>` |\n+| `inputMode=(string 'false')`| (initial)| `<empty string>` |\n+| `inputMode=(string 'on')`| (initial)| `<empty string>` |\n+| `inputMode=(string 'off')`| (initial)| `<empty string>` |\n+| `inputMode=(symbol)`| (initial, warning)| `<empty string>` |\n+| `inputMode=(function)`| (initial, warning)| `<empty string>` |\n+| `inputMode=(null)`| (initial)| `<empty string>` |\n+| `inputMode=(undefined)`| (initial)| `<empty string>` |\n \n ## `integrity` (on `<script>` inside `<div>`)\n | Test Case | Flags | Result |\n@@ -9877,7 +9927,7 @@\n | Test Case | Flags | Result |\n | --- | --- | --- |\n | `src=(string)`| (changed)| `\"https://reactjs.com/\"` |\n-| `src=(empty string)`| (changed)| `\"http://localhost:3000/\"` |\n+| `src=(empty string)`| (initial, warning)| `<empty string>` |\n | `src=(array with string)`| (changed)| `\"https://reactjs.com/\"` |\n | `src=(empty array)`| (changed)| `\"http://localhost:3000/\"` |\n | `src=(object)`| (changed)| `\"http://localhost:3000/result%20of%20toString()\"` |"
            },
            {
                "file": "fixtures/attribute-behavior/package.json",
                "git_diff": "@@ -10,9 +10,12 @@\n     \"react-scripts\": \"1.0.11\",\n     \"react-virtualized\": \"^9.9.0\"\n   },\n+  \"resolutions\": {\n+    \"fsevents\": \"1.2.13\"\n+  },\n   \"scripts\": {\n     \"predev\":\n-      \"cp ../../build/oss-experimental/react/umd/react.development.js public/ && cp ../../build/oss-experimental/react-dom/umd/react-dom.development.js public/ && cp ../../build/oss-experimental/react-dom/umd/react-dom-server-legacy.browser.development.js public/\",\n+      \"cp ../../build/oss-experimental/react/umd/react.development.js public/ && cp ../../build/oss-experimental/react-dom/umd/react-dom.development.js public/ && cp ../../build/oss-experimental/react-dom/umd/react-dom-server.browser.development.js public/\",\n     \"dev\": \"react-scripts start\",\n     \"build\": \"react-scripts build\",\n     \"test\": \"react-scripts test --env=jsdom\","
            },
            {
                "file": "fixtures/attribute-behavior/src/App.js",
                "git_diff": "@@ -213,13 +213,32 @@ function getCanonicalizedValue(value) {\n \n let _didWarn = false;\n function warn(str) {\n-  if (str.includes('ReactDOM.render is no longer supported')) {\n-    return;\n-  }\n   _didWarn = true;\n }\n+\n+/**\n+ * @param {import('react-dom/server')} serverRenderer\n+ */\n+async function renderToString(serverRenderer, element) {\n+  let didError = false;\n+  const stream = await serverRenderer.renderToReadableStream(element, {\n+    onError(error) {\n+      didError = true;\n+      console.error(error);\n+    },\n+  });\n+  await stream.allReady;\n+\n+  if (didError) {\n+    throw new Error('The above error occurred while rendering to string.');\n+  }\n+\n+  const response = new Response(stream);\n+  return response.text();\n+}\n+\n const UNKNOWN_HTML_TAGS = new Set(['keygen', 'time', 'command']);\n-function getRenderedAttributeValue(\n+async function getRenderedAttributeValue(\n   react,\n   renderer,\n   serverRenderer,\n@@ -283,12 +302,21 @@ function getRenderedAttributeValue(\n   _didWarn = false;\n   try {\n     let container = createContainer();\n-    renderer.render(react.createElement(tagName, baseProps), container);\n+    renderer.flushSync(() => {\n+      renderer\n+        .createRoot(container)\n+        .render(react.createElement(tagName, baseProps));\n+    });\n     defaultValue = read(container.lastChild);\n     canonicalDefaultValue = getCanonicalizedValue(defaultValue);\n \n     container = createContainer();\n-    renderer.render(react.createElement(tagName, props), container);\n+\n+    renderer.flushSync(() => {\n+      renderer\n+        .createRoot(container)\n+        .render(react.createElement(tagName, props));\n+    });\n     result = read(container.lastChild);\n     canonicalResult = getCanonicalizedValue(result);\n     didWarn = _didWarn;\n@@ -305,19 +333,22 @@ function getRenderedAttributeValue(\n   try {\n     let container;\n     if (containerTagName === 'document') {\n-      const html = serverRenderer.renderToString(\n+      const html = await renderToString(\n+        serverRenderer,\n         react.createElement(tagName, props)\n       );\n       container = createContainer();\n       container.innerHTML = html;\n     } else if (containerTagName === 'head') {\n-      const html = serverRenderer.renderToString(\n+      const html = await renderToString(\n+        serverRenderer,\n         react.createElement(tagName, props)\n       );\n       container = createContainer();\n       container.innerHTML = html;\n     } else {\n-      const html = serverRenderer.renderToString(\n+      const html = await renderToString(\n+        serverRenderer,\n         react.createElement(\n           containerTagName,\n           null,\n@@ -326,7 +357,8 @@ function getRenderedAttributeValue(\n       );\n       const outerContainer = document.createElement('div');\n       outerContainer.innerHTML = html;\n-      container = outerContainer.firstChild;\n+      // Float may prepend `<link />`\n+      container = outerContainer.lastChild;\n     }\n \n     if (\n@@ -396,8 +428,8 @@ function getRenderedAttributeValue(\n   };\n }\n \n-function prepareState(initGlobals) {\n-  function getRenderedAttributeValues(attribute, type) {\n+async function prepareState(initGlobals) {\n+  async function getRenderedAttributeValues(attribute, type) {\n     const {\n       ReactStable,\n       ReactDOMStable,\n@@ -406,14 +438,14 @@ function prepareState(initGlobals) {\n       ReactDOMNext,\n       ReactDOMServerNext,\n     } = initGlobals(attribute, type);\n-    const reactStableValue = getRenderedAttributeValue(\n+    const reactStableValue = await getRenderedAttributeValue(\n       ReactStable,\n       ReactDOMStable,\n       ReactDOMServerStable,\n       attribute,\n       type\n     );\n-    const reactNextValue = getRenderedAttributeValue(\n+    const reactNextValue = await getRenderedAttributeValue(\n       ReactNext,\n       ReactDOMNext,\n       ReactDOMServerNext,\n@@ -451,7 +483,7 @@ function prepareState(initGlobals) {\n     let hasSameBehaviorForAll = true;\n     let rowPatternHash = '';\n     for (let type of types) {\n-      const result = getRenderedAttributeValues(attribute, type);\n+      const result = await getRenderedAttributeValues(attribute, type);\n       results.set(type.name, result);\n       if (!result.hasSameBehavior) {\n         hasSameBehaviorForAll = false;\n@@ -772,10 +804,10 @@ class App extends React.Component {\n       ReactDOMStable:\n         'https://unpkg.com/react-dom@latest/umd/react-dom.development.js',\n       ReactDOMServerStable:\n-        'https://unpkg.com/react-dom@latest/umd/react-dom-server-legacy.browser.development.js',\n+        'https://unpkg.com/react-dom@latest/umd/react-dom-server.browser.development.js',\n       ReactNext: '/react.development.js',\n       ReactDOMNext: '/react-dom.development.js',\n-      ReactDOMServerNext: '/react-dom-server-legacy.browser.development.js',\n+      ReactDOMServerNext: '/react-dom-server.browser.development.js',\n     };\n     const codePromises = Object.values(sources).map(src =>\n       fetch(src).then(res => res.text())\n@@ -820,7 +852,7 @@ class App extends React.Component {\n       return globals;\n     }\n \n-    const {table, rowPatternHashes} = prepareState(initGlobals);\n+    const {table, rowPatternHashes} = await prepareState(initGlobals);\n     document.title = 'Ready';\n \n     this.setState({"
            },
            {
                "file": "fixtures/attribute-behavior/src/attributes.js",
                "git_diff": "@@ -119,6 +119,7 @@ const attributes = [\n   },\n   {name: 'aria', read: getAttribute('aria')},\n   {name: 'aria-', read: getAttribute('aria-')},\n+  {name: 'aria-hidden', read: getProperty('ariaHidden')},\n   {name: 'aria-invalidattribute', read: getAttribute('aria-invalidattribute')},\n   {name: 'as', tagName: 'link'},\n   {\n@@ -905,7 +906,7 @@ const attributes = [\n     read: getSVGProperty('height'),\n     overrideStringValue: '100%',\n   },\n-  {name: 'hidden'},\n+  {name: 'hidden', overrideStringValue: 'until-found'},\n   {name: 'high', tagName: 'meter'},\n   {\n     name: 'horiz-adv-x',\n@@ -968,6 +969,7 @@ const attributes = [\n     containerTagName: 'svg',\n     tagName: 'feBlend',\n   },\n+  {name: 'inert'},\n   {\n     name: 'in2',\n     read: getSVGProperty('in2'),\n@@ -977,7 +979,7 @@ const attributes = [\n   {name: 'initialChecked', read: getAttribute('initialchecked')},\n   {name: 'initialValue', read: getAttribute('initialvalue')},\n   {name: 'inlist', read: getAttribute('inlist')},\n-  {name: 'inputMode', tagName: 'input', read: getAttribute('inputmode')}, // TODO: Should use property but it's not implemented in Chrome\n+  {name: 'inputMode', tagName: 'input'},\n   {name: 'integrity', tagName: 'script'},\n   {\n     name: 'intercept',"
            },
            {
                "file": "fixtures/attribute-behavior/yarn.lock",
                "git_diff": "@@ -6,10 +6,6 @@ abab@^1.0.3:\n   version \"1.0.3\"\n   resolved \"https://registry.yarnpkg.com/abab/-/abab-1.0.3.tgz#b81de5f7274ec4e756d797cd834f303642724e5d\"\n \n-abbrev@1:\n-  version \"1.1.0\"\n-  resolved \"https://registry.yarnpkg.com/abbrev/-/abbrev-1.1.0.tgz#d0554c2256636e2f56e7c2e5ad183f859428d81f\"\n-\n accepts@~1.3.3:\n   version \"1.3.4\"\n   resolved \"https://registry.yarnpkg.com/accepts/-/accepts-1.3.4.tgz#86246758c7dd6d21a6474ff084a4740ec05eb21f\"\n@@ -144,17 +140,6 @@ append-transform@^0.4.0:\n   dependencies:\n     default-require-extensions \"^1.0.0\"\n \n-aproba@^1.0.3:\n-  version \"1.1.2\"\n-  resolved \"https://registry.yarnpkg.com/aproba/-/aproba-1.1.2.tgz#45c6629094de4e96f693ef7eab74ae079c240fc1\"\n-\n-are-we-there-yet@~1.1.2:\n-  version \"1.1.4\"\n-  resolved \"https://registry.yarnpkg.com/are-we-there-yet/-/are-we-there-yet-1.1.4.tgz#bb5dca382bb94f05e15194373d16fd3ba1ca110d\"\n-  dependencies:\n-    delegates \"^1.0.0\"\n-    readable-stream \"^2.0.6\"\n-\n argparse@^1.0.7:\n   version \"1.0.9\"\n   resolved \"https://registry.yarnpkg.com/argparse/-/argparse-1.0.9.tgz#73d83bc263f86e97f8cc4f6bae1b0e90a7d22c86\"\n@@ -1036,11 +1021,12 @@ binary-extensions@^1.0.0:\n   version \"1.10.0\"\n   resolved \"https://registry.yarnpkg.com/binary-extensions/-/binary-extensions-1.10.0.tgz#9aeb9a6c5e88638aad171e167f5900abe24835d0\"\n \n-block-stream@*:\n-  version \"0.0.9\"\n-  resolved \"https://registry.yarnpkg.com/block-stream/-/block-stream-0.0.9.tgz#13ebfe778a03205cfe03751481ebb4b3300c126a\"\n+bindings@^1.5.0:\n+  version \"1.5.0\"\n+  resolved \"https://registry.yarnpkg.com/bindings/-/bindings-1.5.0.tgz#10353c9e945334bc0511a6d90b38fbc7c9c504df\"\n+  integrity sha512-p2q/t/mhvuOj/UeLlV6566GD/guowlr0hHxClI0W9m7MWYkL1F0hLo+0Aexs9HSPCtR1SXQ0TD3MMKrXZajbiQ==\n   dependencies:\n-    inherits \"~2.0.0\"\n+    file-uri-to-path \"1.0.0\"\n \n bluebird@^3.4.7:\n   version \"3.5.0\"\n@@ -1536,10 +1522,6 @@ console-browserify@^1.1.0:\n   dependencies:\n     date-now \"^0.1.4\"\n \n-console-control-strings@^1.0.0, console-control-strings@~1.1.0:\n-  version \"1.1.0\"\n-  resolved \"https://registry.yarnpkg.com/console-control-strings/-/console-control-strings-1.1.0.tgz#3d7cf4464db6446ea644bf4b39507f9851008e8e\"\n-\n constants-browserify@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/constants-browserify/-/constants-browserify-1.0.0.tgz#c20b96d8c617748aaf1c16021760cd27fcb8cb75\"\n@@ -1887,10 +1869,6 @@ delayed-stream@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/delayed-stream/-/delayed-stream-1.0.0.tgz#df3ae199acadfb7d440aaae0b29e2272b24ec619\"\n \n-delegates@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/delegates/-/delegates-1.0.0.tgz#84c6e159b81904fdca59a0ef44cd870d31250f9a\"\n-\n depd@1.1.1, depd@~1.1.1:\n   version \"1.1.1\"\n   resolved \"https://registry.yarnpkg.com/depd/-/depd-1.1.1.tgz#5783b4e1c459f06fa5ca27f991f3d06e7a310359\"\n@@ -2583,6 +2561,11 @@ file-saver@^1.3.3:\n   version \"1.3.3\"\n   resolved \"https://registry.yarnpkg.com/file-saver/-/file-saver-1.3.3.tgz#cdd4c44d3aa264eac2f68ec165bc791c34af1232\"\n \n+file-uri-to-path@1.0.0:\n+  version \"1.0.0\"\n+  resolved \"https://registry.yarnpkg.com/file-uri-to-path/-/file-uri-to-path-1.0.0.tgz#553a7b8446ff6f684359c445f1e37a05dacc33dd\"\n+  integrity sha512-0Zt+s3L7Vf1biwWZ29aARiVYLx7iMGnEUl9x33fbB/j3jR81u/O2LbqK+Bm1CDSNDKVtJ/YjwY7TUd5SkeLQLw==\n+\n filename-regex@^2.0.0:\n   version \"2.0.1\"\n   resolved \"https://registry.yarnpkg.com/filename-regex/-/filename-regex-2.0.1.tgz#c1c4b9bee3e09725ddb106b75c1e301fe2f18b26\"\n@@ -2722,29 +2705,13 @@ fs.realpath@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/fs.realpath/-/fs.realpath-1.0.0.tgz#1504ad2523158caa40db4a2787cb01411994ea4f\"\n \n-fsevents@1.1.2, fsevents@^1.0.0:\n-  version \"1.1.2\"\n-  resolved \"https://registry.yarnpkg.com/fsevents/-/fsevents-1.1.2.tgz#3282b713fb3ad80ede0e9fcf4611b5aa6fc033f4\"\n+fsevents@1.1.2, fsevents@1.2.13, fsevents@^1.0.0:\n+  version \"1.2.13\"\n+  resolved \"https://registry.yarnpkg.com/fsevents/-/fsevents-1.2.13.tgz#f325cb0455592428bcf11b383370ef70e3bfcc38\"\n+  integrity sha512-oWb1Z6mkHIskLzEJ/XWX0srkpkTQ7vaopMQkyaEIoq0fmtFVxOthb8cCxeT+p3ynTdkk/RZwbgG4brR5BeWECw==\n   dependencies:\n-    nan \"^2.3.0\"\n-    node-pre-gyp \"^0.6.36\"\n-\n-fstream-ignore@^1.0.5:\n-  version \"1.0.5\"\n-  resolved \"https://registry.yarnpkg.com/fstream-ignore/-/fstream-ignore-1.0.5.tgz#9c31dae34767018fe1d249b24dada67d092da105\"\n-  dependencies:\n-    fstream \"^1.0.0\"\n-    inherits \"2\"\n-    minimatch \"^3.0.0\"\n-\n-fstream@^1.0.0, fstream@^1.0.10, fstream@^1.0.2:\n-  version \"1.0.11\"\n-  resolved \"https://registry.yarnpkg.com/fstream/-/fstream-1.0.11.tgz#5c1fb1f117477114f0632a0eb4b71b3cb0fd3171\"\n-  dependencies:\n-    graceful-fs \"^4.1.2\"\n-    inherits \"~2.0.0\"\n-    mkdirp \">=0.5 0\"\n-    rimraf \"2\"\n+    bindings \"^1.5.0\"\n+    nan \"^2.12.1\"\n \n function-bind@^1.0.2, function-bind@^1.1.0:\n   version \"1.1.0\"\n@@ -2754,19 +2721,6 @@ functional-red-black-tree@^1.0.1:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/functional-red-black-tree/-/functional-red-black-tree-1.0.1.tgz#1b0ab3bd553b2a0d6399d29c0e3ea0b252078327\"\n \n-gauge@~2.7.3:\n-  version \"2.7.4\"\n-  resolved \"https://registry.yarnpkg.com/gauge/-/gauge-2.7.4.tgz#2c03405c7538c39d7eb37b317022e325fb018bf7\"\n-  dependencies:\n-    aproba \"^1.0.3\"\n-    console-control-strings \"^1.0.0\"\n-    has-unicode \"^2.0.0\"\n-    object-assign \"^4.1.0\"\n-    signal-exit \"^3.0.0\"\n-    string-width \"^1.0.1\"\n-    strip-ansi \"^3.0.1\"\n-    wide-align \"^1.1.0\"\n-\n get-caller-file@^1.0.1:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/get-caller-file/-/get-caller-file-1.0.2.tgz#f702e63127e7e231c160a80c1554acb70d5047e5\"\n@@ -2935,10 +2889,6 @@ has-flag@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/has-flag/-/has-flag-2.0.0.tgz#e8207af1cc7b30d446cc70b734b5e8be18f88d51\"\n \n-has-unicode@^2.0.0:\n-  version \"2.0.1\"\n-  resolved \"https://registry.yarnpkg.com/has-unicode/-/has-unicode-2.0.1.tgz#e0e6fe6a28cf51138855e086d1691e771de2a8b9\"\n-\n has@^1.0.1:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/has/-/has-1.0.1.tgz#8461733f538b0837c9361e39a9ab9e9704dc2f28\"\n@@ -3159,7 +3109,7 @@ inflight@^1.0.4:\n     once \"^1.3.0\"\n     wrappy \"1\"\n \n-inherits@2, inherits@2.0.3, inherits@^2.0.1, inherits@^2.0.3, inherits@~2.0.0, inherits@~2.0.1, inherits@~2.0.3:\n+inherits@2, inherits@2.0.3, inherits@^2.0.1, inherits@^2.0.3, inherits@~2.0.1, inherits@~2.0.3:\n   version \"2.0.3\"\n   resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.3.tgz#633c2c83e3da42a502f52466022480f4208261de\"\n \n@@ -4190,7 +4140,7 @@ minimatch@3.0.3:\n   dependencies:\n     brace-expansion \"^1.0.0\"\n \n-minimatch@^3.0.0, minimatch@^3.0.2, minimatch@^3.0.3, minimatch@^3.0.4:\n+minimatch@^3.0.2, minimatch@^3.0.3, minimatch@^3.0.4:\n   version \"3.0.4\"\n   resolved \"https://registry.yarnpkg.com/minimatch/-/minimatch-3.0.4.tgz#5166e286457f03306064be5497e8dbb0c3d32083\"\n   dependencies:\n@@ -4208,7 +4158,7 @@ minimist@~0.0.1:\n   version \"0.0.10\"\n   resolved \"https://registry.yarnpkg.com/minimist/-/minimist-0.0.10.tgz#de3f98543dbf96082be48ad1a0c7cda836301dcf\"\n \n-mkdirp@0.5.1, mkdirp@0.5.x, \"mkdirp@>=0.5 0\", mkdirp@^0.5.0, mkdirp@^0.5.1, mkdirp@~0.5.0, mkdirp@~0.5.1:\n+mkdirp@0.5.1, mkdirp@0.5.x, mkdirp@^0.5.0, mkdirp@^0.5.1, mkdirp@~0.5.0, mkdirp@~0.5.1:\n   version \"0.5.1\"\n   resolved \"https://registry.yarnpkg.com/mkdirp/-/mkdirp-0.5.1.tgz#30057438eac6cf7f8c4767f38648d6697d75c903\"\n   dependencies:\n@@ -4233,9 +4183,10 @@ mute-stream@0.0.7:\n   version \"0.0.7\"\n   resolved \"https://registry.yarnpkg.com/mute-stream/-/mute-stream-0.0.7.tgz#3075ce93bc21b8fab43e1bc4da7e8115ed1e7bab\"\n \n-nan@^2.3.0:\n-  version \"2.6.2\"\n-  resolved \"https://registry.yarnpkg.com/nan/-/nan-2.6.2.tgz#e4ff34e6c95fdfb5aecc08de6596f43605a7db45\"\n+nan@^2.12.1:\n+  version \"2.18.0\"\n+  resolved \"https://registry.yarnpkg.com/nan/-/nan-2.18.0.tgz#26a6faae7ffbeb293a39660e88a76b82e30b7554\"\n+  integrity sha512-W7tfG7vMOGtD30sHoZSSc/JVYiyDPEyQVso/Zz+/uQd0B0L46gtC+pHha5FFMRpil6fm/AoEcRWyOVi4+E/f8w==\n \n natural-compare@^1.4.0:\n   version \"1.4.0\"\n@@ -4313,31 +4264,10 @@ node-notifier@^5.0.2:\n     shellwords \"^0.1.0\"\n     which \"^1.2.12\"\n \n-node-pre-gyp@^0.6.36:\n-  version \"0.6.36\"\n-  resolved \"https://registry.yarnpkg.com/node-pre-gyp/-/node-pre-gyp-0.6.36.tgz#db604112cb74e0d477554e9b505b17abddfab786\"\n-  dependencies:\n-    mkdirp \"^0.5.1\"\n-    nopt \"^4.0.1\"\n-    npmlog \"^4.0.2\"\n-    rc \"^1.1.7\"\n-    request \"^2.81.0\"\n-    rimraf \"^2.6.1\"\n-    semver \"^5.3.0\"\n-    tar \"^2.2.1\"\n-    tar-pack \"^3.4.0\"\n-\n node-status-codes@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/node-status-codes/-/node-status-codes-1.0.0.tgz#5ae5541d024645d32a58fcddc9ceecea7ae3ac2f\"\n \n-nopt@^4.0.1:\n-  version \"4.0.1\"\n-  resolved \"https://registry.yarnpkg.com/nopt/-/nopt-4.0.1.tgz#d0d4685afd5415193c8c7505602d0d17cd64474d\"\n-  dependencies:\n-    abbrev \"1\"\n-    osenv \"^0.1.4\"\n-\n normalize-package-data@^2.3.2, normalize-package-data@^2.3.4:\n   version \"2.4.0\"\n   resolved \"https://registry.yarnpkg.com/normalize-package-data/-/normalize-package-data-2.4.0.tgz#12f95a307d58352075a04907b84ac8be98ac012f\"\n@@ -4372,15 +4302,6 @@ npm-run-path@^2.0.0:\n   dependencies:\n     path-key \"^2.0.0\"\n \n-npmlog@^4.0.2:\n-  version \"4.1.2\"\n-  resolved \"https://registry.yarnpkg.com/npmlog/-/npmlog-4.1.2.tgz#08a7f2a8bf734604779a9efa4ad5cc717abb954b\"\n-  dependencies:\n-    are-we-there-yet \"~1.1.2\"\n-    console-control-strings \"~1.1.0\"\n-    gauge \"~2.7.3\"\n-    set-blocking \"~2.0.0\"\n-\n nth-check@~1.0.1:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/nth-check/-/nth-check-1.0.1.tgz#9929acdf628fc2c41098deab82ac580cf149aae4\"\n@@ -4436,7 +4357,7 @@ on-headers@~1.0.1:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/on-headers/-/on-headers-1.0.1.tgz#928f5d0f470d49342651ea6794b0857c100693f7\"\n \n-once@^1.3.0, once@^1.3.3, once@^1.4.0:\n+once@^1.3.0, once@^1.4.0:\n   version \"1.4.0\"\n   resolved \"https://registry.yarnpkg.com/once/-/once-1.4.0.tgz#583b1aa775961d4b113ac17d9c50baef9dd76bd1\"\n   dependencies:\n@@ -4511,7 +4432,7 @@ os-tmpdir@^1.0.0, os-tmpdir@^1.0.1, os-tmpdir@~1.0.1:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/os-tmpdir/-/os-tmpdir-1.0.2.tgz#bbe67406c79aa85c5cfec766fe5734555dfa1274\"\n \n-osenv@^0.1.0, osenv@^0.1.4:\n+osenv@^0.1.0:\n   version \"0.1.4\"\n   resolved \"https://registry.yarnpkg.com/osenv/-/osenv-0.1.4.tgz#42fe6d5953df06c8064be6f176c3d05aaaa34644\"\n   dependencies:\n@@ -5146,7 +5067,7 @@ range-parser@^1.0.3, range-parser@~1.2.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/range-parser/-/range-parser-1.2.0.tgz#f49be6b487894ddc40dcc94a322f611092e00d5e\"\n \n-rc@^1.0.1, rc@^1.1.6, rc@^1.1.7:\n+rc@^1.0.1, rc@^1.1.6:\n   version \"1.2.1\"\n   resolved \"https://registry.yarnpkg.com/rc/-/rc-1.2.1.tgz#2e03e8e42ee450b8cb3dce65be1bf8974e1dfd95\"\n   dependencies:\n@@ -5308,7 +5229,7 @@ readable-stream@1.0:\n     isarray \"0.0.1\"\n     string_decoder \"~0.10.x\"\n \n-readable-stream@^2.0.0, readable-stream@^2.0.1, readable-stream@^2.0.2, readable-stream@^2.0.5, readable-stream@^2.0.6, readable-stream@^2.1.4, readable-stream@^2.2.2, readable-stream@^2.2.6, readable-stream@^2.2.9:\n+readable-stream@^2.0.0, readable-stream@^2.0.1, readable-stream@^2.0.2, readable-stream@^2.0.5, readable-stream@^2.2.2, readable-stream@^2.2.6, readable-stream@^2.2.9:\n   version \"2.3.3\"\n   resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-2.3.3.tgz#368f2512d79f9d46fdfc71349ae7878bbc1eb95c\"\n   dependencies:\n@@ -5470,7 +5391,7 @@ repeating@^2.0.0:\n   dependencies:\n     is-finite \"^1.0.0\"\n \n-request@^2.79.0, request@^2.81.0:\n+request@^2.79.0:\n   version \"2.81.0\"\n   resolved \"https://registry.yarnpkg.com/request/-/request-2.81.0.tgz#c6928946a0e06c5f8d6f8a9333469ffda46298a0\"\n   dependencies:\n@@ -5554,7 +5475,7 @@ right-align@^0.1.1:\n   dependencies:\n     align-text \"^0.1.1\"\n \n-rimraf@2, rimraf@^2.2.8, rimraf@^2.5.1, rimraf@^2.6.1:\n+rimraf@^2.2.8, rimraf@^2.6.1:\n   version \"2.6.1\"\n   resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-2.6.1.tgz#c2338ec643df7a1b7fe5c54fa86f57428a55f33d\"\n   dependencies:\n@@ -5680,7 +5601,7 @@ serviceworker-cache-polyfill@^4.0.0:\n   version \"4.0.0\"\n   resolved \"https://registry.yarnpkg.com/serviceworker-cache-polyfill/-/serviceworker-cache-polyfill-4.0.0.tgz#de19ee73bef21ab3c0740a37b33db62464babdeb\"\n \n-set-blocking@^2.0.0, set-blocking@~2.0.0:\n+set-blocking@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/set-blocking/-/set-blocking-2.0.0.tgz#045f9782d011ae9a6803ddd382b24392b3d890f7\"\n \n@@ -6048,27 +5969,6 @@ tapable@^0.2.7:\n   version \"0.2.8\"\n   resolved \"https://registry.yarnpkg.com/tapable/-/tapable-0.2.8.tgz#99372a5c999bf2df160afc0d74bed4f47948cd22\"\n \n-tar-pack@^3.4.0:\n-  version \"3.4.0\"\n-  resolved \"https://registry.yarnpkg.com/tar-pack/-/tar-pack-3.4.0.tgz#23be2d7f671a8339376cbdb0b8fe3fdebf317984\"\n-  dependencies:\n-    debug \"^2.2.0\"\n-    fstream \"^1.0.10\"\n-    fstream-ignore \"^1.0.5\"\n-    once \"^1.3.3\"\n-    readable-stream \"^2.1.4\"\n-    rimraf \"^2.5.1\"\n-    tar \"^2.2.1\"\n-    uid-number \"^0.0.6\"\n-\n-tar@^2.2.1:\n-  version \"2.2.1\"\n-  resolved \"https://registry.yarnpkg.com/tar/-/tar-2.2.1.tgz#8e4d2a256c0e2185c6b18ad694aec968b83cb1d1\"\n-  dependencies:\n-    block-stream \"*\"\n-    fstream \"^1.0.2\"\n-    inherits \"2\"\n-\n test-exclude@^4.1.1:\n   version \"4.1.1\"\n   resolved \"https://registry.yarnpkg.com/test-exclude/-/test-exclude-4.1.1.tgz#4d84964b0966b0087ecc334a2ce002d3d9341e26\"\n@@ -6223,10 +6123,6 @@ uglifyjs-webpack-plugin@^0.4.6:\n     uglify-js \"^2.8.29\"\n     webpack-sources \"^1.0.1\"\n \n-uid-number@^0.0.6:\n-  version \"0.0.6\"\n-  resolved \"https://registry.yarnpkg.com/uid-number/-/uid-number-0.0.6.tgz#0ea10e8035e8eb5b8e4449f06da1c730663baa81\"\n-\n uniq@^1.0.1:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/uniq/-/uniq-1.0.1.tgz#b31c5ae8254844a3a8281541ce2b04b865a734ff\"\n@@ -6523,12 +6419,6 @@ which@^1.2.12, which@^1.2.14, which@^1.2.9:\n   dependencies:\n     isexe \"^2.0.0\"\n \n-wide-align@^1.1.0:\n-  version \"1.1.2\"\n-  resolved \"https://registry.yarnpkg.com/wide-align/-/wide-align-1.1.2.tgz#571e0f1b0604636ebc0dfc21b0339bbe31341710\"\n-  dependencies:\n-    string-width \"^1.0.2\"\n-\n widest-line@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/widest-line/-/widest-line-1.0.0.tgz#0c09c85c2a94683d0d7eaf8ee097d564bf0e105c\""
            },
            {
                "file": "fixtures/dom/src/__tests__/nested-act-test.js",
                "git_diff": "@@ -20,7 +20,7 @@ describe('unmocked scheduler', () => {\n   beforeEach(() => {\n     jest.resetModules();\n     React = require('react');\n-    DOMAct = React.unstable_act;\n+    DOMAct = React.act;\n     TestRenderer = require('react-test-renderer');\n     TestAct = TestRenderer.act;\n   });\n@@ -61,7 +61,7 @@ describe('mocked scheduler', () => {\n       require.requireActual('scheduler/unstable_mock')\n     );\n     React = require('react');\n-    DOMAct = React.unstable_act;\n+    DOMAct = React.act;\n     TestRenderer = require('react-test-renderer');\n     TestAct = TestRenderer.act;\n   });"
            },
            {
                "file": "fixtures/dom/src/components/fixtures/suspense/index.js",
                "git_diff": "@@ -213,7 +213,7 @@ class TextInputFixtures extends React.Component {\n \n           <Fixture>\n             <SuspendyTree>\n-              <img src=\"https://upload.wikimedia.org/wikipedia/commons/e/ee/Atom_%282%29.png\" />\n+              <img src=\"https://upload.wikimedia.org/wikipedia/commons/1/1b/Atom.png\" />\n               React is cool\n             </SuspendyTree>\n           </Fixture>"
            },
            {
                "file": "fixtures/flight/.gitignore",
                "git_diff": "@@ -7,6 +7,8 @@\n \n # testing\n /coverage\n+/playwright-report\n+/test-results\n \n # production\n /build"
            },
            {
                "file": "fixtures/flight/__tests__/__e2e__/smoke.test.js",
                "git_diff": "@@ -0,0 +1,20 @@\n+import {test, expect} from '@playwright/test';\n+\n+test('smoke test', async ({page}) => {\n+  const consoleErrors = [];\n+  page.on('console', msg => {\n+    const type = msg.type();\n+    if (type === 'warn' || type === 'error') {\n+      consoleErrors.push({type: type, text: msg.text()});\n+    }\n+  });\n+  const pageErrors = [];\n+  page.on('pageerror', error => {\n+    pageErrors.push(error.stack);\n+  });\n+  await page.goto('/');\n+  await expect(page.locator('h1')).toHaveText('Hello World');\n+\n+  await expect(consoleErrors).toEqual([]);\n+  await expect(pageErrors).toEqual([]);\n+});"
            },
            {
                "file": "fixtures/flight/package.json",
                "git_diff": "@@ -3,11 +3,14 @@\n   \"type\": \"module\",\n   \"version\": \"0.1.0\",\n   \"private\": true,\n+  \"devEngines\": {\n+    \"node\": \"20.x || 21.x\"\n+  },\n   \"dependencies\": {\n     \"@babel/core\": \"^7.16.0\",\n     \"@babel/plugin-proposal-private-property-in-object\": \"^7.18.6\",\n     \"@babel/preset-react\": \"^7.22.5\",\n-    \"@pmmmwh/react-refresh-webpack-plugin\": \"^0.5.3\",\n+    \"@pmmmwh/react-refresh-webpack-plugin\": \"0.5.7\",\n     \"@svgr/webpack\": \"^5.5.0\",\n     \"@testing-library/jest-dom\": \"^5.14.1\",\n     \"@testing-library/react\": \"^13.0.0\",\n@@ -60,6 +63,9 @@\n     \"webpack-hot-middleware\": \"^2.25.3\",\n     \"webpack-manifest-plugin\": \"^4.0.2\"\n   },\n+  \"devDependencies\": {\n+    \"@playwright/test\": \"^1.41.2\"\n+  },\n   \"scripts\": {\n     \"predev\": \"cp -r ../../build/oss-experimental/* ./node_modules/\",\n     \"prebuild\": \"cp -r ../../build/oss-experimental/* ./node_modules/\",\n@@ -70,7 +76,7 @@\n     \"start:global\": \"NODE_ENV=production node --experimental-loader ./loader/global.js server/global\",\n     \"start:region\": \"NODE_ENV=production node --experimental-loader ./loader/region.js --conditions=react-server server/region\",\n     \"build\": \"node scripts/build.js\",\n-    \"test\": \"node scripts/test.js --env=jsdom\"\n+    \"test\": \"playwright test\"\n   },\n   \"browserslist\": {\n     \"production\": ["
            },
            {
                "file": "fixtures/flight/playwright.config.js",
                "git_diff": "@@ -0,0 +1,31 @@\n+import {defineConfig, devices} from '@playwright/test';\n+\n+const isCI = Boolean(process.env.CI);\n+\n+export default defineConfig({\n+  // relative to this configuration file.\n+  testDir: '__tests__/__e2e__',\n+  fullyParallel: true,\n+  // Fail the build on CI if you accidentally left test.only in the source code.\n+  forbidOnly: !isCI,\n+  retries: isCI ? 2 : 0,\n+  // Opt out of parallel tests on CI.\n+  workers: isCI ? 1 : undefined,\n+  reporter: 'html',\n+  use: {\n+    baseURL: 'http://localhost:3000',\n+\n+    trace: 'on-first-retry',\n+  },\n+  projects: [\n+    {\n+      name: 'chromium',\n+      use: {...devices['Desktop Chrome']},\n+    },\n+  ],\n+  webServer: {\n+    command: 'FAST_REFRESH=false yarn dev',\n+    url: 'http://localhost:3000',\n+    reuseExistingServer: !isCI,\n+  },\n+});"
            },
            {
                "file": "fixtures/flight/server/global.js",
                "git_diff": "@@ -37,6 +37,7 @@ const React = require('react');\n \n const {renderToPipeableStream} = require('react-dom/server');\n const {createFromNodeStream} = require('react-server-dom-webpack/client');\n+const {PassThrough} = require('stream');\n \n const app = express();\n \n@@ -146,36 +147,46 @@ app.all('/', async function (req, res, next) {\n       // so we start by consuming the RSC payload. This needs a module\n       // map that reverse engineers the client-side path to the SSR path.\n \n-      // This is a bad hack to set the form state after SSR has started. It works\n-      // because we block the root component until we have the form state and\n-      // any form that reads it necessarily will come later. It also only works\n-      // because the formstate type is an object which may change in the future\n-      const lazyFormState = [];\n-\n-      let cachedResult = null;\n-      async function getRootAndFormState() {\n-        const {root, formState} = await createFromNodeStream(\n-          rscResponse,\n-          ssrManifest\n-        );\n-        // We shouldn't be assuming formState is an object type but at the moment\n-        // we have no way of setting the form state from within the render\n-        Object.assign(lazyFormState, formState);\n-        return root;\n-      }\n+      // We need to get the formState before we start rendering but we also\n+      // need to run the Flight client inside the render to get all the preloads.\n+      // The API is ambivalent about what's the right one so we need two for now.\n+\n+      // Tee the response into two streams so that we can do both.\n+      const rscResponse1 = new PassThrough();\n+      const rscResponse2 = new PassThrough();\n+\n+      rscResponse.pipe(rscResponse1);\n+      rscResponse.pipe(rscResponse2);\n+\n+      const {formState} = await createFromNodeStream(rscResponse1, ssrManifest);\n+      rscResponse1.end();\n+\n+      let cachedResult;\n       let Root = () => {\n         if (!cachedResult) {\n-          cachedResult = getRootAndFormState();\n+          // Read this stream inside the render.\n+          cachedResult = createFromNodeStream(rscResponse2, ssrManifest);\n         }\n-        return React.use(cachedResult);\n+        return React.use(cachedResult).root;\n       };\n       // Render it into HTML by resolving the client components\n       res.set('Content-type', 'text/html');\n       const {pipe} = renderToPipeableStream(React.createElement(Root), {\n         bootstrapScripts: mainJSChunks,\n-        formState: lazyFormState,\n+        formState: formState,\n+        onShellReady() {\n+          pipe(res);\n+        },\n+        onShellError(error) {\n+          const {pipe: pipeError} = renderToPipeableStream(\n+            React.createElement('html', null, React.createElement('body')),\n+            {\n+              bootstrapScripts: mainJSChunks,\n+            }\n+          );\n+          pipeError(res);\n+        },\n       });\n-      pipe(res);\n     } catch (e) {\n       console.error(`Failed to SSR: ${e.stack}`);\n       res.statusCode = 500;"
            },
            {
                "file": "fixtures/flight/server/region.js",
                "git_diff": "@@ -103,13 +103,8 @@ app.get('/', async function (req, res) {\n });\n \n app.post('/', bodyParser.text(), async function (req, res) {\n-  const {\n-    renderToPipeableStream,\n-    decodeReply,\n-    decodeReplyFromBusboy,\n-    decodeAction,\n-    decodeFormState,\n-  } = await import('react-server-dom-webpack/server');\n+  const {decodeReply, decodeReplyFromBusboy, decodeAction, decodeFormState} =\n+    await import('react-server-dom-webpack/server');\n   const serverReference = req.get('rsc-action');\n   if (serverReference) {\n     // This is the client-side case"
            },
            {
                "file": "fixtures/flight/yarn.lock",
                "git_diff": "@@ -2689,18 +2689,25 @@\n     \"@nodelib/fs.scandir\" \"2.1.3\"\n     fastq \"^1.6.0\"\n \n-\"@pmmmwh/react-refresh-webpack-plugin@^0.5.3\":\n-  version \"0.5.11\"\n-  resolved \"https://registry.yarnpkg.com/@pmmmwh/react-refresh-webpack-plugin/-/react-refresh-webpack-plugin-0.5.11.tgz#7c2268cedaa0644d677e8c4f377bc8fb304f714a\"\n-  integrity sha512-7j/6vdTym0+qZ6u4XbSAxrWBGYSdCfTzySkj7WAFgDLmSyWlOrWvpyzxlFh5jtw9dn0oL/jtW+06XfFiisN3JQ==\n+\"@playwright/test@^1.41.2\":\n+  version \"1.41.2\"\n+  resolved \"https://registry.yarnpkg.com/@playwright/test/-/test-1.41.2.tgz#bd9db40177f8fd442e16e14e0389d23751cdfc54\"\n+  integrity sha512-qQB9h7KbibJzrDpkXkYvsmiDJK14FULCCZgEcoe2AvFAS64oCirWTwzTlAYEbKaRxWs5TFesE1Na6izMv3HfGg==\n+  dependencies:\n+    playwright \"1.41.2\"\n+\n+\"@pmmmwh/react-refresh-webpack-plugin@0.5.7\":\n+  version \"0.5.7\"\n+  resolved \"https://registry.yarnpkg.com/@pmmmwh/react-refresh-webpack-plugin/-/react-refresh-webpack-plugin-0.5.7.tgz#58f8217ba70069cc6a73f5d7e05e85b458c150e2\"\n+  integrity sha512-bcKCAzF0DV2IIROp9ZHkRJa6O4jy7NlnHdWL3GmcUxYWNjLXkK5kfELELwEfSP5hXPfVL/qOGMAROuMQb9GG8Q==\n   dependencies:\n     ansi-html-community \"^0.0.8\"\n     common-path-prefix \"^3.0.0\"\n-    core-js-pure \"^3.23.3\"\n+    core-js-pure \"^3.8.1\"\n     error-stack-parser \"^2.0.6\"\n     find-up \"^5.0.0\"\n     html-entities \"^2.1.0\"\n-    loader-utils \"^2.0.4\"\n+    loader-utils \"^2.0.0\"\n     schema-utils \"^3.0.0\"\n     source-map \"^0.7.3\"\n \n@@ -4050,10 +4057,10 @@ core-js-compat@^3.30.1, core-js-compat@^3.30.2:\n   dependencies:\n     browserslist \"^4.21.5\"\n \n-core-js-pure@^3.23.3:\n-  version \"3.32.1\"\n-  resolved \"https://registry.yarnpkg.com/core-js-pure/-/core-js-pure-3.32.1.tgz#5775b88f9062885f67b6d7edce59984e89d276f3\"\n-  integrity sha512-f52QZwkFVDPf7UEQZGHKx6NYxsxmVGJe5DIvbzOdRMJlmT6yv0KDjR8rmy3ngr/t5wU54c7Sp/qIJH0ppbhVpQ==\n+core-js-pure@^3.8.1:\n+  version \"3.36.0\"\n+  resolved \"https://registry.yarnpkg.com/core-js-pure/-/core-js-pure-3.36.0.tgz#ffb34330b14e594d6a9835cf5843b4123f1d95db\"\n+  integrity sha512-cN28qmhRNgbMZZMc/RFu5w8pK9VJzpb2rJVR/lHuZJKwmXnoWOpXmMkxqBB514igkp1Hu8WGROsiOAzUcKdHOQ==\n \n cosmiconfig@^6.0.0:\n   version \"6.0.0\"\n@@ -4885,7 +4892,7 @@ fs.realpath@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/fs.realpath/-/fs.realpath-1.0.0.tgz#1504ad2523158caa40db4a2787cb01411994ea4f\"\n \n-fsevents@^2.3.2, fsevents@~2.3.2:\n+fsevents@2.3.2, fsevents@^2.3.2, fsevents@~2.3.2:\n   version \"2.3.2\"\n   resolved \"https://registry.yarnpkg.com/fsevents/-/fsevents-2.3.2.tgz#8a526f78b8fdf4623b709e0b975c52c24c02fd1a\"\n   integrity sha512-xiqMQR4xAeHTuB9uWm+fFRcIOgKBMiOBP+eXiyT7jsgVCq1bkVygt00oASowB7EdtpOHaaPgKt812P9ab+DDKA==\n@@ -6024,7 +6031,7 @@ loader-runner@^4.2.0:\n   resolved \"https://registry.yarnpkg.com/loader-runner/-/loader-runner-4.3.0.tgz#c1b4a163b99f614830353b16755e7149ac2314e1\"\n   integrity sha512-3R/1M+yS3j5ou80Me59j7F9IMs4PXs3VqRrm0TU3AbKPxlmpoY1TNscJV/oGJXo8qCatFGTfDbY6W6ipGOYXfg==\n \n-loader-utils@^2.0.0, loader-utils@^2.0.4:\n+loader-utils@^2.0.0:\n   version \"2.0.4\"\n   resolved \"https://registry.yarnpkg.com/loader-utils/-/loader-utils-2.0.4.tgz#8b5cb38b5c34a9a018ee1fc0e6a066d1dfcc528c\"\n   integrity sha512-xXqpXoINfFhgua9xiqD8fPFHgkoq1mmmpE92WlDbm9rNRd/EbRb+Gqf908T2DMfuHjjJlksiK2RbHVOdD/MqSw==\n@@ -6644,6 +6651,20 @@ pkg-up@^3.1.0:\n   dependencies:\n     find-up \"^3.0.0\"\n \n+playwright-core@1.41.2:\n+  version \"1.41.2\"\n+  resolved \"https://registry.yarnpkg.com/playwright-core/-/playwright-core-1.41.2.tgz#db22372c708926c697acc261f0ef8406606802d9\"\n+  integrity sha512-VaTvwCA4Y8kxEe+kfm2+uUUw5Lubf38RxF7FpBxLPmGe5sdNkSg5e3ChEigaGrX7qdqT3pt2m/98LiyvU2x6CA==\n+\n+playwright@1.41.2:\n+  version \"1.41.2\"\n+  resolved \"https://registry.yarnpkg.com/playwright/-/playwright-1.41.2.tgz#4e760b1c79f33d9129a8c65cc27953be6dd35042\"\n+  integrity sha512-v0bOa6H2GJChDL8pAeLa/LZC4feoAMbSQm1/jF/ySsWWoaNItvrMP7GEkvEEFyCTUYKMxjQKaTSg5up7nR6/8A==\n+  dependencies:\n+    playwright-core \"1.41.2\"\n+  optionalDependencies:\n+    fsevents \"2.3.2\"\n+\n postcss-attribute-case-insensitive@^5.0.2:\n   version \"5.0.2\"\n   resolved \"https://registry.yarnpkg.com/postcss-attribute-case-insensitive/-/postcss-attribute-case-insensitive-5.0.2.tgz#03d761b24afc04c09e757e92ff53716ae8ea2741\""
            },
            {
                "file": "package.json",
                "git_diff": "@@ -14,7 +14,7 @@\n     \"@babel/plugin-proposal-object-rest-spread\": \"^7.11.0\",\n     \"@babel/plugin-syntax-dynamic-import\": \"^7.8.3\",\n     \"@babel/plugin-syntax-import-meta\": \"^7.10.4\",\n-    \"@babel/plugin-syntax-jsx\": \"^7.10.4\",\n+    \"@babel/plugin-syntax-jsx\": \"^7.23.3\",\n     \"@babel/plugin-syntax-typescript\": \"^7.14.5\",\n     \"@babel/plugin-transform-arrow-functions\": \"^7.10.4\",\n     \"@babel/plugin-transform-block-scoped-functions\": \"^7.10.4\",\n@@ -27,12 +27,14 @@\n     \"@babel/plugin-transform-modules-commonjs\": \"^7.10.4\",\n     \"@babel/plugin-transform-object-super\": \"^7.10.4\",\n     \"@babel/plugin-transform-parameters\": \"^7.10.5\",\n+    \"@babel/plugin-transform-react-jsx\": \"^7.23.4\",\n+    \"@babel/plugin-transform-react-jsx-development\": \"^7.22.5\",\n     \"@babel/plugin-transform-react-jsx-source\": \"^7.10.5\",\n     \"@babel/plugin-transform-shorthand-properties\": \"^7.10.4\",\n     \"@babel/plugin-transform-spread\": \"^7.11.0\",\n     \"@babel/plugin-transform-template-literals\": \"^7.10.5\",\n     \"@babel/preset-flow\": \"^7.10.4\",\n-    \"@babel/preset-react\": \"^7.10.4\",\n+    \"@babel/preset-react\": \"^7.23.3\",\n     \"@babel/traverse\": \"^7.11.0\",\n     \"@rollup/plugin-babel\": \"^6.0.3\",\n     \"@rollup/plugin-commonjs\": \"^24.0.1\",\n@@ -53,7 +55,6 @@\n     \"eslint-config-prettier\": \"^6.9.0\",\n     \"eslint-plugin-babel\": \"^5.3.0\",\n     \"eslint-plugin-eslint-plugin\": \"^3.5.3\",\n-    \"eslint-plugin-flowtype\": \"^2.25.0\",\n     \"eslint-plugin-ft-flow\": \"^2.0.3\",\n     \"eslint-plugin-jest\": \"^22.15.0\",\n     \"eslint-plugin-no-for-of-loops\": \"^1.0.0\",\n@@ -62,14 +63,14 @@\n     \"eslint-plugin-react-internal\": \"link:./scripts/eslint-rules\",\n     \"fbjs-scripts\": \"^3.0.1\",\n     \"filesize\": \"^6.0.1\",\n-    \"flow-bin\": \"^0.226.0\",\n-    \"flow-remove-types\": \"^2.226.0\",\n+    \"flow-bin\": \"^0.230.0\",\n+    \"flow-remove-types\": \"^2.230.0\",\n     \"glob\": \"^7.1.6\",\n     \"glob-stream\": \"^6.1.0\",\n     \"google-closure-compiler\": \"^20230206.0.0\",\n     \"gzip-size\": \"^5.1.1\",\n-    \"hermes-eslint\": \"^0.18.2\",\n-    \"hermes-parser\": \"^0.18.2\",\n+    \"hermes-eslint\": \"^0.20.1\",\n+    \"hermes-parser\": \"^0.20.1\",\n     \"jest\": \"^29.4.2\",\n     \"jest-cli\": \"^29.4.2\",\n     \"jest-diff\": \"^29.4.2\",\n@@ -80,6 +81,7 @@\n     \"mkdirp\": \"^0.5.1\",\n     \"ncp\": \"^2.0.0\",\n     \"prettier\": \"3.0.3\",\n+    \"prettier-2\": \"npm:prettier@^2\",\n     \"pretty-format\": \"^29.4.1\",\n     \"prop-types\": \"^15.6.2\",\n     \"random-seed\": \"^0.3.0\",\n@@ -130,7 +132,8 @@\n     \"download-build-for-head\": \"node ./scripts/release/download-experimental-build.js --commit=$(git rev-parse HEAD)\",\n     \"download-build-in-codesandbox-ci\": \"cd scripts/release && yarn install && cd ../../ && yarn download-build-for-head || yarn build --type=node react/index react-dom/index react-dom/src/server react-dom/test-utils scheduler/index react/jsx-runtime react/jsx-dev-runtime\",\n     \"check-release-dependencies\": \"node ./scripts/release/check-release-dependencies\",\n-    \"generate-inline-fizz-runtime\": \"node ./scripts/rollup/generate-inline-fizz-runtime.js\"\n+    \"generate-inline-fizz-runtime\": \"node ./scripts/rollup/generate-inline-fizz-runtime.js\",\n+    \"flags\": \"node ./scripts/flags/flags.js\"\n   },\n   \"resolutions\": {\n     \"react-is\": \"npm:react-is\""
            },
            {
                "file": "packages/eslint-plugin-react-hooks/__tests__/ESLintRuleExhaustiveDeps-test.js",
                "git_diff": "@@ -6747,7 +6747,7 @@ const tests = {\n             '  }\\n' +\n             '  fetchData();\\n' +\n             `}, [someId]); // Or [] if effect doesn't need props or state\\n\\n` +\n-            'Learn more about data fetching with Hooks: https://reactjs.org/link/hooks-data-fetching',\n+            'Learn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching',\n           suggestions: undefined,\n         },\n       ],\n@@ -6771,7 +6771,7 @@ const tests = {\n             '  }\\n' +\n             '  fetchData();\\n' +\n             `}, [someId]); // Or [] if effect doesn't need props or state\\n\\n` +\n-            'Learn more about data fetching with Hooks: https://reactjs.org/link/hooks-data-fetching',\n+            'Learn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching',\n           suggestions: undefined,\n         },\n       ],\n@@ -7747,6 +7747,33 @@ const testsTypescript = {\n         }\n       `,\n     },\n+    {\n+      code: normalizeIndent`\n+        function App(props) {\n+          React.useEffect(() => {\n+            console.log(props.test);\n+          }, [props.test] as const);\n+        }\n+      `,\n+    },\n+    {\n+      code: normalizeIndent`\n+        function App(props) {\n+          React.useEffect(() => {\n+            console.log(props.test);\n+          }, [props.test] as any);\n+        }\n+      `,\n+    },\n+    {\n+      code: normalizeIndent`\n+        function App(props) {\n+          React.useEffect((() => {\n+            console.log(props.test);\n+          }) as any, [props.test]);\n+        }\n+      `,\n+    },\n   ],\n   invalid: [\n     {"
            },
            {
                "file": "packages/eslint-plugin-react-hooks/__tests__/ESLintRulesOfHooks-test.js",
                "git_diff": "@@ -521,6 +521,39 @@ const tests = {\n         }\n       `,\n     },\n+    {\n+      code: normalizeIndent`\n+        export const notAComponent = () => {\n+           return () => {\n+            useState();\n+          }\n+        }\n+      `,\n+      // TODO: this should error but doesn't.\n+      // errors: [functionError('use', 'notAComponent')],\n+    },\n+    {\n+      code: normalizeIndent`\n+        export default () => {\n+          if (isVal) {\n+            useState(0);\n+          }\n+        }\n+      `,\n+      // TODO: this should error but doesn't.\n+      // errors: [genericError('useState')],\n+    },\n+    {\n+      code: normalizeIndent`\n+        function notAComponent() {\n+          return new Promise.then(() => {\n+            useState();\n+          });\n+        }\n+      `,\n+      // TODO: this should error but doesn't.\n+      // errors: [genericError('useState')],\n+    },\n   ],\n   invalid: [\n     {"
            },
            {
                "file": "packages/eslint-plugin-react-hooks/package.json",
                "git_diff": "@@ -26,7 +26,7 @@\n   \"engines\": {\n     \"node\": \">=10\"\n   },\n-  \"homepage\": \"https://reactjs.org/\",\n+  \"homepage\": \"https://react.dev/\",\n   \"peerDependencies\": {\n     \"eslint\": \"^3.0.0 || ^4.0.0 || ^5.0.0 || ^6.0.0 || ^7.0.0 || ^8.0.0-0\"\n   },"
            },
            {
                "file": "packages/eslint-plugin-react-hooks/src/ExhaustiveDeps.js",
                "git_diff": "@@ -111,7 +111,7 @@ export default {\n             '  }\\n' +\n             '  fetchData();\\n' +\n             `}, [someId]); // Or [] if effect doesn't need props or state\\n\\n` +\n-            'Learn more about data fetching with Hooks: https://reactjs.org/link/hooks-data-fetching',\n+            'Learn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching',\n         });\n       }\n \n@@ -618,7 +618,12 @@ export default {\n \n       const declaredDependencies = [];\n       const externalDependencies = new Set();\n-      if (declaredDependenciesNode.type !== 'ArrayExpression') {\n+      const isArrayExpression =\n+        declaredDependenciesNode.type === 'ArrayExpression';\n+      const isTSAsArrayExpression =\n+        declaredDependenciesNode.type === 'TSAsExpression' &&\n+        declaredDependenciesNode.expression.type === 'ArrayExpression';\n+      if (!isArrayExpression && !isTSAsArrayExpression) {\n         // If the declared dependencies are not an array expression then we\n         // can't verify that the user provided the correct dependencies. Tell\n         // the user this in an error.\n@@ -631,7 +636,11 @@ export default {\n             'dependencies.',\n         });\n       } else {\n-        declaredDependenciesNode.elements.forEach(declaredDependencyNode => {\n+        const arrayExpression = isTSAsArrayExpression\n+          ? declaredDependenciesNode.expression\n+          : declaredDependenciesNode;\n+\n+        arrayExpression.elements.forEach(declaredDependencyNode => {\n           // Skip elided elements.\n           if (declaredDependencyNode === null) {\n             return;\n@@ -1214,6 +1223,15 @@ export default {\n             isEffect,\n           );\n           return; // Handled\n+        case 'TSAsExpression':\n+          visitFunctionWithDependencies(\n+            callback.expression,\n+            declaredDependenciesNode,\n+            reactiveHook,\n+            reactiveHookName,\n+            isEffect,\n+          );\n+          return; // Handled\n         case 'Identifier':\n           if (!declaredDependenciesNode) {\n             // No deps, no problems."
            },
            {
                "file": "packages/internal-test-utils/ReactInternalTestUtils.js",
                "git_diff": "@@ -9,6 +9,7 @@ import * as SchedulerMock from 'scheduler/unstable_mock';\n import {diff} from 'jest-diff';\n import {equals} from '@jest/expect-utils';\n import enqueueTask from './enqueueTask';\n+import simulateBrowserEventDispatch from './simulateBrowserEventDispatch';\n \n export {act} from './internalAct';\n \n@@ -264,3 +265,40 @@ ${diff(expectedLog, actualLog)}\n   Error.captureStackTrace(error, assertLog);\n   throw error;\n }\n+\n+// Simulates dispatching events, waiting for microtasks in between.\n+// This matches the browser behavior, which will flush microtasks\n+// between each event handler. This will allow discrete events to\n+// flush between events across different event handlers.\n+export async function simulateEventDispatch(\n+  node: Node,\n+  eventType: string,\n+): Promise<void> {\n+  // Ensure the node is in the document.\n+  for (let current = node; current; current = current.parentNode) {\n+    if (current === document) {\n+      break;\n+    } else if (current.parentNode == null) {\n+      return;\n+    }\n+  }\n+\n+  const customEvent = new Event(eventType, {\n+    bubbles: true,\n+  });\n+\n+  Object.defineProperty(customEvent, 'target', {\n+    // Override the target to the node on which we dispatched the event.\n+    value: node,\n+  });\n+\n+  const impl = Object.getOwnPropertySymbols(node)[0];\n+  const oldDispatch = node[impl].dispatchEvent;\n+  try {\n+    node[impl].dispatchEvent = simulateBrowserEventDispatch;\n+\n+    await node.dispatchEvent(customEvent);\n+  } finally {\n+    node[impl].dispatchEvent = oldDispatch;\n+  }\n+}"
            },
            {
                "file": "packages/internal-test-utils/__tests__/ReactInternalTestUtilsDOM-test.js",
                "git_diff": "@@ -0,0 +1,566 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ *\n+ * @emails react-core\n+ */\n+\n+'use strict';\n+\n+let React;\n+let act;\n+let Scheduler;\n+let ReactDOMClient;\n+let simulateEventDispatch;\n+let assertLog;\n+\n+describe('ReactInternalTestUtilsDOM', () => {\n+  beforeEach(() => {\n+    jest.resetModules();\n+    act = require('internal-test-utils').act;\n+    simulateEventDispatch =\n+      require('internal-test-utils').simulateEventDispatch;\n+    Scheduler = require('scheduler/unstable_mock');\n+    ReactDOMClient = require('react-dom/client');\n+    React = require('react');\n+    assertLog = require('internal-test-utils').assertLog;\n+  });\n+\n+  describe('simulateEventDispatch', () => {\n+    it('should batch discrete capture events', async () => {\n+      let childRef;\n+      function Component() {\n+        const [state, setState] = React.useState(0);\n+        Scheduler.log(`Render ${state}`);\n+        return (\n+          <div\n+            onClickCapture={() => {\n+              queueMicrotask(() => {\n+                Scheduler.log('Parent microtask');\n+              });\n+              setState(1);\n+              Scheduler.log('onClickCapture parent');\n+            }}>\n+            <button\n+              ref={ref => (childRef = ref)}\n+              onClickCapture={() => {\n+                queueMicrotask(() => {\n+                  Scheduler.log('Child microtask');\n+                });\n+                setState(2);\n+                Scheduler.log('onClickCapture child');\n+              }}\n+            />\n+          </div>\n+        );\n+      }\n+\n+      const container = document.createElement('div');\n+      document.body.appendChild(container);\n+      const root = ReactDOMClient.createRoot(container);\n+      await act(() => {\n+        root.render(<Component />);\n+      });\n+\n+      assertLog(['Render 0']);\n+\n+      await act(async () => {\n+        await simulateEventDispatch(childRef, 'click');\n+      });\n+\n+      // Capture runs on every event we dispatch,\n+      // which means we get two for the parent, and one for the child.\n+      assertLog([\n+        'onClickCapture parent',\n+        'onClickCapture child',\n+        'Parent microtask',\n+        'Render 2',\n+        'Child microtask',\n+      ]);\n+\n+      document.body.removeChild(container);\n+    });\n+\n+    it('should batch continuous capture events', async () => {\n+      let childRef;\n+      function Component() {\n+        const [state, setState] = React.useState(0);\n+        Scheduler.log(`Render ${state}`);\n+        return (\n+          <div\n+            onMouseOutCapture={() => {\n+              queueMicrotask(() => {\n+                Scheduler.log('Parent microtask');\n+              });\n+              setState(1);\n+              Scheduler.log('onMouseOutCapture parent');\n+            }}>\n+            <button\n+              ref={ref => (childRef = ref)}\n+              onMouseOutCapture={() => {\n+                queueMicrotask(() => {\n+                  Scheduler.log('Child microtask');\n+                });\n+                setState(2);\n+                Scheduler.log('onMouseOutCapture child');\n+              }}\n+            />\n+          </div>\n+        );\n+      }\n+\n+      const container = document.createElement('div');\n+      document.body.appendChild(container);\n+      const root = ReactDOMClient.createRoot(container);\n+      await act(() => {\n+        root.render(<Component />);\n+      });\n+\n+      assertLog(['Render 0']);\n+\n+      await act(async () => {\n+        await simulateEventDispatch(childRef, 'mouseout');\n+      });\n+\n+      assertLog([\n+        'onMouseOutCapture parent',\n+        'onMouseOutCapture child',\n+        'Parent microtask',\n+        'Child microtask',\n+        'Render 2',\n+      ]);\n+    });\n+\n+    it('should batch bubbling discrete events', async () => {\n+      let childRef;\n+      function Component() {\n+        const [state, setState] = React.useState(0);\n+        Scheduler.log(`Render ${state}`);\n+        return (\n+          <div\n+            onClick={() => {\n+              queueMicrotask(() => {\n+                Scheduler.log('Parent microtask');\n+              });\n+              setState(1);\n+              Scheduler.log('onClick parent');\n+            }}>\n+            <button\n+              ref={ref => (childRef = ref)}\n+              onClick={() => {\n+                queueMicrotask(() => {\n+                  Scheduler.log('Child microtask');\n+                });\n+                setState(2);\n+                Scheduler.log('onClick child');\n+              }}\n+            />\n+          </div>\n+        );\n+      }\n+\n+      const container = document.createElement('div');\n+      document.body.appendChild(container);\n+      const root = ReactDOMClient.createRoot(container);\n+      await act(() => {\n+        root.render(<Component />);\n+      });\n+\n+      assertLog(['Render 0']);\n+\n+      await act(async () => {\n+        await simulateEventDispatch(childRef, 'click');\n+      });\n+\n+      assertLog([\n+        'onClick child',\n+        'onClick parent',\n+        'Child microtask',\n+        'Render 1',\n+        'Parent microtask',\n+      ]);\n+    });\n+\n+    it('should batch bubbling continuous events', async () => {\n+      let childRef;\n+      function Component() {\n+        const [state, setState] = React.useState(0);\n+        Scheduler.log(`Render ${state}`);\n+        return (\n+          <div\n+            onMouseOut={() => {\n+              queueMicrotask(() => {\n+                Scheduler.log('Parent microtask');\n+              });\n+              setState(1);\n+              Scheduler.log('onMouseOut parent');\n+            }}>\n+            <button\n+              ref={ref => (childRef = ref)}\n+              onMouseOut={() => {\n+                queueMicrotask(() => {\n+                  Scheduler.log('Child microtask');\n+                });\n+                setState(2);\n+                Scheduler.log('onMouseOut child');\n+              }}\n+            />\n+          </div>\n+        );\n+      }\n+\n+      const container = document.createElement('div');\n+      document.body.appendChild(container);\n+      const root = ReactDOMClient.createRoot(container);\n+      await act(() => {\n+        root.render(<Component />);\n+      });\n+\n+      assertLog(['Render 0']);\n+\n+      await act(async () => {\n+        await simulateEventDispatch(childRef, 'mouseout');\n+      });\n+\n+      assertLog([\n+        'onMouseOut child',\n+        'onMouseOut parent',\n+        'Child microtask',\n+        'Parent microtask',\n+        'Render 1',\n+      ]);\n+    });\n+\n+    it('does not batch discrete events between handlers', async () => {\n+      let childRef = React.createRef();\n+      function Component() {\n+        const [state, setState] = React.useState(0);\n+        const parentRef = React.useRef();\n+        React.useEffect(() => {\n+          function handleParentEvent() {\n+            queueMicrotask(() => {\n+              Scheduler.log('Parent microtask');\n+            });\n+            setState(2);\n+            Scheduler.log(`Click parent`);\n+          }\n+\n+          function handleChildEvent() {\n+            queueMicrotask(() => {\n+              Scheduler.log('Child microtask');\n+            });\n+            setState(1);\n+            Scheduler.log(`Click child`);\n+          }\n+          parentRef.current.addEventListener('click', handleParentEvent);\n+\n+          childRef.current.addEventListener('click', handleChildEvent);\n+\n+          return () => {\n+            parentRef.current.removeEventListener('click', handleParentEvent);\n+\n+            childRef.current.removeEventListener('click', handleChildEvent);\n+          };\n+        });\n+\n+        Scheduler.log(`Render ${state}`);\n+        return (\n+          <div ref={parentRef}>\n+            <button ref={childRef} />\n+          </div>\n+        );\n+      }\n+\n+      const container = document.createElement('div');\n+      document.body.appendChild(container);\n+      const root = ReactDOMClient.createRoot(container);\n+      await act(() => {\n+        root.render(<Component />);\n+      });\n+\n+      assertLog(['Render 0']);\n+\n+      await act(async () => {\n+        await simulateEventDispatch(childRef.current, 'click');\n+      });\n+\n+      assertLog([\n+        'Click child',\n+        'Child microtask',\n+        'Render 1',\n+        'Click parent',\n+        'Parent microtask',\n+        'Render 2',\n+      ]);\n+    });\n+\n+    it('should batch continuous events between handlers', async () => {\n+      let childRef = React.createRef();\n+      function Component() {\n+        const [state, setState] = React.useState(0);\n+        const parentRef = React.useRef();\n+        React.useEffect(() => {\n+          function handleChildEvent() {\n+            queueMicrotask(() => {\n+              Scheduler.log('Child microtask');\n+            });\n+            setState(1);\n+            Scheduler.log(`Mouseout child`);\n+          }\n+          function handleParentEvent() {\n+            queueMicrotask(() => {\n+              Scheduler.log('Parent microtask');\n+            });\n+            setState(2);\n+            Scheduler.log(`Mouseout parent`);\n+          }\n+          parentRef.current.addEventListener('mouseout', handleParentEvent);\n+\n+          childRef.current.addEventListener('mouseout', handleChildEvent);\n+\n+          return () => {\n+            parentRef.current.removeEventListener(\n+              'mouseout',\n+              handleParentEvent\n+            );\n+\n+            childRef.current.removeEventListener('mouseout', handleChildEvent);\n+          };\n+        });\n+\n+        Scheduler.log(`Render ${state}`);\n+        return (\n+          <div ref={parentRef}>\n+            <button ref={childRef} />\n+          </div>\n+        );\n+      }\n+\n+      const container = document.createElement('div');\n+      document.body.appendChild(container);\n+      const root = ReactDOMClient.createRoot(container);\n+      await act(() => {\n+        root.render(<Component />);\n+      });\n+\n+      assertLog(['Render 0']);\n+\n+      await act(async () => {\n+        await simulateEventDispatch(childRef.current, 'mouseout');\n+      });\n+\n+      assertLog([\n+        'Mouseout child',\n+        'Child microtask',\n+        'Mouseout parent',\n+        'Parent microtask',\n+        'Render 2',\n+      ]);\n+    });\n+\n+    it('should flush discrete events between handlers from different roots', async () => {\n+      const childContainer = document.createElement('div');\n+      const parentContainer = document.createElement('main');\n+\n+      const childRoot = ReactDOMClient.createRoot(childContainer);\n+      const parentRoot = ReactDOMClient.createRoot(parentContainer);\n+      let childSetState;\n+\n+      function Parent() {\n+        // eslint-disable-next-line no-unused-vars\n+        const [state, _] = React.useState('Parent');\n+        const handleClick = () => {\n+          Promise.resolve().then(() => Scheduler.log('Flush Parent microtask'));\n+          childSetState(2);\n+          Scheduler.log('Parent click');\n+        };\n+        return <section onClick={handleClick}>{state}</section>;\n+      }\n+\n+      function Child() {\n+        const [state, setState] = React.useState('Child');\n+        childSetState = setState;\n+        const handleClick = () => {\n+          Promise.resolve().then(() => Scheduler.log('Flush Child microtask'));\n+          setState(1);\n+          Scheduler.log('Child click');\n+        };\n+        Scheduler.log('Render ' + state);\n+        return <span onClick={handleClick}>{state}</span>;\n+      }\n+\n+      await act(() => {\n+        childRoot.render(<Child />);\n+        parentRoot.render(<Parent />);\n+      });\n+\n+      const childNode = childContainer.firstChild;\n+      const parentNode = parentContainer.firstChild;\n+\n+      parentNode.appendChild(childContainer);\n+      document.body.appendChild(parentContainer);\n+\n+      assertLog(['Render Child']);\n+      try {\n+        await act(async () => {\n+          await simulateEventDispatch(childNode, 'click');\n+        });\n+\n+        // Since discrete events flush in a microtasks, they flush before\n+        // the handler for the other root is called, after the microtask\n+        // scheduled in the event fires.\n+        assertLog([\n+          'Child click',\n+          'Flush Child microtask',\n+          'Render 1',\n+          'Parent click',\n+          'Flush Parent microtask',\n+          'Render 2',\n+        ]);\n+      } finally {\n+        document.body.removeChild(parentContainer);\n+      }\n+    });\n+\n+    it('should batch continuous events between handlers from different roots', async () => {\n+      const childContainer = document.createElement('div');\n+      const parentContainer = document.createElement('main');\n+\n+      const childRoot = ReactDOMClient.createRoot(childContainer);\n+      const parentRoot = ReactDOMClient.createRoot(parentContainer);\n+      let childSetState;\n+\n+      function Parent() {\n+        // eslint-disable-next-line no-unused-vars\n+        const [state, _] = React.useState('Parent');\n+        const handleMouseOut = () => {\n+          Promise.resolve().then(() => Scheduler.log('Flush Parent microtask'));\n+          childSetState(2);\n+          Scheduler.log('Parent mouseout');\n+        };\n+        return <section onMouseOut={handleMouseOut}>{state}</section>;\n+      }\n+\n+      function Child() {\n+        const [state, setState] = React.useState('Child');\n+        childSetState = setState;\n+        const handleMouseOut = () => {\n+          Promise.resolve().then(() => Scheduler.log('Flush Child microtask'));\n+          setState(1);\n+          Scheduler.log('Child mouseout');\n+        };\n+        Scheduler.log('Render ' + state);\n+        return <span onMouseOut={handleMouseOut}>{state}</span>;\n+      }\n+\n+      await act(() => {\n+        childRoot.render(<Child />);\n+        parentRoot.render(<Parent />);\n+      });\n+\n+      const childNode = childContainer.firstChild;\n+      const parentNode = parentContainer.firstChild;\n+\n+      parentNode.appendChild(childContainer);\n+      document.body.appendChild(parentContainer);\n+\n+      assertLog(['Render Child']);\n+      try {\n+        await act(async () => {\n+          await simulateEventDispatch(childNode, 'mouseout');\n+        });\n+\n+        // Since continuous events flush in a macrotask, they are batched after\n+        // with the handler for the other root, but the microtasks scheduled\n+        // in the event handlers still fire in between.\n+        assertLog([\n+          'Child mouseout',\n+          'Flush Child microtask',\n+          'Parent mouseout',\n+          'Flush Parent microtask',\n+          'Render 2',\n+        ]);\n+      } finally {\n+        document.body.removeChild(parentContainer);\n+      }\n+    });\n+\n+    it('should fire on nodes removed while dispatching', async () => {\n+      let childRef;\n+      function Component() {\n+        const parentRef = React.useRef();\n+        const middleRef = React.useRef();\n+        Scheduler.log(`Render`);\n+        return (\n+          <div\n+            ref={parentRef}\n+            onClick={() => {\n+              Scheduler.log('onMouseOut parent');\n+            }}>\n+            <div ref={middleRef}>\n+              <button\n+                ref={ref => (childRef = ref)}\n+                onClick={() => {\n+                  Scheduler.log('onMouseOut child');\n+                  childRef.parentNode.remove();\n+                }}\n+              />\n+            </div>\n+          </div>\n+        );\n+      }\n+\n+      const container = document.createElement('div');\n+      document.body.appendChild(container);\n+      const root = ReactDOMClient.createRoot(container);\n+      await act(() => {\n+        root.render(<Component />);\n+      });\n+\n+      assertLog(['Render']);\n+\n+      await act(async () => {\n+        await simulateEventDispatch(childRef, 'click');\n+      });\n+\n+      assertLog(['onMouseOut child', 'onMouseOut parent']);\n+    });\n+\n+    it('should not fire if node is not in the document', async () => {\n+      let childRef;\n+      function Component() {\n+        Scheduler.log(`Render`);\n+        return (\n+          <div\n+            onMouseOut={() => {\n+              Scheduler.log('onMouseOut parent');\n+            }}>\n+            <button\n+              ref={ref => (childRef = ref)}\n+              onMouseOut={() => {\n+                Scheduler.log('onMouseOut child');\n+              }}\n+            />\n+          </div>\n+        );\n+      }\n+\n+      // Do not attach root to document.\n+      const root = ReactDOMClient.createRoot(document.createElement('div'));\n+      await act(() => {\n+        root.render(<Component />);\n+      });\n+\n+      assertLog(['Render']);\n+\n+      await act(async () => {\n+        await simulateEventDispatch(childRef, 'mouseout');\n+      });\n+\n+      // No events flushed, root not in document.\n+      assertLog([]);\n+    });\n+  });\n+});"
            },
            {
                "file": "packages/internal-test-utils/simulateBrowserEventDispatch.js",
                "git_diff": "@@ -0,0 +1,391 @@\n+const DOMException = require('domexception/webidl2js-wrapper');\n+const {nodeRoot} = require('jsdom/lib/jsdom/living/helpers/node');\n+const reportException = require('jsdom/lib/jsdom/living/helpers/runtime-script-errors');\n+const {\n+  isNode,\n+  isShadowRoot,\n+  isSlotable,\n+  getEventTargetParent,\n+  isShadowInclusiveAncestor,\n+  retarget,\n+} = require('jsdom/lib/jsdom/living/helpers/shadow-dom');\n+\n+const {waitForMicrotasks} = require('./ReactInternalTestUtils');\n+\n+const EVENT_PHASE = {\n+  NONE: 0,\n+  CAPTURING_PHASE: 1,\n+  AT_TARGET: 2,\n+  BUBBLING_PHASE: 3,\n+};\n+\n+// Hack to get Symbol(wrapper) for target nodes.\n+let wrapperSymbol;\n+function wrapperForImpl(impl) {\n+  if (impl == null) {\n+    return null;\n+  }\n+\n+  return impl[wrapperSymbol];\n+}\n+\n+// This is a forked implementation of the jsdom dispatchEvent. The goal of\n+// this fork is to match the actual browser behavior of user events more closely.\n+// Real browser events yield to microtasks in-between event handlers, which is\n+// different from programmatically calling dispatchEvent (which does not yield).\n+// JSDOM correctly implements programmatic dispatchEvent, but sometimes we need\n+// to test the behavior of real user interactions, so we simulate it.\n+//\n+// It's async because we need to wait for microtasks between event handlers.\n+//\n+// Taken from:\n+// https://github.com/jsdom/jsdom/blob/2f8a7302a43fff92f244d5f3426367a8eb2b8896/lib/jsdom/living/events/EventTarget-impl.js#L88\n+async function simulateEventDispatch(eventImpl) {\n+  if (eventImpl._dispatchFlag || !eventImpl._initializedFlag) {\n+    throw DOMException.create(this._globalObject, [\n+      'Tried to dispatch an uninitialized event',\n+      'InvalidStateError',\n+    ]);\n+  }\n+  if (eventImpl.eventPhase !== EVENT_PHASE.NONE) {\n+    throw DOMException.create(this._globalObject, [\n+      'Tried to dispatch a dispatching event',\n+      'InvalidStateError',\n+    ]);\n+  }\n+\n+  eventImpl.isTrusted = false;\n+\n+  await _dispatch.call(this, eventImpl);\n+}\n+\n+async function _dispatch(eventImpl, legacyTargetOverrideFlag) {\n+  // Hack: save the wrapper Symbol.\n+  wrapperSymbol = Object.getOwnPropertySymbols(eventImpl)[0];\n+\n+  let targetImpl = this;\n+  let clearTargets = false;\n+  let activationTarget = null;\n+\n+  eventImpl._dispatchFlag = true;\n+\n+  const targetOverride = legacyTargetOverrideFlag\n+    ? wrapperForImpl(targetImpl._globalObject._document)\n+    : targetImpl;\n+  let relatedTarget = retarget(eventImpl.relatedTarget, targetImpl);\n+\n+  if (targetImpl !== relatedTarget || targetImpl === eventImpl.relatedTarget) {\n+    const touchTargets = [];\n+\n+    appendToEventPath(\n+      eventImpl,\n+      targetImpl,\n+      targetOverride,\n+      relatedTarget,\n+      touchTargets,\n+      false,\n+    );\n+\n+    const isActivationEvent = false; // TODO Not ported in fork.\n+\n+    if (isActivationEvent && targetImpl._hasActivationBehavior) {\n+      activationTarget = targetImpl;\n+    }\n+\n+    let slotInClosedTree = false;\n+    let slotable =\n+      isSlotable(targetImpl) && targetImpl._assignedSlot ? targetImpl : null;\n+    let parent = getEventTargetParent(targetImpl, eventImpl);\n+\n+    // Populate event path\n+    // https://dom.spec.whatwg.org/#event-path\n+    while (parent !== null) {\n+      if (slotable !== null) {\n+        if (parent.localName !== 'slot') {\n+          throw new Error(`JSDOM Internal Error: Expected parent to be a Slot`);\n+        }\n+\n+        slotable = null;\n+\n+        const parentRoot = nodeRoot(parent);\n+        if (isShadowRoot(parentRoot) && parentRoot.mode === 'closed') {\n+          slotInClosedTree = true;\n+        }\n+      }\n+\n+      if (isSlotable(parent) && parent._assignedSlot) {\n+        slotable = parent;\n+      }\n+\n+      relatedTarget = retarget(eventImpl.relatedTarget, parent);\n+\n+      if (\n+        (isNode(parent) &&\n+          isShadowInclusiveAncestor(nodeRoot(targetImpl), parent)) ||\n+        wrapperForImpl(parent).constructor.name === 'Window'\n+      ) {\n+        if (\n+          isActivationEvent &&\n+          eventImpl.bubbles &&\n+          activationTarget === null &&\n+          parent._hasActivationBehavior\n+        ) {\n+          activationTarget = parent;\n+        }\n+\n+        appendToEventPath(\n+          eventImpl,\n+          parent,\n+          null,\n+          relatedTarget,\n+          touchTargets,\n+          slotInClosedTree,\n+        );\n+      } else if (parent === relatedTarget) {\n+        parent = null;\n+      } else {\n+        targetImpl = parent;\n+\n+        if (\n+          isActivationEvent &&\n+          activationTarget === null &&\n+          targetImpl._hasActivationBehavior\n+        ) {\n+          activationTarget = targetImpl;\n+        }\n+\n+        appendToEventPath(\n+          eventImpl,\n+          parent,\n+          targetImpl,\n+          relatedTarget,\n+          touchTargets,\n+          slotInClosedTree,\n+        );\n+      }\n+\n+      if (parent !== null) {\n+        parent = getEventTargetParent(parent, eventImpl);\n+      }\n+\n+      slotInClosedTree = false;\n+    }\n+\n+    let clearTargetsStructIndex = -1;\n+    for (\n+      let i = eventImpl._path.length - 1;\n+      i >= 0 && clearTargetsStructIndex === -1;\n+      i--\n+    ) {\n+      if (eventImpl._path[i].target !== null) {\n+        clearTargetsStructIndex = i;\n+      }\n+    }\n+    const clearTargetsStruct = eventImpl._path[clearTargetsStructIndex];\n+\n+    clearTargets =\n+      (isNode(clearTargetsStruct.target) &&\n+        isShadowRoot(nodeRoot(clearTargetsStruct.target))) ||\n+      (isNode(clearTargetsStruct.relatedTarget) &&\n+        isShadowRoot(nodeRoot(clearTargetsStruct.relatedTarget)));\n+\n+    if (\n+      activationTarget !== null &&\n+      activationTarget._legacyPreActivationBehavior\n+    ) {\n+      activationTarget._legacyPreActivationBehavior();\n+    }\n+\n+    for (let i = eventImpl._path.length - 1; i >= 0; --i) {\n+      const struct = eventImpl._path[i];\n+\n+      if (struct.target !== null) {\n+        eventImpl.eventPhase = EVENT_PHASE.AT_TARGET;\n+      } else {\n+        eventImpl.eventPhase = EVENT_PHASE.CAPTURING_PHASE;\n+      }\n+\n+      await invokeEventListeners(struct, eventImpl, 'capturing');\n+    }\n+\n+    for (let i = 0; i < eventImpl._path.length; i++) {\n+      const struct = eventImpl._path[i];\n+\n+      if (struct.target !== null) {\n+        eventImpl.eventPhase = EVENT_PHASE.AT_TARGET;\n+      } else {\n+        if (!eventImpl.bubbles) {\n+          continue;\n+        }\n+\n+        eventImpl.eventPhase = EVENT_PHASE.BUBBLING_PHASE;\n+      }\n+\n+      await invokeEventListeners(struct, eventImpl, 'bubbling');\n+    }\n+  }\n+\n+  eventImpl.eventPhase = EVENT_PHASE.NONE;\n+\n+  eventImpl.currentTarget = null;\n+  eventImpl._path = [];\n+  eventImpl._dispatchFlag = false;\n+  eventImpl._stopPropagationFlag = false;\n+  eventImpl._stopImmediatePropagationFlag = false;\n+\n+  if (clearTargets) {\n+    eventImpl.target = null;\n+    eventImpl.relatedTarget = null;\n+  }\n+\n+  if (activationTarget !== null) {\n+    if (!eventImpl._canceledFlag) {\n+      activationTarget._activationBehavior(eventImpl);\n+    } else if (activationTarget._legacyCanceledActivationBehavior) {\n+      activationTarget._legacyCanceledActivationBehavior();\n+    }\n+  }\n+\n+  return !eventImpl._canceledFlag;\n+}\n+\n+async function invokeEventListeners(struct, eventImpl, phase) {\n+  const structIndex = eventImpl._path.indexOf(struct);\n+  for (let i = structIndex; i >= 0; i--) {\n+    const t = eventImpl._path[i];\n+    if (t.target) {\n+      eventImpl.target = t.target;\n+      break;\n+    }\n+  }\n+\n+  eventImpl.relatedTarget = wrapperForImpl(struct.relatedTarget);\n+\n+  if (eventImpl._stopPropagationFlag) {\n+    return;\n+  }\n+\n+  eventImpl.currentTarget = wrapperForImpl(struct.item);\n+\n+  const listeners = struct.item._eventListeners;\n+  await innerInvokeEventListeners(\n+    eventImpl,\n+    listeners,\n+    phase,\n+    struct.itemInShadowTree,\n+  );\n+}\n+\n+async function innerInvokeEventListeners(\n+  eventImpl,\n+  listeners,\n+  phase,\n+  itemInShadowTree,\n+) {\n+  let found = false;\n+\n+  const {type, target} = eventImpl;\n+  const wrapper = wrapperForImpl(target);\n+\n+  if (!listeners || !listeners[type]) {\n+    return found;\n+  }\n+\n+  // Copy event listeners before iterating since the list can be modified during the iteration.\n+  const handlers = listeners[type].slice();\n+\n+  for (let i = 0; i < handlers.length; i++) {\n+    const listener = handlers[i];\n+    const {capture, once, passive} = listener.options;\n+\n+    // Check if the event listener has been removed since the listeners has been cloned.\n+    if (!listeners[type].includes(listener)) {\n+      continue;\n+    }\n+\n+    found = true;\n+\n+    if (\n+      (phase === 'capturing' && !capture) ||\n+      (phase === 'bubbling' && capture)\n+    ) {\n+      continue;\n+    }\n+\n+    if (once) {\n+      listeners[type].splice(listeners[type].indexOf(listener), 1);\n+    }\n+\n+    let window = null;\n+    if (wrapper && wrapper._document) {\n+      // Triggered by Window\n+      window = wrapper;\n+    } else if (target._ownerDocument) {\n+      // Triggered by most webidl2js'ed instances\n+      window = target._ownerDocument._defaultView;\n+    } else if (wrapper._ownerDocument) {\n+      // Currently triggered by some non-webidl2js things\n+      window = wrapper._ownerDocument._defaultView;\n+    }\n+\n+    let currentEvent;\n+    if (window) {\n+      currentEvent = window._currentEvent;\n+      if (!itemInShadowTree) {\n+        window._currentEvent = eventImpl;\n+      }\n+    }\n+\n+    if (passive) {\n+      eventImpl._inPassiveListenerFlag = true;\n+    }\n+\n+    try {\n+      listener.callback.call(eventImpl.currentTarget, eventImpl);\n+    } catch (e) {\n+      if (window) {\n+        reportException(window, e);\n+      }\n+      // Errors in window-less documents just get swallowed... can you think of anything better?\n+    }\n+\n+    eventImpl._inPassiveListenerFlag = false;\n+\n+    if (window) {\n+      window._currentEvent = currentEvent;\n+    }\n+\n+    if (eventImpl._stopImmediatePropagationFlag) {\n+      return found;\n+    }\n+\n+    // IMPORTANT: Flush microtasks\n+    await waitForMicrotasks();\n+  }\n+\n+  return found;\n+}\n+\n+function appendToEventPath(\n+  eventImpl,\n+  target,\n+  targetOverride,\n+  relatedTarget,\n+  touchTargets,\n+  slotInClosedTree,\n+) {\n+  const itemInShadowTree = isNode(target) && isShadowRoot(nodeRoot(target));\n+  const rootOfClosedTree = isShadowRoot(target) && target.mode === 'closed';\n+\n+  eventImpl._path.push({\n+    item: target,\n+    itemInShadowTree,\n+    target: targetOverride,\n+    relatedTarget,\n+    touchTargets,\n+    rootOfClosedTree,\n+    slotInClosedTree,\n+  });\n+}\n+\n+export default simulateEventDispatch;"
            },
            {
                "file": "packages/jest-react/package.json",
                "git_diff": "@@ -17,7 +17,7 @@\n   \"bugs\": {\n     \"url\": \"https://github.com/facebook/react/issues\"\n   },\n-  \"homepage\": \"https://reactjs.org/\",\n+  \"homepage\": \"https://react.dev/\",\n   \"peerDependencies\": {\n     \"jest\": \"^23.0.1 || ^24.0.0 || ^25.1.0 || ^26.0.0 || ^27.0.0 || ^28.0.0 || ^29.0.0\",\n     \"react\": \"^18.2.0\","
            },
            {
                "file": "packages/jest-react/src/JestReact.js",
                "git_diff": "@@ -6,6 +6,7 @@\n  */\n \n import {REACT_ELEMENT_TYPE, REACT_FRAGMENT_TYPE} from 'shared/ReactSymbols';\n+import {enableRefAsProp} from 'shared/ReactFeatureFlags';\n \n import isArray from 'shared/isArray';\n \n@@ -38,6 +39,34 @@ function assertYieldsWereCleared(root) {\n   }\n }\n \n+function createJSXElementForTestComparison(type, props) {\n+  if (__DEV__ && enableRefAsProp) {\n+    const element = {\n+      $$typeof: REACT_ELEMENT_TYPE,\n+      type: type,\n+      key: null,\n+      props: props,\n+      _owner: null,\n+      _store: __DEV__ ? {} : undefined,\n+    };\n+    Object.defineProperty(element, 'ref', {\n+      enumerable: false,\n+      value: null,\n+    });\n+    return element;\n+  } else {\n+    return {\n+      $$typeof: REACT_ELEMENT_TYPE,\n+      type: type,\n+      key: null,\n+      ref: null,\n+      props: props,\n+      _owner: null,\n+      _store: __DEV__ ? {} : undefined,\n+    };\n+  }\n+}\n+\n export function unstable_toMatchRenderedOutput(root, expectedJSX) {\n   assertYieldsWereCleared(root);\n   const actualJSON = root.toJSON();\n@@ -55,17 +84,9 @@ export function unstable_toMatchRenderedOutput(root, expectedJSX) {\n       if (actualJSXChildren === null || typeof actualJSXChildren === 'string') {\n         actualJSX = actualJSXChildren;\n       } else {\n-        actualJSX = {\n-          $$typeof: REACT_ELEMENT_TYPE,\n-          type: REACT_FRAGMENT_TYPE,\n-          key: null,\n-          ref: null,\n-          props: {\n-            children: actualJSXChildren,\n-          },\n-          _owner: null,\n-          _store: __DEV__ ? {} : undefined,\n-        };\n+        actualJSX = createJSXElementForTestComparison(REACT_FRAGMENT_TYPE, {\n+          children: actualJSXChildren,\n+        });\n       }\n     }\n   } else {\n@@ -82,18 +103,12 @@ function jsonChildToJSXChild(jsonChild) {\n     return jsonChild;\n   } else {\n     const jsxChildren = jsonChildrenToJSXChildren(jsonChild.children);\n-    return {\n-      $$typeof: REACT_ELEMENT_TYPE,\n-      type: jsonChild.type,\n-      key: null,\n-      ref: null,\n-      props:\n-        jsxChildren === null\n-          ? jsonChild.props\n-          : {...jsonChild.props, children: jsxChildren},\n-      _owner: null,\n-      _store: __DEV__ ? {} : undefined,\n-    };\n+    return createJSXElementForTestComparison(\n+      jsonChild.type,\n+      jsxChildren === null\n+        ? jsonChild.props\n+        : {...jsonChild.props, children: jsxChildren},\n+    );\n   }\n }\n "
            },
            {
                "file": "packages/react-art/npm/Circle.js",
                "git_diff": "@@ -18,7 +18,6 @@\n 'use strict';\n \n var assign = Object.assign;\n-var PropTypes = require('prop-types');\n var React = require('react');\n var ReactART = require('react-art');\n \n@@ -34,10 +33,6 @@ var Shape = ReactART.Shape;\n var Circle = createReactClass({\n   displayName: 'Circle',\n \n-  propTypes: {\n-    radius: PropTypes.number.isRequired,\n-  },\n-\n   render: function render() {\n     var radius = this.props.radius;\n "
            },
            {
                "file": "packages/react-art/npm/Rectangle.js",
                "git_diff": "@@ -25,7 +25,6 @@\n 'use strict';\n \n var assign = Object.assign;\n-var PropTypes = require('prop-types');\n var React = require('react');\n var ReactART = require('react-art');\n \n@@ -41,16 +40,6 @@ var Path = ReactART.Path;\n var Rectangle = createReactClass({\n   displayName: 'Rectangle',\n \n-  propTypes: {\n-    width: PropTypes.number.isRequired,\n-    height: PropTypes.number.isRequired,\n-    radius: PropTypes.number,\n-    radiusTopLeft: PropTypes.number,\n-    radiusTopRight: PropTypes.number,\n-    radiusBottomRight: PropTypes.number,\n-    radiusBottomLeft: PropTypes.number,\n-  },\n-\n   render: function render() {\n     var width = this.props.width;\n     var height = this.props.height;"
            },
            {
                "file": "packages/react-art/npm/Wedge.js",
                "git_diff": "@@ -21,7 +21,6 @@\n 'use strict';\n \n var assign = Object.assign;\n-var PropTypes = require('prop-types');\n var React = require('react');\n var ReactART = require('react-art');\n \n@@ -37,13 +36,6 @@ var Path = ReactART.Path;\n var Wedge = createReactClass({\n   displayName: 'Wedge',\n \n-  propTypes: {\n-    outerRadius: PropTypes.number.isRequired,\n-    startAngle: PropTypes.number.isRequired,\n-    endAngle: PropTypes.number.isRequired,\n-    innerRadius: PropTypes.number,\n-  },\n-\n   circleRadians: Math.PI * 2,\n \n   radiansPerDegree: Math.PI / 180,"
            },
            {
                "file": "packages/react-art/package.json",
                "git_diff": "@@ -20,11 +20,10 @@\n   \"bugs\": {\n     \"url\": \"https://github.com/facebook/react/issues\"\n   },\n-  \"homepage\": \"https://reactjs.org/\",\n+  \"homepage\": \"https://react.dev/\",\n   \"dependencies\": {\n     \"art\": \"^0.10.1\",\n     \"create-react-class\": \"^15.6.2\",\n-    \"loose-envify\": \"^1.1.0\",\n     \"scheduler\": \"^0.23.0\"\n   },\n   \"peerDependencies\": {\n@@ -39,10 +38,5 @@\n     \"Circle.js\",\n     \"Rectangle.js\",\n     \"Wedge.js\"\n-  ],\n-  \"browserify\": {\n-    \"transform\": [\n-      \"loose-envify\"\n-    ]\n-  }\n+  ]\n }"
            },
            {
                "file": "packages/react-art/src/__tests__/ReactART-test.js",
                "git_diff": "@@ -24,8 +24,9 @@ import Wedge from 'react-art/Wedge';\n \n // Isolate DOM renderer.\n jest.resetModules();\n-const ReactDOM = require('react-dom');\n-const ReactTestUtils = require('react-dom/test-utils');\n+\n+const ReactDOMClient = require('react-dom/client');\n+const act = require('internal-test-utils').act;\n \n // Isolate test renderer.\n jest.resetModules();\n@@ -42,6 +43,7 @@ let Surface;\n let TestComponent;\n \n let waitFor;\n+let groupRef;\n \n const Missing = {};\n \n@@ -82,8 +84,9 @@ describe('ReactART', () => {\n \n     ({waitFor} = require('internal-test-utils'));\n \n+    groupRef = React.createRef();\n     TestComponent = class extends React.Component {\n-      group = React.createRef();\n+      group = groupRef;\n \n       render() {\n         const a = (\n@@ -132,17 +135,23 @@ describe('ReactART', () => {\n     container = null;\n   });\n \n-  it('should have the correct lifecycle state', () => {\n-    let instance = <TestComponent />;\n-    instance = ReactTestUtils.renderIntoDocument(instance);\n-    const group = instance.group.current;\n+  it('should have the correct lifecycle state', async () => {\n+    const instance = <TestComponent />;\n+    const root = ReactDOMClient.createRoot(container);\n+    await act(() => {\n+      root.render(instance);\n+    });\n+    const group = groupRef.current;\n     // Duck type test for an ART group\n     expect(typeof group.indicate).toBe('function');\n   });\n \n-  it('should render a reasonable SVG structure in SVG mode', () => {\n-    let instance = <TestComponent />;\n-    instance = ReactTestUtils.renderIntoDocument(instance);\n+  it('should render a reasonable SVG structure in SVG mode', async () => {\n+    const instance = <TestComponent />;\n+    const root = ReactDOMClient.createRoot(container);\n+    await act(() => {\n+      root.render(instance);\n+    });\n \n     const expectedStructure = {\n       nodeName: 'svg',\n@@ -165,15 +174,15 @@ describe('ReactART', () => {\n       ],\n     };\n \n-    const realNode = ReactDOM.findDOMNode(instance);\n+    const realNode = container.firstChild;\n     testDOMNodeStructure(realNode, expectedStructure);\n   });\n \n-  it('should be able to reorder components', () => {\n-    const instance = ReactDOM.render(\n-      <TestComponent flipped={false} />,\n-      container,\n-    );\n+  it('should be able to reorder components', async () => {\n+    const root = ReactDOMClient.createRoot(container);\n+    await act(() => {\n+      root.render(<TestComponent flipped={false} />);\n+    });\n \n     const expectedStructure = {\n       nodeName: 'svg',\n@@ -191,10 +200,12 @@ describe('ReactART', () => {\n       ],\n     };\n \n-    const realNode = ReactDOM.findDOMNode(instance);\n+    const realNode = container.firstChild;\n     testDOMNodeStructure(realNode, expectedStructure);\n \n-    ReactDOM.render(<TestComponent flipped={true} />, container);\n+    await act(() => {\n+      root.render(<TestComponent flipped={true} />);\n+    });\n \n     const expectedNewStructure = {\n       nodeName: 'svg',\n@@ -215,7 +226,7 @@ describe('ReactART', () => {\n     testDOMNodeStructure(realNode, expectedNewStructure);\n   });\n \n-  it('should be able to reorder many components', () => {\n+  it('should be able to reorder many components', async () => {\n     class Component extends React.Component {\n       render() {\n         const chars = this.props.chars.split('');\n@@ -233,17 +244,20 @@ describe('ReactART', () => {\n     const before = 'abcdefghijklmnopqrst';\n     const after = 'mxhpgwfralkeoivcstzy';\n \n-    let instance = ReactDOM.render(<Component chars={before} />, container);\n-    const realNode = ReactDOM.findDOMNode(instance);\n+    const root = ReactDOMClient.createRoot(container);\n+    await act(() => {\n+      root.render(<Component chars={before} />);\n+    });\n+    const realNode = container.firstChild;\n     expect(realNode.textContent).toBe(before);\n \n-    instance = ReactDOM.render(<Component chars={after} />, container);\n+    await act(() => {\n+      root.render(<Component chars={after} />);\n+    });\n     expect(realNode.textContent).toBe(after);\n-\n-    ReactDOM.unmountComponentAtNode(container);\n   });\n \n-  it('renders composite with lifecycle inside group', () => {\n+  it('renders composite with lifecycle inside group', async () => {\n     let mounted = false;\n \n     class CustomShape extends React.Component {\n@@ -255,18 +269,20 @@ describe('ReactART', () => {\n         mounted = true;\n       }\n     }\n-\n-    ReactTestUtils.renderIntoDocument(\n-      <Surface>\n-        <Group>\n-          <CustomShape />\n-        </Group>\n-      </Surface>,\n-    );\n+    const root = ReactDOMClient.createRoot(container);\n+    await act(() => {\n+      root.render(\n+        <Surface>\n+          <Group>\n+            <CustomShape />\n+          </Group>\n+        </Surface>,\n+      );\n+    });\n     expect(mounted).toBe(true);\n   });\n \n-  it('resolves refs before componentDidMount', () => {\n+  it('resolves refs before componentDidMount', async () => {\n     class CustomShape extends React.Component {\n       render() {\n         return <Shape />;\n@@ -293,11 +309,14 @@ describe('ReactART', () => {\n       }\n     }\n \n-    ReactTestUtils.renderIntoDocument(<Outer />);\n+    const root = ReactDOMClient.createRoot(container);\n+    await act(() => {\n+      root.render(<Outer />);\n+    });\n     expect(ref.constructor).toBe(CustomShape);\n   });\n \n-  it('resolves refs before componentDidUpdate', () => {\n+  it('resolves refs before componentDidUpdate', async () => {\n     class CustomShape extends React.Component {\n       render() {\n         return <Shape />;\n@@ -327,24 +346,34 @@ describe('ReactART', () => {\n         );\n       }\n     }\n-    ReactDOM.render(<Outer />, container);\n+\n+    const root = ReactDOMClient.createRoot(container);\n+    await act(() => {\n+      root.render(<Outer />);\n+    });\n     expect(ref).toBe(null);\n-    ReactDOM.render(<Outer mountCustomShape={true} />, container);\n+\n+    await act(() => {\n+      root.render(<Outer mountCustomShape={true} />);\n+    });\n     expect(ref.constructor).toBe(CustomShape);\n   });\n \n-  it('adds and updates event handlers', () => {\n-    function render(onClick) {\n-      return ReactDOM.render(\n-        <Surface>\n-          <Shape onClick={onClick} />\n-        </Surface>,\n-        container,\n-      );\n+  it('adds and updates event handlers', async () => {\n+    const root = ReactDOMClient.createRoot(container);\n+\n+    async function render(onClick) {\n+      await act(() => {\n+        root.render(\n+          <Surface>\n+            <Shape onClick={onClick} />\n+          </Surface>,\n+        );\n+      });\n     }\n \n     function doClick(instance) {\n-      const path = ReactDOM.findDOMNode(instance).querySelector('path');\n+      const path = container.firstChild.querySelector('path');\n \n       path.dispatchEvent(\n         new MouseEvent('click', {\n@@ -354,12 +383,12 @@ describe('ReactART', () => {\n     }\n \n     const onClick1 = jest.fn();\n-    let instance = render(onClick1);\n+    let instance = await render(onClick1);\n     doClick(instance);\n     expect(onClick1).toBeCalled();\n \n     const onClick2 = jest.fn();\n-    instance = render(onClick2);\n+    instance = await render(onClick2);\n     doClick(instance);\n     expect(onClick2).toBeCalled();\n   });\n@@ -398,15 +427,17 @@ describe('ReactART', () => {\n \n     await waitFor(['A']);\n \n-    ReactDOM.render(\n-      <Surface>\n-        <LogCurrentRenderer />\n-        <CurrentRendererContext.Provider value=\"ART\">\n+    const root = ReactDOMClient.createRoot(container);\n+    await act(() => {\n+      root.render(\n+        <Surface>\n           <LogCurrentRenderer />\n-        </CurrentRendererContext.Provider>\n-      </Surface>,\n-      container,\n-    );\n+          <CurrentRendererContext.Provider value=\"ART\">\n+            <LogCurrentRenderer />\n+          </CurrentRendererContext.Provider>\n+        </Surface>,\n+      );\n+    });\n \n     expect(ops).toEqual([null, 'ART']);\n \n@@ -425,18 +456,6 @@ describe('ReactARTComponents', () => {\n     expect(circle.toJSON()).toMatchSnapshot();\n   });\n \n-  it('should warn if radius is missing on a Circle component', () => {\n-    expect(() =>\n-      ReactTestRenderer.create(\n-        <Circle stroke=\"green\" strokeWidth={3} fill=\"blue\" />,\n-      ),\n-    ).toErrorDev(\n-      'Warning: Failed prop type: The prop `radius` is marked as required in `Circle`, ' +\n-        'but its value is `undefined`.' +\n-        '\\n    in Circle (at **)',\n-    );\n-  });\n-\n   it('should generate a <Shape> with props for drawing the Rectangle', () => {\n     const rectangle = ReactTestRenderer.create(\n       <Rectangle width={50} height={50} stroke=\"green\" fill=\"blue\" />,\n@@ -498,19 +517,6 @@ describe('ReactARTComponents', () => {\n     expect(rectangle.toJSON()).toMatchSnapshot();\n   });\n \n-  it('should warn if width/height is missing on a Rectangle component', () => {\n-    expect(() =>\n-      ReactTestRenderer.create(<Rectangle stroke=\"green\" fill=\"blue\" />),\n-    ).toErrorDev([\n-      'Warning: Failed prop type: The prop `width` is marked as required in `Rectangle`, ' +\n-        'but its value is `undefined`.' +\n-        '\\n    in Rectangle (at **)',\n-      'Warning: Failed prop type: The prop `height` is marked as required in `Rectangle`, ' +\n-        'but its value is `undefined`.' +\n-        '\\n    in Rectangle (at **)',\n-    ]);\n-  });\n-\n   it('should generate a <Shape> with props for drawing the Wedge', () => {\n     const wedge = ReactTestRenderer.create(\n       <Wedge outerRadius={50} startAngle={0} endAngle={360} fill=\"blue\" />,\n@@ -524,18 +530,4 @@ describe('ReactARTComponents', () => {\n     );\n     expect(wedge.toJSON()).toBeNull();\n   });\n-\n-  it('should warn if outerRadius/startAngle/endAngle is missing on a Wedge component', () => {\n-    expect(() => ReactTestRenderer.create(<Wedge fill=\"blue\" />)).toErrorDev([\n-      'Warning: Failed prop type: The prop `outerRadius` is marked as required in `Wedge`, ' +\n-        'but its value is `undefined`.' +\n-        '\\n    in Wedge (at **)',\n-      'Warning: Failed prop type: The prop `startAngle` is marked as required in `Wedge`, ' +\n-        'but its value is `undefined`.' +\n-        '\\n    in Wedge (at **)',\n-      'Warning: Failed prop type: The prop `endAngle` is marked as required in `Wedge`, ' +\n-        'but its value is `undefined`.' +\n-        '\\n    in Wedge (at **)',\n-    ]);\n-  });\n });"
            },
            {
                "file": "packages/react-cache/src/__tests__/ReactCacheOld-test.internal.js",
                "git_diff": "@@ -13,7 +13,7 @@ let ReactCache;\n let createResource;\n let React;\n let ReactFeatureFlags;\n-let ReactTestRenderer;\n+let ReactNoop;\n let Scheduler;\n let Suspense;\n let TextResource;\n@@ -34,7 +34,7 @@ describe('ReactCache', () => {\n     Suspense = React.Suspense;\n     ReactCache = require('react-cache');\n     createResource = ReactCache.unstable_createResource;\n-    ReactTestRenderer = require('react-test-renderer');\n+    ReactNoop = require('react-noop-renderer');\n     Scheduler = require('scheduler');\n \n     const InternalTestUtils = require('internal-test-utils');\n@@ -120,9 +120,8 @@ describe('ReactCache', () => {\n       );\n     }\n \n-    ReactTestRenderer.create(<App />, {\n-      isConcurrent: true,\n-    });\n+    const root = ReactNoop.createRoot();\n+    root.render(<App />);\n \n     await waitForAll(['Suspend! [Hi]', 'Loading...']);\n \n@@ -140,9 +139,8 @@ describe('ReactCache', () => {\n       );\n     }\n \n-    const root = ReactTestRenderer.create(<App />, {\n-      isConcurrent: true,\n-    });\n+    const root = ReactNoop.createRoot();\n+    root.render(<App />);\n \n     await waitForAll(['Suspend! [Hi]', 'Loading...']);\n \n@@ -157,7 +155,7 @@ describe('ReactCache', () => {\n     assertLog(['Promise rejected [Hi]', 'Error! [Hi]', 'Error! [Hi]']);\n \n     // Should throw again on a subsequent read\n-    root.update(<App />);\n+    root.render(<App />);\n     await waitForThrow('Failed to load: Hi');\n     assertLog(['Error! [Hi]', 'Error! [Hi]']);\n   });\n@@ -176,13 +174,11 @@ describe('ReactCache', () => {\n       return BadTextResource.read(['Hi', 100]);\n     }\n \n-    ReactTestRenderer.create(\n+    const root = ReactNoop.createRoot();\n+    root.render(\n       <Suspense fallback={<Text text=\"Loading...\" />}>\n         <App />\n       </Suspense>,\n-      {\n-        isConcurrent: true,\n-      },\n     );\n \n     if (__DEV__) {\n@@ -202,16 +198,14 @@ describe('ReactCache', () => {\n   it('evicts least recently used values', async () => {\n     ReactCache.unstable_setGlobalCacheLimit(3);\n \n+    const root = ReactNoop.createRoot();\n     // Render 1, 2, and 3\n-    const root = ReactTestRenderer.create(\n+    root.render(\n       <Suspense fallback={<Text text=\"Loading...\" />}>\n         <AsyncText ms={100} text={1} />\n         <AsyncText ms={100} text={2} />\n         <AsyncText ms={100} text={3} />\n       </Suspense>,\n-      {\n-        isConcurrent: true,\n-      },\n     );\n     await waitForAll(['Suspend! [1]', 'Loading...']);\n     jest.advanceTimersByTime(100);\n@@ -228,7 +222,7 @@ describe('ReactCache', () => {\n     expect(root).toMatchRenderedOutput('123');\n \n     // Render 1, 4, 5\n-    root.update(\n+    root.render(\n       <Suspense fallback={<Text text=\"Loading...\" />}>\n         <AsyncText ms={100} text={1} />\n         <AsyncText ms={100} text={4} />\n@@ -255,7 +249,7 @@ describe('ReactCache', () => {\n     // We've now rendered values 1, 2, 3, 4, 5, over our limit of 3. The least\n     // recently used values are 2 and 3. They should have been evicted.\n \n-    root.update(\n+    root.render(\n       <Suspense fallback={<Text text=\"Loading...\" />}>\n         <AsyncText ms={100} text={1} />\n         <AsyncText ms={100} text={2} />\n@@ -293,13 +287,11 @@ describe('ReactCache', () => {\n       return <Text text=\"Result\" />;\n     }\n \n-    const root = ReactTestRenderer.create(\n+    const root = ReactNoop.createRoot();\n+    root.render(\n       <Suspense fallback={<Text text=\"Loading...\" />}>\n         <App />\n       </Suspense>,\n-      {\n-        isConcurrent: true,\n-      },\n     );\n \n     await waitForAll(['Loading...']);\n@@ -351,13 +343,11 @@ describe('ReactCache', () => {\n       }\n     }\n \n-    const root = ReactTestRenderer.create(\n+    const root = ReactNoop.createRoot();\n+    root.render(\n       <Suspense fallback={<Text text=\"Loading...\" />}>\n         <BadAsyncText text=\"Hi\" />\n       </Suspense>,\n-      {\n-        isConcurrent: true,\n-      },\n     );\n \n     await waitForAll(['Suspend! [Hi]', 'Loading...']);\n@@ -367,13 +357,10 @@ describe('ReactCache', () => {\n     // cached value.\n     resolveThenable('Hi muahahaha I am different');\n \n-    root.update(\n+    root.render(\n       <Suspense fallback={<Text text=\"Loading...\" />}>\n         <BadAsyncText text=\"Hi\" />\n       </Suspense>,\n-      {\n-        isConcurrent: true,\n-      },\n     );\n \n     assertLog([]);"
            },
            {
                "file": "packages/react-client/package.json",
                "git_diff": "@@ -6,7 +6,7 @@\n   \"keywords\": [\n     \"react\"\n   ],\n-  \"homepage\": \"https://reactjs.org/\",\n+  \"homepage\": \"https://react.dev/\",\n   \"bugs\": \"https://github.com/facebook/react/issues\",\n   \"license\": \"MIT\",\n   \"files\": [\n@@ -25,13 +25,5 @@\n   },\n   \"peerDependencies\": {\n     \"react\": \"^17.0.0\"\n-  },\n-  \"dependencies\": {\n-    \"loose-envify\": \"^1.1.0\"\n-  },\n-  \"browserify\": {\n-    \"transform\": [\n-      \"loose-envify\"\n-    ]\n   }\n }"
            },
            {
                "file": "packages/react-client/src/ReactFlightClient.js",
                "git_diff": "@@ -7,7 +7,12 @@\n  * @flow\n  */\n \n-import type {Thenable} from 'shared/ReactTypes';\n+import type {\n+  Thenable,\n+  ReactDebugInfo,\n+  ReactComponentInfo,\n+  ReactAsyncInfo,\n+} from 'shared/ReactTypes';\n import type {LazyComponent} from 'react/src/ReactLazy';\n \n import type {\n@@ -23,11 +28,18 @@ import type {\n   HintModel,\n } from 'react-server/src/ReactFlightServerConfig';\n \n-import type {CallServerCallback} from './ReactFlightReplyClient';\n+import type {\n+  CallServerCallback,\n+  EncodeFormActionCallback,\n+} from './ReactFlightReplyClient';\n \n import type {Postpone} from 'react/src/ReactPostpone';\n \n-import {enableBinaryFlight, enablePostpone} from 'shared/ReactFeatureFlags';\n+import {\n+  enableBinaryFlight,\n+  enablePostpone,\n+  enableRefAsProp,\n+} from 'shared/ReactFeatureFlags';\n \n import {\n   resolveClientReference,\n@@ -38,6 +50,7 @@ import {\n   readFinalStringChunk,\n   createStringDecoder,\n   prepareDestinationForModule,\n+  printToConsole,\n } from './ReactFlightClientConfig';\n \n import {registerServerReference} from './ReactFlightReplyClient';\n@@ -48,9 +61,7 @@ import {\n   REACT_POSTPONE_TYPE,\n } from 'shared/ReactSymbols';\n \n-import {getOrCreateServerContext} from 'shared/ReactServerContextRegistry';\n-\n-export type {CallServerCallback};\n+export type {CallServerCallback, EncodeFormActionCallback};\n \n type UninitializedModel = string;\n \n@@ -83,48 +94,55 @@ type PendingChunk<T> = {\n   value: null | Array<(T) => mixed>,\n   reason: null | Array<(mixed) => mixed>,\n   _response: Response,\n+  _debugInfo?: null | ReactDebugInfo,\n   then(resolve: (T) => mixed, reject: (mixed) => mixed): void,\n };\n type BlockedChunk<T> = {\n   status: 'blocked',\n   value: null | Array<(T) => mixed>,\n   reason: null | Array<(mixed) => mixed>,\n   _response: Response,\n+  _debugInfo?: null | ReactDebugInfo,\n   then(resolve: (T) => mixed, reject: (mixed) => mixed): void,\n };\n type CyclicChunk<T> = {\n   status: 'cyclic',\n   value: null | Array<(T) => mixed>,\n   reason: null | Array<(mixed) => mixed>,\n   _response: Response,\n+  _debugInfo?: null | ReactDebugInfo,\n   then(resolve: (T) => mixed, reject: (mixed) => mixed): void,\n };\n type ResolvedModelChunk<T> = {\n   status: 'resolved_model',\n   value: UninitializedModel,\n   reason: null,\n   _response: Response,\n+  _debugInfo?: null | ReactDebugInfo,\n   then(resolve: (T) => mixed, reject: (mixed) => mixed): void,\n };\n type ResolvedModuleChunk<T> = {\n   status: 'resolved_module',\n   value: ClientReference<T>,\n   reason: null,\n   _response: Response,\n+  _debugInfo?: null | ReactDebugInfo,\n   then(resolve: (T) => mixed, reject: (mixed) => mixed): void,\n };\n type InitializedChunk<T> = {\n   status: 'fulfilled',\n   value: T,\n   reason: null,\n   _response: Response,\n+  _debugInfo?: null | ReactDebugInfo,\n   then(resolve: (T) => mixed, reject: (mixed) => mixed): void,\n };\n type ErroredChunk<T> = {\n   status: 'rejected',\n   value: null,\n   reason: mixed,\n   _response: Response,\n+  _debugInfo?: null | ReactDebugInfo,\n   then(resolve: (T) => mixed, reject: (mixed) => mixed): void,\n };\n type SomeChunk<T> =\n@@ -142,6 +160,9 @@ function Chunk(status: any, value: any, reason: any, response: Response) {\n   this.value = value;\n   this.reason = reason;\n   this._response = response;\n+  if (__DEV__) {\n+    this._debugInfo = null;\n+  }\n }\n // We subclass Promise.prototype so that we get other methods like .catch\n Chunk.prototype = (Object.create(Promise.prototype): any);\n@@ -193,6 +214,7 @@ export type Response = {\n   _bundlerConfig: SSRModuleMap,\n   _moduleLoading: ModuleLoading,\n   _callServer: CallServerCallback,\n+  _encodeFormAction: void | EncodeFormActionCallback,\n   _nonce: ?string,\n   _chunks: Map<number, SomeChunk<any>>,\n   _fromJSON: (key: string, value: JSONValue) => any,\n@@ -446,24 +468,46 @@ export function reportGlobalError(response: Response, error: Error): void {\n   });\n }\n \n+function nullRefGetter() {\n+  if (__DEV__) {\n+    return null;\n+  }\n+}\n+\n function createElement(\n   type: mixed,\n   key: mixed,\n   props: mixed,\n ): React$Element<any> {\n-  const element: any = {\n-    // This tag allows us to uniquely identify this as a React Element\n-    $$typeof: REACT_ELEMENT_TYPE,\n-\n-    // Built-in properties that belong on the element\n-    type: type,\n-    key: key,\n-    ref: null,\n-    props: props,\n-\n-    // Record the component responsible for creating this element.\n-    _owner: null,\n-  };\n+  let element: any;\n+  if (__DEV__ && enableRefAsProp) {\n+    // `ref` is non-enumerable in dev\n+    element = ({\n+      $$typeof: REACT_ELEMENT_TYPE,\n+      type,\n+      key,\n+      props,\n+      _owner: null,\n+    }: any);\n+    Object.defineProperty(element, 'ref', {\n+      enumerable: false,\n+      get: nullRefGetter,\n+    });\n+  } else {\n+    element = ({\n+      // This tag allows us to uniquely identify this as a React Element\n+      $$typeof: REACT_ELEMENT_TYPE,\n+\n+      type,\n+      key,\n+      ref: null,\n+      props,\n+\n+      // Record the component responsible for creating this element.\n+      _owner: null,\n+    }: any);\n+  }\n+\n   if (__DEV__) {\n     // We don't really need to add any of these but keeping them for good measure.\n     // Unfortunately, _store is enumerable in jest matchers so for equality to\n@@ -477,16 +521,11 @@ function createElement(\n       writable: true,\n       value: true, // This element has already been validated on the server.\n     });\n-    Object.defineProperty(element, '_self', {\n-      configurable: false,\n-      enumerable: false,\n-      writable: false,\n-      value: null,\n-    });\n-    Object.defineProperty(element, '_source', {\n+    // debugInfo contains Server Component debug information.\n+    Object.defineProperty(element, '_debugInfo', {\n       configurable: false,\n       enumerable: false,\n-      writable: false,\n+      writable: true,\n       value: null,\n     });\n   }\n@@ -501,6 +540,12 @@ function createLazyChunkWrapper<T>(\n     _payload: chunk,\n     _init: readChunk,\n   };\n+  if (__DEV__) {\n+    // Ensure we have a live array to track future debug info.\n+    const chunkDebugInfo: ReactDebugInfo =\n+      chunk._debugInfo || (chunk._debugInfo = []);\n+    lazyType._debugInfo = chunkDebugInfo;\n+  }\n   return lazyType;\n }\n \n@@ -578,7 +623,7 @@ function createServerReferenceProxy<A: Iterable<any>, T>(\n       },\n     );\n   };\n-  registerServerReference(proxy, metaData);\n+  registerServerReference(proxy, metaData, response._encodeFormAction);\n   return proxy;\n }\n \n@@ -626,6 +671,10 @@ function parseModelString(\n       }\n       case '@': {\n         // Promise\n+        if (value.length === 2) {\n+          // Infinite promise that never resolves.\n+          return new Promise(() => {});\n+        }\n         const id = parseInt(value.slice(2), 16);\n         const chunk = getChunk(response, id);\n         return chunk;\n@@ -634,10 +683,6 @@ function parseModelString(\n         // Symbol\n         return Symbol.for(value.slice(2));\n       }\n-      case 'P': {\n-        // Server Context Provider\n-        return getOrCreateServerContext(value.slice(2)).Provider;\n-      }\n       case 'F': {\n         // Server Reference\n         const id = parseInt(value.slice(2), 16);\n@@ -685,6 +730,21 @@ function parseModelString(\n         // BigInt\n         return BigInt(value.slice(2));\n       }\n+      case 'E': {\n+        if (__DEV__) {\n+          // In DEV mode we allow indirect eval to produce functions for logging.\n+          // This should not compile to eval() because then it has local scope access.\n+          try {\n+            // eslint-disable-next-line no-eval\n+            return (0, eval)(value.slice(2));\n+          } catch (x) {\n+            // We currently use this to express functions so we fail parsing it,\n+            // let's just return a blank function as a place holder.\n+            return function () {};\n+          }\n+        }\n+        // Fallthrough\n+      }\n       default: {\n         // We assume that anything else is a reference ID.\n         const id = parseInt(value.slice(1), 16);\n@@ -700,7 +760,33 @@ function parseModelString(\n         // The status might have changed after initialization.\n         switch (chunk.status) {\n           case INITIALIZED:\n-            return chunk.value;\n+            const chunkValue = chunk.value;\n+            if (__DEV__ && chunk._debugInfo) {\n+              // If we have a direct reference to an object that was rendered by a synchronous\n+              // server component, it might have some debug info about how it was rendered.\n+              // We forward this to the underlying object. This might be a React Element or\n+              // an Array fragment.\n+              // If this was a string / number return value we lose the debug info. We choose\n+              // that tradeoff to allow sync server components to return plain values and not\n+              // use them as React Nodes necessarily. We could otherwise wrap them in a Lazy.\n+              if (\n+                typeof chunkValue === 'object' &&\n+                chunkValue !== null &&\n+                (Array.isArray(chunkValue) ||\n+                  chunkValue.$$typeof === REACT_ELEMENT_TYPE) &&\n+                !chunkValue._debugInfo\n+              ) {\n+                // We should maybe use a unique symbol for arrays but this is a React owned array.\n+                // $FlowFixMe[prop-missing]: This should be added to elements.\n+                Object.defineProperty(chunkValue, '_debugInfo', {\n+                  configurable: false,\n+                  enumerable: false,\n+                  writable: true,\n+                  value: chunk._debugInfo,\n+                });\n+              }\n+            }\n+            return chunkValue;\n           case PENDING:\n           case BLOCKED:\n           case CYCLIC:\n@@ -749,13 +835,15 @@ export function createResponse(\n   bundlerConfig: SSRModuleMap,\n   moduleLoading: ModuleLoading,\n   callServer: void | CallServerCallback,\n+  encodeFormAction: void | EncodeFormActionCallback,\n   nonce: void | string,\n ): Response {\n   const chunks: Map<number, SomeChunk<any>> = new Map();\n   const response: Response = {\n     _bundlerConfig: bundlerConfig,\n     _moduleLoading: moduleLoading,\n     _callServer: callServer !== undefined ? callServer : missingCall,\n+    _encodeFormAction: encodeFormAction,\n     _nonce: nonce,\n     _chunks: chunks,\n     _stringDecoder: createStringDecoder(),\n@@ -977,6 +1065,45 @@ function resolveHint<Code: HintCode>(\n   dispatchHint(code, hintModel);\n }\n \n+function resolveDebugInfo(\n+  response: Response,\n+  id: number,\n+  debugInfo: ReactComponentInfo | ReactAsyncInfo,\n+): void {\n+  if (!__DEV__) {\n+    // These errors should never make it into a build so we don't need to encode them in codes.json\n+    // eslint-disable-next-line react-internal/prod-error-codes\n+    throw new Error(\n+      'resolveDebugInfo should never be called in production mode. This is a bug in React.',\n+    );\n+  }\n+  const chunk = getChunk(response, id);\n+  const chunkDebugInfo: ReactDebugInfo =\n+    chunk._debugInfo || (chunk._debugInfo = []);\n+  chunkDebugInfo.push(debugInfo);\n+}\n+\n+function resolveConsoleEntry(\n+  response: Response,\n+  value: UninitializedModel,\n+): void {\n+  if (!__DEV__) {\n+    // These errors should never make it into a build so we don't need to encode them in codes.json\n+    // eslint-disable-next-line react-internal/prod-error-codes\n+    throw new Error(\n+      'resolveConsoleEntry should never be called in production mode. This is a bug in React.',\n+    );\n+  }\n+\n+  const payload: [string, string, string, mixed] = parseModel(response, value);\n+  const methodName = payload[0];\n+  // TODO: Restore the fake stack before logging.\n+  // const stackTrace = payload[1];\n+  const env = payload[2];\n+  const args = payload.slice(3);\n+  printToConsole(methodName, args, env);\n+}\n+\n function mergeBuffer(\n   buffer: Array<Uint8Array>,\n   lastChunk: Uint8Array,\n@@ -1070,7 +1197,7 @@ function processFullRow(\n       case 70 /* \"F\" */:\n         resolveTypedArray(response, id, buffer, chunk, Float32Array, 4);\n         return;\n-      case 68 /* \"D\" */:\n+      case 100 /* \"d\" */:\n         resolveTypedArray(response, id, buffer, chunk, Float64Array, 8);\n         return;\n       case 78 /* \"N\" */:\n@@ -1120,6 +1247,25 @@ function processFullRow(\n       resolveText(response, id, row);\n       return;\n     }\n+    case 68 /* \"D\" */: {\n+      if (__DEV__) {\n+        const debugInfo = JSON.parse(row);\n+        resolveDebugInfo(response, id, debugInfo);\n+        return;\n+      }\n+      // Fallthrough to share the error with Console entries.\n+    }\n+    case 87 /* \"W\" */: {\n+      if (__DEV__) {\n+        resolveConsoleEntry(response, row);\n+        return;\n+      }\n+      throw new Error(\n+        'Failed to read a RSC payload created by a development version of React ' +\n+          'on the server while using a production version on the client. Always use ' +\n+          'matching versions on the server and the client.',\n+      );\n+    }\n     case 80 /* \"P\" */: {\n       if (enablePostpone) {\n         if (__DEV__) {\n@@ -1183,7 +1329,7 @@ export function processBinaryChunk(\n               resolvedRowTag === 76 /* \"L\" */ ||\n               resolvedRowTag === 108 /* \"l\" */ ||\n               resolvedRowTag === 70 /* \"F\" */ ||\n-              resolvedRowTag === 68 /* \"D\" */ ||\n+              resolvedRowTag === 100 /* \"d\" */ ||\n               resolvedRowTag === 78 /* \"N\" */ ||\n               resolvedRowTag === 109 /* \"m\" */ ||\n               resolvedRowTag === 86)) /* \"V\" */"
            },
            {
                "file": "packages/react-client/src/ReactFlightClientConsoleConfigBrowser.js",
                "git_diff": "@@ -0,0 +1,69 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ *\n+ * @flow\n+ */\n+\n+const badgeFormat = '%c%s%c ';\n+// Same badge styling as DevTools.\n+const badgeStyle =\n+  // We use a fixed background if light-dark is not supported, otherwise\n+  // we use a transparent background.\n+  'background: #e6e6e6;' +\n+  'background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));' +\n+  'color: #000000;' +\n+  'color: light-dark(#000000, #ffffff);' +\n+  'border-radius: 2px';\n+const resetStyle = '';\n+const pad = ' ';\n+\n+export function printToConsole(\n+  methodName: string,\n+  args: Array<any>,\n+  badgeName: string,\n+): void {\n+  let offset = 0;\n+  switch (methodName) {\n+    case 'dir':\n+    case 'dirxml':\n+    case 'groupEnd':\n+    case 'table': {\n+      // These methods cannot be colorized because they don't take a formatting string.\n+      // eslint-disable-next-line react-internal/no-production-logging\n+      console[methodName].apply(console, args);\n+      return;\n+    }\n+    case 'assert': {\n+      // assert takes formatting options as the second argument.\n+      offset = 1;\n+    }\n+  }\n+\n+  const newArgs = args.slice(0);\n+  if (typeof newArgs[offset] === 'string') {\n+    newArgs.splice(\n+      offset,\n+      1,\n+      badgeFormat + newArgs[offset],\n+      badgeStyle,\n+      pad + badgeName + pad,\n+      resetStyle,\n+    );\n+  } else {\n+    newArgs.splice(\n+      offset,\n+      0,\n+      badgeFormat,\n+      badgeStyle,\n+      pad + badgeName + pad,\n+      resetStyle,\n+    );\n+  }\n+\n+  // eslint-disable-next-line react-internal/no-production-logging\n+  console[methodName].apply(console, newArgs);\n+  return;\n+}"
            },
            {
                "file": "packages/react-client/src/ReactFlightClientConsoleConfigPlain.js",
                "git_diff": "@@ -0,0 +1,50 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ *\n+ * @flow\n+ */\n+\n+const badgeFormat = '[%s] ';\n+const pad = ' ';\n+\n+export function printToConsole(\n+  methodName: string,\n+  args: Array<any>,\n+  badgeName: string,\n+): void {\n+  let offset = 0;\n+  switch (methodName) {\n+    case 'dir':\n+    case 'dirxml':\n+    case 'groupEnd':\n+    case 'table': {\n+      // These methods cannot be colorized because they don't take a formatting string.\n+      // eslint-disable-next-line react-internal/no-production-logging\n+      console[methodName].apply(console, args);\n+      return;\n+    }\n+    case 'assert': {\n+      // assert takes formatting options as the second argument.\n+      offset = 1;\n+    }\n+  }\n+\n+  const newArgs = args.slice(0);\n+  if (typeof newArgs[offset] === 'string') {\n+    newArgs.splice(\n+      offset,\n+      1,\n+      badgeFormat + newArgs[offset],\n+      pad + badgeName + pad,\n+    );\n+  } else {\n+    newArgs.splice(offset, 0, badgeFormat, pad + badgeName + pad);\n+  }\n+\n+  // eslint-disable-next-line react-internal/no-production-logging\n+  console[methodName].apply(console, newArgs);\n+  return;\n+}"
            },
            {
                "file": "packages/react-client/src/ReactFlightClientConsoleConfigServer.js",
                "git_diff": "@@ -0,0 +1,70 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ *\n+ * @flow\n+ */\n+\n+// This flips color using ANSI, then sets a color styling, then resets.\n+const badgeFormat = '\\x1b[0m\\x1b[7m%c%s\\x1b[0m%c ';\n+// Same badge styling as DevTools.\n+const badgeStyle =\n+  // We use a fixed background if light-dark is not supported, otherwise\n+  // we use a transparent background.\n+  'background: #e6e6e6;' +\n+  'background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));' +\n+  'color: #000000;' +\n+  'color: light-dark(#000000, #ffffff);' +\n+  'border-radius: 2px';\n+const resetStyle = '';\n+const pad = ' ';\n+\n+export function printToConsole(\n+  methodName: string,\n+  args: Array<any>,\n+  badgeName: string,\n+): void {\n+  let offset = 0;\n+  switch (methodName) {\n+    case 'dir':\n+    case 'dirxml':\n+    case 'groupEnd':\n+    case 'table': {\n+      // These methods cannot be colorized because they don't take a formatting string.\n+      // eslint-disable-next-line react-internal/no-production-logging\n+      console[methodName].apply(console, args);\n+      return;\n+    }\n+    case 'assert': {\n+      // assert takes formatting options as the second argument.\n+      offset = 1;\n+    }\n+  }\n+\n+  const newArgs = args.slice(0);\n+  if (typeof newArgs[offset] === 'string') {\n+    newArgs.splice(\n+      offset,\n+      1,\n+      badgeFormat + newArgs[offset],\n+      badgeStyle,\n+      pad + badgeName + pad,\n+      resetStyle,\n+    );\n+  } else {\n+    newArgs.splice(\n+      offset,\n+      0,\n+      badgeFormat,\n+      badgeStyle,\n+      pad + badgeName + pad,\n+      resetStyle,\n+    );\n+  }\n+\n+  // eslint-disable-next-line react-internal/no-production-logging\n+  console[methodName].apply(console, newArgs);\n+  return;\n+}"
            },
            {
                "file": "packages/react-client/src/ReactFlightClientStreamConfigNode.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-client/src/ReactFlightClientStreamConfigWeb.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-client/src/ReactFlightReplyClient.js",
                "git_diff": "@@ -14,10 +14,12 @@ import type {\n   RejectedThenable,\n   ReactCustomFormAction,\n } from 'shared/ReactTypes';\n+import {enableRenderableContext} from 'shared/ReactFeatureFlags';\n \n import {\n   REACT_ELEMENT_TYPE,\n   REACT_LAZY_TYPE,\n+  REACT_CONTEXT_TYPE,\n   REACT_PROVIDER_TYPE,\n   getIteratorFn,\n } from 'shared/ReactSymbols';\n@@ -47,6 +49,11 @@ export opaque type ServerReference<T> = T;\n \n export type CallServerCallback = <A, T>(id: any, args: A) => Promise<T>;\n \n+export type EncodeFormActionCallback = <A>(\n+  id: any,\n+  args: Promise<A>,\n+) => ReactCustomFormAction;\n+\n export type ServerReferenceId = any;\n \n const knownServerReferences: WeakMap<\n@@ -297,7 +304,10 @@ export function processReply(\n             'React Lazy cannot be passed to Server Functions from the Client.%s',\n             describeObjectForErrorMessage(parent, key),\n           );\n-        } else if ((value: any).$$typeof === REACT_PROVIDER_TYPE) {\n+        } else if (\n+          (value: any).$$typeof ===\n+          (enableRenderableContext ? REACT_CONTEXT_TYPE : REACT_PROVIDER_TYPE)\n+        ) {\n           console.error(\n             'React Context Providers cannot be passed to Server Functions from the Client.%s',\n             describeObjectForErrorMessage(parent, key),\n@@ -454,7 +464,7 @@ function encodeFormData(reference: any): Thenable<FormData> {\n   return thenable;\n }\n \n-export function encodeFormAction(\n+function defaultEncodeFormAction(\n   this: any => Promise<any>,\n   identifierPrefix: string,\n ): ReactCustomFormAction {\n@@ -503,6 +513,25 @@ export function encodeFormAction(\n   };\n }\n \n+function customEncodeFormAction(\n+  proxy: any => Promise<any>,\n+  identifierPrefix: string,\n+  encodeFormAction: EncodeFormActionCallback,\n+): ReactCustomFormAction {\n+  const reference = knownServerReferences.get(proxy);\n+  if (!reference) {\n+    throw new Error(\n+      'Tried to encode a Server Action from a different instance than the encoder is from. ' +\n+        'This is a bug in React.',\n+    );\n+  }\n+  let boundPromise: Promise<Array<any>> = (reference.bound: any);\n+  if (boundPromise === null) {\n+    boundPromise = Promise.resolve([]);\n+  }\n+  return encodeFormAction(reference.id, boundPromise);\n+}\n+\n function isSignatureEqual(\n   this: any => Promise<any>,\n   referenceId: ServerReferenceId,\n@@ -569,13 +598,27 @@ function isSignatureEqual(\n export function registerServerReference(\n   proxy: any,\n   reference: {id: ServerReferenceId, bound: null | Thenable<Array<any>>},\n+  encodeFormAction: void | EncodeFormActionCallback,\n ) {\n   // Expose encoder for use by SSR, as well as a special bind that can be used to\n   // keep server capabilities.\n   if (usedWithSSR) {\n     // Only expose this in builds that would actually use it. Not needed on the client.\n+    const $$FORM_ACTION =\n+      encodeFormAction === undefined\n+        ? defaultEncodeFormAction\n+        : function (\n+            this: any => Promise<any>,\n+            identifierPrefix: string,\n+          ): ReactCustomFormAction {\n+            return customEncodeFormAction(\n+              this,\n+              identifierPrefix,\n+              encodeFormAction,\n+            );\n+          };\n     Object.defineProperties((proxy: any), {\n-      $$FORM_ACTION: {value: encodeFormAction},\n+      $$FORM_ACTION: {value: $$FORM_ACTION},\n       $$IS_SIGNATURE_EQUAL: {value: isSignatureEqual},\n       bind: {value: bind},\n     });\n@@ -587,11 +630,22 @@ export function registerServerReference(\n const FunctionBind = Function.prototype.bind;\n // $FlowFixMe[method-unbinding]\n const ArraySlice = Array.prototype.slice;\n-function bind(this: Function) {\n+function bind(this: Function): Function {\n   // $FlowFixMe[unsupported-syntax]\n   const newFn = FunctionBind.apply(this, arguments);\n   const reference = knownServerReferences.get(this);\n   if (reference) {\n+    if (__DEV__) {\n+      const thisBind = arguments[0];\n+      if (thisBind != null) {\n+        // This doesn't warn in browser environments since it's not instrumented outside\n+        // usedWithSSR. This makes this an SSR only warning which we don't generally do.\n+        // TODO: Consider a DEV only instrumentation in the browser.\n+        console.error(\n+          'Cannot bind \"this\" of a Server Action. Pass null or undefined as the first argument to .bind().',\n+        );\n+      }\n+    }\n     const args = ArraySlice.call(arguments, 1);\n     let boundPromise = null;\n     if (reference.bound !== null) {\n@@ -601,20 +655,31 @@ function bind(this: Function) {\n     } else {\n       boundPromise = Promise.resolve(args);\n     }\n-    registerServerReference(newFn, {id: reference.id, bound: boundPromise});\n+    // Expose encoder for use by SSR, as well as a special bind that can be used to\n+    // keep server capabilities.\n+    if (usedWithSSR) {\n+      // Only expose this in builds that would actually use it. Not needed on the client.\n+      Object.defineProperties((newFn: any), {\n+        $$FORM_ACTION: {value: this.$$FORM_ACTION},\n+        $$IS_SIGNATURE_EQUAL: {value: isSignatureEqual},\n+        bind: {value: bind},\n+      });\n+    }\n+    knownServerReferences.set(newFn, {id: reference.id, bound: boundPromise});\n   }\n   return newFn;\n }\n \n export function createServerReference<A: Iterable<any>, T>(\n   id: ServerReferenceId,\n   callServer: CallServerCallback,\n+  encodeFormAction?: EncodeFormActionCallback,\n ): (...A) => Promise<T> {\n   const proxy = function (): Promise<T> {\n     // $FlowFixMe[method-unbinding]\n     const args = Array.prototype.slice.call(arguments);\n     return callServer(id, args);\n   };\n-  registerServerReference(proxy, {id, bound: null});\n+  registerServerReference(proxy, {id, bound: null}, encodeFormAction);\n   return proxy;\n }"
            },
            {
                "file": "packages/react-client/src/__tests__/ReactFlight-test.js",
                "git_diff": "@@ -10,6 +10,15 @@\n \n 'use strict';\n \n+function normalizeCodeLocInfo(str) {\n+  return (\n+    str &&\n+    str.replace(/\\n +(?:at|in) ([\\S]+)[^\\n]*/g, function (m, name) {\n+      return '\\n    in ' + name + (/\\d/.test(m) ? ' (at **)' : '');\n+    })\n+  );\n+}\n+\n const heldValues = [];\n let finalizationCallback;\n function FinalizationRegistryMock(callback) {\n@@ -69,6 +78,14 @@ describe('ReactFlight', () => {\n           error,\n         };\n       }\n+      componentDidCatch(error, errorInfo) {\n+        expect(error).toBe(this.state.error);\n+        if (this.props.expectedStack !== undefined) {\n+          expect(normalizeCodeLocInfo(errorInfo.componentStack)).toBe(\n+            this.props.expectedStack,\n+          );\n+        }\n+      }\n       componentDidMount() {\n         expect(this.state.hasError).toBe(true);\n         expect(this.state.error).toBeTruthy();\n@@ -83,7 +100,16 @@ describe('ReactFlight', () => {\n               ' builds to avoid leaking sensitive details. A digest property is included on this error instance which' +\n               ' may provide additional details about the nature of the error.',\n           );\n-          expect(this.state.error.digest).toContain(this.props.expectedMessage);\n+          let expectedDigest = this.props.expectedMessage;\n+          if (\n+            expectedDigest.startsWith('{') ||\n+            expectedDigest.startsWith('<')\n+          ) {\n+            expectedDigest = '{}';\n+          } else if (expectedDigest.startsWith('[')) {\n+            expectedDigest = '[]';\n+          }\n+          expect(this.state.error.digest).toContain(expectedDigest);\n           expect(this.state.error.stack).toBe(\n             'Error: ' + this.state.error.message,\n           );\n@@ -122,32 +148,6 @@ describe('ReactFlight', () => {\n     jest.restoreAllMocks();\n   });\n \n-  function createServerContext(globalName, defaultValue, withStack) {\n-    let ctx;\n-    expect(() => {\n-      ctx = React.createServerContext(globalName, defaultValue);\n-    }).toErrorDev(\n-      'Server Context is deprecated and will soon be removed. ' +\n-        'It was never documented and we have found it not to be useful ' +\n-        'enough to warrant the downside it imposes on all apps.',\n-      {withoutStack: !withStack},\n-    );\n-    return ctx;\n-  }\n-\n-  function createServerServerContext(globalName, defaultValue, withStack) {\n-    let ctx;\n-    expect(() => {\n-      ctx = ReactServer.createServerContext(globalName, defaultValue);\n-    }).toErrorDev(\n-      'Server Context is deprecated and will soon be removed. ' +\n-        'It was never documented and we have found it not to be useful ' +\n-        'enough to warrant the downside it imposes on all apps.',\n-      {withoutStack: !withStack},\n-    );\n-    return ctx;\n-  }\n-\n   function clientReference(value) {\n     return Object.defineProperties(\n       function () {\n@@ -213,12 +213,42 @@ describe('ReactFlight', () => {\n     await act(async () => {\n       const rootModel = await ReactNoopFlightClient.read(transport);\n       const greeting = rootModel.greeting;\n+      expect(greeting._debugInfo).toEqual(\n+        __DEV__ ? [{name: 'Greeting', env: 'Server'}] : undefined,\n+      );\n       ReactNoop.render(greeting);\n     });\n \n     expect(ReactNoop).toMatchRenderedOutput(<span>Hello, Seb Smith</span>);\n   });\n \n+  it('can render a shared forwardRef Component', async () => {\n+    const Greeting = React.forwardRef(function Greeting(\n+      {firstName, lastName},\n+      ref,\n+    ) {\n+      return (\n+        <span ref={ref}>\n+          Hello, {firstName} {lastName}\n+        </span>\n+      );\n+    });\n+\n+    const root = <Greeting firstName=\"Seb\" lastName=\"Smith\" />;\n+\n+    const transport = ReactNoopFlightServer.render(root);\n+\n+    await act(async () => {\n+      const promise = ReactNoopFlightClient.read(transport);\n+      expect(promise._debugInfo).toEqual(\n+        __DEV__ ? [{name: 'Greeting', env: 'Server'}] : undefined,\n+      );\n+      ReactNoop.render(await promise);\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(<span>Hello, Seb Smith</span>);\n+  });\n+\n   it('can render an iterable as an array', async () => {\n     function ItemListClient(props) {\n       return <span>{props.items}</span>;\n@@ -676,7 +706,7 @@ describe('ReactFlight', () => {\n       );\n     }\n     function FunctionProp() {\n-      return <div>{() => {}}</div>;\n+      return <div>{function fn() {}}</div>;\n     }\n     function SymbolProp() {\n       return <div foo={Symbol('foo')} />;\n@@ -694,8 +724,11 @@ describe('ReactFlight', () => {\n         </Client>\n       );\n     }\n+    function FunctionChildrenClient() {\n+      return <Client>{function Component() {}}</Client>;\n+    }\n     function FunctionPropClient() {\n-      return <Client>{() => {}}</Client>;\n+      return <Client foo={() => {}} />;\n     }\n     function SymbolPropClient() {\n       return <Client foo={Symbol('foo')} />;\n@@ -718,6 +751,10 @@ describe('ReactFlight', () => {\n       <EventHandlerPropClient />,\n       options,\n     );\n+    const fnChildrenClient = ReactNoopFlightServer.render(\n+      <FunctionChildrenClient />,\n+      options,\n+    );\n     const fnClient = ReactNoopFlightServer.render(\n       <FunctionPropClient />,\n       options,\n@@ -741,7 +778,9 @@ describe('ReactFlight', () => {\n             </ErrorBoundary>\n             <ErrorBoundary\n               expectedMessage={\n-                'Functions cannot be passed directly to Client Components unless you explicitly expose it by marking it with \"use server\".'\n+                __DEV__\n+                  ? 'Functions are not valid as a child of Client Components. This may happen if you return fn instead of <fn /> from render. Or maybe you meant to call this function rather than return it.'\n+                  : 'Functions cannot be passed directly to Client Components unless you explicitly expose it by marking it with \"use server\".'\n               }>\n               <Render promise={ReactNoopFlightClient.read(fn)} />\n             </ErrorBoundary>\n@@ -754,6 +793,14 @@ describe('ReactFlight', () => {\n             <ErrorBoundary expectedMessage=\"Event handlers cannot be passed to Client Component props.\">\n               <Render promise={ReactNoopFlightClient.read(eventClient)} />\n             </ErrorBoundary>\n+            <ErrorBoundary\n+              expectedMessage={\n+                __DEV__\n+                  ? 'Functions are not valid as a child of Client Components. This may happen if you return Component instead of <Component /> from render. Or maybe you meant to call this function rather than return it.'\n+                  : 'Functions cannot be passed directly to Client Components unless you explicitly expose it by marking it with \"use server\".'\n+              }>\n+              <Render promise={ReactNoopFlightClient.read(fnChildrenClient)} />\n+            </ErrorBoundary>\n             <ErrorBoundary\n               expectedMessage={\n                 'Functions cannot be passed directly to Client Components unless you explicitly expose it by marking it with \"use server\".'\n@@ -772,6 +819,189 @@ describe('ReactFlight', () => {\n     });\n   });\n \n+  it('should emit descriptions of errors in dev', async () => {\n+    const ClientErrorBoundary = clientReference(ErrorBoundary);\n+\n+    function Throw({value}) {\n+      throw value;\n+    }\n+\n+    const testCases = (\n+      <>\n+        <ClientErrorBoundary expectedMessage=\"This is a real Error.\">\n+          <div>\n+            <Throw value={new TypeError('This is a real Error.')} />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary expectedMessage=\"This is a string error.\">\n+          <div>\n+            <Throw value=\"This is a string error.\" />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary expectedMessage=\"{message: ..., extra: ..., nested: ...}\">\n+          <div>\n+            <Throw\n+              value={{\n+                message: 'This is a long message',\n+                extra: 'properties',\n+                nested: {more: 'prop'},\n+              }}\n+            />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary\n+          expectedMessage={'{message: \"Short\", extra: ..., nested: ...}'}>\n+          <div>\n+            <Throw\n+              value={{\n+                message: 'Short',\n+                extra: 'properties',\n+                nested: {more: 'prop'},\n+              }}\n+            />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary expectedMessage=\"Symbol(hello)\">\n+          <div>\n+            <Throw value={Symbol('hello')} />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary expectedMessage=\"123\">\n+          <div>\n+            <Throw value={123} />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary expectedMessage=\"undefined\">\n+          <div>\n+            <Throw value={undefined} />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary expectedMessage=\"<div/>\">\n+          <div>\n+            <Throw value={<div />} />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary expectedMessage=\"function Foo() {}\">\n+          <div>\n+            <Throw value={function Foo() {}} />\n+          </div>\n+        </ClientErrorBoundary>\n+        <ClientErrorBoundary expectedMessage={'[\"array\"]'}>\n+          <div>\n+            <Throw value={['array']} />\n+          </div>\n+        </ClientErrorBoundary>\n+      </>\n+    );\n+\n+    const transport = ReactNoopFlightServer.render(testCases, {\n+      onError(x) {\n+        if (__DEV__) {\n+          return 'a dev digest';\n+        }\n+        if (x instanceof Error) {\n+          return `digest(\"${x.message}\")`;\n+        } else if (Array.isArray(x)) {\n+          return `digest([])`;\n+        } else if (typeof x === 'object' && x !== null) {\n+          return `digest({})`;\n+        }\n+        return `digest(${String(x)})`;\n+      },\n+    });\n+\n+    await act(() => {\n+      startTransition(() => {\n+        ReactNoop.render(ReactNoopFlightClient.read(transport));\n+      });\n+    });\n+  });\n+\n+  it('should include server components in error boundary stacks in dev', async () => {\n+    const ClientErrorBoundary = clientReference(ErrorBoundary);\n+\n+    function Throw({value}) {\n+      throw value;\n+    }\n+\n+    const expectedStack = __DEV__\n+      ? // TODO: This should include Throw but it doesn't have a Fiber.\n+        '\\n    in div' + '\\n    in ErrorBoundary (at **)' + '\\n    in App'\n+      : '\\n    in div' + '\\n    in ErrorBoundary (at **)';\n+\n+    function App() {\n+      return (\n+        <ClientErrorBoundary\n+          expectedMessage=\"This is a real Error.\"\n+          expectedStack={expectedStack}>\n+          <div>\n+            <Throw value={new TypeError('This is a real Error.')} />\n+          </div>\n+        </ClientErrorBoundary>\n+      );\n+    }\n+\n+    const transport = ReactNoopFlightServer.render(<App />, {\n+      onError(x) {\n+        if (__DEV__) {\n+          return 'a dev digest';\n+        }\n+        if (x instanceof Error) {\n+          return `digest(\"${x.message}\")`;\n+        } else if (Array.isArray(x)) {\n+          return `digest([])`;\n+        } else if (typeof x === 'object' && x !== null) {\n+          return `digest({})`;\n+        }\n+        return `digest(${String(x)})`;\n+      },\n+    });\n+\n+    await act(() => {\n+      startTransition(() => {\n+        ReactNoop.render(ReactNoopFlightClient.read(transport));\n+      });\n+    });\n+  });\n+\n+  it('should include server components in warning stacks', async () => {\n+    function Component() {\n+      // Trigger key warning\n+      return <div>{[<span />]}</div>;\n+    }\n+    const ClientComponent = clientReference(Component);\n+\n+    function Indirection({children}) {\n+      return children;\n+    }\n+\n+    function App() {\n+      return (\n+        <Indirection>\n+          <ClientComponent />\n+        </Indirection>\n+      );\n+    }\n+\n+    const transport = ReactNoopFlightServer.render(<App />);\n+\n+    await expect(async () => {\n+      await act(() => {\n+        startTransition(() => {\n+          ReactNoop.render(ReactNoopFlightClient.read(transport));\n+        });\n+      });\n+    }).toErrorDev(\n+      'Each child in a list should have a unique \"key\" prop.\\n' +\n+        '\\n' +\n+        'Check the render method of `Component`. See https://react.dev/link/warning-keys for more information.\\n' +\n+        '    in span (at **)\\n' +\n+        '    in Component (at **)\\n' +\n+        '    in Indirection (at **)\\n' +\n+        '    in App (at **)',\n+    );\n+  });\n+\n   it('should trigger the inner most error boundary inside a Client Component', async () => {\n     function ServerComponent() {\n       throw new Error('This was thrown in the Server Component.');\n@@ -834,8 +1064,8 @@ describe('ReactFlight', () => {\n       'Only plain objects can be passed to Client Components from Server Components. ' +\n         'Objects with toJSON methods are not supported. ' +\n         'Convert it manually to a simple value before passing it to props.\\n' +\n-        '  <input value={{toJSON: function}}>\\n' +\n-        '               ^^^^^^^^^^^^^^^^^^^^',\n+        '  <input value={{toJSON: ...}}>\\n' +\n+        '               ^^^^^^^^^^^^^^^',\n       {withoutStack: true},\n     );\n   });\n@@ -924,8 +1154,8 @@ describe('ReactFlight', () => {\n       'Only plain objects can be passed to Client Components from Server Components. ' +\n         'Objects with toJSON methods are not supported. ' +\n         'Convert it manually to a simple value before passing it to props.\\n' +\n-        '  <>Current date: {{toJSON: function}}</>\\n' +\n-        '                  ^^^^^^^^^^^^^^^^^^^^',\n+        '  <>Current date: {{toJSON: ...}}</>\\n' +\n+        '                  ^^^^^^^^^^^^^^^',\n       {withoutStack: true},\n     );\n   });\n@@ -1021,7 +1251,7 @@ describe('ReactFlight', () => {\n       ReactNoopFlightClient.read(transport);\n     }).toErrorDev(\n       'Each child in a list should have a unique \"key\" prop. ' +\n-        'See https://reactjs.org/link/warning-keys for more information.',\n+        'See https://react.dev/link/warning-keys for more information.',\n     );\n   });\n \n@@ -1042,18 +1272,50 @@ describe('ReactFlight', () => {\n     ]);\n   });\n \n-  it('should warn in DEV if a a client reference is passed to useContext()', () => {\n+  it('should error if useContext is called()', () => {\n+    function ServerComponent() {\n+      return ReactServer.useContext();\n+    }\n+    const errors = [];\n+    ReactNoopFlightServer.render(<ServerComponent />, {\n+      onError(x) {\n+        errors.push(x.message);\n+      },\n+    });\n+    expect(errors).toEqual(['ReactServer.useContext is not a function']);\n+  });\n+\n+  it('should error if a context without a client reference is passed to use()', () => {\n+    const Context = React.createContext();\n+    function ServerComponent() {\n+      return ReactServer.use(Context);\n+    }\n+    const errors = [];\n+    ReactNoopFlightServer.render(<ServerComponent />, {\n+      onError(x) {\n+        errors.push(x.message);\n+      },\n+    });\n+    expect(errors).toEqual([\n+      'Cannot read a Client Context from a Server Component.',\n+    ]);\n+  });\n+\n+  it('should error if a client reference is passed to use()', () => {\n     const Context = React.createContext();\n     const ClientContext = clientReference(Context);\n     function ServerComponent() {\n-      return ReactServer.useContext(ClientContext);\n+      return ReactServer.use(ClientContext);\n     }\n-    expect(() => {\n-      const transport = ReactNoopFlightServer.render(<ServerComponent />);\n-      ReactNoopFlightClient.read(transport);\n-    }).toErrorDev('Cannot read a Client Context from a Server Component.', {\n-      withoutStack: true,\n+    const errors = [];\n+    ReactNoopFlightServer.render(<ServerComponent />, {\n+      onError(x) {\n+        errors.push(x.message);\n+      },\n     });\n+    expect(errors).toEqual([\n+      'Cannot read a Client Context from a Server Component.',\n+    ]);\n   });\n \n   describe('Hooks', () => {\n@@ -1149,440 +1411,86 @@ describe('ReactFlight', () => {\n     });\n   });\n \n-  describe('ServerContext', () => {\n-    // @gate enableServerContext\n-    it('supports basic createServerContext usage', async () => {\n-      const ServerContext = createServerServerContext(\n-        'ServerContext',\n-        'hello from server',\n-      );\n-      function Foo() {\n-        const context = ReactServer.useContext(ServerContext);\n-        return <div>{context}</div>;\n-      }\n-\n-      const transport = ReactNoopFlightServer.render(<Foo />);\n-      await act(async () => {\n-        ReactNoop.render(await ReactNoopFlightClient.read(transport));\n-      });\n+  // @gate enableTaint\n+  it('errors when a tainted object is serialized', async () => {\n+    function UserClient({user}) {\n+      return <span>{user.name}</span>;\n+    }\n+    const User = clientReference(UserClient);\n \n-      expect(ReactNoop).toMatchRenderedOutput(<div>hello from server</div>);\n+    const user = {\n+      name: 'Seb',\n+      age: 'rather not say',\n+    };\n+    ReactServer.experimental_taintObjectReference(\n+      \"Don't pass the raw user object to the client\",\n+      user,\n+    );\n+    const errors = [];\n+    ReactNoopFlightServer.render(<User user={user} />, {\n+      onError(x) {\n+        errors.push(x.message);\n+      },\n     });\n \n-    // @gate enableServerContext\n-    it('propagates ServerContext providers in flight', async () => {\n-      const ServerContext = createServerServerContext(\n-        'ServerContext',\n-        'default',\n-      );\n-\n-      function Foo() {\n-        return (\n-          <div>\n-            <ServerContext.Provider value=\"hi this is server\">\n-              <Bar />\n-            </ServerContext.Provider>\n-          </div>\n-        );\n-      }\n-      function Bar() {\n-        const context = ReactServer.useContext(ServerContext);\n-        return context;\n-      }\n+    expect(errors).toEqual([\"Don't pass the raw user object to the client\"]);\n+  });\n \n-      const transport = ReactNoopFlightServer.render(<Foo />);\n-      await act(async () => {\n-        ReactNoop.render(await ReactNoopFlightClient.read(transport));\n-      });\n+  // @gate enableTaint\n+  it('errors with a specific message when a tainted function is serialized', async () => {\n+    function UserClient({user}) {\n+      return <span>{user.name}</span>;\n+    }\n+    const User = clientReference(UserClient);\n \n-      expect(ReactNoop).toMatchRenderedOutput(<div>hi this is server</div>);\n+    function change() {}\n+    ReactServer.experimental_taintObjectReference(\n+      'A change handler cannot be passed to a client component',\n+      change,\n+    );\n+    const errors = [];\n+    ReactNoopFlightServer.render(<User onChange={change} />, {\n+      onError(x) {\n+        errors.push(x.message);\n+      },\n     });\n \n-    // @gate enableServerContext\n-    it('errors if you try passing JSX through ServerContext value', () => {\n-      const ServerContext = createServerServerContext('ServerContext', {\n-        foo: {\n-          bar: <span>hi this is default</span>,\n-        },\n-      });\n+    expect(errors).toEqual([\n+      'A change handler cannot be passed to a client component',\n+    ]);\n+  });\n \n-      function Foo() {\n-        return (\n-          <div>\n-            <ServerContext.Provider\n-              value={{\n-                foo: {\n-                  bar: <span>hi this is server</span>,\n-                },\n-              }}>\n-              <Bar />\n-            </ServerContext.Provider>\n-          </div>\n-        );\n-      }\n-      function Bar() {\n-        const context = ReactServer.useContext(ServerContext);\n-        return context.foo.bar;\n-      }\n+  // @gate enableTaint\n+  it('errors when a tainted string is serialized', async () => {\n+    function UserClient({user}) {\n+      return <span>{user.name}</span>;\n+    }\n+    const User = clientReference(UserClient);\n \n-      expect(() => {\n-        ReactNoopFlightServer.render(<Foo />);\n-      }).toErrorDev('React elements are not allowed in ServerContext', {\n-        withoutStack: true,\n-      });\n-    });\n+    const process = {\n+      env: {\n+        SECRET: '3e971ecc1485fe78625598bf9b6f85db',\n+      },\n+    };\n+    ReactServer.experimental_taintUniqueValue(\n+      'Cannot pass a secret token to the client',\n+      process,\n+      process.env.SECRET,\n+    );\n \n-    // @gate enableServerContext\n-    it('propagates ServerContext and cleans up the providers in flight', async () => {\n-      const ServerContext = createServerServerContext(\n-        'ServerContext',\n-        'default',\n-      );\n+    const errors = [];\n+    ReactNoopFlightServer.render(<User token={process.env.SECRET} />, {\n+      onError(x) {\n+        errors.push(x.message);\n+      },\n+    });\n \n-      function Foo() {\n-        return (\n-          <>\n-            <ServerContext.Provider value=\"hi this is server outer\">\n-              <ServerContext.Provider value=\"hi this is server\">\n-                <Bar />\n-              </ServerContext.Provider>\n-              <ServerContext.Provider value=\"hi this is server2\">\n-                <Bar />\n-              </ServerContext.Provider>\n-              <Bar />\n-            </ServerContext.Provider>\n-            <ServerContext.Provider value=\"hi this is server outer2\">\n-              <Bar />\n-            </ServerContext.Provider>\n-            <Bar />\n-          </>\n-        );\n-      }\n-      function Bar() {\n-        const context = ReactServer.useContext(ServerContext);\n-        return <span>{context}</span>;\n-      }\n+    expect(errors).toEqual(['Cannot pass a secret token to the client']);\n \n-      const transport = ReactNoopFlightServer.render(<Foo />);\n-      await act(async () => {\n-        ReactNoop.render(await ReactNoopFlightClient.read(transport));\n-      });\n-\n-      expect(ReactNoop).toMatchRenderedOutput(\n-        <>\n-          <span>hi this is server</span>\n-          <span>hi this is server2</span>\n-          <span>hi this is server outer</span>\n-          <span>hi this is server outer2</span>\n-          <span>default</span>\n-        </>,\n-      );\n-    });\n-\n-    // @gate enableServerContext\n-    it('propagates ServerContext providers in flight after suspending', async () => {\n-      const ServerContext = createServerServerContext(\n-        'ServerContext',\n-        'default',\n-      );\n-\n-      function Foo() {\n-        return (\n-          <div>\n-            <ServerContext.Provider value=\"hi this is server\">\n-              <React.Suspense fallback={'Loading'}>\n-                <Bar />\n-              </React.Suspense>\n-            </ServerContext.Provider>\n-          </div>\n-        );\n-      }\n-\n-      let resolve;\n-      const promise = new Promise(res => {\n-        resolve = () => {\n-          promise.unsuspend = true;\n-          res();\n-        };\n-      });\n-\n-      function Bar() {\n-        if (!promise.unsuspend) {\n-          Scheduler.log('suspended');\n-          throw promise;\n-        }\n-        Scheduler.log('rendered');\n-        const context = ReactServer.useContext(ServerContext);\n-        return context;\n-      }\n-\n-      const transport = ReactNoopFlightServer.render(<Foo />);\n-\n-      assertLog(['suspended']);\n-\n-      await act(async () => {\n-        resolve();\n-        await promise;\n-        jest.runAllImmediates();\n-      });\n-\n-      assertLog(['rendered']);\n-\n-      await act(async () => {\n-        ReactNoop.render(await ReactNoopFlightClient.read(transport));\n-      });\n-\n-      expect(ReactNoop).toMatchRenderedOutput(<div>hi this is server</div>);\n-    });\n-\n-    // @gate enableServerContext\n-    it('serializes ServerContext to client', async () => {\n-      const ServerContext = createServerServerContext(\n-        'ServerContext',\n-        'default',\n-      );\n-      const ClientContext = createServerContext('ServerContext', 'default');\n-\n-      function ClientBar() {\n-        Scheduler.log('ClientBar');\n-        const context = React.useContext(ClientContext);\n-        return <span>{context}</span>;\n-      }\n-\n-      const Bar = clientReference(ClientBar);\n-\n-      function Foo() {\n-        return (\n-          <ServerContext.Provider value=\"hi this is server\">\n-            <Bar />\n-          </ServerContext.Provider>\n-        );\n-      }\n-\n-      const model = {\n-        foo: <Foo />,\n-      };\n-\n-      const transport = ReactNoopFlightServer.render(model);\n-\n-      assertLog([]);\n-\n-      await act(async () => {\n-        const flightModel = await ReactNoopFlightClient.read(transport);\n-        ReactNoop.render(flightModel.foo);\n-      });\n-\n-      assertLog(['ClientBar']);\n-      expect(ReactNoop).toMatchRenderedOutput(<span>hi this is server</span>);\n-\n-      expect(() => {\n-        createServerContext('ServerContext', 'default');\n-      }).toThrow('ServerContext: ServerContext already defined');\n-    });\n-\n-    // @gate enableServerContext\n-    it('takes ServerContext from the client for refetching use cases', async () => {\n-      const ServerContext = createServerServerContext(\n-        'ServerContext',\n-        'default',\n-      );\n-      function Bar() {\n-        return <span>{ReactServer.useContext(ServerContext)}</span>;\n-      }\n-      const transport = ReactNoopFlightServer.render(<Bar />, {\n-        context: [['ServerContext', 'Override']],\n-      });\n-\n-      await act(async () => {\n-        const flightModel = await ReactNoopFlightClient.read(transport);\n-        ReactNoop.render(flightModel);\n-      });\n-      expect(ReactNoop).toMatchRenderedOutput(<span>Override</span>);\n-    });\n-\n-    // @gate enableServerContext\n-    it('sets default initial value when defined lazily on server or client', async () => {\n-      let ServerContext;\n-      function inlineLazyServerContextInitialization() {\n-        if (!ServerContext) {\n-          ServerContext = createServerServerContext('ServerContext', 'default');\n-        }\n-        return ServerContext;\n-      }\n-\n-      let ClientContext;\n-      function inlineContextInitialization() {\n-        if (!ClientContext) {\n-          ClientContext = createServerContext('ServerContext', 'default', true);\n-        }\n-        return ClientContext;\n-      }\n-\n-      function ClientBaz() {\n-        const context = inlineContextInitialization();\n-        const value = React.useContext(context);\n-        return <div>{value}</div>;\n-      }\n-\n-      const Baz = clientReference(ClientBaz);\n-\n-      function Bar() {\n-        return (\n-          <article>\n-            <div>\n-              {ReactServer.useContext(inlineLazyServerContextInitialization())}\n-            </div>\n-            <Baz />\n-          </article>\n-        );\n-      }\n-\n-      function ServerApp() {\n-        const Context = inlineLazyServerContextInitialization();\n-        return (\n-          <>\n-            <Context.Provider value=\"test\">\n-              <Bar />\n-            </Context.Provider>\n-            <Bar />\n-          </>\n-        );\n-      }\n-\n-      function ClientApp({serverModel}) {\n-        return (\n-          <>\n-            {serverModel}\n-            <ClientBaz />\n-          </>\n-        );\n-      }\n-\n-      const transport = ReactNoopFlightServer.render(<ServerApp />);\n-\n-      expect(ClientContext).toBe(undefined);\n-\n-      // Reset all modules, except flight-modules which keeps the registry of Client Components\n-      const flightModules = require('react-noop-renderer/flight-modules');\n-      jest.resetModules();\n-      jest.mock('react', () => require('react/react.react-server'));\n-      jest.mock('react-noop-renderer/flight-modules', () => flightModules);\n-\n-      ReactServer = require('react');\n-      ReactNoopFlightServer = require('react-noop-renderer/flight-server');\n-\n-      __unmockReact();\n-      jest.resetModules();\n-      jest.mock('react-noop-renderer/flight-modules', () => flightModules);\n-      React = require('react');\n-      ReactNoop = require('react-noop-renderer');\n-      ReactNoopFlightClient = require('react-noop-renderer/flight-client');\n-      act = require('internal-test-utils').act;\n-      Scheduler = require('scheduler');\n-\n-      await act(async () => {\n-        const serverModel = await ReactNoopFlightClient.read(transport);\n-        ReactNoop.render(<ClientApp serverModel={serverModel} />);\n-      });\n-\n-      expect(ClientContext).not.toBe(ServerContext);\n-\n-      expect(ReactNoop).toMatchRenderedOutput(\n-        <>\n-          <article>\n-            <div>test</div>\n-            <div>test</div>\n-          </article>\n-          <article>\n-            <div>default</div>\n-            <div>default</div>\n-          </article>\n-          <div>default</div>\n-        </>,\n-      );\n-    });\n-  });\n-\n-  // @gate enableTaint\n-  it('errors when a tainted object is serialized', async () => {\n-    function UserClient({user}) {\n-      return <span>{user.name}</span>;\n-    }\n-    const User = clientReference(UserClient);\n-\n-    const user = {\n-      name: 'Seb',\n-      age: 'rather not say',\n-    };\n-    ReactServer.experimental_taintObjectReference(\n-      \"Don't pass the raw user object to the client\",\n-      user,\n-    );\n-    const errors = [];\n-    ReactNoopFlightServer.render(<User user={user} />, {\n-      onError(x) {\n-        errors.push(x.message);\n-      },\n-    });\n-\n-    expect(errors).toEqual([\"Don't pass the raw user object to the client\"]);\n-  });\n-\n-  // @gate enableTaint\n-  it('errors with a specific message when a tainted function is serialized', async () => {\n-    function UserClient({user}) {\n-      return <span>{user.name}</span>;\n-    }\n-    const User = clientReference(UserClient);\n-\n-    function change() {}\n-    ReactServer.experimental_taintObjectReference(\n-      'A change handler cannot be passed to a client component',\n-      change,\n-    );\n-    const errors = [];\n-    ReactNoopFlightServer.render(<User onChange={change} />, {\n-      onError(x) {\n-        errors.push(x.message);\n-      },\n-    });\n-\n-    expect(errors).toEqual([\n-      'A change handler cannot be passed to a client component',\n-    ]);\n-  });\n-\n-  // @gate enableTaint\n-  it('errors when a tainted string is serialized', async () => {\n-    function UserClient({user}) {\n-      return <span>{user.name}</span>;\n-    }\n-    const User = clientReference(UserClient);\n-\n-    const process = {\n-      env: {\n-        SECRET: '3e971ecc1485fe78625598bf9b6f85db',\n-      },\n-    };\n-    ReactServer.experimental_taintUniqueValue(\n-      'Cannot pass a secret token to the client',\n-      process,\n-      process.env.SECRET,\n-    );\n-\n-    const errors = [];\n-    ReactNoopFlightServer.render(<User token={process.env.SECRET} />, {\n-      onError(x) {\n-        errors.push(x.message);\n-      },\n-    });\n-\n-    expect(errors).toEqual(['Cannot pass a secret token to the client']);\n-\n-    // This just ensures the process object is kept alive for the life time of\n-    // the test since we're simulating a global as an example.\n-    expect(process.env.SECRET).toBe('3e971ecc1485fe78625598bf9b6f85db');\n-  });\n+    // This just ensures the process object is kept alive for the life time of\n+    // the test since we're simulating a global as an example.\n+    expect(process.env.SECRET).toBe('3e971ecc1485fe78625598bf9b6f85db');\n+  });\n \n   // @gate enableTaint\n   it('errors when a tainted bigint is serialized', async () => {\n@@ -1700,4 +1608,534 @@ describe('ReactFlight', () => {\n \n     expect(errors).toEqual([]);\n   });\n+\n+  // @gate enableServerComponentKeys\n+  it('preserves state when keying a server component', async () => {\n+    function StatefulClient({name}) {\n+      const [state] = React.useState(name.toLowerCase());\n+      return state;\n+    }\n+    const Stateful = clientReference(StatefulClient);\n+\n+    function Item({item}) {\n+      return (\n+        <div>\n+          {item}\n+          <Stateful name={item} />\n+        </div>\n+      );\n+    }\n+\n+    function Items({items}) {\n+      return items.map(item => {\n+        return <Item key={item} item={item} />;\n+      });\n+    }\n+\n+    const transport = ReactNoopFlightServer.render(\n+      <Items items={['A', 'B', 'C']} />,\n+    );\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport));\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <>\n+        <div>Aa</div>\n+        <div>Bb</div>\n+        <div>Cc</div>\n+      </>,\n+    );\n+\n+    const transport2 = ReactNoopFlightServer.render(\n+      <Items items={['B', 'A', 'D', 'C']} />,\n+    );\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport2));\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <>\n+        <div>Bb</div>\n+        <div>Aa</div>\n+        <div>Dd</div>\n+        <div>Cc</div>\n+      </>,\n+    );\n+  });\n+\n+  // @gate enableServerComponentKeys\n+  it('does not inherit keys of children inside a server component', async () => {\n+    function StatefulClient({name, initial}) {\n+      const [state] = React.useState(initial);\n+      return state;\n+    }\n+    const Stateful = clientReference(StatefulClient);\n+\n+    function Item({item, initial}) {\n+      // This key is the key of the single item of this component.\n+      // It's NOT part of the key of the list the parent component is\n+      // in.\n+      return (\n+        <div key={item}>\n+          {item}\n+          <Stateful name={item} initial={initial} />\n+        </div>\n+      );\n+    }\n+\n+    function IndirectItem({item, initial}) {\n+      // Even though we render two items with the same child key this key\n+      // should not conflict, because the key belongs to the parent slot.\n+      return <Item key=\"parent\" item={item} initial={initial} />;\n+    }\n+\n+    // These items don't have their own keys because they're in a fixed set\n+    const transport = ReactNoopFlightServer.render(\n+      <>\n+        <Item item=\"A\" initial={1} />\n+        <Item item=\"B\" initial={2} />\n+        <IndirectItem item=\"C\" initial={5} />\n+        <IndirectItem item=\"C\" initial={6} />\n+      </>,\n+    );\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport));\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <>\n+        <div>A1</div>\n+        <div>B2</div>\n+        <div>C5</div>\n+        <div>C6</div>\n+      </>,\n+    );\n+\n+    // This means that they shouldn't swap state when the properties update\n+    const transport2 = ReactNoopFlightServer.render(\n+      <>\n+        <Item item=\"B\" initial={3} />\n+        <Item item=\"A\" initial={4} />\n+        <IndirectItem item=\"C\" initial={7} />\n+        <IndirectItem item=\"C\" initial={8} />\n+      </>,\n+    );\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport2));\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <>\n+        <div>B3</div>\n+        <div>A4</div>\n+        <div>C5</div>\n+        <div>C6</div>\n+      </>,\n+    );\n+  });\n+\n+  // @gate enableServerComponentKeys\n+  it('shares state between single return and array return in a parent', async () => {\n+    function StatefulClient({name, initial}) {\n+      const [state] = React.useState(initial);\n+      return state;\n+    }\n+    const Stateful = clientReference(StatefulClient);\n+\n+    function Item({item, initial}) {\n+      // This key is the key of the single item of this component.\n+      // It's NOT part of the key of the list the parent component is\n+      // in.\n+      return (\n+        <span key={item}>\n+          {item}\n+          <Stateful name={item} initial={initial} />\n+        </span>\n+      );\n+    }\n+\n+    function Condition({condition}) {\n+      if (condition) {\n+        return <Item item=\"A\" initial={1} />;\n+      }\n+      // The first item in the fragment is the same as the single item.\n+      return (\n+        <>\n+          <Item item=\"A\" initial={2} />\n+          <Item item=\"B\" initial={3} />\n+        </>\n+      );\n+    }\n+\n+    function ConditionPlain({condition}) {\n+      if (condition) {\n+        return (\n+          <span>\n+            C\n+            <Stateful name=\"C\" initial={1} />\n+          </span>\n+        );\n+      }\n+      // The first item in the fragment is the same as the single item.\n+      return (\n+        <>\n+          <span>\n+            C\n+            <Stateful name=\"C\" initial={2} />\n+          </span>\n+          <span>\n+            D\n+            <Stateful name=\"D\" initial={3} />\n+          </span>\n+        </>\n+      );\n+    }\n+\n+    const transport = ReactNoopFlightServer.render(\n+      // This two item wrapper ensures we're already one step inside an array.\n+      // A single item is not the same as a set when it's nested one level.\n+      <>\n+        <div>\n+          <Condition condition={true} />\n+        </div>\n+        <div>\n+          <ConditionPlain condition={true} />\n+        </div>\n+        <div key=\"keyed\">\n+          <ConditionPlain condition={true} />\n+        </div>\n+      </>,\n+    );\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport));\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <>\n+        <div>\n+          <span>A1</span>\n+        </div>\n+        <div>\n+          <span>C1</span>\n+        </div>\n+        <div>\n+          <span>C1</span>\n+        </div>\n+      </>,\n+    );\n+\n+    const transport2 = ReactNoopFlightServer.render(\n+      <>\n+        <div>\n+          <Condition condition={false} />\n+        </div>\n+        <div>\n+          <ConditionPlain condition={false} />\n+        </div>\n+        {null}\n+        <div key=\"keyed\">\n+          <ConditionPlain condition={false} />\n+        </div>\n+      </>,\n+    );\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport2));\n+    });\n+\n+    // We're intentionally breaking from the semantics here for efficiency of the protocol.\n+    // In the case a Server Component inside a fragment is itself implicitly keyed but its\n+    // return value has a key, then we need a wrapper fragment. This means they can't\n+    // reconcile. To solve this we would need to add a wrapper fragment to every Server\n+    // Component just in case it returns a fragment later which is a lot.\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <>\n+        <div>\n+          <span>A2{/* This should be A1 ideally */}</span>\n+          <span>B3</span>\n+        </div>\n+        <div>\n+          <span>C1</span>\n+          <span>D3</span>\n+        </div>\n+        <div>\n+          <span>C1</span>\n+          <span>D3</span>\n+        </div>\n+      </>,\n+    );\n+  });\n+\n+  it('shares state between single return and array return in a set', async () => {\n+    function StatefulClient({name, initial}) {\n+      const [state] = React.useState(initial);\n+      return state;\n+    }\n+    const Stateful = clientReference(StatefulClient);\n+\n+    function Item({item, initial}) {\n+      // This key is the key of the single item of this component.\n+      // It's NOT part of the key of the list the parent component is\n+      // in.\n+      return (\n+        <span key={item}>\n+          {item}\n+          <Stateful name={item} initial={initial} />\n+        </span>\n+      );\n+    }\n+\n+    function Condition({condition}) {\n+      if (condition) {\n+        return <Item item=\"A\" initial={1} />;\n+      }\n+      // The first item in the fragment is the same as the single item.\n+      return (\n+        <>\n+          <Item item=\"A\" initial={2} />\n+          <Item item=\"B\" initial={3} />\n+        </>\n+      );\n+    }\n+\n+    function ConditionPlain({condition}) {\n+      if (condition) {\n+        return (\n+          <span>\n+            C\n+            <Stateful name=\"C\" initial={1} />\n+          </span>\n+        );\n+      }\n+      // The first item in the fragment is the same as the single item.\n+      return (\n+        <>\n+          <span>\n+            C\n+            <Stateful name=\"C\" initial={2} />\n+          </span>\n+          <span>\n+            D\n+            <Stateful name=\"D\" initial={3} />\n+          </span>\n+        </>\n+      );\n+    }\n+\n+    const transport = ReactNoopFlightServer.render(\n+      // This two item wrapper ensures we're already one step inside an array.\n+      // A single item is not the same as a set when it's nested one level.\n+      <div>\n+        <Condition condition={true} />\n+        <ConditionPlain condition={true} />\n+        <ConditionPlain key=\"keyed\" condition={true} />\n+      </div>,\n+    );\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport));\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <div>\n+        <span>A1</span>\n+        <span>C1</span>\n+        <span>C1</span>\n+      </div>,\n+    );\n+\n+    const transport2 = ReactNoopFlightServer.render(\n+      <div>\n+        <Condition condition={false} />\n+        <ConditionPlain condition={false} />\n+        {null}\n+        <ConditionPlain key=\"keyed\" condition={false} />\n+      </div>,\n+    );\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport2));\n+    });\n+\n+    // We're intentionally breaking from the semantics here for efficiency of the protocol.\n+    // The issue with this test scenario is that when the Server Component is in a set,\n+    // the next slot can't be conditionally a fragment or single. That would require wrapping\n+    // in an additional fragment for every single child just in case it every expands to a\n+    // fragment.\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <div>\n+        <span>A2{/* Should be A1 */}</span>\n+        <span>B3</span>\n+        <span>C2{/* Should be C1 */}</span>\n+        <span>D3</span>\n+        <span>C2{/* Should be C1 */}</span>\n+        <span>D3</span>\n+      </div>,\n+    );\n+  });\n+\n+  // @gate enableServerComponentKeys\n+  it('preserves state with keys split across async work', async () => {\n+    let resolve;\n+    const promise = new Promise(r => (resolve = r));\n+\n+    function StatefulClient({name}) {\n+      const [state] = React.useState(name.toLowerCase());\n+      return state;\n+    }\n+    const Stateful = clientReference(StatefulClient);\n+\n+    function Item({name}) {\n+      if (name === 'A') {\n+        return promise.then(() => (\n+          <div>\n+            {name}\n+            <Stateful name={name} />\n+          </div>\n+        ));\n+      }\n+      return (\n+        <div>\n+          {name}\n+          <Stateful name={name} />\n+        </div>\n+      );\n+    }\n+\n+    const transport = ReactNoopFlightServer.render([\n+      <Item key=\"a\" name=\"A\" />,\n+      null,\n+    ]);\n+\n+    // Create a gap in the stream\n+    await resolve();\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport));\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(<div>Aa</div>);\n+\n+    const transport2 = ReactNoopFlightServer.render([\n+      null,\n+      <Item key=\"a\" name=\"B\" />,\n+    ]);\n+\n+    await act(async () => {\n+      ReactNoop.render(await ReactNoopFlightClient.read(transport2));\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(<div>Ba</div>);\n+  });\n+\n+  it('preserves debug info for server-to-server pass through', async () => {\n+    function ThirdPartyLazyComponent() {\n+      return <span>!</span>;\n+    }\n+\n+    const lazy = React.lazy(async () => ({\n+      default: <ThirdPartyLazyComponent />,\n+    }));\n+\n+    function ThirdPartyComponent() {\n+      return <span>stranger</span>;\n+    }\n+\n+    function ServerComponent({transport}) {\n+      // This is a Server Component that receives other Server Components from a third party.\n+      const children = ReactNoopFlightClient.read(transport);\n+      return <div>Hello, {children}</div>;\n+    }\n+\n+    const promiseComponent = Promise.resolve(<ThirdPartyComponent />);\n+\n+    const thirdPartyTransport = ReactNoopFlightServer.render(\n+      [promiseComponent, lazy],\n+      {\n+        environmentName: 'third-party',\n+      },\n+    );\n+\n+    // Wait for the lazy component to initialize\n+    await 0;\n+\n+    const transport = ReactNoopFlightServer.render(\n+      <ServerComponent transport={thirdPartyTransport} />,\n+    );\n+\n+    await act(async () => {\n+      const promise = ReactNoopFlightClient.read(transport);\n+      expect(promise._debugInfo).toEqual(\n+        __DEV__ ? [{name: 'ServerComponent', env: 'Server'}] : undefined,\n+      );\n+      const result = await promise;\n+      const thirdPartyChildren = await result.props.children[1];\n+      // We expect the debug info to be transferred from the inner stream to the outer.\n+      expect(thirdPartyChildren[0]._debugInfo).toEqual(\n+        __DEV__\n+          ? [{name: 'ThirdPartyComponent', env: 'third-party'}]\n+          : undefined,\n+      );\n+      expect(thirdPartyChildren[1]._debugInfo).toEqual(\n+        __DEV__\n+          ? [{name: 'ThirdPartyLazyComponent', env: 'third-party'}]\n+          : undefined,\n+      );\n+      ReactNoop.render(result);\n+    });\n+\n+    expect(ReactNoop).toMatchRenderedOutput(\n+      <div>\n+        Hello, <span>stranger</span>\n+        <span>!</span>\n+      </div>,\n+    );\n+  });\n+\n+  // @gate enableServerComponentLogs && __DEV__\n+  it('replays logs, but not onError logs', async () => {\n+    function foo() {\n+      return 'hello';\n+    }\n+    function ServerComponent() {\n+      console.log('hi', {prop: 123, fn: foo});\n+      throw new Error('err');\n+    }\n+\n+    let transport;\n+    expect(() => {\n+      // Reset the modules so that we get a new overridden console on top of the\n+      // one installed by expect. This ensures that we still emit console.error\n+      // calls.\n+      jest.resetModules();\n+      jest.mock('react', () => require('react/react.react-server'));\n+      ReactServer = require('react');\n+      ReactNoopFlightServer = require('react-noop-renderer/flight-server');\n+      transport = ReactNoopFlightServer.render({root: <ServerComponent />});\n+    }).toErrorDev('err');\n+\n+    const log = console.log;\n+    try {\n+      console.log = jest.fn();\n+      // The error should not actually get logged because we're not awaiting the root\n+      // so it's not thrown but the server log also shouldn't be replayed.\n+      await ReactNoopFlightClient.read(transport);\n+\n+      expect(console.log).toHaveBeenCalledTimes(1);\n+      expect(console.log.mock.calls[0][0]).toBe('hi');\n+      expect(console.log.mock.calls[0][1].prop).toBe(123);\n+      const loggedFn = console.log.mock.calls[0][1].fn;\n+      expect(typeof loggedFn).toBe('function');\n+      expect(loggedFn).not.toBe(foo);\n+      expect(loggedFn.toString()).toBe(foo.toString());\n+    } finally {\n+      console.log = log;\n+    }\n+  });\n });"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.custom.js",
                "git_diff": "@@ -47,3 +47,5 @@ export opaque type StringDecoder = mixed; // eslint-disable-line no-undef\n export const createStringDecoder = $$$config.createStringDecoder;\n export const readPartialStringChunk = $$$config.readPartialStringChunk;\n export const readFinalStringChunk = $$$config.readFinalStringChunk;\n+\n+export const printToConsole = $$$config.printToConsole;"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-browser-esm.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigBrowser';\n+export * from 'react-client/src/ReactFlightClientStreamConfigWeb';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigBrowser';\n export * from 'react-server-dom-esm/src/ReactFlightClientConfigBundlerESM';\n export * from 'react-server-dom-esm/src/ReactFlightClientConfigTargetESMBrowser';\n export * from 'react-dom-bindings/src/shared/ReactFlightClientConfigDOM';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-browser-turbopack.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigBrowser';\n+export * from 'react-client/src/ReactFlightClientStreamConfigWeb';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigBrowser';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigBundlerTurbopack';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigBundlerTurbopackBrowser';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigTargetTurbopackBrowser';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-browser.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigBrowser';\n+export * from 'react-client/src/ReactFlightClientStreamConfigWeb';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigBrowser';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigBundlerWebpack';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigBundlerWebpackBrowser';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigTargetWebpackBrowser';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-bun.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigBrowser';\n+export * from 'react-client/src/ReactFlightClientStreamConfigWeb';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigPlain';\n export * from 'react-dom-bindings/src/shared/ReactFlightClientConfigDOM';\n \n export type Response = any;"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-edge-turbopack.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigBrowser';\n+export * from 'react-client/src/ReactFlightClientStreamConfigWeb';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigServer';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigBundlerTurbopack';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigBundlerTurbopackServer';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigTargetTurbopackServer';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-edge-webpack.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigBrowser';\n+export * from 'react-client/src/ReactFlightClientStreamConfigWeb';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigServer';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigBundlerWebpack';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigBundlerWebpackServer';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigTargetWebpackServer';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-fb-experimental.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigBrowser';\n+export * from 'react-client/src/ReactFlightClientStreamConfigWeb';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigPlain';\n export * from 'react-dom-bindings/src/shared/ReactFlightClientConfigDOM';\n export * from 'react-server-dom-fb/src/ReactFlightClientConfigFBBundler';\n "
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-legacy.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigBrowser';\n+export * from 'react-client/src/ReactFlightClientStreamConfigWeb';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigBrowser';\n export * from 'react-dom-bindings/src/shared/ReactFlightClientConfigDOM';\n \n export type Response = any;"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-node-esm.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigNode';\n+export * from 'react-client/src/ReactFlightClientStreamConfigNode';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigServer';\n export * from 'react-server-dom-esm/src/ReactFlightClientConfigBundlerESM';\n export * from 'react-server-dom-esm/src/ReactFlightClientConfigTargetESMServer';\n export * from 'react-dom-bindings/src/shared/ReactFlightClientConfigDOM';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-node-turbopack-bundled.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigNode';\n+export * from 'react-client/src/ReactFlightClientStreamConfigNode';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigServer';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigBundlerTurbopack';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigBundlerTurbopackServer';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigTargetTurbopackServer';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-node-turbopack.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigNode';\n+export * from 'react-client/src/ReactFlightClientStreamConfigNode';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigServer';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigBundlerNode';\n export * from 'react-server-dom-turbopack/src/ReactFlightClientConfigTargetTurbopackServer';\n export * from 'react-dom-bindings/src/shared/ReactFlightClientConfigDOM';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-node-webpack.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigNode';\n+export * from 'react-client/src/ReactFlightClientStreamConfigNode';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigServer';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigBundlerWebpack';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigBundlerWebpackServer';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigTargetWebpackServer';"
            },
            {
                "file": "packages/react-client/src/forks/ReactFlightClientConfig.dom-node.js",
                "git_diff": "@@ -7,7 +7,8 @@\n  * @flow\n  */\n \n-export * from 'react-client/src/ReactFlightClientConfigNode';\n+export * from 'react-client/src/ReactFlightClientStreamConfigNode';\n+export * from 'react-client/src/ReactFlightClientConsoleConfigServer';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigBundlerNode';\n export * from 'react-server-dom-webpack/src/ReactFlightClientConfigTargetWebpackServer';\n export * from 'react-dom-bindings/src/shared/ReactFlightClientConfigDOM';"
            },
            {
                "file": "packages/react-debug-tools/package.json",
                "git_diff": "@@ -6,7 +6,7 @@\n   \"keywords\": [\n     \"react\"\n   ],\n-  \"homepage\": \"https://reactjs.org/\",\n+  \"homepage\": \"https://react.dev/\",\n   \"bugs\": \"https://github.com/facebook/react/issues\",\n   \"license\": \"MIT\",\n   \"files\": [\n@@ -28,6 +28,6 @@\n     \"react\": \"^17.0.0\"\n   },\n   \"dependencies\": {\n-    \"error-stack-parser\": \"^2.0.2\"\n+    \"error-stack-parser\": \"^2.1.4\"\n   }\n }"
            },
            {
                "file": "packages/react-debug-tools/src/ReactDebugHooks.js",
                "git_diff": "@@ -8,9 +8,12 @@\n  */\n \n import type {\n+  Awaited,\n   ReactContext,\n-  ReactProviderType,\n   StartTransitionOptions,\n+  Usable,\n+  Thenable,\n+  ReactDebugInfo,\n } from 'shared/ReactTypes';\n import type {\n   Fiber,\n@@ -26,16 +29,21 @@ import {\n   ContextProvider,\n   ForwardRef,\n } from 'react-reconciler/src/ReactWorkTags';\n-import {REACT_MEMO_CACHE_SENTINEL} from 'shared/ReactSymbols';\n+import {\n+  REACT_MEMO_CACHE_SENTINEL,\n+  REACT_CONTEXT_TYPE,\n+} from 'shared/ReactSymbols';\n \n type CurrentDispatcherRef = typeof ReactSharedInternals.ReactCurrentDispatcher;\n \n // Used to track hooks called during a render\n \n type HookLogEntry = {\n+  displayName: string | null,\n   primitive: string,\n   stackError: Error,\n   value: mixed,\n+  debugInfo: ReactDebugInfo | null,\n };\n \n let hookLog: Array<HookLogEntry> = [];\n@@ -75,11 +83,47 @@ function getPrimitiveStackCache(): Map<string, Array<any>> {\n       Dispatcher.useImperativeHandle(undefined, () => null);\n       Dispatcher.useDebugValue(null);\n       Dispatcher.useCallback(() => {});\n+      Dispatcher.useTransition();\n+      Dispatcher.useSyncExternalStore(\n+        () => () => {},\n+        () => null,\n+        () => null,\n+      );\n+      Dispatcher.useDeferredValue(null);\n       Dispatcher.useMemo(() => null);\n       if (typeof Dispatcher.useMemoCache === 'function') {\n         // This type check is for Flow only.\n         Dispatcher.useMemoCache(0);\n       }\n+      if (typeof Dispatcher.useOptimistic === 'function') {\n+        // This type check is for Flow only.\n+        Dispatcher.useOptimistic(null, (s: mixed, a: mixed) => s);\n+      }\n+      if (typeof Dispatcher.useFormState === 'function') {\n+        // This type check is for Flow only.\n+        Dispatcher.useFormState((s: mixed, p: mixed) => s, null);\n+      }\n+      if (typeof Dispatcher.use === 'function') {\n+        // This type check is for Flow only.\n+        Dispatcher.use(\n+          ({\n+            $$typeof: REACT_CONTEXT_TYPE,\n+            _currentValue: null,\n+          }: any),\n+        );\n+        Dispatcher.use({\n+          then() {},\n+          status: 'fulfilled',\n+          value: null,\n+        });\n+        try {\n+          Dispatcher.use(\n+            ({\n+              then() {},\n+            }: any),\n+          );\n+        } catch (x) {}\n+      }\n     } finally {\n       readHookLog = hookLog;\n       hookLog = [];\n@@ -109,18 +153,77 @@ function readContext<T>(context: ReactContext<T>): T {\n   return context._currentValue;\n }\n \n-function use<T>(): T {\n-  // TODO: What should this do if it receives an unresolved promise?\n-  throw new Error(\n-    'Support for `use` not yet implemented in react-debug-tools.',\n-  );\n+const SuspenseException: mixed = new Error(\n+  \"Suspense Exception: This is not a real error! It's an implementation \" +\n+    'detail of `use` to interrupt the current render. You must either ' +\n+    'rethrow it immediately, or move the `use` call outside of the ' +\n+    '`try/catch` block. Capturing without rethrowing will lead to ' +\n+    'unexpected behavior.\\n\\n' +\n+    'To handle async errors, wrap your component in an error boundary, or ' +\n+    \"call the promise's `.catch` method and pass the result to `use`\",\n+);\n+\n+function use<T>(usable: Usable<T>): T {\n+  if (usable !== null && typeof usable === 'object') {\n+    // $FlowFixMe[method-unbinding]\n+    if (typeof usable.then === 'function') {\n+      const thenable: Thenable<any> = (usable: any);\n+      switch (thenable.status) {\n+        case 'fulfilled': {\n+          const fulfilledValue: T = thenable.value;\n+          hookLog.push({\n+            displayName: null,\n+            primitive: 'Promise',\n+            stackError: new Error(),\n+            value: fulfilledValue,\n+            debugInfo:\n+              thenable._debugInfo === undefined ? null : thenable._debugInfo,\n+          });\n+          return fulfilledValue;\n+        }\n+        case 'rejected': {\n+          const rejectedError = thenable.reason;\n+          throw rejectedError;\n+        }\n+      }\n+      // If this was an uncached Promise we have to abandon this attempt\n+      // but we can still emit anything up until this point.\n+      hookLog.push({\n+        displayName: null,\n+        primitive: 'Unresolved',\n+        stackError: new Error(),\n+        value: thenable,\n+        debugInfo:\n+          thenable._debugInfo === undefined ? null : thenable._debugInfo,\n+      });\n+      throw SuspenseException;\n+    } else if (usable.$$typeof === REACT_CONTEXT_TYPE) {\n+      const context: ReactContext<T> = (usable: any);\n+      const value = readContext(context);\n+\n+      hookLog.push({\n+        displayName: context.displayName || 'Context',\n+        primitive: 'Context (use)',\n+        stackError: new Error(),\n+        value,\n+        debugInfo: null,\n+      });\n+\n+      return value;\n+    }\n+  }\n+\n+  // eslint-disable-next-line react-internal/safe-string-coercion\n+  throw new Error('An unsupported type was passed to use(): ' + String(usable));\n }\n \n function useContext<T>(context: ReactContext<T>): T {\n   hookLog.push({\n+    displayName: context.displayName || null,\n     primitive: 'Context',\n     stackError: new Error(),\n     value: context._currentValue,\n+    debugInfo: null,\n   });\n   return context._currentValue;\n }\n@@ -136,7 +239,13 @@ function useState<S>(\n       ? // $FlowFixMe[incompatible-use]: Flow doesn't like mixed types\n         initialState()\n       : initialState;\n-  hookLog.push({primitive: 'State', stackError: new Error(), value: state});\n+  hookLog.push({\n+    displayName: null,\n+    primitive: 'State',\n+    stackError: new Error(),\n+    value: state,\n+    debugInfo: null,\n+  });\n   return [state, (action: BasicStateAction<S>) => {}];\n }\n \n@@ -153,9 +262,11 @@ function useReducer<S, I, A>(\n     state = init !== undefined ? init(initialArg) : ((initialArg: any): S);\n   }\n   hookLog.push({\n+    displayName: null,\n     primitive: 'Reducer',\n     stackError: new Error(),\n     value: state,\n+    debugInfo: null,\n   });\n   return [state, (action: A) => {}];\n }\n@@ -164,19 +275,23 @@ function useRef<T>(initialValue: T): {current: T} {\n   const hook = nextHook();\n   const ref = hook !== null ? hook.memoizedState : {current: initialValue};\n   hookLog.push({\n+    displayName: null,\n     primitive: 'Ref',\n     stackError: new Error(),\n     value: ref.current,\n+    debugInfo: null,\n   });\n   return ref;\n }\n \n function useCacheRefresh(): () => void {\n   const hook = nextHook();\n   hookLog.push({\n+    displayName: null,\n     primitive: 'CacheRefresh',\n     stackError: new Error(),\n     value: hook !== null ? hook.memoizedState : function refresh() {},\n+    debugInfo: null,\n   });\n   return () => {};\n }\n@@ -187,9 +302,11 @@ function useLayoutEffect(\n ): void {\n   nextHook();\n   hookLog.push({\n+    displayName: null,\n     primitive: 'LayoutEffect',\n     stackError: new Error(),\n     value: create,\n+    debugInfo: null,\n   });\n }\n \n@@ -199,9 +316,11 @@ function useInsertionEffect(\n ): void {\n   nextHook();\n   hookLog.push({\n+    displayName: null,\n     primitive: 'InsertionEffect',\n     stackError: new Error(),\n     value: create,\n+    debugInfo: null,\n   });\n }\n \n@@ -210,7 +329,13 @@ function useEffect(\n   inputs: Array<mixed> | void | null,\n ): void {\n   nextHook();\n-  hookLog.push({primitive: 'Effect', stackError: new Error(), value: create});\n+  hookLog.push({\n+    displayName: null,\n+    primitive: 'Effect',\n+    stackError: new Error(),\n+    value: create,\n+    debugInfo: null,\n+  });\n }\n \n function useImperativeHandle<T>(\n@@ -228,26 +353,32 @@ function useImperativeHandle<T>(\n     instance = ref.current;\n   }\n   hookLog.push({\n+    displayName: null,\n     primitive: 'ImperativeHandle',\n     stackError: new Error(),\n     value: instance,\n+    debugInfo: null,\n   });\n }\n \n function useDebugValue(value: any, formatterFn: ?(value: any) => any) {\n   hookLog.push({\n+    displayName: null,\n     primitive: 'DebugValue',\n     stackError: new Error(),\n     value: typeof formatterFn === 'function' ? formatterFn(value) : value,\n+    debugInfo: null,\n   });\n }\n \n function useCallback<T>(callback: T, inputs: Array<mixed> | void | null): T {\n   const hook = nextHook();\n   hookLog.push({\n+    displayName: null,\n     primitive: 'Callback',\n     stackError: new Error(),\n     value: hook !== null ? hook.memoizedState[0] : callback,\n+    debugInfo: null,\n   });\n   return callback;\n }\n@@ -258,7 +389,13 @@ function useMemo<T>(\n ): T {\n   const hook = nextHook();\n   const value = hook !== null ? hook.memoizedState[0] : nextCreate();\n-  hookLog.push({primitive: 'Memo', stackError: new Error(), value});\n+  hookLog.push({\n+    displayName: null,\n+    primitive: 'Memo',\n+    stackError: new Error(),\n+    value,\n+    debugInfo: null,\n+  });\n   return value;\n }\n \n@@ -274,9 +411,11 @@ function useSyncExternalStore<T>(\n   nextHook(); // Effect\n   const value = getSnapshot();\n   hookLog.push({\n+    displayName: null,\n     primitive: 'SyncExternalStore',\n     stackError: new Error(),\n     value,\n+    debugInfo: null,\n   });\n   return value;\n }\n@@ -288,22 +427,29 @@ function useTransition(): [\n   // useTransition() composes multiple hooks internally.\n   // Advance the current hook index the same number of times\n   // so that subsequent hooks have the right memoized state.\n-  nextHook(); // State\n+  const stateHook = nextHook();\n   nextHook(); // Callback\n+\n+  const isPending = stateHook !== null ? stateHook.memoizedState : false;\n+\n   hookLog.push({\n+    displayName: null,\n     primitive: 'Transition',\n     stackError: new Error(),\n-    value: undefined,\n+    value: isPending,\n+    debugInfo: null,\n   });\n-  return [false, callback => {}];\n+  return [isPending, () => {}];\n }\n \n function useDeferredValue<T>(value: T, initialValue?: T): T {\n   const hook = nextHook();\n   hookLog.push({\n+    displayName: null,\n     primitive: 'DeferredValue',\n     stackError: new Error(),\n     value: hook !== null ? hook.memoizedState : value,\n+    debugInfo: null,\n   });\n   return value;\n }\n@@ -312,9 +458,11 @@ function useId(): string {\n   const hook = nextHook();\n   const id = hook !== null ? hook.memoizedState : '';\n   hookLog.push({\n+    displayName: null,\n     primitive: 'Id',\n     stackError: new Error(),\n     value: id,\n+    debugInfo: null,\n   });\n   return id;\n }\n@@ -348,6 +496,93 @@ function useMemoCache(size: number): Array<any> {\n   return data;\n }\n \n+function useOptimistic<S, A>(\n+  passthrough: S,\n+  reducer: ?(S, A) => S,\n+): [S, (A) => void] {\n+  const hook = nextHook();\n+  let state;\n+  if (hook !== null) {\n+    state = hook.memoizedState;\n+  } else {\n+    state = passthrough;\n+  }\n+  hookLog.push({\n+    displayName: null,\n+    primitive: 'Optimistic',\n+    stackError: new Error(),\n+    value: state,\n+    debugInfo: null,\n+  });\n+  return [state, (action: A) => {}];\n+}\n+\n+function useFormState<S, P>(\n+  action: (Awaited<S>, P) => S,\n+  initialState: Awaited<S>,\n+  permalink?: string,\n+): [Awaited<S>, (P) => void] {\n+  const hook = nextHook(); // FormState\n+  nextHook(); // ActionQueue\n+  const stackError = new Error();\n+  let value;\n+  let debugInfo = null;\n+  let error = null;\n+\n+  if (hook !== null) {\n+    const actionResult = hook.memoizedState;\n+    if (\n+      typeof actionResult === 'object' &&\n+      actionResult !== null &&\n+      // $FlowFixMe[method-unbinding]\n+      typeof actionResult.then === 'function'\n+    ) {\n+      const thenable: Thenable<Awaited<S>> = (actionResult: any);\n+      switch (thenable.status) {\n+        case 'fulfilled': {\n+          value = thenable.value;\n+          debugInfo =\n+            thenable._debugInfo === undefined ? null : thenable._debugInfo;\n+          break;\n+        }\n+        case 'rejected': {\n+          const rejectedError = thenable.reason;\n+          error = rejectedError;\n+          break;\n+        }\n+        default:\n+          // If this was an uncached Promise we have to abandon this attempt\n+          // but we can still emit anything up until this point.\n+          error = SuspenseException;\n+          debugInfo =\n+            thenable._debugInfo === undefined ? null : thenable._debugInfo;\n+          value = thenable;\n+      }\n+    } else {\n+      value = (actionResult: any);\n+    }\n+  } else {\n+    value = initialState;\n+  }\n+\n+  hookLog.push({\n+    displayName: null,\n+    primitive: 'FormState',\n+    stackError: stackError,\n+    value: value,\n+    debugInfo: debugInfo,\n+  });\n+\n+  if (error !== null) {\n+    throw error;\n+  }\n+\n+  // value being a Thenable is equivalent to error being not null\n+  // i.e. we only reach this point with Awaited<S>\n+  const state = ((value: any): Awaited<S>);\n+  return [state, (payload: P) => {}];\n+}\n+\n const Dispatcher: DispatcherType = {\n   use,\n   readContext,\n@@ -361,13 +596,15 @@ const Dispatcher: DispatcherType = {\n   useInsertionEffect,\n   useMemo,\n   useMemoCache,\n+  useOptimistic,\n   useReducer,\n   useRef,\n   useState,\n   useTransition,\n   useSyncExternalStore,\n   useDeferredValue,\n   useId,\n+  useFormState,\n };\n \n // create a proxy to throw a custom error\n@@ -406,7 +643,8 @@ export type HooksNode = {\n   name: string,\n   value: mixed,\n   subHooks: Array<HooksNode>,\n-  hookSource?: HookSource,\n+  debugInfo: null | ReactDebugInfo,\n+  hookSource: null | HookSource,\n };\n export type HooksTree = Array<HooksNode>;\n \n@@ -472,6 +710,15 @@ function isReactWrapper(functionName: any, primitiveName: string) {\n   if (!functionName) {\n     return false;\n   }\n+  switch (primitiveName) {\n+    case 'Context':\n+    case 'Context (use)':\n+    case 'Promise':\n+    case 'Unresolved':\n+      if (functionName.endsWith('use')) {\n+        return true;\n+      }\n+  }\n   const expectedPrimitiveName = 'use' + primitiveName;\n   if (functionName.length < expectedPrimitiveName.length) {\n     return false;\n@@ -544,7 +791,6 @@ function parseCustomHookName(functionName: void | string): string {\n function buildTree(\n   rootStack: any,\n   readHookLog: Array<HookLogEntry>,\n-  includeHooksSource: boolean,\n ): HooksTree {\n   const rootChildren: Array<HooksNode> = [];\n   let prevStack = null;\n@@ -587,60 +833,63 @@ function buildTree(\n           name: parseCustomHookName(stack[j - 1].functionName),\n           value: undefined,\n           subHooks: children,\n-        };\n-\n-        if (includeHooksSource) {\n-          levelChild.hookSource = {\n+          debugInfo: null,\n+          hookSource: {\n             lineNumber: stackFrame.lineNumber,\n             columnNumber: stackFrame.columnNumber,\n             functionName: stackFrame.functionName,\n             fileName: stackFrame.fileName,\n-          };\n-        }\n+          },\n+        };\n \n         levelChildren.push(levelChild);\n         stackOfChildren.push(levelChildren);\n         levelChildren = children;\n       }\n       prevStack = stack;\n     }\n-    const {primitive} = hook;\n+    const {displayName, primitive, debugInfo} = hook;\n \n     // For now, the \"id\" of stateful hooks is just the stateful hook index.\n     // Custom hooks have no ids, nor do non-stateful native hooks (e.g. Context, DebugValue).\n     const id =\n-      primitive === 'Context' || primitive === 'DebugValue'\n+      primitive === 'Context' ||\n+      primitive === 'Context (use)' ||\n+      primitive === 'DebugValue' ||\n+      primitive === 'Promise' ||\n+      primitive === 'Unresolved'\n         ? null\n         : nativeHookID++;\n \n     // For the time being, only State and Reducer hooks support runtime overrides.\n     const isStateEditable = primitive === 'Reducer' || primitive === 'State';\n+    const name = displayName || primitive;\n     const levelChild: HooksNode = {\n       id,\n       isStateEditable,\n-      name: primitive,\n+      name: name,\n       value: hook.value,\n       subHooks: [],\n+      debugInfo: debugInfo,\n+      hookSource: null,\n     };\n \n-    if (includeHooksSource) {\n-      const hookSource: HookSource = {\n-        lineNumber: null,\n-        functionName: null,\n-        fileName: null,\n-        columnNumber: null,\n-      };\n-      if (stack && stack.length >= 1) {\n-        const stackFrame = stack[0];\n-        hookSource.lineNumber = stackFrame.lineNumber;\n-        hookSource.functionName = stackFrame.functionName;\n-        hookSource.fileName = stackFrame.fileName;\n-        hookSource.columnNumber = stackFrame.columnNumber;\n-      }\n-\n-      levelChild.hookSource = hookSource;\n+    const hookSource: HookSource = {\n+      lineNumber: null,\n+      functionName: null,\n+      fileName: null,\n+      columnNumber: null,\n+    };\n+    if (stack && stack.length >= 1) {\n+      const stackFrame = stack[0];\n+      hookSource.lineNumber = stackFrame.lineNumber;\n+      hookSource.functionName = stackFrame.functionName;\n+      hookSource.fileName = stackFrame.fileName;\n+      hookSource.columnNumber = stackFrame.columnNumber;\n     }\n \n+    levelChild.hookSource = hookSource;\n+\n     levelChildren.push(levelChild);\n   }\n \n@@ -686,6 +935,11 @@ function processDebugValues(\n \n function handleRenderFunctionError(error: any): void {\n   // original error might be any type.\n+  if (error === SuspenseException) {\n+    // An uncached Promise was used. We can't synchronously resolve the rest of\n+    // the Hooks but we can at least show what ever we got so far.\n+    return;\n+  }\n   if (\n     error instanceof Error &&\n     error.name === 'ReactDebugToolsUnsupportedHookError'\n@@ -713,7 +967,6 @@ export function inspectHooks<Props>(\n   renderFunction: Props => React$Node,\n   props: Props,\n   currentDispatcher: ?CurrentDispatcherRef,\n-  includeHooksSource: boolean = false,\n ): HooksTree {\n   // DevTools will pass the current renderer's injected dispatcher.\n   // Other apps might compile debug hooks as part of their app though.\n@@ -739,15 +992,18 @@ export function inspectHooks<Props>(\n     currentDispatcher.current = previousDispatcher;\n   }\n   const rootStack = ErrorStackParser.parse(ancestorStackError);\n-  return buildTree(rootStack, readHookLog, includeHooksSource);\n+  return buildTree(rootStack, readHookLog);\n }\n \n function setupContexts(contextMap: Map<ReactContext<any>, any>, fiber: Fiber) {\n   let current: null | Fiber = fiber;\n   while (current) {\n     if (current.tag === ContextProvider) {\n-      const providerType: ReactProviderType<any> = current.type;\n-      const context: ReactContext<any> = providerType._context;\n+      let context: ReactContext<any> = current.type;\n+      if ((context: any)._context !== undefined) {\n+        // Support inspection of pre-19+ providers.\n+        context = (context: any)._context;\n+      }\n       if (!contextMap.has(context)) {\n         // Store the current value that we're going to restore later.\n         contextMap.set(context, context._currentValue);\n@@ -768,7 +1024,6 @@ function inspectHooksOfForwardRef<Props, Ref>(\n   props: Props,\n   ref: Ref,\n   currentDispatcher: CurrentDispatcherRef,\n-  includeHooksSource: boolean,\n ): HooksTree {\n   const previousDispatcher = currentDispatcher.current;\n   let readHookLog;\n@@ -785,7 +1040,7 @@ function inspectHooksOfForwardRef<Props, Ref>(\n     currentDispatcher.current = previousDispatcher;\n   }\n   const rootStack = ErrorStackParser.parse(ancestorStackError);\n-  return buildTree(rootStack, readHookLog, includeHooksSource);\n+  return buildTree(rootStack, readHookLog);\n }\n \n function resolveDefaultProps(Component: any, baseProps: any) {\n@@ -806,7 +1061,6 @@ function resolveDefaultProps(Component: any, baseProps: any) {\n export function inspectHooksOfFiber(\n   fiber: Fiber,\n   currentDispatcher: ?CurrentDispatcherRef,\n-  includeHooksSource: boolean = false,\n ): HooksTree {\n   // DevTools will pass the current renderer's injected dispatcher.\n   // Other apps might compile debug hooks as part of their app though.\n@@ -848,11 +1102,10 @@ export function inspectHooksOfFiber(\n         props,\n         fiber.ref,\n         currentDispatcher,\n-        includeHooksSource,\n       );\n     }\n \n-    return inspectHooks(type, props, currentDispatcher, includeHooksSource);\n+    return inspectHooks(type, props, currentDispatcher);\n   } finally {\n     currentFiber = null;\n     currentHook = null;"
            },
            {
                "file": "packages/react-debug-tools/src/__tests__/ReactDevToolsHooksIntegration-test.js",
                "git_diff": "@@ -43,7 +43,7 @@ describe('React hooks DevTools integration', () => {\n     const InternalTestUtils = require('internal-test-utils');\n     waitForAll = InternalTestUtils.waitForAll;\n \n-    act = ReactTestRenderer.act;\n+    act = require('internal-test-utils').act;\n   });\n \n   it('should support editing useState hooks', async () => {\n@@ -55,7 +55,12 @@ describe('React hooks DevTools integration', () => {\n       return <div>count:{count}</div>;\n     }\n \n-    const renderer = ReactTestRenderer.create(<MyComponent />);\n+    let renderer;\n+    await act(() => {\n+      renderer = ReactTestRenderer.create(<MyComponent />, {\n+        unstable_isConcurrent: true,\n+      });\n+    });\n     expect(renderer.toJSON()).toEqual({\n       type: 'div',\n       props: {},\n@@ -107,7 +112,12 @@ describe('React hooks DevTools integration', () => {\n       );\n     }\n \n-    const renderer = ReactTestRenderer.create(<MyComponent />);\n+    let renderer;\n+    await act(() => {\n+      renderer = ReactTestRenderer.create(<MyComponent />, {\n+        unstable_isConcurrent: true,\n+      });\n+    });\n     expect(renderer.toJSON()).toEqual({\n       type: 'div',\n       props: {},\n@@ -155,7 +165,12 @@ describe('React hooks DevTools integration', () => {\n       return <div>count:{count}</div>;\n     }\n \n-    const renderer = ReactTestRenderer.create(<MyComponent />);\n+    let renderer;\n+    await act(() => {\n+      renderer = ReactTestRenderer.create(<MyComponent />, {\n+        unstable_isConcurrent: true,\n+      });\n+    });\n     expect(renderer.toJSON()).toEqual({\n       type: 'div',\n       props: {},\n@@ -192,14 +207,17 @@ describe('React hooks DevTools integration', () => {\n     function MyComponent() {\n       return 'Done';\n     }\n-\n-    const renderer = ReactTestRenderer.create(\n-      <div>\n-        <React.Suspense fallback={'Loading'}>\n-          <MyComponent />\n-        </React.Suspense>\n-      </div>,\n-    );\n+    let renderer;\n+    await act(() => {\n+      renderer = ReactTestRenderer.create(\n+        <div>\n+          <React.Suspense fallback={'Loading'}>\n+            <MyComponent />\n+          </React.Suspense>\n+        </div>,\n+        {unstable_isConcurrent: true},\n+      );\n+    });\n     const fiber = renderer.root._currentFiber().child;\n     if (__DEV__) {\n       // First render was locked\n@@ -236,7 +254,6 @@ describe('React hooks DevTools integration', () => {\n     }\n   });\n \n-  // @gate __DEV__\n   it('should support overriding suspense in concurrent mode', async () => {\n     if (__DEV__) {\n       // Lock the first render\n@@ -254,7 +271,7 @@ describe('React hooks DevTools integration', () => {\n             <MyComponent />\n           </React.Suspense>\n         </div>,\n-        {isConcurrent: true},\n+        {unstable_isConcurrent: true},\n       ),\n     );\n "
            },
            {
                "file": "packages/react-debug-tools/src/__tests__/ReactHooksInspection-test.js",
                "git_diff": "@@ -13,6 +13,18 @@\n let React;\n let ReactDebugTools;\n \n+function normalizeSourceLoc(tree) {\n+  tree.forEach(node => {\n+    if (node.hookSource) {\n+      node.hookSource.fileName = '**';\n+      node.hookSource.lineNumber = 0;\n+      node.hookSource.columnNumber = 0;\n+    }\n+    normalizeSourceLoc(node.subHooks);\n+  });\n+  return tree;\n+}\n+\n describe('ReactHooksInspection', () => {\n   beforeEach(() => {\n     jest.resetModules();\n@@ -26,15 +38,24 @@ describe('ReactHooksInspection', () => {\n       return <div>{state}</div>;\n     }\n     const tree = ReactDebugTools.inspectHooks(Foo, {});\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'hello world',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"hello world\",\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect a simple custom hook', () => {\n@@ -48,23 +69,75 @@ describe('ReactHooksInspection', () => {\n       return <div>{value}</div>;\n     }\n     const tree = ReactDebugTools.inspectHooks(Foo, {});\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Custom',\n-        value: __DEV__ ? 'custom hook label' : undefined,\n-        subHooks: [\n+    if (__DEV__) {\n+      expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+              [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"Foo\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": null,\n+                  \"isStateEditable\": false,\n+                  \"name\": \"Custom\",\n+                  \"subHooks\": [\n+                    {\n+                      \"debugInfo\": null,\n+                      \"hookSource\": {\n+                        \"columnNumber\": 0,\n+                        \"fileName\": \"**\",\n+                        \"functionName\": \"useCustom\",\n+                        \"lineNumber\": 0,\n+                      },\n+                      \"id\": 0,\n+                      \"isStateEditable\": true,\n+                      \"name\": \"State\",\n+                      \"subHooks\": [],\n+                      \"value\": \"hello world\",\n+                    },\n+                  ],\n+                  \"value\": \"custom hook label\",\n+                },\n+              ]\n+          `);\n+    } else {\n+      expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+        [\n           {\n-            isStateEditable: true,\n-            id: 0,\n-            name: 'State',\n-            value: 'hello world',\n-            subHooks: [],\n+            \"debugInfo\": null,\n+            \"hookSource\": {\n+              \"columnNumber\": 0,\n+              \"fileName\": \"**\",\n+              \"functionName\": \"Foo\",\n+              \"lineNumber\": 0,\n+            },\n+            \"id\": null,\n+            \"isStateEditable\": false,\n+            \"name\": \"Custom\",\n+            \"subHooks\": [\n+              {\n+                \"debugInfo\": null,\n+                \"hookSource\": {\n+                  \"columnNumber\": 0,\n+                  \"fileName\": \"**\",\n+                  \"functionName\": \"useCustom\",\n+                  \"lineNumber\": 0,\n+                },\n+                \"id\": 0,\n+                \"isStateEditable\": true,\n+                \"name\": \"State\",\n+                \"subHooks\": [],\n+                \"value\": \"hello world\",\n+              },\n+            ],\n+            \"value\": undefined,\n           },\n-        ],\n-      },\n-    ]);\n+        ]\n+      `);\n+    }\n   });\n \n   it('should inspect a tree of multiple hooks', () => {\n@@ -84,52 +157,96 @@ describe('ReactHooksInspection', () => {\n       );\n     }\n     const tree = ReactDebugTools.inspectHooks(Foo, {});\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Custom',\n-        value: undefined,\n-        subHooks: [\n-          {\n-            isStateEditable: true,\n-            id: 0,\n-            name: 'State',\n-            subHooks: [],\n-            value: 'hello',\n-          },\n-          {\n-            isStateEditable: false,\n-            id: 1,\n-            name: 'Effect',\n-            subHooks: [],\n-            value: effect,\n-          },\n-        ],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Custom',\n-        value: undefined,\n-        subHooks: [\n-          {\n-            isStateEditable: true,\n-            id: 2,\n-            name: 'State',\n-            value: 'world',\n-            subHooks: [],\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n           },\n-          {\n-            isStateEditable: false,\n-            id: 3,\n-            name: 'Effect',\n-            value: effect,\n-            subHooks: [],\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Custom\",\n+          \"subHooks\": [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useCustom\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": 0,\n+              \"isStateEditable\": true,\n+              \"name\": \"State\",\n+              \"subHooks\": [],\n+              \"value\": \"hello\",\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useCustom\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": 1,\n+              \"isStateEditable\": false,\n+              \"name\": \"Effect\",\n+              \"subHooks\": [],\n+              \"value\": [Function],\n+            },\n+          ],\n+          \"value\": undefined,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n           },\n-        ],\n-      },\n-    ]);\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Custom\",\n+          \"subHooks\": [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useCustom\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": 2,\n+              \"isStateEditable\": true,\n+              \"name\": \"State\",\n+              \"subHooks\": [],\n+              \"value\": \"world\",\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useCustom\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": 3,\n+              \"isStateEditable\": false,\n+              \"name\": \"Effect\",\n+              \"subHooks\": [],\n+              \"value\": [Function],\n+            },\n+          ],\n+          \"value\": undefined,\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect a tree of multiple levels of hooks', () => {\n@@ -159,82 +276,154 @@ describe('ReactHooksInspection', () => {\n       );\n     }\n     const tree = ReactDebugTools.inspectHooks(Foo, {});\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Bar',\n-        value: undefined,\n-        subHooks: [\n-          {\n-            isStateEditable: false,\n-            id: null,\n-            name: 'Custom',\n-            value: undefined,\n-            subHooks: [\n-              {\n-                isStateEditable: true,\n-                id: 0,\n-                name: 'Reducer',\n-                value: 'hello',\n-                subHooks: [],\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Bar\",\n+          \"subHooks\": [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useBar\",\n+                \"lineNumber\": 0,\n               },\n-              {\n-                isStateEditable: false,\n-                id: 1,\n-                name: 'Effect',\n-                value: effect,\n-                subHooks: [],\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Custom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 0,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"Reducer\",\n+                  \"subHooks\": [],\n+                  \"value\": \"hello\",\n+                },\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 1,\n+                  \"isStateEditable\": false,\n+                  \"name\": \"Effect\",\n+                  \"subHooks\": [],\n+                  \"value\": [Function],\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useBar\",\n+                \"lineNumber\": 0,\n               },\n-            ],\n-          },\n-          {\n-            isStateEditable: false,\n-            id: 2,\n-            name: 'LayoutEffect',\n-            value: effect,\n-            subHooks: [],\n-          },\n-        ],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Baz',\n-        value: undefined,\n-        subHooks: [\n-          {\n-            isStateEditable: false,\n-            id: 3,\n-            name: 'LayoutEffect',\n-            value: effect,\n-            subHooks: [],\n+              \"id\": 2,\n+              \"isStateEditable\": false,\n+              \"name\": \"LayoutEffect\",\n+              \"subHooks\": [],\n+              \"value\": [Function],\n+            },\n+          ],\n+          \"value\": undefined,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n           },\n-          {\n-            isStateEditable: false,\n-            id: null,\n-            name: 'Custom',\n-            subHooks: [\n-              {\n-                isStateEditable: true,\n-                id: 4,\n-                name: 'Reducer',\n-                subHooks: [],\n-                value: 'world',\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Baz\",\n+          \"subHooks\": [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useBaz\",\n+                \"lineNumber\": 0,\n               },\n-              {\n-                isStateEditable: false,\n-                id: 5,\n-                name: 'Effect',\n-                subHooks: [],\n-                value: effect,\n+              \"id\": 3,\n+              \"isStateEditable\": false,\n+              \"name\": \"LayoutEffect\",\n+              \"subHooks\": [],\n+              \"value\": [Function],\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useBaz\",\n+                \"lineNumber\": 0,\n               },\n-            ],\n-            value: undefined,\n-          },\n-        ],\n-      },\n-    ]);\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Custom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 4,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"Reducer\",\n+                  \"subHooks\": [],\n+                  \"value\": \"world\",\n+                },\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 5,\n+                  \"isStateEditable\": false,\n+                  \"name\": \"Effect\",\n+                  \"subHooks\": [],\n+                  \"value\": [Function],\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+          ],\n+          \"value\": undefined,\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect the default value using the useContext hook', () => {\n@@ -244,15 +433,24 @@ describe('ReactHooksInspection', () => {\n       return <div>{value}</div>;\n     }\n     const tree = ReactDebugTools.inspectHooks(Foo, {});\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Context',\n-        value: 'default',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Context\",\n+          \"subHooks\": [],\n+          \"value\": \"default\",\n+        },\n+      ]\n+    `);\n   });\n \n   it('should support an injected dispatcher', () => {\n@@ -288,6 +486,129 @@ describe('ReactHooksInspection', () => {\n     expect(setterCalls[1]).toBe(initial);\n   });\n \n+  it('should inspect use() calls for Promise and Context', async () => {\n+    const MyContext = React.createContext('hi');\n+    const promise = Promise.resolve('world');\n+    await promise;\n+    promise.status = 'fulfilled';\n+    promise.value = 'world';\n+    promise._debugInfo = [{name: 'Hello'}];\n+\n+    function useCustom() {\n+      const value = React.use(promise);\n+      const [state] = React.useState(value);\n+      return state;\n+    }\n+    function Foo(props) {\n+      const value1 = React.use(MyContext);\n+      const value2 = useCustom();\n+      return (\n+        <div>\n+          {value1} {value2}\n+        </div>\n+      );\n+    }\n+    const tree = ReactDebugTools.inspectHooks(Foo, {});\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Context\",\n+          \"subHooks\": [],\n+          \"value\": \"hi\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Custom\",\n+          \"subHooks\": [\n+            {\n+              \"debugInfo\": [\n+                {\n+                  \"name\": \"Hello\",\n+                },\n+              ],\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useCustom\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Promise\",\n+              \"subHooks\": [],\n+              \"value\": \"world\",\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useCustom\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": 0,\n+              \"isStateEditable\": true,\n+              \"name\": \"State\",\n+              \"subHooks\": [],\n+              \"value\": \"world\",\n+            },\n+          ],\n+          \"value\": undefined,\n+        },\n+      ]\n+    `);\n+  });\n+\n+  it('should inspect use() calls for unresolved Promise', () => {\n+    const promise = Promise.resolve('hi');\n+\n+    function Foo(props) {\n+      const value = React.use(promise);\n+      return <div>{value}</div>;\n+    }\n+    const tree = ReactDebugTools.inspectHooks(Foo, {});\n+    const results = normalizeSourceLoc(tree);\n+    expect(results).toHaveLength(1);\n+    expect(results[0]).toMatchInlineSnapshot(\n+      {\n+        value: expect.any(Promise),\n+      },\n+      `\n+      {\n+        \"debugInfo\": null,\n+        \"hookSource\": {\n+          \"columnNumber\": 0,\n+          \"fileName\": \"**\",\n+          \"functionName\": \"Foo\",\n+          \"lineNumber\": 0,\n+        },\n+        \"id\": null,\n+        \"isStateEditable\": false,\n+        \"name\": \"Unresolved\",\n+        \"subHooks\": [],\n+        \"value\": Any<Promise>,\n+      }\n+    `,\n+    );\n+  });\n+\n   describe('useDebugValue', () => {\n     it('should be ignored when called outside of a custom hook', () => {\n       function Foo(props) {\n@@ -308,23 +629,75 @@ describe('ReactHooksInspection', () => {\n         return null;\n       }\n       const tree = ReactDebugTools.inspectHooks(Foo, {});\n-      expect(tree).toEqual([\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'Custom',\n-          value: __DEV__ ? 'bar:123' : undefined,\n-          subHooks: [\n+      if (__DEV__) {\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+                  [\n+                    {\n+                      \"debugInfo\": null,\n+                      \"hookSource\": {\n+                        \"columnNumber\": 0,\n+                        \"fileName\": \"**\",\n+                        \"functionName\": \"Foo\",\n+                        \"lineNumber\": 0,\n+                      },\n+                      \"id\": null,\n+                      \"isStateEditable\": false,\n+                      \"name\": \"Custom\",\n+                      \"subHooks\": [\n+                        {\n+                          \"debugInfo\": null,\n+                          \"hookSource\": {\n+                            \"columnNumber\": 0,\n+                            \"fileName\": \"**\",\n+                            \"functionName\": \"useCustom\",\n+                            \"lineNumber\": 0,\n+                          },\n+                          \"id\": 0,\n+                          \"isStateEditable\": true,\n+                          \"name\": \"State\",\n+                          \"subHooks\": [],\n+                          \"value\": 0,\n+                        },\n+                      ],\n+                      \"value\": \"bar:123\",\n+                    },\n+                  ]\n+              `);\n+      } else {\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n             {\n-              isStateEditable: true,\n-              id: 0,\n-              name: 'State',\n-              subHooks: [],\n-              value: 0,\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Foo\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Custom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 0,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": undefined,\n             },\n-          ],\n-        },\n-      ]);\n+          ]\n+        `);\n+      }\n     });\n   });\n });"
            },
            {
                "file": "packages/react-debug-tools/src/__tests__/ReactHooksInspectionIntegration-test.js",
                "git_diff": "@@ -11,16 +11,30 @@\n 'use strict';\n \n let React;\n+let ReactDOM;\n let ReactTestRenderer;\n let ReactDebugTools;\n let act;\n let useMemoCache;\n \n+function normalizeSourceLoc(tree) {\n+  tree.forEach(node => {\n+    if (node.hookSource) {\n+      node.hookSource.fileName = '**';\n+      node.hookSource.lineNumber = 0;\n+      node.hookSource.columnNumber = 0;\n+    }\n+    normalizeSourceLoc(node.subHooks);\n+  });\n+  return tree;\n+}\n+\n describe('ReactHooksInspectionIntegration', () => {\n   beforeEach(() => {\n     jest.resetModules();\n     React = require('react');\n     ReactTestRenderer = require('react-test-renderer');\n+    ReactDOM = require('react-dom');\n     act = require('internal-test-utils').act;\n     ReactDebugTools = require('react-debug-tools');\n     useMemoCache = React.unstable_useMemoCache;\n@@ -41,22 +55,38 @@ describe('ReactHooksInspectionIntegration', () => {\n \n     let childFiber = renderer.root.findByType(Foo)._currentFiber();\n     let tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'hello',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: true,\n-        id: 1,\n-        name: 'State',\n-        value: 'world',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"hello\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"world\",\n+        },\n+      ]\n+    `);\n \n     const {onMouseDown: setStateA, onMouseUp: setStateB} =\n       renderer.root.findByType('div').props;\n@@ -66,44 +96,76 @@ describe('ReactHooksInspectionIntegration', () => {\n     childFiber = renderer.root.findByType(Foo)._currentFiber();\n     tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n \n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'Hi',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: true,\n-        id: 1,\n-        name: 'State',\n-        value: 'world',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"Hi\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"world\",\n+        },\n+      ]\n+    `);\n \n     await act(() => setStateB('world!'));\n \n     childFiber = renderer.root.findByType(Foo)._currentFiber();\n     tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n \n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'Hi',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: true,\n-        id: 1,\n-        name: 'State',\n-        value: 'world!',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"Hi\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"world!\",\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect the current state of all stateful hooks', async () => {\n@@ -150,58 +212,122 @@ describe('ReactHooksInspectionIntegration', () => {\n     const {onClick: updateStates} = renderer.root.findByType('div').props;\n \n     let tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'a',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: true,\n-        id: 1,\n-        name: 'Reducer',\n-        value: 'b',\n-        subHooks: [],\n-      },\n-      {isStateEditable: false, id: 2, name: 'Ref', value: 'c', subHooks: []},\n-      {\n-        isStateEditable: false,\n-        id: 3,\n-        name: 'LayoutEffect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 4,\n-        name: 'Effect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 5,\n-        name: 'ImperativeHandle',\n-        value: outsideRef.current,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 6,\n-        name: 'Memo',\n-        value: 'ab',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 7,\n-        name: 'Callback',\n-        value: updateStates,\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"a\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": true,\n+          \"name\": \"Reducer\",\n+          \"subHooks\": [],\n+          \"value\": \"b\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Ref\",\n+          \"subHooks\": [],\n+          \"value\": \"c\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"LayoutEffect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 4,\n+          \"isStateEditable\": false,\n+          \"name\": \"Effect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 5,\n+          \"isStateEditable\": false,\n+          \"name\": \"ImperativeHandle\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 6,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"ab\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 7,\n+          \"isStateEditable\": false,\n+          \"name\": \"Callback\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+      ]\n+    `);\n \n     await act(() => {\n       updateStates();\n@@ -210,58 +336,122 @@ describe('ReactHooksInspectionIntegration', () => {\n     childFiber = renderer.root.findByType(Foo)._currentFiber();\n     tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n \n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'A',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: true,\n-        id: 1,\n-        name: 'Reducer',\n-        value: 'B',\n-        subHooks: [],\n-      },\n-      {isStateEditable: false, id: 2, name: 'Ref', value: 'C', subHooks: []},\n-      {\n-        isStateEditable: false,\n-        id: 3,\n-        name: 'LayoutEffect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 4,\n-        name: 'Effect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 5,\n-        name: 'ImperativeHandle',\n-        value: outsideRef.current,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 6,\n-        name: 'Memo',\n-        value: 'Ab',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 7,\n-        name: 'Callback',\n-        value: updateStates,\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"A\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": true,\n+          \"name\": \"Reducer\",\n+          \"subHooks\": [],\n+          \"value\": \"B\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Ref\",\n+          \"subHooks\": [],\n+          \"value\": \"C\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"LayoutEffect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 4,\n+          \"isStateEditable\": false,\n+          \"name\": \"Effect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 5,\n+          \"isStateEditable\": false,\n+          \"name\": \"ImperativeHandle\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 6,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"Ab\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 7,\n+          \"isStateEditable\": false,\n+          \"name\": \"Callback\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect the current state of all stateful hooks, including useInsertionEffect', async () => {\n@@ -310,65 +500,136 @@ describe('ReactHooksInspectionIntegration', () => {\n     const {onClick: updateStates} = renderer.root.findByType('div').props;\n \n     let tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'a',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: true,\n-        id: 1,\n-        name: 'Reducer',\n-        value: 'b',\n-        subHooks: [],\n-      },\n-      {isStateEditable: false, id: 2, name: 'Ref', value: 'c', subHooks: []},\n-      {\n-        isStateEditable: false,\n-        id: 3,\n-        name: 'InsertionEffect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 4,\n-        name: 'LayoutEffect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 5,\n-        name: 'Effect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 6,\n-        name: 'ImperativeHandle',\n-        value: outsideRef.current,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 7,\n-        name: 'Memo',\n-        value: 'ab',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 8,\n-        name: 'Callback',\n-        value: updateStates,\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"a\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": true,\n+          \"name\": \"Reducer\",\n+          \"subHooks\": [],\n+          \"value\": \"b\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Ref\",\n+          \"subHooks\": [],\n+          \"value\": \"c\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"InsertionEffect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 4,\n+          \"isStateEditable\": false,\n+          \"name\": \"LayoutEffect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 5,\n+          \"isStateEditable\": false,\n+          \"name\": \"Effect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 6,\n+          \"isStateEditable\": false,\n+          \"name\": \"ImperativeHandle\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 7,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"ab\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 8,\n+          \"isStateEditable\": false,\n+          \"name\": \"Callback\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+      ]\n+    `);\n \n     await act(() => {\n       updateStates();\n@@ -377,71 +638,145 @@ describe('ReactHooksInspectionIntegration', () => {\n     childFiber = renderer.root.findByType(Foo)._currentFiber();\n     tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n \n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'A',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: true,\n-        id: 1,\n-        name: 'Reducer',\n-        value: 'B',\n-        subHooks: [],\n-      },\n-      {isStateEditable: false, id: 2, name: 'Ref', value: 'C', subHooks: []},\n-      {\n-        isStateEditable: false,\n-        id: 3,\n-        name: 'InsertionEffect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 4,\n-        name: 'LayoutEffect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 5,\n-        name: 'Effect',\n-        value: effect,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 6,\n-        name: 'ImperativeHandle',\n-        value: outsideRef.current,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 7,\n-        name: 'Memo',\n-        value: 'Ab',\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: false,\n-        id: 8,\n-        name: 'Callback',\n-        value: updateStates,\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"A\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": true,\n+          \"name\": \"Reducer\",\n+          \"subHooks\": [],\n+          \"value\": \"B\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Ref\",\n+          \"subHooks\": [],\n+          \"value\": \"C\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"InsertionEffect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 4,\n+          \"isStateEditable\": false,\n+          \"name\": \"LayoutEffect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 5,\n+          \"isStateEditable\": false,\n+          \"name\": \"Effect\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 6,\n+          \"isStateEditable\": false,\n+          \"name\": \"ImperativeHandle\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 7,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"Ab\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 8,\n+          \"isStateEditable\": false,\n+          \"name\": \"Callback\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect the value of the current provider in useContext', () => {\n     const MyContext = React.createContext('default');\n+    const ThemeContext = React.createContext('default');\n+    ThemeContext.displayName = 'Theme';\n     function Foo(props) {\n       const value = React.useContext(MyContext);\n+      React.useContext(ThemeContext);\n       return <div>{value}</div>;\n     }\n     const renderer = ReactTestRenderer.create(\n@@ -451,15 +786,38 @@ describe('ReactHooksInspectionIntegration', () => {\n     );\n     const childFiber = renderer.root.findByType(Foo)._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Context',\n-        value: 'contextual',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Context\",\n+          \"subHooks\": [],\n+          \"value\": \"contextual\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Theme\",\n+          \"subHooks\": [],\n+          \"value\": \"default\",\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect forwardRef', () => {\n@@ -473,15 +831,24 @@ describe('ReactHooksInspectionIntegration', () => {\n \n     const childFiber = renderer.root.findByType(Foo)._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: false,\n-        id: 0,\n-        name: 'ImperativeHandle',\n-        value: obj,\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": undefined,\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": false,\n+          \"name\": \"ImperativeHandle\",\n+          \"subHooks\": [],\n+          \"value\": [Function],\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect memo', () => {\n@@ -494,15 +861,24 @@ describe('ReactHooksInspectionIntegration', () => {\n     // TODO: Test renderer findByType is broken for memo. Have to search for the inner.\n     const childFiber = renderer.root.findByType(InnerFoo)._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'hello',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"InnerFoo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"hello\",\n+        },\n+      ]\n+    `);\n   });\n \n   it('should inspect custom hooks', () => {\n@@ -517,23 +893,39 @@ describe('ReactHooksInspectionIntegration', () => {\n     const renderer = ReactTestRenderer.create(<Foo />);\n     const childFiber = renderer.root.findByType(Foo)._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Custom',\n-        value: undefined,\n-        subHooks: [\n-          {\n-            isStateEditable: true,\n-            id: 0,\n-            name: 'State',\n-            value: 'hello',\n-            subHooks: [],\n-          },\n-        ],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Custom\",\n+          \"subHooks\": [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"useCustom\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": 0,\n+              \"isStateEditable\": true,\n+              \"name\": \"State\",\n+              \"subHooks\": [],\n+              \"value\": \"hello\",\n+            },\n+          ],\n+          \"value\": undefined,\n+        },\n+      ]\n+    `);\n   });\n \n   it('should support composite useTransition hook', () => {\n@@ -546,29 +938,214 @@ describe('ReactHooksInspectionIntegration', () => {\n     const renderer = ReactTestRenderer.create(<Foo />);\n     const childFiber = renderer.root.findByType(Foo)._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        id: 0,\n-        isStateEditable: false,\n-        name: 'Transition',\n-        value: undefined,\n-        subHooks: [],\n-      },\n-      {\n-        id: 1,\n-        isStateEditable: false,\n-        name: 'Memo',\n-        value: 'hello',\n-        subHooks: [],\n-      },\n-      {\n-        id: 2,\n-        isStateEditable: false,\n-        name: 'Memo',\n-        value: 'not used',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": false,\n+          \"name\": \"Transition\",\n+          \"subHooks\": [],\n+          \"value\": false,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"hello\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n+  });\n+\n+  it('should update isPending returned from useTransition', async () => {\n+    const IndefiniteSuspender = React.lazy(() => new Promise(() => {}));\n+    let startTransition;\n+    function Foo(props) {\n+      const [show, setShow] = React.useState(false);\n+      const [isPending, _startTransition] = React.useTransition();\n+      React.useMemo(() => 'hello', []);\n+      React.useMemo(() => 'not used', []);\n+\n+      // Otherwise we capture the version from the react-debug-tools dispatcher.\n+      if (startTransition === undefined) {\n+        startTransition = () => {\n+          _startTransition(() => {\n+            setShow(true);\n+          });\n+        };\n+      }\n+\n+      return (\n+        <React.Suspense fallback=\"Loading\">\n+          {isPending ? 'Pending' : null}\n+          {show ? <IndefiniteSuspender /> : null}\n+        </React.Suspense>\n+      );\n+    }\n+    const renderer = await act(() => {\n+      return ReactTestRenderer.create(<Foo />, {isConcurrent: true});\n+    });\n+    expect(renderer).toMatchRenderedOutput(null);\n+    let childFiber = renderer.root.findByType(Foo)._currentFiber();\n+    let tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": false,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"Transition\",\n+          \"subHooks\": [],\n+          \"value\": false,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"hello\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n+\n+    await act(() => {\n+      startTransition();\n+    });\n+\n+    expect(renderer).toMatchRenderedOutput('Pending');\n+\n+    childFiber = renderer.root.findByType(Foo)._currentFiber();\n+    tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": false,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"Transition\",\n+          \"subHooks\": [],\n+          \"value\": true,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"hello\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n   });\n \n   it('should support useDeferredValue hook', () => {\n@@ -581,29 +1158,52 @@ describe('ReactHooksInspectionIntegration', () => {\n     const renderer = ReactTestRenderer.create(<Foo />);\n     const childFiber = renderer.root.findByType(Foo)._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        id: 0,\n-        isStateEditable: false,\n-        name: 'DeferredValue',\n-        value: 'abc',\n-        subHooks: [],\n-      },\n-      {\n-        id: 1,\n-        isStateEditable: false,\n-        name: 'Memo',\n-        value: 1,\n-        subHooks: [],\n-      },\n-      {\n-        id: 2,\n-        isStateEditable: false,\n-        name: 'Memo',\n-        value: 2,\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": false,\n+          \"name\": \"DeferredValue\",\n+          \"subHooks\": [],\n+          \"value\": \"abc\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": 1,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": 2,\n+        },\n+      ]\n+    `);\n   });\n \n   it('should support useId hook', () => {\n@@ -624,13 +1224,22 @@ describe('ReactHooksInspectionIntegration', () => {\n     expect(tree[0].name).toEqual('Id');\n     expect(String(tree[0].value).startsWith(':r')).toBe(true);\n \n-    expect(tree[1]).toEqual({\n-      id: 1,\n-      isStateEditable: true,\n-      name: 'State',\n-      value: 'hello',\n-      subHooks: [],\n-    });\n+    expect(normalizeSourceLoc(tree)[1]).toMatchInlineSnapshot(`\n+      {\n+        \"debugInfo\": null,\n+        \"hookSource\": {\n+          \"columnNumber\": 0,\n+          \"fileName\": \"**\",\n+          \"functionName\": \"Foo\",\n+          \"lineNumber\": 0,\n+        },\n+        \"id\": 1,\n+        \"isStateEditable\": true,\n+        \"name\": \"State\",\n+        \"subHooks\": [],\n+        \"value\": \"hello\",\n+      }\n+    `);\n   });\n \n   describe('useMemoCache', () => {\n@@ -714,60 +1323,218 @@ describe('ReactHooksInspectionIntegration', () => {\n       const renderer = ReactTestRenderer.create(<Example />);\n       const childFiber = renderer.root.findByType(Example)._currentFiber();\n       const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-      expect(tree).toEqual([\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'LabeledValue',\n-          value: __DEV__ ? 'custom label a' : undefined,\n-          subHooks: [\n+      if (__DEV__) {\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n             {\n-              isStateEditable: true,\n-              id: 0,\n-              name: 'State',\n-              value: 'a',\n-              subHooks: [],\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"LabeledValue\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useLabeledValue\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 0,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": \"a\",\n+                },\n+              ],\n+              \"value\": \"custom label a\",\n             },\n-          ],\n-        },\n-        {\n-          isStateEditable: true,\n-          id: 1,\n-          name: 'State',\n-          value: 'b',\n-          subHooks: [],\n-        },\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'Anonymous',\n-          value: undefined,\n-          subHooks: [\n             {\n-              isStateEditable: true,\n-              id: 2,\n-              name: 'State',\n-              value: 'c',\n-              subHooks: [],\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": 1,\n+              \"isStateEditable\": true,\n+              \"name\": \"State\",\n+              \"subHooks\": [],\n+              \"value\": \"b\",\n             },\n-          ],\n-        },\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'LabeledValue',\n-          value: __DEV__ ? 'custom label d' : undefined,\n-          subHooks: [\n             {\n-              isStateEditable: true,\n-              id: 3,\n-              name: 'State',\n-              value: 'd',\n-              subHooks: [],\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Anonymous\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useAnonymous\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 2,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": \"c\",\n+                },\n+              ],\n+              \"value\": undefined,\n             },\n-          ],\n-        },\n-      ]);\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"LabeledValue\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useLabeledValue\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 3,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": \"d\",\n+                },\n+              ],\n+              \"value\": \"custom label d\",\n+            },\n+          ]\n+        `);\n+      } else\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"LabeledValue\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useLabeledValue\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 0,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": \"a\",\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": 1,\n+              \"isStateEditable\": true,\n+              \"name\": \"State\",\n+              \"subHooks\": [],\n+              \"value\": \"b\",\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Anonymous\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useAnonymous\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 2,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": \"c\",\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"LabeledValue\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useLabeledValue\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 3,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": \"d\",\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+          ]\n+        `);\n     });\n \n     it('should support inspectable values for nested custom hooks', () => {\n@@ -786,31 +1553,104 @@ describe('ReactHooksInspectionIntegration', () => {\n       const renderer = ReactTestRenderer.create(<Example />);\n       const childFiber = renderer.root.findByType(Example)._currentFiber();\n       const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-      expect(tree).toEqual([\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'Outer',\n-          value: __DEV__ ? 'outer' : undefined,\n-          subHooks: [\n+      if (__DEV__) {\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n             {\n-              isStateEditable: false,\n-              id: null,\n-              name: 'Inner',\n-              value: __DEV__ ? 'inner' : undefined,\n-              subHooks: [\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Outer\",\n+              \"subHooks\": [\n                 {\n-                  isStateEditable: true,\n-                  id: 0,\n-                  name: 'State',\n-                  value: 0,\n-                  subHooks: [],\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useOuter\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": null,\n+                  \"isStateEditable\": false,\n+                  \"name\": \"Inner\",\n+                  \"subHooks\": [\n+                    {\n+                      \"debugInfo\": null,\n+                      \"hookSource\": {\n+                        \"columnNumber\": 0,\n+                        \"fileName\": \"**\",\n+                        \"functionName\": \"useInner\",\n+                        \"lineNumber\": 0,\n+                      },\n+                      \"id\": 0,\n+                      \"isStateEditable\": true,\n+                      \"name\": \"State\",\n+                      \"subHooks\": [],\n+                      \"value\": 0,\n+                    },\n+                  ],\n+                  \"value\": \"inner\",\n                 },\n               ],\n+              \"value\": \"outer\",\n             },\n-          ],\n-        },\n-      ]);\n+          ]\n+        `);\n+      } else\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Outer\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useOuter\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": null,\n+                  \"isStateEditable\": false,\n+                  \"name\": \"Inner\",\n+                  \"subHooks\": [\n+                    {\n+                      \"debugInfo\": null,\n+                      \"hookSource\": {\n+                        \"columnNumber\": 0,\n+                        \"fileName\": \"**\",\n+                        \"functionName\": \"useInner\",\n+                        \"lineNumber\": 0,\n+                      },\n+                      \"id\": 0,\n+                      \"isStateEditable\": true,\n+                      \"name\": \"State\",\n+                      \"subHooks\": [],\n+                      \"value\": 0,\n+                    },\n+                  ],\n+                  \"value\": undefined,\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+          ]\n+        `);\n     });\n \n     it('should support multiple inspectable values per custom hooks', () => {\n@@ -833,53 +1673,194 @@ describe('ReactHooksInspectionIntegration', () => {\n       const renderer = ReactTestRenderer.create(<Example />);\n       const childFiber = renderer.root.findByType(Example)._currentFiber();\n       const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-      expect(tree).toEqual([\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'SingleLabelCustom',\n-          value: __DEV__ ? 'single one' : undefined,\n-          subHooks: [\n+      if (__DEV__) {\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n             {\n-              isStateEditable: true,\n-              id: 0,\n-              name: 'State',\n-              value: 0,\n-              subHooks: [],\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"SingleLabelCustom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useSingleLabelCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 0,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": \"single one\",\n             },\n-          ],\n-        },\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'MultiLabelCustom',\n-          value: __DEV__ ? ['one', 'two', 'three'] : undefined,\n-          subHooks: [\n             {\n-              isStateEditable: true,\n-              id: 1,\n-              name: 'State',\n-              value: 0,\n-              subHooks: [],\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"MultiLabelCustom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useMultiLabelCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 1,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": [\n+                \"one\",\n+                \"two\",\n+                \"three\",\n+              ],\n             },\n-          ],\n-        },\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'SingleLabelCustom',\n-          value: __DEV__ ? 'single two' : undefined,\n-          subHooks: [\n             {\n-              isStateEditable: true,\n-              id: 2,\n-              name: 'State',\n-              value: 0,\n-              subHooks: [],\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"SingleLabelCustom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useSingleLabelCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 2,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": \"single two\",\n+            },\n+          ]\n+        `);\n+      } else\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"SingleLabelCustom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useSingleLabelCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 0,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": undefined,\n             },\n-          ],\n-        },\n-      ]);\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"MultiLabelCustom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useMultiLabelCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 1,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"SingleLabelCustom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useSingleLabelCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 2,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+          ]\n+        `);\n     });\n \n     it('should ignore useDebugValue() made outside of a custom hook', () => {\n@@ -905,23 +1886,74 @@ describe('ReactHooksInspectionIntegration', () => {\n       const renderer = ReactTestRenderer.create(<Example />);\n       const childFiber = renderer.root.findByType(Example)._currentFiber();\n       const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-      expect(tree).toEqual([\n-        {\n-          isStateEditable: false,\n-          id: null,\n-          name: 'Custom',\n-          value: __DEV__ ? 'bar:123' : undefined,\n-          subHooks: [\n+      if (__DEV__) {\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n             {\n-              isStateEditable: true,\n-              id: 0,\n-              name: 'State',\n-              subHooks: [],\n-              value: 0,\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Custom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 0,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": \"bar:123\",\n             },\n-          ],\n-        },\n-      ]);\n+          ]\n+        `);\n+      } else\n+        expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+          [\n+            {\n+              \"debugInfo\": null,\n+              \"hookSource\": {\n+                \"columnNumber\": 0,\n+                \"fileName\": \"**\",\n+                \"functionName\": \"Example\",\n+                \"lineNumber\": 0,\n+              },\n+              \"id\": null,\n+              \"isStateEditable\": false,\n+              \"name\": \"Custom\",\n+              \"subHooks\": [\n+                {\n+                  \"debugInfo\": null,\n+                  \"hookSource\": {\n+                    \"columnNumber\": 0,\n+                    \"fileName\": \"**\",\n+                    \"functionName\": \"useCustom\",\n+                    \"lineNumber\": 0,\n+                  },\n+                  \"id\": 0,\n+                  \"isStateEditable\": true,\n+                  \"name\": \"State\",\n+                  \"subHooks\": [],\n+                  \"value\": 0,\n+                },\n+              ],\n+              \"value\": undefined,\n+            },\n+          ]\n+        `);\n     });\n   });\n \n@@ -956,15 +1988,24 @@ describe('ReactHooksInspectionIntegration', () => {\n \n     const childFiber = renderer.root._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: 'def',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": \"def\",\n+        },\n+      ]\n+    `);\n   });\n \n   it('should support an injected dispatcher', () => {\n@@ -1004,7 +2045,7 @@ describe('ReactHooksInspectionIntegration', () => {\n           '1. You might have mismatching versions of React and the renderer (such as React DOM)\\n' +\n           '2. You might be breaking the Rules of Hooks\\n' +\n           '3. You might have more than one copy of React in the same app\\n' +\n-          'See https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.',\n+          'See https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem.',\n       );\n       didCatch = true;\n     }\n@@ -1049,22 +2090,40 @@ describe('ReactHooksInspectionIntegration', () => {\n \n     const childFiber = renderer.root._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        isStateEditable: false,\n-        id: null,\n-        name: 'Context',\n-        value: 1,\n-        subHooks: [],\n-      },\n-      {\n-        isStateEditable: true,\n-        id: 0,\n-        name: 'State',\n-        value: {count: 2},\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Context\",\n+          \"subHooks\": [],\n+          \"value\": 1,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": {\n+            \"count\": 2,\n+          },\n+        },\n+      ]\n+    `);\n   });\n \n   it('should support composite useSyncExternalStore hook', () => {\n@@ -1082,28 +2141,236 @@ describe('ReactHooksInspectionIntegration', () => {\n     const renderer = ReactTestRenderer.create(<Foo />);\n     const childFiber = renderer.root.findByType(Foo)._currentFiber();\n     const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n-    expect(tree).toEqual([\n-      {\n-        id: 0,\n-        isStateEditable: false,\n-        name: 'SyncExternalStore',\n-        value: 'snapshot',\n-        subHooks: [],\n-      },\n-      {\n-        id: 1,\n-        isStateEditable: false,\n-        name: 'Memo',\n-        value: 'memo',\n-        subHooks: [],\n-      },\n-      {\n-        id: 2,\n-        isStateEditable: false,\n-        name: 'Memo',\n-        value: 'not used',\n-        subHooks: [],\n-      },\n-    ]);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": false,\n+          \"name\": \"SyncExternalStore\",\n+          \"subHooks\": [],\n+          \"value\": \"snapshot\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"memo\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n+  });\n+\n+  it('should support use(Context) hook', () => {\n+    const Context = React.createContext('default');\n+    function Foo() {\n+      const value = React.use(Context);\n+      React.useMemo(() => 'memo', []);\n+      React.useMemo(() => 'not used', []);\n+\n+      return value;\n+    }\n+\n+    const renderer = ReactTestRenderer.create(<Foo />);\n+    const childFiber = renderer.root.findByType(Foo)._currentFiber();\n+    const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Context\",\n+          \"subHooks\": [],\n+          \"value\": \"default\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"memo\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n+  });\n+\n+  // @gate enableAsyncActions\n+  it('should support useOptimistic hook', () => {\n+    const useOptimistic = React.useOptimistic;\n+    function Foo() {\n+      const [value] = useOptimistic('abc', currentState => currentState);\n+      React.useMemo(() => 'memo', []);\n+      React.useMemo(() => 'not used', []);\n+      return value;\n+    }\n+\n+    const renderer = ReactTestRenderer.create(<Foo />);\n+    const childFiber = renderer.root.findByType(Foo)._currentFiber();\n+    const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": false,\n+          \"name\": \"Optimistic\",\n+          \"subHooks\": [],\n+          \"value\": \"abc\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"memo\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n+  });\n+\n+  // @gate enableFormActions && enableAsyncActions\n+  it('should support useFormState hook', () => {\n+    function Foo() {\n+      const [value] = ReactDOM.useFormState(function increment(n) {\n+        return n;\n+      }, 0);\n+      React.useMemo(() => 'memo', []);\n+      React.useMemo(() => 'not used', []);\n+\n+      return value;\n+    }\n+\n+    const renderer = ReactTestRenderer.create(<Foo />);\n+    const childFiber = renderer.root.findByType(Foo)._currentFiber();\n+    const tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": false,\n+          \"name\": \"FormState\",\n+          \"subHooks\": [],\n+          \"value\": 0,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"memo\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n   });\n });"
            },
            {
                "file": "packages/react-devtools-core/package.json",
                "git_diff": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"react-devtools-core\",\n-  \"version\": \"5.0.0\",\n+  \"version\": \"5.0.2\",\n   \"description\": \"Use react-devtools outside of the browser\",\n   \"license\": \"MIT\",\n   \"main\": \"./dist/backend.js\","
            },
            {
                "file": "packages/react-devtools-core/src/standalone.js",
                "git_diff": "@@ -33,7 +33,7 @@ import {\n import {localStorageSetItem} from 'react-devtools-shared/src/storage';\n \n import type {FrontendBridge} from 'react-devtools-shared/src/bridge';\n-import type {InspectedElement} from 'react-devtools-shared/src/frontend/types';\n+import type {Source} from 'react-devtools-shared/src/shared/types';\n \n installHook(window);\n \n@@ -127,36 +127,55 @@ function reload() {\n         store: ((store: any): Store),\n         warnIfLegacyBackendDetected: true,\n         viewElementSourceFunction,\n+        fetchFileWithCaching,\n       }),\n     );\n   }, 100);\n }\n \n+const resourceCache: Map<string, string> = new Map();\n+\n+// As a potential improvement, this should be done from the backend of RDT.\n+// Browser extension is doing this via exchanging messages\n+// between devtools_page and dedicated content script for it, see `fetchFileWithCaching.js`.\n+async function fetchFileWithCaching(url: string) {\n+  if (resourceCache.has(url)) {\n+    return Promise.resolve(resourceCache.get(url));\n+  }\n+\n+  return fetch(url)\n+    .then(data => data.text())\n+    .then(content => {\n+      resourceCache.set(url, content);\n+\n+      return content;\n+    });\n+}\n+\n function canViewElementSourceFunction(\n-  inspectedElement: InspectedElement,\n+  _source: Source,\n+  symbolicatedSource: Source | null,\n ): boolean {\n-  if (\n-    inspectedElement.canViewSource === false ||\n-    inspectedElement.source === null\n-  ) {\n+  if (symbolicatedSource == null) {\n     return false;\n   }\n \n-  const {source} = inspectedElement;\n-\n-  return doesFilePathExist(source.fileName, projectRoots);\n+  return doesFilePathExist(symbolicatedSource.sourceURL, projectRoots);\n }\n \n function viewElementSourceFunction(\n-  id: number,\n-  inspectedElement: InspectedElement,\n+  _source: Source,\n+  symbolicatedSource: Source | null,\n ): void {\n-  const {source} = inspectedElement;\n-  if (source !== null) {\n-    launchEditor(source.fileName, source.lineNumber, projectRoots);\n-  } else {\n-    log.error('Cannot inspect element', id);\n+  if (symbolicatedSource == null) {\n+    return;\n   }\n+\n+  launchEditor(\n+    symbolicatedSource.sourceURL,\n+    symbolicatedSource.line,\n+    projectRoots,\n+  );\n }\n \n function onDisconnected() {"
            },
            {
                "file": "packages/react-devtools-extensions/chrome/manifest.json",
                "git_diff": "@@ -2,8 +2,8 @@\n   \"manifest_version\": 3,\n   \"name\": \"React Developer Tools\",\n   \"description\": \"Adds React debugging tools to the Chrome Developer Tools.\",\n-  \"version\": \"5.0.0\",\n-  \"version_name\": \"5.0.0\",\n+  \"version\": \"5.0.2\",\n+  \"version_name\": \"5.0.2\",\n   \"minimum_chrome_version\": \"102\",\n   \"icons\": {\n     \"16\": \"icons/16-production.png\","
            },
            {
                "file": "packages/react-devtools-extensions/edge/manifest.json",
                "git_diff": "@@ -2,8 +2,8 @@\n   \"manifest_version\": 3,\n   \"name\": \"React Developer Tools\",\n   \"description\": \"Adds React debugging tools to the Microsoft Edge Developer Tools.\",\n-  \"version\": \"5.0.0\",\n-  \"version_name\": \"5.0.0\",\n+  \"version\": \"5.0.2\",\n+  \"version_name\": \"5.0.2\",\n   \"minimum_chrome_version\": \"102\",\n   \"icons\": {\n     \"16\": \"icons/16-production.png\","
            },
            {
                "file": "packages/react-devtools-extensions/firefox/manifest.json",
                "git_diff": "@@ -2,7 +2,7 @@\n   \"manifest_version\": 2,\n   \"name\": \"React Developer Tools\",\n   \"description\": \"Adds React debugging tools to the Firefox Developer Tools.\",\n-  \"version\": \"5.0.0\",\n+  \"version\": \"5.0.2\",\n   \"applications\": {\n     \"gecko\": {\n       \"id\": \"@react-devtools\","
            },
            {
                "file": "packages/react-devtools-extensions/src/main/fetchFileWithCaching.js",
                "git_diff": "@@ -1,5 +1,6 @@\n /* global chrome */\n \n+import {normalizeUrl} from 'react-devtools-shared/src/utils';\n import {__DEBUG__} from 'react-devtools-shared/src/constants';\n \n let debugIDCounter = 0;\n@@ -107,17 +108,35 @@ const fetchFromPage = async (url, resolve, reject) => {\n   });\n };\n \n-// Fetching files from the extension won't make use of the network cache\n-// for resources that have already been loaded by the page.\n-// This helper function allows the extension to request files to be fetched\n-// by the content script (running in the page) to increase the likelihood of a cache hit.\n-const fetchFileWithCaching = url => {\n+// 1. Check if resource is available via chrome.devtools.inspectedWindow.getResources\n+// 2. Check if resource was loaded previously and available in network cache via chrome.devtools.network.getHAR\n+// 3. Fallback to fetching directly from the page context (from backend)\n+async function fetchFileWithCaching(url: string): Promise<string> {\n+  if (__IS_CHROME__ || __IS_EDGE__) {\n+    const resources = await new Promise(resolve =>\n+      chrome.devtools.inspectedWindow.getResources(r => resolve(r)),\n+    );\n+\n+    const normalizedReferenceURL = normalizeUrl(url);\n+    const resource = resources.find(r => r.url === normalizedReferenceURL);\n+\n+    if (resource != null) {\n+      const content = await new Promise(resolve =>\n+        resource.getContent(fetchedContent => resolve(fetchedContent)),\n+      );\n+\n+      if (content) {\n+        return content;\n+      }\n+    }\n+  }\n+\n   return new Promise((resolve, reject) => {\n     // Try fetching from the Network cache first.\n     // If DevTools was opened after the page started loading, we may have missed some requests.\n     // So fall back to a fetch() from the page and hope we get a cached response that way.\n     fetchFromNetworkCache(url, resolve, reject);\n   });\n-};\n+}\n \n export default fetchFileWithCaching;"
            },
            {
                "file": "packages/react-devtools-extensions/src/main/index.js",
                "git_diff": "@@ -128,34 +128,13 @@ function createBridgeAndStore() {\n     }\n   };\n \n-  const viewElementSourceFunction = id => {\n-    const rendererID = store.getRendererIDForElement(id);\n-    if (rendererID != null) {\n-      // Ask the renderer interface to determine the component function,\n-      // and store it as a global variable on the window\n-      bridge.send('viewElementSource', {id, rendererID});\n+  const viewElementSourceFunction = (source, symbolicatedSource) => {\n+    const {sourceURL, line, column} = symbolicatedSource\n+      ? symbolicatedSource\n+      : source;\n \n-      setTimeout(() => {\n-        // Ask Chrome to display the location of the component function,\n-        // or a render method if it is a Class (ideally Class instance, not type)\n-        // assuming the renderer found one.\n-        chrome.devtools.inspectedWindow.eval(`\n-                if (window.$type != null) {\n-                  if (\n-                    window.$type &&\n-                    window.$type.prototype &&\n-                    window.$type.prototype.isReactComponent\n-                  ) {\n-                    // inspect Component.render, not constructor\n-                    inspect(window.$type.prototype.render);\n-                  } else {\n-                    // inspect Functional Component\n-                    inspect(window.$type);\n-                  }\n-                }\n-              `);\n-      }, 100);\n-    }\n+    // We use 1-based line and column, Chrome expects them 0-based.\n+    chrome.devtools.panels.openResource(sourceURL, line - 1, column - 1);\n   };\n \n   // TODO (Webpack 5) Hopefully we can remove this prop after the Webpack 5 migration.\n@@ -183,17 +162,14 @@ function createBridgeAndStore() {\n         store,\n         warnIfUnsupportedVersionDetected: true,\n         viewAttributeSourceFunction,\n+        // Firefox doesn't support chrome.devtools.panels.openResource yet\n+        canViewElementSourceFunction: () => __IS_CHROME__ || __IS_EDGE__,\n         viewElementSourceFunction,\n-        viewUrlSourceFunction,\n       }),\n     );\n   };\n }\n \n-const viewUrlSourceFunction = (url, line, col) => {\n-  chrome.devtools.panels.openResource(url, line, col);\n-};\n-\n function ensureInitialHTMLIsCleared(container) {\n   if (container._hasInitialHTMLBeenCleared) {\n     return;"
            },
            {
                "file": "packages/react-devtools-extensions/webpack.config.js",
                "git_diff": "@@ -39,6 +39,7 @@ const LOGGING_URL = process.env.LOGGING_URL || null;\n const IS_CHROME = process.env.IS_CHROME === 'true';\n const IS_FIREFOX = process.env.IS_FIREFOX === 'true';\n const IS_EDGE = process.env.IS_EDGE === 'true';\n+const IS_INTERNAL_VERSION = process.env.FEATURE_FLAG_TARGET === 'extension-fb';\n \n const featureFlagTarget = process.env.FEATURE_FLAG_TARGET || 'extension-oss';\n \n@@ -119,6 +120,7 @@ module.exports = {\n       __IS_CHROME__: IS_CHROME,\n       __IS_FIREFOX__: IS_FIREFOX,\n       __IS_EDGE__: IS_EDGE,\n+      __IS_INTERNAL_VERSION__: IS_INTERNAL_VERSION,\n       'process.env.DEVTOOLS_PACKAGE': `\"react-devtools-extensions\"`,\n       'process.env.DEVTOOLS_VERSION': `\"${DEVTOOLS_VERSION}\"`,\n       'process.env.EDITOR_URL': EDITOR_URL != null ? `\"${EDITOR_URL}\"` : null,"
            },
            {
                "file": "packages/react-devtools-inline/__tests__/__e2e__/components.test.js",
                "git_diff": "@@ -59,7 +59,7 @@ test.describe('Components', () => {\n     const isEditableValue = semver.gte(config.use.react_version, '16.8.0');\n \n     // Then read the inspected values.\n-    const [propName, propValue, sourceText] = await page.evaluate(\n+    const [propName, propValue] = await page.evaluate(\n       isEditable => {\n         const {createTestNameSelector, findAllNodes} =\n           window.REACT_DOM_DEVTOOLS;\n@@ -85,21 +85,41 @@ test.describe('Components', () => {\n           createTestNameSelector('InspectedElementPropsTree'),\n           createTestNameSelector(selectorValue),\n         ])[0];\n-        const source = findAllNodes(container, [\n-          createTestNameSelector('InspectedElementView-Source'),\n-        ])[0];\n         const value = isEditable.value\n           ? valueElement.value\n           : valueElement.innerText;\n \n-        return [name, value, source.innerText];\n+        return [name, value];\n       },\n       {name: isEditableName, value: isEditableValue}\n     );\n \n     expect(propName).toBe('label');\n     expect(propValue).toBe('\"one\"');\n-    expect(sourceText).toMatch(/ListApp[a-zA-Z]*\\.js/);\n+  });\n+\n+  test('Should allow inspecting source of the element', async () => {\n+    // Source inspection is available only in modern renderer.\n+    runOnlyForReactRange('>=16.8');\n+\n+    // Select the first list item in DevTools.\n+    await devToolsUtils.selectElement(page, 'ListItem', 'List\\nApp');\n+\n+    // Then read the inspected values.\n+    const sourceText = await page.evaluate(() => {\n+      const {createTestNameSelector, findAllNodes} = window.REACT_DOM_DEVTOOLS;\n+      const container = document.getElementById('devtools');\n+\n+      const source = findAllNodes(container, [\n+        createTestNameSelector('InspectedElementView-Source'),\n+      ])[0];\n+\n+      return source.innerText;\n+    });\n+\n+    // If React version is specified, the e2e-regression.html page will be used\n+    // If not, then e2e.html, see playwright.config.js, how url is constructed\n+    expect(sourceText).toMatch(/e2e-app[\\-a-zA-Z]*\\.js/);\n   });\n \n   test('should allow props to be edited', async () => {"
            },
            {
                "file": "packages/react-devtools-inline/__tests__/__e2e__/devtools-utils.js",
                "git_diff": "@@ -37,7 +37,10 @@ async function selectElement(page, displayName, waitForOwnersText) {\n       createTestNameSelector('ComponentTreeListItem'),\n       createTextSelector(listItemText),\n     ])[0];\n-    listItem.click();\n+\n+    listItem.dispatchEvent(\n+      new MouseEvent('mousedown', {bubbles: true, cancelable: true})\n+    );\n   }, displayName);\n \n   if (waitForOwnersText) {"
            },
            {
                "file": "packages/react-devtools-inline/package.json",
                "git_diff": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"react-devtools-inline\",\n-  \"version\": \"5.0.0\",\n+  \"version\": \"5.0.2\",\n   \"description\": \"Embed react-devtools within a website\",\n   \"license\": \"MIT\",\n   \"main\": \"./dist/backend.js\","
            },
            {
                "file": "packages/react-devtools-shared/package.json",
                "git_diff": "@@ -19,10 +19,12 @@\n     \"@reach/tooltip\": \"^0.16.0\",\n     \"clipboard-js\": \"^0.3.6\",\n     \"compare-versions\": \"^5.0.3\",\n+    \"jsc-safe-url\": \"^0.2.4\",\n     \"json5\": \"^2.1.3\",\n     \"local-storage-fallback\": \"^4.1.1\",\n     \"lodash.throttle\": \"^4.1.1\",\n     \"memoize-one\": \"^3.1.1\",\n-    \"react-virtualized-auto-sizer\": \"^1.0.6\"\n+    \"react-virtualized-auto-sizer\": \"^1.0.23\",\n+    \"react-window\": \"^1.8.10\"\n   }\n }"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/FastRefreshDevToolsIntegration-test.js",
                "git_diff": "@@ -7,25 +7,22 @@\n  * @flow\n  */\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('Fast Refresh', () => {\n   let React;\n   let ReactFreshRuntime;\n   let act;\n   let babel;\n-  let container;\n   let exportsObj;\n   let freshPlugin;\n-  let legacyRender;\n   let store;\n   let withErrorsOrWarningsIgnored;\n \n-  afterEach(() => {\n-    jest.resetModules();\n-  });\n-\n   beforeEach(() => {\n+    global.IS_REACT_ACT_ENVIRONMENT = true;\n+\n     exportsObj = undefined;\n-    container = document.createElement('div');\n \n     babel = require('@babel/core');\n     freshPlugin = require('react-refresh/babel');\n@@ -39,10 +36,12 @@ describe('Fast Refresh', () => {\n \n     const utils = require('./utils');\n     act = utils.act;\n-    legacyRender = utils.legacyRender;\n     withErrorsOrWarningsIgnored = utils.withErrorsOrWarningsIgnored;\n   });\n \n+  const {render: renderImplementation, getContainer} =\n+    getVersionedRenderImplementation();\n+\n   function execute(source) {\n     const compiled = babel.transform(source, {\n       babelrc: false,\n@@ -73,7 +72,7 @@ describe('Fast Refresh', () => {\n   function render(source) {\n     const Component = execute(source);\n     act(() => {\n-      legacyRender(<Component />, container);\n+      renderImplementation(<Component />);\n     });\n     // Module initialization shouldn't be counted as a hot update.\n     expect(ReactFreshRuntime.performReactRefresh()).toBe(null);\n@@ -98,7 +97,7 @@ describe('Fast Refresh', () => {\n       // Here, we'll just force a re-render using the newer type to emulate this.\n       const NextComponent = nextExports.default;\n       act(() => {\n-        legacyRender(<NextComponent />, container);\n+        renderImplementation(<NextComponent />);\n       });\n     }\n     act(() => {\n@@ -142,8 +141,8 @@ describe('Fast Refresh', () => {\n             <Child key=\"A\">\n     `);\n \n-    let element = container.firstChild;\n-    expect(container.firstChild).not.toBe(null);\n+    let element = getContainer().firstChild;\n+    expect(getContainer().firstChild).not.toBe(null);\n \n     patch(`\n       function Parent() {\n@@ -163,8 +162,8 @@ describe('Fast Refresh', () => {\n     `);\n \n     // State is preserved; this verifies that Fast Refresh is wired up.\n-    expect(container.firstChild).toBe(element);\n-    element = container.firstChild;\n+    expect(getContainer().firstChild).toBe(element);\n+    element = getContainer().firstChild;\n \n     patch(`\n       function Parent() {\n@@ -184,7 +183,7 @@ describe('Fast Refresh', () => {\n     `);\n \n     // State is reset because hooks changed.\n-    expect(container.firstChild).not.toBe(element);\n+    expect(getContainer().firstChild).not.toBe(element);\n   });\n \n   // @reactVersion >= 16.9"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/TimelineProfiler-test.js",
                "git_diff": "@@ -9,51 +9,25 @@\n \n 'use strict';\n \n-import {normalizeCodeLocInfo} from './utils';\n+import {\n+  getLegacyRenderImplementation,\n+  getModernRenderImplementation,\n+  normalizeCodeLocInfo,\n+} from './utils';\n \n describe('Timeline profiler', () => {\n   let React;\n-  let ReactDOMClient;\n   let Scheduler;\n-  let renderHelper;\n-  let renderRootHelper;\n   let store;\n-  let unmountFns;\n   let utils;\n-  let waitFor;\n-  let waitForAll;\n-  let waitForPaint;\n-  let assertLog;\n \n   beforeEach(() => {\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    unmountFns = [];\n-    renderHelper = element => {\n-      const unmountFn = utils.legacyRender(element);\n-      unmountFns.push(unmountFn);\n-      return unmountFn;\n-    };\n-    renderRootHelper = element => {\n-      const container = document.createElement('div');\n-      const root = ReactDOMClient.createRoot(container);\n-      root.render(element);\n-      const unmountFn = () => root.unmount();\n-      unmountFns.push(unmountFn);\n-      return unmountFn;\n-    };\n-\n     React = require('react');\n-    ReactDOMClient = require('react-dom/client');\n     Scheduler = require('scheduler');\n \n-    const InternalTestUtils = require('internal-test-utils');\n-    waitFor = InternalTestUtils.waitFor;\n-    waitForAll = InternalTestUtils.waitForAll;\n-    waitForPaint = InternalTestUtils.waitForPaint;\n-    assertLog = InternalTestUtils.assertLog;\n-\n     store = global.store;\n   });\n \n@@ -135,18 +109,57 @@ describe('Timeline profiler', () => {\n       // Verify all logged marks also get cleared.\n       expect(marks).toHaveLength(0);\n \n-      unmountFns.forEach(unmountFn => unmountFn());\n-\n       setPerformanceMock(null);\n     });\n \n-    it('should mark sync render without suspends or state updates', () => {\n-      renderHelper(<div />);\n+    describe('with legacy render', () => {\n+      const {render: legacyRender} = getLegacyRenderImplementation();\n+\n+      // @reactVersion <= 18.2\n+      // @reactVersion >= 18.0\n+      it('should mark sync render without suspends or state updates', () => {\n+        legacyRender(<div />);\n+\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n+        [\n+          \"--schedule-render-1\",\n+          \"--render-start-1\",\n+          \"--render-stop\",\n+          \"--commit-start-1\",\n+          \"--react-version-<filtered-version>\",\n+          \"--profiler-version-1\",\n+          \"--react-internal-module-start-  at filtered (<anonymous>:0:0)\",\n+          \"--react-internal-module-stop-  at filtered (<anonymous>:1:1)\",\n+          \"--react-lane-labels-Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen\",\n+          \"--layout-effects-start-1\",\n+          \"--layout-effects-stop\",\n+          \"--commit-stop\",\n+        ]\n+      `);\n+      });\n+\n+      // TODO(hoxyq): investigate why running this test with React 18 fails\n+      // @reactVersion <= 18.2\n+      // @reactVersion >= 18.0\n+      xit('should mark sync render with suspense that resolves', async () => {\n+        const fakeSuspensePromise = Promise.resolve(true);\n+        function Example() {\n+          throw fakeSuspensePromise;\n+        }\n+\n+        legacyRender(\n+          <React.Suspense fallback={null}>\n+            <Example />\n+          </React.Suspense>,\n+        );\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-2\",\n           \"--render-start-2\",\n+          \"--component-render-start-Example\",\n+          \"--component-render-stop\",\n+          \"--suspense-suspend-0-Example-mount-2-\",\n           \"--render-stop\",\n           \"--commit-start-2\",\n           \"--react-version-<filtered-version>\",\n@@ -159,173 +172,224 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n \n-    it('should mark concurrent render without suspends or state updates', async () => {\n-      renderRootHelper(<div />);\n+        clearPendingMarks();\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n-        [\n-          \"--schedule-render-32\",\n-        ]\n-      `);\n+        await fakeSuspensePromise;\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n+                [\n+                  \"--suspense-resolved-0-Example\",\n+                ]\n+          `);\n+      });\n \n-      clearPendingMarks();\n+      // TODO(hoxyq): investigate why running this test with React 18 fails\n+      // @reactVersion <= 18.2\n+      // @reactVersion >= 18.0\n+      xit('should mark sync render with suspense that rejects', async () => {\n+        const fakeSuspensePromise = Promise.reject(new Error('error'));\n+        function Example() {\n+          throw fakeSuspensePromise;\n+        }\n \n-      await waitForPaint([]);\n+        legacyRender(\n+          <React.Suspense fallback={null}>\n+            <Example />\n+          </React.Suspense>,\n+        );\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n-          \"--render-start-32\",\n+          \"--schedule-render-2\",\n+          \"--render-start-2\",\n+          \"--component-render-start-Example\",\n+          \"--component-render-stop\",\n+          \"--suspense-suspend-0-Example-mount-2-\",\n           \"--render-stop\",\n-          \"--commit-start-32\",\n+          \"--commit-start-2\",\n           \"--react-version-<filtered-version>\",\n           \"--profiler-version-1\",\n           \"--react-internal-module-start-  at filtered (<anonymous>:0:0)\",\n           \"--react-internal-module-stop-  at filtered (<anonymous>:1:1)\",\n           \"--react-lane-labels-SyncHydrationLane,Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen,Deferred\",\n-          \"--layout-effects-start-32\",\n+          \"--layout-effects-start-2\",\n           \"--layout-effects-stop\",\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n-\n-    it('should mark render yields', async () => {\n-      function Bar() {\n-        Scheduler.log('Bar');\n-        return null;\n-      }\n \n-      function Foo() {\n-        Scheduler.log('Foo');\n-        return <Bar />;\n-      }\n+        clearPendingMarks();\n \n-      React.startTransition(() => {\n-        renderRootHelper(<Foo />);\n+        await expect(fakeSuspensePromise).rejects.toThrow();\n+        expect(clearedMarks).toContain(`--suspense-rejected-0-Example`);\n       });\n \n-      await waitFor(['Foo']);\n+      // @reactVersion <= 18.2\n+      // @reactVersion >= 18.0\n+      it('should mark sync render that throws', async () => {\n+        jest.spyOn(console, 'error').mockImplementation(() => {});\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n-        [\n-          \"--schedule-render-128\",\n-          \"--render-start-128\",\n-          \"--component-render-start-Foo\",\n-          \"--component-render-stop\",\n-          \"--render-yield\",\n-        ]\n-      `);\n-    });\n+        class ErrorBoundary extends React.Component {\n+          state = {error: null};\n+          componentDidCatch(error) {\n+            this.setState({error});\n+          }\n+          render() {\n+            if (this.state.error) {\n+              return null;\n+            }\n+            return this.props.children;\n+          }\n+        }\n \n-    it('should mark sync render with suspense that resolves', async () => {\n-      const fakeSuspensePromise = Promise.resolve(true);\n-      function Example() {\n-        throw fakeSuspensePromise;\n-      }\n+        function ExampleThatThrows() {\n+          throw Error('Expected error');\n+        }\n \n-      renderHelper(\n-        <React.Suspense fallback={null}>\n-          <Example />\n-        </React.Suspense>,\n-      );\n+        legacyRender(\n+          <ErrorBoundary>\n+            <ExampleThatThrows />\n+          </ErrorBoundary>,\n+        );\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n-          \"--schedule-render-2\",\n-          \"--render-start-2\",\n-          \"--component-render-start-Example\",\n+          \"--schedule-render-1\",\n+          \"--render-start-1\",\n+          \"--component-render-start-ErrorBoundary\",\n           \"--component-render-stop\",\n-          \"--suspense-suspend-0-Example-mount-2-\",\n+          \"--component-render-start-ExampleThatThrows\",\n+          \"--component-render-start-ExampleThatThrows\",\n+          \"--component-render-stop\",\n+          \"--error-ExampleThatThrows-mount-Expected error\",\n           \"--render-stop\",\n-          \"--commit-start-2\",\n+          \"--commit-start-1\",\n           \"--react-version-<filtered-version>\",\n           \"--profiler-version-1\",\n           \"--react-internal-module-start-  at filtered (<anonymous>:0:0)\",\n           \"--react-internal-module-stop-  at filtered (<anonymous>:1:1)\",\n-          \"--react-lane-labels-SyncHydrationLane,Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen,Deferred\",\n-          \"--layout-effects-start-2\",\n+          \"--react-lane-labels-Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen\",\n+          \"--layout-effects-start-1\",\n+          \"--schedule-state-update-1-ErrorBoundary\",\n           \"--layout-effects-stop\",\n           \"--commit-stop\",\n+          \"--render-start-1\",\n+          \"--component-render-start-ErrorBoundary\",\n+          \"--component-render-stop\",\n+          \"--render-stop\",\n+          \"--commit-start-1\",\n+          \"--react-version-<filtered-version>\",\n+          \"--profiler-version-1\",\n+          \"--react-internal-module-start-  at filtered (<anonymous>:0:0)\",\n+          \"--react-internal-module-stop-  at filtered (<anonymous>:1:1)\",\n+          \"--react-lane-labels-Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen\",\n+          \"--commit-stop\",\n         ]\n       `);\n+      });\n+    });\n \n-      clearPendingMarks();\n+    describe('with createRoot', () => {\n+      let waitFor;\n+      let waitForAll;\n+      let waitForPaint;\n+      let assertLog;\n \n-      await fakeSuspensePromise;\n-      expect(clearedMarks).toMatchInlineSnapshot(`\n-                [\n-                  \"--suspense-resolved-0-Example\",\n-                ]\n-          `);\n-    });\n+      beforeEach(() => {\n+        const InternalTestUtils = require('internal-test-utils');\n+        waitFor = InternalTestUtils.waitFor;\n+        waitForAll = InternalTestUtils.waitForAll;\n+        waitForPaint = InternalTestUtils.waitForPaint;\n+        assertLog = InternalTestUtils.assertLog;\n+      });\n \n-    it('should mark sync render with suspense that rejects', async () => {\n-      const fakeSuspensePromise = Promise.reject(new Error('error'));\n-      function Example() {\n-        throw fakeSuspensePromise;\n-      }\n+      const {render: modernRender} = getModernRenderImplementation();\n \n-      renderHelper(\n-        <React.Suspense fallback={null}>\n-          <Example />\n-        </React.Suspense>,\n-      );\n+      it('should mark concurrent render without suspends or state updates', async () => {\n+        modernRender(<div />);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n-          \"--schedule-render-2\",\n-          \"--render-start-2\",\n-          \"--component-render-start-Example\",\n-          \"--component-render-stop\",\n-          \"--suspense-suspend-0-Example-mount-2-\",\n+          \"--schedule-render-32\",\n+        ]\n+      `);\n+\n+        clearPendingMarks();\n+\n+        await waitForPaint([]);\n+\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n+        [\n+          \"--render-start-32\",\n           \"--render-stop\",\n-          \"--commit-start-2\",\n+          \"--commit-start-32\",\n           \"--react-version-<filtered-version>\",\n           \"--profiler-version-1\",\n           \"--react-internal-module-start-  at filtered (<anonymous>:0:0)\",\n           \"--react-internal-module-stop-  at filtered (<anonymous>:1:1)\",\n           \"--react-lane-labels-SyncHydrationLane,Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen,Deferred\",\n-          \"--layout-effects-start-2\",\n+          \"--layout-effects-start-32\",\n           \"--layout-effects-stop\",\n           \"--commit-stop\",\n         ]\n       `);\n+      });\n \n-      clearPendingMarks();\n+      it('should mark render yields', async () => {\n+        function Bar() {\n+          Scheduler.log('Bar');\n+          return null;\n+        }\n \n-      await expect(fakeSuspensePromise).rejects.toThrow();\n-      expect(clearedMarks).toContain(`--suspense-rejected-0-Example`);\n-    });\n+        function Foo() {\n+          Scheduler.log('Foo');\n+          return <Bar />;\n+        }\n+\n+        React.startTransition(() => {\n+          modernRender(<Foo />);\n+        });\n \n-    it('should mark concurrent render with suspense that resolves', async () => {\n-      let resolveFakePromise;\n-      const fakeSuspensePromise = new Promise(\n-        resolve => (resolveFakePromise = resolve),\n-      );\n+        await waitFor(['Foo']);\n \n-      function Example() {\n-        throw fakeSuspensePromise;\n-      }\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n+        [\n+          \"--schedule-render-128\",\n+          \"--render-start-128\",\n+          \"--component-render-start-Foo\",\n+          \"--component-render-stop\",\n+          \"--render-yield\",\n+        ]\n+      `);\n+      });\n+\n+      it('should mark concurrent render with suspense that resolves', async () => {\n+        let resolveFakePromise;\n+        const fakeSuspensePromise = new Promise(\n+          resolve => (resolveFakePromise = resolve),\n+        );\n+\n+        function Example() {\n+          throw fakeSuspensePromise;\n+        }\n \n-      renderRootHelper(\n-        <React.Suspense fallback={null}>\n-          <Example />\n-        </React.Suspense>,\n-      );\n+        modernRender(\n+          <React.Suspense fallback={null}>\n+            <Example />\n+          </React.Suspense>,\n+        );\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await waitForPaint([]);\n+        await waitForPaint([]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--render-start-32\",\n           \"--component-render-start-Example\",\n@@ -344,43 +408,43 @@ describe('Timeline profiler', () => {\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await resolveFakePromise();\n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        await resolveFakePromise();\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n             [\n               \"--suspense-resolved-0-Example\",\n             ]\n         `);\n-    });\n+      });\n \n-    it('should mark concurrent render with suspense that rejects', async () => {\n-      let rejectFakePromise;\n-      const fakeSuspensePromise = new Promise(\n-        (_, reject) => (rejectFakePromise = reject),\n-      );\n+      it('should mark concurrent render with suspense that rejects', async () => {\n+        let rejectFakePromise;\n+        const fakeSuspensePromise = new Promise(\n+          (_, reject) => (rejectFakePromise = reject),\n+        );\n \n-      function Example() {\n-        throw fakeSuspensePromise;\n-      }\n+        function Example() {\n+          throw fakeSuspensePromise;\n+        }\n \n-      renderRootHelper(\n-        <React.Suspense fallback={null}>\n-          <Example />\n-        </React.Suspense>,\n-      );\n+        modernRender(\n+          <React.Suspense fallback={null}>\n+            <Example />\n+          </React.Suspense>,\n+        );\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await waitForPaint([]);\n+        await waitForPaint([]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--render-start-32\",\n           \"--component-render-start-Example\",\n@@ -399,43 +463,43 @@ describe('Timeline profiler', () => {\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await expect(() => {\n-        rejectFakePromise(new Error('error'));\n-        return fakeSuspensePromise;\n-      }).rejects.toThrow();\n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        await expect(() => {\n+          rejectFakePromise(new Error('error'));\n+          return fakeSuspensePromise;\n+        }).rejects.toThrow();\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n                 [\n                   \"--suspense-rejected-0-Example\",\n                 ]\n           `);\n-    });\n+      });\n \n-    it('should mark cascading class component state updates', async () => {\n-      class Example extends React.Component {\n-        state = {didMount: false};\n-        componentDidMount() {\n-          this.setState({didMount: true});\n-        }\n-        render() {\n-          return null;\n+      it('should mark cascading class component state updates', async () => {\n+        class Example extends React.Component {\n+          state = {didMount: false};\n+          componentDidMount() {\n+            this.setState({didMount: true});\n+          }\n+          render() {\n+            return null;\n+          }\n         }\n-      }\n \n-      renderRootHelper(<Example />);\n+        modernRender(<Example />);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await waitForPaint([]);\n+        await waitForPaint([]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--render-start-32\",\n           \"--component-render-start-Example\",\n@@ -464,31 +528,31 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n+      });\n \n-    it('should mark cascading class component force updates', async () => {\n-      class Example extends React.Component {\n-        componentDidMount() {\n-          this.forceUpdate();\n-        }\n-        render() {\n-          return null;\n+      it('should mark cascading class component force updates', async () => {\n+        class Example extends React.Component {\n+          componentDidMount() {\n+            this.forceUpdate();\n+          }\n+          render() {\n+            return null;\n+          }\n         }\n-      }\n \n-      renderRootHelper(<Example />);\n+        modernRender(<Example />);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await waitForPaint([]);\n+        await waitForPaint([]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--render-start-32\",\n           \"--component-render-start-Example\",\n@@ -517,42 +581,42 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n+      });\n \n-    it('should mark render phase state updates for class component', async () => {\n-      class Example extends React.Component {\n-        state = {didRender: false};\n-        render() {\n-          if (this.state.didRender === false) {\n-            this.setState({didRender: true});\n+      it('should mark render phase state updates for class component', async () => {\n+        class Example extends React.Component {\n+          state = {didRender: false};\n+          render() {\n+            if (this.state.didRender === false) {\n+              this.setState({didRender: true});\n+            }\n+            return null;\n           }\n-          return null;\n         }\n-      }\n \n-      renderRootHelper(<Example />);\n+        modernRender(<Example />);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      let errorMessage;\n-      jest.spyOn(console, 'error').mockImplementation(message => {\n-        errorMessage = message;\n-      });\n+        let errorMessage;\n+        jest.spyOn(console, 'error').mockImplementation(message => {\n+          errorMessage = message;\n+        });\n \n-      await waitForPaint([]);\n+        await waitForPaint([]);\n \n-      expect(console.error).toHaveBeenCalledTimes(1);\n-      expect(errorMessage).toContain(\n-        'Cannot update during an existing state transition',\n-      );\n+        expect(console.error).toHaveBeenCalledTimes(1);\n+        expect(errorMessage).toContain(\n+          'Cannot update during an existing state transition',\n+        );\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--render-start-32\",\n           \"--component-render-start-Example\",\n@@ -570,43 +634,43 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n+      });\n \n-    it('should mark render phase force updates for class component', async () => {\n-      let forced = false;\n-      class Example extends React.Component {\n-        render() {\n-          if (!forced) {\n-            forced = true;\n-            this.forceUpdate();\n-          }\n-          return null;\n+      it('should mark render phase force updates for class component', async () => {\n+        let forced = false;\n+        class Example extends React.Component {\n+          render() {\n+            if (!forced) {\n+              forced = true;\n+              this.forceUpdate();\n+            }\n+            return null;\n+          }\n         }\n-      }\n \n-      renderRootHelper(<Example />);\n+        modernRender(<Example />);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      let errorMessage;\n-      jest.spyOn(console, 'error').mockImplementation(message => {\n-        errorMessage = message;\n-      });\n+        let errorMessage;\n+        jest.spyOn(console, 'error').mockImplementation(message => {\n+          errorMessage = message;\n+        });\n \n-      await waitForPaint([]);\n+        await waitForPaint([]);\n \n-      expect(console.error).toHaveBeenCalledTimes(1);\n-      expect(errorMessage).toContain(\n-        'Cannot update during an existing state transition',\n-      );\n+        expect(console.error).toHaveBeenCalledTimes(1);\n+        expect(errorMessage).toContain(\n+          'Cannot update during an existing state transition',\n+        );\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--render-start-32\",\n           \"--component-render-start-Example\",\n@@ -624,30 +688,30 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n+      });\n \n-    it('should mark cascading layout updates', async () => {\n-      function Example() {\n-        const [didMount, setDidMount] = React.useState(false);\n-        React.useLayoutEffect(() => {\n-          setDidMount(true);\n-        }, []);\n-        return didMount;\n-      }\n+      it('should mark cascading layout updates', async () => {\n+        function Example() {\n+          const [didMount, setDidMount] = React.useState(false);\n+          React.useLayoutEffect(() => {\n+            setDidMount(true);\n+          }, []);\n+          return didMount;\n+        }\n \n-      renderRootHelper(<Example />);\n+        modernRender(<Example />);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await waitForPaint([]);\n+        await waitForPaint([]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--render-start-32\",\n           \"--component-render-start-Example\",\n@@ -678,22 +742,22 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n+      });\n \n-    it('should mark cascading passive updates', async () => {\n-      function Example() {\n-        const [didMount, setDidMount] = React.useState(false);\n-        React.useEffect(() => {\n-          setDidMount(true);\n-        }, []);\n-        return didMount;\n-      }\n+      it('should mark cascading passive updates', async () => {\n+        function Example() {\n+          const [didMount, setDidMount] = React.useState(false);\n+          React.useEffect(() => {\n+            setDidMount(true);\n+          }, []);\n+          return didMount;\n+        }\n \n-      renderRootHelper(<Example />);\n+        modernRender(<Example />);\n \n-      await waitForAll([]);\n+        await waitForAll([]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n           \"--render-start-32\",\n@@ -727,22 +791,22 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n+      });\n \n-    it('should mark render phase updates', async () => {\n-      function Example() {\n-        const [didRender, setDidRender] = React.useState(false);\n-        if (!didRender) {\n-          setDidRender(true);\n+      it('should mark render phase updates', async () => {\n+        function Example() {\n+          const [didRender, setDidRender] = React.useState(false);\n+          if (!didRender) {\n+            setDidRender(true);\n+          }\n+          return didRender;\n         }\n-        return didRender;\n-      }\n \n-      renderRootHelper(<Example />);\n+        modernRender(<Example />);\n \n-      await waitForAll([]);\n+        await waitForAll([]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n           \"--render-start-32\",\n@@ -761,108 +825,46 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n+      });\n \n-    it('should mark sync render that throws', async () => {\n-      jest.spyOn(console, 'error').mockImplementation(() => {});\n+      it('should mark concurrent render that throws', async () => {\n+        jest.spyOn(console, 'error').mockImplementation(() => {});\n \n-      class ErrorBoundary extends React.Component {\n-        state = {error: null};\n-        componentDidCatch(error) {\n-          this.setState({error});\n-        }\n-        render() {\n-          if (this.state.error) {\n-            return null;\n+        class ErrorBoundary extends React.Component {\n+          state = {error: null};\n+          componentDidCatch(error) {\n+            this.setState({error});\n           }\n-          return this.props.children;\n-        }\n-      }\n-\n-      function ExampleThatThrows() {\n-        throw Error('Expected error');\n-      }\n-\n-      renderHelper(\n-        <ErrorBoundary>\n-          <ExampleThatThrows />\n-        </ErrorBoundary>,\n-      );\n-\n-      expect(clearedMarks).toMatchInlineSnapshot(`\n-        [\n-          \"--schedule-render-2\",\n-          \"--render-start-2\",\n-          \"--component-render-start-ErrorBoundary\",\n-          \"--component-render-stop\",\n-          \"--component-render-start-ExampleThatThrows\",\n-          \"--component-render-start-ExampleThatThrows\",\n-          \"--component-render-stop\",\n-          \"--error-ExampleThatThrows-mount-Expected error\",\n-          \"--render-stop\",\n-          \"--commit-start-2\",\n-          \"--react-version-<filtered-version>\",\n-          \"--profiler-version-1\",\n-          \"--react-internal-module-start-  at filtered (<anonymous>:0:0)\",\n-          \"--react-internal-module-stop-  at filtered (<anonymous>:1:1)\",\n-          \"--react-lane-labels-SyncHydrationLane,Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen,Deferred\",\n-          \"--layout-effects-start-2\",\n-          \"--schedule-state-update-2-ErrorBoundary\",\n-          \"--layout-effects-stop\",\n-          \"--commit-stop\",\n-          \"--render-start-2\",\n-          \"--component-render-start-ErrorBoundary\",\n-          \"--component-render-stop\",\n-          \"--render-stop\",\n-          \"--commit-start-2\",\n-          \"--react-version-<filtered-version>\",\n-          \"--profiler-version-1\",\n-          \"--react-internal-module-start-  at filtered (<anonymous>:0:0)\",\n-          \"--react-internal-module-stop-  at filtered (<anonymous>:1:1)\",\n-          \"--react-lane-labels-SyncHydrationLane,Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen,Deferred\",\n-          \"--commit-stop\",\n-        ]\n-      `);\n-    });\n-\n-    it('should mark concurrent render that throws', async () => {\n-      jest.spyOn(console, 'error').mockImplementation(() => {});\n-\n-      class ErrorBoundary extends React.Component {\n-        state = {error: null};\n-        componentDidCatch(error) {\n-          this.setState({error});\n-        }\n-        render() {\n-          if (this.state.error) {\n-            return null;\n+          render() {\n+            if (this.state.error) {\n+              return null;\n+            }\n+            return this.props.children;\n           }\n-          return this.props.children;\n         }\n-      }\n \n-      function ExampleThatThrows() {\n-        // eslint-disable-next-line no-throw-literal\n-        throw 'Expected error';\n-      }\n+        function ExampleThatThrows() {\n+          // eslint-disable-next-line no-throw-literal\n+          throw 'Expected error';\n+        }\n \n-      renderRootHelper(\n-        <ErrorBoundary>\n-          <ExampleThatThrows />\n-        </ErrorBoundary>,\n-      );\n+        modernRender(\n+          <ErrorBoundary>\n+            <ExampleThatThrows />\n+          </ErrorBoundary>,\n+        );\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await waitForPaint([]);\n+        await waitForPaint([]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--render-start-32\",\n           \"--component-render-start-ErrorBoundary\",\n@@ -903,53 +905,53 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n-    });\n+      });\n \n-    it('should mark passive and layout effects', async () => {\n-      function ComponentWithEffects() {\n-        React.useLayoutEffect(() => {\n-          Scheduler.log('layout 1 mount');\n-          return () => {\n-            Scheduler.log('layout 1 unmount');\n-          };\n-        }, []);\n-\n-        React.useEffect(() => {\n-          Scheduler.log('passive 1 mount');\n-          return () => {\n-            Scheduler.log('passive 1 unmount');\n-          };\n-        }, []);\n-\n-        React.useLayoutEffect(() => {\n-          Scheduler.log('layout 2 mount');\n-          return () => {\n-            Scheduler.log('layout 2 unmount');\n-          };\n-        }, []);\n-\n-        React.useEffect(() => {\n-          Scheduler.log('passive 2 mount');\n-          return () => {\n-            Scheduler.log('passive 2 unmount');\n-          };\n-        }, []);\n-\n-        React.useEffect(() => {\n-          Scheduler.log('passive 3 mount');\n-          return () => {\n-            Scheduler.log('passive 3 unmount');\n-          };\n-        }, []);\n+      it('should mark passive and layout effects', async () => {\n+        function ComponentWithEffects() {\n+          React.useLayoutEffect(() => {\n+            Scheduler.log('layout 1 mount');\n+            return () => {\n+              Scheduler.log('layout 1 unmount');\n+            };\n+          }, []);\n \n-        return null;\n-      }\n+          React.useEffect(() => {\n+            Scheduler.log('passive 1 mount');\n+            return () => {\n+              Scheduler.log('passive 1 unmount');\n+            };\n+          }, []);\n+\n+          React.useLayoutEffect(() => {\n+            Scheduler.log('layout 2 mount');\n+            return () => {\n+              Scheduler.log('layout 2 unmount');\n+            };\n+          }, []);\n+\n+          React.useEffect(() => {\n+            Scheduler.log('passive 2 mount');\n+            return () => {\n+              Scheduler.log('passive 2 unmount');\n+            };\n+          }, []);\n+\n+          React.useEffect(() => {\n+            Scheduler.log('passive 3 mount');\n+            return () => {\n+              Scheduler.log('passive 3 unmount');\n+            };\n+          }, []);\n+\n+          return null;\n+        }\n \n-      const unmount = renderRootHelper(<ComponentWithEffects />);\n+        const unmount = modernRender(<ComponentWithEffects />);\n \n-      await waitForPaint(['layout 1 mount', 'layout 2 mount']);\n+        await waitForPaint(['layout 1 mount', 'layout 2 mount']);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-32\",\n           \"--render-start-32\",\n@@ -972,15 +974,15 @@ describe('Timeline profiler', () => {\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await waitForAll([\n-        'passive 1 mount',\n-        'passive 2 mount',\n-        'passive 3 mount',\n-      ]);\n+        await waitForAll([\n+          'passive 1 mount',\n+          'passive 2 mount',\n+          'passive 3 mount',\n+        ]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--passive-effects-start-32\",\n           \"--component-passive-effect-mount-start-ComponentWithEffects\",\n@@ -993,21 +995,21 @@ describe('Timeline profiler', () => {\n         ]\n       `);\n \n-      clearPendingMarks();\n+        clearPendingMarks();\n \n-      await waitForAll([]);\n+        await waitForAll([]);\n \n-      unmount();\n+        unmount();\n \n-      assertLog([\n-        'layout 1 unmount',\n-        'layout 2 unmount',\n-        'passive 1 unmount',\n-        'passive 2 unmount',\n-        'passive 3 unmount',\n-      ]);\n+        assertLog([\n+          'layout 1 unmount',\n+          'layout 2 unmount',\n+          'passive 1 unmount',\n+          'passive 2 unmount',\n+          'passive 3 unmount',\n+        ]);\n \n-      expect(clearedMarks).toMatchInlineSnapshot(`\n+        expect(clearedMarks).toMatchInlineSnapshot(`\n         [\n           \"--schedule-render-2\",\n           \"--render-start-2\",\n@@ -1035,61 +1037,78 @@ describe('Timeline profiler', () => {\n           \"--commit-stop\",\n         ]\n       `);\n+      });\n     });\n \n     describe('lane labels', () => {\n-      it('regression test SyncLane', () => {\n-        renderHelper(<div />);\n+      describe('with legacy render', () => {\n+        const {render: legacyRender} = getLegacyRenderImplementation();\n \n-        expect(clearedMarks).toMatchInlineSnapshot(`\n+        // @reactVersion <= 18.2\n+        // @reactVersion >= 18.0\n+        it('regression test SyncLane', () => {\n+          legacyRender(<div />);\n+\n+          expect(clearedMarks).toMatchInlineSnapshot(`\n           [\n-            \"--schedule-render-2\",\n-            \"--render-start-2\",\n+            \"--schedule-render-1\",\n+            \"--render-start-1\",\n             \"--render-stop\",\n-            \"--commit-start-2\",\n+            \"--commit-start-1\",\n             \"--react-version-<filtered-version>\",\n             \"--profiler-version-1\",\n             \"--react-internal-module-start-  at filtered (<anonymous>:0:0)\",\n             \"--react-internal-module-stop-  at filtered (<anonymous>:1:1)\",\n-            \"--react-lane-labels-SyncHydrationLane,Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen,Deferred\",\n-            \"--layout-effects-start-2\",\n+            \"--react-lane-labels-Sync,InputContinuousHydration,InputContinuous,DefaultHydration,Default,TransitionHydration,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Transition,Retry,Retry,Retry,Retry,Retry,SelectiveHydration,IdleHydration,Idle,Offscreen\",\n+            \"--layout-effects-start-1\",\n             \"--layout-effects-stop\",\n             \"--commit-stop\",\n           ]\n         `);\n+        });\n       });\n \n-      it('regression test DefaultLane', () => {\n-        renderRootHelper(<div />);\n-        expect(clearedMarks).toMatchInlineSnapshot(`\n+      describe('with createRoot()', () => {\n+        let waitForAll;\n+\n+        beforeEach(() => {\n+          const InternalTestUtils = require('internal-test-utils');\n+          waitForAll = InternalTestUtils.waitForAll;\n+        });\n+\n+        const {render: modernRender} = getModernRenderImplementation();\n+\n+        it('regression test DefaultLane', () => {\n+          modernRender(<div />);\n+          expect(clearedMarks).toMatchInlineSnapshot(`\n           [\n             \"--schedule-render-32\",\n           ]\n         `);\n-      });\n+        });\n \n-      it('regression test InputDiscreteLane', async () => {\n-        const targetRef = React.createRef(null);\n+        it('regression test InputDiscreteLane', async () => {\n+          const targetRef = React.createRef(null);\n \n-        function App() {\n-          const [count, setCount] = React.useState(0);\n-          const handleClick = () => {\n-            setCount(count + 1);\n-          };\n-          return <button ref={targetRef} onClick={handleClick} />;\n-        }\n+          function App() {\n+            const [count, setCount] = React.useState(0);\n+            const handleClick = () => {\n+              setCount(count + 1);\n+            };\n+            return <button ref={targetRef} onClick={handleClick} />;\n+          }\n \n-        renderRootHelper(<App />);\n-        await waitForAll([]);\n+          modernRender(<App />);\n+          await waitForAll([]);\n \n-        clearedMarks.splice(0);\n+          clearedMarks.splice(0);\n \n-        targetRef.current.click();\n+          targetRef.current.click();\n \n-        // Wait a frame, for React to process the \"click\" update.\n-        await Promise.resolve();\n+          // Wait a frame, for React to process the \"click\" update.\n+          await Promise.resolve();\n \n-        expect(clearedMarks).toMatchInlineSnapshot(`\n+          expect(clearedMarks).toMatchInlineSnapshot(`\n           [\n             \"--schedule-state-update-2-App\",\n             \"--render-start-2\",\n@@ -1107,29 +1126,29 @@ describe('Timeline profiler', () => {\n             \"--commit-stop\",\n           ]\n         `);\n-      });\n+        });\n \n-      it('regression test InputContinuousLane', async () => {\n-        const targetRef = React.createRef(null);\n+        it('regression test InputContinuousLane', async () => {\n+          const targetRef = React.createRef(null);\n \n-        function App() {\n-          const [count, setCount] = React.useState(0);\n-          const handleMouseOver = () => setCount(count + 1);\n-          return <div ref={targetRef} onMouseOver={handleMouseOver} />;\n-        }\n+          function App() {\n+            const [count, setCount] = React.useState(0);\n+            const handleMouseOver = () => setCount(count + 1);\n+            return <div ref={targetRef} onMouseOver={handleMouseOver} />;\n+          }\n \n-        renderRootHelper(<App />);\n-        await waitForAll([]);\n+          modernRender(<App />);\n+          await waitForAll([]);\n \n-        clearedMarks.splice(0);\n+          clearedMarks.splice(0);\n \n-        const event = document.createEvent('MouseEvents');\n-        event.initEvent('mouseover', true, true);\n-        dispatchAndSetCurrentEvent(targetRef.current, event);\n+          const event = document.createEvent('MouseEvents');\n+          event.initEvent('mouseover', true, true);\n+          dispatchAndSetCurrentEvent(targetRef.current, event);\n \n-        await waitForAll([]);\n+          await waitForAll([]);\n \n-        expect(clearedMarks).toMatchInlineSnapshot(`\n+          expect(clearedMarks).toMatchInlineSnapshot(`\n           [\n             \"--schedule-state-update-8-App\",\n             \"--render-start-8\",\n@@ -1147,6 +1166,7 @@ describe('Timeline profiler', () => {\n             \"--commit-stop\",\n           ]\n         `);\n+        });\n       });\n     });\n   });\n@@ -1196,181 +1216,170 @@ describe('Timeline profiler', () => {\n       };\n     });\n \n-    afterEach(() => {\n-      unmountFns.forEach(unmountFn => unmountFn());\n-    });\n-\n     describe('when profiling', () => {\n       beforeEach(() => {\n         utils.act(() => store.profilerStore.startProfiling());\n       });\n \n-      it('should mark sync render without suspends or state updates', () => {\n-        renderHelper(<div />);\n+      describe('with legacy render', () => {\n+        const {render: legacyRender} = getLegacyRenderImplementation();\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+        // @reactVersion <= 18.2\n+        // @reactVersion >= 18.0\n+        it('should mark sync render without suspends or state updates', () => {\n+          legacyRender(<div />);\n+\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n-              \"lanes\": \"0b0000000000000000000000000000010\",\n+              \"lanes\": \"0b0000000000000000000000000000001\",\n               \"timestamp\": 10,\n               \"type\": \"schedule-render\",\n               \"warning\": null,\n             },\n           ]\n         `);\n-      });\n+        });\n \n-      it('should mark concurrent render without suspends or state updates', () => {\n-        utils.act(() => renderRootHelper(<div />));\n+        // @reactVersion <= 18.2\n+        // @reactVersion >= 18.0\n+        it('should mark sync render that throws', async () => {\n+          jest.spyOn(console, 'error').mockImplementation(() => {});\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          class ErrorBoundary extends React.Component {\n+            state = {error: null};\n+            componentDidCatch(error) {\n+              this.setState({error});\n+            }\n+            render() {\n+              Scheduler.unstable_advanceTime(10);\n+              if (this.state.error) {\n+                Scheduler.unstable_yieldValue('ErrorBoundary fallback');\n+                return null;\n+              }\n+              Scheduler.unstable_yieldValue('ErrorBoundary render');\n+              return this.props.children;\n+            }\n+          }\n+\n+          function ExampleThatThrows() {\n+            Scheduler.unstable_yieldValue('ExampleThatThrows');\n+            throw Error('Expected error');\n+          }\n+\n+          legacyRender(\n+            <ErrorBoundary>\n+              <ExampleThatThrows />\n+            </ErrorBoundary>,\n+          );\n+\n+          expect(Scheduler.unstable_clearYields()).toEqual([\n+            'ErrorBoundary render',\n+            'ExampleThatThrows',\n+            'ExampleThatThrows',\n+            'ErrorBoundary fallback',\n+          ]);\n+\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n-              \"lanes\": \"0b0000000000000000000000000100000\",\n+              \"componentName\": \"ErrorBoundary\",\n+              \"duration\": 10,\n               \"timestamp\": 10,\n-              \"type\": \"schedule-render\",\n+              \"type\": \"render\",\n+              \"warning\": null,\n+            },\n+            {\n+              \"componentName\": \"ExampleThatThrows\",\n+              \"duration\": 0,\n+              \"timestamp\": 20,\n+              \"type\": \"render\",\n+              \"warning\": null,\n+            },\n+            {\n+              \"componentName\": \"ErrorBoundary\",\n+              \"duration\": 10,\n+              \"timestamp\": 20,\n+              \"type\": \"render\",\n               \"warning\": null,\n             },\n           ]\n         `);\n-      });\n-\n-      it('should mark concurrent render without suspends or state updates', () => {\n-        let updaterFn;\n-\n-        function Example() {\n-          const setHigh = React.useState(0)[1];\n-          const setLow = React.useState(0)[1];\n-\n-          updaterFn = () => {\n-            React.startTransition(() => {\n-              setLow(prevLow => prevLow + 1);\n-            });\n-            setHigh(prevHigh => prevHigh + 1);\n-          };\n-\n-          Scheduler.unstable_advanceTime(10);\n-\n-          return null;\n-        }\n-\n-        utils.act(() => renderRootHelper(<Example />));\n-        utils.act(() => store.profilerStore.stopProfiling());\n-        utils.act(() => store.profilerStore.startProfiling());\n-        utils.act(updaterFn);\n-\n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n-              \"componentName\": \"Example\",\n-              \"componentStack\": \"\n-              in Example (at **)\",\n-              \"lanes\": \"0b0000000000000000000000010000000\",\n+              \"lanes\": \"0b0000000000000000000000000000001\",\n               \"timestamp\": 10,\n-              \"type\": \"schedule-state-update\",\n+              \"type\": \"schedule-render\",\n               \"warning\": null,\n             },\n             {\n-              \"componentName\": \"Example\",\n+              \"componentName\": \"ErrorBoundary\",\n               \"componentStack\": \"\n-              in Example (at **)\",\n-              \"lanes\": \"0b0000000000000000000000000100000\",\n-              \"timestamp\": 10,\n+              in ErrorBoundary (at **)\",\n+              \"lanes\": \"0b0000000000000000000000000000001\",\n+              \"timestamp\": 20,\n               \"type\": \"schedule-state-update\",\n               \"warning\": null,\n             },\n           ]\n         `);\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          expect(timelineData.thrownErrors).toMatchInlineSnapshot(`\n           [\n             {\n-              \"componentName\": \"Example\",\n-              \"duration\": 0,\n-              \"timestamp\": 10,\n-              \"type\": \"render\",\n-              \"warning\": null,\n-            },\n-            {\n-              \"componentName\": \"Example\",\n-              \"duration\": 10,\n-              \"timestamp\": 10,\n-              \"type\": \"render\",\n-              \"warning\": null,\n+              \"componentName\": \"ExampleThatThrows\",\n+              \"message\": \"Expected error\",\n+              \"phase\": \"mount\",\n+              \"timestamp\": 20,\n+              \"type\": \"thrown-error\",\n             },\n           ]\n         `);\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-      });\n-\n-      // @reactVersion >=18.2\n-      it('should mark render yields', async () => {\n-        function Bar() {\n-          Scheduler.log('Bar');\n-          return null;\n-        }\n-\n-        function Foo() {\n-          Scheduler.log('Foo');\n-          return <Bar />;\n-        }\n-\n-        React.startTransition(() => {\n-          renderRootHelper(<Foo />);\n         });\n \n-        // Do one step of work.\n-        await waitFor(['Foo']);\n-\n-        // Finish flushing so React commits;\n-        // Unless we do this, the ProfilerStore won't collect Profiling data.\n-        await waitForAll(['Bar']);\n-\n-        // Since we yielded, the batch should report two separate \"render\" chunks.\n-        const batch = getBatchOfWork(0);\n-        expect(batch.filter(({type}) => type === 'render')).toHaveLength(2);\n-      });\n-\n-      it('should mark sync render with suspense that resolves', async () => {\n-        let resolveFn;\n-        let resolved = false;\n-        const suspensePromise = new Promise(resolve => {\n-          resolveFn = () => {\n-            resolved = true;\n-            resolve();\n-          };\n-        });\n+        // @reactVersion <= 18.2\n+        // @reactVersion >= 18.0\n+        it('should mark sync render with suspense that resolves', async () => {\n+          let resolveFn;\n+          let resolved = false;\n+          const suspensePromise = new Promise(resolve => {\n+            resolveFn = () => {\n+              resolved = true;\n+              resolve();\n+            };\n+          });\n \n-        function Example() {\n-          Scheduler.log(resolved ? 'resolved' : 'suspended');\n-          if (!resolved) {\n-            throw suspensePromise;\n+          function Example() {\n+            Scheduler.unstable_yieldValue(resolved ? 'resolved' : 'suspended');\n+            if (!resolved) {\n+              throw suspensePromise;\n+            }\n+            return null;\n           }\n-          return null;\n-        }\n \n-        renderHelper(\n-          <React.Suspense fallback={null}>\n-            <Example />\n-          </React.Suspense>,\n-        );\n+          legacyRender(\n+            <React.Suspense fallback={null}>\n+              <Example />\n+            </React.Suspense>,\n+          );\n \n-        assertLog(['suspended']);\n+          expect(Scheduler.unstable_clearYields()).toEqual(['suspended']);\n \n-        Scheduler.unstable_advanceTime(10);\n-        resolveFn();\n-        await suspensePromise;\n+          Scheduler.unstable_advanceTime(10);\n+          resolveFn();\n+          await suspensePromise;\n \n-        await waitForAll(['resolved']);\n+          await Scheduler.unstable_flushAllWithoutAsserting();\n+          expect(Scheduler.unstable_clearYields()).toEqual(['resolved']);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n+          const timelineData = stopProfilingAndGetTimelineData();\n \n-        // Verify the Suspense event and duration was recorded.\n-        expect(timelineData.suspenseEvents).toHaveLength(1);\n-        const suspenseEvent = timelineData.suspenseEvents[0];\n-        expect(suspenseEvent).toMatchInlineSnapshot(`\n+          // Verify the Suspense event and duration was recorded.\n+          expect(timelineData.suspenseEvents).toHaveLength(1);\n+          const suspenseEvent = timelineData.suspenseEvents[0];\n+          expect(suspenseEvent).toMatchInlineSnapshot(`\n           {\n             \"componentName\": \"Example\",\n             \"depth\": 0,\n@@ -1385,50 +1394,50 @@ describe('Timeline profiler', () => {\n           }\n         `);\n \n-        // There should be two batches of renders: Suspeneded and resolved.\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toHaveLength(2);\n-      });\n-\n-      // @reactVersion >=18.2\n-      it('should mark sync render with suspense that rejects', async () => {\n-        let rejectFn;\n-        let rejected = false;\n-        const suspensePromise = new Promise((resolve, reject) => {\n-          rejectFn = () => {\n-            rejected = true;\n-            reject(new Error('error'));\n-          };\n+          // There should be two batches of renders: Suspeneded and resolved.\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toHaveLength(2);\n         });\n \n-        function Example() {\n-          Scheduler.log(rejected ? 'rejected' : 'suspended');\n-          if (!rejected) {\n-            throw suspensePromise;\n+        // @reactVersion = 18.2\n+        it('should mark sync render with suspense that rejects', async () => {\n+          let rejectFn;\n+          let rejected = false;\n+          const suspensePromise = new Promise((resolve, reject) => {\n+            rejectFn = () => {\n+              rejected = true;\n+              reject(new Error('error'));\n+            };\n+          });\n+\n+          function Example() {\n+            Scheduler.unstable_yieldValue(rejected ? 'rejected' : 'suspended');\n+            if (!rejected) {\n+              throw suspensePromise;\n+            }\n+            return null;\n           }\n-          return null;\n-        }\n \n-        renderHelper(\n-          <React.Suspense fallback={null}>\n-            <Example />\n-          </React.Suspense>,\n-        );\n+          legacyRender(\n+            <React.Suspense fallback={null}>\n+              <Example />\n+            </React.Suspense>,\n+          );\n \n-        assertLog(['suspended']);\n+          expect(Scheduler.unstable_clearYields()).toEqual(['suspended']);\n \n-        Scheduler.unstable_advanceTime(10);\n-        rejectFn();\n-        await expect(suspensePromise).rejects.toThrow();\n+          Scheduler.unstable_advanceTime(10);\n+          rejectFn();\n+          await expect(suspensePromise).rejects.toThrow();\n \n-        assertLog(['rejected']);\n+          expect(Scheduler.unstable_clearYields()).toEqual(['rejected']);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n+          const timelineData = stopProfilingAndGetTimelineData();\n \n-        // Verify the Suspense event and duration was recorded.\n-        expect(timelineData.suspenseEvents).toHaveLength(1);\n-        const suspenseEvent = timelineData.suspenseEvents[0];\n-        expect(suspenseEvent).toMatchInlineSnapshot(`\n+          // Verify the Suspense event and duration was recorded.\n+          expect(timelineData.suspenseEvents).toHaveLength(1);\n+          const suspenseEvent = timelineData.suspenseEvents[0];\n+          expect(suspenseEvent).toMatchInlineSnapshot(`\n           {\n             \"componentName\": \"Example\",\n             \"depth\": 0,\n@@ -1443,50 +1452,177 @@ describe('Timeline profiler', () => {\n           }\n         `);\n \n-        // There should be two batches of renders: Suspeneded and resolved.\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toHaveLength(2);\n+          // There should be two batches of renders: Suspeneded and resolved.\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toHaveLength(2);\n+        });\n       });\n \n-      // @reactVersion >=18.2\n-      it('should mark concurrent render with suspense that resolves', async () => {\n-        let resolveFn;\n-        let resolved = false;\n-        const suspensePromise = new Promise(resolve => {\n-          resolveFn = () => {\n-            resolved = true;\n-            resolve();\n-          };\n+      describe('with createRoot()', () => {\n+        let waitFor;\n+        let waitForAll;\n+        let waitForPaint;\n+        let assertLog;\n+\n+        beforeEach(() => {\n+          const InternalTestUtils = require('internal-test-utils');\n+          waitFor = InternalTestUtils.waitFor;\n+          waitForAll = InternalTestUtils.waitForAll;\n+          waitForPaint = InternalTestUtils.waitForPaint;\n+          assertLog = InternalTestUtils.assertLog;\n         });\n \n-        function Example() {\n-          Scheduler.log(resolved ? 'resolved' : 'suspended');\n-          if (!resolved) {\n-            throw suspensePromise;\n+        const {render: modernRender} = getModernRenderImplementation();\n+\n+        it('should mark concurrent render without suspends or state updates', () => {\n+          utils.act(() => modernRender(<div />));\n+\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          [\n+            {\n+              \"lanes\": \"0b0000000000000000000000000100000\",\n+              \"timestamp\": 10,\n+              \"type\": \"schedule-render\",\n+              \"warning\": null,\n+            },\n+          ]\n+        `);\n+        });\n+\n+        it('should mark concurrent render without suspends or state updates', () => {\n+          let updaterFn;\n+\n+          function Example() {\n+            const setHigh = React.useState(0)[1];\n+            const setLow = React.useState(0)[1];\n+\n+            updaterFn = () => {\n+              React.startTransition(() => {\n+                setLow(prevLow => prevLow + 1);\n+              });\n+              setHigh(prevHigh => prevHigh + 1);\n+            };\n+\n+            Scheduler.unstable_advanceTime(10);\n+\n+            return null;\n           }\n-          return null;\n-        }\n \n-        renderRootHelper(\n-          <React.Suspense fallback={null}>\n-            <Example />\n-          </React.Suspense>,\n-        );\n+          utils.act(() => modernRender(<Example />));\n+          utils.act(() => store.profilerStore.stopProfiling());\n+          utils.act(() => store.profilerStore.startProfiling());\n+          utils.act(updaterFn);\n \n-        await waitForAll(['suspended']);\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          [\n+            {\n+              \"componentName\": \"Example\",\n+              \"componentStack\": \"\n+              in Example (at **)\",\n+              \"lanes\": \"0b0000000000000000000000010000000\",\n+              \"timestamp\": 10,\n+              \"type\": \"schedule-state-update\",\n+              \"warning\": null,\n+            },\n+            {\n+              \"componentName\": \"Example\",\n+              \"componentStack\": \"\n+              in Example (at **)\",\n+              \"lanes\": \"0b0000000000000000000000000100000\",\n+              \"timestamp\": 10,\n+              \"type\": \"schedule-state-update\",\n+              \"warning\": null,\n+            },\n+          ]\n+        `);\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          [\n+            {\n+              \"componentName\": \"Example\",\n+              \"duration\": 0,\n+              \"timestamp\": 10,\n+              \"type\": \"render\",\n+              \"warning\": null,\n+            },\n+            {\n+              \"componentName\": \"Example\",\n+              \"duration\": 10,\n+              \"timestamp\": 10,\n+              \"type\": \"render\",\n+              \"warning\": null,\n+            },\n+          ]\n+        `);\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+        });\n \n-        Scheduler.unstable_advanceTime(10);\n-        resolveFn();\n-        await suspensePromise;\n+        it('should mark render yields', async () => {\n+          function Bar() {\n+            Scheduler.log('Bar');\n+            return null;\n+          }\n \n-        await waitForAll(['resolved']);\n+          function Foo() {\n+            Scheduler.log('Foo');\n+            return <Bar />;\n+          }\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n+          React.startTransition(() => {\n+            modernRender(<Foo />);\n+          });\n+\n+          // Do one step of work.\n+          await waitFor(['Foo']);\n+\n+          // Finish flushing so React commits;\n+          // Unless we do this, the ProfilerStore won't collect Profiling data.\n+          await waitForAll(['Bar']);\n+\n+          // Since we yielded, the batch should report two separate \"render\" chunks.\n+          const batch = getBatchOfWork(0);\n+          expect(batch.filter(({type}) => type === 'render')).toHaveLength(2);\n+        });\n+\n+        it('should mark concurrent render with suspense that resolves', async () => {\n+          let resolveFn;\n+          let resolved = false;\n+          const suspensePromise = new Promise(resolve => {\n+            resolveFn = () => {\n+              resolved = true;\n+              resolve();\n+            };\n+          });\n+\n+          function Example() {\n+            Scheduler.log(resolved ? 'resolved' : 'suspended');\n+            if (!resolved) {\n+              throw suspensePromise;\n+            }\n+            return null;\n+          }\n+\n+          modernRender(\n+            <React.Suspense fallback={null}>\n+              <Example />\n+            </React.Suspense>,\n+          );\n \n-        // Verify the Suspense event and duration was recorded.\n-        expect(timelineData.suspenseEvents).toHaveLength(1);\n-        const suspenseEvent = timelineData.suspenseEvents[0];\n-        expect(suspenseEvent).toMatchInlineSnapshot(`\n+          await waitForAll(['suspended']);\n+\n+          Scheduler.unstable_advanceTime(10);\n+          resolveFn();\n+          await suspensePromise;\n+\n+          await waitForAll(['resolved']);\n+\n+          const timelineData = stopProfilingAndGetTimelineData();\n+\n+          // Verify the Suspense event and duration was recorded.\n+          expect(timelineData.suspenseEvents).toHaveLength(1);\n+          const suspenseEvent = timelineData.suspenseEvents[0];\n+          expect(suspenseEvent).toMatchInlineSnapshot(`\n           {\n             \"componentName\": \"Example\",\n             \"depth\": 0,\n@@ -1501,50 +1637,49 @@ describe('Timeline profiler', () => {\n           }\n         `);\n \n-        // There should be two batches of renders: Suspeneded and resolved.\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toHaveLength(2);\n-      });\n-\n-      // @reactVersion >=18.2\n-      it('should mark concurrent render with suspense that rejects', async () => {\n-        let rejectFn;\n-        let rejected = false;\n-        const suspensePromise = new Promise((resolve, reject) => {\n-          rejectFn = () => {\n-            rejected = true;\n-            reject(new Error('error'));\n-          };\n+          // There should be two batches of renders: Suspeneded and resolved.\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toHaveLength(2);\n         });\n \n-        function Example() {\n-          Scheduler.log(rejected ? 'rejected' : 'suspended');\n-          if (!rejected) {\n-            throw suspensePromise;\n+        it('should mark concurrent render with suspense that rejects', async () => {\n+          let rejectFn;\n+          let rejected = false;\n+          const suspensePromise = new Promise((resolve, reject) => {\n+            rejectFn = () => {\n+              rejected = true;\n+              reject(new Error('error'));\n+            };\n+          });\n+\n+          function Example() {\n+            Scheduler.log(rejected ? 'rejected' : 'suspended');\n+            if (!rejected) {\n+              throw suspensePromise;\n+            }\n+            return null;\n           }\n-          return null;\n-        }\n \n-        renderRootHelper(\n-          <React.Suspense fallback={null}>\n-            <Example />\n-          </React.Suspense>,\n-        );\n+          modernRender(\n+            <React.Suspense fallback={null}>\n+              <Example />\n+            </React.Suspense>,\n+          );\n \n-        await waitForAll(['suspended']);\n+          await waitForAll(['suspended']);\n \n-        Scheduler.unstable_advanceTime(10);\n-        rejectFn();\n-        await expect(suspensePromise).rejects.toThrow();\n+          Scheduler.unstable_advanceTime(10);\n+          rejectFn();\n+          await expect(suspensePromise).rejects.toThrow();\n \n-        await waitForAll(['rejected']);\n+          await waitForAll(['rejected']);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n+          const timelineData = stopProfilingAndGetTimelineData();\n \n-        // Verify the Suspense event and duration was recorded.\n-        expect(timelineData.suspenseEvents).toHaveLength(1);\n-        const suspenseEvent = timelineData.suspenseEvents[0];\n-        expect(suspenseEvent).toMatchInlineSnapshot(`\n+          // Verify the Suspense event and duration was recorded.\n+          expect(timelineData.suspenseEvents).toHaveLength(1);\n+          const suspenseEvent = timelineData.suspenseEvents[0];\n+          expect(suspenseEvent).toMatchInlineSnapshot(`\n           {\n             \"componentName\": \"Example\",\n             \"depth\": 0,\n@@ -1559,31 +1694,31 @@ describe('Timeline profiler', () => {\n           }\n         `);\n \n-        // There should be two batches of renders: Suspeneded and resolved.\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toHaveLength(2);\n-      });\n+          // There should be two batches of renders: Suspeneded and resolved.\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toHaveLength(2);\n+        });\n \n-      it('should mark cascading class component state updates', async () => {\n-        class Example extends React.Component {\n-          state = {didMount: false};\n-          componentDidMount() {\n-            this.setState({didMount: true});\n-          }\n-          render() {\n-            Scheduler.unstable_advanceTime(10);\n-            Scheduler.log(this.state.didMount ? 'update' : 'mount');\n-            return null;\n+        it('should mark cascading class component state updates', async () => {\n+          class Example extends React.Component {\n+            state = {didMount: false};\n+            componentDidMount() {\n+              this.setState({didMount: true});\n+            }\n+            render() {\n+              Scheduler.unstable_advanceTime(10);\n+              Scheduler.log(this.state.didMount ? 'update' : 'mount');\n+              return null;\n+            }\n           }\n-        }\n \n-        renderRootHelper(<Example />);\n+          modernRender(<Example />);\n \n-        await waitForPaint(['mount', 'update']);\n+          await waitForPaint(['mount', 'update']);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"Example\",\n@@ -1601,7 +1736,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -1620,29 +1755,29 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-      });\n+        });\n \n-      it('should mark cascading class component force updates', async () => {\n-        let forced = false;\n-        class Example extends React.Component {\n-          componentDidMount() {\n-            forced = true;\n-            this.forceUpdate();\n-          }\n-          render() {\n-            Scheduler.unstable_advanceTime(10);\n-            Scheduler.log(forced ? 'force update' : 'mount');\n-            return null;\n+        it('should mark cascading class component force updates', async () => {\n+          let forced = false;\n+          class Example extends React.Component {\n+            componentDidMount() {\n+              forced = true;\n+              this.forceUpdate();\n+            }\n+            render() {\n+              Scheduler.unstable_advanceTime(10);\n+              Scheduler.log(forced ? 'force update' : 'mount');\n+              return null;\n+            }\n           }\n-        }\n \n-        renderRootHelper(<Example />);\n+          modernRender(<Example />);\n \n-        await waitForPaint(['mount', 'force update']);\n+          await waitForPaint(['mount', 'force update']);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"Example\",\n@@ -1660,7 +1795,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -1677,40 +1812,40 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-      });\n+        });\n \n-      it('should mark render phase state updates for class component', async () => {\n-        class Example extends React.Component {\n-          state = {didRender: false};\n-          render() {\n-            if (this.state.didRender === false) {\n-              this.setState({didRender: true});\n+        it('should mark render phase state updates for class component', async () => {\n+          class Example extends React.Component {\n+            state = {didRender: false};\n+            render() {\n+              if (this.state.didRender === false) {\n+                this.setState({didRender: true});\n+              }\n+              Scheduler.unstable_advanceTime(10);\n+              Scheduler.log(\n+                this.state.didRender ? 'second render' : 'first render',\n+              );\n+              return null;\n             }\n-            Scheduler.unstable_advanceTime(10);\n-            Scheduler.log(\n-              this.state.didRender ? 'second render' : 'first render',\n-            );\n-            return null;\n           }\n-        }\n-\n-        renderRootHelper(<Example />);\n-\n-        let errorMessage;\n-        jest.spyOn(console, 'error').mockImplementation(message => {\n-          errorMessage = message;\n-        });\n \n-        await waitForAll(['first render', 'second render']);\n+          modernRender(<Example />);\n \n-        expect(console.error).toHaveBeenCalledTimes(1);\n-        expect(errorMessage).toContain(\n-          'Cannot update during an existing state transition',\n-        );\n+          let errorMessage;\n+          jest.spyOn(console, 'error').mockImplementation(message => {\n+            errorMessage = message;\n+          });\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          await waitForAll(['first render', 'second render']);\n+\n+          expect(console.error).toHaveBeenCalledTimes(1);\n+          expect(errorMessage).toContain(\n+            'Cannot update during an existing state transition',\n+          );\n+\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"Example\",\n@@ -1728,7 +1863,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -1747,39 +1882,39 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-      });\n+        });\n \n-      it('should mark render phase force updates for class component', async () => {\n-        let forced = false;\n-        class Example extends React.Component {\n-          render() {\n-            Scheduler.unstable_advanceTime(10);\n-            Scheduler.log(forced ? 'force update' : 'render');\n-            if (!forced) {\n-              forced = true;\n-              this.forceUpdate();\n+        it('should mark render phase force updates for class component', async () => {\n+          let forced = false;\n+          class Example extends React.Component {\n+            render() {\n+              Scheduler.unstable_advanceTime(10);\n+              Scheduler.log(forced ? 'force update' : 'render');\n+              if (!forced) {\n+                forced = true;\n+                this.forceUpdate();\n+              }\n+              return null;\n             }\n-            return null;\n           }\n-        }\n \n-        renderRootHelper(<Example />);\n+          modernRender(<Example />);\n \n-        let errorMessage;\n-        jest.spyOn(console, 'error').mockImplementation(message => {\n-          errorMessage = message;\n-        });\n+          let errorMessage;\n+          jest.spyOn(console, 'error').mockImplementation(message => {\n+            errorMessage = message;\n+          });\n \n-        await waitForAll(['render', 'force update']);\n+          await waitForAll(['render', 'force update']);\n \n-        expect(console.error).toHaveBeenCalledTimes(1);\n-        expect(errorMessage).toContain(\n-          'Cannot update during an existing state transition',\n-        );\n+          expect(console.error).toHaveBeenCalledTimes(1);\n+          expect(errorMessage).toContain(\n+            'Cannot update during an existing state transition',\n+          );\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"Example\",\n@@ -1797,7 +1932,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -1814,27 +1949,27 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-      });\n+        });\n \n-      it('should mark cascading layout updates', async () => {\n-        function Example() {\n-          const [didMount, setDidMount] = React.useState(false);\n-          React.useLayoutEffect(() => {\n-            Scheduler.unstable_advanceTime(1);\n-            setDidMount(true);\n-          }, []);\n-          Scheduler.unstable_advanceTime(10);\n-          Scheduler.log(didMount ? 'update' : 'mount');\n-          return didMount;\n-        }\n+        it('should mark cascading layout updates', async () => {\n+          function Example() {\n+            const [didMount, setDidMount] = React.useState(false);\n+            React.useLayoutEffect(() => {\n+              Scheduler.unstable_advanceTime(1);\n+              setDidMount(true);\n+            }, []);\n+            Scheduler.unstable_advanceTime(10);\n+            Scheduler.log(didMount ? 'update' : 'mount');\n+            return didMount;\n+          }\n \n-        renderRootHelper(<Example />);\n+          modernRender(<Example />);\n \n-        await waitForAll(['mount', 'update']);\n+          await waitForAll(['mount', 'update']);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"Example\",\n@@ -1859,7 +1994,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -1878,26 +2013,26 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-      });\n+        });\n \n-      it('should mark cascading passive updates', async () => {\n-        function Example() {\n-          const [didMount, setDidMount] = React.useState(false);\n-          React.useEffect(() => {\n-            Scheduler.unstable_advanceTime(1);\n-            setDidMount(true);\n-          }, []);\n-          Scheduler.unstable_advanceTime(10);\n-          Scheduler.log(didMount ? 'update' : 'mount');\n-          return didMount;\n-        }\n+        it('should mark cascading passive updates', async () => {\n+          function Example() {\n+            const [didMount, setDidMount] = React.useState(false);\n+            React.useEffect(() => {\n+              Scheduler.unstable_advanceTime(1);\n+              setDidMount(true);\n+            }, []);\n+            Scheduler.unstable_advanceTime(10);\n+            Scheduler.log(didMount ? 'update' : 'mount');\n+            return didMount;\n+          }\n \n-        renderRootHelper(<Example />);\n-        await waitForAll(['mount', 'update']);\n+          modernRender(<Example />);\n+          await waitForAll(['mount', 'update']);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(2);\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"Example\",\n@@ -1922,7 +2057,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -1941,26 +2076,26 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-      });\n+        });\n \n-      it('should mark render phase updates', async () => {\n-        function Example() {\n-          const [didRender, setDidRender] = React.useState(false);\n-          Scheduler.unstable_advanceTime(10);\n-          if (!didRender) {\n-            setDidRender(true);\n+        it('should mark render phase updates', async () => {\n+          function Example() {\n+            const [didRender, setDidRender] = React.useState(false);\n+            Scheduler.unstable_advanceTime(10);\n+            if (!didRender) {\n+              setDidRender(true);\n+            }\n+            Scheduler.log(didRender ? 'update' : 'mount');\n+            return didRender;\n           }\n-          Scheduler.log(didRender ? 'update' : 'mount');\n-          return didRender;\n-        }\n \n-        renderRootHelper(<Example />);\n-        await waitForAll(['mount', 'update']);\n+          modernRender(<Example />);\n+          await waitForAll(['mount', 'update']);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        // Render phase updates should be retried as part of the same batch.\n-        expect(timelineData.batchUIDToMeasuresMap.size).toBe(1);\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          // Render phase updates should be retried as part of the same batch.\n+          expect(timelineData.batchUIDToMeasuresMap.size).toBe(1);\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"Example\",\n@@ -1971,7 +2106,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -1990,146 +2125,51 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-      });\n+        });\n \n-      it('should mark sync render that throws', async () => {\n-        jest.spyOn(console, 'error').mockImplementation(() => {});\n+        it('should mark concurrent render that throws', async () => {\n+          jest.spyOn(console, 'error').mockImplementation(() => {});\n \n-        class ErrorBoundary extends React.Component {\n-          state = {error: null};\n-          componentDidCatch(error) {\n-            this.setState({error});\n-          }\n-          render() {\n-            Scheduler.unstable_advanceTime(10);\n-            if (this.state.error) {\n-              Scheduler.log('ErrorBoundary fallback');\n-              return null;\n+          class ErrorBoundary extends React.Component {\n+            state = {error: null};\n+            componentDidCatch(error) {\n+              this.setState({error});\n             }\n-            Scheduler.log('ErrorBoundary render');\n-            return this.props.children;\n-          }\n-        }\n-\n-        function ExampleThatThrows() {\n-          Scheduler.log('ExampleThatThrows');\n-          throw Error('Expected error');\n-        }\n-\n-        renderHelper(\n-          <ErrorBoundary>\n-            <ExampleThatThrows />\n-          </ErrorBoundary>,\n-        );\n-\n-        assertLog([\n-          'ErrorBoundary render',\n-          'ExampleThatThrows',\n-          'ExampleThatThrows',\n-          'ErrorBoundary fallback',\n-        ]);\n-\n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n-          [\n-            {\n-              \"componentName\": \"ErrorBoundary\",\n-              \"duration\": 10,\n-              \"timestamp\": 10,\n-              \"type\": \"render\",\n-              \"warning\": null,\n-            },\n-            {\n-              \"componentName\": \"ExampleThatThrows\",\n-              \"duration\": 0,\n-              \"timestamp\": 20,\n-              \"type\": \"render\",\n-              \"warning\": null,\n-            },\n-            {\n-              \"componentName\": \"ErrorBoundary\",\n-              \"duration\": 10,\n-              \"timestamp\": 20,\n-              \"type\": \"render\",\n-              \"warning\": null,\n-            },\n-          ]\n-        `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n-          [\n-            {\n-              \"lanes\": \"0b0000000000000000000000000000010\",\n-              \"timestamp\": 10,\n-              \"type\": \"schedule-render\",\n-              \"warning\": null,\n-            },\n-            {\n-              \"componentName\": \"ErrorBoundary\",\n-              \"componentStack\": \"\n-              in ErrorBoundary (at **)\",\n-              \"lanes\": \"0b0000000000000000000000000000010\",\n-              \"timestamp\": 20,\n-              \"type\": \"schedule-state-update\",\n-              \"warning\": null,\n-            },\n-          ]\n-        `);\n-        expect(timelineData.thrownErrors).toMatchInlineSnapshot(`\n-          [\n-            {\n-              \"componentName\": \"ExampleThatThrows\",\n-              \"message\": \"Expected error\",\n-              \"phase\": \"mount\",\n-              \"timestamp\": 20,\n-              \"type\": \"thrown-error\",\n-            },\n-          ]\n-        `);\n-      });\n-\n-      it('should mark concurrent render that throws', async () => {\n-        jest.spyOn(console, 'error').mockImplementation(() => {});\n-\n-        class ErrorBoundary extends React.Component {\n-          state = {error: null};\n-          componentDidCatch(error) {\n-            this.setState({error});\n-          }\n-          render() {\n-            Scheduler.unstable_advanceTime(10);\n-            if (this.state.error) {\n-              Scheduler.log('ErrorBoundary fallback');\n-              return null;\n+            render() {\n+              Scheduler.unstable_advanceTime(10);\n+              if (this.state.error) {\n+                Scheduler.log('ErrorBoundary fallback');\n+                return null;\n+              }\n+              Scheduler.log('ErrorBoundary render');\n+              return this.props.children;\n             }\n-            Scheduler.log('ErrorBoundary render');\n-            return this.props.children;\n           }\n-        }\n-\n-        function ExampleThatThrows() {\n-          Scheduler.log('ExampleThatThrows');\n-          // eslint-disable-next-line no-throw-literal\n-          throw 'Expected error';\n-        }\n-\n-        renderRootHelper(\n-          <ErrorBoundary>\n-            <ExampleThatThrows />\n-          </ErrorBoundary>,\n-        );\n \n-        await waitForAll([\n-          'ErrorBoundary render',\n-          'ExampleThatThrows',\n-          'ExampleThatThrows',\n-          'ErrorBoundary render',\n-          'ExampleThatThrows',\n-          'ExampleThatThrows',\n-          'ErrorBoundary fallback',\n-        ]);\n+          function ExampleThatThrows() {\n+            Scheduler.log('ExampleThatThrows');\n+            // eslint-disable-next-line no-throw-literal\n+            throw 'Expected error';\n+          }\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          modernRender(\n+            <ErrorBoundary>\n+              <ExampleThatThrows />\n+            </ErrorBoundary>,\n+          );\n+\n+          await waitForAll([\n+            'ErrorBoundary render',\n+            'ExampleThatThrows',\n+            'ExampleThatThrows',\n+            'ErrorBoundary render',\n+            'ExampleThatThrows',\n+            'ExampleThatThrows',\n+            'ErrorBoundary fallback',\n+          ]);\n+\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"ErrorBoundary\",\n@@ -2168,7 +2208,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -2187,7 +2227,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.thrownErrors).toMatchInlineSnapshot(`\n+          expect(timelineData.thrownErrors).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"ExampleThatThrows\",\n@@ -2205,72 +2245,72 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-      });\n-\n-      it('should mark passive and layout effects', async () => {\n-        function ComponentWithEffects() {\n-          React.useLayoutEffect(() => {\n-            Scheduler.log('layout 1 mount');\n-            return () => {\n-              Scheduler.log('layout 1 unmount');\n-            };\n-          }, []);\n-\n-          React.useEffect(() => {\n-            Scheduler.log('passive 1 mount');\n-            return () => {\n-              Scheduler.log('passive 1 unmount');\n-            };\n-          }, []);\n-\n-          React.useLayoutEffect(() => {\n-            Scheduler.log('layout 2 mount');\n-            return () => {\n-              Scheduler.log('layout 2 unmount');\n-            };\n-          }, []);\n-\n-          React.useEffect(() => {\n-            Scheduler.log('passive 2 mount');\n-            return () => {\n-              Scheduler.log('passive 2 unmount');\n-            };\n-          }, []);\n+        });\n \n-          React.useEffect(() => {\n-            Scheduler.log('passive 3 mount');\n-            return () => {\n-              Scheduler.log('passive 3 unmount');\n-            };\n-          }, []);\n+        it('should mark passive and layout effects', async () => {\n+          function ComponentWithEffects() {\n+            React.useLayoutEffect(() => {\n+              Scheduler.log('layout 1 mount');\n+              return () => {\n+                Scheduler.log('layout 1 unmount');\n+              };\n+            }, []);\n+\n+            React.useEffect(() => {\n+              Scheduler.log('passive 1 mount');\n+              return () => {\n+                Scheduler.log('passive 1 unmount');\n+              };\n+            }, []);\n+\n+            React.useLayoutEffect(() => {\n+              Scheduler.log('layout 2 mount');\n+              return () => {\n+                Scheduler.log('layout 2 unmount');\n+              };\n+            }, []);\n+\n+            React.useEffect(() => {\n+              Scheduler.log('passive 2 mount');\n+              return () => {\n+                Scheduler.log('passive 2 unmount');\n+              };\n+            }, []);\n+\n+            React.useEffect(() => {\n+              Scheduler.log('passive 3 mount');\n+              return () => {\n+                Scheduler.log('passive 3 unmount');\n+              };\n+            }, []);\n \n-          return null;\n-        }\n+            return null;\n+          }\n \n-        const unmount = renderRootHelper(<ComponentWithEffects />);\n+          const unmount = modernRender(<ComponentWithEffects />);\n \n-        await waitForPaint(['layout 1 mount', 'layout 2 mount']);\n+          await waitForPaint(['layout 1 mount', 'layout 2 mount']);\n \n-        await waitForAll([\n-          'passive 1 mount',\n-          'passive 2 mount',\n-          'passive 3 mount',\n-        ]);\n+          await waitForAll([\n+            'passive 1 mount',\n+            'passive 2 mount',\n+            'passive 3 mount',\n+          ]);\n \n-        await waitForAll([]);\n+          await waitForAll([]);\n \n-        unmount();\n+          unmount();\n \n-        assertLog([\n-          'layout 1 unmount',\n-          'layout 2 unmount',\n-          'passive 1 unmount',\n-          'passive 2 unmount',\n-          'passive 3 unmount',\n-        ]);\n+          assertLog([\n+            'layout 1 unmount',\n+            'layout 2 unmount',\n+            'passive 1 unmount',\n+            'passive 2 unmount',\n+            'passive 3 unmount',\n+          ]);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.componentMeasures).toMatchInlineSnapshot(`\n           [\n             {\n               \"componentName\": \"ComponentWithEffects\",\n@@ -2351,7 +2391,7 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n-        expect(timelineData.batchUIDToMeasuresMap).toMatchInlineSnapshot(`\n+          expect(timelineData.batchUIDToMeasuresMap).toMatchInlineSnapshot(`\n           Map {\n             1 => [\n               {\n@@ -2439,33 +2479,33 @@ describe('Timeline profiler', () => {\n             ],\n           }\n         `);\n-      });\n+        });\n \n-      it('should generate component stacks for state update', async () => {\n-        function CommponentWithChildren({initialRender}) {\n-          Scheduler.log('Render ComponentWithChildren');\n-          return <Child initialRender={initialRender} />;\n-        }\n+        it('should generate component stacks for state update', async () => {\n+          function CommponentWithChildren({initialRender}) {\n+            Scheduler.log('Render ComponentWithChildren');\n+            return <Child initialRender={initialRender} />;\n+          }\n \n-        function Child({initialRender}) {\n-          const [didRender, setDidRender] = React.useState(initialRender);\n-          if (!didRender) {\n-            setDidRender(true);\n+          function Child({initialRender}) {\n+            const [didRender, setDidRender] = React.useState(initialRender);\n+            if (!didRender) {\n+              setDidRender(true);\n+            }\n+            Scheduler.log('Render Child');\n+            return null;\n           }\n-          Scheduler.log('Render Child');\n-          return null;\n-        }\n \n-        renderRootHelper(<CommponentWithChildren initialRender={false} />);\n+          modernRender(<CommponentWithChildren initialRender={false} />);\n \n-        await waitForAll([\n-          'Render ComponentWithChildren',\n-          'Render Child',\n-          'Render Child',\n-        ]);\n+          await waitForAll([\n+            'Render ComponentWithChildren',\n+            'Render Child',\n+            'Render Child',\n+          ]);\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData.schedulingEvents).toMatchInlineSnapshot(`\n           [\n             {\n               \"lanes\": \"0b0000000000000000000000000100000\",\n@@ -2485,16 +2525,22 @@ describe('Timeline profiler', () => {\n             },\n           ]\n         `);\n+        });\n       });\n     });\n \n     describe('when not profiling', () => {\n-      // @reactVersion >=18.0\n-      it('should not log any marks', () => {\n-        renderHelper(<div />);\n+      describe('with legacy render', () => {\n+        const {render: legacyRender} = getLegacyRenderImplementation();\n \n-        const timelineData = stopProfilingAndGetTimelineData();\n-        expect(timelineData).toBeNull();\n+        // @reactVersion <= 18.2\n+        // @reactVersion >= 18.0\n+        it('should not log any marks', () => {\n+          legacyRender(<div />);\n+\n+          const timelineData = stopProfilingAndGetTimelineData();\n+          expect(timelineData).toBeNull();\n+        });\n       });\n     });\n   });"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/componentStacks-test.js",
                "git_diff": "@@ -7,12 +7,11 @@\n  * @flow\n  */\n \n-import {normalizeCodeLocInfo} from './utils';\n+import {getVersionedRenderImplementation, normalizeCodeLocInfo} from './utils';\n \n describe('component stack', () => {\n   let React;\n   let act;\n-  let legacyRender;\n   let mockError;\n   let mockWarn;\n \n@@ -30,11 +29,12 @@ describe('component stack', () => {\n \n     const utils = require('./utils');\n     act = utils.act;\n-    legacyRender = utils.legacyRender;\n \n     React = require('react');\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   // @reactVersion >=16.9\n   it('should log the current component stack along with an error or warning', () => {\n     const Grandparent = () => <Parent />;\n@@ -45,9 +45,7 @@ describe('component stack', () => {\n       return null;\n     };\n \n-    const container = document.createElement('div');\n-\n-    act(() => legacyRender(<Grandparent />, container));\n+    act(() => render(<Grandparent />));\n \n     expect(mockError).toHaveBeenCalledWith(\n       'Test error.',\n@@ -79,8 +77,7 @@ describe('component stack', () => {\n       return null;\n     };\n \n-    const container = document.createElement('div');\n-    act(() => legacyRender(<Example test=\"abc\" />, container));\n+    act(() => render(<Example test=\"abc\" />));\n \n     expect(useEffectCount).toBe(1);\n \n@@ -89,4 +86,41 @@ describe('component stack', () => {\n       '\\n    in Example (at **)',\n     );\n   });\n+\n+  // @reactVersion >=18.3\n+  it('should log the current component stack with debug info from promises', () => {\n+    const Child = () => {\n+      console.error('Test error.');\n+      console.warn('Test warning.');\n+      return null;\n+    };\n+    const ChildPromise = Promise.resolve(<Child />);\n+    ChildPromise.status = 'fulfilled';\n+    ChildPromise.value = <Child />;\n+    ChildPromise._debugInfo = [\n+      {\n+        name: 'ServerComponent',\n+        env: 'Server',\n+      },\n+    ];\n+    const Parent = () => ChildPromise;\n+    const Grandparent = () => <Parent />;\n+\n+    act(() => render(<Grandparent />));\n+\n+    expect(mockError).toHaveBeenCalledWith(\n+      'Test error.',\n+      '\\n    in Child (at **)' +\n+        '\\n    in ServerComponent (at **)' +\n+        '\\n    in Parent (at **)' +\n+        '\\n    in Grandparent (at **)',\n+    );\n+    expect(mockWarn).toHaveBeenCalledWith(\n+      'Test warning.',\n+      '\\n    in Child (at **)' +\n+        '\\n    in ServerComponent (at **)' +\n+        '\\n    in Parent (at **)' +\n+        '\\n    in Grandparent (at **)',\n+    );\n+  });\n });"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/console-test.js",
                "git_diff": "@@ -7,13 +7,12 @@\n  * @flow\n  */\n \n-import {normalizeCodeLocInfo} from './utils';\n+import {getVersionedRenderImplementation, normalizeCodeLocInfo} from './utils';\n \n let React;\n let ReactDOMClient;\n let act;\n let fakeConsole;\n-let legacyRender;\n let mockError;\n let mockInfo;\n let mockGroup;\n@@ -67,9 +66,10 @@ describe('console', () => {\n \n     const utils = require('./utils');\n     act = utils.act;\n-    legacyRender = utils.legacyRender;\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   // @reactVersion >=18.0\n   it('should not patch console methods that are not explicitly overridden', () => {\n     expect(fakeConsole.error).not.toBe(mockError);\n@@ -185,7 +185,7 @@ describe('console', () => {\n       return null;\n     };\n \n-    act(() => legacyRender(<Child />, document.createElement('div')));\n+    act(() => render(<Child />));\n \n     expect(mockWarn).toHaveBeenCalledTimes(1);\n     expect(mockWarn.mock.calls[0]).toHaveLength(1);\n@@ -215,7 +215,7 @@ describe('console', () => {\n       return null;\n     };\n \n-    act(() => legacyRender(<Parent />, document.createElement('div')));\n+    act(() => render(<Parent />));\n \n     expect(mockLog).toHaveBeenCalledTimes(1);\n     expect(mockLog.mock.calls[0]).toHaveLength(1);\n@@ -256,7 +256,7 @@ describe('console', () => {\n       return null;\n     };\n \n-    act(() => legacyRender(<Parent />, document.createElement('div')));\n+    act(() => render(<Parent />));\n \n     expect(mockLog).toHaveBeenCalledTimes(2);\n     expect(mockLog.mock.calls[0]).toHaveLength(1);\n@@ -313,9 +313,8 @@ describe('console', () => {\n       }\n     }\n \n-    const container = document.createElement('div');\n-    act(() => legacyRender(<Parent />, container));\n-    act(() => legacyRender(<Parent />, container));\n+    act(() => render(<Parent />));\n+    act(() => render(<Parent />));\n \n     expect(mockLog).toHaveBeenCalledTimes(2);\n     expect(mockLog.mock.calls[0]).toHaveLength(1);\n@@ -367,7 +366,7 @@ describe('console', () => {\n       }\n     }\n \n-    act(() => legacyRender(<Parent />, document.createElement('div')));\n+    act(() => render(<Parent />));\n \n     expect(mockLog).toHaveBeenCalledTimes(1);\n     expect(mockLog.mock.calls[0]).toHaveLength(1);\n@@ -396,7 +395,7 @@ describe('console', () => {\n       return null;\n     };\n \n-    act(() => legacyRender(<Child />, document.createElement('div')));\n+    act(() => render(<Child />));\n \n     expect(mockWarn).toHaveBeenCalledTimes(1);\n     expect(mockWarn.mock.calls[0]).toHaveLength(1);\n@@ -410,7 +409,7 @@ describe('console', () => {\n       breakOnConsoleErrors: false,\n       showInlineWarningsAndErrors: false,\n     });\n-    act(() => legacyRender(<Child />, document.createElement('div')));\n+    act(() => render(<Child />));\n \n     expect(mockWarn).toHaveBeenCalledTimes(2);\n     expect(mockWarn.mock.calls[1]).toHaveLength(2);\n@@ -457,7 +456,7 @@ describe('console', () => {\n       return null;\n     };\n \n-    act(() => legacyRender(<Parent />, document.createElement('div')));\n+    act(() => render(<Parent />));\n \n     expect(mockLog).toHaveBeenCalledTimes(1);\n     expect(mockLog.mock.calls[0]).toHaveLength(1);\n@@ -483,7 +482,7 @@ describe('console', () => {\n       return null;\n     };\n \n-    act(() => legacyRender(<Component />, document.createElement('div')));\n+    act(() => render(<Component />));\n \n     expect(mockWarn).toHaveBeenCalledTimes(1);\n     expect(mockWarn.mock.calls[0][0]).toBe('Symbol:');\n@@ -626,6 +625,147 @@ describe('console', () => {\n     expect(mockGroupCollapsed.mock.calls[0][0]).toBe('groupCollapsed');\n   });\n \n+  it('should double log from useMemo if hideConsoleLogsInStrictMode is disabled in Strict mode', () => {\n+    global.__REACT_DEVTOOLS_APPEND_COMPONENT_STACK__ = false;\n+    global.__REACT_DEVTOOLS_HIDE_CONSOLE_LOGS_IN_STRICT_MODE__ = false;\n+\n+    const container = document.createElement('div');\n+    const root = ReactDOMClient.createRoot(container);\n+\n+    function App() {\n+      React.useMemo(() => {\n+        fakeConsole.log('log');\n+        fakeConsole.warn('warn');\n+        fakeConsole.error('error');\n+        fakeConsole.info('info');\n+        fakeConsole.group('group');\n+        fakeConsole.groupCollapsed('groupCollapsed');\n+      }, []);\n+      return <div />;\n+    }\n+\n+    act(() =>\n+      root.render(\n+        <React.StrictMode>\n+          <App />\n+        </React.StrictMode>,\n+      ),\n+    );\n+    expect(mockLog.mock.calls[0]).toHaveLength(1);\n+    expect(mockLog.mock.calls[0][0]).toBe('log');\n+    expect(mockLog.mock.calls[1]).toEqual([\n+      '%c%s',\n+      `color: ${process.env.DARK_MODE_DIMMED_LOG_COLOR}`,\n+      'log',\n+    ]);\n+\n+    expect(mockWarn).toHaveBeenCalledTimes(2);\n+    expect(mockWarn.mock.calls[0]).toHaveLength(1);\n+    expect(mockWarn.mock.calls[0][0]).toBe('warn');\n+    expect(mockWarn.mock.calls[1]).toHaveLength(3);\n+    expect(mockWarn.mock.calls[1]).toEqual([\n+      '%c%s',\n+      `color: ${process.env.DARK_MODE_DIMMED_WARNING_COLOR}`,\n+      'warn',\n+    ]);\n+\n+    expect(mockError).toHaveBeenCalledTimes(2);\n+    expect(mockError.mock.calls[0]).toHaveLength(1);\n+    expect(mockError.mock.calls[0][0]).toBe('error');\n+    expect(mockError.mock.calls[1]).toHaveLength(3);\n+    expect(mockError.mock.calls[1]).toEqual([\n+      '%c%s',\n+      `color: ${process.env.DARK_MODE_DIMMED_ERROR_COLOR}`,\n+      'error',\n+    ]);\n+\n+    expect(mockInfo).toHaveBeenCalledTimes(2);\n+    expect(mockInfo.mock.calls[0]).toHaveLength(1);\n+    expect(mockInfo.mock.calls[0][0]).toBe('info');\n+    expect(mockInfo.mock.calls[1]).toHaveLength(3);\n+    expect(mockInfo.mock.calls[1]).toEqual([\n+      '%c%s',\n+      `color: ${process.env.DARK_MODE_DIMMED_LOG_COLOR}`,\n+      'info',\n+    ]);\n+\n+    expect(mockGroup).toHaveBeenCalledTimes(2);\n+    expect(mockGroup.mock.calls[0]).toHaveLength(1);\n+    expect(mockGroup.mock.calls[0][0]).toBe('group');\n+    expect(mockGroup.mock.calls[1]).toHaveLength(3);\n+    expect(mockGroup.mock.calls[1]).toEqual([\n+      '%c%s',\n+      `color: ${process.env.DARK_MODE_DIMMED_LOG_COLOR}`,\n+      'group',\n+    ]);\n+\n+    expect(mockGroupCollapsed).toHaveBeenCalledTimes(2);\n+    expect(mockGroupCollapsed.mock.calls[0]).toHaveLength(1);\n+    expect(mockGroupCollapsed.mock.calls[0][0]).toBe('groupCollapsed');\n+    expect(mockGroupCollapsed.mock.calls[1]).toHaveLength(3);\n+    expect(mockGroupCollapsed.mock.calls[1]).toEqual([\n+      '%c%s',\n+      `color: ${process.env.DARK_MODE_DIMMED_LOG_COLOR}`,\n+      'groupCollapsed',\n+    ]);\n+  });\n+\n+  it('should not double log from useMemo fns if hideConsoleLogsInStrictMode is enabled in Strict mode', () => {\n+    global.__REACT_DEVTOOLS_APPEND_COMPONENT_STACK__ = false;\n+    global.__REACT_DEVTOOLS_HIDE_CONSOLE_LOGS_IN_STRICT_MODE__ = true;\n+\n+    const container = document.createElement('div');\n+    const root = ReactDOMClient.createRoot(container);\n+\n+    function App() {\n+      React.useMemo(() => {\n+        console.log(\n+          'CALL',\n+          global.__REACT_DEVTOOLS_HIDE_CONSOLE_LOGS_IN_STRICT_MODE__,\n+        );\n+        fakeConsole.log('log');\n+        fakeConsole.warn('warn');\n+        fakeConsole.error('error');\n+        fakeConsole.info('info');\n+        fakeConsole.group('group');\n+        fakeConsole.groupCollapsed('groupCollapsed');\n+      }, []);\n+      return <div />;\n+    }\n+\n+    act(() =>\n+      root.render(\n+        <React.StrictMode>\n+          <App />\n+        </React.StrictMode>,\n+      ),\n+    );\n+\n+    expect(mockLog).toHaveBeenCalledTimes(1);\n+    expect(mockLog.mock.calls[0]).toHaveLength(1);\n+    expect(mockLog.mock.calls[0][0]).toBe('log');\n+\n+    expect(mockWarn).toHaveBeenCalledTimes(1);\n+    expect(mockWarn.mock.calls[0]).toHaveLength(1);\n+    expect(mockWarn.mock.calls[0][0]).toBe('warn');\n+\n+    expect(mockError).toHaveBeenCalledTimes(1);\n+    expect(mockError.mock.calls[0]).toHaveLength(1);\n+    expect(mockError.mock.calls[0][0]).toBe('error');\n+\n+    expect(mockInfo).toHaveBeenCalledTimes(1);\n+    expect(mockInfo.mock.calls[0]).toHaveLength(1);\n+    expect(mockInfo.mock.calls[0][0]).toBe('info');\n+\n+    expect(mockGroup).toHaveBeenCalledTimes(1);\n+    expect(mockGroup.mock.calls[0]).toHaveLength(1);\n+    expect(mockGroup.mock.calls[0][0]).toBe('group');\n+\n+    expect(mockGroupCollapsed).toHaveBeenCalledTimes(1);\n+    expect(mockGroupCollapsed.mock.calls[0]).toHaveLength(1);\n+    expect(mockGroupCollapsed.mock.calls[0][0]).toBe('groupCollapsed');\n+  });\n+\n   it('should double log in Strict mode initial render for extension', () => {\n     global.__REACT_DEVTOOLS_APPEND_COMPONENT_STACK__ = false;\n     global.__REACT_DEVTOOLS_HIDE_CONSOLE_LOGS_IN_STRICT_MODE__ = false;\n@@ -824,7 +964,6 @@ describe('console error', () => {\n \n     const utils = require('./utils');\n     act = utils.act;\n-    legacyRender = utils.legacyRender;\n   });\n \n   // @reactVersion >=18.0"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/editing-test.js",
                "git_diff": "@@ -10,11 +10,12 @@\n import type {FrontendBridge} from 'react-devtools-shared/src/bridge';\n import type Store from 'react-devtools-shared/src/devtools/store';\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('editing interface', () => {\n   let PropTypes;\n   let React;\n   let bridge: FrontendBridge;\n-  let legacyRender;\n   let store: Store;\n   let utils;\n \n@@ -25,8 +26,6 @@ describe('editing interface', () => {\n   beforeEach(() => {\n     utils = require('./utils');\n \n-    legacyRender = utils.legacyRender;\n-\n     bridge = global.bridge;\n     store = global.store;\n     store.collapseNodesByDefault = false;\n@@ -36,6 +35,8 @@ describe('editing interface', () => {\n     React = require('react');\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   describe('props', () => {\n     let committedClassProps;\n     let committedFunctionProps;\n@@ -66,9 +67,8 @@ describe('editing interface', () => {\n \n       inputRef = React.createRef(null);\n \n-      const container = document.createElement('div');\n       await utils.actAsync(() =>\n-        legacyRender(\n+        render(\n           <>\n             <ClassComponent\n               array={[1, 2, 3]}\n@@ -84,7 +84,6 @@ describe('editing interface', () => {\n             ,\n             <input ref={inputRef} onChange={jest.fn()} value=\"initial\" />\n           </>,\n-          container,\n         ),\n       );\n \n@@ -440,11 +439,9 @@ describe('editing interface', () => {\n         }\n       }\n \n-      const container = document.createElement('div');\n       await utils.actAsync(() =>\n-        legacyRender(\n+        render(\n           <ClassComponent object={{nested: 'initial'}} shallow=\"initial\" />,\n-          container,\n         ),\n       );\n \n@@ -662,10 +659,7 @@ describe('editing interface', () => {\n         return null;\n       }\n \n-      const container = document.createElement('div');\n-      await utils.actAsync(() =>\n-        legacyRender(<FunctionComponent />, container),\n-      );\n+      await utils.actAsync(() => render(<FunctionComponent />));\n \n       hookID = 0; // index\n       id = ((store.getElementIDAtIndex(0): any): number);\n@@ -917,13 +911,11 @@ describe('editing interface', () => {\n         }\n       }\n \n-      const container = document.createElement('div');\n       await utils.actAsync(() =>\n-        legacyRender(\n+        render(\n           <LegacyContextProvider>\n             <ClassComponent />\n           </LegacyContextProvider>,\n-          container,\n         ),\n       );\n "
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/gate-test.js",
                "git_diff": "@@ -0,0 +1,18 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ *\n+ * @flow\n+ */\n+\n+describe('gate', () => {\n+  //@gate false\n+  it('should expect an error for this test', () => {\n+    throw new Error('This test should fail');\n+  });\n+\n+  //@gate true\n+  it('should not an error for this test', () => {});\n+});"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/inspectedElement-test.js",
                "git_diff": "@@ -8,7 +8,12 @@\n  */\n \n import typeof ReactTestRenderer from 'react-test-renderer';\n-import {withErrorsOrWarningsIgnored} from 'react-devtools-shared/src/__tests__/utils';\n+import {\n+  withErrorsOrWarningsIgnored,\n+  getLegacyRenderImplementation,\n+  getModernRenderImplementation,\n+  getVersionedRenderImplementation,\n+} from 'react-devtools-shared/src/__tests__/utils';\n \n import type {FrontendBridge} from 'react-devtools-shared/src/bridge';\n import type Store from 'react-devtools-shared/src/devtools/store';\n@@ -33,7 +38,6 @@ describe('InspectedElement', () => {\n   let TestUtilsAct;\n   let TestRendererAct;\n \n-  let legacyRender;\n   let testRendererInstance;\n \n   let ErrorBoundary;\n@@ -45,8 +49,6 @@ describe('InspectedElement', () => {\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    legacyRender = utils.legacyRender;\n-\n     bridge = global.bridge;\n     store = global.store;\n     store.collapseNodesByDefault = false;\n@@ -101,6 +103,10 @@ describe('InspectedElement', () => {\n     jest.restoreAllMocks();\n   });\n \n+  const {render: legacyRender} = getLegacyRenderImplementation();\n+  const {render: modernRender} = getModernRenderImplementation();\n+  const {render} = getVersionedRenderImplementation();\n+\n   const Contexts = ({\n     children,\n     defaultSelectedElementID = null,\n@@ -173,16 +179,17 @@ describe('InspectedElement', () => {\n     return inspectedElement;\n   }\n \n-  it('should inspect the currently selected element', async () => {\n+  // TODO(hoxyq): Enable this test for versions ~18, currently broken\n+  // @reactVersion <= 18.2\n+  xit('should inspect the currently selected element (legacy render)', async () => {\n     const Example = () => {\n       const [count] = React.useState(1);\n       return count;\n     };\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(() =>\n-      legacyRender(<Example a={1} b=\"abc\" />, container),\n-    );\n+    await utils.actAsync(() => {\n+      legacyRender(<Example a={1} b=\"abc\" />);\n+    });\n \n     const inspectedElement = await inspectElementAtIndex(0);\n     expect(inspectedElement).toMatchInlineSnapshot(`\n@@ -191,6 +198,7 @@ describe('InspectedElement', () => {\n         \"events\": undefined,\n         \"hooks\": [\n           {\n+            \"debugInfo\": null,\n             \"hookSource\": {\n               \"columnNumber\": \"removed by Jest serializer\",\n               \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -216,6 +224,49 @@ describe('InspectedElement', () => {\n     `);\n   });\n \n+  it('should inspect the currently selected element (createRoot)', async () => {\n+    const Example = () => {\n+      const [count] = React.useState(1);\n+      return count;\n+    };\n+\n+    await utils.actAsync(() => {\n+      modernRender(<Example a={1} b=\"abc\" />);\n+    });\n+\n+    const inspectedElement = await inspectElementAtIndex(0);\n+    expect(inspectedElement).toMatchInlineSnapshot(`\n+      {\n+        \"context\": null,\n+        \"events\": undefined,\n+        \"hooks\": [\n+          {\n+            \"debugInfo\": null,\n+            \"hookSource\": {\n+              \"columnNumber\": \"removed by Jest serializer\",\n+              \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n+              \"functionName\": \"Example\",\n+              \"lineNumber\": \"removed by Jest serializer\",\n+            },\n+            \"id\": 0,\n+            \"isStateEditable\": true,\n+            \"name\": \"State\",\n+            \"subHooks\": [],\n+            \"value\": 1,\n+          },\n+        ],\n+        \"id\": 2,\n+        \"owners\": null,\n+        \"props\": {\n+          \"a\": 1,\n+          \"b\": \"abc\",\n+        },\n+        \"rootType\": \"createRoot()\",\n+        \"state\": null,\n+      }\n+    `);\n+  });\n+\n   it('should have hasLegacyContext flag set to either \"true\" or \"false\" depending on which context API is used.', async () => {\n     const contextData = {\n       bool: true,\n@@ -256,9 +307,8 @@ describe('InspectedElement', () => {\n     const ModernContext = React.createContext();\n     ModernContext.displayName = 'ModernContext';\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <React.Fragment>\n           <LegacyContextProvider>\n             <LegacyContextConsumer />\n@@ -269,7 +319,6 @@ describe('InspectedElement', () => {\n             <ModernContext.Consumer>{value => null}</ModernContext.Consumer>\n           </ModernContext.Provider>\n         </React.Fragment>,\n-        container,\n       ),\n     );\n \n@@ -303,7 +352,7 @@ describe('InspectedElement', () => {\n       // from props like defaultSelectedElementID and it's easier to reset here than\n       // to read the TreeDispatcherContext and update the selected ID that way.\n       // We're testing the inspected values here, not the context wiring, so that's ok.\n-      utils.withErrorsOrWarningsIgnored(\n+      withErrorsOrWarningsIgnored(\n         ['An update to %s inside a test was not wrapped in act'],\n         () => {\n           testRendererInstance = TestRenderer.create(null, {\n@@ -322,11 +371,7 @@ describe('InspectedElement', () => {\n   it('should poll for updates for the currently selected element', async () => {\n     const Example = () => null;\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(\n-      () => legacyRender(<Example a={1} b=\"abc\" />, container),\n-      false,\n-    );\n+    await utils.actAsync(() => render(<Example a={1} b=\"abc\" />), false);\n \n     let inspectedElement = await inspectElementAtIndex(0);\n     expect(inspectedElement.props).toMatchInlineSnapshot(`\n@@ -336,10 +381,7 @@ describe('InspectedElement', () => {\n       }\n     `);\n \n-    await utils.actAsync(\n-      () => legacyRender(<Example a={2} b=\"def\" />, container),\n-      false,\n-    );\n+    await utils.actAsync(() => render(<Example a={2} b=\"def\" />), false);\n \n     // TODO (cache)\n     // This test only passes if both the check-for-updates poll AND the test renderer.update() call are included below.\n@@ -371,20 +413,20 @@ describe('InspectedElement', () => {\n       return null;\n     });\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Wrapper>\n           <Target a={1} b=\"abc\" />\n         </Wrapper>,\n-        container,\n       ),\n     );\n \n     targetRenderCount = 0;\n \n     let inspectedElement = await inspectElementAtIndex(1);\n-    expect(targetRenderCount).toBe(1);\n+    // One more because we call render function for generating component stack,\n+    // which is required for defining source location\n+    expect(targetRenderCount).toBe(2);\n     expect(inspectedElement.props).toMatchInlineSnapshot(`\n       {\n         \"a\": 1,\n@@ -403,11 +445,10 @@ describe('InspectedElement', () => {\n \n     await utils.actAsync(\n       () =>\n-        legacyRender(\n+        render(\n           <Wrapper>\n             <Target a={2} b=\"def\" />\n           </Wrapper>,\n-          container,\n         ),\n       false,\n     );\n@@ -435,20 +476,20 @@ describe('InspectedElement', () => {\n       return null;\n     });\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Wrapper>\n           <Target a={1} b=\"abc\" />\n         </Wrapper>,\n-        container,\n       ),\n     );\n \n     targetRenderCount = 0;\n \n     let inspectedElement = await inspectElementAtIndex(1);\n-    expect(targetRenderCount).toBe(1);\n+    // One more because we call render function for generating component stack,\n+    // which is required for defining source location\n+    expect(targetRenderCount).toBe(2);\n     expect(inspectedElement.props).toMatchInlineSnapshot(`\n       {\n         \"a\": 1,\n@@ -465,7 +506,7 @@ describe('InspectedElement', () => {\n     // The backend still thinks the most recently-inspected element is still cached,\n     // so the frontend needs to tell it to resend a full value.\n     // We can verify this by asserting that the component is re-rendered again.\n-    utils.withErrorsOrWarningsIgnored(\n+    withErrorsOrWarningsIgnored(\n       ['An update to %s inside a test was not wrapped in act'],\n       () => {\n         testRendererInstance = TestRenderer.create(null, {\n@@ -503,9 +544,7 @@ describe('InspectedElement', () => {\n       return null;\n     });\n \n-    const container = document.createElement('div');\n-    const root = ReactDOMClient.createRoot(container);\n-    await utils.actAsync(() => root.render(<Target a={1} b=\"abc\" />));\n+    await utils.actAsync(() => render(<Target a={1} b=\"abc\" />));\n \n     expect(targetRenderCount).toBe(1);\n     expect(console.error).toHaveBeenCalledTimes(1);\n@@ -520,7 +559,9 @@ describe('InspectedElement', () => {\n     const inspectedElement = await inspectElementAtIndex(0);\n \n     expect(inspectedElement).not.toBe(null);\n-    expect(targetRenderCount).toBe(2);\n+    // One more because we call render function for generating component stack,\n+    // which is required for defining source location\n+    expect(targetRenderCount).toBe(3);\n     expect(console.error).toHaveBeenCalledTimes(1);\n     expect(console.info).toHaveBeenCalledTimes(1);\n     expect(console.log).toHaveBeenCalledTimes(1);\n@@ -530,9 +571,8 @@ describe('InspectedElement', () => {\n   it('should support simple data types', async () => {\n     const Example = () => null;\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Example\n           boolean_false={false}\n           boolean_true={true}\n@@ -546,7 +586,6 @@ describe('InspectedElement', () => {\n           value_null={null}\n           value_undefined={undefined}\n         />,\n-        container,\n       ),\n     );\n \n@@ -619,9 +658,8 @@ describe('InspectedElement', () => {\n       },\n     });\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Example\n           anonymous_fn={instance.anonymousFunction}\n           array_buffer={arrayBuffer}\n@@ -646,7 +684,6 @@ describe('InspectedElement', () => {\n           symbol={Symbol('symbol')}\n           typed_array={typedArray}\n         />,\n-        container,\n       ),\n     );\n \n@@ -781,12 +818,8 @@ describe('InspectedElement', () => {\n       throw Error('Should not be consumed!');\n     }\n \n-    const container = document.createElement('div');\n-\n     const iterable = generator();\n-    await utils.actAsync(() =>\n-      legacyRender(<Example prop={iterable} />, container),\n-    );\n+    await utils.actAsync(() => render(<Example prop={iterable} />));\n \n     const inspectedElement = await inspectElementAtIndex(0);\n     expect(inspectedElement.props).toMatchInlineSnapshot(`\n@@ -807,10 +840,7 @@ describe('InspectedElement', () => {\n     object.number = 123;\n     object.boolean = true;\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(() =>\n-      legacyRender(<Example object={object} />, container),\n-    );\n+    await utils.actAsync(() => render(<Example object={object} />));\n \n     const inspectedElement = await inspectElementAtIndex(0);\n     expect(inspectedElement.props).toMatchInlineSnapshot(`\n@@ -832,10 +862,7 @@ describe('InspectedElement', () => {\n       hasOwnProperty: true,\n     };\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(() =>\n-      legacyRender(<Example object={object} />, container),\n-    );\n+    await utils.actAsync(() => render(<Example object={object} />));\n \n     const inspectedElement = await inspectElementAtIndex(0);\n \n@@ -869,10 +896,7 @@ describe('InspectedElement', () => {\n \n     const Example = () => null;\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(() =>\n-      legacyRender(<Example data={new CustomData()} />, container),\n-    );\n+    await utils.actAsync(() => render(<Example data={new CustomData()} />));\n \n     const inspectedElement = await inspectElementAtIndex(0);\n     expect(inspectedElement.props).toMatchInlineSnapshot(`\n@@ -948,10 +972,7 @@ describe('InspectedElement', () => {\n       },\n     });\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(() =>\n-      legacyRender(<Example object={object} />, container),\n-    );\n+    await utils.actAsync(() => render(<Example object={object} />));\n \n     const inspectedElement = await inspectElementAtIndex(0);\n     expect(inspectedElement.props).toMatchInlineSnapshot(`\n@@ -1003,10 +1024,8 @@ describe('InspectedElement', () => {\n       },\n     );\n     const Example = ({data}) => null;\n-    const container = document.createElement('div');\n-    await utils.actAsync(() =>\n-      legacyRender(<Example data={testData} />, container),\n-    );\n+\n+    await utils.actAsync(() => render(<Example data={testData} />));\n \n     const inspectedElement = await inspectElementAtIndex(0);\n     expect(inspectedElement.props).toMatchInlineSnapshot(`\n@@ -1034,9 +1053,8 @@ describe('InspectedElement', () => {\n       return state.foo.bar.baz;\n     };\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Example\n           nestedObject={{\n             a: {\n@@ -1052,7 +1070,6 @@ describe('InspectedElement', () => {\n             },\n           }}\n         />,\n-        container,\n       ),\n     );\n \n@@ -1148,6 +1165,7 @@ describe('InspectedElement', () => {\n     expect(inspectedElement.hooks).toMatchInlineSnapshot(`\n       [\n         {\n+          \"debugInfo\": null,\n           \"hookSource\": {\n             \"columnNumber\": \"removed by Jest serializer\",\n             \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -1175,6 +1193,7 @@ describe('InspectedElement', () => {\n     expect(inspectedElement.hooks).toMatchInlineSnapshot(`\n       [\n         {\n+          \"debugInfo\": null,\n           \"hookSource\": {\n             \"columnNumber\": \"removed by Jest serializer\",\n             \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -1200,13 +1219,11 @@ describe('InspectedElement', () => {\n   it('should dehydrate complex nested values when requested', async () => {\n     const Example = () => null;\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Example\n           set_of_sets={new Set([new Set([1, 2, 3]), new Set(['a', 'b', 'c'])])}\n         />,\n-        container,\n       ),\n     );\n \n@@ -1265,9 +1282,8 @@ describe('InspectedElement', () => {\n   it('should include updates for nested values that were previously hydrated', async () => {\n     const Example = () => null;\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Example\n           nestedObject={{\n             a: {\n@@ -1287,7 +1303,6 @@ describe('InspectedElement', () => {\n             },\n           }}\n         />,\n-        container,\n       ),\n     );\n \n@@ -1370,7 +1385,7 @@ describe('InspectedElement', () => {\n \n     await TestRendererAct(async () => {\n       await TestUtilsAct(async () => {\n-        legacyRender(\n+        render(\n           <Example\n             nestedObject={{\n               a: {\n@@ -1390,7 +1405,6 @@ describe('InspectedElement', () => {\n               },\n             }}\n           />,\n-          container,\n         );\n       });\n     });\n@@ -1427,9 +1441,8 @@ describe('InspectedElement', () => {\n   it('should return a full update if a path is inspected for an object that has other pending changes', async () => {\n     const Example = () => null;\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Example\n           nestedObject={{\n             a: {\n@@ -1449,7 +1462,6 @@ describe('InspectedElement', () => {\n             },\n           }}\n         />,\n-        container,\n       ),\n     );\n \n@@ -1507,7 +1519,7 @@ describe('InspectedElement', () => {\n \n     await TestRendererAct(async () => {\n       await TestUtilsAct(async () => {\n-        legacyRender(\n+        render(\n           <Example\n             nestedObject={{\n               a: {\n@@ -1527,7 +1539,6 @@ describe('InspectedElement', () => {\n               },\n             }}\n           />,\n-          container,\n         );\n       });\n     });\n@@ -1561,9 +1572,8 @@ describe('InspectedElement', () => {\n   it('should not tear if hydration is requested after an update', async () => {\n     const Example = () => null;\n \n-    const container = document.createElement('div');\n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Example\n           nestedObject={{\n             value: 1,\n@@ -1575,7 +1585,6 @@ describe('InspectedElement', () => {\n             },\n           }}\n         />,\n-        container,\n       ),\n     );\n \n@@ -1610,7 +1619,7 @@ describe('InspectedElement', () => {\n     `);\n \n     await TestUtilsAct(async () => {\n-      legacyRender(\n+      render(\n         <Example\n           nestedObject={{\n             value: 2,\n@@ -1622,7 +1631,6 @@ describe('InspectedElement', () => {\n             },\n           }}\n         />,\n-        container,\n       );\n     });\n \n@@ -1643,17 +1651,16 @@ describe('InspectedElement', () => {\n     `);\n   });\n \n-  it('should inspect hooks for components that only use context', async () => {\n+  // TODO(hoxyq): Enable this test for versions ~18, currently broken\n+  // @reactVersion <= 18.2\n+  xit('should inspect hooks for components that only use context (legacy render)', async () => {\n     const Context = React.createContext(true);\n     const Example = () => {\n       const value = React.useContext(Context);\n       return value;\n     };\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(() =>\n-      legacyRender(<Example a={1} b=\"abc\" />, container),\n-    );\n+    await utils.actAsync(() => legacyRender(<Example a={1} b=\"abc\" />));\n \n     const inspectedElement = await inspectElementAtIndex(0);\n     expect(inspectedElement).toMatchInlineSnapshot(`\n@@ -1662,6 +1669,7 @@ describe('InspectedElement', () => {\n         \"events\": undefined,\n         \"hooks\": [\n           {\n+            \"debugInfo\": null,\n             \"hookSource\": {\n               \"columnNumber\": \"removed by Jest serializer\",\n               \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -1687,6 +1695,48 @@ describe('InspectedElement', () => {\n     `);\n   });\n \n+  it('should inspect hooks for components that only use context (createRoot)', async () => {\n+    const Context = React.createContext(true);\n+    const Example = () => {\n+      const value = React.useContext(Context);\n+      return value;\n+    };\n+\n+    await utils.actAsync(() => modernRender(<Example a={1} b=\"abc\" />));\n+\n+    const inspectedElement = await inspectElementAtIndex(0);\n+    expect(inspectedElement).toMatchInlineSnapshot(`\n+      {\n+        \"context\": null,\n+        \"events\": undefined,\n+        \"hooks\": [\n+          {\n+            \"debugInfo\": null,\n+            \"hookSource\": {\n+              \"columnNumber\": \"removed by Jest serializer\",\n+              \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n+              \"functionName\": \"Example\",\n+              \"lineNumber\": \"removed by Jest serializer\",\n+            },\n+            \"id\": null,\n+            \"isStateEditable\": false,\n+            \"name\": \"Context\",\n+            \"subHooks\": [],\n+            \"value\": true,\n+          },\n+        ],\n+        \"id\": 2,\n+        \"owners\": null,\n+        \"props\": {\n+          \"a\": 1,\n+          \"b\": \"abc\",\n+        },\n+        \"rootType\": \"createRoot()\",\n+        \"state\": null,\n+      }\n+    `);\n+  });\n+\n   it('should enable inspected values to be stored as global variables', async () => {\n     const Example = () => null;\n \n@@ -1702,12 +1752,7 @@ describe('InspectedElement', () => {\n       },\n     };\n \n-    await utils.actAsync(() =>\n-      legacyRender(\n-        <Example nestedObject={nestedObject} />,\n-        document.createElement('div'),\n-      ),\n-    );\n+    await utils.actAsync(() => render(<Example nestedObject={nestedObject} />));\n \n     let storeAsGlobal: StoreAsGlobal = ((null: any): StoreAsGlobal);\n \n@@ -1761,12 +1806,7 @@ describe('InspectedElement', () => {\n       },\n     };\n \n-    await utils.actAsync(() =>\n-      legacyRender(\n-        <Example nestedObject={nestedObject} />,\n-        document.createElement('div'),\n-      ),\n-    );\n+    await utils.actAsync(() => render(<Example nestedObject={nestedObject} />));\n \n     let copyPath: CopyInspectedElementPath =\n       ((null: any): CopyInspectedElementPath);\n@@ -1837,7 +1877,7 @@ describe('InspectedElement', () => {\n     const bigInt = BigInt(123); // eslint-disable-line no-undef\n \n     await utils.actAsync(() =>\n-      legacyRender(\n+      render(\n         <Example\n           arrayBuffer={arrayBuffer}\n           dataView={dataView}\n@@ -1849,7 +1889,6 @@ describe('InspectedElement', () => {\n           immutable={immutable}\n           bigInt={bigInt}\n         />,\n-        document.createElement('div'),\n       ),\n     );\n \n@@ -1902,8 +1941,6 @@ describe('InspectedElement', () => {\n   });\n \n   it('should display complex values of useDebugValue', async () => {\n-    const container = document.createElement('div');\n-\n     function useDebuggableHook() {\n       React.useDebugValue({foo: 2});\n       React.useState(1);\n@@ -1914,14 +1951,13 @@ describe('InspectedElement', () => {\n       return null;\n     }\n \n-    await utils.actAsync(() =>\n-      legacyRender(<DisplayedComplexValue />, container),\n-    );\n+    await utils.actAsync(() => render(<DisplayedComplexValue />));\n \n     const {hooks} = await inspectElementAtIndex(0);\n     expect(hooks).toMatchInlineSnapshot(`\n       [\n         {\n+          \"debugInfo\": null,\n           \"hookSource\": {\n             \"columnNumber\": \"removed by Jest serializer\",\n             \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -1933,6 +1969,7 @@ describe('InspectedElement', () => {\n           \"name\": \"DebuggableHook\",\n           \"subHooks\": [\n             {\n+              \"debugInfo\": null,\n               \"hookSource\": {\n                 \"columnNumber\": \"removed by Jest serializer\",\n                 \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -1967,10 +2004,7 @@ describe('InspectedElement', () => {\n       },\n     );\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(() =>\n-      legacyRender(<Example proxy={proxy} />, container),\n-    );\n+    await utils.actAsync(() => render(<Example proxy={proxy} />));\n \n     const inspectedElement = await inspectElementAtIndex(0);\n \n@@ -1994,12 +2028,13 @@ describe('InspectedElement', () => {\n     `);\n   });\n \n+  // TODO(hoxyq): Enable this test for versions ~18, currently broken\n   // Regression test for github.com/facebook/react/issues/22099\n-  it('should not error when an unchanged component is re-inspected after component filters changed', async () => {\n+  // @reactVersion <= 18.2\n+  xit('should not error when an unchanged component is re-inspected after component filters changed (legacy render)', async () => {\n     const Example = () => <div />;\n \n-    const container = document.createElement('div');\n-    await utils.actAsync(() => legacyRender(<Example />, container));\n+    await utils.actAsync(() => legacyRender(<Example />));\n \n     // Select/inspect element\n     let inspectedElement = await inspectElementAtIndex(0);\n@@ -2018,7 +2053,7 @@ describe('InspectedElement', () => {\n \n     await utils.actAsync(async () => {\n       // Ignore transient warning this causes\n-      utils.withErrorsOrWarningsIgnored(['No element found with id'], () => {\n+      withErrorsOrWarningsIgnored(['No element found with id'], () => {\n         store.componentFilters = [];\n \n         // Flush events to the renderer.\n@@ -2030,7 +2065,7 @@ describe('InspectedElement', () => {\n     // from props like defaultSelectedElementID and it's easier to reset here than\n     // to read the TreeDispatcherContext and update the selected ID that way.\n     // We're testing the inspected values here, not the context wiring, so that's ok.\n-    utils.withErrorsOrWarningsIgnored(\n+    withErrorsOrWarningsIgnored(\n       ['An update to %s inside a test was not wrapped in act'],\n       () => {\n         testRendererInstance = TestRenderer.create(null, {\n@@ -2055,7 +2090,69 @@ describe('InspectedElement', () => {\n     `);\n   });\n \n-  it('should display the root type for ReactDOM.hydrate', async () => {\n+  // Regression test for github.com/facebook/react/issues/22099\n+  it('should not error when an unchanged component is re-inspected after component filters changed (createRoot)', async () => {\n+    const Example = () => <div />;\n+\n+    await utils.actAsync(() => modernRender(<Example />));\n+\n+    // Select/inspect element\n+    let inspectedElement = await inspectElementAtIndex(0);\n+    expect(inspectedElement).toMatchInlineSnapshot(`\n+      {\n+        \"context\": null,\n+        \"events\": undefined,\n+        \"hooks\": null,\n+        \"id\": 2,\n+        \"owners\": null,\n+        \"props\": {},\n+        \"rootType\": \"createRoot()\",\n+        \"state\": null,\n+      }\n+    `);\n+\n+    await utils.actAsync(async () => {\n+      // Ignore transient warning this causes\n+      withErrorsOrWarningsIgnored(['No element found with id'], () => {\n+        store.componentFilters = [];\n+\n+        // Flush events to the renderer.\n+        jest.runOnlyPendingTimers();\n+      });\n+    }, false);\n+\n+    // HACK: Recreate TestRenderer instance because we rely on default state values\n+    // from props like defaultSelectedElementID and it's easier to reset here than\n+    // to read the TreeDispatcherContext and update the selected ID that way.\n+    // We're testing the inspected values here, not the context wiring, so that's ok.\n+    withErrorsOrWarningsIgnored(\n+      ['An update to %s inside a test was not wrapped in act'],\n+      () => {\n+        testRendererInstance = TestRenderer.create(null, {\n+          isConcurrent: true,\n+        });\n+      },\n+    );\n+\n+    // Select/inspect the same element again\n+    inspectedElement = await inspectElementAtIndex(0);\n+    expect(inspectedElement).toMatchInlineSnapshot(`\n+      {\n+        \"context\": null,\n+        \"events\": undefined,\n+        \"hooks\": null,\n+        \"id\": 2,\n+        \"owners\": null,\n+        \"props\": {},\n+        \"rootType\": \"createRoot()\",\n+        \"state\": null,\n+      }\n+    `);\n+  });\n+\n+  // TODO(hoxyq): Enable this test for versions ~18, currently broken\n+  // @reactVersion <= 18.2\n+  xit('should display the root type for ReactDOM.hydrate', async () => {\n     const Example = () => <div />;\n \n     await utils.actAsync(() => {\n@@ -2073,12 +2170,13 @@ describe('InspectedElement', () => {\n     expect(inspectedElement.rootType).toMatchInlineSnapshot(`\"hydrate()\"`);\n   });\n \n-  it('should display the root type for ReactDOM.render', async () => {\n+  // TODO(hoxyq): Enable this test for versions ~18, currently broken\n+  // @reactVersion <= 18.2\n+  xit('should display the root type for ReactDOM.render', async () => {\n     const Example = () => <div />;\n \n     await utils.actAsync(() => {\n-      const container = document.createElement('div');\n-      legacyRender(<Example />, container);\n+      legacyRender(<Example />);\n     }, false);\n \n     const inspectedElement = await inspectElementAtIndex(0);\n@@ -2126,8 +2224,7 @@ describe('InspectedElement', () => {\n     };\n \n     await utils.actAsync(() => {\n-      const container = document.createElement('div');\n-      ReactDOMClient.createRoot(container).render(<Example />);\n+      render(<Example />);\n     }, false);\n \n     shouldThrow = true;\n@@ -2148,17 +2245,15 @@ describe('InspectedElement', () => {\n         return count;\n       };\n \n-      const container = document.createElement('div');\n-      await utils.actAsync(() =>\n-        legacyRender(<Example a={1} b=\"abc\" />, container),\n-      );\n+      await utils.actAsync(() => render(<Example a={1} b=\"abc\" />));\n \n       await inspectElementAtIndex(0);\n \n       expect(global.$r).toMatchInlineSnapshot(`\n         {\n           \"hooks\": [\n             {\n+              \"debugInfo\": null,\n               \"hookSource\": {\n                 \"columnNumber\": \"removed by Jest serializer\",\n                 \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -2187,17 +2282,15 @@ describe('InspectedElement', () => {\n         return count;\n       });\n \n-      const container = document.createElement('div');\n-      await utils.actAsync(() =>\n-        legacyRender(<Example a={1} b=\"abc\" />, container),\n-      );\n+      await utils.actAsync(() => render(<Example a={1} b=\"abc\" />));\n \n       await inspectElementAtIndex(0);\n \n       expect(global.$r).toMatchInlineSnapshot(`\n         {\n           \"hooks\": [\n             {\n+              \"debugInfo\": null,\n               \"hookSource\": {\n                 \"columnNumber\": \"removed by Jest serializer\",\n                 \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -2226,17 +2319,15 @@ describe('InspectedElement', () => {\n         return count;\n       });\n \n-      const container = document.createElement('div');\n-      await utils.actAsync(() =>\n-        legacyRender(<Example a={1} b=\"abc\" />, container),\n-      );\n+      await utils.actAsync(() => render(<Example a={1} b=\"abc\" />));\n \n       await inspectElementAtIndex(0);\n \n       expect(global.$r).toMatchInlineSnapshot(`\n         {\n           \"hooks\": [\n             {\n+              \"debugInfo\": null,\n               \"hookSource\": {\n                 \"columnNumber\": \"removed by Jest serializer\",\n                 \"fileName\": \"react-devtools-shared/src/__tests__/inspectedElement-test.js\",\n@@ -2269,10 +2360,7 @@ describe('InspectedElement', () => {\n         }\n       }\n \n-      const container = document.createElement('div');\n-      await utils.actAsync(() =>\n-        legacyRender(<Example a={1} b=\"abc\" />, container),\n-      );\n+      await utils.actAsync(() => render(<Example a={1} b=\"abc\" />));\n \n       await inspectElementAtIndex(0);\n \n@@ -2334,12 +2422,8 @@ describe('InspectedElement', () => {\n         return null;\n       };\n \n-      const container = document.createElement('div');\n-\n       await withErrorsOrWarningsIgnored(['test-only: '], async () => {\n-        await utils.actAsync(() =>\n-          legacyRender(<Example repeatWarningCount={1} />, container),\n-        );\n+        await utils.actAsync(() => render(<Example repeatWarningCount={1} />));\n       });\n \n       const data = await getErrorsAndWarningsForElementAtIndex(0);\n@@ -2371,11 +2455,8 @@ describe('InspectedElement', () => {\n         return null;\n       };\n \n-      const container = document.createElement('div');\n-      await utils.withErrorsOrWarningsIgnored(['test-only:'], async () => {\n-        await utils.actAsync(() =>\n-          legacyRender(<Example repeatWarningCount={1} />, container),\n-        );\n+      await withErrorsOrWarningsIgnored(['test-only:'], async () => {\n+        await utils.actAsync(() => render(<Example repeatWarningCount={1} />));\n       });\n       const data = await getErrorsAndWarningsForElementAtIndex(0);\n       expect(data).toMatchInlineSnapshot(`\n@@ -2407,11 +2488,8 @@ describe('InspectedElement', () => {\n         return null;\n       };\n \n-      const container = document.createElement('div');\n-      await utils.withErrorsOrWarningsIgnored(['test-only:'], async () => {\n-        await utils.actAsync(() =>\n-          legacyRender(<Example repeatWarningCount={1} />, container),\n-        );\n+      await withErrorsOrWarningsIgnored(['test-only:'], async () => {\n+        await utils.actAsync(() => render(<Example repeatWarningCount={1} />));\n       });\n \n       const data = await getErrorsAndWarningsForElementAtIndex(0);\n@@ -2444,11 +2522,8 @@ describe('InspectedElement', () => {\n         return null;\n       };\n \n-      const container = document.createElement('div');\n-      await utils.withErrorsOrWarningsIgnored(['test-only:'], async () => {\n-        await utils.actAsync(() =>\n-          legacyRender(<Example repeatWarningCount={1} />, container),\n-        );\n+      await withErrorsOrWarningsIgnored(['test-only:'], async () => {\n+        await utils.actAsync(() => render(<Example repeatWarningCount={1} />));\n       });\n \n       const data = await getErrorsAndWarningsForElementAtIndex(0);\n@@ -2475,12 +2550,11 @@ describe('InspectedElement', () => {\n         return [<div />];\n       };\n \n-      const container = document.createElement('div');\n-      await utils.withErrorsOrWarningsIgnored(\n+      await withErrorsOrWarningsIgnored(\n         ['Warning: Each child in a list should have a unique \"key\" prop.'],\n         async () => {\n           await utils.actAsync(() =>\n-            legacyRender(<Example repeatWarningCount={1} />, container),\n+            render(<Example repeatWarningCount={1} />),\n           );\n         },\n       );\n@@ -2490,7 +2564,7 @@ describe('InspectedElement', () => {\n         {\n           \"errors\": [\n             [\n-              \"Warning: Each child in a list should have a unique \"key\" prop. See https://reactjs.org/link/warning-keys for more information.\n+              \"Warning: Each child in a list should have a unique \"key\" prop. See https://react.dev/link/warning-keys for more information.\n             at Example\",\n               1,\n             ],\n@@ -2507,11 +2581,8 @@ describe('InspectedElement', () => {\n         return null;\n       };\n \n-      const container = document.createElement('div');\n-      await utils.withErrorsOrWarningsIgnored(['test-only:'], async () => {\n-        await utils.actAsync(() =>\n-          legacyRender(<Example repeatWarningCount={1} />, container),\n-        );\n+      await withErrorsOrWarningsIgnored(['test-only:'], async () => {\n+        await utils.actAsync(() => render(<Example repeatWarningCount={1} />));\n       });\n \n       const {\n@@ -2538,15 +2609,13 @@ describe('InspectedElement', () => {\n         return null;\n       };\n \n-      const container = document.createElement('div');\n-      await utils.withErrorsOrWarningsIgnored(['test-only:'], async () => {\n+      await withErrorsOrWarningsIgnored(['test-only:'], async () => {\n         await utils.actAsync(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Example id={1} />\n               <Example id={2} />\n             </React.Fragment>,\n-            container,\n           ),\n         );\n       });\n@@ -2635,15 +2704,13 @@ describe('InspectedElement', () => {\n         return null;\n       };\n \n-      const container = document.createElement('div');\n-      await utils.withErrorsOrWarningsIgnored(['test-only:'], async () => {\n+      await withErrorsOrWarningsIgnored(['test-only:'], async () => {\n         await utils.actAsync(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Example id={1} />\n               <Example id={2} />\n             </React.Fragment>,\n-            container,\n           ),\n         );\n       });\n@@ -2726,7 +2793,9 @@ describe('InspectedElement', () => {\n     });\n   });\n \n-  it('inspecting nested renderers should not throw', async () => {\n+  // TODO(hoxyq): Enable this test for versions ~18, currently broken\n+  // @reactVersion <= 18.2\n+  xit('inspecting nested renderers should not throw (legacy render)', async () => {\n     // Ignoring react art warnings\n     jest.spyOn(console, 'error').mockImplementation(() => {});\n     const ReactArt = require('react-art');\n@@ -2749,7 +2818,7 @@ describe('InspectedElement', () => {\n     }\n \n     await utils.actAsync(() => {\n-      legacyRender(<App />, document.createElement('div'));\n+      legacyRender(<App />);\n     });\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n@@ -2784,6 +2853,64 @@ describe('InspectedElement', () => {\n     `);\n   });\n \n+  it('inspecting nested renderers should not throw (createRoot)', async () => {\n+    // Ignoring react art warnings\n+    jest.spyOn(console, 'error').mockImplementation(() => {});\n+    const ReactArt = require('react-art');\n+    const ArtSVGMode = require('art/modes/svg');\n+    const ARTCurrentMode = require('art/modes/current');\n+    store.componentFilters = [];\n+\n+    ARTCurrentMode.setCurrent(ArtSVGMode);\n+    const {Surface, Group} = ReactArt;\n+\n+    function Child() {\n+      return (\n+        <Surface width={1} height={1}>\n+          <Group />\n+        </Surface>\n+      );\n+    }\n+    function App() {\n+      return <Child />;\n+    }\n+\n+    await utils.actAsync(() => {\n+      modernRender(<App />);\n+    });\n+    expect(store).toMatchInlineSnapshot(`\n+      [root]\n+        \u25be <App>\n+          \u25be <Child>\n+            \u25be <Surface>\n+                <svg>\n+      [root]\n+          <Group>\n+    `);\n+\n+    const inspectedElement = await inspectElementAtIndex(4);\n+    expect(inspectedElement.owners).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"compiledWithForget\": false,\n+          \"displayName\": \"Child\",\n+          \"hocDisplayNames\": null,\n+          \"id\": 5,\n+          \"key\": null,\n+          \"type\": 5,\n+        },\n+        {\n+          \"compiledWithForget\": false,\n+          \"displayName\": \"App\",\n+          \"hocDisplayNames\": null,\n+          \"id\": 4,\n+          \"key\": null,\n+          \"type\": 5,\n+        },\n+      ]\n+    `);\n+  });\n+\n   describe('error boundary', () => {\n     it('can toggle error', async () => {\n       class LocalErrorBoundary extends React.Component<any> {\n@@ -2800,11 +2927,10 @@ describe('InspectedElement', () => {\n       const Example = () => 'example';\n \n       await utils.actAsync(() =>\n-        legacyRender(\n+        render(\n           <LocalErrorBoundary>\n             <Example />\n           </LocalErrorBoundary>,\n-          document.createElement('div'),\n         ),\n       );\n \n@@ -2813,7 +2939,7 @@ describe('InspectedElement', () => {\n       ): any): number);\n       const inspect = index => {\n         // HACK: Recreate TestRenderer instance so we can inspect different elements\n-        utils.withErrorsOrWarningsIgnored(\n+        withErrorsOrWarningsIgnored(\n           ['An update to %s inside a test was not wrapped in act'],\n           () => {\n             testRendererInstance = TestRenderer.create(null, {"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/legacy/storeLegacy-v15-test.js",
                "git_diff": "@@ -753,37 +753,43 @@ describe('Store (legacy)', () => {\n       `);\n     });\n \n-    it('should support expanding deep parts of the tree', () => {\n-      const Wrapper = ({forwardedRef}) => (\n-        <Nested depth={3} forwardedRef={forwardedRef} />\n-      );\n-      const Nested = ({depth, forwardedRef}) =>\n-        depth > 0 ? (\n-          <Nested depth={depth - 1} forwardedRef={forwardedRef} />\n-        ) : (\n-          <div ref={forwardedRef} />\n+    // TODO: These tests don't work when enableRefAsProp is on because the\n+    // JSX runtime that's injected into the test environment by the compiler\n+    // is not compatible with older versions of React. Need to configure the\n+    // the test environment in such a way that certain test modules like this\n+    // one can use an older transform.\n+    if (!require('shared/ReactFeatureFlags').enableRefAsProp) {\n+      it('should support expanding deep parts of the tree', () => {\n+        const Wrapper = ({forwardedRef}) => (\n+          <Nested depth={3} forwardedRef={forwardedRef} />\n         );\n-\n-      let ref = null;\n-      const refSetter = value => {\n-        ref = value;\n-      };\n-\n-      act(() =>\n-        ReactDOM.render(\n-          <Wrapper forwardedRef={refSetter} />,\n-          document.createElement('div'),\n-        ),\n-      );\n-      expect(store).toMatchInlineSnapshot(`\n+        const Nested = ({depth, forwardedRef}) =>\n+          depth > 0 ? (\n+            <Nested depth={depth - 1} forwardedRef={forwardedRef} />\n+          ) : (\n+            <div ref={forwardedRef} />\n+          );\n+\n+        let ref = null;\n+        const refSetter = value => {\n+          ref = value;\n+        };\n+\n+        act(() =>\n+          ReactDOM.render(\n+            <Wrapper forwardedRef={refSetter} />,\n+            document.createElement('div'),\n+          ),\n+        );\n+        expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <Wrapper>\n       `);\n \n-      const deepestedNodeID = global.agent.getIDForNode(ref);\n+        const deepestedNodeID = global.agent.getIDForNode(ref);\n \n-      act(() => store.toggleIsCollapsed(deepestedNodeID, false));\n-      expect(store).toMatchInlineSnapshot(`\n+        act(() => store.toggleIsCollapsed(deepestedNodeID, false));\n+        expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Wrapper>\n             \u25be <Nested>\n@@ -793,16 +799,16 @@ describe('Store (legacy)', () => {\n                       <div>\n       `);\n \n-      const rootID = store.getElementIDAtIndex(0);\n+        const rootID = store.getElementIDAtIndex(0);\n \n-      act(() => store.toggleIsCollapsed(rootID, true));\n-      expect(store).toMatchInlineSnapshot(`\n+        act(() => store.toggleIsCollapsed(rootID, true));\n+        expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <Wrapper>\n       `);\n \n-      act(() => store.toggleIsCollapsed(rootID, false));\n-      expect(store).toMatchInlineSnapshot(`\n+        act(() => store.toggleIsCollapsed(rootID, false));\n+        expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Wrapper>\n             \u25be <Nested>\n@@ -812,17 +818,17 @@ describe('Store (legacy)', () => {\n                       <div>\n       `);\n \n-      const id = store.getElementIDAtIndex(1);\n+        const id = store.getElementIDAtIndex(1);\n \n-      act(() => store.toggleIsCollapsed(id, true));\n-      expect(store).toMatchInlineSnapshot(`\n+        act(() => store.toggleIsCollapsed(id, true));\n+        expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Wrapper>\n             \u25b8 <Nested>\n       `);\n \n-      act(() => store.toggleIsCollapsed(id, false));\n-      expect(store).toMatchInlineSnapshot(`\n+        act(() => store.toggleIsCollapsed(id, false));\n+        expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Wrapper>\n             \u25be <Nested>\n@@ -831,7 +837,8 @@ describe('Store (legacy)', () => {\n                   \u25be <Nested>\n                       <div>\n       `);\n-    });\n+      });\n+    }\n \n     it('should support reordering of children', () => {\n       const Root = ({children}) => <div>{children}</div>;"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/ownersListContext-test.js",
                "git_diff": "@@ -12,11 +12,12 @@ import type {Element} from 'react-devtools-shared/src/frontend/types';\n import type {FrontendBridge} from 'react-devtools-shared/src/bridge';\n import type Store from 'react-devtools-shared/src/devtools/store';\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('OwnersListContext', () => {\n   let React;\n   let TestRenderer: ReactTestRenderer;\n   let bridge: FrontendBridge;\n-  let legacyRender;\n   let store: Store;\n   let utils;\n \n@@ -30,8 +31,6 @@ describe('OwnersListContext', () => {\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    legacyRender = utils.legacyRender;\n-\n     bridge = global.bridge;\n     store = global.store;\n     store.collapseNodesByDefault = false;\n@@ -51,6 +50,8 @@ describe('OwnersListContext', () => {\n       require('react-devtools-shared/src/devtools/views/Components/TreeContext').TreeContextController;\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   const Contexts = ({children, defaultOwnerID = null}) => (\n     <BridgeContext.Provider value={bridge}>\n       <StoreContext.Provider value={store}>\n@@ -98,9 +99,7 @@ describe('OwnersListContext', () => {\n     };\n     const Child = () => null;\n \n-    utils.act(() =>\n-      legacyRender(<Grandparent />, document.createElement('div')),\n-    );\n+    utils.act(() => render(<Grandparent />));\n \n     expect(store).toMatchInlineSnapshot(`\n       [root]\n@@ -143,9 +142,7 @@ describe('OwnersListContext', () => {\n     };\n     const Child = () => null;\n \n-    utils.act(() =>\n-      legacyRender(<Grandparent />, document.createElement('div')),\n-    );\n+    utils.act(() => render(<Grandparent />));\n \n     expect(store).toMatchInlineSnapshot(`\n       [root]\n@@ -171,9 +168,7 @@ describe('OwnersListContext', () => {\n     const Grandparent = () => <Parent />;\n     const Parent = () => null;\n \n-    utils.act(() =>\n-      legacyRender(<Grandparent />, document.createElement('div')),\n-    );\n+    utils.act(() => render(<Grandparent />));\n \n     expect(store).toMatchInlineSnapshot(`\n       [root]\n@@ -198,9 +193,7 @@ describe('OwnersListContext', () => {\n       return <Memo ref={ref} />;\n     };\n \n-    utils.act(() =>\n-      legacyRender(<Grandparent />, document.createElement('div')),\n-    );\n+    utils.act(() => render(<Grandparent />));\n \n     expect(store).toMatchInlineSnapshot(`\n       [root]"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/preprocessData-test.js",
                "git_diff": "@@ -9,7 +9,12 @@\n \n 'use strict';\n \n-import {normalizeCodeLocInfo} from './utils';\n+import semver from 'semver';\n+\n+import {getLegacyRenderImplementation, normalizeCodeLocInfo} from './utils';\n+import {ReactVersion} from '../../../../ReactVersions';\n+\n+const ReactVersionTestingAgainst = process.env.REACT_VERSION || ReactVersion;\n \n describe('Timeline profiler', () => {\n   let React;\n@@ -76,6 +81,13 @@ describe('Timeline profiler', () => {\n     }\n \n     beforeEach(() => {\n+      // Mock react/jsx-dev-runtime for React 16.x\n+      // Although there are no tests in this suite which will run for React 16,\n+      // Jest will report an error trying to resolve this dependency\n+      if (semver.lt(ReactVersionTestingAgainst, '17.0.0')) {\n+        jest.mock('react/jsx-dev-runtime', () => {});\n+      }\n+\n       utils = require('./utils');\n       utils.beforeEachProfiling();\n \n@@ -107,6 +119,8 @@ describe('Timeline profiler', () => {\n       setPerformanceMock(null);\n     });\n \n+    const {render: legacyRender} = getLegacyRenderImplementation();\n+\n     describe('getLanesFromTransportDecimalBitmask', () => {\n       let getLanesFromTransportDecimalBitmask;\n \n@@ -614,8 +628,10 @@ describe('Timeline profiler', () => {\n         `);\n       });\n \n+      // @reactVersion <= 18.2\n+      // @reactVersion >= 18.0\n       it('should process a sample legacy render sequence', async () => {\n-        utils.legacyRender(<div />, document.createElement('div'));\n+        legacyRender(<div />);\n \n         const data = await preprocessData([\n           ...createBoilerplateEntries(),\n@@ -629,31 +645,31 @@ describe('Timeline profiler', () => {\n                   \"batchUID\": 0,\n                   \"depth\": 0,\n                   \"duration\": 0.01,\n-                  \"lanes\": \"0b0000000000000000000000000000001\",\n+                  \"lanes\": \"0b0000000000000000000000000000000\",\n                   \"timestamp\": 0.006,\n                   \"type\": \"render-idle\",\n                 },\n                 {\n                   \"batchUID\": 0,\n                   \"depth\": 0,\n                   \"duration\": 0.001,\n-                  \"lanes\": \"0b0000000000000000000000000000001\",\n+                  \"lanes\": \"0b0000000000000000000000000000000\",\n                   \"timestamp\": 0.006,\n                   \"type\": \"render\",\n                 },\n                 {\n                   \"batchUID\": 0,\n                   \"depth\": 0,\n                   \"duration\": 0.008,\n-                  \"lanes\": \"0b0000000000000000000000000000001\",\n+                  \"lanes\": \"0b0000000000000000000000000000000\",\n                   \"timestamp\": 0.008,\n                   \"type\": \"commit\",\n                 },\n                 {\n                   \"batchUID\": 0,\n                   \"depth\": 1,\n                   \"duration\": 0.001,\n-                  \"lanes\": \"0b0000000000000000000000000000001\",\n+                  \"lanes\": \"0b0000000000000000000000000000000\",\n                   \"timestamp\": 0.014,\n                   \"type\": \"layout-effects\",\n                 },\n@@ -714,41 +730,41 @@ describe('Timeline profiler', () => {\n               30 => \"Offscreen\",\n             },\n             \"laneToReactMeasureMap\": Map {\n-              0 => [],\n-              1 => [\n+              0 => [\n                 {\n                   \"batchUID\": 0,\n                   \"depth\": 0,\n                   \"duration\": 0.01,\n-                  \"lanes\": \"0b0000000000000000000000000000001\",\n+                  \"lanes\": \"0b0000000000000000000000000000000\",\n                   \"timestamp\": 0.006,\n                   \"type\": \"render-idle\",\n                 },\n                 {\n                   \"batchUID\": 0,\n                   \"depth\": 0,\n                   \"duration\": 0.001,\n-                  \"lanes\": \"0b0000000000000000000000000000001\",\n+                  \"lanes\": \"0b0000000000000000000000000000000\",\n                   \"timestamp\": 0.006,\n                   \"type\": \"render\",\n                 },\n                 {\n                   \"batchUID\": 0,\n                   \"depth\": 0,\n                   \"duration\": 0.008,\n-                  \"lanes\": \"0b0000000000000000000000000000001\",\n+                  \"lanes\": \"0b0000000000000000000000000000000\",\n                   \"timestamp\": 0.008,\n                   \"type\": \"commit\",\n                 },\n                 {\n                   \"batchUID\": 0,\n                   \"depth\": 1,\n                   \"duration\": 0.001,\n-                  \"lanes\": \"0b0000000000000000000000000000001\",\n+                  \"lanes\": \"0b0000000000000000000000000000000\",\n                   \"timestamp\": 0.014,\n                   \"type\": \"layout-effects\",\n                 },\n               ],\n+              1 => [],\n               2 => [],\n               3 => [],\n               4 => [],\n@@ -785,7 +801,7 @@ describe('Timeline profiler', () => {\n             \"reactVersion\": \"<filtered-version>\",\n             \"schedulingEvents\": [\n               {\n-                \"lanes\": \"0b0000000000000000000000000000001\",\n+                \"lanes\": \"0b0000000000000000000000000000000\",\n                 \"timestamp\": 0.005,\n                 \"type\": \"schedule-render\",\n                 \"warning\": null,\n@@ -1132,9 +1148,9 @@ describe('Timeline profiler', () => {\n       });\n \n       // @reactVersion >= 18.0\n+      // @reactVersion <= 18.2\n       it('should error if events and measures are incomplete', async () => {\n-        const container = document.createElement('div');\n-        utils.legacyRender(<div />, container);\n+        legacyRender(<div />);\n \n         const invalidMarks = clearedMarks.filter(\n           mark => !mark.includes('render-stop'),\n@@ -1150,9 +1166,9 @@ describe('Timeline profiler', () => {\n       });\n \n       // @reactVersion >= 18.0\n+      // @reactVersion <= 18.2\n       it('should error if work is completed without being started', async () => {\n-        const container = document.createElement('div');\n-        utils.legacyRender(<div />, container);\n+        legacyRender(<div />);\n \n         const invalidMarks = clearedMarks.filter(\n           mark => !mark.includes('render-start'),\n@@ -1262,6 +1278,7 @@ describe('Timeline profiler', () => {\n       describe('warnings', () => {\n         describe('long event handlers', () => {\n           // @reactVersion >= 18.0\n+          // @reactVersion <= 18.2\n           it('should not warn when React scedules a (sync) update inside of a short event handler', async () => {\n             function App() {\n               return null;\n@@ -1275,7 +1292,7 @@ describe('Timeline profiler', () => {\n \n             clearPendingMarks();\n \n-            utils.legacyRender(<App />, document.createElement('div'));\n+            legacyRender(<App />);\n \n             testMarks.push(...createUserTimingData(clearedMarks));\n \n@@ -1285,6 +1302,7 @@ describe('Timeline profiler', () => {\n           });\n \n           // @reactVersion >= 18.0\n+          // @reactVersion <= 18.2\n           it('should not warn about long events if the cause was non-React JavaScript', async () => {\n             function App() {\n               return null;\n@@ -1300,7 +1318,7 @@ describe('Timeline profiler', () => {\n \n             clearPendingMarks();\n \n-            utils.legacyRender(<App />, document.createElement('div'));\n+            legacyRender(<App />);\n \n             testMarks.push(...createUserTimingData(clearedMarks));\n \n@@ -1310,6 +1328,7 @@ describe('Timeline profiler', () => {\n           });\n \n           // @reactVersion >= 18.0\n+          // @reactVersion <= 18.2\n           it('should warn when React scedules a long (sync) update inside of an event', async () => {\n             function App() {\n               return null;\n@@ -1323,7 +1342,7 @@ describe('Timeline profiler', () => {\n \n             clearPendingMarks();\n \n-            utils.legacyRender(<App />, document.createElement('div'));\n+            legacyRender(<App />);\n \n             clearedMarks.forEach(markName => {\n               if (markName === '--render-stop') {\n@@ -1929,8 +1948,12 @@ describe('Timeline profiler', () => {\n       global.IS_REACT_ACT_ENVIRONMENT = true;\n     });\n \n+    const {render: legacyRender} = getLegacyRenderImplementation();\n+\n+    // @reactVersion <= 18.2\n+    // @reactVersion >= 18.0\n     it('should process a sample legacy render sequence', async () => {\n-      utils.legacyRender(<div />, document.createElement('div'));\n+      legacyRender(<div />);\n       utils.act(() => store.profilerStore.stopProfiling());\n \n       const data = store.profilerStore.profilingData?.timelineData;\n@@ -1944,31 +1967,31 @@ describe('Timeline profiler', () => {\n                 \"batchUID\": 1,\n                 \"depth\": 0,\n                 \"duration\": 0,\n-                \"lanes\": \"0b0000000000000000000000000000010\",\n+                \"lanes\": \"0b0000000000000000000000000000001\",\n                 \"timestamp\": 10,\n                 \"type\": \"render-idle\",\n               },\n               {\n                 \"batchUID\": 1,\n                 \"depth\": 0,\n                 \"duration\": 0,\n-                \"lanes\": \"0b0000000000000000000000000000010\",\n+                \"lanes\": \"0b0000000000000000000000000000001\",\n                 \"timestamp\": 10,\n                 \"type\": \"render\",\n               },\n               {\n                 \"batchUID\": 1,\n                 \"depth\": 0,\n                 \"duration\": 0,\n-                \"lanes\": \"0b0000000000000000000000000000010\",\n+                \"lanes\": \"0b0000000000000000000000000000001\",\n                 \"timestamp\": 10,\n                 \"type\": \"commit\",\n               },\n               {\n                 \"batchUID\": 1,\n                 \"depth\": 1,\n                 \"duration\": 0,\n-                \"lanes\": \"0b0000000000000000000000000000010\",\n+                \"lanes\": \"0b0000000000000000000000000000001\",\n                 \"timestamp\": 10,\n                 \"type\": \"layout-effects\",\n               },\n@@ -1979,13 +2002,13 @@ describe('Timeline profiler', () => {\n           \"flamechart\": [],\n           \"internalModuleSourceToRanges\": Map {},\n           \"laneToLabelMap\": Map {\n-            1 => \"SyncHydrationLane\",\n-            2 => \"Sync\",\n-            4 => \"InputContinuousHydration\",\n-            8 => \"InputContinuous\",\n-            16 => \"DefaultHydration\",\n-            32 => \"Default\",\n-            64 => \"TransitionHydration\",\n+            1 => \"Sync\",\n+            2 => \"InputContinuousHydration\",\n+            4 => \"InputContinuous\",\n+            8 => \"DefaultHydration\",\n+            16 => \"Default\",\n+            32 => \"TransitionHydration\",\n+            64 => \"Transition\",\n             128 => \"Transition\",\n             256 => \"Transition\",\n             512 => \"Transition\",\n@@ -2005,48 +2028,48 @@ describe('Timeline profiler', () => {\n             8388608 => \"Retry\",\n             16777216 => \"Retry\",\n             33554432 => \"Retry\",\n-            67108864 => \"SelectiveHydration\",\n-            134217728 => \"IdleHydration\",\n-            268435456 => \"Idle\",\n-            536870912 => \"Offscreen\",\n-            1073741824 => \"Deferred\",\n+            67108864 => \"Retry\",\n+            134217728 => \"SelectiveHydration\",\n+            268435456 => \"IdleHydration\",\n+            536870912 => \"Idle\",\n+            1073741824 => \"Offscreen\",\n           },\n           \"laneToReactMeasureMap\": Map {\n-            1 => [],\n-            2 => [\n+            1 => [\n               {\n                 \"batchUID\": 1,\n                 \"depth\": 0,\n                 \"duration\": 0,\n-                \"lanes\": \"0b0000000000000000000000000000010\",\n+                \"lanes\": \"0b0000000000000000000000000000001\",\n                 \"timestamp\": 10,\n                 \"type\": \"render-idle\",\n               },\n               {\n                 \"batchUID\": 1,\n                 \"depth\": 0,\n                 \"duration\": 0,\n-                \"lanes\": \"0b0000000000000000000000000000010\",\n+                \"lanes\": \"0b0000000000000000000000000000001\",\n                 \"timestamp\": 10,\n                 \"type\": \"render\",\n               },\n               {\n                 \"batchUID\": 1,\n                 \"depth\": 0,\n                 \"duration\": 0,\n-                \"lanes\": \"0b0000000000000000000000000000010\",\n+                \"lanes\": \"0b0000000000000000000000000000001\",\n                 \"timestamp\": 10,\n                 \"type\": \"commit\",\n               },\n               {\n                 \"batchUID\": 1,\n                 \"depth\": 1,\n                 \"duration\": 0,\n-                \"lanes\": \"0b0000000000000000000000000000010\",\n+                \"lanes\": \"0b0000000000000000000000000000001\",\n                 \"timestamp\": 10,\n                 \"type\": \"layout-effects\",\n               },\n             ],\n+            2 => [],\n             4 => [],\n             8 => [],\n             16 => [],\n@@ -2083,7 +2106,7 @@ describe('Timeline profiler', () => {\n           \"reactVersion\": \"<filtered-version>\",\n           \"schedulingEvents\": [\n             {\n-              \"lanes\": \"0b0000000000000000000000000000010\",\n+              \"lanes\": \"0b0000000000000000000000000000001\",\n               \"timestamp\": 10,\n               \"type\": \"schedule-render\",\n               \"warning\": null,"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilerChangeDescriptions-test.js",
                "git_diff": "@@ -7,25 +7,26 @@\n  * @flow\n  */\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('Profiler change descriptions', () => {\n   let React;\n-  let legacyRender;\n   let store;\n   let utils;\n \n   beforeEach(() => {\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    legacyRender = utils.legacyRender;\n-\n     store = global.store;\n     store.collapseNodesByDefault = false;\n     store.recordChangeDescriptions = true;\n \n     React = require('react');\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   // @reactVersion >=18.0\n   it('should identify useContext as the cause for a re-render', () => {\n     const Context = React.createContext(0);\n@@ -62,10 +63,8 @@ describe('Profiler change descriptions', () => {\n       );\n     };\n \n-    const container = document.createElement('div');\n-\n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => legacyRender(<App />, container));\n+    utils.act(() => render(<App />));\n     utils.act(() => forceUpdate());\n     utils.act(() => store.profilerStore.stopProfiling());\n "
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilerContext-test.js",
                "git_diff": "@@ -13,9 +13,12 @@ import type {Context} from 'react-devtools-shared/src/devtools/views/Profiler/Pr\n import type {DispatcherContext} from 'react-devtools-shared/src/devtools/views/Components/TreeContext';\n import type Store from 'react-devtools-shared/src/devtools/store';\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('ProfilerContext', () => {\n   let React;\n   let ReactDOM;\n+  let ReactDOMClient;\n   let TestRenderer: ReactTestRenderer;\n   let bridge: FrontendBridge;\n   let legacyRender;\n@@ -43,6 +46,7 @@ describe('ProfilerContext', () => {\n \n     React = require('react');\n     ReactDOM = require('react-dom');\n+    ReactDOMClient = require('react-dom/client');\n     TestRenderer = utils.requireTestRenderer();\n \n     BridgeContext =\n@@ -61,6 +65,8 @@ describe('ProfilerContext', () => {\n       require('react-devtools-shared/src/devtools/views/Components/TreeContext').TreeStateContext;\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   const Contexts = ({\n     children = null,\n     defaultSelectedElementID = null,\n@@ -77,7 +83,9 @@ describe('ProfilerContext', () => {\n     </BridgeContext.Provider>\n   );\n \n-  it('updates updates profiling support based on the attached roots', async () => {\n+  // @reactVersion <= 18.2\n+  // @reactVersion >= 18.0\n+  it('updates updates profiling support based on the attached roots (legacy render)', async () => {\n     const Component = () => null;\n \n     let context: Context = ((null: any): Context);\n@@ -110,10 +118,47 @@ describe('ProfilerContext', () => {\n     expect(context.supportsProfiling).toBe(false);\n   });\n \n+  // @reactVersion >= 18\n+  it('updates updates profiling support based on the attached roots (createRoot)', async () => {\n+    const Component = () => null;\n+\n+    let context: Context = ((null: any): Context);\n+\n+    function ContextReader() {\n+      context = React.useContext(ProfilerContext);\n+      return null;\n+    }\n+    await utils.actAsync(() => {\n+      TestRenderer.create(\n+        <Contexts>\n+          <ContextReader />\n+        </Contexts>,\n+      );\n+    });\n+\n+    expect(context.supportsProfiling).toBe(false);\n+\n+    const containerA = document.createElement('div');\n+    const containerB = document.createElement('div');\n+\n+    const rootA = ReactDOMClient.createRoot(containerA);\n+    const rootB = ReactDOMClient.createRoot(containerB);\n+\n+    await utils.actAsync(() => rootA.render(<Component />));\n+    expect(context.supportsProfiling).toBe(true);\n+\n+    await utils.actAsync(() => rootB.render(<Component />));\n+    await utils.actAsync(() => rootA.unmount());\n+    expect(context.supportsProfiling).toBe(true);\n+\n+    await utils.actAsync(() => rootB.unmount());\n+    expect(context.supportsProfiling).toBe(false);\n+  });\n+\n   it('should gracefully handle an empty profiling session (with no recorded commits)', async () => {\n     const Example = () => null;\n \n-    utils.act(() => legacyRender(<Example />, document.createElement('div')));\n+    utils.act(() => render(<Example />));\n \n     let context: Context = ((null: any): Context);\n \n@@ -145,7 +190,9 @@ describe('ProfilerContext', () => {\n     expect(context.profilingData).toBe(null);\n   });\n \n-  it('should auto-select the root ID matching the Components tab selection if it has profiling data', async () => {\n+  // @reactVersion <= 18.2\n+  // @reactVersion >= 18.0\n+  it('should auto-select the root ID matching the Components tab selection if it has profiling data (legacy render)', async () => {\n     const Parent = () => <Child />;\n     const Child = () => null;\n \n@@ -191,7 +238,60 @@ describe('ProfilerContext', () => {\n     );\n   });\n \n-  it('should not select the root ID matching the Components tab selection if it has no profiling data', async () => {\n+  // @reactVersion >= 18\n+  it('should auto-select the root ID matching the Components tab selection if it has profiling data (createRoot)', async () => {\n+    const Parent = () => <Child />;\n+    const Child = () => null;\n+\n+    const containerOne = document.createElement('div');\n+    const containerTwo = document.createElement('div');\n+\n+    const rootOne = ReactDOMClient.createRoot(containerOne);\n+    const rootTwo = ReactDOMClient.createRoot(containerTwo);\n+\n+    utils.act(() => rootOne.render(<Parent />));\n+    utils.act(() => rootTwo.render(<Parent />));\n+    expect(store).toMatchInlineSnapshot(`\n+      [root]\n+        \u25be <Parent>\n+            <Child>\n+      [root]\n+        \u25be <Parent>\n+            <Child>\n+    `);\n+\n+    // Profile and record updates to both roots.\n+    await utils.actAsync(() => store.profilerStore.startProfiling());\n+    await utils.actAsync(() => rootOne.render(<Parent />));\n+    await utils.actAsync(() => rootTwo.render(<Parent />));\n+    await utils.actAsync(() => store.profilerStore.stopProfiling());\n+\n+    let context: Context = ((null: any): Context);\n+    function ContextReader() {\n+      context = React.useContext(ProfilerContext);\n+      return null;\n+    }\n+\n+    // Select an element within the second root.\n+    await utils.actAsync(() =>\n+      TestRenderer.create(\n+        <Contexts\n+          defaultSelectedElementID={store.getElementIDAtIndex(3)}\n+          defaultSelectedElementIndex={3}>\n+          <ContextReader />\n+        </Contexts>,\n+      ),\n+    );\n+\n+    expect(context).not.toBeNull();\n+    expect(context.rootID).toBe(\n+      store.getRootIDForElement(((store.getElementIDAtIndex(3): any): number)),\n+    );\n+  });\n+\n+  // @reactVersion <= 18.2\n+  // @reactVersion >= 18.0\n+  it('should not select the root ID matching the Components tab selection if it has no profiling data (legacy render)', async () => {\n     const Parent = () => <Child />;\n     const Child = () => null;\n \n@@ -237,7 +337,60 @@ describe('ProfilerContext', () => {\n     );\n   });\n \n-  it('should maintain root selection between profiling sessions so long as there is data for that root', async () => {\n+  // @reactVersion >= 18\n+  it('should not select the root ID matching the Components tab selection if it has no profiling data (createRoot)', async () => {\n+    const Parent = () => <Child />;\n+    const Child = () => null;\n+\n+    const containerOne = document.createElement('div');\n+    const containerTwo = document.createElement('div');\n+\n+    const rootOne = ReactDOMClient.createRoot(containerOne);\n+    const rootTwo = ReactDOMClient.createRoot(containerTwo);\n+\n+    utils.act(() => rootOne.render(<Parent />));\n+    utils.act(() => rootTwo.render(<Parent />));\n+    expect(store).toMatchInlineSnapshot(`\n+      [root]\n+        \u25be <Parent>\n+            <Child>\n+      [root]\n+        \u25be <Parent>\n+            <Child>\n+    `);\n+\n+    // Profile and record updates to only the first root.\n+    await utils.actAsync(() => store.profilerStore.startProfiling());\n+    await utils.actAsync(() => rootOne.render(<Parent />));\n+    await utils.actAsync(() => store.profilerStore.stopProfiling());\n+\n+    let context: Context = ((null: any): Context);\n+    function ContextReader() {\n+      context = React.useContext(ProfilerContext);\n+      return null;\n+    }\n+\n+    // Select an element within the second root.\n+    await utils.actAsync(() =>\n+      TestRenderer.create(\n+        <Contexts\n+          defaultSelectedElementID={store.getElementIDAtIndex(3)}\n+          defaultSelectedElementIndex={3}>\n+          <ContextReader />\n+        </Contexts>,\n+      ),\n+    );\n+\n+    // Verify the default profiling root is the first one.\n+    expect(context).not.toBeNull();\n+    expect(context.rootID).toBe(\n+      store.getRootIDForElement(((store.getElementIDAtIndex(0): any): number)),\n+    );\n+  });\n+\n+  // @reactVersion <= 18.2\n+  // @reactVersion >= 18.0\n+  it('should maintain root selection between profiling sessions so long as there is data for that root (legacy render)', async () => {\n     const Parent = () => <Child />;\n     const Child = () => null;\n \n@@ -300,17 +453,83 @@ describe('ProfilerContext', () => {\n     expect(context.rootID).toBe(store.getRootIDForElement(id));\n   });\n \n+  // @reactVersion >= 18.0\n+  it('should maintain root selection between profiling sessions so long as there is data for that root (createRoot)', async () => {\n+    const Parent = () => <Child />;\n+    const Child = () => null;\n+\n+    const containerA = document.createElement('div');\n+    const containerB = document.createElement('div');\n+\n+    const rootA = ReactDOMClient.createRoot(containerA);\n+    const rootB = ReactDOMClient.createRoot(containerB);\n+\n+    utils.act(() => rootA.render(<Parent />));\n+    utils.act(() => rootB.render(<Parent />));\n+\n+    expect(store).toMatchInlineSnapshot(`\n+      [root]\n+        \u25be <Parent>\n+            <Child>\n+      [root]\n+        \u25be <Parent>\n+            <Child>\n+    `);\n+\n+    // Profile and record updates.\n+    await utils.actAsync(() => store.profilerStore.startProfiling());\n+    await utils.actAsync(() => rootA.render(<Parent />));\n+    await utils.actAsync(() => rootB.render(<Parent />));\n+    await utils.actAsync(() => store.profilerStore.stopProfiling());\n+\n+    let context: Context = ((null: any): Context);\n+    let dispatch: DispatcherContext = ((null: any): DispatcherContext);\n+    let selectedElementID = null;\n+    function ContextReader() {\n+      context = React.useContext(ProfilerContext);\n+      dispatch = React.useContext(TreeDispatcherContext);\n+      selectedElementID = React.useContext(TreeStateContext).selectedElementID;\n+      return null;\n+    }\n+\n+    const id = ((store.getElementIDAtIndex(3): any): number);\n+\n+    // Select an element within the second root.\n+    await utils.actAsync(() =>\n+      TestRenderer.create(\n+        <Contexts defaultSelectedElementID={id} defaultSelectedElementIndex={3}>\n+          <ContextReader />\n+        </Contexts>,\n+      ),\n+    );\n+\n+    expect(selectedElementID).toBe(id);\n+\n+    // Profile and record more updates to both roots\n+    await utils.actAsync(() => store.profilerStore.startProfiling());\n+    await utils.actAsync(() => rootA.render(<Parent />));\n+    await utils.actAsync(() => rootB.render(<Parent />));\n+    await utils.actAsync(() => store.profilerStore.stopProfiling());\n+\n+    const otherID = ((store.getElementIDAtIndex(0): any): number);\n+\n+    // Change the selected element within a the Components tab.\n+    utils.act(() => dispatch({type: 'SELECT_ELEMENT_AT_INDEX', payload: 0}));\n+\n+    // Verify that the initial Profiler root selection is maintained.\n+    expect(selectedElementID).toBe(otherID);\n+    expect(context).not.toBeNull();\n+    expect(context.rootID).toBe(store.getRootIDForElement(id));\n+  });\n+\n   it('should sync selected element in the Components tab too, provided the element is a match', async () => {\n     const GrandParent = ({includeChild}) => (\n       <Parent includeChild={includeChild} />\n     );\n     const Parent = ({includeChild}) => (includeChild ? <Child /> : null);\n     const Child = () => null;\n \n-    const container = document.createElement('div');\n-    utils.act(() =>\n-      legacyRender(<GrandParent includeChild={true} />, container),\n-    );\n+    utils.act(() => render(<GrandParent includeChild={true} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <GrandParent>\n@@ -323,12 +542,8 @@ describe('ProfilerContext', () => {\n \n     // Profile and record updates.\n     await utils.actAsync(() => store.profilerStore.startProfiling());\n-    await utils.actAsync(() =>\n-      legacyRender(<GrandParent includeChild={true} />, container),\n-    );\n-    await utils.actAsync(() =>\n-      legacyRender(<GrandParent includeChild={false} />, container),\n-    );\n+    await utils.actAsync(() => render(<GrandParent includeChild={true} />));\n+    await utils.actAsync(() => render(<GrandParent includeChild={false} />));\n     await utils.actAsync(() => store.profilerStore.stopProfiling());\n \n     expect(store).toMatchInlineSnapshot(`"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilerStore-test.js",
                "git_diff": "@@ -9,27 +9,30 @@\n \n import type Store from 'react-devtools-shared/src/devtools/store';\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('ProfilerStore', () => {\n   let React;\n-  let ReactDOM;\n-  let legacyRender;\n   let store: Store;\n   let utils;\n \n   beforeEach(() => {\n+    global.IS_REACT_ACT_ENVIRONMENT = true;\n+\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    legacyRender = utils.legacyRender;\n-\n     store = global.store;\n     store.collapseNodesByDefault = false;\n     store.recordChangeDescriptions = true;\n \n     React = require('react');\n-    ReactDOM = require('react-dom');\n   });\n \n+  const {render, unmount} = getVersionedRenderImplementation();\n+  const {render: renderOther, unmount: unmountOther} =\n+    getVersionedRenderImplementation();\n+\n   // @reactVersion >= 16.9\n   it('should not remove profiling data when roots are unmounted', async () => {\n     const Parent = ({count}) =>\n@@ -38,32 +41,27 @@ describe('ProfilerStore', () => {\n         .map((_, index) => <Child key={index} duration={index} />);\n     const Child = () => <div>Hi!</div>;\n \n-    const containerA = document.createElement('div');\n-    const containerB = document.createElement('div');\n-\n     utils.act(() => {\n-      legacyRender(<Parent key=\"A\" count={3} />, containerA);\n-      legacyRender(<Parent key=\"B\" count={2} />, containerB);\n+      render(<Parent key=\"A\" count={3} />);\n+      renderOther(<Parent key=\"B\" count={2} />);\n     });\n \n     utils.act(() => store.profilerStore.startProfiling());\n \n     utils.act(() => {\n-      legacyRender(<Parent key=\"A\" count={4} />, containerA);\n-      legacyRender(<Parent key=\"B\" count={1} />, containerB);\n+      render(<Parent key=\"A\" count={4} />);\n+      renderOther(<Parent key=\"B\" count={1} />);\n     });\n \n     utils.act(() => store.profilerStore.stopProfiling());\n \n     const rootA = store.roots[0];\n     const rootB = store.roots[1];\n \n-    utils.act(() => ReactDOM.unmountComponentAtNode(containerB));\n-\n+    utils.act(() => unmountOther());\n     expect(store.profilerStore.getDataForRoot(rootA)).not.toBeNull();\n \n-    utils.act(() => ReactDOM.unmountComponentAtNode(containerA));\n-\n+    utils.act(() => unmount());\n     expect(store.profilerStore.getDataForRoot(rootB)).not.toBeNull();\n   });\n \n@@ -95,14 +93,9 @@ describe('ProfilerStore', () => {\n       return <input ref={inputRef} value={name} onChange={handleChange} />;\n     };\n \n-    const container = document.createElement('div');\n-\n-    // This element has to be in the <body> for the event system to work.\n-    document.body.appendChild(container);\n-\n     // It's important that this test uses legacy sync mode.\n     // The root API does not trigger this particular failing case.\n-    legacyRender(<ControlledInput />, container);\n+    utils.act(() => render(<ControlledInput />));\n \n     utils.act(() => store.profilerStore.startProfiling());\n \n@@ -148,14 +141,9 @@ describe('ProfilerStore', () => {\n       return <input ref={inputRef} onBlur={handleBlur} />;\n     };\n \n-    const container = document.createElement('div');\n-\n-    // This element has to be in the <body> for the event system to work.\n-    document.body.appendChild(container);\n-\n     // It's important that this test uses legacy sync mode.\n     // The root API does not trigger this particular failing case.\n-    legacyRender(<Example />, container);\n+    utils.act(() => render(<Example />));\n \n     expect(commitCount).toBe(1);\n     commitCount = 0;\n@@ -164,10 +152,10 @@ describe('ProfilerStore', () => {\n \n     // Focus and blur.\n     const target = inputRef.current;\n-    target.focus();\n-    target.blur();\n-    target.focus();\n-    target.blur();\n+    utils.act(() => target.focus());\n+    utils.act(() => target.blur());\n+    utils.act(() => target.focus());\n+    utils.act(() => target.blur());\n     expect(commitCount).toBe(1);\n \n     utils.act(() => store.profilerStore.stopProfiling());\n@@ -204,14 +192,9 @@ describe('ProfilerStore', () => {\n       return state.hasOwnProperty;\n     };\n \n-    const container = document.createElement('div');\n-\n-    // This element has to be in the <body> for the event system to work.\n-    document.body.appendChild(container);\n-\n     // It's important that this test uses legacy sync mode.\n     // The root API does not trigger this particular failing case.\n-    legacyRender(<ControlledInput />, container);\n+    utils.act(() => render(<ControlledInput />));\n \n     utils.act(() => store.profilerStore.startProfiling());\n     utils.act(() =>\n@@ -243,9 +226,7 @@ describe('ProfilerStore', () => {\n       );\n     };\n \n-    const container = document.createElement('div');\n-\n-    utils.act(() => legacyRender(<App />, container));\n+    utils.act(() => render(<App />));\n     utils.act(() => store.profilerStore.startProfiling());\n   });\n });"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilingCache-test.js",
                "git_diff": "@@ -10,6 +10,8 @@\n import type {FrontendBridge} from 'react-devtools-shared/src/bridge';\n import type Store from 'react-devtools-shared/src/devtools/store';\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('ProfilingCache', () => {\n   let PropTypes;\n   let React;\n@@ -39,8 +41,11 @@ describe('ProfilingCache', () => {\n     Scheduler = require('scheduler');\n   });\n \n+  const {render, getContainer} = getVersionedRenderImplementation();\n+\n   // @reactVersion >= 16.9\n-  it('should collect data for each root (including ones added or mounted after profiling started)', () => {\n+  // @reactVersion <= 18.2\n+  it('should collect data for each root (including ones added or mounted after profiling started) (legacy render)', () => {\n     const Parent = ({count}) => {\n       Scheduler.unstable_advanceTime(10);\n       const children = new Array(count)\n@@ -151,6 +156,116 @@ describe('ProfilingCache', () => {\n     });\n   });\n \n+  // @reactVersion >= 18\n+  it('should collect data for each root (including ones added or mounted after profiling started) (createRoot)', () => {\n+    const Parent = ({count}) => {\n+      Scheduler.unstable_advanceTime(10);\n+      const children = new Array(count)\n+        .fill(true)\n+        .map((_, index) => <Child key={index} duration={index} />);\n+      return (\n+        <React.Fragment>\n+          {children}\n+          <MemoizedChild duration={1} />\n+        </React.Fragment>\n+      );\n+    };\n+    const Child = ({duration}) => {\n+      Scheduler.unstable_advanceTime(duration);\n+      return null;\n+    };\n+    const MemoizedChild = React.memo(Child);\n+\n+    const RootA = ({children}) => children;\n+    const RootB = ({children}) => children;\n+    const RootC = ({children}) => children;\n+\n+    const containerA = document.createElement('div');\n+    const containerB = document.createElement('div');\n+    const containerC = document.createElement('div');\n+\n+    const rootA = ReactDOMClient.createRoot(containerA);\n+    const rootB = ReactDOMClient.createRoot(containerB);\n+    const rootC = ReactDOMClient.createRoot(containerC);\n+\n+    utils.act(() =>\n+      rootA.render(\n+        <RootA>\n+          <Parent count={2} />\n+        </RootA>,\n+      ),\n+    );\n+    utils.act(() =>\n+      rootB.render(\n+        <RootB>\n+          <Parent count={1} />\n+        </RootB>,\n+      ),\n+    );\n+    utils.act(() => store.profilerStore.startProfiling());\n+    utils.act(() =>\n+      rootA.render(\n+        <RootA>\n+          <Parent count={3} />\n+        </RootA>,\n+      ),\n+    );\n+    utils.act(() =>\n+      rootC.render(\n+        <RootC>\n+          <Parent count={1} />\n+        </RootC>,\n+      ),\n+    );\n+    utils.act(() =>\n+      rootA.render(\n+        <RootA>\n+          <Parent count={1} />\n+        </RootA>,\n+      ),\n+    );\n+    utils.act(() => rootB.unmount());\n+    utils.act(() =>\n+      rootA.render(\n+        <RootA>\n+          <Parent count={0} />\n+        </RootA>,\n+      ),\n+    );\n+    utils.act(() => store.profilerStore.stopProfiling());\n+    utils.act(() => rootA.unmount());\n+\n+    const rootIDs = Array.from(\n+      store.profilerStore.profilingData.dataForRoots.values(),\n+    ).map(({rootID}) => rootID);\n+    expect(rootIDs).toHaveLength(3);\n+\n+    const originalProfilingDataForRoot = [];\n+\n+    let data = store.profilerStore.getDataForRoot(rootIDs[0]);\n+    expect(data.displayName).toMatchInlineSnapshot(`\"RootA\"`);\n+    expect(data.commitData).toHaveLength(3);\n+    originalProfilingDataForRoot.push(data);\n+\n+    data = store.profilerStore.getDataForRoot(rootIDs[1]);\n+    expect(data.displayName).toMatchInlineSnapshot(`\"RootC\"`);\n+    expect(data.commitData).toHaveLength(1);\n+    originalProfilingDataForRoot.push(data);\n+\n+    data = store.profilerStore.getDataForRoot(rootIDs[2]);\n+    expect(data.displayName).toMatchInlineSnapshot(`\"RootB\"`);\n+    expect(data.commitData).toHaveLength(1);\n+    originalProfilingDataForRoot.push(data);\n+\n+    utils.exportImportHelper(bridge, store);\n+\n+    rootIDs.forEach((rootID, index) => {\n+      const current = store.profilerStore.getDataForRoot(rootID);\n+      const prev = originalProfilingDataForRoot[index];\n+      expect(current).toEqual(prev);\n+    });\n+  });\n+\n   // @reactVersion >= 16.9\n   it('should collect data for each commit', () => {\n     const Parent = ({count}) => {\n@@ -171,13 +286,11 @@ describe('ProfilingCache', () => {\n     };\n     const MemoizedChild = React.memo(Child);\n \n-    const container = document.createElement('div');\n-\n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => legacyRender(<Parent count={2} />, container));\n-    utils.act(() => legacyRender(<Parent count={3} />, container));\n-    utils.act(() => legacyRender(<Parent count={1} />, container));\n-    utils.act(() => legacyRender(<Parent count={0} />, container));\n+    utils.act(() => render(<Parent count={2} />));\n+    utils.act(() => render(<Parent count={3} />));\n+    utils.act(() => render(<Parent count={1} />));\n+    utils.act(() => render(<Parent count={0} />));\n     utils.act(() => store.profilerStore.stopProfiling());\n \n     const rootID = store.roots[0];\n@@ -244,19 +357,13 @@ describe('ProfilingCache', () => {\n       }\n     }\n \n-    const container = document.createElement('div');\n-\n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => legacyRender(<LegacyContextProvider />, container));\n+    utils.act(() => render(<LegacyContextProvider />));\n     expect(instance).not.toBeNull();\n     utils.act(() => (instance: any).setState({count: 1}));\n-    utils.act(() =>\n-      legacyRender(<LegacyContextProvider foo={123} />, container),\n-    );\n-    utils.act(() =>\n-      legacyRender(<LegacyContextProvider bar=\"abc\" />, container),\n-    );\n-    utils.act(() => legacyRender(<LegacyContextProvider />, container));\n+    utils.act(() => render(<LegacyContextProvider foo={123} />));\n+    utils.act(() => render(<LegacyContextProvider bar=\"abc\" />));\n+    utils.act(() => render(<LegacyContextProvider />));\n     utils.act(() => store.profilerStore.stopProfiling());\n \n     const rootID = store.roots[0];\n@@ -574,25 +681,21 @@ describe('ProfilingCache', () => {\n       return null;\n     };\n \n-    const container = document.createElement('div');\n-\n     utils.act(() => store.profilerStore.startProfiling());\n     utils.act(() =>\n-      legacyRender(\n+      render(\n         <Context.Provider value={true}>\n           <Component count={1} />\n         </Context.Provider>,\n-        container,\n       ),\n     );\n \n     // Second render has no changed hooks, only changed props.\n     utils.act(() =>\n-      legacyRender(\n+      render(\n         <Context.Provider value={true}>\n           <Component count={2} />\n         </Context.Provider>,\n-        container,\n       ),\n     );\n \n@@ -604,11 +707,10 @@ describe('ProfilingCache', () => {\n \n     // Fifth render has a changed context value, but no changed hook.\n     utils.act(() =>\n-      legacyRender(\n+      render(\n         <Context.Provider value={false}>\n           <Component count={2} />\n         </Context.Provider>,\n-        container,\n       ),\n     );\n \n@@ -754,9 +856,7 @@ describe('ProfilingCache', () => {\n     };\n \n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() =>\n-      legacyRender(<Grandparent />, document.createElement('div')),\n-    );\n+    utils.act(() => render(<Grandparent />));\n     utils.act(() => store.profilerStore.stopProfiling());\n \n     expect(store).toMatchInlineSnapshot(`\n@@ -822,9 +922,7 @@ describe('ProfilingCache', () => {\n     };\n \n     utils.act(() => store.profilerStore.startProfiling());\n-    await utils.actAsync(() =>\n-      legacyRender(<Parent />, document.createElement('div')),\n-    );\n+    await utils.actAsync(() => render(<Parent />));\n     utils.act(() => store.profilerStore.stopProfiling());\n \n     const rootID = store.roots[0];\n@@ -880,12 +978,10 @@ describe('ProfilingCache', () => {\n     };\n     const MemoizedChild = React.memo(Child);\n \n-    const container = document.createElement('div');\n-\n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => legacyRender(<Parent count={1} />, container));\n-    utils.act(() => legacyRender(<Parent count={2} />, container));\n-    utils.act(() => legacyRender(<Parent count={3} />, container));\n+    utils.act(() => render(<Parent count={1} />));\n+    utils.act(() => render(<Parent count={2} />));\n+    utils.act(() => render(<Parent count={3} />));\n     utils.act(() => store.profilerStore.stopProfiling());\n \n     const rootID = store.roots[0];\n@@ -940,11 +1036,11 @@ describe('ProfilingCache', () => {\n \n   // @reactVersion >= 18.0.0\n   // @reactVersion <= 18.2.0\n-  it('should handle unexpectedly shallow suspense trees for react v[18.0.0 - 18.2.0]', () => {\n-    const container = document.createElement('div');\n-\n+  it('should handle unexpectedly shallow suspense trees for react v[18.0.0 - 18.2.0] (legacy render)', () => {\n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => legacyRender(<React.Suspense />, container));\n+    utils.act(() =>\n+      legacyRender(<React.Suspense />, document.createElement('div')),\n+    );\n     utils.act(() => store.profilerStore.stopProfiling());\n \n     const rootID = store.roots[0];\n@@ -981,13 +1077,51 @@ describe('ProfilingCache', () => {\n     `);\n   });\n \n-  // This test is not gated.\n-  // For this test we use the current version of react, built from source.\n-  it('should handle unexpectedly shallow suspense trees', () => {\n-    const container = document.createElement('div');\n+  // @reactVersion >= 18.0.0\n+  // @reactVersion <= 18.2.0\n+  it('should handle unexpectedly shallow suspense trees for react v[18.0.0 - 18.2.0] (createRoot)', () => {\n+    utils.act(() => store.profilerStore.startProfiling());\n+    utils.act(() => render(<React.Suspense />));\n+    utils.act(() => store.profilerStore.stopProfiling());\n+\n+    const rootID = store.roots[0];\n+    const commitData = store.profilerStore.getDataForRoot(rootID).commitData;\n+    expect(commitData).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"changeDescriptions\": Map {},\n+          \"duration\": 0,\n+          \"effectDuration\": null,\n+          \"fiberActualDurations\": Map {\n+            1 => 0,\n+            2 => 0,\n+          },\n+          \"fiberSelfDurations\": Map {\n+            1 => 0,\n+            2 => 0,\n+          },\n+          \"passiveEffectDuration\": null,\n+          \"priorityLevel\": \"Normal\",\n+          \"timestamp\": 0,\n+          \"updaters\": [\n+            {\n+              \"compiledWithForget\": false,\n+              \"displayName\": \"createRoot()\",\n+              \"hocDisplayNames\": null,\n+              \"id\": 1,\n+              \"key\": null,\n+              \"type\": 11,\n+            },\n+          ],\n+        },\n+      ]\n+    `);\n+  });\n \n+  // @reactVersion > 18.2.0\n+  it('should handle unexpectedly shallow suspense trees', () => {\n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => legacyRender(<React.Suspense />, container));\n+    utils.act(() => render(<React.Suspense />));\n     utils.act(() => store.profilerStore.stopProfiling());\n \n     const rootID = store.roots[0];\n@@ -1012,7 +1146,7 @@ describe('ProfilingCache', () => {\n           \"updaters\": [\n             {\n               \"compiledWithForget\": false,\n-              \"displayName\": \"render()\",\n+              \"displayName\": \"createRoot()\",\n               \"hocDisplayNames\": null,\n               \"id\": 1,\n               \"key\": null,\n@@ -1103,15 +1237,16 @@ describe('ProfilingCache', () => {\n       );\n     }\n \n-    const {Simulate} = require('react-dom/test-utils');\n-\n-    const container = document.createElement('div');\n-    utils.act(() => legacyRender(<App />, container));\n-    expect(container.textContent).toBe('Home');\n+    utils.act(() => render(<App />));\n+    expect(getContainer().textContent).toBe('Home');\n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => Simulate.click(linkRef.current));\n+    utils.act(() =>\n+      linkRef.current.dispatchEvent(\n+        new MouseEvent('click', {bubbles: true, cancelable: true}),\n+      ),\n+    );\n     utils.act(() => store.profilerStore.stopProfiling());\n-    expect(container.textContent).toBe('About');\n+    expect(getContainer().textContent).toBe('About');\n   });\n \n   // @reactVersion >= 18.0"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilingCharts-test.js",
                "git_diff": "@@ -9,19 +9,18 @@\n \n import type Store from 'react-devtools-shared/src/devtools/store';\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('profiling charts', () => {\n   let React;\n   let Scheduler;\n-  let legacyRender;\n   let store: Store;\n   let utils;\n \n   beforeEach(() => {\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    legacyRender = utils.legacyRender;\n-\n     store = global.store;\n     store.collapseNodesByDefault = false;\n     store.recordChangeDescriptions = true;\n@@ -30,6 +29,8 @@ describe('profiling charts', () => {\n     Scheduler = require('scheduler');\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   function getFlamegraphChartData(rootID, commitIndex) {\n     const commitTree = store.profilerStore.profilingCache.getCommitTree({\n       commitIndex,\n@@ -78,11 +79,9 @@ describe('profiling charts', () => {\n         return null;\n       });\n \n-      const container = document.createElement('div');\n-\n       utils.act(() => store.profilerStore.startProfiling());\n \n-      utils.act(() => legacyRender(<Parent />, container));\n+      utils.act(() => render(<Parent />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Parent>\n@@ -91,7 +90,7 @@ describe('profiling charts', () => {\n               <Child key=\"third\"> [Memo]\n       `);\n \n-      utils.act(() => legacyRender(<Parent />, container));\n+      utils.act(() => render(<Parent />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Parent>\n@@ -228,11 +227,9 @@ describe('profiling charts', () => {\n         return null;\n       });\n \n-      const container = document.createElement('div');\n-\n       utils.act(() => store.profilerStore.startProfiling());\n \n-      utils.act(() => legacyRender(<Parent />, container));\n+      utils.act(() => render(<Parent />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Parent>\n@@ -241,7 +238,7 @@ describe('profiling charts', () => {\n               <Child key=\"third\"> [Memo]\n       `);\n \n-      utils.act(() => legacyRender(<Parent />, container));\n+      utils.act(() => render(<Parent />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Parent>"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilingCommitTreeBuilder-test.js",
                "git_diff": "@@ -9,31 +9,35 @@\n \n import type Store from 'react-devtools-shared/src/devtools/store';\n \n+import {\n+  getLegacyRenderImplementation,\n+  getModernRenderImplementation,\n+} from './utils';\n+\n describe('commit tree', () => {\n   let React;\n-  let ReactDOMClient;\n   let Scheduler;\n-  let legacyRender;\n   let store: Store;\n   let utils;\n \n   beforeEach(() => {\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    legacyRender = utils.legacyRender;\n-\n     store = global.store;\n     store.collapseNodesByDefault = false;\n     store.recordChangeDescriptions = true;\n \n     React = require('react');\n-    ReactDOMClient = require('react-dom/client');\n     Scheduler = require('scheduler');\n   });\n \n+  const {render: legacyRender} = getLegacyRenderImplementation();\n+  const {render: modernRender} = getModernRenderImplementation();\n+\n   // @reactVersion >= 16.9\n-  it('should be able to rebuild the store tree for each commit', () => {\n+  // @reactVersion <= 18.2\n+  it('should be able to rebuild the store tree for each commit (legacy render)', () => {\n     const Parent = ({count}) => {\n       Scheduler.unstable_advanceTime(10);\n       return new Array(count)\n@@ -45,31 +49,88 @@ describe('commit tree', () => {\n       return null;\n     });\n \n-    const container = document.createElement('div');\n+    utils.act(() => store.profilerStore.startProfiling());\n+    utils.act(() => legacyRender(<Parent count={1} />));\n+    expect(store).toMatchInlineSnapshot(`\n+      [root]\n+        \u25be <Parent>\n+            <Child key=\"0\"> [Memo]\n+    `);\n+    utils.act(() => legacyRender(<Parent count={3} />));\n+    expect(store).toMatchInlineSnapshot(`\n+      [root]\n+        \u25be <Parent>\n+            <Child key=\"0\"> [Memo]\n+            <Child key=\"1\"> [Memo]\n+            <Child key=\"2\"> [Memo]\n+    `);\n+    utils.act(() => legacyRender(<Parent count={2} />));\n+    expect(store).toMatchInlineSnapshot(`\n+      [root]\n+        \u25be <Parent>\n+            <Child key=\"0\"> [Memo]\n+            <Child key=\"1\"> [Memo]\n+    `);\n+    utils.act(() => legacyRender(<Parent count={0} />));\n+    expect(store).toMatchInlineSnapshot(`\n+      [root]\n+          <Parent>\n+    `);\n+    utils.act(() => store.profilerStore.stopProfiling());\n+\n+    const rootID = store.roots[0];\n+    const commitTrees = [];\n+    for (let commitIndex = 0; commitIndex < 4; commitIndex++) {\n+      commitTrees.push(\n+        store.profilerStore.profilingCache.getCommitTree({\n+          commitIndex,\n+          rootID,\n+        }),\n+      );\n+    }\n+\n+    expect(commitTrees[0].nodes.size).toBe(3); // <Root> + <Parent> + <Child>\n+    expect(commitTrees[1].nodes.size).toBe(5); // <Root> + <Parent> + <Child> x 3\n+    expect(commitTrees[2].nodes.size).toBe(4); // <Root> + <Parent> + <Child> x 2\n+    expect(commitTrees[3].nodes.size).toBe(2); // <Root> + <Parent>\n+  });\n+\n+  // @reactVersion >= 18\n+  it('should be able to rebuild the store tree for each commit (createRoot)', () => {\n+    const Parent = ({count}) => {\n+      Scheduler.unstable_advanceTime(10);\n+      return new Array(count)\n+        .fill(true)\n+        .map((_, index) => <Child key={index} />);\n+    };\n+    const Child = React.memo(function Child() {\n+      Scheduler.unstable_advanceTime(2);\n+      return null;\n+    });\n \n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => legacyRender(<Parent count={1} />, container));\n+    utils.act(() => modernRender(<Parent count={1} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Parent>\n             <Child key=\"0\"> [Memo]\n     `);\n-    utils.act(() => legacyRender(<Parent count={3} />, container));\n+    utils.act(() => modernRender(<Parent count={3} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Parent>\n             <Child key=\"0\"> [Memo]\n             <Child key=\"1\"> [Memo]\n             <Child key=\"2\"> [Memo]\n     `);\n-    utils.act(() => legacyRender(<Parent count={2} />, container));\n+    utils.act(() => modernRender(<Parent count={2} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Parent>\n             <Child key=\"0\"> [Memo]\n             <Child key=\"1\"> [Memo]\n     `);\n-    utils.act(() => legacyRender(<Parent count={0} />, container));\n+    utils.act(() => modernRender(<Parent count={0} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n           <Parent>\n@@ -118,25 +179,24 @@ describe('commit tree', () => {\n     });\n \n     // @reactVersion >= 16.9\n+    // @reactVersion <= 18.2\n     it('should support Lazy components (legacy render)', async () => {\n-      const container = document.createElement('div');\n-\n       utils.act(() => store.profilerStore.startProfiling());\n-      utils.act(() => legacyRender(<App renderChildren={true} />, container));\n+      utils.act(() => legacyRender(<App renderChildren={true} />));\n       await Promise.resolve();\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <App>\n               <Suspense>\n       `);\n-      utils.act(() => legacyRender(<App renderChildren={true} />, container));\n+      utils.act(() => legacyRender(<App renderChildren={true} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <App>\n             \u25be <Suspense>\n                 <LazyInnerComponent>\n       `);\n-      utils.act(() => legacyRender(<App renderChildren={false} />, container));\n+      utils.act(() => legacyRender(<App renderChildren={false} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n             <App>\n@@ -161,25 +221,22 @@ describe('commit tree', () => {\n \n     // @reactVersion >= 18.0\n     it('should support Lazy components (createRoot)', async () => {\n-      const container = document.createElement('div');\n-      const root = ReactDOMClient.createRoot(container);\n-\n       utils.act(() => store.profilerStore.startProfiling());\n-      utils.act(() => root.render(<App renderChildren={true} />));\n+      utils.act(() => modernRender(<App renderChildren={true} />));\n       await Promise.resolve();\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <App>\n               <Suspense>\n       `);\n-      utils.act(() => root.render(<App renderChildren={true} />));\n+      utils.act(() => modernRender(<App renderChildren={true} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <App>\n             \u25be <Suspense>\n                 <LazyInnerComponent>\n       `);\n-      utils.act(() => root.render(<App renderChildren={false} />));\n+      utils.act(() => modernRender(<App renderChildren={false} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n             <App>\n@@ -203,17 +260,16 @@ describe('commit tree', () => {\n     });\n \n     // @reactVersion >= 16.9\n+    // @reactVersion <= 18.2\n     it('should support Lazy components that are unmounted before resolving (legacy render)', async () => {\n-      const container = document.createElement('div');\n-\n       utils.act(() => store.profilerStore.startProfiling());\n-      utils.act(() => legacyRender(<App renderChildren={true} />, container));\n+      utils.act(() => legacyRender(<App renderChildren={true} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <App>\n               <Suspense>\n       `);\n-      utils.act(() => legacyRender(<App renderChildren={false} />, container));\n+      utils.act(() => legacyRender(<App renderChildren={false} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n             <App>\n@@ -237,17 +293,14 @@ describe('commit tree', () => {\n \n     // @reactVersion >= 18.0\n     it('should support Lazy components that are unmounted before resolving (createRoot)', async () => {\n-      const container = document.createElement('div');\n-      const root = ReactDOMClient.createRoot(container);\n-\n       utils.act(() => store.profilerStore.startProfiling());\n-      utils.act(() => root.render(<App renderChildren={true} />));\n+      utils.act(() => modernRender(<App renderChildren={true} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <App>\n               <Suspense>\n       `);\n-      utils.act(() => root.render(<App renderChildren={false} />));\n+      utils.act(() => modernRender(<App renderChildren={false} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n             <App>"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilingHostRoot-test.js",
                "git_diff": "@@ -7,11 +7,14 @@\n  * @flow\n  */\n \n+import {\n+  getLegacyRenderImplementation,\n+  getModernRenderImplementation,\n+} from './utils';\n+\n describe('profiling HostRoot', () => {\n   let React;\n-  let ReactDOMClient;\n   let Scheduler;\n-  let legacyRender;\n   let store;\n   let utils;\n   let getEffectDurations;\n@@ -22,14 +25,11 @@ describe('profiling HostRoot', () => {\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    legacyRender = utils.legacyRender;\n-\n     getEffectDurations = require('../backend/utils').getEffectDurations;\n \n     store = global.store;\n \n     React = require('react');\n-    ReactDOMClient = require('react-dom/client');\n     Scheduler = require('scheduler');\n \n     effectDurations = [];\n@@ -49,7 +49,11 @@ describe('profiling HostRoot', () => {\n     };\n   });\n \n-  // @reactVersion >=18.0\n+  const {render: legacyRender} = getLegacyRenderImplementation();\n+  const {render: modernRender} = getModernRenderImplementation();\n+\n+  // @reactVersion >= 18.0\n+  // @reactVersion <= 18.2\n   it('should expose passive and layout effect durations for render()', () => {\n     function App() {\n       React.useEffect(() => {\n@@ -63,8 +67,7 @@ describe('profiling HostRoot', () => {\n \n     utils.act(() => store.profilerStore.startProfiling());\n     utils.act(() => {\n-      const container = document.createElement('div');\n-      legacyRender(<App />, container);\n+      legacyRender(<App />);\n     });\n     utils.act(() => store.profilerStore.stopProfiling());\n \n@@ -92,9 +95,7 @@ describe('profiling HostRoot', () => {\n \n     utils.act(() => store.profilerStore.startProfiling());\n     utils.act(() => {\n-      const container = document.createElement('div');\n-      const root = ReactDOMClient.createRoot(container);\n-      root.render(<App />);\n+      modernRender(<App />);\n     });\n     utils.act(() => store.profilerStore.stopProfiling());\n \n@@ -126,12 +127,9 @@ describe('profiling HostRoot', () => {\n       return null;\n     }\n \n-    const container = document.createElement('div');\n-    const root = ReactDOMClient.createRoot(container);\n-\n     utils.act(() => store.profilerStore.startProfiling());\n-    utils.act(() => root.render(<App />));\n-    utils.act(() => root.render(<App shouldCascade={true} />));\n+    utils.act(() => modernRender(<App />));\n+    utils.act(() => modernRender(<App shouldCascade={true} />));\n     utils.act(() => store.profilerStore.stopProfiling());\n \n     expect(effectDurations).toHaveLength(3);"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/setupTests.js",
                "git_diff": "@@ -13,6 +13,7 @@ import type {\n   BackendBridge,\n   FrontendBridge,\n } from 'react-devtools-shared/src/bridge';\n+const {getTestFlags} = require('../../../../scripts/jest/TestFlags');\n \n // Argument is serialized when passed from jest-cli script through to setupTests.\n const compactConsole = process.env.compactConsole === 'true';\n@@ -32,6 +33,76 @@ if (compactConsole) {\n   global.console = new CustomConsole(process.stdout, process.stderr, formatter);\n }\n \n+const expectTestToFail = async (callback, error) => {\n+  if (callback.length > 0) {\n+    throw Error(\n+      'Gated test helpers do not support the `done` callback. Return a ' +\n+        'promise instead.',\n+    );\n+  }\n+  try {\n+    const maybePromise = callback();\n+    if (\n+      maybePromise !== undefined &&\n+      maybePromise !== null &&\n+      typeof maybePromise.then === 'function'\n+    ) {\n+      await maybePromise;\n+    }\n+  } catch (testError) {\n+    return;\n+  }\n+  throw error;\n+};\n+\n+const gatedErrorMessage = 'Gated test was expected to fail, but it passed.';\n+global._test_gate = (gateFn, testName, callback) => {\n+  let shouldPass;\n+  try {\n+    const flags = getTestFlags();\n+    shouldPass = gateFn(flags);\n+  } catch (e) {\n+    test(testName, () => {\n+      throw e;\n+    });\n+    return;\n+  }\n+  if (shouldPass) {\n+    test(testName, callback);\n+  } else {\n+    const error = new Error(gatedErrorMessage);\n+    Error.captureStackTrace(error, global._test_gate);\n+    test(`[GATED, SHOULD FAIL] ${testName}`, () =>\n+      expectTestToFail(callback, error));\n+  }\n+};\n+global._test_gate_focus = (gateFn, testName, callback) => {\n+  let shouldPass;\n+  try {\n+    const flags = getTestFlags();\n+    shouldPass = gateFn(flags);\n+  } catch (e) {\n+    test.only(testName, () => {\n+      throw e;\n+    });\n+    return;\n+  }\n+  if (shouldPass) {\n+    test.only(testName, callback);\n+  } else {\n+    const error = new Error(gatedErrorMessage);\n+    Error.captureStackTrace(error, global._test_gate_focus);\n+    test.only(`[GATED, SHOULD FAIL] ${testName}`, () =>\n+      expectTestToFail(callback, error));\n+  }\n+};\n+\n+// Dynamic version of @gate pragma\n+global.gate = fn => {\n+  const flags = getTestFlags();\n+  return fn(flags);\n+};\n+\n beforeEach(() => {\n   global.mockClipboardCopy = jest.fn();\n "
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/store-test.js",
                "git_diff": "@@ -7,6 +7,8 @@\n  * @flow\n  */\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('Store', () => {\n   let React;\n   let ReactDOM;\n@@ -21,6 +23,8 @@ describe('Store', () => {\n   let withErrorsOrWarningsIgnored;\n \n   beforeEach(() => {\n+    global.IS_REACT_ACT_ENVIRONMENT = true;\n+\n     agent = global.agent;\n     bridge = global.bridge;\n     store = global.store;\n@@ -37,13 +41,13 @@ describe('Store', () => {\n     withErrorsOrWarningsIgnored = utils.withErrorsOrWarningsIgnored;\n   });\n \n+  const {render, unmount, createContainer} = getVersionedRenderImplementation();\n+\n   // @reactVersion >= 18.0\n   it('should not allow a root node to be collapsed', () => {\n     const Component = () => <div>Hi</div>;\n \n-    act(() =>\n-      legacyRender(<Component count={4} />, document.createElement('div')),\n-    );\n+    act(() => render(<Component count={4} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n           <Component>\n@@ -62,15 +66,13 @@ describe('Store', () => {\n   it('should properly handle a root with no visible nodes', () => {\n     const Root = ({children}) => children;\n \n-    const container = document.createElement('div');\n-\n-    act(() => legacyRender(<Root>{null}</Root>, container));\n+    act(() => render(<Root>{null}</Root>));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n           <Root>\n     `);\n \n-    act(() => legacyRender(<div />, container));\n+    act(() => render(<div />));\n     expect(store).toMatchInlineSnapshot(`[root]`);\n   });\n \n@@ -93,17 +95,14 @@ describe('Store', () => {\n     };\n     const Child = () => null;\n \n-    const container = document.createElement('div');\n-\n     act(() =>\n-      legacyRender(\n+      render(\n         <>\n           <React.Suspense fallback=\"Loading...\">\n             <Owner />\n           </React.Suspense>\n           <Parent />\n         </>,\n-        container,\n       ),\n     );\n     expect(store).toMatchInlineSnapshot(`\n@@ -119,9 +118,7 @@ describe('Store', () => {\n     const Component = () => null;\n     Component.displayName = '\ud83d\udfe9\ud83d\udc9c\ud83d\udd35';\n \n-    const container = document.createElement('div');\n-\n-    act(() => legacyRender(<Component />, container));\n+    act(() => render(<Component />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n           <\ud83d\udfe9\ud83d\udc9c\ud83d\udd35>\n@@ -196,9 +193,7 @@ describe('Store', () => {\n         new Array(count).fill(true).map((_, index) => <Child key={index} />);\n       const Child = () => <div>Hi!</div>;\n \n-      const container = document.createElement('div');\n-\n-      act(() => legacyRender(<Grandparent count={4} />, container));\n+      act(() => render(<Grandparent count={4} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Grandparent>\n@@ -214,7 +209,7 @@ describe('Store', () => {\n                 <Child key=\"3\">\n       `);\n \n-      act(() => legacyRender(<Grandparent count={2} />, container));\n+      act(() => render(<Grandparent count={2} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Grandparent>\n@@ -226,12 +221,14 @@ describe('Store', () => {\n                 <Child key=\"1\">\n       `);\n \n-      act(() => ReactDOM.unmountComponentAtNode(container));\n+      act(() => unmount());\n       expect(store).toMatchInlineSnapshot(``);\n     });\n \n     // @reactVersion >= 18.0\n-    it('should support mount and update operations for multiple roots', () => {\n+    // @reactVersion < 19\n+    // @gate !disableLegacyMode\n+    it('should support mount and update operations for multiple roots (legacy render)', () => {\n       const Parent = ({count}) =>\n         new Array(count).fill(true).map((_, index) => <Child key={index} />);\n       const Child = () => <div>Hi!</div>;\n@@ -285,6 +282,64 @@ describe('Store', () => {\n       expect(store).toMatchInlineSnapshot(``);\n     });\n \n+    // @reactVersion >= 18.0\n+    it('should support mount and update operations for multiple roots (createRoot)', () => {\n+      const Parent = ({count}) =>\n+        new Array(count).fill(true).map((_, index) => <Child key={index} />);\n+      const Child = () => <div>Hi!</div>;\n+\n+      const containerA = document.createElement('div');\n+      const containerB = document.createElement('div');\n+\n+      const rootA = ReactDOMClient.createRoot(containerA);\n+      const rootB = ReactDOMClient.createRoot(containerB);\n+\n+      act(() => {\n+        rootA.render(<Parent key=\"A\" count={3} />);\n+        rootB.render(<Parent key=\"B\" count={2} />);\n+      });\n+      expect(store).toMatchInlineSnapshot(`\n+        [root]\n+          \u25be <Parent key=\"A\">\n+              <Child key=\"0\">\n+              <Child key=\"1\">\n+              <Child key=\"2\">\n+        [root]\n+          \u25be <Parent key=\"B\">\n+              <Child key=\"0\">\n+              <Child key=\"1\">\n+      `);\n+\n+      act(() => {\n+        rootA.render(<Parent key=\"A\" count={4} />);\n+        rootB.render(<Parent key=\"B\" count={1} />);\n+      });\n+      expect(store).toMatchInlineSnapshot(`\n+        [root]\n+          \u25be <Parent key=\"A\">\n+              <Child key=\"0\">\n+              <Child key=\"1\">\n+              <Child key=\"2\">\n+              <Child key=\"3\">\n+        [root]\n+          \u25be <Parent key=\"B\">\n+              <Child key=\"0\">\n+      `);\n+\n+      act(() => rootB.unmount());\n+      expect(store).toMatchInlineSnapshot(`\n+        [root]\n+          \u25be <Parent key=\"A\">\n+              <Child key=\"0\">\n+              <Child key=\"1\">\n+              <Child key=\"2\">\n+              <Child key=\"3\">\n+      `);\n+\n+      act(() => rootA.unmount());\n+      expect(store).toMatchInlineSnapshot(``);\n+    });\n+\n     // @reactVersion >= 18.0\n     it('should filter DOM nodes from the store tree', () => {\n       const Grandparent = () => (\n@@ -302,9 +357,7 @@ describe('Store', () => {\n       );\n       const Child = () => <div>Hi!</div>;\n \n-      act(() =>\n-        legacyRender(<Grandparent count={4} />, document.createElement('div')),\n-      );\n+      act(() => render(<Grandparent count={4} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Grandparent>\n@@ -337,8 +390,7 @@ describe('Store', () => {\n         </React.Fragment>\n       );\n \n-      const container = document.createElement('div');\n-      act(() => legacyRender(<Wrapper shouldSuspense={true} />, container));\n+      act(() => render(<Wrapper shouldSuspense={true} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Wrapper>\n@@ -348,7 +400,7 @@ describe('Store', () => {\n       `);\n \n       act(() => {\n-        legacyRender(<Wrapper shouldSuspense={false} />, container);\n+        render(<Wrapper shouldSuspense={false} />);\n       });\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n@@ -399,15 +451,13 @@ describe('Store', () => {\n         </React.Fragment>\n       );\n \n-      const container = document.createElement('div');\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={false}\n             suspendFirst={false}\n             suspendSecond={false}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -425,13 +475,12 @@ describe('Store', () => {\n                 <Component key=\"Unrelated at End\">\n       `);\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={false}\n             suspendFirst={true}\n             suspendSecond={false}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -449,13 +498,12 @@ describe('Store', () => {\n                 <Component key=\"Unrelated at End\">\n       `);\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={false}\n             suspendFirst={false}\n             suspendSecond={true}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -473,13 +521,12 @@ describe('Store', () => {\n                 <Component key=\"Unrelated at End\">\n       `);\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={false}\n             suspendFirst={true}\n             suspendSecond={false}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -497,13 +544,12 @@ describe('Store', () => {\n                 <Component key=\"Unrelated at End\">\n       `);\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={true}\n             suspendFirst={true}\n             suspendSecond={false}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -514,13 +560,12 @@ describe('Store', () => {\n                 <Loading key=\"Parent Fallback\">\n       `);\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={false}\n             suspendFirst={true}\n             suspendSecond={true}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -538,13 +583,12 @@ describe('Store', () => {\n                 <Component key=\"Unrelated at End\">\n       `);\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={false}\n             suspendFirst={false}\n             suspendSecond={false}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -599,13 +643,12 @@ describe('Store', () => {\n                 <Loading key=\"Parent Fallback\">\n       `);\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={false}\n             suspendFirst={true}\n             suspendSecond={true}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -658,13 +701,12 @@ describe('Store', () => {\n                 <Component key=\"Unrelated at End\">\n       `);\n       act(() =>\n-        legacyRender(\n+        render(\n           <Wrapper\n             suspendParent={false}\n             suspendFirst={false}\n             suspendSecond={false}\n           />,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -743,9 +785,7 @@ describe('Store', () => {\n         new Array(count).fill(true).map((_, index) => <Child key={index} />);\n       const Child = () => <div>Hi!</div>;\n \n-      act(() =>\n-        legacyRender(<Grandparent count={2} />, document.createElement('div')),\n-      );\n+      act(() => render(<Grandparent count={2} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Grandparent>\n@@ -816,9 +856,7 @@ describe('Store', () => {\n       const foo = <Foo key=\"foo\" />;\n       const bar = <Bar key=\"bar\" />;\n \n-      const container = document.createElement('div');\n-\n-      act(() => legacyRender(<Root>{[foo, bar]}</Root>, container));\n+      act(() => render(<Root>{[foo, bar]}</Root>));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Root>\n@@ -829,7 +867,7 @@ describe('Store', () => {\n                 <Component key=\"1\">\n       `);\n \n-      act(() => legacyRender(<Root>{[bar, foo]}</Root>, container));\n+      act(() => render(<Root>{[bar, foo]}</Root>));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25be <Root>\n@@ -870,15 +908,12 @@ describe('Store', () => {\n         new Array(count).fill(true).map((_, index) => <Child key={index} />);\n       const Child = () => <div>Hi!</div>;\n \n-      const container = document.createElement('div');\n-\n       act(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Parent count={1} />\n             <Parent count={3} />\n           </React.Fragment>,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -888,12 +923,11 @@ describe('Store', () => {\n       `);\n \n       act(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Parent count={2} />\n             <Parent count={1} />\n           </React.Fragment>,\n-          container,\n         ),\n       );\n       expect(store).toMatchInlineSnapshot(`\n@@ -902,12 +936,14 @@ describe('Store', () => {\n           \u25b8 <Parent>\n       `);\n \n-      act(() => ReactDOM.unmountComponentAtNode(container));\n+      act(() => unmount());\n       expect(store).toMatchInlineSnapshot(``);\n     });\n \n     // @reactVersion >= 18.0\n-    it('should support mount and update operations for multiple roots', () => {\n+    // @reactVersion < 19\n+    // @gate !disableLegacyMode\n+    it('should support mount and update operations for multiple roots (legacy render)', () => {\n       const Parent = ({count}) =>\n         new Array(count).fill(true).map((_, index) => <Child key={index} />);\n       const Child = () => <div>Hi!</div>;\n@@ -947,6 +983,50 @@ describe('Store', () => {\n       expect(store).toMatchInlineSnapshot(``);\n     });\n \n+    // @reactVersion >= 18.0\n+    it('should support mount and update operations for multiple roots (createRoot)', () => {\n+      const Parent = ({count}) =>\n+        new Array(count).fill(true).map((_, index) => <Child key={index} />);\n+      const Child = () => <div>Hi!</div>;\n+\n+      const containerA = document.createElement('div');\n+      const containerB = document.createElement('div');\n+\n+      const rootA = ReactDOMClient.createRoot(containerA);\n+      const rootB = ReactDOMClient.createRoot(containerB);\n+\n+      act(() => {\n+        rootA.render(<Parent key=\"A\" count={3} />);\n+        rootB.render(<Parent key=\"B\" count={2} />);\n+      });\n+      expect(store).toMatchInlineSnapshot(`\n+        [root]\n+          \u25b8 <Parent key=\"A\">\n+        [root]\n+          \u25b8 <Parent key=\"B\">\n+      `);\n+\n+      act(() => {\n+        rootA.render(<Parent key=\"A\" count={4} />);\n+        rootB.render(<Parent key=\"B\" count={1} />);\n+      });\n+      expect(store).toMatchInlineSnapshot(`\n+        [root]\n+          \u25b8 <Parent key=\"A\">\n+        [root]\n+          \u25b8 <Parent key=\"B\">\n+      `);\n+\n+      act(() => rootB.unmount());\n+      expect(store).toMatchInlineSnapshot(`\n+        [root]\n+          \u25b8 <Parent key=\"A\">\n+      `);\n+\n+      act(() => rootA.unmount());\n+      expect(store).toMatchInlineSnapshot(``);\n+    });\n+\n     // @reactVersion >= 18.0\n     it('should filter DOM nodes from the store tree', () => {\n       const Grandparent = () => (\n@@ -964,9 +1044,7 @@ describe('Store', () => {\n       );\n       const Child = () => <div>Hi!</div>;\n \n-      act(() =>\n-        legacyRender(<Grandparent count={4} />, document.createElement('div')),\n-      );\n+      act(() => render(<Grandparent count={4} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <Grandparent>\n@@ -1012,8 +1090,7 @@ describe('Store', () => {\n         </React.Fragment>\n       );\n \n-      const container = document.createElement('div');\n-      act(() => legacyRender(<Wrapper shouldSuspense={true} />, container));\n+      act(() => render(<Wrapper shouldSuspense={true} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <Wrapper>\n@@ -1031,7 +1108,7 @@ describe('Store', () => {\n       `);\n \n       act(() => {\n-        legacyRender(<Wrapper shouldSuspense={false} />, container);\n+        render(<Wrapper shouldSuspense={false} />);\n       });\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n@@ -1054,9 +1131,7 @@ describe('Store', () => {\n         new Array(count).fill(true).map((_, index) => <Child key={index} />);\n       const Child = () => <div>Hi!</div>;\n \n-      act(() =>\n-        legacyRender(<Grandparent count={2} />, document.createElement('div')),\n-      );\n+      act(() => render(<Grandparent count={2} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <Grandparent>\n@@ -1136,12 +1211,7 @@ describe('Store', () => {\n \n       const ref = React.createRef();\n \n-      act(() =>\n-        legacyRender(\n-          <Wrapper forwardedRef={ref} />,\n-          document.createElement('div'),\n-        ),\n-      );\n+      act(() => render(<Wrapper forwardedRef={ref} />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <Wrapper>\n@@ -1207,15 +1277,13 @@ describe('Store', () => {\n       const foo = <Foo key=\"foo\" />;\n       const bar = <Bar key=\"bar\" />;\n \n-      const container = document.createElement('div');\n-\n-      act(() => legacyRender(<Root>{[foo, bar]}</Root>, container));\n+      act(() => render(<Root>{[foo, bar]}</Root>));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <Root>\n       `);\n \n-      act(() => legacyRender(<Root>{[bar, foo]}</Root>, container));\n+      act(() => render(<Root>{[bar, foo]}</Root>));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <Root>\n@@ -1264,7 +1332,7 @@ describe('Store', () => {\n       const Parent = () => <Child />;\n       const Child = () => null;\n \n-      act(() => legacyRender(<SuspenseTree />, document.createElement('div')));\n+      act(() => render(<SuspenseTree />));\n       expect(store).toMatchInlineSnapshot(`\n         [root]\n           \u25b8 <SuspenseTree>\n@@ -1328,7 +1396,7 @@ describe('Store', () => {\n       const Parent = () => <Child />;\n       const Child = () => null;\n \n-      act(() => legacyRender(<Grandparent />, document.createElement('div')));\n+      act(() => render(<Grandparent />));\n \n       for (let i = 0; i < store.numElements; i++) {\n         expect(store.getIndexOfElementID(store.getElementIDAtIndex(i))).toBe(i);\n@@ -1342,8 +1410,8 @@ describe('Store', () => {\n       const Child = () => null;\n \n       act(() => {\n-        legacyRender(<Grandparent />, document.createElement('div'));\n-        legacyRender(<Grandparent />, document.createElement('div'));\n+        render(<Grandparent />);\n+        render(<Grandparent />);\n       });\n \n       for (let i = 0; i < store.numElements; i++) {\n@@ -1358,12 +1426,11 @@ describe('Store', () => {\n       const Child = () => null;\n \n       act(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Grandparent />\n             <Grandparent />\n           </React.Fragment>,\n-          document.createElement('div'),\n         ),\n       );\n \n@@ -1379,19 +1446,20 @@ describe('Store', () => {\n       const Child = () => null;\n \n       act(() => {\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Grandparent />\n             <Grandparent />\n           </React.Fragment>,\n-          document.createElement('div'),\n         );\n-        legacyRender(\n+\n+        createContainer();\n+\n+        render(\n           <React.Fragment>\n             <Grandparent />\n             <Grandparent />\n           </React.Fragment>,\n-          document.createElement('div'),\n         );\n       });\n \n@@ -1402,7 +1470,9 @@ describe('Store', () => {\n   });\n \n   // @reactVersion >= 18.0\n-  it('detects and updates profiling support based on the attached roots', () => {\n+  // @reactVersion < 19\n+  // @gate !disableLegacyMode\n+  it('detects and updates profiling support based on the attached roots (legacy render)', () => {\n     const Component = () => null;\n \n     const containerA = document.createElement('div');\n@@ -1421,6 +1491,29 @@ describe('Store', () => {\n     expect(store.rootSupportsBasicProfiling).toBe(false);\n   });\n \n+  // @reactVersion >= 18\n+  it('detects and updates profiling support based on the attached roots (createRoot)', () => {\n+    const Component = () => null;\n+\n+    const containerA = document.createElement('div');\n+    const containerB = document.createElement('div');\n+\n+    const rootA = ReactDOMClient.createRoot(containerA);\n+    const rootB = ReactDOMClient.createRoot(containerB);\n+\n+    expect(store.rootSupportsBasicProfiling).toBe(false);\n+\n+    act(() => rootA.render(<Component />));\n+    expect(store.rootSupportsBasicProfiling).toBe(true);\n+\n+    act(() => rootB.render(<Component />));\n+    act(() => rootA.unmount());\n+    expect(store.rootSupportsBasicProfiling).toBe(true);\n+\n+    act(() => rootB.unmount());\n+    expect(store.rootSupportsBasicProfiling).toBe(false);\n+  });\n+\n   // @reactVersion >= 18.0\n   it('should properly serialize non-string key values', () => {\n     const Child = () => null;\n@@ -1429,7 +1522,7 @@ describe('Store', () => {\n     // This is pretty hacky.\n     const fauxElement = Object.assign({}, <Child />, {key: 123});\n \n-    act(() => legacyRender([fauxElement], document.createElement('div')));\n+    act(() => render([fauxElement]));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n           <Child key=\"123\">\n@@ -1488,15 +1581,13 @@ describe('Store', () => {\n       </React.Fragment>\n     );\n \n-    const container = document.createElement('div');\n-\n     // Render once to start fetching the lazy component\n-    act(() => legacyRender(<App />, container));\n+    act(() => render(<App />));\n \n     await Promise.resolve();\n \n     // Render again after it resolves\n-    act(() => legacyRender(<App />, container));\n+    act(() => render(<App />));\n \n     expect(store).toMatchInlineSnapshot(`\n       [root]\n@@ -1543,6 +1634,8 @@ describe('Store', () => {\n     });\n \n     // @reactVersion >= 18.0\n+    // @reactVersion < 19\n+    // @gate !disableLegacyMode\n     it('should support Lazy components (legacy render)', async () => {\n       const container = document.createElement('div');\n \n@@ -1612,6 +1705,8 @@ describe('Store', () => {\n     });\n \n     // @reactVersion >= 18.0\n+    // @reactVersion < 19\n+    // @gate !disableLegacyMode\n     it('should support Lazy components that are unmounted before they finish loading (legacy render)', async () => {\n       const container = document.createElement('div');\n \n@@ -1634,6 +1729,7 @@ describe('Store', () => {\n     });\n \n     // @reactVersion >= 18.0\n+    // @reactVersion < 19\n     it('should support Lazy components that are unmounted before they finish loading in (createRoot)', async () => {\n       const container = document.createElement('div');\n       const root = ReactDOMClient.createRoot(container);\n@@ -1665,10 +1761,9 @@ describe('Store', () => {\n         console.warn('test-only: render warning');\n         return null;\n       }\n-      const container = document.createElement('div');\n \n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n-        act(() => legacyRender(<Example />, container));\n+        act(() => render(<Example />));\n       });\n \n       expect(store).toMatchInlineSnapshot(`\n@@ -1678,7 +1773,7 @@ describe('Store', () => {\n       `);\n \n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n-        act(() => legacyRender(<Example rerender={1} />, container));\n+        act(() => render(<Example rerender={1} />));\n       });\n \n       expect(store).toMatchInlineSnapshot(`\n@@ -1697,10 +1792,9 @@ describe('Store', () => {\n         });\n         return null;\n       }\n-      const container = document.createElement('div');\n \n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n-        act(() => legacyRender(<Example />, container));\n+        act(() => render(<Example />));\n       });\n \n       expect(store).toMatchInlineSnapshot(`\n@@ -1710,7 +1804,7 @@ describe('Store', () => {\n       `);\n \n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n-        act(() => legacyRender(<Example rerender={1} />, container));\n+        act(() => render(<Example rerender={1} />));\n       });\n \n       expect(store).toMatchInlineSnapshot(`\n@@ -1739,11 +1833,10 @@ describe('Store', () => {\n           });\n           return null;\n         }\n-        const container = document.createElement('div');\n \n         withErrorsOrWarningsIgnored(['test-only:'], () => {\n           act(() => {\n-            legacyRender(<Example />, container);\n+            render(<Example />);\n           }, false);\n         });\n         flushPendingBridgeOperations();\n@@ -1760,7 +1853,7 @@ describe('Store', () => {\n               <Example> \u2715\u26a0\n         `);\n \n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(store).toMatchInlineSnapshot(``);\n       });\n \n@@ -1778,15 +1871,12 @@ describe('Store', () => {\n           return null;\n         }\n \n-        const container = document.createElement('div');\n-\n         withErrorsOrWarningsIgnored(['test-only:'], () => {\n           act(() => {\n-            legacyRender(\n+            render(\n               <>\n                 <Example />\n               </>,\n-              container,\n             );\n           }, false);\n           flushPendingBridgeOperations();\n@@ -1797,12 +1887,11 @@ describe('Store', () => {\n \n           // Before warnings and errors have flushed, flush another commit.\n           act(() => {\n-            legacyRender(\n+            render(\n               <>\n                 <Example />\n                 <Noop />\n               </>,\n-              container,\n             );\n           }, false);\n           flushPendingBridgeOperations();\n@@ -1823,14 +1912,13 @@ describe('Store', () => {\n               <Noop>\n         `);\n \n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(store).toMatchInlineSnapshot(``);\n       });\n     });\n \n     // @reactVersion >= 18.0\n     it('from react get counted', () => {\n-      const container = document.createElement('div');\n       function Example() {\n         return [<Child />];\n       }\n@@ -1841,7 +1929,7 @@ describe('Store', () => {\n       withErrorsOrWarningsIgnored(\n         ['Warning: Each child in a list should have a unique \"key\" prop'],\n         () => {\n-          act(() => legacyRender(<Example />, container));\n+          act(() => render(<Example />));\n         },\n       );\n \n@@ -1860,15 +1948,14 @@ describe('Store', () => {\n         console.warn('test-only: render warning');\n         return null;\n       }\n-      const container = document.createElement('div');\n+\n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n         act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Example />\n               <Example />\n             </React.Fragment>,\n-            container,\n           ),\n         );\n       });\n@@ -1902,15 +1989,14 @@ describe('Store', () => {\n         console.warn('test-only: render warning');\n         return null;\n       }\n-      const container = document.createElement('div');\n+\n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n         act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Example />\n               <Example />\n             </React.Fragment>,\n-            container,\n           ),\n         );\n       });\n@@ -1948,15 +2034,14 @@ describe('Store', () => {\n         console.warn('test-only: render warning');\n         return null;\n       }\n-      const container = document.createElement('div');\n+\n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n         act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Example />\n               <Example />\n             </React.Fragment>,\n-            container,\n           ),\n         );\n       });\n@@ -2002,16 +2087,15 @@ describe('Store', () => {\n         console.warn('test-only: render warning');\n         return null;\n       }\n-      const container = document.createElement('div');\n+\n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n         act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <ComponentWithError />\n               <ComponentWithWarning />\n               <ComponentWithWarningAndError />\n             </React.Fragment>,\n-            container,\n           ),\n         );\n       });\n@@ -2025,12 +2109,11 @@ describe('Store', () => {\n \n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n         act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <ComponentWithWarning />\n               <ComponentWithWarningAndError />\n             </React.Fragment>,\n-            container,\n           ),\n         );\n       });\n@@ -2043,11 +2126,10 @@ describe('Store', () => {\n \n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n         act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <ComponentWithWarning />\n             </React.Fragment>,\n-            container,\n           ),\n         );\n       });\n@@ -2058,7 +2140,7 @@ describe('Store', () => {\n       `);\n \n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n-        act(() => legacyRender(<React.Fragment />, container));\n+        act(() => render(<React.Fragment />));\n       });\n       expect(store).toMatchInlineSnapshot(`[root]`);\n       expect(store.errorCount).toBe(0);\n@@ -2086,9 +2168,7 @@ describe('Store', () => {\n         );\n       }\n \n-      const container = document.createElement('div');\n-      const root = ReactDOMClient.createRoot(container);\n-      await actAsync(() => root.render(<App renderA={true} />));\n+      await actAsync(() => render(<App renderA={true} />));\n \n       expect(store).toMatchInlineSnapshot(`\n           [root]\n@@ -2097,7 +2177,7 @@ describe('Store', () => {\n                   <ChildA>\n         `);\n \n-      await actAsync(() => root.render(<App renderA={false} />));\n+      await actAsync(() => render(<App renderA={false} />));\n \n       expect(store).toMatchInlineSnapshot(`\n           [root]"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/storeComponentFilters-test.js",
                "git_diff": "@@ -10,23 +10,18 @@\n import type {FrontendBridge} from 'react-devtools-shared/src/bridge';\n import type Store from 'react-devtools-shared/src/devtools/store';\n \n+import {\n+  getLegacyRenderImplementation,\n+  getVersionedRenderImplementation,\n+} from './utils';\n+\n describe('Store component filters', () => {\n   let React;\n   let Types;\n   let bridge: FrontendBridge;\n-  let legacyRender;\n   let store: Store;\n   let utils;\n-\n-  const act = async (callback: Function) => {\n-    if (React.unstable_act != null) {\n-      await React.unstable_act(callback);\n-    } else {\n-      callback();\n-    }\n-\n-    jest.runAllTimers(); // Flush Bridge operations\n-  };\n+  let actAsync;\n \n   beforeEach(() => {\n     bridge = global.bridge;\n@@ -39,12 +34,14 @@ describe('Store component filters', () => {\n     Types = require('react-devtools-shared/src/frontend/types');\n     utils = require('./utils');\n \n-    legacyRender = utils.legacyRender;\n+    actAsync = utils.actAsync;\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   // @reactVersion >= 16.0\n   it('should throw if filters are updated while profiling', async () => {\n-    await act(async () => store.profilerStore.startProfiling());\n+    await actAsync(async () => store.profilerStore.startProfiling());\n     expect(() => (store.componentFilters = [])).toThrow(\n       'Cannot modify filter preferences while profiling',\n     );\n@@ -59,12 +56,11 @@ describe('Store component filters', () => {\n     }\n     const FunctionComponent = () => <div>Hi</div>;\n \n-    await act(async () =>\n-      legacyRender(\n+    await actAsync(async () =>\n+      render(\n         <ClassComponent>\n           <FunctionComponent />\n         </ClassComponent>,\n-        document.createElement('div'),\n       ),\n     );\n     expect(store).toMatchInlineSnapshot(`\n@@ -75,7 +71,7 @@ describe('Store component filters', () => {\n                 <div>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createElementTypeFilter(Types.ElementTypeHostComponent),\n@@ -87,7 +83,7 @@ describe('Store component filters', () => {\n             <FunctionComponent>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createElementTypeFilter(Types.ElementTypeClass),\n@@ -100,7 +96,7 @@ describe('Store component filters', () => {\n               <div>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createElementTypeFilter(Types.ElementTypeClass),\n@@ -113,7 +109,7 @@ describe('Store component filters', () => {\n             <div>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createElementTypeFilter(Types.ElementTypeClass, false),\n@@ -128,7 +124,7 @@ describe('Store component filters', () => {\n                 <div>\n     `);\n \n-    await act(async () => (store.componentFilters = []));\n+    await actAsync(async () => (store.componentFilters = []));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <ClassComponent>\n@@ -142,16 +138,14 @@ describe('Store component filters', () => {\n   it('should ignore invalid ElementTypeRoot filter', async () => {\n     const Component = () => <div>Hi</div>;\n \n-    await act(async () =>\n-      legacyRender(<Component />, document.createElement('div')),\n-    );\n+    await actAsync(async () => render(<Component />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Component>\n             <div>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createElementTypeFilter(Types.ElementTypeRoot),\n@@ -172,14 +166,13 @@ describe('Store component filters', () => {\n     const Bar = () => <Text label=\"bar\" />;\n     const Baz = () => <Text label=\"baz\" />;\n \n-    await act(async () =>\n-      legacyRender(\n+    await actAsync(async () =>\n+      render(\n         <React.Fragment>\n           <Foo />\n           <Bar />\n           <Baz />\n         </React.Fragment>,\n-        document.createElement('div'),\n       ),\n     );\n     expect(store).toMatchInlineSnapshot(`\n@@ -192,7 +185,7 @@ describe('Store component filters', () => {\n             <Text>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [utils.createDisplayNameFilter('Foo')]),\n     );\n@@ -205,7 +198,7 @@ describe('Store component filters', () => {\n             <Text>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [utils.createDisplayNameFilter('Ba')]),\n     );\n@@ -217,7 +210,7 @@ describe('Store component filters', () => {\n           <Text>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [utils.createDisplayNameFilter('B.z')]),\n     );\n@@ -231,20 +224,23 @@ describe('Store component filters', () => {\n     `);\n   });\n \n+  // Disabled: filtering by path was removed, source is now determined lazily, including symbolication if applicable\n   // @reactVersion >= 16.0\n-  it('should filter by path', async () => {\n-    const Component = () => <div>Hi</div>;\n+  xit('should filter by path', async () => {\n+    // This component should use props object in order to throw for component stack generation\n+    // See ReactComponentStackFrame:155 or DevToolsComponentStackFrame:147\n+    const Component = props => {\n+      return <div>{props.message}</div>;\n+    };\n \n-    await act(async () =>\n-      legacyRender(<Component />, document.createElement('div')),\n-    );\n+    await actAsync(async () => render(<Component message=\"Hi\" />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Component>\n             <div>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createLocationFilter(__filename.replace(__dirname, '')),\n@@ -253,7 +249,7 @@ describe('Store component filters', () => {\n \n     expect(store).toMatchInlineSnapshot(`[root]`);\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createLocationFilter('this:is:a:made:up:path'),\n@@ -275,7 +271,7 @@ describe('Store component filters', () => {\n     const Bar = () => <Foo />;\n     Bar.displayName = 'Bar(Foo(Component))';\n \n-    await act(async () => legacyRender(<Bar />, document.createElement('div')));\n+    await actAsync(async () => render(<Bar />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Component> [Bar][Foo]\n@@ -284,7 +280,7 @@ describe('Store component filters', () => {\n                 <div>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () => (store.componentFilters = [utils.createHOCFilter(true)]),\n     );\n     expect(store).toMatchInlineSnapshot(`\n@@ -293,7 +289,7 @@ describe('Store component filters', () => {\n             <div>\n     `);\n \n-    await act(\n+    await actAsync(\n       async () => (store.componentFilters = [utils.createHOCFilter(false)]),\n     );\n     expect(store).toMatchInlineSnapshot(`\n@@ -307,29 +303,29 @@ describe('Store component filters', () => {\n \n   // @reactVersion >= 16.0\n   it('should not send a bridge update if the set of enabled filters has not changed', async () => {\n-    await act(\n+    await actAsync(\n       async () => (store.componentFilters = [utils.createHOCFilter(true)]),\n     );\n \n     bridge.addListener('updateComponentFilters', componentFilters => {\n       throw Error('Unexpected component update');\n     });\n \n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createHOCFilter(false),\n           utils.createHOCFilter(true),\n         ]),\n     );\n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createHOCFilter(true),\n           utils.createLocationFilter('abc', false),\n         ]),\n     );\n-    await act(\n+    await actAsync(\n       async () =>\n         (store.componentFilters = [\n           utils.createHOCFilter(true),\n@@ -361,29 +357,22 @@ describe('Store component filters', () => {\n       utils.createElementTypeFilter(Types.ElementTypeSuspense),\n     ];\n \n-    const container = document.createElement('div');\n-    await act(async () =>\n-      legacyRender(<Wrapper shouldSuspend={true} />, container),\n-    );\n+    await actAsync(async () => render(<Wrapper shouldSuspend={true} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Wrapper>\n           \u25be <Loading>\n               <div>\n     `);\n \n-    await act(async () =>\n-      legacyRender(<Wrapper shouldSuspend={false} />, container),\n-    );\n+    await actAsync(async () => render(<Wrapper shouldSuspend={false} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Wrapper>\n             <Component>\n     `);\n \n-    await act(async () =>\n-      legacyRender(<Wrapper shouldSuspend={true} />, container),\n-    );\n+    await actAsync(async () => render(<Wrapper shouldSuspend={true} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Wrapper>\n@@ -393,8 +382,11 @@ describe('Store component filters', () => {\n   });\n \n   describe('inline errors and warnings', () => {\n+    const {render: legacyRender} = getLegacyRenderImplementation();\n+\n     // @reactVersion >= 17.0\n-    it('only counts for unfiltered components', async () => {\n+    // @reactVersion <= 18.2\n+    it('only counts for unfiltered components (legacy render)', async () => {\n       function ComponentWithWarning() {\n         console.warn('test-only: render warning');\n         return null;\n@@ -409,15 +401,7 @@ describe('Store component filters', () => {\n         return null;\n       }\n \n-      // HACK This require() is needed (somewhere in the test) for this case to pass.\n-      // Without it, the legacyRender() call below causes this test to fail\n-      // because it requires \"react-dom\" for the first time,\n-      // which causes the console error() and warn() methods to be overridden again,\n-      // effectively disconnecting the DevTools override in 'react-devtools-shared/src/backend/console'.\n-      require('react-dom');\n-\n-      const container = document.createElement('div');\n-      await act(\n+      await actAsync(\n         async () =>\n           (store.componentFilters = [\n             utils.createDisplayNameFilter('Warning'),\n@@ -431,15 +415,104 @@ describe('Store component filters', () => {\n             <ComponentWithWarning />\n             <ComponentWithWarningAndError />\n           </React.Fragment>,\n-          container,\n         );\n       });\n \n       expect(store).toMatchInlineSnapshot(``);\n       expect(store.errorCount).toBe(0);\n       expect(store.warningCount).toBe(0);\n \n-      await act(async () => (store.componentFilters = []));\n+      await actAsync(async () => (store.componentFilters = []));\n+      expect(store).toMatchInlineSnapshot(`\n+        \u2715 2, \u26a0 2\n+        [root]\n+            <ComponentWithError> \u2715\n+            <ComponentWithWarning> \u26a0\n+            <ComponentWithWarningAndError> \u2715\u26a0\n+      `);\n+\n+      await actAsync(\n+        async () =>\n+          (store.componentFilters = [utils.createDisplayNameFilter('Warning')]),\n+      );\n+      expect(store).toMatchInlineSnapshot(`\n+        \u2715 1, \u26a0 0\n+        [root]\n+            <ComponentWithError> \u2715\n+      `);\n+\n+      await actAsync(\n+        async () =>\n+          (store.componentFilters = [utils.createDisplayNameFilter('Error')]),\n+      );\n+      expect(store).toMatchInlineSnapshot(`\n+        \u2715 0, \u26a0 1\n+        [root]\n+            <ComponentWithWarning> \u26a0\n+      `);\n+\n+      await actAsync(\n+        async () =>\n+          (store.componentFilters = [\n+            utils.createDisplayNameFilter('Warning'),\n+            utils.createDisplayNameFilter('Error'),\n+          ]),\n+      );\n+      expect(store).toMatchInlineSnapshot(`[root]`);\n+      expect(store.errorCount).toBe(0);\n+      expect(store.warningCount).toBe(0);\n+\n+      await actAsync(async () => (store.componentFilters = []));\n+      expect(store).toMatchInlineSnapshot(`\n+        \u2715 2, \u26a0 2\n+        [root]\n+            <ComponentWithError> \u2715\n+            <ComponentWithWarning> \u26a0\n+            <ComponentWithWarningAndError> \u2715\u26a0\n+      `);\n+    });\n+\n+    // @reactVersion >= 18\n+    it('only counts for unfiltered components (createRoot)', async () => {\n+      function ComponentWithWarning() {\n+        console.warn('test-only: render warning');\n+        return null;\n+      }\n+      function ComponentWithError() {\n+        console.error('test-only: render error');\n+        return null;\n+      }\n+      function ComponentWithWarningAndError() {\n+        console.error('test-only: render error');\n+        console.warn('test-only: render warning');\n+        return null;\n+      }\n+\n+      await actAsync(\n+        async () =>\n+          (store.componentFilters = [\n+            utils.createDisplayNameFilter('Warning'),\n+            utils.createDisplayNameFilter('Error'),\n+          ]),\n+      );\n+\n+      utils.withErrorsOrWarningsIgnored(['test-only:'], () => {\n+        utils.act(() => {\n+          render(\n+            <React.Fragment>\n+              <ComponentWithError />\n+              <ComponentWithWarning />\n+              <ComponentWithWarningAndError />\n+            </React.Fragment>,\n+          );\n+        }, false);\n+      });\n+\n+      expect(store).toMatchInlineSnapshot(``);\n+      expect(store.errorCount).toBe(0);\n+      expect(store.warningCount).toBe(0);\n+\n+      await actAsync(async () => (store.componentFilters = []));\n       expect(store).toMatchInlineSnapshot(`\n         \u2715 2, \u26a0 2\n         [root]\n@@ -448,7 +521,7 @@ describe('Store component filters', () => {\n             <ComponentWithWarningAndError> \u2715\u26a0\n       `);\n \n-      await act(\n+      await actAsync(\n         async () =>\n           (store.componentFilters = [utils.createDisplayNameFilter('Warning')]),\n       );\n@@ -458,7 +531,7 @@ describe('Store component filters', () => {\n             <ComponentWithError> \u2715\n       `);\n \n-      await act(\n+      await actAsync(\n         async () =>\n           (store.componentFilters = [utils.createDisplayNameFilter('Error')]),\n       );\n@@ -468,7 +541,7 @@ describe('Store component filters', () => {\n             <ComponentWithWarning> \u26a0\n       `);\n \n-      await act(\n+      await actAsync(\n         async () =>\n           (store.componentFilters = [\n             utils.createDisplayNameFilter('Warning'),\n@@ -479,7 +552,7 @@ describe('Store component filters', () => {\n       expect(store.errorCount).toBe(0);\n       expect(store.warningCount).toBe(0);\n \n-      await act(async () => (store.componentFilters = []));\n+      await actAsync(async () => (store.componentFilters = []));\n       expect(store).toMatchInlineSnapshot(`\n         \u2715 2, \u26a0 2\n         [root]"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/storeOwners-test.js",
                "git_diff": "@@ -8,11 +8,11 @@\n  */\n \n const {printOwnersList} = require('../devtools/utils');\n+const {getVersionedRenderImplementation} = require('./utils');\n \n describe('Store owners list', () => {\n   let React;\n   let act;\n-  let legacyRender;\n   let store;\n \n   beforeEach(() => {\n@@ -23,9 +23,10 @@ describe('Store owners list', () => {\n \n     const utils = require('./utils');\n     act = utils.act;\n-    legacyRender = utils.legacyRender;\n   });\n \n+  const {render} = getVersionedRenderImplementation();\n+\n   function getFormattedOwnersList(elementID) {\n     const ownersList = store.getOwnersListForElement(elementID);\n     return printOwnersList(ownersList);\n@@ -43,7 +44,7 @@ describe('Store owners list', () => {\n     const Leaf = () => <div>Leaf</div>;\n     const Intermediate = ({children}) => <Wrapper>{children}</Wrapper>;\n \n-    act(() => legacyRender(<Root />, document.createElement('div')));\n+    act(() => render(<Root />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Root>\n@@ -80,7 +81,7 @@ describe('Store owners list', () => {\n       <Wrapper key=\"wrapper\">{children}</Wrapper>,\n     ];\n \n-    act(() => legacyRender(<Root />, document.createElement('div')));\n+    act(() => render(<Root />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Root>\n@@ -122,14 +123,7 @@ describe('Store owners list', () => {\n     const Leaf = () => <div>Leaf</div>;\n     const Intermediate = ({children}) => <Wrapper>{children}</Wrapper>;\n \n-    const container = document.createElement('div');\n-\n-    act(() =>\n-      legacyRender(\n-        <Root includeDirect={false} includeIndirect={true} />,\n-        container,\n-      ),\n-    );\n+    act(() => render(<Root includeDirect={false} includeIndirect={true} />));\n \n     const rootID = store.getElementIDAtIndex(0);\n     expect(store).toMatchInlineSnapshot(`\n@@ -145,12 +139,7 @@ describe('Store owners list', () => {\n               <Leaf>\"\n     `);\n \n-    act(() =>\n-      legacyRender(\n-        <Root includeDirect={true} includeIndirect={true} />,\n-        container,\n-      ),\n-    );\n+    act(() => render(<Root includeDirect={true} includeIndirect={true} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Root>\n@@ -166,12 +155,7 @@ describe('Store owners list', () => {\n               <Leaf>\"\n     `);\n \n-    act(() =>\n-      legacyRender(\n-        <Root includeDirect={true} includeIndirect={false} />,\n-        container,\n-      ),\n-    );\n+    act(() => render(<Root includeDirect={true} includeIndirect={false} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Root>\n@@ -182,12 +166,7 @@ describe('Store owners list', () => {\n             <Leaf>\"\n     `);\n \n-    act(() =>\n-      legacyRender(\n-        <Root includeDirect={false} includeIndirect={false} />,\n-        container,\n-      ),\n-    );\n+    act(() => render(<Root includeDirect={false} includeIndirect={false} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n           <Root>\n@@ -204,8 +183,7 @@ describe('Store owners list', () => {\n         : [<Leaf key=\"C\" />, <Leaf key=\"B\" />, <Leaf key=\"A\" />];\n     const Leaf = () => <div>Leaf</div>;\n \n-    const container = document.createElement('div');\n-    act(() => legacyRender(<Root ascending={true} />, container));\n+    act(() => render(<Root ascending={true} />));\n \n     const rootID = store.getElementIDAtIndex(0);\n     expect(store).toMatchInlineSnapshot(`\n@@ -222,7 +200,7 @@ describe('Store owners list', () => {\n             <Leaf key=\"C\">\"\n     `);\n \n-    act(() => legacyRender(<Root ascending={false} />, container));\n+    act(() => render(<Root ascending={false} />));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Root>"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/storeStressSync-test.js",
                "git_diff": "@@ -7,33 +7,36 @@\n  * @flow\n  */\n \n+import {getLegacyRenderImplementation} from './utils';\n+\n describe('StoreStress (Legacy Mode)', () => {\n   let React;\n-  let ReactDOM;\n   let act;\n   let bridge;\n   let store;\n   let print;\n-  let legacyRender;\n \n   beforeEach(() => {\n     bridge = global.bridge;\n     store = global.store;\n     store.collapseNodesByDefault = false;\n \n     React = require('react');\n-    ReactDOM = require('react-dom');\n \n     const utils = require('./utils');\n     act = utils.act;\n-    legacyRender = utils.legacyRender;\n \n     print = require('./__serializers__/storeSerializer').print;\n   });\n \n+  const {render, unmount, createContainer, getContainer} =\n+    getLegacyRenderImplementation();\n+\n   // This is a stress test for the tree mount/update/unmount traversal.\n   // It renders different trees that should produce the same output.\n   // @reactVersion >= 16.9\n+  // @reactVersion < 19\n+  // @gate !disableLegacyMode\n   it('should handle a stress test with different tree operations (Legacy Mode)', () => {\n     let setShowX;\n     const A = () => 'a';\n@@ -60,8 +63,7 @@ describe('StoreStress (Legacy Mode)', () => {\n     }\n \n     // 1. Render a normal version of [a, b, c, d, e].\n-    let container = document.createElement('div');\n-    act(() => legacyRender(<Parent>{[a, b, c, d, e]}</Parent>, container));\n+    act(() => render(<Parent>{[a, b, c, d, e]}</Parent>));\n     expect(store).toMatchInlineSnapshot(`\n       [root]\n         \u25be <Parent>\n@@ -71,7 +73,7 @@ describe('StoreStress (Legacy Mode)', () => {\n             <D key=\"d\">\n             <E key=\"e\">\n     `);\n-    expect(container.textContent).toMatch('abcde');\n+    expect(getContainer().textContent).toMatch('abcde');\n     const snapshotForABCDE = print(store);\n \n     // 2. Render a version where <C /> renders an <X /> child instead of 'c'.\n@@ -89,18 +91,18 @@ describe('StoreStress (Legacy Mode)', () => {\n             <D key=\"d\">\n             <E key=\"e\">\n     `);\n-    expect(container.textContent).toMatch('abxde');\n+    expect(getContainer().textContent).toMatch('abxde');\n     const snapshotForABXDE = print(store);\n \n     // 3. Verify flipping it back produces the original result.\n     act(() => {\n       setShowX(false);\n     });\n-    expect(container.textContent).toMatch('abcde');\n+    expect(getContainer().textContent).toMatch('abcde');\n     expect(print(store)).toBe(snapshotForABCDE);\n \n     // 4. Clean up.\n-    act(() => ReactDOM.unmountComponentAtNode(container));\n+    act(() => unmount());\n     expect(print(store)).toBe('');\n \n     // Now comes the interesting part.\n@@ -138,61 +140,62 @@ describe('StoreStress (Legacy Mode)', () => {\n     // 5. Test fresh mount for each case.\n     for (let i = 0; i < cases.length; i++) {\n       // Ensure fresh mount.\n-      container = document.createElement('div');\n+      createContainer();\n \n       // Verify mounting 'abcde'.\n-      act(() => legacyRender(<Parent>{cases[i]}</Parent>, container));\n-      expect(container.textContent).toMatch('abcde');\n+      act(() => render(<Parent>{cases[i]}</Parent>));\n+      expect(getContainer().textContent).toMatch('abcde');\n       expect(print(store)).toEqual(snapshotForABCDE);\n \n       // Verify switching to 'abxde'.\n       act(() => {\n         setShowX(true);\n       });\n-      expect(container.textContent).toMatch('abxde');\n+      expect(getContainer().textContent).toMatch('abxde');\n       expect(print(store)).toBe(snapshotForABXDE);\n \n       // Verify switching back to 'abcde'.\n       act(() => {\n         setShowX(false);\n       });\n-      expect(container.textContent).toMatch('abcde');\n+      expect(getContainer().textContent).toMatch('abcde');\n       expect(print(store)).toBe(snapshotForABCDE);\n \n       // Clean up.\n-      act(() => ReactDOM.unmountComponentAtNode(container));\n+      act(() => unmount());\n       expect(print(store)).toBe('');\n     }\n \n     // 6. Verify *updates* by reusing the container between iterations.\n     // There'll be no unmounting until the very end.\n-    container = document.createElement('div');\n+    createContainer();\n     for (let i = 0; i < cases.length; i++) {\n       // Verify mounting 'abcde'.\n-      act(() => legacyRender(<Parent>{cases[i]}</Parent>, container));\n-      expect(container.textContent).toMatch('abcde');\n+      act(() => render(<Parent>{cases[i]}</Parent>));\n+      expect(getContainer().textContent).toMatch('abcde');\n       expect(print(store)).toEqual(snapshotForABCDE);\n \n       // Verify switching to 'abxde'.\n       act(() => {\n         setShowX(true);\n       });\n-      expect(container.textContent).toMatch('abxde');\n+      expect(getContainer().textContent).toMatch('abxde');\n       expect(print(store)).toBe(snapshotForABXDE);\n \n       // Verify switching back to 'abcde'.\n       act(() => {\n         setShowX(false);\n       });\n-      expect(container.textContent).toMatch('abcde');\n+      expect(getContainer().textContent).toMatch('abcde');\n       expect(print(store)).toBe(snapshotForABCDE);\n       // Don't unmount. Reuse the container between iterations.\n     }\n-    act(() => ReactDOM.unmountComponentAtNode(container));\n+    act(() => unmount());\n     expect(print(store)).toBe('');\n   });\n \n   // @reactVersion >= 16.9\n+  // @reactVersion <= 18.2\n   it('should handle stress test with reordering (Legacy Mode)', () => {\n     const A = () => 'a';\n     const B = () => 'b';\n@@ -320,69 +323,70 @@ describe('StoreStress (Legacy Mode)', () => {\n \n     // 1. Capture the expected render result.\n     const snapshots = [];\n-    let container = document.createElement('div');\n     for (let i = 0; i < steps.length; i++) {\n-      act(() => legacyRender(<Root>{steps[i]}</Root>, container));\n+      createContainer();\n+\n+      act(() => render(<Root>{steps[i]}</Root>));\n       // We snapshot each step once so it doesn't regress.\n       expect(store).toMatchInlineSnapshot(stepsSnapshot[i]);\n       snapshots.push(print(store));\n-      act(() => ReactDOM.unmountComponentAtNode(container));\n+      act(() => unmount());\n       expect(print(store)).toBe('');\n     }\n \n     // 2. Verify that we can update from every step to every other step and back.\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n-        container = document.createElement('div');\n-        act(() => legacyRender(<Root>{steps[i]}</Root>, container));\n+        createContainer();\n+\n+        act(() => render(<Root>{steps[i]}</Root>));\n         expect(print(store)).toMatch(snapshots[i]);\n-        act(() => legacyRender(<Root>{steps[j]}</Root>, container));\n+        act(() => render(<Root>{steps[j]}</Root>));\n         expect(print(store)).toMatch(snapshots[j]);\n-        act(() => legacyRender(<Root>{steps[i]}</Root>, container));\n+        act(() => render(<Root>{steps[i]}</Root>));\n         expect(print(store)).toMatch(snapshots[i]);\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n \n     // 3. Same test as above, but this time we wrap children in a host component.\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <div>{steps[i]}</div>\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toMatch(snapshots[i]);\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <div>{steps[j]}</div>\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toMatch(snapshots[j]);\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <div>{steps[i]}</div>\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toMatch(snapshots[i]);\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n   });\n \n   // @reactVersion >= 18.0\n+  // @reactVersion <= 18.2\n   it('should handle a stress test for Suspense (Legacy Mode)', async () => {\n     const A = () => 'a';\n     const B = () => 'b';\n@@ -528,29 +532,31 @@ describe('StoreStress (Legacy Mode)', () => {\n     // 1. For each step, check Suspense can render them as initial primary content.\n     // This is the only step where we use Jest snapshots.\n     const snapshots = [];\n-    let container = document.createElement('div');\n     for (let i = 0; i < steps.length; i++) {\n+      createContainer();\n+\n       act(() =>\n-        legacyRender(\n+        render(\n           <Root>\n             <X />\n             <React.Suspense fallback={z}>{steps[i]}</React.Suspense>\n             <Y />\n           </Root>,\n-          container,\n         ),\n       );\n       // We snapshot each step once so it doesn't regress.\n       expect(store).toMatchInlineSnapshot(stepsSnapshot[i]);\n       snapshots.push(print(store));\n-      act(() => ReactDOM.unmountComponentAtNode(container));\n+      act(() => unmount());\n       expect(print(store)).toBe('');\n     }\n \n     // 2. Verify check Suspense can render same steps as initial fallback content.\n     for (let i = 0; i < steps.length; i++) {\n+      createContainer();\n+\n       act(() =>\n-        legacyRender(\n+        render(\n           <Root>\n             <X />\n             <React.Suspense fallback={steps[i]}>\n@@ -560,57 +566,54 @@ describe('StoreStress (Legacy Mode)', () => {\n             </React.Suspense>\n             <Y />\n           </Root>,\n-          container,\n         ),\n       );\n       expect(print(store)).toEqual(snapshots[i]);\n-      act(() => ReactDOM.unmountComponentAtNode(container));\n+      act(() => unmount());\n       expect(print(store)).toBe('');\n     }\n \n     // 3. Verify we can update from each step to each step in primary mode.\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>{steps[i]}</React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Re-render with steps[j].\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>{steps[j]}</React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Verify the successful transition to steps[j].\n         expect(print(store)).toEqual(snapshots[j]);\n         // Check that we can transition back again.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>{steps[i]}</React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n@@ -619,9 +622,10 @@ describe('StoreStress (Legacy Mode)', () => {\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n@@ -631,13 +635,12 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Re-render with steps[j].\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>\n@@ -647,14 +650,13 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Verify the successful transition to steps[j].\n         expect(print(store)).toEqual(snapshots[j]);\n         // Check that we can transition back again.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n@@ -664,12 +666,11 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n@@ -678,21 +679,21 @@ describe('StoreStress (Legacy Mode)', () => {\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>{steps[i]}</React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Re-render with steps[j].\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>\n@@ -702,25 +703,23 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Verify the successful transition to steps[j].\n         expect(print(store)).toEqual(snapshots[j]);\n         // Check that we can transition back again.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>{steps[i]}</React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n@@ -729,9 +728,10 @@ describe('StoreStress (Legacy Mode)', () => {\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n@@ -741,26 +741,24 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Re-render with steps[j].\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>{steps[j]}</React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Verify the successful transition to steps[j].\n         expect(print(store)).toEqual(snapshots[j]);\n         // Check that we can transition back again.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n@@ -770,12 +768,11 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n@@ -784,15 +781,15 @@ describe('StoreStress (Legacy Mode)', () => {\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>{steps[i]}</React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n \n@@ -824,7 +821,7 @@ describe('StoreStress (Legacy Mode)', () => {\n \n         // Trigger actual fallback.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>\n@@ -834,7 +831,6 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[j]);\n@@ -852,13 +848,12 @@ describe('StoreStress (Legacy Mode)', () => {\n \n         // Switch to primary mode.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>{steps[i]}</React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Fallback is still forced though.\n@@ -876,13 +871,14 @@ describe('StoreStress (Legacy Mode)', () => {\n         expect(print(store)).toEqual(snapshots[i]);\n \n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n   });\n \n   // @reactVersion >= 18.0\n+  // @reactVersion <= 18.2\n   it('should handle a stress test for Suspense without type change (Legacy Mode)', () => {\n     const A = () => 'a';\n     const B = () => 'b';\n@@ -1176,24 +1172,25 @@ describe('StoreStress (Legacy Mode)', () => {\n     // 1. For each step, check Suspense can render them as initial primary content.\n     // This is the only step where we use Jest snapshots.\n     const snapshots = [];\n-    let container = document.createElement('div');\n+\n     for (let i = 0; i < steps.length; i++) {\n+      createContainer();\n+\n       act(() =>\n-        legacyRender(\n+        render(\n           <Root>\n             <X />\n             <React.Suspense fallback={z}>\n               <MaybeSuspend suspend={false}>{steps[i]}</MaybeSuspend>\n             </React.Suspense>\n             <Y />\n           </Root>,\n-          container,\n         ),\n       );\n       // We snapshot each step once so it doesn't regress.\n       expect(store).toMatchInlineSnapshot(stepsSnapshot[i]);\n       snapshots.push(print(store));\n-      act(() => ReactDOM.unmountComponentAtNode(container));\n+      act(() => unmount());\n       expect(print(store)).toBe('');\n     }\n \n@@ -1202,8 +1199,10 @@ describe('StoreStress (Legacy Mode)', () => {\n     // which is different from the snapshots above. So we take more snapshots.\n     const fallbackSnapshots = [];\n     for (let i = 0; i < steps.length; i++) {\n+      createContainer();\n+\n       act(() =>\n-        legacyRender(\n+        render(\n           <Root>\n             <X />\n             <React.Suspense fallback={steps[i]}>\n@@ -1213,65 +1212,62 @@ describe('StoreStress (Legacy Mode)', () => {\n             </React.Suspense>\n             <Y />\n           </Root>,\n-          container,\n         ),\n       );\n       // We snapshot each step once so it doesn't regress.\n       expect(store).toMatchInlineSnapshot(stepsSnapshotTwo[i]);\n       fallbackSnapshots.push(print(store));\n-      act(() => ReactDOM.unmountComponentAtNode(container));\n+      act(() => unmount());\n       expect(print(store)).toBe('');\n     }\n \n     // 3. Verify we can update from each step to each step in primary mode.\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>\n                 <MaybeSuspend suspend={false}>{steps[i]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Re-render with steps[j].\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>\n                 <MaybeSuspend suspend={false}>{steps[j]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Verify the successful transition to steps[j].\n         expect(print(store)).toEqual(snapshots[j]);\n         // Check that we can transition back again.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>\n                 <MaybeSuspend suspend={false}>{steps[i]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n@@ -1280,9 +1276,10 @@ describe('StoreStress (Legacy Mode)', () => {\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n@@ -1295,13 +1292,12 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(fallbackSnapshots[i]);\n         // Re-render with steps[j].\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>\n@@ -1314,14 +1310,13 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Verify the successful transition to steps[j].\n         expect(print(store)).toEqual(fallbackSnapshots[j]);\n         // Check that we can transition back again.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n@@ -1334,12 +1329,11 @@ describe('StoreStress (Legacy Mode)', () => {\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(fallbackSnapshots[i]);\n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n@@ -1348,51 +1342,49 @@ describe('StoreStress (Legacy Mode)', () => {\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>\n                 <MaybeSuspend suspend={false}>{steps[i]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Re-render with steps[j].\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>\n                 <MaybeSuspend suspend={true}>{steps[i]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Verify the successful transition to steps[j].\n         expect(print(store)).toEqual(fallbackSnapshots[j]);\n         // Check that we can transition back again.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={z}>\n                 <MaybeSuspend suspend={false}>{steps[i]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(snapshots[i]);\n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n@@ -1401,51 +1393,49 @@ describe('StoreStress (Legacy Mode)', () => {\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n                 <MaybeSuspend suspend={true}>{steps[j]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(fallbackSnapshots[i]);\n         // Re-render with steps[j].\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n                 <MaybeSuspend suspend={false}>{steps[j]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Verify the successful transition to steps[j].\n         expect(print(store)).toEqual(snapshots[j]);\n         // Check that we can transition back again.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[i]}>\n                 <MaybeSuspend suspend={true}>{steps[j]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(fallbackSnapshots[i]);\n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }\n@@ -1454,17 +1444,17 @@ describe('StoreStress (Legacy Mode)', () => {\n     for (let i = 0; i < steps.length; i++) {\n       for (let j = 0; j < steps.length; j++) {\n         // Always start with a fresh container and steps[i].\n-        container = document.createElement('div');\n+        createContainer();\n+\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>\n                 <MaybeSuspend suspend={false}>{steps[i]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n \n@@ -1496,15 +1486,14 @@ describe('StoreStress (Legacy Mode)', () => {\n \n         // Trigger actual fallback.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>\n                 <MaybeSuspend suspend={true}>{steps[i]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         expect(print(store)).toEqual(fallbackSnapshots[j]);\n@@ -1522,15 +1511,14 @@ describe('StoreStress (Legacy Mode)', () => {\n \n         // Switch to primary mode.\n         act(() =>\n-          legacyRender(\n+          render(\n             <Root>\n               <X />\n               <React.Suspense fallback={steps[j]}>\n                 <MaybeSuspend suspend={false}>{steps[i]}</MaybeSuspend>\n               </React.Suspense>\n               <Y />\n             </Root>,\n-            container,\n           ),\n         );\n         // Fallback is still forced though.\n@@ -1548,7 +1536,7 @@ describe('StoreStress (Legacy Mode)', () => {\n         expect(print(store)).toEqual(snapshots[i]);\n \n         // Clean up after every iteration.\n-        act(() => ReactDOM.unmountComponentAtNode(container));\n+        act(() => unmount());\n         expect(print(store)).toBe('');\n       }\n     }"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/storeStressTestConcurrent-test.js",
                "git_diff": "@@ -17,6 +17,8 @@ describe('StoreStressConcurrent', () => {\n   let print;\n \n   beforeEach(() => {\n+    global.IS_REACT_ACT_ENVIRONMENT = true;\n+\n     bridge = global.bridge;\n     store = global.store;\n     store.collapseNodesByDefault = false;\n@@ -31,12 +33,6 @@ describe('StoreStressConcurrent', () => {\n     print = require('./__serializers__/storeSerializer').print;\n   });\n \n-  // TODO: Remove this in favor of @gate pragma\n-  if (!__EXPERIMENTAL__) {\n-    it(\"empty test so Jest doesn't complain\", () => {});\n-    return;\n-  }\n-\n   // This is a stress test for the tree mount/update/unmount traversal.\n   // It renders different trees that should produce the same output.\n   // @reactVersion >= 18.0"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/treeContext-test.js",
                "git_diff": "@@ -15,12 +15,12 @@ import type {\n   StateContext,\n } from 'react-devtools-shared/src/devtools/views/Components/TreeContext';\n \n+import {getVersionedRenderImplementation} from './utils';\n+\n describe('TreeListContext', () => {\n   let React;\n-  let ReactDOM;\n   let TestRenderer: ReactTestRenderer;\n   let bridge: FrontendBridge;\n-  let legacyRender;\n   let store: Store;\n   let utils;\n   let withErrorsOrWarningsIgnored;\n@@ -33,18 +33,18 @@ describe('TreeListContext', () => {\n   let state: StateContext;\n \n   beforeEach(() => {\n+    global.IS_REACT_ACT_ENVIRONMENT = true;\n+\n     utils = require('./utils');\n     utils.beforeEachProfiling();\n \n-    legacyRender = utils.legacyRender;\n     withErrorsOrWarningsIgnored = utils.withErrorsOrWarningsIgnored;\n \n     bridge = global.bridge;\n     store = global.store;\n     store.collapseNodesByDefault = false;\n \n     React = require('react');\n-    ReactDOM = require('react-dom');\n     TestRenderer = utils.requireTestRenderer();\n \n     BridgeContext =\n@@ -54,6 +54,8 @@ describe('TreeListContext', () => {\n     TreeContext = require('react-devtools-shared/src/devtools/views/Components/TreeContext');\n   });\n \n+  const {render, unmount, createContainer} = getVersionedRenderImplementation();\n+\n   afterEach(() => {\n     // Reset between tests\n     dispatch = ((null: any): DispatcherContext);\n@@ -89,9 +91,7 @@ describe('TreeListContext', () => {\n       );\n       const Child = () => null;\n \n-      utils.act(() =>\n-        legacyRender(<Grandparent />, document.createElement('div')),\n-      );\n+      utils.act(() => render(<Grandparent />));\n \n       let renderer;\n       utils.act(() => (renderer = TestRenderer.create(<Contexts />)));\n@@ -215,9 +215,7 @@ describe('TreeListContext', () => {\n       );\n       const Child = () => null;\n \n-      utils.act(() =>\n-        legacyRender(<Grandparent />, document.createElement('div')),\n-      );\n+      utils.act(() => render(<Grandparent />));\n \n       let renderer;\n       utils.act(() => (renderer = TestRenderer.create(<Contexts />)));\n@@ -301,9 +299,7 @@ describe('TreeListContext', () => {\n       );\n       const Child = () => null;\n \n-      utils.act(() =>\n-        legacyRender(<Grandparent />, document.createElement('div')),\n-      );\n+      utils.act(() => render(<Grandparent />));\n \n       let renderer;\n       utils.act(() => (renderer = TestRenderer.create(<Contexts />)));\n@@ -391,16 +387,14 @@ describe('TreeListContext', () => {\n       const Parent = props => props.children || null;\n       const Child = () => null;\n \n-      const container = document.createElement('div');\n       utils.act(() =>\n-        legacyRender(\n+        render(\n           <Grandparent>\n             <Parent>\n               <Child />\n               <Child />\n             </Parent>\n           </Grandparent>,\n-          container,\n         ),\n       );\n \n@@ -427,11 +421,10 @@ describe('TreeListContext', () => {\n \n       // Remove the child (which should auto-select the parent)\n       await utils.actAsync(() =>\n-        legacyRender(\n+        render(\n           <Grandparent>\n             <Parent />\n           </Grandparent>,\n-          container,\n         ),\n       );\n       expect(state).toMatchInlineSnapshot(`\n@@ -441,7 +434,7 @@ describe('TreeListContext', () => {\n       `);\n \n       // Unmount the root (so that nothing is selected)\n-      await utils.actAsync(() => ReactDOM.unmountComponentAtNode(container));\n+      await utils.actAsync(() => unmount());\n       expect(state).toMatchInlineSnapshot(``);\n     });\n \n@@ -459,9 +452,7 @@ describe('TreeListContext', () => {\n           .map((_, index) => <Child key={index} />);\n       const Child = () => null;\n \n-      utils.act(() =>\n-        legacyRender(<Grandparent />, document.createElement('div')),\n-      );\n+      utils.act(() => render(<Grandparent />));\n \n       let renderer;\n       utils.act(() => (renderer = TestRenderer.create(<Contexts />)));\n@@ -620,9 +611,7 @@ describe('TreeListContext', () => {\n           .map((_, index) => <Child key={index} />);\n       const Child = () => null;\n \n-      utils.act(() =>\n-        legacyRender(<Grandparent />, document.createElement('div')),\n-      );\n+      utils.act(() => render(<Grandparent />));\n \n       let renderer;\n       utils.act(() => (renderer = TestRenderer.create(<Contexts />)));\n@@ -920,14 +909,13 @@ describe('TreeListContext', () => {\n       Qux.displayName = `withHOC(${Qux.name})`;\n \n       utils.act(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Foo />\n             <Bar />\n             <Baz />\n             <Qux />\n           </React.Fragment>,\n-          document.createElement('div'),\n         ),\n       );\n \n@@ -992,14 +980,13 @@ describe('TreeListContext', () => {\n       const Baz = () => null;\n \n       utils.act(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Foo />\n             <Baz />\n             <Bar />\n             <Baz />\n           </React.Fragment>,\n-          document.createElement('div'),\n         ),\n       );\n \n@@ -1096,15 +1083,12 @@ describe('TreeListContext', () => {\n       const Bar = () => null;\n       const Baz = () => null;\n \n-      const container = document.createElement('div');\n-\n       utils.act(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Foo />\n             <Bar />\n           </React.Fragment>,\n-          container,\n         ),\n       );\n \n@@ -1125,13 +1109,12 @@ describe('TreeListContext', () => {\n       `);\n \n       await utils.actAsync(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Foo />\n             <Bar />\n             <Baz />\n           </React.Fragment>,\n-          container,\n         ),\n       );\n       utils.act(() => renderer.update(<Contexts />));\n@@ -1157,16 +1140,13 @@ describe('TreeListContext', () => {\n       const Bar = () => null;\n       const Baz = () => null;\n \n-      const container = document.createElement('div');\n-\n       utils.act(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Foo />\n             <Bar />\n             <Baz />\n           </React.Fragment>,\n-          container,\n         ),\n       );\n \n@@ -1198,12 +1178,11 @@ describe('TreeListContext', () => {\n       `);\n \n       await utils.actAsync(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Foo />\n             <Bar />\n           </React.Fragment>,\n-          container,\n         ),\n       );\n       utils.act(() => renderer.update(<Contexts />));\n@@ -1243,9 +1222,7 @@ describe('TreeListContext', () => {\n       );\n       const Child = () => null;\n \n-      utils.act(() =>\n-        legacyRender(<Grandparent />, document.createElement('div')),\n-      );\n+      utils.act(() => render(<Grandparent />));\n \n       let renderer;\n       utils.act(() => (renderer = TestRenderer.create(<Contexts />)));\n@@ -1284,8 +1261,7 @@ describe('TreeListContext', () => {\n         new Array(count).fill(true).map((_, index) => <Child key={index} />);\n       const Child = () => null;\n \n-      const container = document.createElement('div');\n-      utils.act(() => legacyRender(<Grandparent count={2} />, container));\n+      utils.act(() => render(<Grandparent count={2} />));\n \n       let renderer;\n       utils.act(() => (renderer = TestRenderer.create(<Contexts />)));\n@@ -1307,18 +1283,14 @@ describe('TreeListContext', () => {\n                <Child key=\"1\">\n       `);\n \n-      await utils.actAsync(() =>\n-        legacyRender(<Grandparent count={1} />, container),\n-      );\n+      await utils.actAsync(() => render(<Grandparent count={1} />));\n       expect(state).toMatchInlineSnapshot(`\n         [owners]\n         \u2192  \u25be <Parent>\n                <Child key=\"0\">\n       `);\n \n-      await utils.actAsync(() =>\n-        legacyRender(<Grandparent count={0} />, container),\n-      );\n+      await utils.actAsync(() => render(<Grandparent count={0} />));\n       expect(state).toMatchInlineSnapshot(`\n         [owners]\n         \u2192    <Parent>\n@@ -1329,13 +1301,11 @@ describe('TreeListContext', () => {\n       const Parent = props => props.children || null;\n       const Child = () => null;\n \n-      const container = document.createElement('div');\n       utils.act(() =>\n-        legacyRender(\n+        render(\n           <Parent>\n             <Child />\n           </Parent>,\n-          container,\n         ),\n       );\n \n@@ -1355,7 +1325,7 @@ describe('TreeListContext', () => {\n         \u2192    <Child>\n       `);\n \n-      await utils.actAsync(() => legacyRender(<Parent />, container));\n+      await utils.actAsync(() => render(<Parent />));\n       expect(state).toMatchInlineSnapshot(`\n         [root]\n         \u2192    <Parent>\n@@ -1369,7 +1339,7 @@ describe('TreeListContext', () => {\n         \u2192    <Parent>\n       `);\n \n-      await utils.actAsync(() => ReactDOM.unmountComponentAtNode(container));\n+      await utils.actAsync(() => unmount());\n       expect(state).toMatchInlineSnapshot(``);\n     });\n \n@@ -1387,8 +1357,7 @@ describe('TreeListContext', () => {\n         </React.Suspense>\n       );\n \n-      const container = document.createElement('div');\n-      utils.act(() => legacyRender(<Parent />, container));\n+      utils.act(() => render(<Parent />));\n \n       let renderer;\n       utils.act(() => (renderer = TestRenderer.create(<Contexts />)));\n@@ -1495,13 +1464,12 @@ describe('TreeListContext', () => {\n \n     it('should handle when there are no errors/warnings', () => {\n       utils.act(() =>\n-        legacyRender(\n+        render(\n           <React.Fragment>\n             <Child />\n             <Child />\n             <Child />\n           </React.Fragment>,\n-          document.createElement('div'),\n         ),\n       );\n \n@@ -1558,15 +1526,14 @@ describe('TreeListContext', () => {\n     it('should cycle through the next errors/warnings and wrap around', () => {\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child />\n               <Child logWarning={true} />\n               <Child />\n               <Child logError={true} />\n               <Child />\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -1619,15 +1586,14 @@ describe('TreeListContext', () => {\n     it('should cycle through the previous errors/warnings and wrap around', () => {\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child />\n               <Child logWarning={true} />\n               <Child />\n               <Child logError={true} />\n               <Child />\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -1680,20 +1646,21 @@ describe('TreeListContext', () => {\n     it('should cycle through the next errors/warnings and wrap around with multiple roots', () => {\n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n         utils.act(() => {\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child />\n               <Child logWarning={true} />,\n             </React.Fragment>,\n-            document.createElement('div'),\n           );\n-          legacyRender(\n+\n+          createContainer();\n+\n+          render(\n             <React.Fragment>\n               <Child />\n               <Child logError={true} />\n               <Child />\n             </React.Fragment>,\n-            document.createElement('div'),\n           );\n         });\n       });\n@@ -1750,20 +1717,21 @@ describe('TreeListContext', () => {\n     it('should cycle through the previous errors/warnings and wrap around with multiple roots', () => {\n       withErrorsOrWarningsIgnored(['test-only:'], () => {\n         utils.act(() => {\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child />\n               <Child logWarning={true} />,\n             </React.Fragment>,\n-            document.createElement('div'),\n           );\n-          legacyRender(\n+\n+          createContainer();\n+\n+          render(\n             <React.Fragment>\n               <Child />\n               <Child logError={true} />\n               <Child />\n             </React.Fragment>,\n-            document.createElement('div'),\n           );\n         });\n       });\n@@ -1820,15 +1788,14 @@ describe('TreeListContext', () => {\n     it('should select the next or previous element relative to the current selection', () => {\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child />\n               <Child logWarning={true} />\n               <Child />\n               <Child logError={true} />\n               <Child />\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -1882,14 +1849,13 @@ describe('TreeListContext', () => {\n     it('should update correctly when errors/warnings are cleared for a fiber in the list', () => {\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child logWarning={true} />\n               <Child logError={true} />\n               <Child logError={true} />\n               <Child logWarning={true} />\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -1955,12 +1921,11 @@ describe('TreeListContext', () => {\n     it('should update correctly when errors/warnings are cleared for the currently selected fiber', () => {\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child logWarning={true} />\n               <Child logError={true} />\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -1992,18 +1957,15 @@ describe('TreeListContext', () => {\n     });\n \n     it('should update correctly when new errors/warnings are added', () => {\n-      const container = document.createElement('div');\n-\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child logWarning={true} />\n               <Child />\n               <Child />\n               <Child logError={true} />\n             </React.Fragment>,\n-            container,\n           ),\n         ),\n       );\n@@ -2030,14 +1992,13 @@ describe('TreeListContext', () => {\n \n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child />\n               <Child logWarning={true} />\n               <Child />\n               <Child />\n             </React.Fragment>,\n-            container,\n           ),\n         ),\n       );\n@@ -2076,12 +2037,11 @@ describe('TreeListContext', () => {\n     it('should update correctly when all errors/warnings are cleared', () => {\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child logWarning={true} />\n               <Child logError={true} />\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -2120,7 +2080,6 @@ describe('TreeListContext', () => {\n     });\n \n     it('should update correctly when elements are added/removed', () => {\n-      const container = document.createElement('div');\n       let errored = false;\n       function ErrorOnce() {\n         if (!errored) {\n@@ -2131,11 +2090,10 @@ describe('TreeListContext', () => {\n       }\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <ErrorOnce key=\"error\" />\n             </React.Fragment>,\n-            container,\n           ),\n         ),\n       );\n@@ -2150,12 +2108,11 @@ describe('TreeListContext', () => {\n \n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child />\n               <ErrorOnce key=\"error\" />\n             </React.Fragment>,\n-            container,\n           ),\n         ),\n       );\n@@ -2178,7 +2135,6 @@ describe('TreeListContext', () => {\n     });\n \n     it('should update correctly when elements are re-ordered', () => {\n-      const container = document.createElement('div');\n       function ErrorOnce() {\n         const didErrorRef = React.useRef(false);\n         if (!didErrorRef.current) {\n@@ -2189,14 +2145,13 @@ describe('TreeListContext', () => {\n       }\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Child key=\"A\" />\n               <ErrorOnce key=\"B\" />\n               <Child key=\"C\" />\n               <ErrorOnce key=\"D\" />\n             </React.Fragment>,\n-            container,\n           ),\n         ),\n       );\n@@ -2227,14 +2182,13 @@ describe('TreeListContext', () => {\n       // Re-order the tree and ensure indices are updated.\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <ErrorOnce key=\"B\" />\n               <Child key=\"A\" />\n               <ErrorOnce key=\"D\" />\n               <Child key=\"C\" />\n             </React.Fragment>,\n-            container,\n           ),\n         ),\n       );\n@@ -2261,14 +2215,13 @@ describe('TreeListContext', () => {\n       // Re-order the tree and ensure indices are updated.\n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <ErrorOnce key=\"D\" />\n               <ErrorOnce key=\"B\" />\n               <Child key=\"A\" />\n               <Child key=\"C\" />\n             </React.Fragment>,\n-            container,\n           ),\n         ),\n       );\n@@ -2289,7 +2242,7 @@ describe('TreeListContext', () => {\n \n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Wrapper>\n                 <Child logWarning={true} />\n@@ -2300,7 +2253,6 @@ describe('TreeListContext', () => {\n                 </Wrapper>\n               </Wrapper>\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -2339,7 +2291,7 @@ describe('TreeListContext', () => {\n \n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Wrapper>\n                 <Child logWarning={true} />\n@@ -2350,7 +2302,6 @@ describe('TreeListContext', () => {\n                 </Wrapper>\n               </Wrapper>\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -2425,7 +2376,7 @@ describe('TreeListContext', () => {\n \n       withErrorsOrWarningsIgnored(['test-only:'], () =>\n         utils.act(() =>\n-          legacyRender(\n+          render(\n             <React.Fragment>\n               <Wrapper>\n                 <Child logWarning={true} />\n@@ -2436,7 +2387,6 @@ describe('TreeListContext', () => {\n                 </Wrapper>\n               </Wrapper>\n             </React.Fragment>,\n-            document.createElement('div'),\n           ),\n         ),\n       );\n@@ -2483,12 +2433,11 @@ describe('TreeListContext', () => {\n \n         withErrorsOrWarningsIgnored(['test-only:'], () =>\n           utils.act(() =>\n-            legacyRender(\n+            render(\n               <React.Suspense fallback={null}>\n                 <Child logWarning={true} />\n                 <NeverResolves />\n               </React.Suspense>,\n-              document.createElement('div'),\n             ),\n           ),\n         );\n@@ -2515,16 +2464,13 @@ describe('TreeListContext', () => {\n         }\n         const LazyComponent = React.lazy(() => fakeImport(Child));\n \n-        const container = document.createElement('div');\n-\n         withErrorsOrWarningsIgnored(['test-only:'], () =>\n           utils.act(() =>\n-            legacyRender(\n+            render(\n               <React.Suspense fallback={null}>\n                 <Child logWarning={true} />\n                 <LazyComponent />\n               </React.Suspense>,\n-              container,\n             ),\n           ),\n         );\n@@ -2538,12 +2484,11 @@ describe('TreeListContext', () => {\n         await Promise.resolve();\n         withErrorsOrWarningsIgnored(['test-only:'], () =>\n           utils.act(() =>\n-            legacyRender(\n+            render(\n               <React.Suspense fallback={null}>\n                 <Child logWarning={true} />\n                 <LazyComponent />\n               </React.Suspense>,\n-              container,\n             ),\n           ),\n         );\n@@ -2565,15 +2510,12 @@ describe('TreeListContext', () => {\n \n         const Fallback = () => <Child logError={true} />;\n \n-        const container = document.createElement('div');\n-\n         withErrorsOrWarningsIgnored(['test-only:'], () =>\n           utils.act(() =>\n-            legacyRender(\n+            render(\n               <React.Suspense fallback={<Fallback />}>\n                 <LazyComponent />\n               </React.Suspense>,\n-              container,\n             ),\n           ),\n         );\n@@ -2590,11 +2532,10 @@ describe('TreeListContext', () => {\n         await Promise.resolve();\n         withErrorsOrWarningsIgnored(['test-only:'], () =>\n           utils.act(() =>\n-            legacyRender(\n+            render(\n               <React.Suspense fallback={<Fallback />}>\n                 <LazyComponent />\n               </React.Suspense>,\n-              container,\n             ),\n           ),\n         );\n@@ -2629,16 +2570,14 @@ describe('TreeListContext', () => {\n           }\n         }\n \n-        const container = document.createElement('div');\n         withErrorsOrWarningsIgnored(\n           ['test-only:', 'React will try to recreate this component tree'],\n           () => {\n             utils.act(() =>\n-              legacyRender(\n+              render(\n                 <ErrorBoundary>\n                   <BadRender />\n                 </ErrorBoundary>,\n-                container,\n               ),\n             );\n           },\n@@ -2659,7 +2598,7 @@ describe('TreeListContext', () => {\n           \u2192    <ErrorBoundary> \u2715\n         `);\n \n-        utils.act(() => ReactDOM.unmountComponentAtNode(container));\n+        utils.act(() => unmount());\n         expect(state).toMatchInlineSnapshot(``);\n \n         // Should be a noop\n@@ -2693,16 +2632,14 @@ describe('TreeListContext', () => {\n           }\n         }\n \n-        const container = document.createElement('div');\n         withErrorsOrWarningsIgnored(\n           ['test-only:', 'React will try to recreate this component tree'],\n           () => {\n             utils.act(() =>\n-              legacyRender(\n+              render(\n                 <ErrorBoundary>\n                   <LogsWarning />\n                 </ErrorBoundary>,\n-                container,\n               ),\n             );\n           },\n@@ -2723,7 +2660,7 @@ describe('TreeListContext', () => {\n           \u2192    <ErrorBoundary> \u2715\n         `);\n \n-        utils.act(() => ReactDOM.unmountComponentAtNode(container));\n+        utils.act(() => unmount());\n         expect(state).toMatchInlineSnapshot(``);\n \n         // Should be a noop\n@@ -2752,16 +2689,14 @@ describe('TreeListContext', () => {\n           }\n         }\n \n-        const container = document.createElement('div');\n         withErrorsOrWarningsIgnored(\n           ['test-only:', 'React will try to recreate this component tree'],\n           () => {\n             utils.act(() =>\n-              legacyRender(\n+              render(\n                 <ErrorBoundary>\n                   <BadRender />\n                 </ErrorBoundary>,\n-                container,\n               ),\n             );\n           },"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/useEditableValue-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/utils-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/utils.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backend/DevToolsComponentStackFrame.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backend/DevToolsFiberComponentStack.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backend/ReactSymbols.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backend/legacy/renderer.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backend/renderer.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backend/types.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backend/utils.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backendAPI.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/cache.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/Element.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElement.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElementContext.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElementSourcePanel.css",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElementSourcePanel.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElementView.css",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElementView.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/InspectedElementViewSourceButton.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/OpenInEditorButton.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/Skeleton.css",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/Skeleton.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/Tree.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Components/ViewSourceContext.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/DevTools.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Profiler/SidebarEventInfo.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/Settings/ComponentsSettings.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/devtools/views/hooks.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/frontend/types.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/hook.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/hooks/__tests__/parseHookNames-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/CHANGELOG.md",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/LICENSE.md",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/README.md",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/dist/index-dev.umd.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/dist/index-prod.umd.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/dist/index.cjs.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/dist/index.cjs.js.flow",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/dist/index.esm.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/dist/index.esm.js.flow",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/package.json",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/FixedSizeGrid.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/FixedSizeList.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/VariableSizeGrid.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/VariableSizeList.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/areEqual.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/createGridComponent.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/createListComponent.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/domHelpers.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/index.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/shallowDiffers.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/shouldComponentUpdate.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/node_modules/react-window/src/timer.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/shared/types.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/symbolicateSource.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/utils.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shell/src/app/InspectableElements/CustomHooks.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shell/src/app/InspectableElements/UnserializableProps.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shell/src/app/index.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shell/src/multi/left.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shell/src/multi/right.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shell/webpack-server.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-timeline/package.json",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-timeline/src/view-base/Surface.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-timeline/src/view-base/utils/normalizeWheel.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools/CHANGELOG.md",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools/package.json",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/package.json",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/client/ReactDOMComponent.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/client/ReactDOMInput.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/client/ReactDOMOption.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/client/ReactDOMSelect.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/client/ReactDOMTextarea.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/client/ReactFiberConfigDOM.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/client/ToStringValue.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/client/validateDOMNesting.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/events/ReactDOMEventReplaying.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/server/ReactDOMFlightServerHostDispatcher.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/server/ReactFizzConfigDOM.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/server/ReactFizzConfigDOMLegacy.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/server/ReactFlightServerConfigDOM.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/server/escapeTextForBrowser.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/server/fizz-instruction-set/ReactDOMFizzInstructionSetInlineCodeStrings.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/server/fizz-instruction-set/ReactDOMFizzInstructionSetShared.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/shared/ReactDOMFormActions.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/shared/ReactDOMInvalidARIAHook.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/shared/ReactDOMUnknownPropertyHook.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/shared/ReactFlightClientConfigDOM.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom-bindings/src/shared/isCustomElement.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/index.experimental.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/package.json",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/ReactDOMSharedInternals.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/CSSPropertyOperations-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/InvalidEventListeners-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactBrowserEventEmitter-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactChildReconciler-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactComponent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactComponentLifeCycle-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactCompositeComponent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactCompositeComponentDOMMinimalism-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactCompositeComponentNestedState-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactCompositeComponentState-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOM-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMAttribute-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMComponent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMComponentTree-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMConsoleErrorReporting-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMConsoleErrorReportingLegacy-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMEventListener-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMEventPropagation-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMFiber-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMFiberAsync-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMFizzServer-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMFloat-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMForm-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMHooks-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMHydrationDiff-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMIframe-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMInput-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMInvalidARIAHook-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMLegacyComponentTree-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMLegacyFiber-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMOption-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMRoot-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMSVG-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMSelect-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMSelection-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationAttributes-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationBasic-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationCheckbox-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationClassContextType-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationElements-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationFragment-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationHooks-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationInput-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationLegacyContext-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationLegacyContextDisabled-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationModes-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationNewContext-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationReconnecting-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationRefs-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationSelect-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationSpecialTypes-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationTextarea-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationUntrustedURL-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationUserInteraction-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerLifecycles-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerPartialHydration-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerSuspense-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMSingletonComponents-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMSuspensePlaceholder-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMTestSelectors-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMTextComponent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMTextarea-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMserverIntegrationProgress-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDeprecationWarnings-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactEmptyComponent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactErrorBoundaries-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactErrorBoundariesHooks-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactEventIndependence-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactFunctionComponent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactIdentity-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactLegacyCompositeComponent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactLegacyContextDisabled-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactLegacyErrorBoundaries-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactLegacyMount-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactLegacyRootWarnings-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactLegacyUpdates-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactMockedComponent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactMountDestruction-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactMultiChild-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactMultiChildReconcile-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactMultiChildText-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactRenderDocument-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactServerRendering-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactServerRenderingHydration-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactTestUtils-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactTestUtilsAct-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactTestUtilsActUnmockedScheduler-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactTreeTraversal-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactUpdates-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/findDOMNode-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/multiple-copies-of-react-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/refs-destruction-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/refs-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/refsLegacy-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/renderSubtreeIntoContainer-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/utils/ReactDOMServerIntegrationTestUtils.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/__tests__/validateDOMNesting-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/client/ReactDOM.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/client/ReactDOMLegacy.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/client/ReactDOMRoot.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/client/__tests__/trustedTypes-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/events/__tests__/DOMPluginEventSystem-test.internal.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/events/__tests__/SyntheticClipboardEvent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/events/__tests__/SyntheticEvent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-dom/src/events/__tests__/SyntheticFocusEvent-test.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools/package.json",
                "git_diff": "@@ -25,7 +25,7 @@\n   \"dependencies\": {\n     \"cross-spawn\": \"^5.0.1\",\n     \"electron\": \"^23.1.2\",\n-    \"ip\": \"^1.1.4\",\n+    \"ip\": \"^1.1.9\",\n     \"minimist\": \"^1.2.3\",\n     \"react-devtools-core\": \"5.0.2\",\n     \"update-notifier\": \"^2.1.0\""
            },
            {
                "file": "scripts/bench/package.json",
                "git_diff": "@@ -11,7 +11,7 @@\n     \"cli-table\": \"^0.3.1\",\n     \"http-server\": \"^0.10.0\",\n     \"http2\": \"^3.3.6\",\n-    \"lighthouse\": \"^3.2.1\",\n+    \"lighthouse\": \"^6.0.0\",\n     \"mime\": \"^1.3.6\",\n     \"minimist\": \"^1.2.3\",\n     \"ncp\": \"^2.0.0\","
            },
            {
                "file": "scripts/bench/yarn.lock",
                "git_diff": "@@ -2,30 +2,27 @@\n # yarn lockfile v1\n \n \n-\"@types/core-js@^0.9.41\":\n-  version \"0.9.46\"\n-  resolved \"https://registry.yarnpkg.com/@types/core-js/-/core-js-0.9.46.tgz#ea701ee34cbb6dfe6d100f1530319547c93c8d79\"\n-  integrity sha512-LooLR6XHes9V+kNYRz1Qm8w3atw9QMn7XeZUmIpUelllF9BdryeUKd/u0Wh5ErcjpWfG39NrToU9MF7ngsTFVw==\n+\"@sindresorhus/is@^0.14.0\":\n+  version \"0.14.0\"\n+  resolved \"https://registry.yarnpkg.com/@sindresorhus/is/-/is-0.14.0.tgz#9fb3a3cf3132328151f353de4632e01e52102bea\"\n+  integrity sha512-9NET910DNaIPngYnLLPeg+Ogzqsi9uM4mSboU5y6p8S5DzMTVEsJZrawi+BoDNUVBa2DhJqQYUFvMDfgU062LQ==\n \n-\"@types/mkdirp@^0.3.29\":\n-  version \"0.3.29\"\n-  resolved \"https://registry.yarnpkg.com/@types/mkdirp/-/mkdirp-0.3.29.tgz#7f2ad7ec55f914482fc9b1ec4bb1ae6028d46066\"\n-  integrity sha1-fyrX7FX5FEgvybHsS7GuYCjUYGY=\n+\"@szmarczak/http-timer@^1.1.2\":\n+  version \"1.1.2\"\n+  resolved \"https://registry.yarnpkg.com/@szmarczak/http-timer/-/http-timer-1.1.2.tgz#b1665e2c461a2cd92f4c1bbf50d5454de0d4b421\"\n+  integrity sha512-XIB2XbzHTN6ieIjfIMV9hlVcfPU26s2vafYWQcZHWXHOxiaRZYEDKEwdl129Zyg50+foYV2jCgtrqSA6qNuNSA==\n+  dependencies:\n+    defer-to-connect \"^1.0.1\"\n \n \"@types/node@*\":\n   version \"10.12.0\"\n   resolved \"https://registry.yarnpkg.com/@types/node/-/node-10.12.0.tgz#ea6dcbddbc5b584c83f06c60e82736d8fbb0c235\"\n   integrity sha512-3TUHC3jsBAB7qVRGxT6lWyYo2v96BMmD2PTcl47H25Lu7UXtFH/2qqmKiVrnel6Ne//0TFYf6uvNX+HW2FRkLQ==\n \n-\"@types/node@^9.3.0\":\n-  version \"9.6.35\"\n-  resolved \"https://registry.yarnpkg.com/@types/node/-/node-9.6.35.tgz#197dd535c094362a7c95f0b78f07583d6681ed26\"\n-  integrity sha512-h5zvHS8wXHGa+Gcqs9K8vqCgOtqjr0+NqG/DDJmQIX1wpR9HivAfgV8bjcD3mGM4bPfQw5Aneb2Pn8355L83jA==\n-\n-\"@types/rimraf@^0.0.28\":\n-  version \"0.0.28\"\n-  resolved \"https://registry.yarnpkg.com/@types/rimraf/-/rimraf-0.0.28.tgz#5562519bc7963caca8abf7f128cae3b594d41d06\"\n-  integrity sha1-VWJRm8eWPKyoq/fxKMrjtZTUHQY=\n+JSV@^4.0.2:\n+  version \"4.0.2\"\n+  resolved \"https://registry.yarnpkg.com/JSV/-/JSV-4.0.2.tgz#d077f6825571f82132f9dffaed587b4029feff57\"\n+  integrity sha512-ZJ6wx9xaKJ3yFUhq5/sk82PJMuUyLk277I8mQeyDgCTjGdjWJIvPfaU5LIXaMuaN2UO1X3kZH4+lgphublZUHw==\n \n abbrev@1:\n   version \"1.1.0\"\n@@ -38,28 +35,38 @@ ajv@^4.9.1:\n     co \"^4.6.0\"\n     json-stable-stringify \"^1.0.1\"\n \n-ansi-align@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/ansi-align/-/ansi-align-2.0.0.tgz#c36aeccba563b89ceb556f3690f0b1d9e3547f7f\"\n+ajv@^6.12.3:\n+  version \"6.12.6\"\n+  resolved \"https://registry.yarnpkg.com/ajv/-/ajv-6.12.6.tgz#baf5a62e802b07d977034586f8c3baf5adf26df4\"\n+  integrity sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g==\n   dependencies:\n-    string-width \"^2.0.0\"\n+    fast-deep-equal \"^3.1.1\"\n+    fast-json-stable-stringify \"^2.0.0\"\n+    json-schema-traverse \"^0.4.1\"\n+    uri-js \"^4.2.2\"\n \n-ansi-escapes@^3.0.0:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/ansi-escapes/-/ansi-escapes-3.1.0.tgz#f73207bb81207d75fd6c83f125af26eea378ca30\"\n-  integrity sha512-UgAb8H9D41AQnu/PbWlCofQVcnV4Gs2bBJi9eZPxfU/hgglFh3SMDMENRIqdr7H6XFnXdoknctFByVsCOotTVw==\n+ansi-align@^3.0.0:\n+  version \"3.0.1\"\n+  resolved \"https://registry.yarnpkg.com/ansi-align/-/ansi-align-3.0.1.tgz#0cdf12e111ace773a86e9a1fad1225c43cb19a59\"\n+  integrity sha512-IOfwwBF5iczOjp/WeY4YxyjqAFMQoZufdQWDd19SEExbVLNXqvpzSJ/M7Za4/sCPmQ0+GRquoA7bGcINcxew6w==\n+  dependencies:\n+    string-width \"^4.1.0\"\n+\n+ansi-escapes@^4.2.1:\n+  version \"4.3.2\"\n+  resolved \"https://registry.yarnpkg.com/ansi-escapes/-/ansi-escapes-4.3.2.tgz#6b2291d1db7d98b6521d5f1efa42d0f3a9feb65e\"\n+  integrity sha512-gKXj5ALrKWQLsYG9jlTRmR/xKluxHV+Z9QEwNIgCfM1/uwPMCuzVVnh5mwTd+OuBZcwSIMbqssNWRm1lE51QaQ==\n+  dependencies:\n+    type-fest \"^0.21.3\"\n \n ansi-regex@^2.0.0:\n   version \"2.1.1\"\n   resolved \"https://registry.yarnpkg.com/ansi-regex/-/ansi-regex-2.1.1.tgz#c3b33ab5ee360d86e0e628f0468ae7ef27d654df\"\n \n-ansi-regex@^3.0.0:\n-  version \"3.0.0\"\n-  resolved \"https://registry.yarnpkg.com/ansi-regex/-/ansi-regex-3.0.0.tgz#ed0317c322064f79466c02966bddb605ab37d998\"\n-\n-ansi-styles@^2.2.1:\n-  version \"2.2.1\"\n-  resolved \"https://registry.yarnpkg.com/ansi-styles/-/ansi-styles-2.2.1.tgz#b432dd3358b634cf75e1e4664368240533c1ddbe\"\n+ansi-regex@^5.0.1:\n+  version \"5.0.1\"\n+  resolved \"https://registry.yarnpkg.com/ansi-regex/-/ansi-regex-5.0.1.tgz#082cb2c89c9fe8659a311a53bd6a4dc5301db304\"\n+  integrity sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==\n \n ansi-styles@^3.1.0:\n   version \"3.2.0\"\n@@ -74,6 +81,13 @@ ansi-styles@^3.2.1:\n   dependencies:\n     color-convert \"^1.9.0\"\n \n+ansi-styles@^4.1.0:\n+  version \"4.3.0\"\n+  resolved \"https://registry.yarnpkg.com/ansi-styles/-/ansi-styles-4.3.0.tgz#edd803628ae71c04c85ae7a0906edad34b648937\"\n+  integrity sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==\n+  dependencies:\n+    color-convert \"^2.0.1\"\n+\n aproba@^1.0.3:\n   version \"1.1.2\"\n   resolved \"https://registry.yarnpkg.com/aproba/-/aproba-1.1.2.tgz#45c6629094de4e96f693ef7eab74ae079c240fc1\"\n@@ -118,14 +132,24 @@ aws-sign2@~0.6.0:\n   version \"0.6.0\"\n   resolved \"https://registry.yarnpkg.com/aws-sign2/-/aws-sign2-0.6.0.tgz#14342dd38dbcc94d0e5b87d763cd63612c0e794f\"\n \n+aws-sign2@~0.7.0:\n+  version \"0.7.0\"\n+  resolved \"https://registry.yarnpkg.com/aws-sign2/-/aws-sign2-0.7.0.tgz#b46e890934a9591f2d2f6f86d7e6a9f1b3fe76a8\"\n+  integrity sha512-08kcGqnYf/YmjoRhfxyu+CLxBjUtHLXLXX/vUfx9l2LYzG3c1m61nrpyFUZI6zeS+Li/wWMMidD9KgrqtGq3mA==\n+\n aws4@^1.2.1:\n   version \"1.6.0\"\n   resolved \"https://registry.yarnpkg.com/aws4/-/aws4-1.6.0.tgz#83ef5ca860b2b32e4a0deedee8c771b9db57471e\"\n \n-axe-core@3.0.0-beta.2:\n-  version \"3.0.0-beta.2\"\n-  resolved \"https://registry.yarnpkg.com/axe-core/-/axe-core-3.0.0-beta.2.tgz#82a13d371268034352bba2bcb263c5625b3e4a09\"\n-  integrity sha512-JyMXnHDuzr6hei+mINWsR/iEyPBFSjpgF4/lUijO7QDGVKtTmdpDxc2+7X/xW+rPIwhcd72euJ2UunbRXF+1Eg==\n+aws4@^1.8.0:\n+  version \"1.12.0\"\n+  resolved \"https://registry.yarnpkg.com/aws4/-/aws4-1.12.0.tgz#ce1c9d143389679e253b314241ea9aa5cec980d3\"\n+  integrity sha512-NmWvPnx0F1SfrQbYwOi7OeaNGokp9XhzNioJ/CSBs8Qa4vxug81mhJEAVZwxXuBmYB5KDRfMq/F3RR0BIU7sWg==\n+\n+axe-core@3.5.5:\n+  version \"3.5.5\"\n+  resolved \"https://registry.yarnpkg.com/axe-core/-/axe-core-3.5.5.tgz#84315073b53fa3c0c51676c588d59da09a192227\"\n+  integrity sha512-5P0QZ6J5xGikH780pghEdbEKijCTrruK9KxtPZCFWUpef0f6GipO+xEZ5GKCb020mmqgbiNO6TcA55CriL784Q==\n \n balanced-match@^1.0.0:\n   version \"1.0.0\"\n@@ -149,17 +173,19 @@ boom@2.x.x:\n   dependencies:\n     hoek \"2.x.x\"\n \n-boxen@^1.0.0:\n-  version \"1.2.1\"\n-  resolved \"https://registry.yarnpkg.com/boxen/-/boxen-1.2.1.tgz#0f11e7fe344edb9397977fc13ede7f64d956481d\"\n-  dependencies:\n-    ansi-align \"^2.0.0\"\n-    camelcase \"^4.0.0\"\n-    chalk \"^2.0.1\"\n-    cli-boxes \"^1.0.0\"\n-    string-width \"^2.0.0\"\n-    term-size \"^1.2.0\"\n-    widest-line \"^1.0.0\"\n+boxen@^4.2.0:\n+  version \"4.2.0\"\n+  resolved \"https://registry.yarnpkg.com/boxen/-/boxen-4.2.0.tgz#e411b62357d6d6d36587c8ac3d5d974daa070e64\"\n+  integrity sha512-eB4uT9RGzg2odpER62bBwSLvUeGC+WbRjjyyFhGsKnc8wp/m0+hQsMUvUe3H2V0D5vw0nBdO1hCJoZo5mKeuIQ==\n+  dependencies:\n+    ansi-align \"^3.0.0\"\n+    camelcase \"^5.3.1\"\n+    chalk \"^3.0.0\"\n+    cli-boxes \"^2.2.0\"\n+    string-width \"^4.1.0\"\n+    term-size \"^2.1.0\"\n+    type-fest \"^0.8.1\"\n+    widest-line \"^3.1.0\"\n \n brace-expansion@^1.1.7:\n   version \"1.1.8\"\n@@ -168,83 +194,81 @@ brace-expansion@^1.1.7:\n     balanced-match \"^1.0.0\"\n     concat-map \"0.0.1\"\n \n+cacheable-request@^6.0.0:\n+  version \"6.1.0\"\n+  resolved \"https://registry.yarnpkg.com/cacheable-request/-/cacheable-request-6.1.0.tgz#20ffb8bd162ba4be11e9567d823db651052ca912\"\n+  integrity sha512-Oj3cAGPCqOZX7Rz64Uny2GYAZNliQSqfbePrgAQ1wKAihYmCUnraBtJtKcGR4xz7wF+LoJC+ssFZvv5BgF9Igg==\n+  dependencies:\n+    clone-response \"^1.0.2\"\n+    get-stream \"^5.1.0\"\n+    http-cache-semantics \"^4.0.0\"\n+    keyv \"^3.0.0\"\n+    lowercase-keys \"^2.0.0\"\n+    normalize-url \"^4.1.0\"\n+    responselike \"^1.0.2\"\n+\n camelcase@^2.0.1:\n   version \"2.1.1\"\n   resolved \"https://registry.yarnpkg.com/camelcase/-/camelcase-2.1.1.tgz#7c1d16d679a1bbe59ca02cacecfb011e201f5a1f\"\n \n-camelcase@^4.0.0, camelcase@^4.1.0:\n-  version \"4.1.0\"\n-  resolved \"https://registry.yarnpkg.com/camelcase/-/camelcase-4.1.0.tgz#d545635be1e33c542649c69173e5de6acfae34dd\"\n+camelcase@^5.0.0, camelcase@^5.3.1:\n+  version \"5.3.1\"\n+  resolved \"https://registry.yarnpkg.com/camelcase/-/camelcase-5.3.1.tgz#e3c9b31569e106811df242f715725a1f4c494320\"\n+  integrity sha512-L28STB170nwWS63UjtlEOE3dldQApaJXZkOI1uMFfzf3rRuPegHaHesyee+YxQ+W6SvRDQV6UrdOdRiR153wJg==\n \n-capture-stack-trace@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/capture-stack-trace/-/capture-stack-trace-1.0.0.tgz#4a6fa07399c26bba47f0b2496b4d0fb408c5550d\"\n+canonicalize@^1.0.1:\n+  version \"1.0.8\"\n+  resolved \"https://registry.yarnpkg.com/canonicalize/-/canonicalize-1.0.8.tgz#24d1f1a00ed202faafd9bf8e63352cd4450c6df1\"\n+  integrity sha512-0CNTVCLZggSh7bc5VkX5WWPWO+cyZbNd07IHIsSXLia/eAq+r836hgk+8BKoEh7949Mda87VUOitx5OddVj64A==\n \n caseless@~0.12.0:\n   version \"0.12.0\"\n   resolved \"https://registry.yarnpkg.com/caseless/-/caseless-0.12.0.tgz#1b681c21ff84033c826543090689420d187151dc\"\n \n-chalk@^1.0.0:\n-  version \"1.1.3\"\n-  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-1.1.3.tgz#a8115c55e4a702fe4d150abd3872822a7e09fc98\"\n+chalk@^2.1.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-2.1.0.tgz#ac5becf14fa21b99c6c92ca7a7d7cfd5b17e743e\"\n   dependencies:\n-    ansi-styles \"^2.2.1\"\n-    escape-string-regexp \"^1.0.2\"\n-    has-ansi \"^2.0.0\"\n-    strip-ansi \"^3.0.0\"\n-    supports-color \"^2.0.0\"\n+    ansi-styles \"^3.1.0\"\n+    escape-string-regexp \"^1.0.5\"\n+    supports-color \"^4.0.0\"\n \n-chalk@^2.0.0:\n-  version \"2.4.1\"\n-  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-2.4.1.tgz#18c49ab16a037b6eb0152cc83e3471338215b66e\"\n-  integrity sha512-ObN6h1v2fTJSmUXoS3nMQ92LbDK9be4TV+6G+omQlGJFdcUX5heKi1LZ1YnRMIgwTLEj3E24bT6tYni50rlCfQ==\n+chalk@^2.4.2:\n+  version \"2.4.2\"\n+  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-2.4.2.tgz#cd42541677a54333cf541a49108c1432b44c9424\"\n+  integrity sha512-Mti+f9lpJNcwF4tWV8/OrTTtF1gZi+f8FqlyAdouralcFWFQWF2+NgCHShjkCb+IFBLq9buZwE1xckQU4peSuQ==\n   dependencies:\n     ansi-styles \"^3.2.1\"\n     escape-string-regexp \"^1.0.5\"\n     supports-color \"^5.3.0\"\n \n-chalk@^2.0.1, chalk@^2.1.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-2.1.0.tgz#ac5becf14fa21b99c6c92ca7a7d7cfd5b17e743e\"\n+chalk@^3.0.0:\n+  version \"3.0.0\"\n+  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-3.0.0.tgz#3f73c2bf526591f574cc492c51e2456349f844e4\"\n+  integrity sha512-4D3B6Wf41KOYRFdszmDqMCGq5VV/uMAB273JILmO+3jAlh8X4qDtdtgCR3fxtbLEMzSx22QdhnDcJvu2u1fVwg==\n   dependencies:\n-    ansi-styles \"^3.1.0\"\n-    escape-string-regexp \"^1.0.5\"\n-    supports-color \"^4.0.0\"\n+    ansi-styles \"^4.1.0\"\n+    supports-color \"^7.1.0\"\n \n-chardet@^0.4.0:\n-  version \"0.4.2\"\n-  resolved \"https://registry.yarnpkg.com/chardet/-/chardet-0.4.2.tgz#b5473b33dc97c424e5d98dc87d55d4d8a29c8bf2\"\n-  integrity sha1-tUc7M9yXxCTl2Y3IfVXU2KKci/I=\n+chalk@^4.1.0:\n+  version \"4.1.2\"\n+  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-4.1.2.tgz#aac4e2b7734a740867aeb16bf02aad556a1e7a01\"\n+  integrity sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==\n+  dependencies:\n+    ansi-styles \"^4.1.0\"\n+    supports-color \"^7.1.0\"\n+\n+chardet@^0.7.0:\n+  version \"0.7.0\"\n+  resolved \"https://registry.yarnpkg.com/chardet/-/chardet-0.7.0.tgz#90094849f0937f2eedc2425d0d28a9e5f0cbad9e\"\n+  integrity sha512-mT8iDcrh03qDGRRmoA2hmBJnxpllMR+0/0qlzjqZES6NdiWDcZkCNAk4rPFZ9Q85r27unkiNNg8ZOiwZXBHwcA==\n \n charenc@~0.0.1:\n   version \"0.0.2\"\n   resolved \"https://registry.yarnpkg.com/charenc/-/charenc-0.0.2.tgz#c0a1d2f3a7092e03774bfa83f14c0fc5790a8667\"\n   integrity sha1-wKHS86cJLgN3S/qD8UwPxXkKhmc=\n \n-chrome-devtools-frontend@1.0.401423:\n-  version \"1.0.401423\"\n-  resolved \"https://registry.yarnpkg.com/chrome-devtools-frontend/-/chrome-devtools-frontend-1.0.401423.tgz#32a89b8d04e378a494be3c8d63271703be1c04ea\"\n-\n-chrome-devtools-frontend@1.0.593291:\n-  version \"1.0.593291\"\n-  resolved \"https://registry.yarnpkg.com/chrome-devtools-frontend/-/chrome-devtools-frontend-1.0.593291.tgz#72ed2e488e4ab8c5df9f35a5ce6bb128eb3c5e74\"\n-  integrity sha512-rZYanFVohRHjYdFdbvmna/9yzA+PMYfjBqXaLfF6SxE9ZnmfuMhItHGqPXrUTvuv1IuqaD1FX51WmTFwa2zfUA==\n-\n-chrome-launcher@^0.10.5:\n-  version \"0.10.5\"\n-  resolved \"https://registry.yarnpkg.com/chrome-launcher/-/chrome-launcher-0.10.5.tgz#d0aa72c11f1653e6a60dfebea171522447470ef1\"\n-  integrity sha512-Gbzg8HlWhyuoVqflhiXwfFXhzNfNWvAkSWv2QR1Yl6mwsMo1oCLAVjp2tIySuS4lrZLEjzVx1fOy584yE76P4g==\n-  dependencies:\n-    \"@types/core-js\" \"^0.9.41\"\n-    \"@types/mkdirp\" \"^0.3.29\"\n-    \"@types/node\" \"^9.3.0\"\n-    \"@types/rimraf\" \"^0.0.28\"\n-    is-wsl \"^1.1.0\"\n-    lighthouse-logger \"^1.0.0\"\n-    mkdirp \"0.5.1\"\n-    rimraf \"^2.6.1\"\n-\n-chrome-launcher@^0.13.2:\n+chrome-launcher@^0.13.2, chrome-launcher@^0.13.4:\n   version \"0.13.4\"\n   resolved \"https://registry.yarnpkg.com/chrome-launcher/-/chrome-launcher-0.13.4.tgz#4c7d81333c98282899c4e38256da23e00ed32f73\"\n   integrity sha512-nnzXiDbGKjDSK6t2I+35OAPBy5Pw/39bgkb/ZAFwMhwJbdYBp6aH+vW28ZgtjdU890Q7D+3wN/tB8N66q5Gi2A==\n@@ -256,27 +280,33 @@ chrome-launcher@^0.13.2:\n     mkdirp \"^0.5.3\"\n     rimraf \"^3.0.2\"\n \n-cli-boxes@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/cli-boxes/-/cli-boxes-1.0.0.tgz#4fa917c3e59c94a004cd61f8ee509da651687143\"\n+ci-info@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/ci-info/-/ci-info-2.0.0.tgz#67a9e964be31a51e15e5010d58e6f12834002f46\"\n+  integrity sha512-5tK7EtrZ0N+OLFMthtqOj4fI2Jeb88C4CAZPu25LDVUgXJ0A3Js4PMGqrn0JU1W0Mh1/Z8wZzYPxqUrXeBboCQ==\n \n-cli-cursor@^2.1.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/cli-cursor/-/cli-cursor-2.1.0.tgz#b35dac376479facc3e94747d41d0d0f5238ffcb5\"\n-  integrity sha1-s12sN2R5+sw+lHR9QdDQ9SOP/LU=\n+cli-boxes@^2.2.0:\n+  version \"2.2.1\"\n+  resolved \"https://registry.yarnpkg.com/cli-boxes/-/cli-boxes-2.2.1.tgz#ddd5035d25094fce220e9cab40a45840a440318f\"\n+  integrity sha512-y4coMcylgSCdVinjiDBuR8PCC2bLjyGTwEmPb9NHR/QaNU6EUOXcTY/s6VjGMD6ENSEaeQYHCY0GNGS5jfMwPw==\n+\n+cli-cursor@^3.1.0:\n+  version \"3.1.0\"\n+  resolved \"https://registry.yarnpkg.com/cli-cursor/-/cli-cursor-3.1.0.tgz#264305a7ae490d1d03bf0c9ba7c925d1753af307\"\n+  integrity sha512-I/zHAwsKf9FqGoXM4WWRACob9+SNukZTd94DWF57E4toouRulbCxcUh6RKUEOQlYTHJnzkPMySvPNaaSLNfLZw==\n   dependencies:\n-    restore-cursor \"^2.0.0\"\n+    restore-cursor \"^3.1.0\"\n \n cli-table@^0.3.1:\n   version \"0.3.1\"\n   resolved \"https://registry.yarnpkg.com/cli-table/-/cli-table-0.3.1.tgz#f53b05266a8b1a0b934b3d0821e6e2dc5914ae23\"\n   dependencies:\n     colors \"1.0.3\"\n \n-cli-width@^2.0.0:\n-  version \"2.2.0\"\n-  resolved \"https://registry.yarnpkg.com/cli-width/-/cli-width-2.2.0.tgz#ff19ede8a9a5e579324147b0c11f0fbcbabed639\"\n-  integrity sha1-/xnt6Kml5XkyQUewwR8PvLq+1jk=\n+cli-width@^3.0.0:\n+  version \"3.0.0\"\n+  resolved \"https://registry.yarnpkg.com/cli-width/-/cli-width-3.0.0.tgz#a2f48437a2caa9a22436e794bf071ec9e61cedf6\"\n+  integrity sha512-FxqpkPPwu1HjuN93Omfm4h8uIanXofW0RxVEW3k5RKx+mJJYSthzNhp32Kzxxy3YAEZ/Dc/EWN1vZRY0+kOhbw==\n \n cliui@^3.0.3:\n   version \"3.2.0\"\n@@ -286,6 +316,13 @@ cliui@^3.0.3:\n     strip-ansi \"^3.0.1\"\n     wrap-ansi \"^2.0.0\"\n \n+clone-response@^1.0.2:\n+  version \"1.0.3\"\n+  resolved \"https://registry.yarnpkg.com/clone-response/-/clone-response-1.0.3.tgz#af2032aa47816399cf5f0a1d0db902f517abb8c3\"\n+  integrity sha512-ROoL94jJH2dUVML2Y/5PEDNaSHgeOdSDicUyS7izcF63G6sTc/FTjLub4b8Il9S8S0beOfYt0TaA5qvFK+w0wA==\n+  dependencies:\n+    mimic-response \"^1.0.0\"\n+\n co@^4.6.0:\n   version \"4.6.0\"\n   resolved \"https://registry.yarnpkg.com/co/-/co-4.6.0.tgz#6ea6bdf3d853ae54ccb8e47bfa0bf3f9031fb184\"\n@@ -300,10 +337,22 @@ color-convert@^1.9.0:\n   dependencies:\n     color-name \"^1.1.1\"\n \n+color-convert@^2.0.1:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/color-convert/-/color-convert-2.0.1.tgz#72d3a68d598c9bdb3af2ad1e84f21d896abd4de3\"\n+  integrity sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==\n+  dependencies:\n+    color-name \"~1.1.4\"\n+\n color-name@^1.1.1:\n   version \"1.1.3\"\n   resolved \"https://registry.yarnpkg.com/color-name/-/color-name-1.1.3.tgz#a7d0558bd89c42f795dd42328f740831ca53bc25\"\n \n+color-name@~1.1.4:\n+  version \"1.1.4\"\n+  resolved \"https://registry.yarnpkg.com/color-name/-/color-name-1.1.4.tgz#c2a09a87acbde69543de6f63fa3995c826c536a2\"\n+  integrity sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==\n+\n colors@1.0.3:\n   version \"1.0.3\"\n   resolved \"https://registry.yarnpkg.com/colors/-/colors-1.0.3.tgz#0433f44d809680fdeb60ed260f1b0c262e82a40b\"\n@@ -314,32 +363,28 @@ combined-stream@^1.0.5, combined-stream@~1.0.5:\n   dependencies:\n     delayed-stream \"~1.0.0\"\n \n+combined-stream@^1.0.6, combined-stream@~1.0.6:\n+  version \"1.0.8\"\n+  resolved \"https://registry.yarnpkg.com/combined-stream/-/combined-stream-1.0.8.tgz#c3d45a8b34fd730631a110a8a2520682b31d5a7f\"\n+  integrity sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==\n+  dependencies:\n+    delayed-stream \"~1.0.0\"\n+\n concat-map@0.0.1:\n   version \"0.0.1\"\n   resolved \"https://registry.yarnpkg.com/concat-map/-/concat-map-0.0.1.tgz#d8a96bd77fd68df7793a73036a3ba0d5405d477b\"\n \n-configstore@^3.0.0:\n-  version \"3.1.1\"\n-  resolved \"https://registry.yarnpkg.com/configstore/-/configstore-3.1.1.tgz#094ee662ab83fad9917678de114faaea8fcdca90\"\n-  dependencies:\n-    dot-prop \"^4.1.0\"\n-    graceful-fs \"^4.1.2\"\n-    make-dir \"^1.0.0\"\n-    unique-string \"^1.0.0\"\n-    write-file-atomic \"^2.0.0\"\n-    xdg-basedir \"^3.0.0\"\n-\n-configstore@^3.1.1:\n-  version \"3.1.2\"\n-  resolved \"https://registry.yarnpkg.com/configstore/-/configstore-3.1.2.tgz#c6f25defaeef26df12dd33414b001fe81a543f8f\"\n-  integrity sha512-vtv5HtGjcYUgFrXc6Kx747B83MRRVS5R1VTEQoXvuP+kMI+if6uywV0nDGoiydJRy4yk7h9od5Og0kxx4zUXmw==\n+configstore@^5.0.1:\n+  version \"5.0.1\"\n+  resolved \"https://registry.yarnpkg.com/configstore/-/configstore-5.0.1.tgz#d365021b5df4b98cdd187d6a3b0e3f6a7cc5ed96\"\n+  integrity sha512-aMKprgk5YhBNyH25hj8wGt2+D52Sw1DRRIzqBwLp2Ya9mFmY8KPvvtvmna8SxVR9JMZ4kzMD68N22vlaRpkeFA==\n   dependencies:\n-    dot-prop \"^4.1.0\"\n+    dot-prop \"^5.2.0\"\n     graceful-fs \"^4.1.2\"\n-    make-dir \"^1.0.0\"\n-    unique-string \"^1.0.0\"\n-    write-file-atomic \"^2.0.0\"\n-    xdg-basedir \"^3.0.0\"\n+    make-dir \"^3.0.0\"\n+    unique-string \"^2.0.0\"\n+    write-file-atomic \"^3.0.0\"\n+    xdg-basedir \"^4.0.0\"\n \n console-control-strings@^1.0.0, console-control-strings@~1.1.0:\n   version \"1.1.0\"\n@@ -358,20 +403,6 @@ corser@~2.0.0:\n   version \"2.0.1\"\n   resolved \"https://registry.yarnpkg.com/corser/-/corser-2.0.1.tgz#8eda252ecaab5840dcd975ceb90d9370c819ff87\"\n \n-create-error-class@^3.0.0:\n-  version \"3.0.2\"\n-  resolved \"https://registry.yarnpkg.com/create-error-class/-/create-error-class-3.0.2.tgz#06be7abef947a3f14a30fd610671d401bca8b7b6\"\n-  dependencies:\n-    capture-stack-trace \"^1.0.0\"\n-\n-cross-spawn@^5.0.1:\n-  version \"5.1.0\"\n-  resolved \"https://registry.yarnpkg.com/cross-spawn/-/cross-spawn-5.1.0.tgz#e8bd0efee58fcff6f8f94510a0a554bbfa235449\"\n-  dependencies:\n-    lru-cache \"^4.0.1\"\n-    shebang-command \"^1.2.0\"\n-    which \"^1.2.9\"\n-\n crypt@~0.0.1:\n   version \"0.0.2\"\n   resolved \"https://registry.yarnpkg.com/crypt/-/crypt-0.0.2.tgz#88d7ff7ec0dfb86f713dc87bbb42d044d3e6c41b\"\n@@ -383,19 +414,20 @@ cryptiles@2.x.x:\n   dependencies:\n     boom \"2.x.x\"\n \n-crypto-random-string@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/crypto-random-string/-/crypto-random-string-1.0.0.tgz#a230f64f568310e1498009940790ec99545bca7e\"\n+crypto-random-string@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/crypto-random-string/-/crypto-random-string-2.0.0.tgz#ef2a7a966ec11083388369baa02ebead229b30d5\"\n+  integrity sha512-v1plID3y9r/lPhviJ1wrXpLeyUIGAZ2SHNYTEapm7/8A9nLPoyvVp3RK/EPFqn5kEznyWgYZNsRtYYIWbuG8KA==\n \n cssom@0.3.x:\n   version \"0.3.4\"\n   resolved \"https://registry.yarnpkg.com/cssom/-/cssom-0.3.4.tgz#8cd52e8a3acfd68d3aed38ee0a640177d2f9d797\"\n   integrity sha512-+7prCSORpXNeR4/fUP3rL+TzqtiFfhMvTd7uEqMdgPvLPt4+uzFUeufx5RHjGTACCargg/DiEt/moMQmvnfkog==\n \n-cssstyle@1.1.1:\n-  version \"1.1.1\"\n-  resolved \"https://registry.yarnpkg.com/cssstyle/-/cssstyle-1.1.1.tgz#18b038a9c44d65f7a8e428a653b9f6fe42faf5fb\"\n-  integrity sha512-364AI1l/M5TYcFH83JnOH/pSqgaNnKmYgKrm0didZMGKWjQB60dymwWy1rKUgL3J1ffdq9xVi2yGLHdSjjSNog==\n+cssstyle@1.2.1:\n+  version \"1.2.1\"\n+  resolved \"https://registry.yarnpkg.com/cssstyle/-/cssstyle-1.2.1.tgz#3aceb2759eaf514ac1a21628d723d6043a819495\"\n+  integrity sha512-7DYm8qe+gPx/h77QlCyFmX80+fGaE/6A/Ekl0zaszYOubvySO2saYFdQ78P29D0UsULxFKCetDGNaNRUdSF+2A==\n   dependencies:\n     cssom \"0.3.x\"\n \n@@ -411,21 +443,38 @@ debug@^2.2.0:\n   dependencies:\n     ms \"2.0.0\"\n \n-debug@^2.6.8:\n+debug@^2.6.8, debug@^2.6.9:\n   version \"2.6.9\"\n   resolved \"https://registry.yarnpkg.com/debug/-/debug-2.6.9.tgz#5d128515df134ff327e90a4c93f4e077a536341f\"\n   integrity sha512-bC7ElrdJaJnPbAP+1EotYvqZsb3ecl5wi6Bfi6BJTUcNowp6cvspg0jXznRTKDjm/E7AdgFBVeAPVMNcKGsHMA==\n   dependencies:\n     ms \"2.0.0\"\n \n-decamelize@^1.1.1:\n+decamelize@^1.1.1, decamelize@^1.2.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/decamelize/-/decamelize-1.2.0.tgz#f6534d15148269b20352e7bee26f501f9a191290\"\n \n+decompress-response@^3.3.0:\n+  version \"3.3.0\"\n+  resolved \"https://registry.yarnpkg.com/decompress-response/-/decompress-response-3.3.0.tgz#80a4dd323748384bfa248083622aedec982adff3\"\n+  integrity sha512-BzRPQuY1ip+qDonAOz42gRm/pg9F768C+npV/4JOsxRC2sq+Rlk+Q4ZCAsOhnIaMrgarILY+RMUIvMmmX1qAEA==\n+  dependencies:\n+    mimic-response \"^1.0.0\"\n+\n+deep-extend@^0.6.0:\n+  version \"0.6.0\"\n+  resolved \"https://registry.yarnpkg.com/deep-extend/-/deep-extend-0.6.0.tgz#c4fa7c95404a17a9c3e8ca7e1537312b736330ac\"\n+  integrity sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA==\n+\n deep-extend@~0.4.0:\n   version \"0.4.2\"\n   resolved \"https://registry.yarnpkg.com/deep-extend/-/deep-extend-0.4.2.tgz#48b699c27e334bf89f10892be432f6e4c7d34a7f\"\n \n+defer-to-connect@^1.0.1:\n+  version \"1.1.3\"\n+  resolved \"https://registry.yarnpkg.com/defer-to-connect/-/defer-to-connect-1.1.3.tgz#331ae050c08dcf789f8c83a7b81f0ed94f4ac591\"\n+  integrity sha512-0ISdNousHvZT2EiFlZeZAHBUvSxmKswVCEf8hW7KWgG4a8MVEu/3Vb6uWYozkjylyCxe0JBIiRB1jV45S70WVQ==\n+\n delayed-stream@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/delayed-stream/-/delayed-stream-1.0.0.tgz#df3ae199acadfb7d440aaae0b29e2272b24ec619\"\n@@ -434,18 +483,17 @@ delegates@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/delegates/-/delegates-1.0.0.tgz#84c6e159b81904fdca59a0ef44cd870d31250f9a\"\n \n-devtools-timeline-model@1.1.6:\n-  version \"1.1.6\"\n-  resolved \"https://registry.yarnpkg.com/devtools-timeline-model/-/devtools-timeline-model-1.1.6.tgz#7be51a73b55d727b597bb30dd1ed2e8e210639a5\"\n-  dependencies:\n-    chrome-devtools-frontend \"1.0.401423\"\n-    resolve \"1.1.7\"\n+details-element-polyfill@^2.4.0:\n+  version \"2.4.0\"\n+  resolved \"https://registry.yarnpkg.com/details-element-polyfill/-/details-element-polyfill-2.4.0.tgz#e0622adef7902662faf27b4ab8acba5dc4e3a6e6\"\n+  integrity sha512-jnZ/m0+b1gz3EcooitqL7oDEkKHEro659dt8bWB/T/HjiILucoQhHvvi5MEOAIFJXxxO+rIYJ/t3qCgfUOSU5g==\n \n-dot-prop@^4.1.0:\n-  version \"4.2.0\"\n-  resolved \"https://registry.yarnpkg.com/dot-prop/-/dot-prop-4.2.0.tgz#1f19e0c2e1aa0e32797c49799f2837ac6af69c57\"\n+dot-prop@^5.2.0:\n+  version \"5.3.0\"\n+  resolved \"https://registry.yarnpkg.com/dot-prop/-/dot-prop-5.3.0.tgz#90ccce708cd9cd82cc4dc8c3ddd9abdd55b20e88\"\n+  integrity sha512-QM8q3zDe58hqUqjraQOmzZ1LIH9SWQJTlEKCH4kJ2oQvLZk7RbQXvtDM2XEq3fwkV9CCvvH4LA0AV+ogFsBM2Q==\n   dependencies:\n-    is-obj \"^1.0.0\"\n+    is-obj \"^2.0.0\"\n \n duplexer3@^0.1.4:\n   version \"0.1.4\"\n@@ -467,52 +515,67 @@ ecstatic@^2.0.0:\n     minimist \"^1.1.0\"\n     url-join \"^2.0.2\"\n \n-escape-string-regexp@^1.0.2, escape-string-regexp@^1.0.5:\n+emoji-regex@^8.0.0:\n+  version \"8.0.0\"\n+  resolved \"https://registry.yarnpkg.com/emoji-regex/-/emoji-regex-8.0.0.tgz#e818fd69ce5ccfcb404594f842963bf53164cc37\"\n+  integrity sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==\n+\n+end-of-stream@^1.1.0:\n+  version \"1.4.4\"\n+  resolved \"https://registry.yarnpkg.com/end-of-stream/-/end-of-stream-1.4.4.tgz#5ae64a5f45057baf3626ec14da0ca5e4b2431eb0\"\n+  integrity sha512-+uw1inIHVPQoaVuHzRyXd21icM+cnt4CzD5rW+NC1wjOUSTOs+Te7FOv7AhN7vS9x/oIyhLP5PR1H+phQAHu5Q==\n+  dependencies:\n+    once \"^1.4.0\"\n+\n+escape-goat@^2.0.0:\n+  version \"2.1.1\"\n+  resolved \"https://registry.yarnpkg.com/escape-goat/-/escape-goat-2.1.1.tgz#1b2dc77003676c457ec760b2dc68edb648188675\"\n+  integrity sha512-8/uIhbG12Csjy2JEW7D9pHbreaVaS/OpN3ycnyvElTdwM5n6GY6W6e2IPemfvGZeUMqZ9A/3GqIZMgKnBhAw/Q==\n+\n+escape-string-regexp@^1.0.5:\n   version \"1.0.5\"\n   resolved \"https://registry.yarnpkg.com/escape-string-regexp/-/escape-string-regexp-1.0.5.tgz#1b61c0562190a8dff6ae3bb2cf0200ca130b86d4\"\n \n-esprima@^4.0.1:\n-  version \"4.0.1\"\n-  resolved \"https://registry.yarnpkg.com/esprima/-/esprima-4.0.1.tgz#13b04cdb3e6c5d19df91ab6987a8695619b0aa71\"\n-  integrity sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==\n-\n eventemitter3@1.x.x:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/eventemitter3/-/eventemitter3-1.2.0.tgz#1c86991d816ad1e504750e73874224ecf3bec508\"\n \n-execa@^0.7.0:\n-  version \"0.7.0\"\n-  resolved \"https://registry.yarnpkg.com/execa/-/execa-0.7.0.tgz#944becd34cc41ee32a63a9faf27ad5a65fc59777\"\n-  dependencies:\n-    cross-spawn \"^5.0.1\"\n-    get-stream \"^3.0.0\"\n-    is-stream \"^1.1.0\"\n-    npm-run-path \"^2.0.0\"\n-    p-finally \"^1.0.0\"\n-    signal-exit \"^3.0.0\"\n-    strip-eof \"^1.0.0\"\n-\n extend@~3.0.0:\n   version \"3.0.1\"\n   resolved \"https://registry.yarnpkg.com/extend/-/extend-3.0.1.tgz#a755ea7bc1adfcc5a31ce7e762dbaadc5e636444\"\n \n-external-editor@^2.0.4:\n-  version \"2.2.0\"\n-  resolved \"https://registry.yarnpkg.com/external-editor/-/external-editor-2.2.0.tgz#045511cfd8d133f3846673d1047c154e214ad3d5\"\n-  integrity sha512-bSn6gvGxKt+b7+6TKEv1ZycHleA7aHhRHyAqJyp5pbUFuYYNIzpZnQDk7AsYckyWdEnTeAnay0aCy2aV6iTk9A==\n+extend@~3.0.2:\n+  version \"3.0.2\"\n+  resolved \"https://registry.yarnpkg.com/extend/-/extend-3.0.2.tgz#f8b1136b4071fbd8eb140aff858b1019ec2915fa\"\n+  integrity sha512-fjquC59cD7CyW6urNXK0FBufkZcoiGG80wTuPujX590cB5Ttln20E2UB4S/WARVqhXffZl2LNgS+gQdPIIim/g==\n+\n+external-editor@^3.0.3:\n+  version \"3.1.0\"\n+  resolved \"https://registry.yarnpkg.com/external-editor/-/external-editor-3.1.0.tgz#cb03f740befae03ea4d283caed2741a83f335495\"\n+  integrity sha512-hMQ4CX1p1izmuLYyZqLMO/qGNw10wSv9QDCPfzXfyFrOaCSSoRfqE1Kf1s5an66J5JZC62NewG+mK49jOCtQew==\n   dependencies:\n-    chardet \"^0.4.0\"\n-    iconv-lite \"^0.4.17\"\n+    chardet \"^0.7.0\"\n+    iconv-lite \"^0.4.24\"\n     tmp \"^0.0.33\"\n \n extsprintf@1.3.0, extsprintf@^1.2.0:\n   version \"1.3.0\"\n   resolved \"https://registry.yarnpkg.com/extsprintf/-/extsprintf-1.3.0.tgz#96918440e3041a7a414f8c52e3c574eb3c3e1e05\"\n \n-figures@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/figures/-/figures-2.0.0.tgz#3ab1a2d2a62c8bfb431a0c94cb797a2fce27c962\"\n-  integrity sha1-OrGi0qYsi/tDGgyUy3l6L84nyWI=\n+fast-deep-equal@^3.1.1:\n+  version \"3.1.3\"\n+  resolved \"https://registry.yarnpkg.com/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz#3a7d56b559d6cbc3eb512325244e619a65c6c525\"\n+  integrity sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==\n+\n+fast-json-stable-stringify@^2.0.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz#874bf69c6f404c2b5d99c481341399fd55892633\"\n+  integrity sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==\n+\n+figures@^3.0.0:\n+  version \"3.2.0\"\n+  resolved \"https://registry.yarnpkg.com/figures/-/figures-3.2.0.tgz#625c18bd293c604dc4a8ddb2febf0c88341746af\"\n+  integrity sha512-yaduQFRKLXYOGgEn6AZau90j3ggSOyiqXU0F9JZfeXYhNa+Jk4X+s45A2zg5jns87GAFa34BBm2kXw4XpNcbdg==\n   dependencies:\n     escape-string-regexp \"^1.0.5\"\n \n@@ -528,6 +591,15 @@ form-data@~2.1.1:\n     combined-stream \"^1.0.5\"\n     mime-types \"^2.1.12\"\n \n+form-data@~2.3.2:\n+  version \"2.3.3\"\n+  resolved \"https://registry.yarnpkg.com/form-data/-/form-data-2.3.3.tgz#dcce52c05f644f298c6a7ab936bd724ceffbf3a6\"\n+  integrity sha512-1lLKB2Mu3aGP1Q/2eCOx0fNbRMe7XdwktwOruhfqqd0rIJWwN4Dh+E3hrPSlDCXnSR7UtZ1N38rVXm+6+MEhJQ==\n+  dependencies:\n+    asynckit \"^0.4.0\"\n+    combined-stream \"^1.0.6\"\n+    mime-types \"^2.1.12\"\n+\n fs-extra@~0.26.2:\n   version \"0.26.7\"\n   resolved \"https://registry.yarnpkg.com/fs-extra/-/fs-extra-0.26.7.tgz#9ae1fdd94897798edab76d0918cf42d0c3184fa9\"\n@@ -572,9 +644,19 @@ gauge@~2.7.3:\n     strip-ansi \"^3.0.1\"\n     wide-align \"^1.1.0\"\n \n-get-stream@^3.0.0:\n-  version \"3.0.0\"\n-  resolved \"https://registry.yarnpkg.com/get-stream/-/get-stream-3.0.0.tgz#8e943d1358dc37555054ecbe2edb05aa174ede14\"\n+get-stream@^4.1.0:\n+  version \"4.1.0\"\n+  resolved \"https://registry.yarnpkg.com/get-stream/-/get-stream-4.1.0.tgz#c1b255575f3dc21d59bfc79cd3d2b46b1c3a54b5\"\n+  integrity sha512-GMat4EJ5161kIy2HevLlr4luNjBgvmj413KaQA7jt4V8B4RDsfpHk7WQ9GVqfYyyx8OS/L66Kox+rJRNklLK7w==\n+  dependencies:\n+    pump \"^3.0.0\"\n+\n+get-stream@^5.1.0:\n+  version \"5.2.0\"\n+  resolved \"https://registry.yarnpkg.com/get-stream/-/get-stream-5.2.0.tgz#4966a1795ee5ace65e706c4b7beb71257d6e22d3\"\n+  integrity sha512-nBF+F1rAZVCu/p7rjzgA+Yb4lfYXrpl7a6VmJrU8wF9I1CKvP/QwPNZHnOlwbTkY6dvtFIzFMSyQXbLoTQPRpA==\n+  dependencies:\n+    pump \"^3.0.0\"\n \n getpass@^0.1.1:\n   version \"0.1.7\"\n@@ -605,42 +687,57 @@ glob@^7.1.3:\n     once \"^1.3.0\"\n     path-is-absolute \"^1.0.0\"\n \n-got@^6.7.1:\n-  version \"6.7.1\"\n-  resolved \"https://registry.yarnpkg.com/got/-/got-6.7.1.tgz#240cd05785a9a18e561dc1b44b41c763ef1e8db0\"\n+global-dirs@^2.0.1:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/global-dirs/-/global-dirs-2.1.0.tgz#e9046a49c806ff04d6c1825e196c8f0091e8df4d\"\n+  integrity sha512-MG6kdOUh/xBnyo9cJFeIKkLEc1AyFq42QTU4XiX51i2NEdxLxLWXIjEjmqKeSuKR7pAZjTqUVoT2b2huxVLgYQ==\n   dependencies:\n-    create-error-class \"^3.0.0\"\n-    duplexer3 \"^0.1.4\"\n-    get-stream \"^3.0.0\"\n-    is-redirect \"^1.0.0\"\n-    is-retry-allowed \"^1.0.0\"\n-    is-stream \"^1.0.0\"\n-    lowercase-keys \"^1.0.0\"\n-    safe-buffer \"^5.0.1\"\n-    timed-out \"^4.0.0\"\n-    unzip-response \"^2.0.1\"\n-    url-parse-lax \"^1.0.0\"\n+    ini \"1.3.7\"\n \n-graceful-fs@^4.1.11, graceful-fs@^4.1.2, graceful-fs@^4.1.6, graceful-fs@^4.1.9:\n+got@^9.6.0:\n+  version \"9.6.0\"\n+  resolved \"https://registry.yarnpkg.com/got/-/got-9.6.0.tgz#edf45e7d67f99545705de1f7bbeeeb121765ed85\"\n+  integrity sha512-R7eWptXuGYxwijs0eV+v3o6+XH1IqVK8dJOEecQfTmkncw9AV4dcw/Dhxi8MdlqPthxxpZyizMzyg8RTmEsG+Q==\n+  dependencies:\n+    \"@sindresorhus/is\" \"^0.14.0\"\n+    \"@szmarczak/http-timer\" \"^1.1.2\"\n+    cacheable-request \"^6.0.0\"\n+    decompress-response \"^3.3.0\"\n+    duplexer3 \"^0.1.4\"\n+    get-stream \"^4.1.0\"\n+    lowercase-keys \"^1.0.1\"\n+    mimic-response \"^1.0.1\"\n+    p-cancelable \"^1.0.0\"\n+    to-readable-stream \"^1.0.0\"\n+    url-parse-lax \"^3.0.0\"\n+\n+graceful-fs@^4.1.2, graceful-fs@^4.1.6, graceful-fs@^4.1.9:\n   version \"4.1.11\"\n   resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.1.11.tgz#0e8bdfe4d1ddb8854d64e04ea7c00e2a026e5658\"\n \n har-schema@^1.0.5:\n   version \"1.0.5\"\n   resolved \"https://registry.yarnpkg.com/har-schema/-/har-schema-1.0.5.tgz#d263135f43307c02c602afc8fe95970c0151369e\"\n \n+har-schema@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/har-schema/-/har-schema-2.0.0.tgz#a94c2224ebcac04782a0d9035521f24735b7ec92\"\n+  integrity sha512-Oqluz6zhGX8cyRaTQlFMPw80bSJVG2x/cFb8ZPhUILGgHka9SsokCCOQgpveePerqidZOrT14ipqfJb7ILcW5Q==\n+\n har-validator@~4.2.1:\n   version \"4.2.1\"\n   resolved \"https://registry.yarnpkg.com/har-validator/-/har-validator-4.2.1.tgz#33481d0f1bbff600dd203d75812a6a5fba002e2a\"\n   dependencies:\n     ajv \"^4.9.1\"\n     har-schema \"^1.0.5\"\n \n-has-ansi@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/has-ansi/-/has-ansi-2.0.0.tgz#34f5049ce1ecdf2b0649af3ef24e45ed35416d91\"\n+har-validator@~5.1.3:\n+  version \"5.1.5\"\n+  resolved \"https://registry.yarnpkg.com/har-validator/-/har-validator-5.1.5.tgz#1f0803b9f8cb20c0fa13822df1ecddb36bde1efd\"\n+  integrity sha512-nmT2T0lljbxdQZfspsno9hgrG3Uir6Ks5afism62poxqBM6sDnMEuPmzTq8XN0OEwqKLLdh1jQI3qyE66Nzb3w==\n   dependencies:\n-    ansi-regex \"^2.0.0\"\n+    ajv \"^6.12.3\"\n+    har-schema \"^2.0.0\"\n \n has-flag@^2.0.0:\n   version \"2.0.0\"\n@@ -651,10 +748,20 @@ has-flag@^3.0.0:\n   resolved \"https://registry.yarnpkg.com/has-flag/-/has-flag-3.0.0.tgz#b5d454dc2199ae225699f3467e5a07f3b955bafd\"\n   integrity sha1-tdRU3CGZriJWmfNGfloH87lVuv0=\n \n+has-flag@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/has-flag/-/has-flag-4.0.0.tgz#944771fd9c81c81265c4d6941860da06bb59479b\"\n+  integrity sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==\n+\n has-unicode@^2.0.0:\n   version \"2.0.1\"\n   resolved \"https://registry.yarnpkg.com/has-unicode/-/has-unicode-2.0.1.tgz#e0e6fe6a28cf51138855e086d1691e771de2a8b9\"\n \n+has-yarn@^2.1.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/has-yarn/-/has-yarn-2.1.0.tgz#137e11354a7b5bf11aa5cb649cf0c6f3ff2b2e77\"\n+  integrity sha512-UqBRqi4ju7T+TqGNdqAO0PaSVGsDGJUBQvk9eUWNGRY1CFGDzYhLWoM7JQEemnlvVcv/YEmc2wNW8BC24EnUsw==\n+\n hawk@~3.1.3:\n   version \"3.1.3\"\n   resolved \"https://registry.yarnpkg.com/hawk/-/hawk-3.1.3.tgz#078444bd7c1640b0fe540d2c9b73d59678e8e1c4\"\n@@ -673,6 +780,11 @@ hoek@2.x.x:\n   version \"2.16.3\"\n   resolved \"https://registry.yarnpkg.com/hoek/-/hoek-2.16.3.tgz#20bb7403d3cea398e91dc4710a8ff1b8274a25ed\"\n \n+http-cache-semantics@^4.0.0:\n+  version \"4.1.1\"\n+  resolved \"https://registry.yarnpkg.com/http-cache-semantics/-/http-cache-semantics-4.1.1.tgz#abe02fcb2985460bf0323be664436ec3476a6d5a\"\n+  integrity sha512-er295DKPVsV82j5kw1Gjt+ADA/XYHsajl82cGNQG2eyoPkvgUhX+nDIyelzhIWbbsXP39EHcI6l5tYs2FYqYXQ==\n+\n http-link-header@^0.8.0:\n   version \"0.8.0\"\n   resolved \"https://registry.yarnpkg.com/http-link-header/-/http-link-header-0.8.0.tgz#a22b41a0c9b1e2d8fac1bf1b697c6bd532d5f5e4\"\n@@ -706,11 +818,20 @@ http-signature@~1.1.0:\n     jsprim \"^1.2.2\"\n     sshpk \"^1.7.0\"\n \n+http-signature@~1.2.0:\n+  version \"1.2.0\"\n+  resolved \"https://registry.yarnpkg.com/http-signature/-/http-signature-1.2.0.tgz#9aecd925114772f3d95b65a60abb8f7c18fbace1\"\n+  integrity sha512-CAbnr6Rz4CYQkLYUtSNXxQPUH2gK8f3iWexVlsnMeD+GjlsQ0Xsy1cOX+mN3dtxYomRy21CiOzU8Uhw6OwncEQ==\n+  dependencies:\n+    assert-plus \"^1.0.0\"\n+    jsprim \"^1.2.2\"\n+    sshpk \"^1.7.0\"\n+\n http2@^3.3.6:\n   version \"3.3.6\"\n   resolved \"https://registry.yarnpkg.com/http2/-/http2-3.3.6.tgz#7df06227e02b5b5a5841deea08239b3198d04bec\"\n \n-iconv-lite@^0.4.17:\n+iconv-lite@^0.4.24:\n   version \"0.4.24\"\n   resolved \"https://registry.yarnpkg.com/iconv-lite/-/iconv-lite-0.4.24.tgz#2022b4b25fbddc21d2f524974a474aafe733908b\"\n   integrity sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==\n@@ -740,41 +861,55 @@ inherits@2, inherits@~2.0.0, inherits@~2.0.3:\n   version \"2.0.3\"\n   resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.3.tgz#633c2c83e3da42a502f52466022480f4208261de\"\n \n+ini@1.3.7:\n+  version \"1.3.7\"\n+  resolved \"https://registry.yarnpkg.com/ini/-/ini-1.3.7.tgz#a09363e1911972ea16d7a8851005d84cf09a9a84\"\n+  integrity sha512-iKpRpXP+CrP2jyrxvg1kMUpXDyRUFDWurxbnVT1vQPx+Wz9uCYsMIqYuSBLV+PAaZG/d7kRLKRFc9oDMsH+mFQ==\n+\n ini@~1.3.0:\n   version \"1.3.4\"\n   resolved \"https://registry.yarnpkg.com/ini/-/ini-1.3.4.tgz#0537cb79daf59b59a1a517dff706c86ec039162e\"\n \n-inquirer@^3.3.0:\n-  version \"3.3.0\"\n-  resolved \"https://registry.yarnpkg.com/inquirer/-/inquirer-3.3.0.tgz#9dd2f2ad765dcab1ff0443b491442a20ba227dc9\"\n-  integrity sha512-h+xtnyk4EwKvFWHrUYsWErEVR+igKtLdchu+o0Z1RL7VU/jVMFbYir2bp6bAj8efFNxWqHX0dIss6fJQ+/+qeQ==\n-  dependencies:\n-    ansi-escapes \"^3.0.0\"\n-    chalk \"^2.0.0\"\n-    cli-cursor \"^2.1.0\"\n-    cli-width \"^2.0.0\"\n-    external-editor \"^2.0.4\"\n-    figures \"^2.0.0\"\n-    lodash \"^4.3.0\"\n-    mute-stream \"0.0.7\"\n-    run-async \"^2.2.0\"\n-    rx-lite \"^4.0.8\"\n-    rx-lite-aggregates \"^4.0.8\"\n-    string-width \"^2.1.0\"\n-    strip-ansi \"^4.0.0\"\n+inquirer@^7.3.3:\n+  version \"7.3.3\"\n+  resolved \"https://registry.yarnpkg.com/inquirer/-/inquirer-7.3.3.tgz#04d176b2af04afc157a83fd7c100e98ee0aad003\"\n+  integrity sha512-JG3eIAj5V9CwcGvuOmoo6LB9kbAYT8HXffUl6memuszlwDC/qvFAJw49XJ5NROSFNPxp3iQg1GqkFhaY/CR0IA==\n+  dependencies:\n+    ansi-escapes \"^4.2.1\"\n+    chalk \"^4.1.0\"\n+    cli-cursor \"^3.1.0\"\n+    cli-width \"^3.0.0\"\n+    external-editor \"^3.0.3\"\n+    figures \"^3.0.0\"\n+    lodash \"^4.17.19\"\n+    mute-stream \"0.0.8\"\n+    run-async \"^2.4.0\"\n+    rxjs \"^6.6.0\"\n+    string-width \"^4.1.0\"\n+    strip-ansi \"^6.0.0\"\n     through \"^2.3.6\"\n \n-intl-messageformat-parser@1.4.0, intl-messageformat-parser@^1.4.0:\n-  version \"1.4.0\"\n-  resolved \"https://registry.yarnpkg.com/intl-messageformat-parser/-/intl-messageformat-parser-1.4.0.tgz#b43d45a97468cadbe44331d74bb1e8dea44fc075\"\n-  integrity sha1-tD1FqXRoytvkQzHXS7Ho3qRPwHU=\n+intl-messageformat-parser@^1.8.1:\n+  version \"1.8.1\"\n+  resolved \"https://registry.yarnpkg.com/intl-messageformat-parser/-/intl-messageformat-parser-1.8.1.tgz#0eb14c5618333be4c95c409457b66c8c33ddcc01\"\n+  integrity sha512-IMSCKVf0USrM/959vj3xac7s8f87sc+80Y/ipBzdKy4ifBv5Gsj2tZ41EAaURVg01QU71fYr77uA8Meh6kELbg==\n \n-intl-messageformat@^2.2.0:\n-  version \"2.2.0\"\n-  resolved \"https://registry.yarnpkg.com/intl-messageformat/-/intl-messageformat-2.2.0.tgz#345bcd46de630b7683330c2e52177ff5eab484fc\"\n-  integrity sha1-NFvNRt5jC3aDMwwuUhd/9eq0hPw=\n+intl-messageformat@^4.4.0:\n+  version \"4.4.0\"\n+  resolved \"https://registry.yarnpkg.com/intl-messageformat/-/intl-messageformat-4.4.0.tgz#aa196a4d04b573f4090bc417f982d81de4f74fad\"\n+  integrity sha512-z+Bj2rS3LZSYU4+sNitdHrwnBhr0wO80ZJSW8EzKDBowwUe3Q/UsvgCGjrwa+HPzoGCLEb9HAjfJgo4j2Sac8w==\n   dependencies:\n-    intl-messageformat-parser \"1.4.0\"\n+    intl-messageformat-parser \"^1.8.1\"\n+\n+intl-pluralrules@^1.0.3:\n+  version \"1.3.1\"\n+  resolved \"https://registry.yarnpkg.com/intl-pluralrules/-/intl-pluralrules-1.3.1.tgz#304ec4038a597894f6616633cbf5e66fb3dbee04\"\n+  integrity sha512-sNYPls1Q4fyN0EGLFVJ7TIuaMWln01LupLozfIBt69rHK0DHehghMSz6ejfnSklgRddnyQSEaQPIU6d9TCKH3w==\n+\n+intl@^1.2.5:\n+  version \"1.2.5\"\n+  resolved \"https://registry.yarnpkg.com/intl/-/intl-1.2.5.tgz#82244a2190c4e419f8371f5aa34daa3420e2abde\"\n+  integrity sha512-rK0KcPHeBFBcqsErKSpvZnrOmWOj+EmDkyJ57e90YWaQNqbcivcqmKDlHEeNprDWOsKzPsh1BfSpPQdDvclHVw==\n \n invert-kv@^1.0.0:\n   version \"1.0.0\"\n@@ -785,6 +920,13 @@ is-buffer@~1.1.1:\n   resolved \"https://registry.yarnpkg.com/is-buffer/-/is-buffer-1.1.6.tgz#efaa2ea9daa0d7ab2ea13a97b2b8ad51fefbe8be\"\n   integrity sha512-NcdALwpXkTm5Zvvbk7owOUSvVvBKDgKP5/ewfXEznmQFfs4ZRmanOeKBTjRVjka3QFoN6XJ+9F3USqfHqTaU5w==\n \n+is-ci@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/is-ci/-/is-ci-2.0.0.tgz#6bc6334181810e04b5c22b3d589fdca55026404c\"\n+  integrity sha512-YfJT7rkpQB0updsdHLGWrvhBJfcfzNNawYDNIyQXJz0IViGf75O8EBPKSdvw2rF+LGCsX4FZ8tcr3b19LcZq4w==\n+  dependencies:\n+    ci-info \"^2.0.0\"\n+\n is-docker@^2.0.0:\n   version \"2.2.1\"\n   resolved \"https://registry.yarnpkg.com/is-docker/-/is-docker-2.2.1.tgz#33eeabe23cfe86f14bde4408a02c0cfb853acdaa\"\n@@ -796,36 +938,35 @@ is-fullwidth-code-point@^1.0.0:\n   dependencies:\n     number-is-nan \"^1.0.0\"\n \n-is-fullwidth-code-point@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/is-fullwidth-code-point/-/is-fullwidth-code-point-2.0.0.tgz#a3b30a5c4f199183167aaab93beefae3ddfb654f\"\n-\n-is-npm@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/is-npm/-/is-npm-1.0.0.tgz#f2fb63a65e4905b406c86072765a1a4dc793b9f4\"\n-\n-is-obj@^1.0.0:\n-  version \"1.0.1\"\n-  resolved \"https://registry.yarnpkg.com/is-obj/-/is-obj-1.0.1.tgz#3e4729ac1f5fde025cd7d83a896dab9f4f67db0f\"\n+is-fullwidth-code-point@^3.0.0:\n+  version \"3.0.0\"\n+  resolved \"https://registry.yarnpkg.com/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz#f116f8064fe90b3f7844a38997c0b75051269f1d\"\n+  integrity sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==\n \n-is-promise@^2.1.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/is-promise/-/is-promise-2.1.0.tgz#79a2a9ece7f096e80f36d2b2f3bc16c1ff4bf3fa\"\n-  integrity sha1-eaKp7OfwlugPNtKy87wWwf9L8/o=\n+is-installed-globally@^0.3.1:\n+  version \"0.3.2\"\n+  resolved \"https://registry.yarnpkg.com/is-installed-globally/-/is-installed-globally-0.3.2.tgz#fd3efa79ee670d1187233182d5b0a1dd00313141\"\n+  integrity sha512-wZ8x1js7Ia0kecP/CHM/3ABkAmujX7WPvQk6uu3Fly/Mk44pySulQpnHG46OMjHGXApINnV4QhY3SWnECO2z5g==\n+  dependencies:\n+    global-dirs \"^2.0.1\"\n+    is-path-inside \"^3.0.1\"\n \n-is-redirect@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/is-redirect/-/is-redirect-1.0.0.tgz#1d03dded53bd8db0f30c26e4f95d36fc7c87dc24\"\n+is-npm@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/is-npm/-/is-npm-4.0.0.tgz#c90dd8380696df87a7a6d823c20d0b12bbe3c84d\"\n+  integrity sha512-96ECIfh9xtDDlPylNPXhzjsykHsMJZ18ASpaWzQyBr4YRTcVjUvzaHayDAES2oU/3KpljhHUjtSRNiDwi0F0ig==\n \n-is-retry-allowed@^1.0.0:\n-  version \"1.1.0\"\n-  resolved \"https://registry.yarnpkg.com/is-retry-allowed/-/is-retry-allowed-1.1.0.tgz#11a060568b67339444033d0125a61a20d564fb34\"\n+is-obj@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/is-obj/-/is-obj-2.0.0.tgz#473fb05d973705e3fd9620545018ca8e22ef4982\"\n+  integrity sha512-drqDG3cbczxxEJRoOXcOjtdp1J/lyp1mNn0xaznRs8+muBhgQcrnbspox5X5fOw0HnMnbfDzvnEMEtqDEJEo8w==\n \n-is-stream@^1.0.0, is-stream@^1.1.0:\n-  version \"1.1.0\"\n-  resolved \"https://registry.yarnpkg.com/is-stream/-/is-stream-1.1.0.tgz#12d4a3dd4e68e0b79ceb8dbc84173ae80d91ca44\"\n+is-path-inside@^3.0.1:\n+  version \"3.0.3\"\n+  resolved \"https://registry.yarnpkg.com/is-path-inside/-/is-path-inside-3.0.3.tgz#d231362e53a07ff2b0e0ea7fed049161ffd16283\"\n+  integrity sha512-Fd4gABb+ycGAmKou8eMftCupSir5lRxqf4aD/vd0cD2qc4HL07OjCeuHMr8Ro4CoMaeCKDB0/ECBOVWjTwUvPQ==\n \n-is-typedarray@~1.0.0:\n+is-typedarray@^1.0.0, is-typedarray@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-typedarray/-/is-typedarray-1.0.0.tgz#e479c80858df0c1b11ddda6940f96011fcda4a9a\"\n \n@@ -841,6 +982,11 @@ is-wsl@^2.2.0:\n   dependencies:\n     is-docker \"^2.0.0\"\n \n+is-yarn-global@^0.3.0:\n+  version \"0.3.0\"\n+  resolved \"https://registry.yarnpkg.com/is-yarn-global/-/is-yarn-global-0.3.0.tgz#d502d3382590ea3004893746754c89139973e232\"\n+  integrity sha512-VjSeb/lHmkoyd8ryPVIKvOCn4D1koMqY+vqyjjUfc3xyKtP4dYOxM44sZrnqQSzSds3xyOrUTLTC9LVCVgLngw==\n+\n isarray@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/isarray/-/isarray-1.0.0.tgz#bb935d48582cba168c06834957a54a3e07124f11\"\n@@ -853,19 +999,30 @@ isstream@~0.1.2:\n   version \"0.1.2\"\n   resolved \"https://registry.yarnpkg.com/isstream/-/isstream-0.1.2.tgz#47e63f7af55afa6f92e1500e690eb8b8529c099a\"\n \n-jpeg-js@0.1.2, jpeg-js@^0.1.2:\n-  version \"0.1.2\"\n-  resolved \"https://registry.yarnpkg.com/jpeg-js/-/jpeg-js-0.1.2.tgz#135b992c0575c985cfa0f494a3227ed238583ece\"\n+jpeg-js@^0.4.1:\n+  version \"0.4.4\"\n+  resolved \"https://registry.yarnpkg.com/jpeg-js/-/jpeg-js-0.4.4.tgz#a9f1c6f1f9f0fa80cdb3484ed9635054d28936aa\"\n+  integrity sha512-WZzeDOEtTOBK4Mdsar0IqEU5sMr3vSV2RqkAIzUEV2BHnUfKGyswWFPFwK5EeDo93K3FohSHbLAjj0s1Wzd+dg==\n \n-js-library-detector@^5.1.0:\n-  version \"5.1.0\"\n-  resolved \"https://registry.yarnpkg.com/js-library-detector/-/js-library-detector-5.1.0.tgz#1e2e88b119bb91e6581b28f4a90018ea1320de73\"\n-  integrity sha512-EIBFkV6/3PFoTp3V7BjuPTPuc8/2wjPMyI5A0t2eicZ/RhXHBYnWzb+E3Ai2H8kVW/N+a+pYMyWqVcV3CBCtzw==\n+js-library-detector@^6.4.0:\n+  version \"6.7.0\"\n+  resolved \"https://registry.yarnpkg.com/js-library-detector/-/js-library-detector-6.7.0.tgz#5075c71fcf835b71133bca13363b91509a39235a\"\n+  integrity sha512-c80Qupofp43y4cJ7+8TTDN/AsDwLi5oOm/plBrWI+iQt485vKXCco+yVmOwEgdo9VOdsYTuV0UlTeetVPTriXA==\n \n jsbn@~0.1.0:\n   version \"0.1.1\"\n   resolved \"https://registry.yarnpkg.com/jsbn/-/jsbn-0.1.1.tgz#a5e654c2e5a2deb5f201d96cefbca80c0ef2f513\"\n \n+json-buffer@3.0.0:\n+  version \"3.0.0\"\n+  resolved \"https://registry.yarnpkg.com/json-buffer/-/json-buffer-3.0.0.tgz#5b1f397afc75d677bde8bcfc0e47e1f9a3d9a898\"\n+  integrity sha512-CuUqjv0FUZIdXkHPI8MezCnFCdaTAacej1TZYulLoAg1h/PhwkdXFN4V/gzY4g+fMBCOV2xF+rp7t2XD2ns/NQ==\n+\n+json-schema-traverse@^0.4.1:\n+  version \"0.4.1\"\n+  resolved \"https://registry.yarnpkg.com/json-schema-traverse/-/json-schema-traverse-0.4.1.tgz#69f6a87d9513ab8bb8fe63bdb0979c448e684660\"\n+  integrity sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg==\n+\n json-schema@0.2.3:\n   version \"0.2.3\"\n   resolved \"https://registry.yarnpkg.com/json-schema/-/json-schema-0.2.3.tgz#b480c892e59a2f05954ce727bd3f2a4e882f9e13\"\n@@ -890,6 +1047,26 @@ jsonify@~0.0.0:\n   version \"0.0.0\"\n   resolved \"https://registry.yarnpkg.com/jsonify/-/jsonify-0.0.0.tgz#2c74b6ee41d93ca51b7b5aaee8f503631d252a73\"\n \n+jsonld@^1.5.0:\n+  version \"1.8.1\"\n+  resolved \"https://registry.yarnpkg.com/jsonld/-/jsonld-1.8.1.tgz#55ea541b22b8af5a5d6a5e32328e3f2678148882\"\n+  integrity sha512-f0rusl5v8aPKS3jApT5fhYsdTC/JpyK1PoJ+ZtYYtZXoyb1J0Z///mJqLwrfL/g4NueFSqPymDYIi1CcSk7b8Q==\n+  dependencies:\n+    canonicalize \"^1.0.1\"\n+    rdf-canonize \"^1.0.2\"\n+    request \"^2.88.0\"\n+    semver \"^5.6.0\"\n+    xmldom \"0.1.19\"\n+\n+jsonlint-mod@^1.7.5:\n+  version \"1.7.6\"\n+  resolved \"https://registry.yarnpkg.com/jsonlint-mod/-/jsonlint-mod-1.7.6.tgz#6f1c4c51fdb5c2002489a0665e3e19a316743319\"\n+  integrity sha512-oGuk6E1ehmIpw0w9ttgb2KsDQQgGXBzZczREW8OfxEm9eCQYL9/LCexSnh++0z3AiYGcXpBgqDSx9AAgzl/Bvg==\n+  dependencies:\n+    JSV \"^4.0.2\"\n+    chalk \"^2.4.2\"\n+    underscore \"^1.9.1\"\n+\n jsprim@^1.2.2:\n   version \"1.4.1\"\n   resolved \"https://registry.yarnpkg.com/jsprim/-/jsprim-1.4.1.tgz#313e66bc1e5cc06e438bc1b7499c2e5c56acb6a2\"\n@@ -899,17 +1076,25 @@ jsprim@^1.2.2:\n     json-schema \"0.2.3\"\n     verror \"1.10.0\"\n \n+keyv@^3.0.0:\n+  version \"3.1.0\"\n+  resolved \"https://registry.yarnpkg.com/keyv/-/keyv-3.1.0.tgz#ecc228486f69991e49e9476485a5be1e8fc5c4d9\"\n+  integrity sha512-9ykJ/46SN/9KPM/sichzQ7OvXyGDYKGTaDlKMGCAlg2UK8KRy4jb0d8sFc+0Tt0YYnThq8X2RZgCg74RPxgcVA==\n+  dependencies:\n+    json-buffer \"3.0.0\"\n+\n klaw@^1.0.0:\n   version \"1.3.1\"\n   resolved \"https://registry.yarnpkg.com/klaw/-/klaw-1.3.1.tgz#4088433b46b3b1ba259d78785d8e96f73ba02439\"\n   optionalDependencies:\n     graceful-fs \"^4.1.9\"\n \n-latest-version@^3.0.0:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/latest-version/-/latest-version-3.1.0.tgz#a205383fea322b33b5ae3b18abee0dc2f356ee15\"\n+latest-version@^5.0.0:\n+  version \"5.1.0\"\n+  resolved \"https://registry.yarnpkg.com/latest-version/-/latest-version-5.1.0.tgz#119dfe908fe38d15dfa43ecd13fa12ec8832face\"\n+  integrity sha512-weT+r0kTkRQdCdYCNtkMwWXQTMEswKrFBkm4ckQOMVhhqhIMI1UT2hMj+1iigIhgSZm5gTmrRXBNoGUgaTY1xA==\n   dependencies:\n-    package-json \"^4.0.0\"\n+    package-json \"^6.3.0\"\n \n lcid@^1.0.0:\n   version \"1.0.0\"\n@@ -925,54 +1110,82 @@ lighthouse-logger@^1.0.0:\n     debug \"^2.6.8\"\n     marky \"^1.2.0\"\n \n-lighthouse@^3.2.1:\n-  version \"3.2.1\"\n-  resolved \"https://registry.yarnpkg.com/lighthouse/-/lighthouse-3.2.1.tgz#90681c9eb8b5dea41a2569e3d4bafdbd4292c97f\"\n-  integrity sha512-zoL0wc9gj8TJhhY1oHwO62E4bAj3LL+5YPCEgCU+sepextiynt11mXDjQcBXpTeDI195zIuk3CjEnppbq/kW5Q==\n-  dependencies:\n-    axe-core \"3.0.0-beta.2\"\n-    chrome-devtools-frontend \"1.0.593291\"\n-    chrome-launcher \"^0.10.5\"\n-    configstore \"^3.1.1\"\n-    cssstyle \"1.1.1\"\n-    devtools-timeline-model \"1.1.6\"\n-    esprima \"^4.0.1\"\n+lighthouse-logger@^1.2.0:\n+  version \"1.4.2\"\n+  resolved \"https://registry.yarnpkg.com/lighthouse-logger/-/lighthouse-logger-1.4.2.tgz#aef90f9e97cd81db367c7634292ee22079280aaa\"\n+  integrity sha512-gPWxznF6TKmUHrOQjlVo2UbaL2EJ71mb2CCeRs/2qBpi4L/g4LUVc9+3lKQ6DTUZwJswfM7ainGrLO1+fOqa2g==\n+  dependencies:\n+    debug \"^2.6.9\"\n+    marky \"^1.2.2\"\n+\n+lighthouse-stack-packs@^1.3.0:\n+  version \"1.12.1\"\n+  resolved \"https://registry.yarnpkg.com/lighthouse-stack-packs/-/lighthouse-stack-packs-1.12.1.tgz#1dbebf795d50e6a96454ece7754bd4aa5be546ae\"\n+  integrity sha512-i4jTmg7tvZQFwNFiwB+nCK6a7ICR68Xcwo+VIVd6Spi71vBNFUlds5HiDrSbClZdkQDON2Bhqv+KKJIo5zkPeA==\n+\n+lighthouse@^6.0.0:\n+  version \"6.5.0\"\n+  resolved \"https://registry.yarnpkg.com/lighthouse/-/lighthouse-6.5.0.tgz#b59dde5ec35acd36e22457e19de33d4e14e2ef1c\"\n+  integrity sha512-d9J2V03WjvpJL2YvKlwZsz+KuCwrxXo/6uh1au74oNrVZm53w4CC3Xyaew82wz36frWToqN3k8dl06jFVziGrA==\n+  dependencies:\n+    axe-core \"3.5.5\"\n+    chrome-launcher \"^0.13.4\"\n+    configstore \"^5.0.1\"\n+    cssstyle \"1.2.1\"\n+    details-element-polyfill \"^2.4.0\"\n     http-link-header \"^0.8.0\"\n-    inquirer \"^3.3.0\"\n-    intl-messageformat \"^2.2.0\"\n-    intl-messageformat-parser \"^1.4.0\"\n-    jpeg-js \"0.1.2\"\n-    js-library-detector \"^5.1.0\"\n-    lighthouse-logger \"^1.0.0\"\n+    inquirer \"^7.3.3\"\n+    intl \"^1.2.5\"\n+    intl-messageformat \"^4.4.0\"\n+    intl-pluralrules \"^1.0.3\"\n+    jpeg-js \"^0.4.1\"\n+    js-library-detector \"^6.4.0\"\n+    jsonld \"^1.5.0\"\n+    jsonlint-mod \"^1.7.5\"\n+    lighthouse-logger \"^1.2.0\"\n+    lighthouse-stack-packs \"^1.3.0\"\n+    lodash.get \"^4.4.2\"\n     lodash.isequal \"^4.5.0\"\n+    lodash.set \"^4.3.2\"\n     lookup-closest-locale \"6.0.4\"\n     metaviewport-parser \"0.2.0\"\n-    mkdirp \"0.5.1\"\n-    opn \"4.0.2\"\n+    open \"^6.4.0\"\n     parse-cache-control \"1.0.1\"\n+    ps-list \"^7.2.0\"\n     raven \"^2.2.1\"\n     rimraf \"^2.6.1\"\n     robots-parser \"^2.0.1\"\n     semver \"^5.3.0\"\n-    speedline-core \"1.4.2\"\n-    update-notifier \"^2.1.0\"\n+    speedline-core \"^1.4.3\"\n+    third-party-web \"^0.12.2\"\n+    update-notifier \"^4.1.0\"\n     ws \"3.3.2\"\n     yargs \"3.32.0\"\n-    yargs-parser \"7.0.0\"\n+    yargs-parser \"^18.1.3\"\n+\n+lodash.get@^4.4.2:\n+  version \"4.4.2\"\n+  resolved \"https://registry.yarnpkg.com/lodash.get/-/lodash.get-4.4.2.tgz#2d177f652fa31e939b4438d5341499dfa3825e99\"\n+  integrity sha512-z+Uw/vLuy6gQe8cfaFWD7p0wVv8fJl3mbzXh33RS+0oW2wvUqiRXiQ69gLWSLpgB5/6sU+r6BlQR0MBILadqTQ==\n \n lodash.isequal@^4.5.0:\n   version \"4.5.0\"\n   resolved \"https://registry.yarnpkg.com/lodash.isequal/-/lodash.isequal-4.5.0.tgz#415c4478f2bcc30120c22ce10ed3226f7d3e18e0\"\n   integrity sha1-QVxEePK8wwEgwizhDtMib30+GOA=\n \n+lodash.set@^4.3.2:\n+  version \"4.3.2\"\n+  resolved \"https://registry.yarnpkg.com/lodash.set/-/lodash.set-4.3.2.tgz#d8757b1da807dde24816b0d6a84bea1a76230b23\"\n+  integrity sha512-4hNPN5jlm/N/HLMCO43v8BXKq9Z7QdAGc/VGrRD61w8gN9g/6jF9A4L1pbUgBLCffi0w9VsXfTOij5x8iTyFvg==\n+\n lodash@^4.13.1:\n   version \"4.17.4\"\n   resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.4.tgz#78203a4d1c328ae1d86dca6460e369b57f4055ae\"\n \n-lodash@^4.3.0:\n-  version \"4.17.11\"\n-  resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.11.tgz#b39ea6229ef607ecd89e2c8df12536891cac9b8d\"\n-  integrity sha512-cQKh8igo5QUhZ7lg38DYWAxMvjSAKG0A8wGSVimP07SIUEK2UO+arSRKbRZWtelMtN5V0Hkwh5ryOto/SshYIg==\n+lodash@^4.17.19:\n+  version \"4.17.21\"\n+  resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.21.tgz#679591c564c3bffaae8454cf0b3df370c3d6911c\"\n+  integrity sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==\n \n lookup-closest-locale@6.0.4:\n   version \"6.0.4\"\n@@ -983,24 +1196,33 @@ lowercase-keys@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/lowercase-keys/-/lowercase-keys-1.0.0.tgz#4e3366b39e7f5457e35f1324bdf6f88d0bfc7306\"\n \n-lru-cache@^4.0.1:\n-  version \"4.1.1\"\n-  resolved \"https://registry.yarnpkg.com/lru-cache/-/lru-cache-4.1.1.tgz#622e32e82488b49279114a4f9ecf45e7cd6bba55\"\n-  dependencies:\n-    pseudomap \"^1.0.2\"\n-    yallist \"^2.1.2\"\n+lowercase-keys@^1.0.1:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/lowercase-keys/-/lowercase-keys-1.0.1.tgz#6f9e30b47084d971a7c820ff15a6c5167b74c26f\"\n+  integrity sha512-G2Lj61tXDnVFFOi8VZds+SoQjtQC3dgokKdDG2mTm1tx4m50NUHBOZSBwQQHyy0V12A0JTG4icfZQH+xPyh8VA==\n \n-make-dir@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/make-dir/-/make-dir-1.0.0.tgz#97a011751e91dd87cfadef58832ebb04936de978\"\n+lowercase-keys@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/lowercase-keys/-/lowercase-keys-2.0.0.tgz#2603e78b7b4b0006cbca2fbcc8a3202558ac9479\"\n+  integrity sha512-tqNXrS78oMOE73NMxK4EMLQsQowWf8jKooH9g7xPavRT706R6bkQJ6DY2Te7QukaZsulxa30wQ7bk0pm4XiHmA==\n+\n+make-dir@^3.0.0:\n+  version \"3.1.0\"\n+  resolved \"https://registry.yarnpkg.com/make-dir/-/make-dir-3.1.0.tgz#415e967046b3a7f1d185277d84aa58203726a13f\"\n+  integrity sha512-g3FeP20LNwhALb/6Cz6Dd4F2ngze0jz7tbzrD2wAV+o9FeNHe4rL+yK2md0J/fiSf1sa1ADhXqi5+oVwOM/eGw==\n   dependencies:\n-    pify \"^2.3.0\"\n+    semver \"^6.0.0\"\n \n marky@^1.2.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/marky/-/marky-1.2.0.tgz#9617ed647bbbea8f45d19526da33dec70606df42\"\n   integrity sha1-lhftZHu76o9F0ZUm2jPexwYG30I=\n \n+marky@^1.2.2:\n+  version \"1.2.5\"\n+  resolved \"https://registry.yarnpkg.com/marky/-/marky-1.2.5.tgz#55796b688cbd72390d2d399eaaf1832c9413e3c0\"\n+  integrity sha512-q9JtQJKjpsVxCRVgQ+WapguSbKC3SQ5HEzFGPAJMStgh3QjCawp00UKv3MTTAArTmGmmPUvllHZoNbZ3gs0I+Q==\n+\n md5@^2.2.1:\n   version \"2.2.1\"\n   resolved \"https://registry.yarnpkg.com/md5/-/md5-2.2.1.tgz#53ab38d5fe3c8891ba465329ea23fac0540126f9\"\n@@ -1015,6 +1237,11 @@ metaviewport-parser@0.2.0:\n   resolved \"https://registry.yarnpkg.com/metaviewport-parser/-/metaviewport-parser-0.2.0.tgz#535c3ce1ccf6223a5025fddc6a1c36505f7e7db1\"\n   integrity sha1-U1w84cz2IjpQJf3cahw2UF9+fbE=\n \n+mime-db@1.52.0:\n+  version \"1.52.0\"\n+  resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.52.0.tgz#bbabcdc02859f4987301c856e3387ce5ec43bf70\"\n+  integrity sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==\n+\n mime-db@~1.29.0:\n   version \"1.29.0\"\n   resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.29.0.tgz#48d26d235589651704ac5916ca06001914266878\"\n@@ -1025,15 +1252,27 @@ mime-types@^2.1.12, mime-types@~2.1.7:\n   dependencies:\n     mime-db \"~1.29.0\"\n \n+mime-types@~2.1.19:\n+  version \"2.1.35\"\n+  resolved \"https://registry.yarnpkg.com/mime-types/-/mime-types-2.1.35.tgz#381a871b62a734450660ae3deee44813f70d959a\"\n+  integrity sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==\n+  dependencies:\n+    mime-db \"1.52.0\"\n+\n mime@^1.2.11, mime@^1.3.6:\n   version \"1.6.0\"\n   resolved \"https://registry.yarnpkg.com/mime/-/mime-1.6.0.tgz#32cd9e5c64553bd58d19a568af452acff04981b1\"\n   integrity sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==\n \n-mimic-fn@^1.0.0:\n-  version \"1.2.0\"\n-  resolved \"https://registry.yarnpkg.com/mimic-fn/-/mimic-fn-1.2.0.tgz#820c86a39334640e99516928bd03fca88057d022\"\n-  integrity sha512-jf84uxzwiuiIVKiOLpfYk7N46TSy8ubTonmneY9vrpHNAnp0QBt2BxWV9dO3/j+BoVAb+a5G6YDPW3M5HOdMWQ==\n+mimic-fn@^2.1.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/mimic-fn/-/mimic-fn-2.1.0.tgz#7ed2c2ccccaf84d3ffcb7a69b57711fc2083401b\"\n+  integrity sha512-OqbOk5oEQeAZ8WXWydlu9HJjz9WVdEIvamMCcXmuqUYjTknH/sqsWvhQ3vgwKFRR1HpjvNBKQ37nbJgYzGqGcg==\n+\n+mimic-response@^1.0.0, mimic-response@^1.0.1:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/mimic-response/-/mimic-response-1.0.1.tgz#4923538878eef42063cb8a3e3b0798781487ab1b\"\n+  integrity sha512-j5EctnkH7amfV/q5Hgmoal1g2QHFJRraOtmx0JpIqkxhBhI/lJSl1nMpQ45hVarwNETOoWEimndZ4QK0RHxuxQ==\n \n minimatch@^3.0.0, minimatch@^3.0.2, minimatch@^3.0.4:\n   version \"3.0.4\"\n@@ -1066,7 +1305,7 @@ minimist@~0.0.1:\n   version \"0.0.10\"\n   resolved \"https://registry.yarnpkg.com/minimist/-/minimist-0.0.10.tgz#de3f98543dbf96082be48ad1a0c7cda836301dcf\"\n \n-mkdirp@0.5.1, mkdirp@0.5.x, \"mkdirp@>=0.5 0\", mkdirp@^0.5.0, mkdirp@^0.5.1:\n+mkdirp@0.5.x, \"mkdirp@>=0.5 0\", mkdirp@^0.5.0, mkdirp@^0.5.1:\n   version \"0.5.1\"\n   resolved \"https://registry.yarnpkg.com/mkdirp/-/mkdirp-0.5.1.tgz#30057438eac6cf7f8c4767f38648d6697d75c903\"\n   dependencies:\n@@ -1083,10 +1322,10 @@ ms@2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/ms/-/ms-2.0.0.tgz#5608aeadfc00be6c2901df5f9861788de0d597c8\"\n \n-mute-stream@0.0.7:\n-  version \"0.0.7\"\n-  resolved \"https://registry.yarnpkg.com/mute-stream/-/mute-stream-0.0.7.tgz#3075ce93bc21b8fab43e1bc4da7e8115ed1e7bab\"\n-  integrity sha1-MHXOk7whuPq0PhvE2n6BFe0ee6s=\n+mute-stream@0.0.8:\n+  version \"0.0.8\"\n+  resolved \"https://registry.yarnpkg.com/mute-stream/-/mute-stream-0.0.8.tgz#1630c42b2251ff81e2a283de96a5497ea92e5e0d\"\n+  integrity sha512-nnbWWOkoWyUsTjKrhgD0dcz22mdkSnpYqbEjIm2nhwhuxlSkpywJmBo8h0ZqJdkp73mb90SssHkN4rsRaBAfAA==\n \n nan@^2.2.0:\n   version \"2.6.2\"\n@@ -1096,6 +1335,11 @@ ncp@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/ncp/-/ncp-2.0.0.tgz#195a21d6c46e361d2fb1281ba38b91e9df7bdbb3\"\n \n+node-forge@^0.10.0:\n+  version \"0.10.0\"\n+  resolved \"https://registry.yarnpkg.com/node-forge/-/node-forge-0.10.0.tgz#32dea2afb3e9926f02ee5ce8794902691a676bf3\"\n+  integrity sha512-PPmu8eEeG9saEUvI97fm4OYxXVB6bFvyNTyiUOBichBpFG8A1Ljw3bY62+5oOjDEMHRnd0Y7HQ+x7uzxOzC6JA==\n+\n node-gyp@^3.5.0:\n   version \"3.6.2\"\n   resolved \"https://registry.yarnpkg.com/node-gyp/-/node-gyp-3.6.2.tgz#9bfbe54562286284838e750eac05295853fa1c60\"\n@@ -1158,11 +1402,10 @@ nopt@^4.0.1:\n     abbrev \"1\"\n     osenv \"^0.1.4\"\n \n-npm-run-path@^2.0.0:\n-  version \"2.0.2\"\n-  resolved \"https://registry.yarnpkg.com/npm-run-path/-/npm-run-path-2.0.2.tgz#35a9232dfa35d7067b4cb2ddf2357b1871536c5f\"\n-  dependencies:\n-    path-key \"^2.0.0\"\n+normalize-url@^4.1.0:\n+  version \"4.5.1\"\n+  resolved \"https://registry.yarnpkg.com/normalize-url/-/normalize-url-4.5.1.tgz#0dd90cf1288ee1d1313b87081c9a5932ee48518a\"\n+  integrity sha512-9UZCFRHQdNrfTpGg8+1INIg93B6zE0aXMVFkw1WFwvO4SlZywU6aLg5Of0Ap/PgcbSw4LNxvMWXMeugwMCX0AA==\n \n \"npmlog@0 || 1 || 2 || 3 || 4\", npmlog@^4.0.2:\n   version \"4.1.2\"\n@@ -1181,34 +1424,39 @@ oauth-sign@~0.8.1:\n   version \"0.8.2\"\n   resolved \"https://registry.yarnpkg.com/oauth-sign/-/oauth-sign-0.8.2.tgz#46a6ab7f0aead8deae9ec0565780b7d4efeb9d43\"\n \n-object-assign@^4.0.1, object-assign@^4.1.0:\n+oauth-sign@~0.9.0:\n+  version \"0.9.0\"\n+  resolved \"https://registry.yarnpkg.com/oauth-sign/-/oauth-sign-0.9.0.tgz#47a7b016baa68b5fa0ecf3dee08a85c679ac6455\"\n+  integrity sha512-fexhUFFPTGV8ybAtSIGbV6gOkSv8UtRbDBnAyLQw4QPKkgNlsH2ByPGtMUqdWkos6YCRmAqViwgZrJc/mRDzZQ==\n+\n+object-assign@^4.1.0:\n   version \"4.1.1\"\n   resolved \"https://registry.yarnpkg.com/object-assign/-/object-assign-4.1.1.tgz#2109adc7965887cfc05cbbd442cac8bfbb360863\"\n \n-once@^1.3.0, once@^1.3.3:\n+once@^1.3.0, once@^1.3.1, once@^1.3.3, once@^1.4.0:\n   version \"1.4.0\"\n   resolved \"https://registry.yarnpkg.com/once/-/once-1.4.0.tgz#583b1aa775961d4b113ac17d9c50baef9dd76bd1\"\n   dependencies:\n     wrappy \"1\"\n \n-onetime@^2.0.0:\n-  version \"2.0.1\"\n-  resolved \"https://registry.yarnpkg.com/onetime/-/onetime-2.0.1.tgz#067428230fd67443b2794b22bba528b6867962d4\"\n-  integrity sha1-BnQoIw/WdEOyeUsiu6UotoZ5YtQ=\n+onetime@^5.1.0:\n+  version \"5.1.2\"\n+  resolved \"https://registry.yarnpkg.com/onetime/-/onetime-5.1.2.tgz#d0e96ebb56b07476df1dd9c4806e5237985ca45e\"\n+  integrity sha512-kbpaSSGJTWdAY5KPVeMOKXSrPtr8C8C7wodJbcsd51jRnmD+GZu8Y0VoU6Dm5Z4vWr0Ig/1NKuWRKf7j5aaYSg==\n   dependencies:\n-    mimic-fn \"^1.0.0\"\n+    mimic-fn \"^2.1.0\"\n+\n+open@^6.4.0:\n+  version \"6.4.0\"\n+  resolved \"https://registry.yarnpkg.com/open/-/open-6.4.0.tgz#5c13e96d0dc894686164f18965ecfe889ecfc8a9\"\n+  integrity sha512-IFenVPgF70fSm1keSd2iDBIDIBZkroLeuffXq+wKTzTJlBpesFWojV9lb8mzOfaAzM1sr7HQHuO0vtV0zYekGg==\n+  dependencies:\n+    is-wsl \"^1.1.0\"\n \n opener@~1.4.0:\n   version \"1.4.3\"\n   resolved \"https://registry.yarnpkg.com/opener/-/opener-1.4.3.tgz#5c6da2c5d7e5831e8ffa3964950f8d6674ac90b8\"\n \n-opn@4.0.2:\n-  version \"4.0.2\"\n-  resolved \"https://registry.yarnpkg.com/opn/-/opn-4.0.2.tgz#7abc22e644dff63b0a96d5ab7f2790c0f01abc95\"\n-  dependencies:\n-    object-assign \"^4.0.1\"\n-    pinkie-promise \"^2.0.0\"\n-\n optimist@0.6.x:\n   version \"0.6.1\"\n   resolved \"https://registry.yarnpkg.com/optimist/-/optimist-0.6.1.tgz#da3ea74686fa21a19a111c326e90eb15a0196686\"\n@@ -1237,18 +1485,20 @@ osenv@0, osenv@^0.1.4:\n     os-homedir \"^1.0.0\"\n     os-tmpdir \"^1.0.0\"\n \n-p-finally@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/p-finally/-/p-finally-1.0.0.tgz#3fbcfb15b899a44123b34b6dcc18b724336a2cae\"\n+p-cancelable@^1.0.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/p-cancelable/-/p-cancelable-1.1.0.tgz#d078d15a3af409220c886f1d9a0ca2e441ab26cc\"\n+  integrity sha512-s73XxOZ4zpt1edZYZzvhqFa6uvQc1vwUa0K0BdtIZgQMAJj9IbebH+JkgKZc9h+B05PKHLOTl4ajG1BmNrVZlw==\n \n-package-json@^4.0.0:\n-  version \"4.0.1\"\n-  resolved \"https://registry.yarnpkg.com/package-json/-/package-json-4.0.1.tgz#8869a0401253661c4c4ca3da6c2121ed555f5eed\"\n+package-json@^6.3.0:\n+  version \"6.5.0\"\n+  resolved \"https://registry.yarnpkg.com/package-json/-/package-json-6.5.0.tgz#6feedaca35e75725876d0b0e64974697fed145b0\"\n+  integrity sha512-k3bdm2n25tkyxcjSKzB5x8kfVxlMdgsbPr0GkZcwHsLpba6cBjqCt1KlcChKEvxHIcTB1FVMuwoijZ26xex5MQ==\n   dependencies:\n-    got \"^6.7.1\"\n-    registry-auth-token \"^3.0.1\"\n-    registry-url \"^3.0.3\"\n-    semver \"^5.1.0\"\n+    got \"^9.6.0\"\n+    registry-auth-token \"^4.0.0\"\n+    registry-url \"^5.0.0\"\n+    semver \"^6.2.0\"\n \n parse-cache-control@1.0.1:\n   version \"1.0.1\"\n@@ -1259,27 +1509,14 @@ path-is-absolute@^1.0.0:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/path-is-absolute/-/path-is-absolute-1.0.1.tgz#174b9268735534ffbc7ace6bf53a5a9e1b5c5f5f\"\n \n-path-key@^2.0.0:\n-  version \"2.0.1\"\n-  resolved \"https://registry.yarnpkg.com/path-key/-/path-key-2.0.1.tgz#411cadb574c5a140d3a4b1910d40d80cc9f40b40\"\n-\n performance-now@^0.2.0:\n   version \"0.2.0\"\n   resolved \"https://registry.yarnpkg.com/performance-now/-/performance-now-0.2.0.tgz#33ef30c5c77d4ea21c5a53869d91b56d8f2555e5\"\n \n-pify@^2.3.0:\n-  version \"2.3.0\"\n-  resolved \"https://registry.yarnpkg.com/pify/-/pify-2.3.0.tgz#ed141a6ac043a849ea588498e7dca8b15330e90c\"\n-\n-pinkie-promise@^2.0.0:\n-  version \"2.0.1\"\n-  resolved \"https://registry.yarnpkg.com/pinkie-promise/-/pinkie-promise-2.0.1.tgz#2135d6dfa7a358c069ac9b178776288228450ffa\"\n-  dependencies:\n-    pinkie \"^2.0.0\"\n-\n-pinkie@^2.0.0:\n-  version \"2.0.4\"\n-  resolved \"https://registry.yarnpkg.com/pinkie/-/pinkie-2.0.4.tgz#72556b80cfa0d48a974e80e77248e80ed4f7f870\"\n+performance-now@^2.1.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/performance-now/-/performance-now-2.1.0.tgz#6309f4e0e5fa913ec1c69307ae364b4b377c9e7b\"\n+  integrity sha512-7EAHlyLHI56VEIdK57uwHdHKIaAGbnXPiw0yWbarQZOKaKpvUIgW0jWRVLiatnM+XXlSwsanIBH/hzGMJulMow==\n \n portfinder@^1.0.13:\n   version \"1.0.13\"\n@@ -1289,9 +1526,10 @@ portfinder@^1.0.13:\n     debug \"^2.2.0\"\n     mkdirp \"0.5.x\"\n \n-prepend-http@^1.0.1:\n-  version \"1.0.4\"\n-  resolved \"https://registry.yarnpkg.com/prepend-http/-/prepend-http-1.0.4.tgz#d4f4562b0ce3696e41ac52d0e002e57a635dc6dc\"\n+prepend-http@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/prepend-http/-/prepend-http-2.0.0.tgz#e92434bfa5ea8c19f41cdfd401d741a3c819d897\"\n+  integrity sha512-ravE6m9Atw9Z/jjttRUZ+clIXogdghyZAuWJ3qEzjT+jI/dL1ifAqhZeC5VHzQp1MSt1+jxKkFNemj/iO7tVUA==\n \n process-nextick-args@~1.0.6:\n   version \"1.0.7\"\n@@ -1303,14 +1541,40 @@ promisify-node@~0.3.0:\n   dependencies:\n     nodegit-promise \"~4.0.0\"\n \n-pseudomap@^1.0.2:\n-  version \"1.0.2\"\n-  resolved \"https://registry.yarnpkg.com/pseudomap/-/pseudomap-1.0.2.tgz#f052a28da70e618917ef0a8ac34c1ae5a68286b3\"\n+ps-list@^7.2.0:\n+  version \"7.2.0\"\n+  resolved \"https://registry.yarnpkg.com/ps-list/-/ps-list-7.2.0.tgz#3d110e1de8249a4b178c9b1cf2a215d1e4e42fc0\"\n+  integrity sha512-v4Bl6I3f2kJfr5o80ShABNHAokIgY+wFDTQfE+X3zWYgSGQOCBeYptLZUpoOALBqO5EawmDN/tjTldJesd0ujQ==\n+\n+psl@^1.1.28:\n+  version \"1.9.0\"\n+  resolved \"https://registry.yarnpkg.com/psl/-/psl-1.9.0.tgz#d0df2a137f00794565fcaf3b2c00cd09f8d5a5a7\"\n+  integrity sha512-E/ZsdU4HLs/68gYzgGTkMicWTLPdAftJLfJFlLUAAKZGkStNU72sZjT66SnMDVOfOWY/YAoiD7Jxa9iHvngcag==\n+\n+pump@^3.0.0:\n+  version \"3.0.0\"\n+  resolved \"https://registry.yarnpkg.com/pump/-/pump-3.0.0.tgz#b4a2116815bde2f4e1ea602354e8c75565107a64\"\n+  integrity sha512-LwZy+p3SFs1Pytd/jYct4wpv49HiYCqd9Rlc5ZVdk0V+8Yzv6jR5Blk3TRmPL1ft69TxP0IMZGJ+WPFU2BFhww==\n+  dependencies:\n+    end-of-stream \"^1.1.0\"\n+    once \"^1.3.1\"\n \n punycode@^1.4.1:\n   version \"1.4.1\"\n   resolved \"https://registry.yarnpkg.com/punycode/-/punycode-1.4.1.tgz#c0d5a63b2718800ad8e1eb0fa5269c84dd41845e\"\n \n+punycode@^2.1.0, punycode@^2.1.1:\n+  version \"2.3.1\"\n+  resolved \"https://registry.yarnpkg.com/punycode/-/punycode-2.3.1.tgz#027422e2faec0b25e1549c3e1bd8309b9133b6e5\"\n+  integrity sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==\n+\n+pupa@^2.0.1:\n+  version \"2.1.1\"\n+  resolved \"https://registry.yarnpkg.com/pupa/-/pupa-2.1.1.tgz#f5e8fd4afc2c5d97828faa523549ed8744a20d62\"\n+  integrity sha512-l1jNAspIBSFqbT+y+5FosojNpVpF94nlI+wDUpqP9enwOTfHx9f0gh5nB96vl+6yTpsJsypeNrwfzPrKuHB41A==\n+  dependencies:\n+    escape-goat \"^2.0.0\"\n+\n qs@~2.3.3:\n   version \"2.3.3\"\n   resolved \"https://registry.yarnpkg.com/qs/-/qs-2.3.3.tgz#e9e85adbe75da0bbe4c8e0476a086290f863b404\"\n@@ -1319,6 +1583,11 @@ qs@~6.4.0:\n   version \"6.4.0\"\n   resolved \"https://registry.yarnpkg.com/qs/-/qs-6.4.0.tgz#13e26d28ad6b0ffaa91312cd3bf708ed351e7233\"\n \n+qs@~6.5.2:\n+  version \"6.5.3\"\n+  resolved \"https://registry.yarnpkg.com/qs/-/qs-6.5.3.tgz#3aeeffc91967ef6e35c0e488ef46fb296ab76aad\"\n+  integrity sha512-qxXIEh4pCGfHICj1mAJQ2/2XVZkjCDTcEgfoSQxc/fYivUZxTkk7L3bDBJSoNrEzXI17oUO5Dp07ktqE5KzczA==\n+\n raven@^2.2.1:\n   version \"2.6.4\"\n   resolved \"https://registry.yarnpkg.com/raven/-/raven-2.6.4.tgz#458d4a380c8fbb59e0150c655625aaf60c167ea3\"\n@@ -1330,7 +1599,17 @@ raven@^2.2.1:\n     timed-out \"4.0.1\"\n     uuid \"3.3.2\"\n \n-rc@^1.0.1, rc@^1.1.6, rc@^1.1.7:\n+rc@1.2.8, rc@^1.2.8:\n+  version \"1.2.8\"\n+  resolved \"https://registry.yarnpkg.com/rc/-/rc-1.2.8.tgz#cd924bf5200a075b83c188cd6b9e211b7fc0d3ed\"\n+  integrity sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw==\n+  dependencies:\n+    deep-extend \"^0.6.0\"\n+    ini \"~1.3.0\"\n+    minimist \"^1.2.0\"\n+    strip-json-comments \"~2.0.1\"\n+\n+rc@^1.1.7:\n   version \"1.2.1\"\n   resolved \"https://registry.yarnpkg.com/rc/-/rc-1.2.1.tgz#2e03e8e42ee450b8cb3dce65be1bf8974e1dfd95\"\n   dependencies:\n@@ -1339,6 +1618,14 @@ rc@^1.0.1, rc@^1.1.6, rc@^1.1.7:\n     minimist \"^1.2.0\"\n     strip-json-comments \"~2.0.1\"\n \n+rdf-canonize@^1.0.2:\n+  version \"1.2.0\"\n+  resolved \"https://registry.yarnpkg.com/rdf-canonize/-/rdf-canonize-1.2.0.tgz#9872b2cc6ed92a9969e834f9f042addaf0d4f7f9\"\n+  integrity sha512-MQdcRDz4+82nUrEb3hNQangBDpmep15uMmnWclGi/1KS0bNVc8oHpoNI0PFLHZsvwgwRzH31bO1JAScqUAstvw==\n+  dependencies:\n+    node-forge \"^0.10.0\"\n+    semver \"^6.3.0\"\n+\n readable-stream@^2.0.6, readable-stream@^2.1.4:\n   version \"2.3.3\"\n   resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-2.3.3.tgz#368f2512d79f9d46fdfc71349ae7878bbc1eb95c\"\n@@ -1351,18 +1638,19 @@ readable-stream@^2.0.6, readable-stream@^2.1.4:\n     string_decoder \"~1.0.3\"\n     util-deprecate \"~1.0.1\"\n \n-registry-auth-token@^3.0.1:\n-  version \"3.3.1\"\n-  resolved \"https://registry.yarnpkg.com/registry-auth-token/-/registry-auth-token-3.3.1.tgz#fb0d3289ee0d9ada2cbb52af5dfe66cb070d3006\"\n+registry-auth-token@^4.0.0:\n+  version \"4.2.2\"\n+  resolved \"https://registry.yarnpkg.com/registry-auth-token/-/registry-auth-token-4.2.2.tgz#f02d49c3668884612ca031419491a13539e21fac\"\n+  integrity sha512-PC5ZysNb42zpFME6D/XlIgtNGdTl8bBOCw90xQLVMpzuuubJKYDWFAEuUNc+Cn8Z8724tg2SDhDRrkVEsqfDMg==\n   dependencies:\n-    rc \"^1.1.6\"\n-    safe-buffer \"^5.0.1\"\n+    rc \"1.2.8\"\n \n-registry-url@^3.0.3:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/registry-url/-/registry-url-3.1.0.tgz#3d4ef870f73dde1d77f0cf9a381432444e174942\"\n+registry-url@^5.0.0:\n+  version \"5.1.0\"\n+  resolved \"https://registry.yarnpkg.com/registry-url/-/registry-url-5.1.0.tgz#e98334b50d5434b81136b44ec638d9c2009c5009\"\n+  integrity sha512-8acYXXTI0AkQv6RAOjE3vOaIXZkT9wo4LOFbBKYQEEnnMNBpKqdUrI6S4NT0KPIo/WVvJ5tE/X5LF/TQUf0ekw==\n   dependencies:\n-    rc \"^1.0.1\"\n+    rc \"^1.2.8\"\n \n request@2, request@^2.81.0:\n   version \"2.81.0\"\n@@ -1391,20 +1679,49 @@ request@2, request@^2.81.0:\n     tunnel-agent \"^0.6.0\"\n     uuid \"^3.0.0\"\n \n+request@^2.88.0:\n+  version \"2.88.2\"\n+  resolved \"https://registry.yarnpkg.com/request/-/request-2.88.2.tgz#d73c918731cb5a87da047e207234146f664d12b3\"\n+  integrity sha512-MsvtOrfG9ZcrOwAW+Qi+F6HbD0CWXEh9ou77uOb7FM2WPhwT7smM833PzanhJLsgXjN89Ir6V2PczXNnMpwKhw==\n+  dependencies:\n+    aws-sign2 \"~0.7.0\"\n+    aws4 \"^1.8.0\"\n+    caseless \"~0.12.0\"\n+    combined-stream \"~1.0.6\"\n+    extend \"~3.0.2\"\n+    forever-agent \"~0.6.1\"\n+    form-data \"~2.3.2\"\n+    har-validator \"~5.1.3\"\n+    http-signature \"~1.2.0\"\n+    is-typedarray \"~1.0.0\"\n+    isstream \"~0.1.2\"\n+    json-stringify-safe \"~5.0.1\"\n+    mime-types \"~2.1.19\"\n+    oauth-sign \"~0.9.0\"\n+    performance-now \"^2.1.0\"\n+    qs \"~6.5.2\"\n+    safe-buffer \"^5.1.2\"\n+    tough-cookie \"~2.5.0\"\n+    tunnel-agent \"^0.6.0\"\n+    uuid \"^3.3.2\"\n+\n requires-port@1.x.x:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/requires-port/-/requires-port-1.0.0.tgz#925d2601d39ac485e091cf0da5c6e694dc3dcaff\"\n \n-resolve@1.1.7:\n-  version \"1.1.7\"\n-  resolved \"https://registry.yarnpkg.com/resolve/-/resolve-1.1.7.tgz#203114d82ad2c5ed9e8e0411b3932875e889e97b\"\n+responselike@^1.0.2:\n+  version \"1.0.2\"\n+  resolved \"https://registry.yarnpkg.com/responselike/-/responselike-1.0.2.tgz#918720ef3b631c5642be068f15ade5a46f4ba1e7\"\n+  integrity sha512-/Fpe5guzJk1gPqdJLJR5u7eG/gNY4nImjbRDaVWVMRhne55TCmj2i9Q+54PBRfatRC8v/rIiv9BN0pMd9OV5EQ==\n+  dependencies:\n+    lowercase-keys \"^1.0.0\"\n \n-restore-cursor@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/restore-cursor/-/restore-cursor-2.0.0.tgz#9f7ee287f82fd326d4fd162923d62129eee0dfaf\"\n-  integrity sha1-n37ih/gv0ybU/RYpI9YhKe7g368=\n+restore-cursor@^3.1.0:\n+  version \"3.1.0\"\n+  resolved \"https://registry.yarnpkg.com/restore-cursor/-/restore-cursor-3.1.0.tgz#39f67c54b3a7a58cea5236d95cf0034239631f7e\"\n+  integrity sha512-l+sSefzHpj5qimhFSE5a8nufZYAM3sBSVMAPtYkmC+4EH2anSGaEMXSD0izRQbu9nfyQ9y5JrVmp7E8oZrUjvA==\n   dependencies:\n-    onetime \"^2.0.0\"\n+    onetime \"^5.1.0\"\n     signal-exit \"^3.0.2\"\n \n rimraf@2, rimraf@^2.2.8, rimraf@^2.5.1, rimraf@^2.6.1:\n@@ -1425,44 +1742,53 @@ robots-parser@^2.0.1:\n   resolved \"https://registry.yarnpkg.com/robots-parser/-/robots-parser-2.1.0.tgz#d16b78ce34e861ab6afbbf0aac65974dbe01566e\"\n   integrity sha512-k07MeDS1Tl1zjoYs5bHfUbgQ0MfaeTOepDcjZFxdYXd84p6IeLDQyUwlMk2AZ9c2yExA30I3ayWhmqz9tg0DzQ==\n \n-run-async@^2.2.0:\n-  version \"2.3.0\"\n-  resolved \"https://registry.yarnpkg.com/run-async/-/run-async-2.3.0.tgz#0371ab4ae0bdd720d4166d7dfda64ff7a445a6c0\"\n-  integrity sha1-A3GrSuC91yDUFm19/aZP96RFpsA=\n-  dependencies:\n-    is-promise \"^2.1.0\"\n+run-async@^2.4.0:\n+  version \"2.4.1\"\n+  resolved \"https://registry.yarnpkg.com/run-async/-/run-async-2.4.1.tgz#8440eccf99ea3e70bd409d49aab88e10c189a455\"\n+  integrity sha512-tvVnVv01b8c1RrA6Ep7JkStj85Guv/YrMcwqYQnwjsAS2cTmmPGBBjAjpCW7RrSodNSoE2/qg9O4bceNvUuDgQ==\n \n-rx-lite-aggregates@^4.0.8:\n-  version \"4.0.8\"\n-  resolved \"https://registry.yarnpkg.com/rx-lite-aggregates/-/rx-lite-aggregates-4.0.8.tgz#753b87a89a11c95467c4ac1626c4efc4e05c67be\"\n-  integrity sha1-dTuHqJoRyVRnxKwWJsTvxOBcZ74=\n+rxjs@^6.6.0:\n+  version \"6.6.7\"\n+  resolved \"https://registry.yarnpkg.com/rxjs/-/rxjs-6.6.7.tgz#90ac018acabf491bf65044235d5863c4dab804c9\"\n+  integrity sha512-hTdwr+7yYNIT5n4AMYp85KA6yw2Va0FLa3Rguvbpa4W3I5xynaBZo41cM3XM+4Q6fRMj3sBYIR1VAmZMXYJvRQ==\n   dependencies:\n-    rx-lite \"*\"\n-\n-rx-lite@*, rx-lite@^4.0.8:\n-  version \"4.0.8\"\n-  resolved \"https://registry.yarnpkg.com/rx-lite/-/rx-lite-4.0.8.tgz#0b1e11af8bc44836f04a6407e92da42467b79444\"\n-  integrity sha1-Cx4Rr4vESDbwSmQH6S2kJGe3lEQ=\n+    tslib \"^1.9.0\"\n \n safe-buffer@^5.0.1, safe-buffer@~5.1.0, safe-buffer@~5.1.1:\n   version \"5.1.1\"\n   resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.1.1.tgz#893312af69b2123def71f57889001671eeb2c853\"\n \n+safe-buffer@^5.1.2:\n+  version \"5.2.1\"\n+  resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.2.1.tgz#1eaf9fa9bdb1fdd4ec75f58f9cdb4e6b7827eec6\"\n+  integrity sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==\n+\n \"safer-buffer@>= 2.1.2 < 3\":\n   version \"2.1.2\"\n   resolved \"https://registry.yarnpkg.com/safer-buffer/-/safer-buffer-2.1.2.tgz#44fa161b0187b9549dd84bb91802f9bd8385cd6a\"\n   integrity sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==\n \n-semver-diff@^2.0.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/semver-diff/-/semver-diff-2.1.0.tgz#4bbb8437c8d37e4b0cf1a68fd726ec6d645d6d36\"\n+semver-diff@^3.1.1:\n+  version \"3.1.1\"\n+  resolved \"https://registry.yarnpkg.com/semver-diff/-/semver-diff-3.1.1.tgz#05f77ce59f325e00e2706afd67bb506ddb1ca32b\"\n+  integrity sha512-GX0Ix/CJcHyB8c4ykpHGIAvLyOwOobtM/8d+TQkAd81/bEjgPHrfba41Vpesr7jX/t8Uh+R3EX9eAS5be+jQYg==\n   dependencies:\n-    semver \"^5.0.3\"\n+    semver \"^6.3.0\"\n \n-semver@^5.0.3, semver@^5.1.0, semver@^5.3.0:\n+semver@^5.3.0:\n   version \"5.4.1\"\n   resolved \"https://registry.yarnpkg.com/semver/-/semver-5.4.1.tgz#e059c09d8571f0540823733433505d3a2f00b18e\"\n \n+semver@^5.6.0:\n+  version \"5.7.2\"\n+  resolved \"https://registry.yarnpkg.com/semver/-/semver-5.7.2.tgz#48d55db737c3287cd4835e17fa13feace1c41ef8\"\n+  integrity sha512-cBznnQ9KjJqU67B52RMC65CMarK2600WFnbkcaiwWq3xy/5haFJlshgnpjovMVJ+Hff49d8GEn0b87C5pDQ10g==\n+\n+semver@^6.0.0, semver@^6.2.0, semver@^6.3.0:\n+  version \"6.3.1\"\n+  resolved \"https://registry.yarnpkg.com/semver/-/semver-6.3.1.tgz#556d2ef8689146e46dcea4bfdd095f3434dffcb4\"\n+  integrity sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==\n+\n semver@~5.3.0:\n   version \"5.3.0\"\n   resolved \"https://registry.yarnpkg.com/semver/-/semver-5.3.0.tgz#9b2ce5d3de02d17c6012ad326aa6b4d0cf54f94f\"\n@@ -1471,38 +1797,24 @@ set-blocking@~2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/set-blocking/-/set-blocking-2.0.0.tgz#045f9782d011ae9a6803ddd382b24392b3d890f7\"\n \n-shebang-command@^1.2.0:\n-  version \"1.2.0\"\n-  resolved \"https://registry.yarnpkg.com/shebang-command/-/shebang-command-1.2.0.tgz#44aac65b695b03398968c39f363fee5deafdf1ea\"\n-  dependencies:\n-    shebang-regex \"^1.0.0\"\n-\n-shebang-regex@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/shebang-regex/-/shebang-regex-1.0.0.tgz#da42f49740c0b42db2ca9728571cb190c98efea3\"\n-\n signal-exit@^3.0.0, signal-exit@^3.0.2:\n   version \"3.0.2\"\n   resolved \"https://registry.yarnpkg.com/signal-exit/-/signal-exit-3.0.2.tgz#b5fdc08f1287ea1178628e415e25132b73646c6d\"\n \n-slide@^1.1.5:\n-  version \"1.1.6\"\n-  resolved \"https://registry.yarnpkg.com/slide/-/slide-1.1.6.tgz#56eb027d65b4d2dce6cb2e2d32c4d4afc9e1d707\"\n-\n sntp@1.x.x:\n   version \"1.0.9\"\n   resolved \"https://registry.yarnpkg.com/sntp/-/sntp-1.0.9.tgz#6541184cc90aeea6c6e7b35e2659082443c66198\"\n   dependencies:\n     hoek \"2.x.x\"\n \n-speedline-core@1.4.2:\n-  version \"1.4.2\"\n-  resolved \"https://registry.yarnpkg.com/speedline-core/-/speedline-core-1.4.2.tgz#bb061444a218d67b4cd52f63a262386197b90c8a\"\n-  integrity sha512-9/5CApkKKl6bS6jJ2D0DQllwz/1xq3cyJCR6DLgAQnkj5djCuq8NbflEdD2TI01p8qzS9qaKjzxM9cHT11ezmg==\n+speedline-core@^1.4.3:\n+  version \"1.4.3\"\n+  resolved \"https://registry.yarnpkg.com/speedline-core/-/speedline-core-1.4.3.tgz#4d6e7276e2063c2d36a375cb25a523ac73475319\"\n+  integrity sha512-DI7/OuAUD+GMpR6dmu8lliO2Wg5zfeh+/xsdyJZCzd8o5JgFUjCeLsBDuZjIQJdwXS3J0L/uZYrELKYqx+PXog==\n   dependencies:\n     \"@types/node\" \"*\"\n     image-ssim \"^0.2.0\"\n-    jpeg-js \"^0.1.2\"\n+    jpeg-js \"^0.4.1\"\n \n sshpk@^1.7.0:\n   version \"1.13.1\"\n@@ -1535,12 +1847,14 @@ string-width@^1.0.1, string-width@^1.0.2:\n     is-fullwidth-code-point \"^1.0.0\"\n     strip-ansi \"^3.0.0\"\n \n-string-width@^2.0.0, string-width@^2.1.0:\n-  version \"2.1.1\"\n-  resolved \"https://registry.yarnpkg.com/string-width/-/string-width-2.1.1.tgz#ab93f27a8dc13d28cac815c462143a6d9012ae9e\"\n+string-width@^4.0.0, string-width@^4.1.0:\n+  version \"4.2.3\"\n+  resolved \"https://registry.yarnpkg.com/string-width/-/string-width-4.2.3.tgz#269c7117d27b05ad2e536830a8ec895ef9c6d010\"\n+  integrity sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==\n   dependencies:\n-    is-fullwidth-code-point \"^2.0.0\"\n-    strip-ansi \"^4.0.0\"\n+    emoji-regex \"^8.0.0\"\n+    is-fullwidth-code-point \"^3.0.0\"\n+    strip-ansi \"^6.0.1\"\n \n string_decoder@~1.0.3:\n   version \"1.0.3\"\n@@ -1558,24 +1872,17 @@ strip-ansi@^3.0.0, strip-ansi@^3.0.1:\n   dependencies:\n     ansi-regex \"^2.0.0\"\n \n-strip-ansi@^4.0.0:\n-  version \"4.0.0\"\n-  resolved \"https://registry.yarnpkg.com/strip-ansi/-/strip-ansi-4.0.0.tgz#a8479022eb1ac368a871389b635262c505ee368f\"\n+strip-ansi@^6.0.0, strip-ansi@^6.0.1:\n+  version \"6.0.1\"\n+  resolved \"https://registry.yarnpkg.com/strip-ansi/-/strip-ansi-6.0.1.tgz#9e26c63d30f53443e9489495b2105d37b67a85d9\"\n+  integrity sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==\n   dependencies:\n-    ansi-regex \"^3.0.0\"\n-\n-strip-eof@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/strip-eof/-/strip-eof-1.0.0.tgz#bb43ff5598a6eb05d89b59fcd129c983313606bf\"\n+    ansi-regex \"^5.0.1\"\n \n strip-json-comments@~2.0.1:\n   version \"2.0.1\"\n   resolved \"https://registry.yarnpkg.com/strip-json-comments/-/strip-json-comments-2.0.1.tgz#3c531942e908c2697c0ec344858c286c7ca0a60a\"\n \n-supports-color@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/supports-color/-/supports-color-2.0.0.tgz#535d045ce6b6363fa40117084629995e9df324c7\"\n-\n supports-color@^4.0.0:\n   version \"4.2.1\"\n   resolved \"https://registry.yarnpkg.com/supports-color/-/supports-color-4.2.1.tgz#65a4bb2631e90e02420dba5554c375a4754bb836\"\n@@ -1589,6 +1896,13 @@ supports-color@^5.3.0:\n   dependencies:\n     has-flag \"^3.0.0\"\n \n+supports-color@^7.1.0:\n+  version \"7.2.0\"\n+  resolved \"https://registry.yarnpkg.com/supports-color/-/supports-color-7.2.0.tgz#1b7dcdcb32b8138801b3e478ba6a51caa89648da\"\n+  integrity sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==\n+  dependencies:\n+    has-flag \"^4.0.0\"\n+\n tar-pack@^3.4.0:\n   version \"3.4.0\"\n   resolved \"https://registry.yarnpkg.com/tar-pack/-/tar-pack-3.4.0.tgz#23be2d7f671a8339376cbdb0b8fe3fdebf317984\"\n@@ -1610,18 +1924,22 @@ tar@^2.0.0, tar@^2.2.1:\n     fstream \"^1.0.2\"\n     inherits \"2\"\n \n-term-size@^1.2.0:\n-  version \"1.2.0\"\n-  resolved \"https://registry.yarnpkg.com/term-size/-/term-size-1.2.0.tgz#458b83887f288fc56d6fffbfad262e26638efa69\"\n-  dependencies:\n-    execa \"^0.7.0\"\n+term-size@^2.1.0:\n+  version \"2.2.1\"\n+  resolved \"https://registry.yarnpkg.com/term-size/-/term-size-2.2.1.tgz#2a6a54840432c2fb6320fea0f415531e90189f54\"\n+  integrity sha512-wK0Ri4fOGjv/XPy8SBHZChl8CM7uMc5VML7SqiQ0zG7+J5Vr+RMQDoHa2CNT6KHUnTGIXH34UDMkPzAUyapBZg==\n+\n+third-party-web@^0.12.2:\n+  version \"0.12.7\"\n+  resolved \"https://registry.yarnpkg.com/third-party-web/-/third-party-web-0.12.7.tgz#64445702379abf1a29066d636a965173e4e423c6\"\n+  integrity sha512-9d/OfjEOjyeOpnm4F9o0KSK6BI6ytvi9DINSB5h1+jdlCvQlhKpViMSxWpBN9WstdfDQ61BS6NxWqcPCuQCAJg==\n \n through@^2.3.6:\n   version \"2.3.8\"\n   resolved \"https://registry.yarnpkg.com/through/-/through-2.3.8.tgz#0dd4c9ffaabc357960b1b724115d7e0e86a2e1f5\"\n   integrity sha1-DdTJ/6q8NXlgsbckEV1+Doai4fU=\n \n-timed-out@4.0.1, timed-out@^4.0.0:\n+timed-out@4.0.1:\n   version \"4.0.1\"\n   resolved \"https://registry.yarnpkg.com/timed-out/-/timed-out-4.0.1.tgz#f32eacac5a175bea25d7fab565ab3ed8741ef56f\"\n \n@@ -1632,12 +1950,30 @@ tmp@^0.0.33:\n   dependencies:\n     os-tmpdir \"~1.0.2\"\n \n+to-readable-stream@^1.0.0:\n+  version \"1.0.0\"\n+  resolved \"https://registry.yarnpkg.com/to-readable-stream/-/to-readable-stream-1.0.0.tgz#ce0aa0c2f3df6adf852efb404a783e77c0475771\"\n+  integrity sha512-Iq25XBt6zD5npPhlLVXGFN3/gyR2/qODcKNNyTMd4vbm39HUaOiAM4PMq0eMVC/Tkxz+Zjdsc55g9yyz+Yq00Q==\n+\n tough-cookie@~2.3.0:\n   version \"2.3.2\"\n   resolved \"https://registry.yarnpkg.com/tough-cookie/-/tough-cookie-2.3.2.tgz#f081f76e4c85720e6c37a5faced737150d84072a\"\n   dependencies:\n     punycode \"^1.4.1\"\n \n+tough-cookie@~2.5.0:\n+  version \"2.5.0\"\n+  resolved \"https://registry.yarnpkg.com/tough-cookie/-/tough-cookie-2.5.0.tgz#cd9fb2a0aa1d5a12b473bd9fb96fa3dcff65ade2\"\n+  integrity sha512-nlLsUzgm1kfLXSXfRZMc1KLAugd4hqJHDTvc2hDIwS3mZAfMEuMbc03SujMF+GEcpaX/qboeycw6iO8JwVv2+g==\n+  dependencies:\n+    psl \"^1.1.28\"\n+    punycode \"^2.1.1\"\n+\n+tslib@^1.9.0:\n+  version \"1.14.1\"\n+  resolved \"https://registry.yarnpkg.com/tslib/-/tslib-1.14.1.tgz#cf2d38bdc34a134bcaf1091c41f6619e2f672d00\"\n+  integrity sha512-Xni35NKzjgMrwevysHTCArtLDpPvye8zV/0E4EyYn43P7/7qvQwPh9BGkHewbMulVntbigmcT7rdX3BNo9wRJg==\n+\n tunnel-agent@^0.6.0:\n   version \"0.6.0\"\n   resolved \"https://registry.yarnpkg.com/tunnel-agent/-/tunnel-agent-0.6.0.tgz#27a5dea06b36b04a0a9966774b290868f0fc40fd\"\n@@ -1648,6 +1984,23 @@ tweetnacl@^0.14.3, tweetnacl@~0.14.0:\n   version \"0.14.5\"\n   resolved \"https://registry.yarnpkg.com/tweetnacl/-/tweetnacl-0.14.5.tgz#5ae68177f192d4456269d108afa93ff8743f4f64\"\n \n+type-fest@^0.21.3:\n+  version \"0.21.3\"\n+  resolved \"https://registry.yarnpkg.com/type-fest/-/type-fest-0.21.3.tgz#d260a24b0198436e133fa26a524a6d65fa3b2e37\"\n+  integrity sha512-t0rzBq87m3fVcduHDUFhKmyyX+9eo6WQjZvf51Ea/M0Q7+T374Jp1aUiyUl0GKxp8M/OETVHSDvmkyPgvX+X2w==\n+\n+type-fest@^0.8.1:\n+  version \"0.8.1\"\n+  resolved \"https://registry.yarnpkg.com/type-fest/-/type-fest-0.8.1.tgz#09e249ebde851d3b1e48d27c105444667f17b83d\"\n+  integrity sha512-4dbzIzqvjtgiM5rw1k5rEHtBANKmdudhGyBEajN01fEyhaAIhsoKNy6y7+IN93IfpFtwY9iqi7kD+xwKhQsNJA==\n+\n+typedarray-to-buffer@^3.1.5:\n+  version \"3.1.5\"\n+  resolved \"https://registry.yarnpkg.com/typedarray-to-buffer/-/typedarray-to-buffer-3.1.5.tgz#a97ee7a9ff42691b9f783ff1bc5112fe3fca9080\"\n+  integrity sha512-zdu8XMNEDepKKR+XYOXAVPtWui0ly0NtohUscw+UmaHiAWT8hrV1rr//H6V+0DvJ3OQ19S979M0laLfX8rm82Q==\n+  dependencies:\n+    is-typedarray \"^1.0.0\"\n+\n uid-number@^0.0.6:\n   version \"0.0.6\"\n   resolved \"https://registry.yarnpkg.com/uid-number/-/uid-number-0.0.6.tgz#0ea10e8035e8eb5b8e4449f06da1c730663baa81\"\n@@ -1657,45 +2010,61 @@ ultron@~1.1.0:\n   resolved \"https://registry.yarnpkg.com/ultron/-/ultron-1.1.1.tgz#9fe1536a10a664a65266a1e3ccf85fd36302bc9c\"\n   integrity sha512-UIEXBNeYmKptWH6z8ZnqTeS8fV74zG0/eRU9VGkpzz+LIJNs8W/zM/L+7ctCkRrgbNnnR0xxw4bKOr0cW0N0Og==\n \n+underscore@^1.9.1:\n+  version \"1.13.6\"\n+  resolved \"https://registry.yarnpkg.com/underscore/-/underscore-1.13.6.tgz#04786a1f589dc6c09f761fc5f45b89e935136441\"\n+  integrity sha512-+A5Sja4HP1M08MaXya7p5LvjuM7K6q/2EaC0+iovj/wOcMsTzMvDFbasi/oSapiwOlt252IqsKqPjCl7huKS0A==\n+\n union@~0.4.3:\n   version \"0.4.6\"\n   resolved \"https://registry.yarnpkg.com/union/-/union-0.4.6.tgz#198fbdaeba254e788b0efcb630bc11f24a2959e0\"\n   dependencies:\n     qs \"~2.3.3\"\n \n-unique-string@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/unique-string/-/unique-string-1.0.0.tgz#9e1057cca851abb93398f8b33ae187b99caec11a\"\n+unique-string@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/unique-string/-/unique-string-2.0.0.tgz#39c6451f81afb2749de2b233e3f7c5e8843bd89d\"\n+  integrity sha512-uNaeirEPvpZWSgzwsPGtU2zVSTrn/8L5q/IexZmH0eH6SA73CmAA5U4GwORTxQAZs95TAXLNqeLoPPNO5gZfWg==\n   dependencies:\n-    crypto-random-string \"^1.0.0\"\n-\n-unzip-response@^2.0.1:\n-  version \"2.0.1\"\n-  resolved \"https://registry.yarnpkg.com/unzip-response/-/unzip-response-2.0.1.tgz#d2f0f737d16b0615e72a6935ed04214572d56f97\"\n+    crypto-random-string \"^2.0.0\"\n \n-update-notifier@^2.1.0:\n-  version \"2.2.0\"\n-  resolved \"https://registry.yarnpkg.com/update-notifier/-/update-notifier-2.2.0.tgz#1b5837cf90c0736d88627732b661c138f86de72f\"\n+update-notifier@^4.1.0:\n+  version \"4.1.3\"\n+  resolved \"https://registry.yarnpkg.com/update-notifier/-/update-notifier-4.1.3.tgz#be86ee13e8ce48fb50043ff72057b5bd598e1ea3\"\n+  integrity sha512-Yld6Z0RyCYGB6ckIjffGOSOmHXj1gMeE7aROz4MG+XMkmixBX4jUngrGXNYz7wPKBmtoD4MnBa2Anu7RSKht/A==\n   dependencies:\n-    boxen \"^1.0.0\"\n-    chalk \"^1.0.0\"\n-    configstore \"^3.0.0\"\n+    boxen \"^4.2.0\"\n+    chalk \"^3.0.0\"\n+    configstore \"^5.0.1\"\n+    has-yarn \"^2.1.0\"\n     import-lazy \"^2.1.0\"\n-    is-npm \"^1.0.0\"\n-    latest-version \"^3.0.0\"\n-    semver-diff \"^2.0.0\"\n-    xdg-basedir \"^3.0.0\"\n+    is-ci \"^2.0.0\"\n+    is-installed-globally \"^0.3.1\"\n+    is-npm \"^4.0.0\"\n+    is-yarn-global \"^0.3.0\"\n+    latest-version \"^5.0.0\"\n+    pupa \"^2.0.1\"\n+    semver-diff \"^3.1.1\"\n+    xdg-basedir \"^4.0.0\"\n+\n+uri-js@^4.2.2:\n+  version \"4.4.1\"\n+  resolved \"https://registry.yarnpkg.com/uri-js/-/uri-js-4.4.1.tgz#9b1a52595225859e55f669d928f88c6c57f2a77e\"\n+  integrity sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg==\n+  dependencies:\n+    punycode \"^2.1.0\"\n \n url-join@^2.0.2:\n   version \"2.0.5\"\n   resolved \"https://registry.yarnpkg.com/url-join/-/url-join-2.0.5.tgz#5af22f18c052a000a48d7b82c5e9c2e2feeda728\"\n   integrity sha1-WvIvGMBSoACkjXuCxenC4v7tpyg=\n \n-url-parse-lax@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/url-parse-lax/-/url-parse-lax-1.0.0.tgz#7af8f303645e9bd79a272e7a14ac68bc0609da73\"\n+url-parse-lax@^3.0.0:\n+  version \"3.0.0\"\n+  resolved \"https://registry.yarnpkg.com/url-parse-lax/-/url-parse-lax-3.0.0.tgz#16b5cafc07dbe3676c1b1999177823d6503acb0c\"\n+  integrity sha512-NjFKA0DidqPa5ciFcSrXnAltTtzz84ogy+NebPvfEgAck0+TNg4UJ4IN+fB7zRZfbgUf0syOo9MDxFkDSMuFaQ==\n   dependencies:\n-    prepend-http \"^1.0.1\"\n+    prepend-http \"^2.0.0\"\n \n util-deprecate@~1.0.1:\n   version \"1.0.2\"\n@@ -1710,6 +2079,11 @@ uuid@^3.0.0:\n   version \"3.1.0\"\n   resolved \"https://registry.yarnpkg.com/uuid/-/uuid-3.1.0.tgz#3dd3d3e790abc24d7b0d3a034ffababe28ebbc04\"\n \n+uuid@^3.3.2:\n+  version \"3.4.0\"\n+  resolved \"https://registry.yarnpkg.com/uuid/-/uuid-3.4.0.tgz#b23e4358afa8a202fe7a100af1f5f883f02007ee\"\n+  integrity sha512-HjSDRw6gZE5JMggctHBcjVak08+KEVhSIiDzFnT9S9aegmp85S/bReBVTb4QTFaRNptJ9kuYaNhnbNEOkbKb/A==\n+\n verror@1.10.0:\n   version \"1.10.0\"\n   resolved \"https://registry.yarnpkg.com/verror/-/verror-1.10.0.tgz#3a105ca17053af55d6e270c1f8288682e18da400\"\n@@ -1718,7 +2092,7 @@ verror@1.10.0:\n     core-util-is \"1.0.2\"\n     extsprintf \"^1.2.0\"\n \n-which@1, which@^1.2.9:\n+which@1:\n   version \"1.3.0\"\n   resolved \"https://registry.yarnpkg.com/which/-/which-1.3.0.tgz#ff04bdfc010ee547d780bec38e1ac1c2777d253a\"\n   dependencies:\n@@ -1730,11 +2104,12 @@ wide-align@^1.1.0:\n   dependencies:\n     string-width \"^1.0.2\"\n \n-widest-line@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/widest-line/-/widest-line-1.0.0.tgz#0c09c85c2a94683d0d7eaf8ee097d564bf0e105c\"\n+widest-line@^3.1.0:\n+  version \"3.1.0\"\n+  resolved \"https://registry.yarnpkg.com/widest-line/-/widest-line-3.1.0.tgz#8292333bbf66cb45ff0de1603b136b7ae1496eca\"\n+  integrity sha512-NsmoXalsWVDMGupxZ5R08ka9flZjjiLvHVAWYOKtiKM8ujtZWr9cRffak+uSE48+Ob8ObalXpwyeUiyDD6QFgg==\n   dependencies:\n-    string-width \"^1.0.1\"\n+    string-width \"^4.0.0\"\n \n window-size@^0.1.4:\n   version \"0.1.4\"\n@@ -1755,13 +2130,15 @@ wrappy@1:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/wrappy/-/wrappy-1.0.2.tgz#b5243d8f3ec1aa35f1364605bc0d1036e30ab69f\"\n \n-write-file-atomic@^2.0.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/write-file-atomic/-/write-file-atomic-2.1.0.tgz#1769f4b551eedce419f0505deae2e26763542d37\"\n+write-file-atomic@^3.0.0:\n+  version \"3.0.3\"\n+  resolved \"https://registry.yarnpkg.com/write-file-atomic/-/write-file-atomic-3.0.3.tgz#56bd5c5a5c70481cd19c571bd39ab965a5de56e8\"\n+  integrity sha512-AvHcyZ5JnSfq3ioSyjrBkH9yW4m7Ayk8/9My/DD9onKeu/94fwrMocemO2QAJFAlnnDN+ZDS+ZjAR5ua1/PV/Q==\n   dependencies:\n-    graceful-fs \"^4.1.11\"\n     imurmurhash \"^0.1.4\"\n-    slide \"^1.1.5\"\n+    is-typedarray \"^1.0.0\"\n+    signal-exit \"^3.0.2\"\n+    typedarray-to-buffer \"^3.1.5\"\n \n ws@3.3.2:\n   version \"3.3.2\"\n@@ -1772,24 +2149,27 @@ ws@3.3.2:\n     safe-buffer \"~5.1.0\"\n     ultron \"~1.1.0\"\n \n-xdg-basedir@^3.0.0:\n-  version \"3.0.0\"\n-  resolved \"https://registry.yarnpkg.com/xdg-basedir/-/xdg-basedir-3.0.0.tgz#496b2cc109eca8dbacfe2dc72b603c17c5870ad4\"\n+xdg-basedir@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/xdg-basedir/-/xdg-basedir-4.0.0.tgz#4bc8d9984403696225ef83a1573cbbcb4e79db13\"\n+  integrity sha512-PSNhEJDejZYV7h50BohL09Er9VaIefr2LMAf3OEmpCkjOi34eYyQYAXUTjEQtZJTKcF0E2UKTh+osDLsgNim9Q==\n+\n+xmldom@0.1.19:\n+  version \"0.1.19\"\n+  resolved \"https://registry.yarnpkg.com/xmldom/-/xmldom-0.1.19.tgz#631fc07776efd84118bf25171b37ed4d075a0abc\"\n+  integrity sha512-pDyxjQSFQgNHkU+yjvoF+GXVGJU7e9EnOg/KcGMDihBIKjTsOeDYaECwC/O9bsUWKY+Sd9izfE43JXC46EOHKA==\n \n y18n@^3.2.0:\n   version \"3.2.1\"\n   resolved \"https://registry.yarnpkg.com/y18n/-/y18n-3.2.1.tgz#6d15fba884c08679c0d77e88e7759e811e07fa41\"\n \n-yallist@^2.1.2:\n-  version \"2.1.2\"\n-  resolved \"https://registry.yarnpkg.com/yallist/-/yallist-2.1.2.tgz#1c11f9218f076089a47dd512f93c6699a6a81d52\"\n-\n-yargs-parser@7.0.0:\n-  version \"7.0.0\"\n-  resolved \"https://registry.yarnpkg.com/yargs-parser/-/yargs-parser-7.0.0.tgz#8d0ac42f16ea55debd332caf4c4038b3e3f5dfd9\"\n-  integrity sha1-jQrELxbqVd69MyyvTEA4s+P139k=\n+yargs-parser@^18.1.3:\n+  version \"18.1.3\"\n+  resolved \"https://registry.yarnpkg.com/yargs-parser/-/yargs-parser-18.1.3.tgz#be68c4975c6b2abf469236b0c870362fab09a7b0\"\n+  integrity sha512-o50j0JeToy/4K6OZcaQmW6lyXXKhq7csREXcDwk2omFPJEwUNOVtJKvmDr9EI1fAJZUyZcRF7kxGBWmRXudrCQ==\n   dependencies:\n-    camelcase \"^4.1.0\"\n+    camelcase \"^5.0.0\"\n+    decamelize \"^1.2.0\"\n \n yargs@3.32.0:\n   version \"3.32.0\""
            },
            {
                "file": "scripts/bench/package.json",
                "git_diff": "@@ -11,7 +11,7 @@\n     \"cli-table\": \"^0.3.1\",\n     \"http-server\": \"^0.10.0\",\n     \"http2\": \"^3.3.6\",\n-    \"lighthouse\": \"^6.0.0\",\n+    \"lighthouse\": \"^9.5.0\",\n     \"mime\": \"^1.3.6\",\n     \"minimist\": \"^1.2.3\",\n     \"ncp\": \"^2.0.0\","
            },
            {
                "file": "scripts/bench/yarn.lock",
                "git_diff": "@@ -2,62 +2,96 @@\n # yarn lockfile v1\n \n \n-\"@sindresorhus/is@^0.14.0\":\n-  version \"0.14.0\"\n-  resolved \"https://registry.yarnpkg.com/@sindresorhus/is/-/is-0.14.0.tgz#9fb3a3cf3132328151f353de4632e01e52102bea\"\n-  integrity sha512-9NET910DNaIPngYnLLPeg+Ogzqsi9uM4mSboU5y6p8S5DzMTVEsJZrawi+BoDNUVBa2DhJqQYUFvMDfgU062LQ==\n-\n-\"@szmarczak/http-timer@^1.1.2\":\n-  version \"1.1.2\"\n-  resolved \"https://registry.yarnpkg.com/@szmarczak/http-timer/-/http-timer-1.1.2.tgz#b1665e2c461a2cd92f4c1bbf50d5454de0d4b421\"\n-  integrity sha512-XIB2XbzHTN6ieIjfIMV9hlVcfPU26s2vafYWQcZHWXHOxiaRZYEDKEwdl129Zyg50+foYV2jCgtrqSA6qNuNSA==\n-  dependencies:\n-    defer-to-connect \"^1.0.1\"\n+\"@sentry/core@6.19.7\":\n+  version \"6.19.7\"\n+  resolved \"https://registry.yarnpkg.com/@sentry/core/-/core-6.19.7.tgz#156aaa56dd7fad8c89c145be6ad7a4f7209f9785\"\n+  integrity sha512-tOfZ/umqB2AcHPGbIrsFLcvApdTm9ggpi/kQZFkej7kMphjT+SGBiQfYtjyg9jcRW+ilAR4JXC9BGKsdEQ+8Vw==\n+  dependencies:\n+    \"@sentry/hub\" \"6.19.7\"\n+    \"@sentry/minimal\" \"6.19.7\"\n+    \"@sentry/types\" \"6.19.7\"\n+    \"@sentry/utils\" \"6.19.7\"\n+    tslib \"^1.9.3\"\n+\n+\"@sentry/hub@6.19.7\":\n+  version \"6.19.7\"\n+  resolved \"https://registry.yarnpkg.com/@sentry/hub/-/hub-6.19.7.tgz#58ad7776bbd31e9596a8ec46365b45cd8b9cfd11\"\n+  integrity sha512-y3OtbYFAqKHCWezF0EGGr5lcyI2KbaXW2Ik7Xp8Mu9TxbSTuwTe4rTntwg8ngPjUQU3SUHzgjqVB8qjiGqFXCA==\n+  dependencies:\n+    \"@sentry/types\" \"6.19.7\"\n+    \"@sentry/utils\" \"6.19.7\"\n+    tslib \"^1.9.3\"\n+\n+\"@sentry/minimal@6.19.7\":\n+  version \"6.19.7\"\n+  resolved \"https://registry.yarnpkg.com/@sentry/minimal/-/minimal-6.19.7.tgz#b3ee46d6abef9ef3dd4837ebcb6bdfd01b9aa7b4\"\n+  integrity sha512-wcYmSJOdvk6VAPx8IcmZgN08XTXRwRtB1aOLZm+MVHjIZIhHoBGZJYTVQS/BWjldsamj2cX3YGbGXNunaCfYJQ==\n+  dependencies:\n+    \"@sentry/hub\" \"6.19.7\"\n+    \"@sentry/types\" \"6.19.7\"\n+    tslib \"^1.9.3\"\n+\n+\"@sentry/node@^6.17.4\":\n+  version \"6.19.7\"\n+  resolved \"https://registry.yarnpkg.com/@sentry/node/-/node-6.19.7.tgz#32963b36b48daebbd559e6f13b1deb2415448592\"\n+  integrity sha512-gtmRC4dAXKODMpHXKfrkfvyBL3cI8y64vEi3fDD046uqYcrWdgoQsffuBbxMAizc6Ez1ia+f0Flue6p15Qaltg==\n+  dependencies:\n+    \"@sentry/core\" \"6.19.7\"\n+    \"@sentry/hub\" \"6.19.7\"\n+    \"@sentry/types\" \"6.19.7\"\n+    \"@sentry/utils\" \"6.19.7\"\n+    cookie \"^0.4.1\"\n+    https-proxy-agent \"^5.0.0\"\n+    lru_map \"^0.3.3\"\n+    tslib \"^1.9.3\"\n+\n+\"@sentry/types@6.19.7\":\n+  version \"6.19.7\"\n+  resolved \"https://registry.yarnpkg.com/@sentry/types/-/types-6.19.7.tgz#c6b337912e588083fc2896eb012526cf7cfec7c7\"\n+  integrity sha512-jH84pDYE+hHIbVnab3Hr+ZXr1v8QABfhx39KknxqKWr2l0oEItzepV0URvbEhB446lk/S/59230dlUUIBGsXbg==\n+\n+\"@sentry/utils@6.19.7\":\n+  version \"6.19.7\"\n+  resolved \"https://registry.yarnpkg.com/@sentry/utils/-/utils-6.19.7.tgz#6edd739f8185fd71afe49cbe351c1bbf5e7b7c79\"\n+  integrity sha512-z95ECmE3i9pbWoXQrD/7PgkBAzJYR+iXtPuTkpBjDKs86O3mT+PXOT3BAn79w2wkn7/i3vOGD2xVr1uiMl26dA==\n+  dependencies:\n+    \"@sentry/types\" \"6.19.7\"\n+    tslib \"^1.9.3\"\n \n \"@types/node@*\":\n   version \"10.12.0\"\n   resolved \"https://registry.yarnpkg.com/@types/node/-/node-10.12.0.tgz#ea6dcbddbc5b584c83f06c60e82736d8fbb0c235\"\n   integrity sha512-3TUHC3jsBAB7qVRGxT6lWyYo2v96BMmD2PTcl47H25Lu7UXtFH/2qqmKiVrnel6Ne//0TFYf6uvNX+HW2FRkLQ==\n \n-JSV@^4.0.2:\n-  version \"4.0.2\"\n-  resolved \"https://registry.yarnpkg.com/JSV/-/JSV-4.0.2.tgz#d077f6825571f82132f9dffaed587b4029feff57\"\n-  integrity sha512-ZJ6wx9xaKJ3yFUhq5/sk82PJMuUyLk277I8mQeyDgCTjGdjWJIvPfaU5LIXaMuaN2UO1X3kZH4+lgphublZUHw==\n+\"@types/yauzl@^2.9.1\":\n+  version \"2.10.3\"\n+  resolved \"https://registry.yarnpkg.com/@types/yauzl/-/yauzl-2.10.3.tgz#e9b2808b4f109504a03cda958259876f61017999\"\n+  integrity sha512-oJoftv0LSuaDZE3Le4DbKX+KS9G36NzOeSap90UIK0yMA/NhKJhqlSGtNDORNRaIbQfzjXDrQa0ytJ6mNRGz/Q==\n+  dependencies:\n+    \"@types/node\" \"*\"\n \n abbrev@1:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/abbrev/-/abbrev-1.1.0.tgz#d0554c2256636e2f56e7c2e5ad183f859428d81f\"\n \n+agent-base@6:\n+  version \"6.0.2\"\n+  resolved \"https://registry.yarnpkg.com/agent-base/-/agent-base-6.0.2.tgz#49fff58577cfee3f37176feab4c22e00f86d7f77\"\n+  integrity sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==\n+  dependencies:\n+    debug \"4\"\n+\n ajv@^4.9.1:\n   version \"4.11.8\"\n   resolved \"https://registry.yarnpkg.com/ajv/-/ajv-4.11.8.tgz#82ffb02b29e662ae53bdc20af15947706739c536\"\n   dependencies:\n     co \"^4.6.0\"\n     json-stable-stringify \"^1.0.1\"\n \n-ajv@^6.12.3:\n-  version \"6.12.6\"\n-  resolved \"https://registry.yarnpkg.com/ajv/-/ajv-6.12.6.tgz#baf5a62e802b07d977034586f8c3baf5adf26df4\"\n-  integrity sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g==\n-  dependencies:\n-    fast-deep-equal \"^3.1.1\"\n-    fast-json-stable-stringify \"^2.0.0\"\n-    json-schema-traverse \"^0.4.1\"\n-    uri-js \"^4.2.2\"\n-\n-ansi-align@^3.0.0:\n-  version \"3.0.1\"\n-  resolved \"https://registry.yarnpkg.com/ansi-align/-/ansi-align-3.0.1.tgz#0cdf12e111ace773a86e9a1fad1225c43cb19a59\"\n-  integrity sha512-IOfwwBF5iczOjp/WeY4YxyjqAFMQoZufdQWDd19SEExbVLNXqvpzSJ/M7Za4/sCPmQ0+GRquoA7bGcINcxew6w==\n-  dependencies:\n-    string-width \"^4.1.0\"\n-\n-ansi-escapes@^4.2.1:\n-  version \"4.3.2\"\n-  resolved \"https://registry.yarnpkg.com/ansi-escapes/-/ansi-escapes-4.3.2.tgz#6b2291d1db7d98b6521d5f1efa42d0f3a9feb65e\"\n-  integrity sha512-gKXj5ALrKWQLsYG9jlTRmR/xKluxHV+Z9QEwNIgCfM1/uwPMCuzVVnh5mwTd+OuBZcwSIMbqssNWRm1lE51QaQ==\n-  dependencies:\n-    type-fest \"^0.21.3\"\n+ansi-colors@^4.1.1:\n+  version \"4.1.3\"\n+  resolved \"https://registry.yarnpkg.com/ansi-colors/-/ansi-colors-4.1.3.tgz#37611340eb2243e70cc604cad35d63270d48781b\"\n+  integrity sha512-/6w/C21Pm1A7aZitlI5Ni/2J6FFQN8i1Cvz3kHABAAbw93v/NlvKdVOqz7CCWz/3iv/JplRSEEZ83XION15ovw==\n \n ansi-regex@^2.0.0:\n   version \"2.1.1\"\n@@ -74,14 +108,7 @@ ansi-styles@^3.1.0:\n   dependencies:\n     color-convert \"^1.9.0\"\n \n-ansi-styles@^3.2.1:\n-  version \"3.2.1\"\n-  resolved \"https://registry.yarnpkg.com/ansi-styles/-/ansi-styles-3.2.1.tgz#41fbb20243e50b12be0f04b8dedbf07520ce841d\"\n-  integrity sha512-VT0ZI6kZRdTh8YyJw3SMbYm/u+NqfsAxEpWO0Pf9sq8/e94WxxOpPKx9FR1FlyCtOVDNOQ+8ntlqFxiRc+r5qA==\n-  dependencies:\n-    color-convert \"^1.9.0\"\n-\n-ansi-styles@^4.1.0:\n+ansi-styles@^4.0.0:\n   version \"4.3.0\"\n   resolved \"https://registry.yarnpkg.com/ansi-styles/-/ansi-styles-4.3.0.tgz#edd803628ae71c04c85ae7a0906edad34b648937\"\n   integrity sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==\n@@ -115,11 +142,6 @@ assert-plus@^0.2.0:\n   version \"0.2.0\"\n   resolved \"https://registry.yarnpkg.com/assert-plus/-/assert-plus-0.2.0.tgz#d74e1b87e7affc0db8aadb7021f3fe48101ab234\"\n \n-async-limiter@~1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/async-limiter/-/async-limiter-1.0.0.tgz#78faed8c3d074ab81f22b4e985d79e8738f720f8\"\n-  integrity sha512-jp/uFnooOiO+L211eZOoSyzpOITMXx1rBITauYykG3BRYPu8h0UcxsPNB04RR5vo4Tyz3+ay17tR6JVf9qzYWg==\n-\n async@^1.5.2:\n   version \"1.5.2\"\n   resolved \"https://registry.yarnpkg.com/async/-/async-1.5.2.tgz#ec6a61ae56480c0c3cb241c95618e20892f9672a\"\n@@ -132,35 +154,39 @@ aws-sign2@~0.6.0:\n   version \"0.6.0\"\n   resolved \"https://registry.yarnpkg.com/aws-sign2/-/aws-sign2-0.6.0.tgz#14342dd38dbcc94d0e5b87d763cd63612c0e794f\"\n \n-aws-sign2@~0.7.0:\n-  version \"0.7.0\"\n-  resolved \"https://registry.yarnpkg.com/aws-sign2/-/aws-sign2-0.7.0.tgz#b46e890934a9591f2d2f6f86d7e6a9f1b3fe76a8\"\n-  integrity sha512-08kcGqnYf/YmjoRhfxyu+CLxBjUtHLXLXX/vUfx9l2LYzG3c1m61nrpyFUZI6zeS+Li/wWMMidD9KgrqtGq3mA==\n-\n aws4@^1.2.1:\n   version \"1.6.0\"\n   resolved \"https://registry.yarnpkg.com/aws4/-/aws4-1.6.0.tgz#83ef5ca860b2b32e4a0deedee8c771b9db57471e\"\n \n-aws4@^1.8.0:\n-  version \"1.12.0\"\n-  resolved \"https://registry.yarnpkg.com/aws4/-/aws4-1.12.0.tgz#ce1c9d143389679e253b314241ea9aa5cec980d3\"\n-  integrity sha512-NmWvPnx0F1SfrQbYwOi7OeaNGokp9XhzNioJ/CSBs8Qa4vxug81mhJEAVZwxXuBmYB5KDRfMq/F3RR0BIU7sWg==\n-\n-axe-core@3.5.5:\n-  version \"3.5.5\"\n-  resolved \"https://registry.yarnpkg.com/axe-core/-/axe-core-3.5.5.tgz#84315073b53fa3c0c51676c588d59da09a192227\"\n-  integrity sha512-5P0QZ6J5xGikH780pghEdbEKijCTrruK9KxtPZCFWUpef0f6GipO+xEZ5GKCb020mmqgbiNO6TcA55CriL784Q==\n+axe-core@4.4.1:\n+  version \"4.4.1\"\n+  resolved \"https://registry.yarnpkg.com/axe-core/-/axe-core-4.4.1.tgz#7dbdc25989298f9ad006645cd396782443757413\"\n+  integrity sha512-gd1kmb21kwNuWr6BQz8fv6GNECPBnUasepcoLbekws23NVBLODdsClRZ+bQ8+9Uomf3Sm3+Vwn0oYG9NvwnJCw==\n \n balanced-match@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/balanced-match/-/balanced-match-1.0.0.tgz#89b4d199ab2bee49de164ea02b89ce462d71b767\"\n \n+base64-js@^1.3.1:\n+  version \"1.5.1\"\n+  resolved \"https://registry.yarnpkg.com/base64-js/-/base64-js-1.5.1.tgz#1b1b440160a5bf7ad40b650f095963481903930a\"\n+  integrity sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==\n+\n bcrypt-pbkdf@^1.0.0:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/bcrypt-pbkdf/-/bcrypt-pbkdf-1.0.1.tgz#63bc5dcb61331b92bc05fd528953c33462a06f8d\"\n   dependencies:\n     tweetnacl \"^0.14.3\"\n \n+bl@^4.0.3:\n+  version \"4.1.0\"\n+  resolved \"https://registry.yarnpkg.com/bl/-/bl-4.1.0.tgz#451535264182bec2fbbc83a62ab98cf11d9f7b3a\"\n+  integrity sha512-1W07cM9gS6DcLperZfFSj+bWLtaPGSOHWhPiGzXmvVJbRLdG82sH/Kn8EtW1VqWVA54AKf2h5k5BbnIbwF3h6w==\n+  dependencies:\n+    buffer \"^5.5.0\"\n+    inherits \"^2.0.4\"\n+    readable-stream \"^3.4.0\"\n+\n block-stream@*:\n   version \"0.0.9\"\n   resolved \"https://registry.yarnpkg.com/block-stream/-/block-stream-0.0.9.tgz#13ebfe778a03205cfe03751481ebb4b3300c126a\"\n@@ -173,53 +199,25 @@ boom@2.x.x:\n   dependencies:\n     hoek \"2.x.x\"\n \n-boxen@^4.2.0:\n-  version \"4.2.0\"\n-  resolved \"https://registry.yarnpkg.com/boxen/-/boxen-4.2.0.tgz#e411b62357d6d6d36587c8ac3d5d974daa070e64\"\n-  integrity sha512-eB4uT9RGzg2odpER62bBwSLvUeGC+WbRjjyyFhGsKnc8wp/m0+hQsMUvUe3H2V0D5vw0nBdO1hCJoZo5mKeuIQ==\n-  dependencies:\n-    ansi-align \"^3.0.0\"\n-    camelcase \"^5.3.1\"\n-    chalk \"^3.0.0\"\n-    cli-boxes \"^2.2.0\"\n-    string-width \"^4.1.0\"\n-    term-size \"^2.1.0\"\n-    type-fest \"^0.8.1\"\n-    widest-line \"^3.1.0\"\n-\n brace-expansion@^1.1.7:\n   version \"1.1.8\"\n   resolved \"https://registry.yarnpkg.com/brace-expansion/-/brace-expansion-1.1.8.tgz#c07b211c7c952ec1f8efd51a77ef0d1d3990a292\"\n   dependencies:\n     balanced-match \"^1.0.0\"\n     concat-map \"0.0.1\"\n \n-cacheable-request@^6.0.0:\n-  version \"6.1.0\"\n-  resolved \"https://registry.yarnpkg.com/cacheable-request/-/cacheable-request-6.1.0.tgz#20ffb8bd162ba4be11e9567d823db651052ca912\"\n-  integrity sha512-Oj3cAGPCqOZX7Rz64Uny2GYAZNliQSqfbePrgAQ1wKAihYmCUnraBtJtKcGR4xz7wF+LoJC+ssFZvv5BgF9Igg==\n-  dependencies:\n-    clone-response \"^1.0.2\"\n-    get-stream \"^5.1.0\"\n-    http-cache-semantics \"^4.0.0\"\n-    keyv \"^3.0.0\"\n-    lowercase-keys \"^2.0.0\"\n-    normalize-url \"^4.1.0\"\n-    responselike \"^1.0.2\"\n+buffer-crc32@~0.2.3:\n+  version \"0.2.13\"\n+  resolved \"https://registry.yarnpkg.com/buffer-crc32/-/buffer-crc32-0.2.13.tgz#0d333e3f00eac50aa1454abd30ef8c2a5d9a7242\"\n+  integrity sha512-VO9Ht/+p3SN7SKWqcrgEzjGbRSJYTx+Q1pTQC0wrWqHx0vpJraQ6GtHx8tvcg1rlK1byhU5gccxgOgj7B0TDkQ==\n \n-camelcase@^2.0.1:\n-  version \"2.1.1\"\n-  resolved \"https://registry.yarnpkg.com/camelcase/-/camelcase-2.1.1.tgz#7c1d16d679a1bbe59ca02cacecfb011e201f5a1f\"\n-\n-camelcase@^5.0.0, camelcase@^5.3.1:\n-  version \"5.3.1\"\n-  resolved \"https://registry.yarnpkg.com/camelcase/-/camelcase-5.3.1.tgz#e3c9b31569e106811df242f715725a1f4c494320\"\n-  integrity sha512-L28STB170nwWS63UjtlEOE3dldQApaJXZkOI1uMFfzf3rRuPegHaHesyee+YxQ+W6SvRDQV6UrdOdRiR153wJg==\n-\n-canonicalize@^1.0.1:\n-  version \"1.0.8\"\n-  resolved \"https://registry.yarnpkg.com/canonicalize/-/canonicalize-1.0.8.tgz#24d1f1a00ed202faafd9bf8e63352cd4450c6df1\"\n-  integrity sha512-0CNTVCLZggSh7bc5VkX5WWPWO+cyZbNd07IHIsSXLia/eAq+r836hgk+8BKoEh7949Mda87VUOitx5OddVj64A==\n+buffer@^5.2.1, buffer@^5.5.0:\n+  version \"5.7.1\"\n+  resolved \"https://registry.yarnpkg.com/buffer/-/buffer-5.7.1.tgz#ba62e7c13133053582197160851a8f648e99eed0\"\n+  integrity sha512-EHcyIPBQ4BSGlvjB16k5KgAJ27CIsHY/2JBmCRReo48y9rQ3MaUzWX3KVlBa4U7MyX02HdVj0K7C3WaB3ju7FQ==\n+  dependencies:\n+    base64-js \"^1.3.1\"\n+    ieee754 \"^1.1.13\"\n \n caseless@~0.12.0:\n   version \"0.12.0\"\n@@ -233,42 +231,12 @@ chalk@^2.1.0:\n     escape-string-regexp \"^1.0.5\"\n     supports-color \"^4.0.0\"\n \n-chalk@^2.4.2:\n-  version \"2.4.2\"\n-  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-2.4.2.tgz#cd42541677a54333cf541a49108c1432b44c9424\"\n-  integrity sha512-Mti+f9lpJNcwF4tWV8/OrTTtF1gZi+f8FqlyAdouralcFWFQWF2+NgCHShjkCb+IFBLq9buZwE1xckQU4peSuQ==\n-  dependencies:\n-    ansi-styles \"^3.2.1\"\n-    escape-string-regexp \"^1.0.5\"\n-    supports-color \"^5.3.0\"\n-\n-chalk@^3.0.0:\n-  version \"3.0.0\"\n-  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-3.0.0.tgz#3f73c2bf526591f574cc492c51e2456349f844e4\"\n-  integrity sha512-4D3B6Wf41KOYRFdszmDqMCGq5VV/uMAB273JILmO+3jAlh8X4qDtdtgCR3fxtbLEMzSx22QdhnDcJvu2u1fVwg==\n-  dependencies:\n-    ansi-styles \"^4.1.0\"\n-    supports-color \"^7.1.0\"\n-\n-chalk@^4.1.0:\n-  version \"4.1.2\"\n-  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-4.1.2.tgz#aac4e2b7734a740867aeb16bf02aad556a1e7a01\"\n-  integrity sha512-oKnbhFyRIXpUuez8iBMmyEa4nbj4IOQyuhc/wy9kY7/WVPcwIO9VA668Pu8RkO7+0G76SLROeyw9CpQ061i4mA==\n-  dependencies:\n-    ansi-styles \"^4.1.0\"\n-    supports-color \"^7.1.0\"\n-\n-chardet@^0.7.0:\n-  version \"0.7.0\"\n-  resolved \"https://registry.yarnpkg.com/chardet/-/chardet-0.7.0.tgz#90094849f0937f2eedc2425d0d28a9e5f0cbad9e\"\n-  integrity sha512-mT8iDcrh03qDGRRmoA2hmBJnxpllMR+0/0qlzjqZES6NdiWDcZkCNAk4rPFZ9Q85r27unkiNNg8ZOiwZXBHwcA==\n-\n-charenc@~0.0.1:\n-  version \"0.0.2\"\n-  resolved \"https://registry.yarnpkg.com/charenc/-/charenc-0.0.2.tgz#c0a1d2f3a7092e03774bfa83f14c0fc5790a8667\"\n-  integrity sha1-wKHS86cJLgN3S/qD8UwPxXkKhmc=\n+chownr@^1.1.1:\n+  version \"1.1.4\"\n+  resolved \"https://registry.yarnpkg.com/chownr/-/chownr-1.1.4.tgz#6fc9d7b42d32a583596337666e7d08084da2cc6b\"\n+  integrity sha512-jJ0bqzaylmJtVnNgzTeSOs8DPavpbYgEr/b0YL8/2GO3xJEhInFmhKMUnEJQjZumK7KXGFhUy89PrsJWlakBVg==\n \n-chrome-launcher@^0.13.2, chrome-launcher@^0.13.4:\n+chrome-launcher@^0.13.2:\n   version \"0.13.4\"\n   resolved \"https://registry.yarnpkg.com/chrome-launcher/-/chrome-launcher-0.13.4.tgz#4c7d81333c98282899c4e38256da23e00ed32f73\"\n   integrity sha512-nnzXiDbGKjDSK6t2I+35OAPBy5Pw/39bgkb/ZAFwMhwJbdYBp6aH+vW28ZgtjdU890Q7D+3wN/tB8N66q5Gi2A==\n@@ -280,48 +248,30 @@ chrome-launcher@^0.13.2, chrome-launcher@^0.13.4:\n     mkdirp \"^0.5.3\"\n     rimraf \"^3.0.2\"\n \n-ci-info@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/ci-info/-/ci-info-2.0.0.tgz#67a9e964be31a51e15e5010d58e6f12834002f46\"\n-  integrity sha512-5tK7EtrZ0N+OLFMthtqOj4fI2Jeb88C4CAZPu25LDVUgXJ0A3Js4PMGqrn0JU1W0Mh1/Z8wZzYPxqUrXeBboCQ==\n-\n-cli-boxes@^2.2.0:\n-  version \"2.2.1\"\n-  resolved \"https://registry.yarnpkg.com/cli-boxes/-/cli-boxes-2.2.1.tgz#ddd5035d25094fce220e9cab40a45840a440318f\"\n-  integrity sha512-y4coMcylgSCdVinjiDBuR8PCC2bLjyGTwEmPb9NHR/QaNU6EUOXcTY/s6VjGMD6ENSEaeQYHCY0GNGS5jfMwPw==\n-\n-cli-cursor@^3.1.0:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/cli-cursor/-/cli-cursor-3.1.0.tgz#264305a7ae490d1d03bf0c9ba7c925d1753af307\"\n-  integrity sha512-I/zHAwsKf9FqGoXM4WWRACob9+SNukZTd94DWF57E4toouRulbCxcUh6RKUEOQlYTHJnzkPMySvPNaaSLNfLZw==\n+chrome-launcher@^0.15.0:\n+  version \"0.15.2\"\n+  resolved \"https://registry.yarnpkg.com/chrome-launcher/-/chrome-launcher-0.15.2.tgz#4e6404e32200095fdce7f6a1e1004f9bd36fa5da\"\n+  integrity sha512-zdLEwNo3aUVzIhKhTtXfxhdvZhUghrnmkvcAq2NoDd+LeOHKf03H5jwZ8T/STsAlzyALkBVK552iaG1fGf1xVQ==\n   dependencies:\n-    restore-cursor \"^3.1.0\"\n+    \"@types/node\" \"*\"\n+    escape-string-regexp \"^4.0.0\"\n+    is-wsl \"^2.2.0\"\n+    lighthouse-logger \"^1.0.0\"\n \n cli-table@^0.3.1:\n   version \"0.3.1\"\n   resolved \"https://registry.yarnpkg.com/cli-table/-/cli-table-0.3.1.tgz#f53b05266a8b1a0b934b3d0821e6e2dc5914ae23\"\n   dependencies:\n     colors \"1.0.3\"\n \n-cli-width@^3.0.0:\n-  version \"3.0.0\"\n-  resolved \"https://registry.yarnpkg.com/cli-width/-/cli-width-3.0.0.tgz#a2f48437a2caa9a22436e794bf071ec9e61cedf6\"\n-  integrity sha512-FxqpkPPwu1HjuN93Omfm4h8uIanXofW0RxVEW3k5RKx+mJJYSthzNhp32Kzxxy3YAEZ/Dc/EWN1vZRY0+kOhbw==\n-\n-cliui@^3.0.3:\n-  version \"3.2.0\"\n-  resolved \"https://registry.yarnpkg.com/cliui/-/cliui-3.2.0.tgz#120601537a916d29940f934da3b48d585a39213d\"\n+cliui@^8.0.1:\n+  version \"8.0.1\"\n+  resolved \"https://registry.yarnpkg.com/cliui/-/cliui-8.0.1.tgz#0c04b075db02cbfe60dc8e6cf2f5486b1a3608aa\"\n+  integrity sha512-BSeNnyus75C4//NQ9gQt1/csTXyo/8Sb+afLAkzAptFuMsod9HFokGNudZpi/oQV73hnVK+sR+5PVRMd+Dr7YQ==\n   dependencies:\n-    string-width \"^1.0.1\"\n-    strip-ansi \"^3.0.1\"\n-    wrap-ansi \"^2.0.0\"\n-\n-clone-response@^1.0.2:\n-  version \"1.0.3\"\n-  resolved \"https://registry.yarnpkg.com/clone-response/-/clone-response-1.0.3.tgz#af2032aa47816399cf5f0a1d0db902f517abb8c3\"\n-  integrity sha512-ROoL94jJH2dUVML2Y/5PEDNaSHgeOdSDicUyS7izcF63G6sTc/FTjLub4b8Il9S8S0beOfYt0TaA5qvFK+w0wA==\n-  dependencies:\n-    mimic-response \"^1.0.0\"\n+    string-width \"^4.2.0\"\n+    strip-ansi \"^6.0.1\"\n+    wrap-ansi \"^7.0.0\"\n \n co@^4.6.0:\n   version \"4.6.0\"\n@@ -363,13 +313,6 @@ combined-stream@^1.0.5, combined-stream@~1.0.5:\n   dependencies:\n     delayed-stream \"~1.0.0\"\n \n-combined-stream@^1.0.6, combined-stream@~1.0.6:\n-  version \"1.0.8\"\n-  resolved \"https://registry.yarnpkg.com/combined-stream/-/combined-stream-1.0.8.tgz#c3d45a8b34fd730631a110a8a2520682b31d5a7f\"\n-  integrity sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==\n-  dependencies:\n-    delayed-stream \"~1.0.0\"\n-\n concat-map@0.0.1:\n   version \"0.0.1\"\n   resolved \"https://registry.yarnpkg.com/concat-map/-/concat-map-0.0.1.tgz#d8a96bd77fd68df7793a73036a3ba0d5405d477b\"\n@@ -390,10 +333,10 @@ console-control-strings@^1.0.0, console-control-strings@~1.1.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/console-control-strings/-/console-control-strings-1.1.0.tgz#3d7cf4464db6446ea644bf4b39507f9851008e8e\"\n \n-cookie@0.3.1:\n-  version \"0.3.1\"\n-  resolved \"https://registry.yarnpkg.com/cookie/-/cookie-0.3.1.tgz#e7e0a1f9ef43b4c8ba925c5c5a96e806d16873bb\"\n-  integrity sha1-5+Ch+e9DtMi6klxcWpboBtFoc7s=\n+cookie@^0.4.1:\n+  version \"0.4.2\"\n+  resolved \"https://registry.yarnpkg.com/cookie/-/cookie-0.4.2.tgz#0e41f24de5ecf317947c82fc789e06a884824432\"\n+  integrity sha512-aSWTXFzaKWkvHO1Ny/s+ePFpvKsPnjc551iI41v3ny/ow6tBG5Vd+FuqGNhh1LxOmVzOlGUriIlOaokOvhaStA==\n \n core-util-is@1.0.2, core-util-is@~1.0.0:\n   version \"1.0.2\"\n@@ -403,10 +346,12 @@ corser@~2.0.0:\n   version \"2.0.1\"\n   resolved \"https://registry.yarnpkg.com/corser/-/corser-2.0.1.tgz#8eda252ecaab5840dcd975ceb90d9370c819ff87\"\n \n-crypt@~0.0.1:\n-  version \"0.0.2\"\n-  resolved \"https://registry.yarnpkg.com/crypt/-/crypt-0.0.2.tgz#88d7ff7ec0dfb86f713dc87bbb42d044d3e6c41b\"\n-  integrity sha1-iNf/fsDfuG9xPch7u0LQRNPmxBs=\n+cross-fetch@3.1.5:\n+  version \"3.1.5\"\n+  resolved \"https://registry.yarnpkg.com/cross-fetch/-/cross-fetch-3.1.5.tgz#e1389f44d9e7ba767907f7af8454787952ab534f\"\n+  integrity sha512-lvb1SBsI0Z7GDwmuid+mU3kWVBwTVUbe7S0H52yaaAdQOXq2YktTCZdlAcNKFzE6QtRz0snpw9bNiPeOIkkQvw==\n+  dependencies:\n+    node-fetch \"2.6.7\"\n \n cryptiles@2.x.x:\n   version \"2.0.5\"\n@@ -419,6 +364,11 @@ crypto-random-string@^2.0.0:\n   resolved \"https://registry.yarnpkg.com/crypto-random-string/-/crypto-random-string-2.0.0.tgz#ef2a7a966ec11083388369baa02ebead229b30d5\"\n   integrity sha512-v1plID3y9r/lPhviJ1wrXpLeyUIGAZ2SHNYTEapm7/8A9nLPoyvVp3RK/EPFqn5kEznyWgYZNsRtYYIWbuG8KA==\n \n+csp_evaluator@1.1.1:\n+  version \"1.1.1\"\n+  resolved \"https://registry.yarnpkg.com/csp_evaluator/-/csp_evaluator-1.1.1.tgz#12b7bb0c6ae9053d30c86e8ddc52a1e920e6c0f7\"\n+  integrity sha512-N3ASg0C4kNPUaNxt1XAvzHIVuzdtr8KLgfk1O8WDyimp1GisPAHESupArO2ieHk9QWbrJ/WkQODyh21Ps/xhxw==\n+\n cssom@0.3.x:\n   version \"0.3.4\"\n   resolved \"https://registry.yarnpkg.com/cssom/-/cssom-0.3.4.tgz#8cd52e8a3acfd68d3aed38ee0a640177d2f9d797\"\n@@ -437,6 +387,13 @@ dashdash@^1.12.0:\n   dependencies:\n     assert-plus \"^1.0.0\"\n \n+debug@4, debug@4.3.4, debug@^4.1.1:\n+  version \"4.3.4\"\n+  resolved \"https://registry.yarnpkg.com/debug/-/debug-4.3.4.tgz#1319f6579357f2338d3337d2cdd4914bb5dcc865\"\n+  integrity sha512-PRWFHuSU3eDtQJPvnNY7Jcket1j0t5OuOsFzPPzsekD52Zl8qUfFIPEiswXqIvHWGVHOgX+7G/vCNNhehwxfkQ==\n+  dependencies:\n+    ms \"2.1.2\"\n+\n debug@^2.2.0:\n   version \"2.6.8\"\n   resolved \"https://registry.yarnpkg.com/debug/-/debug-2.6.8.tgz#e731531ca2ede27d188222427da17821d68ff4fc\"\n@@ -450,30 +407,14 @@ debug@^2.6.8, debug@^2.6.9:\n   dependencies:\n     ms \"2.0.0\"\n \n-decamelize@^1.1.1, decamelize@^1.2.0:\n-  version \"1.2.0\"\n-  resolved \"https://registry.yarnpkg.com/decamelize/-/decamelize-1.2.0.tgz#f6534d15148269b20352e7bee26f501f9a191290\"\n-\n-decompress-response@^3.3.0:\n-  version \"3.3.0\"\n-  resolved \"https://registry.yarnpkg.com/decompress-response/-/decompress-response-3.3.0.tgz#80a4dd323748384bfa248083622aedec982adff3\"\n-  integrity sha512-BzRPQuY1ip+qDonAOz42gRm/pg9F768C+npV/4JOsxRC2sq+Rlk+Q4ZCAsOhnIaMrgarILY+RMUIvMmmX1qAEA==\n-  dependencies:\n-    mimic-response \"^1.0.0\"\n-\n-deep-extend@^0.6.0:\n-  version \"0.6.0\"\n-  resolved \"https://registry.yarnpkg.com/deep-extend/-/deep-extend-0.6.0.tgz#c4fa7c95404a17a9c3e8ca7e1537312b736330ac\"\n-  integrity sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA==\n-\n deep-extend@~0.4.0:\n   version \"0.4.2\"\n   resolved \"https://registry.yarnpkg.com/deep-extend/-/deep-extend-0.4.2.tgz#48b699c27e334bf89f10892be432f6e4c7d34a7f\"\n \n-defer-to-connect@^1.0.1:\n-  version \"1.1.3\"\n-  resolved \"https://registry.yarnpkg.com/defer-to-connect/-/defer-to-connect-1.1.3.tgz#331ae050c08dcf789f8c83a7b81f0ed94f4ac591\"\n-  integrity sha512-0ISdNousHvZT2EiFlZeZAHBUvSxmKswVCEf8hW7KWgG4a8MVEu/3Vb6uWYozkjylyCxe0JBIiRB1jV45S70WVQ==\n+define-lazy-prop@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/define-lazy-prop/-/define-lazy-prop-2.0.0.tgz#3f7ae421129bcaaac9bc74905c98a0009ec9ee7f\"\n+  integrity sha512-Ds09qNh8yw3khSjiJjiUInaGX9xlqZDY7JVryGxdxV7NPeuqQfplOpQ66yJFZut3jLa5zOwkXw1g9EI2uKh4Og==\n \n delayed-stream@~1.0.0:\n   version \"1.0.0\"\n@@ -483,10 +424,10 @@ delegates@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/delegates/-/delegates-1.0.0.tgz#84c6e159b81904fdca59a0ef44cd870d31250f9a\"\n \n-details-element-polyfill@^2.4.0:\n-  version \"2.4.0\"\n-  resolved \"https://registry.yarnpkg.com/details-element-polyfill/-/details-element-polyfill-2.4.0.tgz#e0622adef7902662faf27b4ab8acba5dc4e3a6e6\"\n-  integrity sha512-jnZ/m0+b1gz3EcooitqL7oDEkKHEro659dt8bWB/T/HjiILucoQhHvvi5MEOAIFJXxxO+rIYJ/t3qCgfUOSU5g==\n+devtools-protocol@0.0.981744:\n+  version \"0.0.981744\"\n+  resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.981744.tgz#9960da0370284577d46c28979a0b32651022bacf\"\n+  integrity sha512-0cuGS8+jhR67Fy7qG3i3Pc7Aw494sb9yG9QgpG97SFVWwolgYjlhJg7n+UaHxOQT30d1TYu/EYe9k01ivLErIg==\n \n dot-prop@^5.2.0:\n   version \"5.3.0\"\n@@ -495,10 +436,6 @@ dot-prop@^5.2.0:\n   dependencies:\n     is-obj \"^2.0.0\"\n \n-duplexer3@^0.1.4:\n-  version \"0.1.4\"\n-  resolved \"https://registry.yarnpkg.com/duplexer3/-/duplexer3-0.1.4.tgz#ee01dd1cac0ed3cbc7fdbea37dc0a8f1ce002ce2\"\n-\n ecc-jsbn@~0.1.1:\n   version \"0.1.1\"\n   resolved \"https://registry.yarnpkg.com/ecc-jsbn/-/ecc-jsbn-0.1.1.tgz#0fc73a9ed5f0d53c38193398523ef7e543777505\"\n@@ -520,22 +457,35 @@ emoji-regex@^8.0.0:\n   resolved \"https://registry.yarnpkg.com/emoji-regex/-/emoji-regex-8.0.0.tgz#e818fd69ce5ccfcb404594f842963bf53164cc37\"\n   integrity sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==\n \n-end-of-stream@^1.1.0:\n+end-of-stream@^1.1.0, end-of-stream@^1.4.1:\n   version \"1.4.4\"\n   resolved \"https://registry.yarnpkg.com/end-of-stream/-/end-of-stream-1.4.4.tgz#5ae64a5f45057baf3626ec14da0ca5e4b2431eb0\"\n   integrity sha512-+uw1inIHVPQoaVuHzRyXd21icM+cnt4CzD5rW+NC1wjOUSTOs+Te7FOv7AhN7vS9x/oIyhLP5PR1H+phQAHu5Q==\n   dependencies:\n     once \"^1.4.0\"\n \n-escape-goat@^2.0.0:\n-  version \"2.1.1\"\n-  resolved \"https://registry.yarnpkg.com/escape-goat/-/escape-goat-2.1.1.tgz#1b2dc77003676c457ec760b2dc68edb648188675\"\n-  integrity sha512-8/uIhbG12Csjy2JEW7D9pHbreaVaS/OpN3ycnyvElTdwM5n6GY6W6e2IPemfvGZeUMqZ9A/3GqIZMgKnBhAw/Q==\n+enquirer@^2.3.6:\n+  version \"2.4.1\"\n+  resolved \"https://registry.yarnpkg.com/enquirer/-/enquirer-2.4.1.tgz#93334b3fbd74fc7097b224ab4a8fb7e40bf4ae56\"\n+  integrity sha512-rRqJg/6gd538VHvR3PSrdRBb/1Vy2YfzHqzvbhGIQpDRKIa4FgV/54b5Q1xYSxOOwKvjXweS26E0Q+nAMwp2pQ==\n+  dependencies:\n+    ansi-colors \"^4.1.1\"\n+    strip-ansi \"^6.0.1\"\n+\n+escalade@^3.1.1:\n+  version \"3.1.2\"\n+  resolved \"https://registry.yarnpkg.com/escalade/-/escalade-3.1.2.tgz#54076e9ab29ea5bf3d8f1ed62acffbb88272df27\"\n+  integrity sha512-ErCHMCae19vR8vQGe50xIsVomy19rg6gFu3+r3jkEO46suLMWBksvVyoGgQV+jOfl84ZSOSlmv6Gxa89PmTGmA==\n \n escape-string-regexp@^1.0.5:\n   version \"1.0.5\"\n   resolved \"https://registry.yarnpkg.com/escape-string-regexp/-/escape-string-regexp-1.0.5.tgz#1b61c0562190a8dff6ae3bb2cf0200ca130b86d4\"\n \n+escape-string-regexp@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/escape-string-regexp/-/escape-string-regexp-4.0.0.tgz#14ba83a5d373e3d311e5afca29cf5bfad965bf34\"\n+  integrity sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA==\n+\n eventemitter3@1.x.x:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/eventemitter3/-/eventemitter3-1.2.0.tgz#1c86991d816ad1e504750e73874224ecf3bec508\"\n@@ -544,40 +494,35 @@ extend@~3.0.0:\n   version \"3.0.1\"\n   resolved \"https://registry.yarnpkg.com/extend/-/extend-3.0.1.tgz#a755ea7bc1adfcc5a31ce7e762dbaadc5e636444\"\n \n-extend@~3.0.2:\n-  version \"3.0.2\"\n-  resolved \"https://registry.yarnpkg.com/extend/-/extend-3.0.2.tgz#f8b1136b4071fbd8eb140aff858b1019ec2915fa\"\n-  integrity sha512-fjquC59cD7CyW6urNXK0FBufkZcoiGG80wTuPujX590cB5Ttln20E2UB4S/WARVqhXffZl2LNgS+gQdPIIim/g==\n-\n-external-editor@^3.0.3:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/external-editor/-/external-editor-3.1.0.tgz#cb03f740befae03ea4d283caed2741a83f335495\"\n-  integrity sha512-hMQ4CX1p1izmuLYyZqLMO/qGNw10wSv9QDCPfzXfyFrOaCSSoRfqE1Kf1s5an66J5JZC62NewG+mK49jOCtQew==\n+extract-zip@2.0.1:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/extract-zip/-/extract-zip-2.0.1.tgz#663dca56fe46df890d5f131ef4a06d22bb8ba13a\"\n+  integrity sha512-GDhU9ntwuKyGXdZBUgTIe+vXnWj0fppUEtMDL0+idd5Sta8TGpHssn/eusA9mrPr9qNDym6SxAYZjNvCn/9RBg==\n   dependencies:\n-    chardet \"^0.7.0\"\n-    iconv-lite \"^0.4.24\"\n-    tmp \"^0.0.33\"\n+    debug \"^4.1.1\"\n+    get-stream \"^5.1.0\"\n+    yauzl \"^2.10.0\"\n+  optionalDependencies:\n+    \"@types/yauzl\" \"^2.9.1\"\n \n extsprintf@1.3.0, extsprintf@^1.2.0:\n   version \"1.3.0\"\n   resolved \"https://registry.yarnpkg.com/extsprintf/-/extsprintf-1.3.0.tgz#96918440e3041a7a414f8c52e3c574eb3c3e1e05\"\n \n-fast-deep-equal@^3.1.1:\n-  version \"3.1.3\"\n-  resolved \"https://registry.yarnpkg.com/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz#3a7d56b559d6cbc3eb512325244e619a65c6c525\"\n-  integrity sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==\n-\n-fast-json-stable-stringify@^2.0.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz#874bf69c6f404c2b5d99c481341399fd55892633\"\n-  integrity sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==\n+fd-slicer@~1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/fd-slicer/-/fd-slicer-1.1.0.tgz#25c7c89cb1f9077f8891bbe61d8f390eae256f1e\"\n+  integrity sha512-cE1qsB/VwyQozZ+q1dGxR8LBYNZeofhEdUNGSMbQD3Gw2lAzX9Zb3uIU6Ebc/Fmyjo9AWWfnn0AUCHqtevs/8g==\n+  dependencies:\n+    pend \"~1.2.0\"\n \n-figures@^3.0.0:\n-  version \"3.2.0\"\n-  resolved \"https://registry.yarnpkg.com/figures/-/figures-3.2.0.tgz#625c18bd293c604dc4a8ddb2febf0c88341746af\"\n-  integrity sha512-yaduQFRKLXYOGgEn6AZau90j3ggSOyiqXU0F9JZfeXYhNa+Jk4X+s45A2zg5jns87GAFa34BBm2kXw4XpNcbdg==\n+find-up@^4.0.0:\n+  version \"4.1.0\"\n+  resolved \"https://registry.yarnpkg.com/find-up/-/find-up-4.1.0.tgz#97afe7d6cdc0bc5928584b7c8d7b16e8a9aa5d19\"\n+  integrity sha512-PpOwAdQ/YlXQ2vj8a3h8IipDuYRi3wceVQQGYWxNINccq40Anw7BlsEXCMbt1Zt+OLA6Fq9suIpIWD0OsnISlw==\n   dependencies:\n-    escape-string-regexp \"^1.0.5\"\n+    locate-path \"^5.0.0\"\n+    path-exists \"^4.0.0\"\n \n forever-agent@~0.6.1:\n   version \"0.6.1\"\n@@ -591,14 +536,10 @@ form-data@~2.1.1:\n     combined-stream \"^1.0.5\"\n     mime-types \"^2.1.12\"\n \n-form-data@~2.3.2:\n-  version \"2.3.3\"\n-  resolved \"https://registry.yarnpkg.com/form-data/-/form-data-2.3.3.tgz#dcce52c05f644f298c6a7ab936bd724ceffbf3a6\"\n-  integrity sha512-1lLKB2Mu3aGP1Q/2eCOx0fNbRMe7XdwktwOruhfqqd0rIJWwN4Dh+E3hrPSlDCXnSR7UtZ1N38rVXm+6+MEhJQ==\n-  dependencies:\n-    asynckit \"^0.4.0\"\n-    combined-stream \"^1.0.6\"\n-    mime-types \"^2.1.12\"\n+fs-constants@^1.0.0:\n+  version \"1.0.0\"\n+  resolved \"https://registry.yarnpkg.com/fs-constants/-/fs-constants-1.0.0.tgz#6be0de9be998ce16af8afc24497b9ee9b7ccd9ad\"\n+  integrity sha512-y6OAwoSIf7FyjMIv94u+b5rdheZEjzR63GTyZJm5qh4Bi+2YgwLCcI/fPFZkL5PSixOt6ZNKm+w+Hfp/Bciwow==\n \n fs-extra@~0.26.2:\n   version \"0.26.7\"\n@@ -644,12 +585,10 @@ gauge@~2.7.3:\n     strip-ansi \"^3.0.1\"\n     wide-align \"^1.1.0\"\n \n-get-stream@^4.1.0:\n-  version \"4.1.0\"\n-  resolved \"https://registry.yarnpkg.com/get-stream/-/get-stream-4.1.0.tgz#c1b255575f3dc21d59bfc79cd3d2b46b1c3a54b5\"\n-  integrity sha512-GMat4EJ5161kIy2HevLlr4luNjBgvmj413KaQA7jt4V8B4RDsfpHk7WQ9GVqfYyyx8OS/L66Kox+rJRNklLK7w==\n-  dependencies:\n-    pump \"^3.0.0\"\n+get-caller-file@^2.0.5:\n+  version \"2.0.5\"\n+  resolved \"https://registry.yarnpkg.com/get-caller-file/-/get-caller-file-2.0.5.tgz#4f94412a82db32f36e3b0b9741f8a97feb031f7e\"\n+  integrity sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg==\n \n get-stream@^5.1.0:\n   version \"5.2.0\"\n@@ -687,30 +626,6 @@ glob@^7.1.3:\n     once \"^1.3.0\"\n     path-is-absolute \"^1.0.0\"\n \n-global-dirs@^2.0.1:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/global-dirs/-/global-dirs-2.1.0.tgz#e9046a49c806ff04d6c1825e196c8f0091e8df4d\"\n-  integrity sha512-MG6kdOUh/xBnyo9cJFeIKkLEc1AyFq42QTU4XiX51i2NEdxLxLWXIjEjmqKeSuKR7pAZjTqUVoT2b2huxVLgYQ==\n-  dependencies:\n-    ini \"1.3.7\"\n-\n-got@^9.6.0:\n-  version \"9.6.0\"\n-  resolved \"https://registry.yarnpkg.com/got/-/got-9.6.0.tgz#edf45e7d67f99545705de1f7bbeeeb121765ed85\"\n-  integrity sha512-R7eWptXuGYxwijs0eV+v3o6+XH1IqVK8dJOEecQfTmkncw9AV4dcw/Dhxi8MdlqPthxxpZyizMzyg8RTmEsG+Q==\n-  dependencies:\n-    \"@sindresorhus/is\" \"^0.14.0\"\n-    \"@szmarczak/http-timer\" \"^1.1.2\"\n-    cacheable-request \"^6.0.0\"\n-    decompress-response \"^3.3.0\"\n-    duplexer3 \"^0.1.4\"\n-    get-stream \"^4.1.0\"\n-    lowercase-keys \"^1.0.1\"\n-    mimic-response \"^1.0.1\"\n-    p-cancelable \"^1.0.0\"\n-    to-readable-stream \"^1.0.0\"\n-    url-parse-lax \"^3.0.0\"\n-\n graceful-fs@^4.1.2, graceful-fs@^4.1.6, graceful-fs@^4.1.9:\n   version \"4.1.11\"\n   resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.1.11.tgz#0e8bdfe4d1ddb8854d64e04ea7c00e2a026e5658\"\n@@ -719,49 +634,21 @@ har-schema@^1.0.5:\n   version \"1.0.5\"\n   resolved \"https://registry.yarnpkg.com/har-schema/-/har-schema-1.0.5.tgz#d263135f43307c02c602afc8fe95970c0151369e\"\n \n-har-schema@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/har-schema/-/har-schema-2.0.0.tgz#a94c2224ebcac04782a0d9035521f24735b7ec92\"\n-  integrity sha512-Oqluz6zhGX8cyRaTQlFMPw80bSJVG2x/cFb8ZPhUILGgHka9SsokCCOQgpveePerqidZOrT14ipqfJb7ILcW5Q==\n-\n har-validator@~4.2.1:\n   version \"4.2.1\"\n   resolved \"https://registry.yarnpkg.com/har-validator/-/har-validator-4.2.1.tgz#33481d0f1bbff600dd203d75812a6a5fba002e2a\"\n   dependencies:\n     ajv \"^4.9.1\"\n     har-schema \"^1.0.5\"\n \n-har-validator@~5.1.3:\n-  version \"5.1.5\"\n-  resolved \"https://registry.yarnpkg.com/har-validator/-/har-validator-5.1.5.tgz#1f0803b9f8cb20c0fa13822df1ecddb36bde1efd\"\n-  integrity sha512-nmT2T0lljbxdQZfspsno9hgrG3Uir6Ks5afism62poxqBM6sDnMEuPmzTq8XN0OEwqKLLdh1jQI3qyE66Nzb3w==\n-  dependencies:\n-    ajv \"^6.12.3\"\n-    har-schema \"^2.0.0\"\n-\n has-flag@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/has-flag/-/has-flag-2.0.0.tgz#e8207af1cc7b30d446cc70b734b5e8be18f88d51\"\n \n-has-flag@^3.0.0:\n-  version \"3.0.0\"\n-  resolved \"https://registry.yarnpkg.com/has-flag/-/has-flag-3.0.0.tgz#b5d454dc2199ae225699f3467e5a07f3b955bafd\"\n-  integrity sha1-tdRU3CGZriJWmfNGfloH87lVuv0=\n-\n-has-flag@^4.0.0:\n-  version \"4.0.0\"\n-  resolved \"https://registry.yarnpkg.com/has-flag/-/has-flag-4.0.0.tgz#944771fd9c81c81265c4d6941860da06bb59479b\"\n-  integrity sha512-EykJT/Q1KjTWctppgIAgfSO0tKVuZUjhgMr17kqTumMl6Afv3EISleU7qZUzoXDFTAHTDC4NOoG/ZxU3EvlMPQ==\n-\n has-unicode@^2.0.0:\n   version \"2.0.1\"\n   resolved \"https://registry.yarnpkg.com/has-unicode/-/has-unicode-2.0.1.tgz#e0e6fe6a28cf51138855e086d1691e771de2a8b9\"\n \n-has-yarn@^2.1.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/has-yarn/-/has-yarn-2.1.0.tgz#137e11354a7b5bf11aa5cb649cf0c6f3ff2b2e77\"\n-  integrity sha512-UqBRqi4ju7T+TqGNdqAO0PaSVGsDGJUBQvk9eUWNGRY1CFGDzYhLWoM7JQEemnlvVcv/YEmc2wNW8BC24EnUsw==\n-\n hawk@~3.1.3:\n   version \"3.1.3\"\n   resolved \"https://registry.yarnpkg.com/hawk/-/hawk-3.1.3.tgz#078444bd7c1640b0fe540d2c9b73d59678e8e1c4\"\n@@ -780,11 +667,6 @@ hoek@2.x.x:\n   version \"2.16.3\"\n   resolved \"https://registry.yarnpkg.com/hoek/-/hoek-2.16.3.tgz#20bb7403d3cea398e91dc4710a8ff1b8274a25ed\"\n \n-http-cache-semantics@^4.0.0:\n-  version \"4.1.1\"\n-  resolved \"https://registry.yarnpkg.com/http-cache-semantics/-/http-cache-semantics-4.1.1.tgz#abe02fcb2985460bf0323be664436ec3476a6d5a\"\n-  integrity sha512-er295DKPVsV82j5kw1Gjt+ADA/XYHsajl82cGNQG2eyoPkvgUhX+nDIyelzhIWbbsXP39EHcI6l5tYs2FYqYXQ==\n-\n http-link-header@^0.8.0:\n   version \"0.8.0\"\n   resolved \"https://registry.yarnpkg.com/http-link-header/-/http-link-header-0.8.0.tgz#a22b41a0c9b1e2d8fac1bf1b697c6bd532d5f5e4\"\n@@ -818,34 +700,27 @@ http-signature@~1.1.0:\n     jsprim \"^1.2.2\"\n     sshpk \"^1.7.0\"\n \n-http-signature@~1.2.0:\n-  version \"1.2.0\"\n-  resolved \"https://registry.yarnpkg.com/http-signature/-/http-signature-1.2.0.tgz#9aecd925114772f3d95b65a60abb8f7c18fbace1\"\n-  integrity sha512-CAbnr6Rz4CYQkLYUtSNXxQPUH2gK8f3iWexVlsnMeD+GjlsQ0Xsy1cOX+mN3dtxYomRy21CiOzU8Uhw6OwncEQ==\n-  dependencies:\n-    assert-plus \"^1.0.0\"\n-    jsprim \"^1.2.2\"\n-    sshpk \"^1.7.0\"\n-\n http2@^3.3.6:\n   version \"3.3.6\"\n   resolved \"https://registry.yarnpkg.com/http2/-/http2-3.3.6.tgz#7df06227e02b5b5a5841deea08239b3198d04bec\"\n \n-iconv-lite@^0.4.24:\n-  version \"0.4.24\"\n-  resolved \"https://registry.yarnpkg.com/iconv-lite/-/iconv-lite-0.4.24.tgz#2022b4b25fbddc21d2f524974a474aafe733908b\"\n-  integrity sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==\n+https-proxy-agent@5.0.1, https-proxy-agent@^5.0.0:\n+  version \"5.0.1\"\n+  resolved \"https://registry.yarnpkg.com/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz#c59ef224a04fe8b754f3db0063a25ea30d0005d6\"\n+  integrity sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==\n   dependencies:\n-    safer-buffer \">= 2.1.2 < 3\"\n+    agent-base \"6\"\n+    debug \"4\"\n+\n+ieee754@^1.1.13:\n+  version \"1.2.1\"\n+  resolved \"https://registry.yarnpkg.com/ieee754/-/ieee754-1.2.1.tgz#8eb7a10a63fff25d15a57b001586d177d1b0d352\"\n+  integrity sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==\n \n image-ssim@^0.2.0:\n   version \"0.2.0\"\n   resolved \"https://registry.yarnpkg.com/image-ssim/-/image-ssim-0.2.0.tgz#83b42c7a2e6e4b85505477fe6917f5dbc56420e5\"\n \n-import-lazy@^2.1.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/import-lazy/-/import-lazy-2.1.0.tgz#05698e3d45c88e8d7e9d92cb0584e77f096f3e43\"\n-\n imurmurhash@^0.1.4:\n   version \"0.1.4\"\n   resolved \"https://registry.yarnpkg.com/imurmurhash/-/imurmurhash-0.1.4.tgz#9218b9b2b928a238b13dc4fb6b6d576f231453ea\"\n@@ -861,34 +736,15 @@ inherits@2, inherits@~2.0.0, inherits@~2.0.3:\n   version \"2.0.3\"\n   resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.3.tgz#633c2c83e3da42a502f52466022480f4208261de\"\n \n-ini@1.3.7:\n-  version \"1.3.7\"\n-  resolved \"https://registry.yarnpkg.com/ini/-/ini-1.3.7.tgz#a09363e1911972ea16d7a8851005d84cf09a9a84\"\n-  integrity sha512-iKpRpXP+CrP2jyrxvg1kMUpXDyRUFDWurxbnVT1vQPx+Wz9uCYsMIqYuSBLV+PAaZG/d7kRLKRFc9oDMsH+mFQ==\n+inherits@^2.0.3, inherits@^2.0.4:\n+  version \"2.0.4\"\n+  resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.4.tgz#0fa2c64f932917c3433a0ded55363aae37416b7c\"\n+  integrity sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==\n \n ini@~1.3.0:\n   version \"1.3.4\"\n   resolved \"https://registry.yarnpkg.com/ini/-/ini-1.3.4.tgz#0537cb79daf59b59a1a517dff706c86ec039162e\"\n \n-inquirer@^7.3.3:\n-  version \"7.3.3\"\n-  resolved \"https://registry.yarnpkg.com/inquirer/-/inquirer-7.3.3.tgz#04d176b2af04afc157a83fd7c100e98ee0aad003\"\n-  integrity sha512-JG3eIAj5V9CwcGvuOmoo6LB9kbAYT8HXffUl6memuszlwDC/qvFAJw49XJ5NROSFNPxp3iQg1GqkFhaY/CR0IA==\n-  dependencies:\n-    ansi-escapes \"^4.2.1\"\n-    chalk \"^4.1.0\"\n-    cli-cursor \"^3.1.0\"\n-    cli-width \"^3.0.0\"\n-    external-editor \"^3.0.3\"\n-    figures \"^3.0.0\"\n-    lodash \"^4.17.19\"\n-    mute-stream \"0.0.8\"\n-    run-async \"^2.4.0\"\n-    rxjs \"^6.6.0\"\n-    string-width \"^4.1.0\"\n-    strip-ansi \"^6.0.0\"\n-    through \"^2.3.6\"\n-\n intl-messageformat-parser@^1.8.1:\n   version \"1.8.1\"\n   resolved \"https://registry.yarnpkg.com/intl-messageformat-parser/-/intl-messageformat-parser-1.8.1.tgz#0eb14c5618333be4c95c409457b66c8c33ddcc01\"\n@@ -901,33 +757,7 @@ intl-messageformat@^4.4.0:\n   dependencies:\n     intl-messageformat-parser \"^1.8.1\"\n \n-intl-pluralrules@^1.0.3:\n-  version \"1.3.1\"\n-  resolved \"https://registry.yarnpkg.com/intl-pluralrules/-/intl-pluralrules-1.3.1.tgz#304ec4038a597894f6616633cbf5e66fb3dbee04\"\n-  integrity sha512-sNYPls1Q4fyN0EGLFVJ7TIuaMWln01LupLozfIBt69rHK0DHehghMSz6ejfnSklgRddnyQSEaQPIU6d9TCKH3w==\n-\n-intl@^1.2.5:\n-  version \"1.2.5\"\n-  resolved \"https://registry.yarnpkg.com/intl/-/intl-1.2.5.tgz#82244a2190c4e419f8371f5aa34daa3420e2abde\"\n-  integrity sha512-rK0KcPHeBFBcqsErKSpvZnrOmWOj+EmDkyJ57e90YWaQNqbcivcqmKDlHEeNprDWOsKzPsh1BfSpPQdDvclHVw==\n-\n-invert-kv@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/invert-kv/-/invert-kv-1.0.0.tgz#104a8e4aaca6d3d8cd157a8ef8bfab2d7a3ffdb6\"\n-\n-is-buffer@~1.1.1:\n-  version \"1.1.6\"\n-  resolved \"https://registry.yarnpkg.com/is-buffer/-/is-buffer-1.1.6.tgz#efaa2ea9daa0d7ab2ea13a97b2b8ad51fefbe8be\"\n-  integrity sha512-NcdALwpXkTm5Zvvbk7owOUSvVvBKDgKP5/ewfXEznmQFfs4ZRmanOeKBTjRVjka3QFoN6XJ+9F3USqfHqTaU5w==\n-\n-is-ci@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/is-ci/-/is-ci-2.0.0.tgz#6bc6334181810e04b5c22b3d589fdca55026404c\"\n-  integrity sha512-YfJT7rkpQB0updsdHLGWrvhBJfcfzNNawYDNIyQXJz0IViGf75O8EBPKSdvw2rF+LGCsX4FZ8tcr3b19LcZq4w==\n-  dependencies:\n-    ci-info \"^2.0.0\"\n-\n-is-docker@^2.0.0:\n+is-docker@^2.0.0, is-docker@^2.1.1:\n   version \"2.2.1\"\n   resolved \"https://registry.yarnpkg.com/is-docker/-/is-docker-2.2.1.tgz#33eeabe23cfe86f14bde4408a02c0cfb853acdaa\"\n   integrity sha512-F+i2BKsFrH66iaUFc0woD8sLy8getkwTwtOBjvs56Cx4CgJDeKQeqfz8wAYiSb8JOprWhHH5p77PbmYCvvUuXQ==\n@@ -943,50 +773,22 @@ is-fullwidth-code-point@^3.0.0:\n   resolved \"https://registry.yarnpkg.com/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz#f116f8064fe90b3f7844a38997c0b75051269f1d\"\n   integrity sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==\n \n-is-installed-globally@^0.3.1:\n-  version \"0.3.2\"\n-  resolved \"https://registry.yarnpkg.com/is-installed-globally/-/is-installed-globally-0.3.2.tgz#fd3efa79ee670d1187233182d5b0a1dd00313141\"\n-  integrity sha512-wZ8x1js7Ia0kecP/CHM/3ABkAmujX7WPvQk6uu3Fly/Mk44pySulQpnHG46OMjHGXApINnV4QhY3SWnECO2z5g==\n-  dependencies:\n-    global-dirs \"^2.0.1\"\n-    is-path-inside \"^3.0.1\"\n-\n-is-npm@^4.0.0:\n-  version \"4.0.0\"\n-  resolved \"https://registry.yarnpkg.com/is-npm/-/is-npm-4.0.0.tgz#c90dd8380696df87a7a6d823c20d0b12bbe3c84d\"\n-  integrity sha512-96ECIfh9xtDDlPylNPXhzjsykHsMJZ18ASpaWzQyBr4YRTcVjUvzaHayDAES2oU/3KpljhHUjtSRNiDwi0F0ig==\n-\n is-obj@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-obj/-/is-obj-2.0.0.tgz#473fb05d973705e3fd9620545018ca8e22ef4982\"\n   integrity sha512-drqDG3cbczxxEJRoOXcOjtdp1J/lyp1mNn0xaznRs8+muBhgQcrnbspox5X5fOw0HnMnbfDzvnEMEtqDEJEo8w==\n \n-is-path-inside@^3.0.1:\n-  version \"3.0.3\"\n-  resolved \"https://registry.yarnpkg.com/is-path-inside/-/is-path-inside-3.0.3.tgz#d231362e53a07ff2b0e0ea7fed049161ffd16283\"\n-  integrity sha512-Fd4gABb+ycGAmKou8eMftCupSir5lRxqf4aD/vd0cD2qc4HL07OjCeuHMr8Ro4CoMaeCKDB0/ECBOVWjTwUvPQ==\n-\n is-typedarray@^1.0.0, is-typedarray@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-typedarray/-/is-typedarray-1.0.0.tgz#e479c80858df0c1b11ddda6940f96011fcda4a9a\"\n \n-is-wsl@^1.1.0:\n-  version \"1.1.0\"\n-  resolved \"https://registry.yarnpkg.com/is-wsl/-/is-wsl-1.1.0.tgz#1f16e4aa22b04d1336b66188a66af3c600c3a66d\"\n-  integrity sha1-HxbkqiKwTRM2tmGIpmrzxgDDpm0=\n-\n is-wsl@^2.2.0:\n   version \"2.2.0\"\n   resolved \"https://registry.yarnpkg.com/is-wsl/-/is-wsl-2.2.0.tgz#74a4c76e77ca9fd3f932f290c17ea326cd157271\"\n   integrity sha512-fKzAra0rGJUUBwGBgNkHZuToZcn+TtXHpeCgmkMJMMYx1sQDYaCSyjJBSCa2nH1DGm7s3n1oBnohoVTBaN7Lww==\n   dependencies:\n     is-docker \"^2.0.0\"\n \n-is-yarn-global@^0.3.0:\n-  version \"0.3.0\"\n-  resolved \"https://registry.yarnpkg.com/is-yarn-global/-/is-yarn-global-0.3.0.tgz#d502d3382590ea3004893746754c89139973e232\"\n-  integrity sha512-VjSeb/lHmkoyd8ryPVIKvOCn4D1koMqY+vqyjjUfc3xyKtP4dYOxM44sZrnqQSzSds3xyOrUTLTC9LVCVgLngw==\n-\n isarray@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/isarray/-/isarray-1.0.0.tgz#bb935d48582cba168c06834957a54a3e07124f11\"\n@@ -999,12 +801,12 @@ isstream@~0.1.2:\n   version \"0.1.2\"\n   resolved \"https://registry.yarnpkg.com/isstream/-/isstream-0.1.2.tgz#47e63f7af55afa6f92e1500e690eb8b8529c099a\"\n \n-jpeg-js@^0.4.1:\n+jpeg-js@^0.4.1, jpeg-js@^0.4.3:\n   version \"0.4.4\"\n   resolved \"https://registry.yarnpkg.com/jpeg-js/-/jpeg-js-0.4.4.tgz#a9f1c6f1f9f0fa80cdb3484ed9635054d28936aa\"\n   integrity sha512-WZzeDOEtTOBK4Mdsar0IqEU5sMr3vSV2RqkAIzUEV2BHnUfKGyswWFPFwK5EeDo93K3FohSHbLAjj0s1Wzd+dg==\n \n-js-library-detector@^6.4.0:\n+js-library-detector@^6.5.0:\n   version \"6.7.0\"\n   resolved \"https://registry.yarnpkg.com/js-library-detector/-/js-library-detector-6.7.0.tgz#5075c71fcf835b71133bca13363b91509a39235a\"\n   integrity sha512-c80Qupofp43y4cJ7+8TTDN/AsDwLi5oOm/plBrWI+iQt485vKXCco+yVmOwEgdo9VOdsYTuV0UlTeetVPTriXA==\n@@ -1013,16 +815,6 @@ jsbn@~0.1.0:\n   version \"0.1.1\"\n   resolved \"https://registry.yarnpkg.com/jsbn/-/jsbn-0.1.1.tgz#a5e654c2e5a2deb5f201d96cefbca80c0ef2f513\"\n \n-json-buffer@3.0.0:\n-  version \"3.0.0\"\n-  resolved \"https://registry.yarnpkg.com/json-buffer/-/json-buffer-3.0.0.tgz#5b1f397afc75d677bde8bcfc0e47e1f9a3d9a898\"\n-  integrity sha512-CuUqjv0FUZIdXkHPI8MezCnFCdaTAacej1TZYulLoAg1h/PhwkdXFN4V/gzY4g+fMBCOV2xF+rp7t2XD2ns/NQ==\n-\n-json-schema-traverse@^0.4.1:\n-  version \"0.4.1\"\n-  resolved \"https://registry.yarnpkg.com/json-schema-traverse/-/json-schema-traverse-0.4.1.tgz#69f6a87d9513ab8bb8fe63bdb0979c448e684660\"\n-  integrity sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg==\n-\n json-schema@0.2.3:\n   version \"0.2.3\"\n   resolved \"https://registry.yarnpkg.com/json-schema/-/json-schema-0.2.3.tgz#b480c892e59a2f05954ce727bd3f2a4e882f9e13\"\n@@ -1047,26 +839,6 @@ jsonify@~0.0.0:\n   version \"0.0.0\"\n   resolved \"https://registry.yarnpkg.com/jsonify/-/jsonify-0.0.0.tgz#2c74b6ee41d93ca51b7b5aaee8f503631d252a73\"\n \n-jsonld@^1.5.0:\n-  version \"1.8.1\"\n-  resolved \"https://registry.yarnpkg.com/jsonld/-/jsonld-1.8.1.tgz#55ea541b22b8af5a5d6a5e32328e3f2678148882\"\n-  integrity sha512-f0rusl5v8aPKS3jApT5fhYsdTC/JpyK1PoJ+ZtYYtZXoyb1J0Z///mJqLwrfL/g4NueFSqPymDYIi1CcSk7b8Q==\n-  dependencies:\n-    canonicalize \"^1.0.1\"\n-    rdf-canonize \"^1.0.2\"\n-    request \"^2.88.0\"\n-    semver \"^5.6.0\"\n-    xmldom \"0.1.19\"\n-\n-jsonlint-mod@^1.7.5:\n-  version \"1.7.6\"\n-  resolved \"https://registry.yarnpkg.com/jsonlint-mod/-/jsonlint-mod-1.7.6.tgz#6f1c4c51fdb5c2002489a0665e3e19a316743319\"\n-  integrity sha512-oGuk6E1ehmIpw0w9ttgb2KsDQQgGXBzZczREW8OfxEm9eCQYL9/LCexSnh++0z3AiYGcXpBgqDSx9AAgzl/Bvg==\n-  dependencies:\n-    JSV \"^4.0.2\"\n-    chalk \"^2.4.2\"\n-    underscore \"^1.9.1\"\n-\n jsprim@^1.2.2:\n   version \"1.4.1\"\n   resolved \"https://registry.yarnpkg.com/jsprim/-/jsprim-1.4.1.tgz#313e66bc1e5cc06e438bc1b7499c2e5c56acb6a2\"\n@@ -1076,32 +848,12 @@ jsprim@^1.2.2:\n     json-schema \"0.2.3\"\n     verror \"1.10.0\"\n \n-keyv@^3.0.0:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/keyv/-/keyv-3.1.0.tgz#ecc228486f69991e49e9476485a5be1e8fc5c4d9\"\n-  integrity sha512-9ykJ/46SN/9KPM/sichzQ7OvXyGDYKGTaDlKMGCAlg2UK8KRy4jb0d8sFc+0Tt0YYnThq8X2RZgCg74RPxgcVA==\n-  dependencies:\n-    json-buffer \"3.0.0\"\n-\n klaw@^1.0.0:\n   version \"1.3.1\"\n   resolved \"https://registry.yarnpkg.com/klaw/-/klaw-1.3.1.tgz#4088433b46b3b1ba259d78785d8e96f73ba02439\"\n   optionalDependencies:\n     graceful-fs \"^4.1.9\"\n \n-latest-version@^5.0.0:\n-  version \"5.1.0\"\n-  resolved \"https://registry.yarnpkg.com/latest-version/-/latest-version-5.1.0.tgz#119dfe908fe38d15dfa43ecd13fa12ec8832face\"\n-  integrity sha512-weT+r0kTkRQdCdYCNtkMwWXQTMEswKrFBkm4ckQOMVhhqhIMI1UT2hMj+1iigIhgSZm5gTmrRXBNoGUgaTY1xA==\n-  dependencies:\n-    package-json \"^6.3.0\"\n-\n-lcid@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/lcid/-/lcid-1.0.0.tgz#308accafa0bc483a3867b4b6f2b9506251d1b835\"\n-  dependencies:\n-    invert-kv \"^1.0.0\"\n-\n lighthouse-logger@^1.0.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/lighthouse-logger/-/lighthouse-logger-1.2.0.tgz#b76d56935e9c137e86a04741f6bb9b2776e886ca\"\n@@ -1110,101 +862,77 @@ lighthouse-logger@^1.0.0:\n     debug \"^2.6.8\"\n     marky \"^1.2.0\"\n \n-lighthouse-logger@^1.2.0:\n+lighthouse-logger@^1.3.0:\n   version \"1.4.2\"\n   resolved \"https://registry.yarnpkg.com/lighthouse-logger/-/lighthouse-logger-1.4.2.tgz#aef90f9e97cd81db367c7634292ee22079280aaa\"\n   integrity sha512-gPWxznF6TKmUHrOQjlVo2UbaL2EJ71mb2CCeRs/2qBpi4L/g4LUVc9+3lKQ6DTUZwJswfM7ainGrLO1+fOqa2g==\n   dependencies:\n     debug \"^2.6.9\"\n     marky \"^1.2.2\"\n \n-lighthouse-stack-packs@^1.3.0:\n-  version \"1.12.1\"\n-  resolved \"https://registry.yarnpkg.com/lighthouse-stack-packs/-/lighthouse-stack-packs-1.12.1.tgz#1dbebf795d50e6a96454ece7754bd4aa5be546ae\"\n-  integrity sha512-i4jTmg7tvZQFwNFiwB+nCK6a7ICR68Xcwo+VIVd6Spi71vBNFUlds5HiDrSbClZdkQDON2Bhqv+KKJIo5zkPeA==\n+lighthouse-stack-packs@1.8.2:\n+  version \"1.8.2\"\n+  resolved \"https://registry.yarnpkg.com/lighthouse-stack-packs/-/lighthouse-stack-packs-1.8.2.tgz#55111bebe50ed516de3fad0a474795a2556ac36e\"\n+  integrity sha512-vlCUxxQAB8Nu6LQHqPpDRiMi06Du593/my/6JbMttQeEfJ7pf4OS8obSTh5xSOS80U/O7fq59Q8rQGAUxQatUQ==\n \n-lighthouse@^6.0.0:\n-  version \"6.5.0\"\n-  resolved \"https://registry.yarnpkg.com/lighthouse/-/lighthouse-6.5.0.tgz#b59dde5ec35acd36e22457e19de33d4e14e2ef1c\"\n-  integrity sha512-d9J2V03WjvpJL2YvKlwZsz+KuCwrxXo/6uh1au74oNrVZm53w4CC3Xyaew82wz36frWToqN3k8dl06jFVziGrA==\n+lighthouse@^9.5.0:\n+  version \"9.6.8\"\n+  resolved \"https://registry.yarnpkg.com/lighthouse/-/lighthouse-9.6.8.tgz#7ec52f37070b557f8dc57cf4f0c68536fdf5205b\"\n+  integrity sha512-5aRSvnqazci8D2oE7GJM6C7IStvUuMVV+74cGyBuS4n4NCixsDd6+uJdX834XiInSfo+OuVbAJCX4Xu6d2+N9Q==\n   dependencies:\n-    axe-core \"3.5.5\"\n-    chrome-launcher \"^0.13.4\"\n+    \"@sentry/node\" \"^6.17.4\"\n+    axe-core \"4.4.1\"\n+    chrome-launcher \"^0.15.0\"\n     configstore \"^5.0.1\"\n+    csp_evaluator \"1.1.1\"\n     cssstyle \"1.2.1\"\n-    details-element-polyfill \"^2.4.0\"\n+    enquirer \"^2.3.6\"\n     http-link-header \"^0.8.0\"\n-    inquirer \"^7.3.3\"\n-    intl \"^1.2.5\"\n     intl-messageformat \"^4.4.0\"\n-    intl-pluralrules \"^1.0.3\"\n-    jpeg-js \"^0.4.1\"\n-    js-library-detector \"^6.4.0\"\n-    jsonld \"^1.5.0\"\n-    jsonlint-mod \"^1.7.5\"\n-    lighthouse-logger \"^1.2.0\"\n-    lighthouse-stack-packs \"^1.3.0\"\n-    lodash.get \"^4.4.2\"\n-    lodash.isequal \"^4.5.0\"\n-    lodash.set \"^4.3.2\"\n-    lookup-closest-locale \"6.0.4\"\n+    jpeg-js \"^0.4.3\"\n+    js-library-detector \"^6.5.0\"\n+    lighthouse-logger \"^1.3.0\"\n+    lighthouse-stack-packs \"1.8.2\"\n+    lodash \"^4.17.21\"\n+    lookup-closest-locale \"6.2.0\"\n     metaviewport-parser \"0.2.0\"\n-    open \"^6.4.0\"\n+    open \"^8.4.0\"\n     parse-cache-control \"1.0.1\"\n-    ps-list \"^7.2.0\"\n-    raven \"^2.2.1\"\n-    rimraf \"^2.6.1\"\n-    robots-parser \"^2.0.1\"\n+    ps-list \"^8.0.0\"\n+    puppeteer-core \"^13.7.0\"\n+    robots-parser \"^3.0.0\"\n     semver \"^5.3.0\"\n     speedline-core \"^1.4.3\"\n-    third-party-web \"^0.12.2\"\n-    update-notifier \"^4.1.0\"\n-    ws \"3.3.2\"\n-    yargs \"3.32.0\"\n-    yargs-parser \"^18.1.3\"\n-\n-lodash.get@^4.4.2:\n-  version \"4.4.2\"\n-  resolved \"https://registry.yarnpkg.com/lodash.get/-/lodash.get-4.4.2.tgz#2d177f652fa31e939b4438d5341499dfa3825e99\"\n-  integrity sha512-z+Uw/vLuy6gQe8cfaFWD7p0wVv8fJl3mbzXh33RS+0oW2wvUqiRXiQ69gLWSLpgB5/6sU+r6BlQR0MBILadqTQ==\n-\n-lodash.isequal@^4.5.0:\n-  version \"4.5.0\"\n-  resolved \"https://registry.yarnpkg.com/lodash.isequal/-/lodash.isequal-4.5.0.tgz#415c4478f2bcc30120c22ce10ed3226f7d3e18e0\"\n-  integrity sha1-QVxEePK8wwEgwizhDtMib30+GOA=\n-\n-lodash.set@^4.3.2:\n-  version \"4.3.2\"\n-  resolved \"https://registry.yarnpkg.com/lodash.set/-/lodash.set-4.3.2.tgz#d8757b1da807dde24816b0d6a84bea1a76230b23\"\n-  integrity sha512-4hNPN5jlm/N/HLMCO43v8BXKq9Z7QdAGc/VGrRD61w8gN9g/6jF9A4L1pbUgBLCffi0w9VsXfTOij5x8iTyFvg==\n+    third-party-web \"^0.17.1\"\n+    ws \"^7.0.0\"\n+    yargs \"^17.3.1\"\n+    yargs-parser \"^21.0.0\"\n+\n+locate-path@^5.0.0:\n+  version \"5.0.0\"\n+  resolved \"https://registry.yarnpkg.com/locate-path/-/locate-path-5.0.0.tgz#1afba396afd676a6d42504d0a67a3a7eb9f62aa0\"\n+  integrity sha512-t7hw9pI+WvuwNJXwk5zVHpyhIqzg2qTlklJOf0mVxGSbe3Fp2VieZcduNYjaLDoy6p9uGpQEGWG87WpMKlNq8g==\n+  dependencies:\n+    p-locate \"^4.1.0\"\n \n lodash@^4.13.1:\n   version \"4.17.4\"\n   resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.4.tgz#78203a4d1c328ae1d86dca6460e369b57f4055ae\"\n \n-lodash@^4.17.19:\n+lodash@^4.17.21:\n   version \"4.17.21\"\n   resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.21.tgz#679591c564c3bffaae8454cf0b3df370c3d6911c\"\n   integrity sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==\n \n-lookup-closest-locale@6.0.4:\n-  version \"6.0.4\"\n-  resolved \"https://registry.yarnpkg.com/lookup-closest-locale/-/lookup-closest-locale-6.0.4.tgz#1279fed7546a601647bbc980f64423ee990a8590\"\n-  integrity sha512-bWoFbSGe6f1GvMGzj17LrwMX4FhDXDwZyH04ySVCPbtOJADcSRguZNKewoJ3Ful/MOxD/wRHvFPadk/kYZUbuQ==\n+lookup-closest-locale@6.2.0:\n+  version \"6.2.0\"\n+  resolved \"https://registry.yarnpkg.com/lookup-closest-locale/-/lookup-closest-locale-6.2.0.tgz#57f665e604fd26f77142d48152015402b607bcf3\"\n+  integrity sha512-/c2kL+Vnp1jnV6K6RpDTHK3dgg0Tu2VVp+elEiJpjfS1UyY7AjOYHohRug6wT0OpoX2qFgNORndE9RqesfVxWQ==\n \n-lowercase-keys@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/lowercase-keys/-/lowercase-keys-1.0.0.tgz#4e3366b39e7f5457e35f1324bdf6f88d0bfc7306\"\n-\n-lowercase-keys@^1.0.1:\n-  version \"1.0.1\"\n-  resolved \"https://registry.yarnpkg.com/lowercase-keys/-/lowercase-keys-1.0.1.tgz#6f9e30b47084d971a7c820ff15a6c5167b74c26f\"\n-  integrity sha512-G2Lj61tXDnVFFOi8VZds+SoQjtQC3dgokKdDG2mTm1tx4m50NUHBOZSBwQQHyy0V12A0JTG4icfZQH+xPyh8VA==\n-\n-lowercase-keys@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/lowercase-keys/-/lowercase-keys-2.0.0.tgz#2603e78b7b4b0006cbca2fbcc8a3202558ac9479\"\n-  integrity sha512-tqNXrS78oMOE73NMxK4EMLQsQowWf8jKooH9g7xPavRT706R6bkQJ6DY2Te7QukaZsulxa30wQ7bk0pm4XiHmA==\n+lru_map@^0.3.3:\n+  version \"0.3.3\"\n+  resolved \"https://registry.yarnpkg.com/lru_map/-/lru_map-0.3.3.tgz#b5c8351b9464cbd750335a79650a0ec0e56118dd\"\n+  integrity sha512-Pn9cox5CsMYngeDbmChANltQl+5pi6XmTrraMSzhPmMBbmgcxmqWry0U3PGapCU1yB4/LqCcom7qhHZiF/jGfQ==\n \n make-dir@^3.0.0:\n   version \"3.1.0\"\n@@ -1223,25 +951,11 @@ marky@^1.2.2:\n   resolved \"https://registry.yarnpkg.com/marky/-/marky-1.2.5.tgz#55796b688cbd72390d2d399eaaf1832c9413e3c0\"\n   integrity sha512-q9JtQJKjpsVxCRVgQ+WapguSbKC3SQ5HEzFGPAJMStgh3QjCawp00UKv3MTTAArTmGmmPUvllHZoNbZ3gs0I+Q==\n \n-md5@^2.2.1:\n-  version \"2.2.1\"\n-  resolved \"https://registry.yarnpkg.com/md5/-/md5-2.2.1.tgz#53ab38d5fe3c8891ba465329ea23fac0540126f9\"\n-  integrity sha1-U6s41f48iJG6RlMp6iP6wFQBJvk=\n-  dependencies:\n-    charenc \"~0.0.1\"\n-    crypt \"~0.0.1\"\n-    is-buffer \"~1.1.1\"\n-\n metaviewport-parser@0.2.0:\n   version \"0.2.0\"\n   resolved \"https://registry.yarnpkg.com/metaviewport-parser/-/metaviewport-parser-0.2.0.tgz#535c3ce1ccf6223a5025fddc6a1c36505f7e7db1\"\n   integrity sha1-U1w84cz2IjpQJf3cahw2UF9+fbE=\n \n-mime-db@1.52.0:\n-  version \"1.52.0\"\n-  resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.52.0.tgz#bbabcdc02859f4987301c856e3387ce5ec43bf70\"\n-  integrity sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==\n-\n mime-db@~1.29.0:\n   version \"1.29.0\"\n   resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.29.0.tgz#48d26d235589651704ac5916ca06001914266878\"\n@@ -1252,28 +966,11 @@ mime-types@^2.1.12, mime-types@~2.1.7:\n   dependencies:\n     mime-db \"~1.29.0\"\n \n-mime-types@~2.1.19:\n-  version \"2.1.35\"\n-  resolved \"https://registry.yarnpkg.com/mime-types/-/mime-types-2.1.35.tgz#381a871b62a734450660ae3deee44813f70d959a\"\n-  integrity sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==\n-  dependencies:\n-    mime-db \"1.52.0\"\n-\n mime@^1.2.11, mime@^1.3.6:\n   version \"1.6.0\"\n   resolved \"https://registry.yarnpkg.com/mime/-/mime-1.6.0.tgz#32cd9e5c64553bd58d19a568af452acff04981b1\"\n   integrity sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==\n \n-mimic-fn@^2.1.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/mimic-fn/-/mimic-fn-2.1.0.tgz#7ed2c2ccccaf84d3ffcb7a69b57711fc2083401b\"\n-  integrity sha512-OqbOk5oEQeAZ8WXWydlu9HJjz9WVdEIvamMCcXmuqUYjTknH/sqsWvhQ3vgwKFRR1HpjvNBKQ37nbJgYzGqGcg==\n-\n-mimic-response@^1.0.0, mimic-response@^1.0.1:\n-  version \"1.0.1\"\n-  resolved \"https://registry.yarnpkg.com/mimic-response/-/mimic-response-1.0.1.tgz#4923538878eef42063cb8a3e3b0798781487ab1b\"\n-  integrity sha512-j5EctnkH7amfV/q5Hgmoal1g2QHFJRraOtmx0JpIqkxhBhI/lJSl1nMpQ45hVarwNETOoWEimndZ4QK0RHxuxQ==\n-\n minimatch@^3.0.0, minimatch@^3.0.2, minimatch@^3.0.4:\n   version \"3.0.4\"\n   resolved \"https://registry.yarnpkg.com/minimatch/-/minimatch-3.0.4.tgz#5166e286457f03306064be5497e8dbb0c3d32083\"\n@@ -1305,6 +1002,11 @@ minimist@~0.0.1:\n   version \"0.0.10\"\n   resolved \"https://registry.yarnpkg.com/minimist/-/minimist-0.0.10.tgz#de3f98543dbf96082be48ad1a0c7cda836301dcf\"\n \n+mkdirp-classic@^0.5.2:\n+  version \"0.5.3\"\n+  resolved \"https://registry.yarnpkg.com/mkdirp-classic/-/mkdirp-classic-0.5.3.tgz#fa10c9115cc6d8865be221ba47ee9bed78601113\"\n+  integrity sha512-gKLcREMhtuZRwRAfqP3RFW+TK4JqApVBtOIftVgjuABpAtpxhPGaDcfvbhNvD0B8iD1oUr/txX35NjcaY6Ns/A==\n+\n mkdirp@0.5.x, \"mkdirp@>=0.5 0\", mkdirp@^0.5.0, mkdirp@^0.5.1:\n   version \"0.5.1\"\n   resolved \"https://registry.yarnpkg.com/mkdirp/-/mkdirp-0.5.1.tgz#30057438eac6cf7f8c4767f38648d6697d75c903\"\n@@ -1322,10 +1024,10 @@ ms@2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/ms/-/ms-2.0.0.tgz#5608aeadfc00be6c2901df5f9861788de0d597c8\"\n \n-mute-stream@0.0.8:\n-  version \"0.0.8\"\n-  resolved \"https://registry.yarnpkg.com/mute-stream/-/mute-stream-0.0.8.tgz#1630c42b2251ff81e2a283de96a5497ea92e5e0d\"\n-  integrity sha512-nnbWWOkoWyUsTjKrhgD0dcz22mdkSnpYqbEjIm2nhwhuxlSkpywJmBo8h0ZqJdkp73mb90SssHkN4rsRaBAfAA==\n+ms@2.1.2:\n+  version \"2.1.2\"\n+  resolved \"https://registry.yarnpkg.com/ms/-/ms-2.1.2.tgz#d09d1f357b443f493382a8eb3ccd183872ae6009\"\n+  integrity sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w==\n \n nan@^2.2.0:\n   version \"2.6.2\"\n@@ -1335,10 +1037,12 @@ ncp@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/ncp/-/ncp-2.0.0.tgz#195a21d6c46e361d2fb1281ba38b91e9df7bdbb3\"\n \n-node-forge@^0.10.0:\n-  version \"0.10.0\"\n-  resolved \"https://registry.yarnpkg.com/node-forge/-/node-forge-0.10.0.tgz#32dea2afb3e9926f02ee5ce8794902691a676bf3\"\n-  integrity sha512-PPmu8eEeG9saEUvI97fm4OYxXVB6bFvyNTyiUOBichBpFG8A1Ljw3bY62+5oOjDEMHRnd0Y7HQ+x7uzxOzC6JA==\n+node-fetch@2.6.7:\n+  version \"2.6.7\"\n+  resolved \"https://registry.yarnpkg.com/node-fetch/-/node-fetch-2.6.7.tgz#24de9fba827e3b4ae44dc8b20256a379160052ad\"\n+  integrity sha512-ZjMPFEfVx5j+y2yF35Kzx5sF7kDzxuDj6ziH4FFbOp87zKDZNx8yExJIb05OGF4Nlt9IHFIMBkRl41VdvcNdbQ==\n+  dependencies:\n+    whatwg-url \"^5.0.0\"\n \n node-gyp@^3.5.0:\n   version \"3.6.2\"\n@@ -1402,11 +1106,6 @@ nopt@^4.0.1:\n     abbrev \"1\"\n     osenv \"^0.1.4\"\n \n-normalize-url@^4.1.0:\n-  version \"4.5.1\"\n-  resolved \"https://registry.yarnpkg.com/normalize-url/-/normalize-url-4.5.1.tgz#0dd90cf1288ee1d1313b87081c9a5932ee48518a\"\n-  integrity sha512-9UZCFRHQdNrfTpGg8+1INIg93B6zE0aXMVFkw1WFwvO4SlZywU6aLg5Of0Ap/PgcbSw4LNxvMWXMeugwMCX0AA==\n-\n \"npmlog@0 || 1 || 2 || 3 || 4\", npmlog@^4.0.2:\n   version \"4.1.2\"\n   resolved \"https://registry.yarnpkg.com/npmlog/-/npmlog-4.1.2.tgz#08a7f2a8bf734604779a9efa4ad5cc717abb954b\"\n@@ -1424,11 +1123,6 @@ oauth-sign@~0.8.1:\n   version \"0.8.2\"\n   resolved \"https://registry.yarnpkg.com/oauth-sign/-/oauth-sign-0.8.2.tgz#46a6ab7f0aead8deae9ec0565780b7d4efeb9d43\"\n \n-oauth-sign@~0.9.0:\n-  version \"0.9.0\"\n-  resolved \"https://registry.yarnpkg.com/oauth-sign/-/oauth-sign-0.9.0.tgz#47a7b016baa68b5fa0ecf3dee08a85c679ac6455\"\n-  integrity sha512-fexhUFFPTGV8ybAtSIGbV6gOkSv8UtRbDBnAyLQw4QPKkgNlsH2ByPGtMUqdWkos6YCRmAqViwgZrJc/mRDzZQ==\n-\n object-assign@^4.1.0:\n   version \"4.1.1\"\n   resolved \"https://registry.yarnpkg.com/object-assign/-/object-assign-4.1.1.tgz#2109adc7965887cfc05cbbd442cac8bfbb360863\"\n@@ -1439,19 +1133,14 @@ once@^1.3.0, once@^1.3.1, once@^1.3.3, once@^1.4.0:\n   dependencies:\n     wrappy \"1\"\n \n-onetime@^5.1.0:\n-  version \"5.1.2\"\n-  resolved \"https://registry.yarnpkg.com/onetime/-/onetime-5.1.2.tgz#d0e96ebb56b07476df1dd9c4806e5237985ca45e\"\n-  integrity sha512-kbpaSSGJTWdAY5KPVeMOKXSrPtr8C8C7wodJbcsd51jRnmD+GZu8Y0VoU6Dm5Z4vWr0Ig/1NKuWRKf7j5aaYSg==\n-  dependencies:\n-    mimic-fn \"^2.1.0\"\n-\n-open@^6.4.0:\n-  version \"6.4.0\"\n-  resolved \"https://registry.yarnpkg.com/open/-/open-6.4.0.tgz#5c13e96d0dc894686164f18965ecfe889ecfc8a9\"\n-  integrity sha512-IFenVPgF70fSm1keSd2iDBIDIBZkroLeuffXq+wKTzTJlBpesFWojV9lb8mzOfaAzM1sr7HQHuO0vtV0zYekGg==\n+open@^8.4.0:\n+  version \"8.4.2\"\n+  resolved \"https://registry.yarnpkg.com/open/-/open-8.4.2.tgz#5b5ffe2a8f793dcd2aad73e550cb87b59cb084f9\"\n+  integrity sha512-7x81NCL719oNbsq/3mh+hVrAWmFuEYUqrq/Iw3kUzH8ReypT9QQ0BLoJS7/G9k6N81XjW4qHWtjWwe/9eLy1EQ==\n   dependencies:\n-    is-wsl \"^1.1.0\"\n+    define-lazy-prop \"^2.0.0\"\n+    is-docker \"^2.1.1\"\n+    is-wsl \"^2.2.0\"\n \n opener@~1.4.0:\n   version \"1.4.3\"\n@@ -1468,13 +1157,7 @@ os-homedir@^1.0.0:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/os-homedir/-/os-homedir-1.0.2.tgz#ffbc4988336e0e833de0c168c7ef152121aa7fb3\"\n \n-os-locale@^1.4.0:\n-  version \"1.4.0\"\n-  resolved \"https://registry.yarnpkg.com/os-locale/-/os-locale-1.4.0.tgz#20f9f17ae29ed345e8bde583b13d2009803c14d9\"\n-  dependencies:\n-    lcid \"^1.0.0\"\n-\n-os-tmpdir@^1.0.0, os-tmpdir@~1.0.2:\n+os-tmpdir@^1.0.0:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/os-tmpdir/-/os-tmpdir-1.0.2.tgz#bbe67406c79aa85c5cfec766fe5734555dfa1274\"\n \n@@ -1485,38 +1168,54 @@ osenv@0, osenv@^0.1.4:\n     os-homedir \"^1.0.0\"\n     os-tmpdir \"^1.0.0\"\n \n-p-cancelable@^1.0.0:\n-  version \"1.1.0\"\n-  resolved \"https://registry.yarnpkg.com/p-cancelable/-/p-cancelable-1.1.0.tgz#d078d15a3af409220c886f1d9a0ca2e441ab26cc\"\n-  integrity sha512-s73XxOZ4zpt1edZYZzvhqFa6uvQc1vwUa0K0BdtIZgQMAJj9IbebH+JkgKZc9h+B05PKHLOTl4ajG1BmNrVZlw==\n+p-limit@^2.2.0:\n+  version \"2.3.0\"\n+  resolved \"https://registry.yarnpkg.com/p-limit/-/p-limit-2.3.0.tgz#3dd33c647a214fdfffd835933eb086da0dc21db1\"\n+  integrity sha512-//88mFWSJx8lxCzwdAABTJL2MyWB12+eIY7MDL2SqLmAkeKU9qxRvWuSyTjm3FUmpBEMuFfckAIqEaVGUDxb6w==\n+  dependencies:\n+    p-try \"^2.0.0\"\n \n-package-json@^6.3.0:\n-  version \"6.5.0\"\n-  resolved \"https://registry.yarnpkg.com/package-json/-/package-json-6.5.0.tgz#6feedaca35e75725876d0b0e64974697fed145b0\"\n-  integrity sha512-k3bdm2n25tkyxcjSKzB5x8kfVxlMdgsbPr0GkZcwHsLpba6cBjqCt1KlcChKEvxHIcTB1FVMuwoijZ26xex5MQ==\n+p-locate@^4.1.0:\n+  version \"4.1.0\"\n+  resolved \"https://registry.yarnpkg.com/p-locate/-/p-locate-4.1.0.tgz#a3428bb7088b3a60292f66919278b7c297ad4f07\"\n+  integrity sha512-R79ZZ/0wAxKGu3oYMlz8jy/kbhsNrS7SKZ7PxEHBgJ5+F2mtFW2fK2cOtBh1cHYkQsbzFV7I+EoRKe6Yt0oK7A==\n   dependencies:\n-    got \"^9.6.0\"\n-    registry-auth-token \"^4.0.0\"\n-    registry-url \"^5.0.0\"\n-    semver \"^6.2.0\"\n+    p-limit \"^2.2.0\"\n+\n+p-try@^2.0.0:\n+  version \"2.2.0\"\n+  resolved \"https://registry.yarnpkg.com/p-try/-/p-try-2.2.0.tgz#cb2868540e313d61de58fafbe35ce9004d5540e6\"\n+  integrity sha512-R4nPAVTAU0B9D35/Gk3uJf/7XYbQcyohSKdvAxIRSNghFl4e71hVoGnBNQz9cWaXxO2I10KTC+3jMdvvoKw6dQ==\n \n parse-cache-control@1.0.1:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/parse-cache-control/-/parse-cache-control-1.0.1.tgz#8eeab3e54fa56920fe16ba38f77fa21aacc2d74e\"\n   integrity sha1-juqz5U+laSD+Fro493+iGqzC104=\n \n+path-exists@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/path-exists/-/path-exists-4.0.0.tgz#513bdbe2d3b95d7762e8c1137efa195c6c61b5b3\"\n+  integrity sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==\n+\n path-is-absolute@^1.0.0:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/path-is-absolute/-/path-is-absolute-1.0.1.tgz#174b9268735534ffbc7ace6bf53a5a9e1b5c5f5f\"\n \n+pend@~1.2.0:\n+  version \"1.2.0\"\n+  resolved \"https://registry.yarnpkg.com/pend/-/pend-1.2.0.tgz#7a57eb550a6783f9115331fcf4663d5c8e007a50\"\n+  integrity sha512-F3asv42UuXchdzt+xXqfW1OGlVBe+mxa2mqI0pg5yAHZPvFmY3Y6drSf/GQ1A86WgWEN9Kzh/WrgKa6iGcHXLg==\n+\n performance-now@^0.2.0:\n   version \"0.2.0\"\n   resolved \"https://registry.yarnpkg.com/performance-now/-/performance-now-0.2.0.tgz#33ef30c5c77d4ea21c5a53869d91b56d8f2555e5\"\n \n-performance-now@^2.1.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/performance-now/-/performance-now-2.1.0.tgz#6309f4e0e5fa913ec1c69307ae364b4b377c9e7b\"\n-  integrity sha512-7EAHlyLHI56VEIdK57uwHdHKIaAGbnXPiw0yWbarQZOKaKpvUIgW0jWRVLiatnM+XXlSwsanIBH/hzGMJulMow==\n+pkg-dir@4.2.0:\n+  version \"4.2.0\"\n+  resolved \"https://registry.yarnpkg.com/pkg-dir/-/pkg-dir-4.2.0.tgz#f099133df7ede422e81d1d8448270eeb3e4261f3\"\n+  integrity sha512-HRDzbaKjC+AOWVXxAU/x54COGeIv9eb+6CkDSQoNTt4XyWoIJvuPsXizxu/Fr23EiekbtZwmh1IcIG/l/a10GQ==\n+  dependencies:\n+    find-up \"^4.0.0\"\n \n portfinder@^1.0.13:\n   version \"1.0.13\"\n@@ -1526,30 +1225,30 @@ portfinder@^1.0.13:\n     debug \"^2.2.0\"\n     mkdirp \"0.5.x\"\n \n-prepend-http@^2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/prepend-http/-/prepend-http-2.0.0.tgz#e92434bfa5ea8c19f41cdfd401d741a3c819d897\"\n-  integrity sha512-ravE6m9Atw9Z/jjttRUZ+clIXogdghyZAuWJ3qEzjT+jI/dL1ifAqhZeC5VHzQp1MSt1+jxKkFNemj/iO7tVUA==\n-\n process-nextick-args@~1.0.6:\n   version \"1.0.7\"\n   resolved \"https://registry.yarnpkg.com/process-nextick-args/-/process-nextick-args-1.0.7.tgz#150e20b756590ad3f91093f25a4f2ad8bff30ba3\"\n \n+progress@2.0.3:\n+  version \"2.0.3\"\n+  resolved \"https://registry.yarnpkg.com/progress/-/progress-2.0.3.tgz#7e8cf8d8f5b8f239c1bc68beb4eb78567d572ef8\"\n+  integrity sha512-7PiHtLll5LdnKIMw100I+8xJXR5gW2QwWYkT6iJva0bXitZKa/XMrSbdmg3r2Xnaidz9Qumd0VPaMrZlF9V9sA==\n+\n promisify-node@~0.3.0:\n   version \"0.3.0\"\n   resolved \"https://registry.yarnpkg.com/promisify-node/-/promisify-node-0.3.0.tgz#b4b55acf90faa7d2b8b90ca396899086c03060cf\"\n   dependencies:\n     nodegit-promise \"~4.0.0\"\n \n-ps-list@^7.2.0:\n-  version \"7.2.0\"\n-  resolved \"https://registry.yarnpkg.com/ps-list/-/ps-list-7.2.0.tgz#3d110e1de8249a4b178c9b1cf2a215d1e4e42fc0\"\n-  integrity sha512-v4Bl6I3f2kJfr5o80ShABNHAokIgY+wFDTQfE+X3zWYgSGQOCBeYptLZUpoOALBqO5EawmDN/tjTldJesd0ujQ==\n+proxy-from-env@1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/proxy-from-env/-/proxy-from-env-1.1.0.tgz#e102f16ca355424865755d2c9e8ea4f24d58c3e2\"\n+  integrity sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==\n \n-psl@^1.1.28:\n-  version \"1.9.0\"\n-  resolved \"https://registry.yarnpkg.com/psl/-/psl-1.9.0.tgz#d0df2a137f00794565fcaf3b2c00cd09f8d5a5a7\"\n-  integrity sha512-E/ZsdU4HLs/68gYzgGTkMicWTLPdAftJLfJFlLUAAKZGkStNU72sZjT66SnMDVOfOWY/YAoiD7Jxa9iHvngcag==\n+ps-list@^8.0.0:\n+  version \"8.1.1\"\n+  resolved \"https://registry.yarnpkg.com/ps-list/-/ps-list-8.1.1.tgz#9ff1952b26a9a07fcc05270407e60544237ae581\"\n+  integrity sha512-OPS9kEJYVmiO48u/B9qneqhkMvgCxT+Tm28VCEJpheTpl8cJ0ffZRRNgS5mrQRTrX5yRTpaJ+hRDeefXYmmorQ==\n \n pump@^3.0.0:\n   version \"3.0.0\"\n@@ -1563,17 +1262,23 @@ punycode@^1.4.1:\n   version \"1.4.1\"\n   resolved \"https://registry.yarnpkg.com/punycode/-/punycode-1.4.1.tgz#c0d5a63b2718800ad8e1eb0fa5269c84dd41845e\"\n \n-punycode@^2.1.0, punycode@^2.1.1:\n-  version \"2.3.1\"\n-  resolved \"https://registry.yarnpkg.com/punycode/-/punycode-2.3.1.tgz#027422e2faec0b25e1549c3e1bd8309b9133b6e5\"\n-  integrity sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==\n-\n-pupa@^2.0.1:\n-  version \"2.1.1\"\n-  resolved \"https://registry.yarnpkg.com/pupa/-/pupa-2.1.1.tgz#f5e8fd4afc2c5d97828faa523549ed8744a20d62\"\n-  integrity sha512-l1jNAspIBSFqbT+y+5FosojNpVpF94nlI+wDUpqP9enwOTfHx9f0gh5nB96vl+6yTpsJsypeNrwfzPrKuHB41A==\n-  dependencies:\n-    escape-goat \"^2.0.0\"\n+puppeteer-core@^13.7.0:\n+  version \"13.7.0\"\n+  resolved \"https://registry.yarnpkg.com/puppeteer-core/-/puppeteer-core-13.7.0.tgz#3344bee3994163f49120a55ddcd144a40575ba5b\"\n+  integrity sha512-rXja4vcnAzFAP1OVLq/5dWNfwBGuzcOARJ6qGV7oAZhnLmVRU8G5MsdeQEAOy332ZhkIOnn9jp15R89LKHyp2Q==\n+  dependencies:\n+    cross-fetch \"3.1.5\"\n+    debug \"4.3.4\"\n+    devtools-protocol \"0.0.981744\"\n+    extract-zip \"2.0.1\"\n+    https-proxy-agent \"5.0.1\"\n+    pkg-dir \"4.2.0\"\n+    progress \"2.0.3\"\n+    proxy-from-env \"1.1.0\"\n+    rimraf \"3.0.2\"\n+    tar-fs \"2.1.1\"\n+    unbzip2-stream \"1.4.3\"\n+    ws \"8.5.0\"\n \n qs@~2.3.3:\n   version \"2.3.3\"\n@@ -1583,32 +1288,6 @@ qs@~6.4.0:\n   version \"6.4.0\"\n   resolved \"https://registry.yarnpkg.com/qs/-/qs-6.4.0.tgz#13e26d28ad6b0ffaa91312cd3bf708ed351e7233\"\n \n-qs@~6.5.2:\n-  version \"6.5.3\"\n-  resolved \"https://registry.yarnpkg.com/qs/-/qs-6.5.3.tgz#3aeeffc91967ef6e35c0e488ef46fb296ab76aad\"\n-  integrity sha512-qxXIEh4pCGfHICj1mAJQ2/2XVZkjCDTcEgfoSQxc/fYivUZxTkk7L3bDBJSoNrEzXI17oUO5Dp07ktqE5KzczA==\n-\n-raven@^2.2.1:\n-  version \"2.6.4\"\n-  resolved \"https://registry.yarnpkg.com/raven/-/raven-2.6.4.tgz#458d4a380c8fbb59e0150c655625aaf60c167ea3\"\n-  integrity sha512-6PQdfC4+DQSFncowthLf+B6Hr0JpPsFBgTVYTAOq7tCmx/kR4SXbeawtPch20+3QfUcQDoJBLjWW1ybvZ4kXTw==\n-  dependencies:\n-    cookie \"0.3.1\"\n-    md5 \"^2.2.1\"\n-    stack-trace \"0.0.10\"\n-    timed-out \"4.0.1\"\n-    uuid \"3.3.2\"\n-\n-rc@1.2.8, rc@^1.2.8:\n-  version \"1.2.8\"\n-  resolved \"https://registry.yarnpkg.com/rc/-/rc-1.2.8.tgz#cd924bf5200a075b83c188cd6b9e211b7fc0d3ed\"\n-  integrity sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw==\n-  dependencies:\n-    deep-extend \"^0.6.0\"\n-    ini \"~1.3.0\"\n-    minimist \"^1.2.0\"\n-    strip-json-comments \"~2.0.1\"\n-\n rc@^1.1.7:\n   version \"1.2.1\"\n   resolved \"https://registry.yarnpkg.com/rc/-/rc-1.2.1.tgz#2e03e8e42ee450b8cb3dce65be1bf8974e1dfd95\"\n@@ -1618,14 +1297,6 @@ rc@^1.1.7:\n     minimist \"^1.2.0\"\n     strip-json-comments \"~2.0.1\"\n \n-rdf-canonize@^1.0.2:\n-  version \"1.2.0\"\n-  resolved \"https://registry.yarnpkg.com/rdf-canonize/-/rdf-canonize-1.2.0.tgz#9872b2cc6ed92a9969e834f9f042addaf0d4f7f9\"\n-  integrity sha512-MQdcRDz4+82nUrEb3hNQangBDpmep15uMmnWclGi/1KS0bNVc8oHpoNI0PFLHZsvwgwRzH31bO1JAScqUAstvw==\n-  dependencies:\n-    node-forge \"^0.10.0\"\n-    semver \"^6.3.0\"\n-\n readable-stream@^2.0.6, readable-stream@^2.1.4:\n   version \"2.3.3\"\n   resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-2.3.3.tgz#368f2512d79f9d46fdfc71349ae7878bbc1eb95c\"\n@@ -1638,19 +1309,14 @@ readable-stream@^2.0.6, readable-stream@^2.1.4:\n     string_decoder \"~1.0.3\"\n     util-deprecate \"~1.0.1\"\n \n-registry-auth-token@^4.0.0:\n-  version \"4.2.2\"\n-  resolved \"https://registry.yarnpkg.com/registry-auth-token/-/registry-auth-token-4.2.2.tgz#f02d49c3668884612ca031419491a13539e21fac\"\n-  integrity sha512-PC5ZysNb42zpFME6D/XlIgtNGdTl8bBOCw90xQLVMpzuuubJKYDWFAEuUNc+Cn8Z8724tg2SDhDRrkVEsqfDMg==\n-  dependencies:\n-    rc \"1.2.8\"\n-\n-registry-url@^5.0.0:\n-  version \"5.1.0\"\n-  resolved \"https://registry.yarnpkg.com/registry-url/-/registry-url-5.1.0.tgz#e98334b50d5434b81136b44ec638d9c2009c5009\"\n-  integrity sha512-8acYXXTI0AkQv6RAOjE3vOaIXZkT9wo4LOFbBKYQEEnnMNBpKqdUrI6S4NT0KPIo/WVvJ5tE/X5LF/TQUf0ekw==\n+readable-stream@^3.1.1, readable-stream@^3.4.0:\n+  version \"3.6.2\"\n+  resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-3.6.2.tgz#56a9b36ea965c00c5a93ef31eb111a0f11056967\"\n+  integrity sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==\n   dependencies:\n-    rc \"^1.2.8\"\n+    inherits \"^2.0.3\"\n+    string_decoder \"^1.1.1\"\n+    util-deprecate \"^1.0.1\"\n \n request@2, request@^2.81.0:\n   version \"2.81.0\"\n@@ -1679,112 +1345,47 @@ request@2, request@^2.81.0:\n     tunnel-agent \"^0.6.0\"\n     uuid \"^3.0.0\"\n \n-request@^2.88.0:\n-  version \"2.88.2\"\n-  resolved \"https://registry.yarnpkg.com/request/-/request-2.88.2.tgz#d73c918731cb5a87da047e207234146f664d12b3\"\n-  integrity sha512-MsvtOrfG9ZcrOwAW+Qi+F6HbD0CWXEh9ou77uOb7FM2WPhwT7smM833PzanhJLsgXjN89Ir6V2PczXNnMpwKhw==\n-  dependencies:\n-    aws-sign2 \"~0.7.0\"\n-    aws4 \"^1.8.0\"\n-    caseless \"~0.12.0\"\n-    combined-stream \"~1.0.6\"\n-    extend \"~3.0.2\"\n-    forever-agent \"~0.6.1\"\n-    form-data \"~2.3.2\"\n-    har-validator \"~5.1.3\"\n-    http-signature \"~1.2.0\"\n-    is-typedarray \"~1.0.0\"\n-    isstream \"~0.1.2\"\n-    json-stringify-safe \"~5.0.1\"\n-    mime-types \"~2.1.19\"\n-    oauth-sign \"~0.9.0\"\n-    performance-now \"^2.1.0\"\n-    qs \"~6.5.2\"\n-    safe-buffer \"^5.1.2\"\n-    tough-cookie \"~2.5.0\"\n-    tunnel-agent \"^0.6.0\"\n-    uuid \"^3.3.2\"\n+require-directory@^2.1.1:\n+  version \"2.1.1\"\n+  resolved \"https://registry.yarnpkg.com/require-directory/-/require-directory-2.1.1.tgz#8c64ad5fd30dab1c976e2344ffe7f792a6a6df42\"\n+  integrity sha512-fGxEI7+wsG9xrvdjsrlmL22OMTTiHRwAMroiEeMgq8gzoLC/PQr7RsRDSTLUg/bZAZtF+TVIkHc6/4RIKrui+Q==\n \n requires-port@1.x.x:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/requires-port/-/requires-port-1.0.0.tgz#925d2601d39ac485e091cf0da5c6e694dc3dcaff\"\n \n-responselike@^1.0.2:\n-  version \"1.0.2\"\n-  resolved \"https://registry.yarnpkg.com/responselike/-/responselike-1.0.2.tgz#918720ef3b631c5642be068f15ade5a46f4ba1e7\"\n-  integrity sha512-/Fpe5guzJk1gPqdJLJR5u7eG/gNY4nImjbRDaVWVMRhne55TCmj2i9Q+54PBRfatRC8v/rIiv9BN0pMd9OV5EQ==\n-  dependencies:\n-    lowercase-keys \"^1.0.0\"\n-\n-restore-cursor@^3.1.0:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/restore-cursor/-/restore-cursor-3.1.0.tgz#39f67c54b3a7a58cea5236d95cf0034239631f7e\"\n-  integrity sha512-l+sSefzHpj5qimhFSE5a8nufZYAM3sBSVMAPtYkmC+4EH2anSGaEMXSD0izRQbu9nfyQ9y5JrVmp7E8oZrUjvA==\n-  dependencies:\n-    onetime \"^5.1.0\"\n-    signal-exit \"^3.0.2\"\n-\n rimraf@2, rimraf@^2.2.8, rimraf@^2.5.1, rimraf@^2.6.1:\n   version \"2.6.1\"\n   resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-2.6.1.tgz#c2338ec643df7a1b7fe5c54fa86f57428a55f33d\"\n   dependencies:\n     glob \"^7.0.5\"\n \n-rimraf@^3.0.2:\n+rimraf@3.0.2, rimraf@^3.0.2:\n   version \"3.0.2\"\n   resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-3.0.2.tgz#f1a5402ba6220ad52cc1282bac1ae3aa49fd061a\"\n   integrity sha512-JZkJMZkAGFFPP2YqXZXPbMlMBgsxzE8ILs4lMIX/2o0L9UBw9O/Y3o6wFw/i9YLapcUJWwqbi3kdxIPdC62TIA==\n   dependencies:\n     glob \"^7.1.3\"\n \n-robots-parser@^2.0.1:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/robots-parser/-/robots-parser-2.1.0.tgz#d16b78ce34e861ab6afbbf0aac65974dbe01566e\"\n-  integrity sha512-k07MeDS1Tl1zjoYs5bHfUbgQ0MfaeTOepDcjZFxdYXd84p6IeLDQyUwlMk2AZ9c2yExA30I3ayWhmqz9tg0DzQ==\n-\n-run-async@^2.4.0:\n-  version \"2.4.1\"\n-  resolved \"https://registry.yarnpkg.com/run-async/-/run-async-2.4.1.tgz#8440eccf99ea3e70bd409d49aab88e10c189a455\"\n-  integrity sha512-tvVnVv01b8c1RrA6Ep7JkStj85Guv/YrMcwqYQnwjsAS2cTmmPGBBjAjpCW7RrSodNSoE2/qg9O4bceNvUuDgQ==\n-\n-rxjs@^6.6.0:\n-  version \"6.6.7\"\n-  resolved \"https://registry.yarnpkg.com/rxjs/-/rxjs-6.6.7.tgz#90ac018acabf491bf65044235d5863c4dab804c9\"\n-  integrity sha512-hTdwr+7yYNIT5n4AMYp85KA6yw2Va0FLa3Rguvbpa4W3I5xynaBZo41cM3XM+4Q6fRMj3sBYIR1VAmZMXYJvRQ==\n-  dependencies:\n-    tslib \"^1.9.0\"\n+robots-parser@^3.0.0:\n+  version \"3.0.1\"\n+  resolved \"https://registry.yarnpkg.com/robots-parser/-/robots-parser-3.0.1.tgz#3d8a3cdfa8ac240cbb062a4bd16fcc0e0fb9ed23\"\n+  integrity sha512-s+pyvQeIKIZ0dx5iJiQk1tPLJAWln39+MI5jtM8wnyws+G5azk+dMnMX0qfbqNetKKNgcWWOdi0sfm+FbQbgdQ==\n \n safe-buffer@^5.0.1, safe-buffer@~5.1.0, safe-buffer@~5.1.1:\n   version \"5.1.1\"\n   resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.1.1.tgz#893312af69b2123def71f57889001671eeb2c853\"\n \n-safe-buffer@^5.1.2:\n+safe-buffer@~5.2.0:\n   version \"5.2.1\"\n   resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.2.1.tgz#1eaf9fa9bdb1fdd4ec75f58f9cdb4e6b7827eec6\"\n   integrity sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==\n \n-\"safer-buffer@>= 2.1.2 < 3\":\n-  version \"2.1.2\"\n-  resolved \"https://registry.yarnpkg.com/safer-buffer/-/safer-buffer-2.1.2.tgz#44fa161b0187b9549dd84bb91802f9bd8385cd6a\"\n-  integrity sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==\n-\n-semver-diff@^3.1.1:\n-  version \"3.1.1\"\n-  resolved \"https://registry.yarnpkg.com/semver-diff/-/semver-diff-3.1.1.tgz#05f77ce59f325e00e2706afd67bb506ddb1ca32b\"\n-  integrity sha512-GX0Ix/CJcHyB8c4ykpHGIAvLyOwOobtM/8d+TQkAd81/bEjgPHrfba41Vpesr7jX/t8Uh+R3EX9eAS5be+jQYg==\n-  dependencies:\n-    semver \"^6.3.0\"\n-\n semver@^5.3.0:\n   version \"5.4.1\"\n   resolved \"https://registry.yarnpkg.com/semver/-/semver-5.4.1.tgz#e059c09d8571f0540823733433505d3a2f00b18e\"\n \n-semver@^5.6.0:\n-  version \"5.7.2\"\n-  resolved \"https://registry.yarnpkg.com/semver/-/semver-5.7.2.tgz#48d55db737c3287cd4835e17fa13feace1c41ef8\"\n-  integrity sha512-cBznnQ9KjJqU67B52RMC65CMarK2600WFnbkcaiwWq3xy/5haFJlshgnpjovMVJ+Hff49d8GEn0b87C5pDQ10g==\n-\n-semver@^6.0.0, semver@^6.2.0, semver@^6.3.0:\n+semver@^6.0.0:\n   version \"6.3.1\"\n   resolved \"https://registry.yarnpkg.com/semver/-/semver-6.3.1.tgz#556d2ef8689146e46dcea4bfdd095f3434dffcb4\"\n   integrity sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==\n@@ -1830,11 +1431,6 @@ sshpk@^1.7.0:\n     jsbn \"~0.1.0\"\n     tweetnacl \"~0.14.0\"\n \n-stack-trace@0.0.10:\n-  version \"0.0.10\"\n-  resolved \"https://registry.yarnpkg.com/stack-trace/-/stack-trace-0.0.10.tgz#547c70b347e8d32b4e108ea1a2a159e5fdde19c0\"\n-  integrity sha1-VHxws0fo0ytOEI6hoqFZ5f3eGcA=\n-\n stats-analysis@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/stats-analysis/-/stats-analysis-2.0.0.tgz#f45c516ff5c5d26c26f2d8c7b3d57592802d6187\"\n@@ -1847,7 +1443,7 @@ string-width@^1.0.1, string-width@^1.0.2:\n     is-fullwidth-code-point \"^1.0.0\"\n     strip-ansi \"^3.0.0\"\n \n-string-width@^4.0.0, string-width@^4.1.0:\n+string-width@^4.1.0, string-width@^4.2.0, string-width@^4.2.3:\n   version \"4.2.3\"\n   resolved \"https://registry.yarnpkg.com/string-width/-/string-width-4.2.3.tgz#269c7117d27b05ad2e536830a8ec895ef9c6d010\"\n   integrity sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==\n@@ -1856,6 +1452,13 @@ string-width@^4.0.0, string-width@^4.1.0:\n     is-fullwidth-code-point \"^3.0.0\"\n     strip-ansi \"^6.0.1\"\n \n+string_decoder@^1.1.1:\n+  version \"1.3.0\"\n+  resolved \"https://registry.yarnpkg.com/string_decoder/-/string_decoder-1.3.0.tgz#42f114594a46cf1a8e30b0a84f56c78c3edac21e\"\n+  integrity sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==\n+  dependencies:\n+    safe-buffer \"~5.2.0\"\n+\n string_decoder@~1.0.3:\n   version \"1.0.3\"\n   resolved \"https://registry.yarnpkg.com/string_decoder/-/string_decoder-1.0.3.tgz#0fc67d7c141825de94282dd536bec6b9bce860ab\"\n@@ -1889,19 +1492,15 @@ supports-color@^4.0.0:\n   dependencies:\n     has-flag \"^2.0.0\"\n \n-supports-color@^5.3.0:\n-  version \"5.5.0\"\n-  resolved \"https://registry.yarnpkg.com/supports-color/-/supports-color-5.5.0.tgz#e2e69a44ac8772f78a1ec0b35b689df6530efc8f\"\n-  integrity sha512-QjVjwdXIt408MIiAqCX4oUKsgU2EqAGzs2Ppkm4aQYbjm+ZEWEcW4SfFNTr4uMNZma0ey4f5lgLrkB0aX0QMow==\n-  dependencies:\n-    has-flag \"^3.0.0\"\n-\n-supports-color@^7.1.0:\n-  version \"7.2.0\"\n-  resolved \"https://registry.yarnpkg.com/supports-color/-/supports-color-7.2.0.tgz#1b7dcdcb32b8138801b3e478ba6a51caa89648da\"\n-  integrity sha512-qpCAvRl9stuOHveKsn7HncJRvv501qIacKzQlO/+Lwxc9+0q2wLyv4Dfvt80/DPn2pqOBsJdDiogXGR9+OvwRw==\n+tar-fs@2.1.1:\n+  version \"2.1.1\"\n+  resolved \"https://registry.yarnpkg.com/tar-fs/-/tar-fs-2.1.1.tgz#489a15ab85f1f0befabb370b7de4f9eb5cbe8784\"\n+  integrity sha512-V0r2Y9scmbDRLCNex/+hYzvp/zyYjvFbHPNgVTKfQvVrb6guiE/fxP+XblDNR011utopbkex2nM4dHNV6GDsng==\n   dependencies:\n-    has-flag \"^4.0.0\"\n+    chownr \"^1.1.1\"\n+    mkdirp-classic \"^0.5.2\"\n+    pump \"^3.0.0\"\n+    tar-stream \"^2.1.4\"\n \n tar-pack@^3.4.0:\n   version \"3.4.0\"\n@@ -1916,6 +1515,17 @@ tar-pack@^3.4.0:\n     tar \"^2.2.1\"\n     uid-number \"^0.0.6\"\n \n+tar-stream@^2.1.4:\n+  version \"2.2.0\"\n+  resolved \"https://registry.yarnpkg.com/tar-stream/-/tar-stream-2.2.0.tgz#acad84c284136b060dc3faa64474aa9aebd77287\"\n+  integrity sha512-ujeqbceABgwMZxEJnk2HDY2DlnUZ+9oEcb1KzTVfYHio0UE6dG71n60d8D2I4qNvleWrrXpmjpt7vZeF1LnMZQ==\n+  dependencies:\n+    bl \"^4.0.3\"\n+    end-of-stream \"^1.4.1\"\n+    fs-constants \"^1.0.0\"\n+    inherits \"^2.0.3\"\n+    readable-stream \"^3.1.1\"\n+\n tar@^2.0.0, tar@^2.2.1:\n   version \"2.2.1\"\n   resolved \"https://registry.yarnpkg.com/tar/-/tar-2.2.1.tgz#8e4d2a256c0e2185c6b18ad694aec968b83cb1d1\"\n@@ -1924,52 +1534,28 @@ tar@^2.0.0, tar@^2.2.1:\n     fstream \"^1.0.2\"\n     inherits \"2\"\n \n-term-size@^2.1.0:\n-  version \"2.2.1\"\n-  resolved \"https://registry.yarnpkg.com/term-size/-/term-size-2.2.1.tgz#2a6a54840432c2fb6320fea0f415531e90189f54\"\n-  integrity sha512-wK0Ri4fOGjv/XPy8SBHZChl8CM7uMc5VML7SqiQ0zG7+J5Vr+RMQDoHa2CNT6KHUnTGIXH34UDMkPzAUyapBZg==\n+third-party-web@^0.17.1:\n+  version \"0.17.1\"\n+  resolved \"https://registry.yarnpkg.com/third-party-web/-/third-party-web-0.17.1.tgz#22e03f1ff519a6380bae4594b704b9bb28e15158\"\n+  integrity sha512-X9Mha8cVeBwakunlZXkXL6xRzw8VCcDGWqT59EzeTYAJIi8ien3CuufnEGEx4ZUFahumNQdoOwf4H2T9Ca6lBg==\n \n-third-party-web@^0.12.2:\n-  version \"0.12.7\"\n-  resolved \"https://registry.yarnpkg.com/third-party-web/-/third-party-web-0.12.7.tgz#64445702379abf1a29066d636a965173e4e423c6\"\n-  integrity sha512-9d/OfjEOjyeOpnm4F9o0KSK6BI6ytvi9DINSB5h1+jdlCvQlhKpViMSxWpBN9WstdfDQ61BS6NxWqcPCuQCAJg==\n-\n-through@^2.3.6:\n+through@^2.3.8:\n   version \"2.3.8\"\n   resolved \"https://registry.yarnpkg.com/through/-/through-2.3.8.tgz#0dd4c9ffaabc357960b1b724115d7e0e86a2e1f5\"\n-  integrity sha1-DdTJ/6q8NXlgsbckEV1+Doai4fU=\n-\n-timed-out@4.0.1:\n-  version \"4.0.1\"\n-  resolved \"https://registry.yarnpkg.com/timed-out/-/timed-out-4.0.1.tgz#f32eacac5a175bea25d7fab565ab3ed8741ef56f\"\n-\n-tmp@^0.0.33:\n-  version \"0.0.33\"\n-  resolved \"https://registry.yarnpkg.com/tmp/-/tmp-0.0.33.tgz#6d34335889768d21b2bcda0aa277ced3b1bfadf9\"\n-  integrity sha512-jRCJlojKnZ3addtTOjdIqoRuPEKBvNXcGYqzO6zWZX8KfKEpnGY5jfggJQ3EjKuu8D4bJRr0y+cYJFmYbImXGw==\n-  dependencies:\n-    os-tmpdir \"~1.0.2\"\n-\n-to-readable-stream@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/to-readable-stream/-/to-readable-stream-1.0.0.tgz#ce0aa0c2f3df6adf852efb404a783e77c0475771\"\n-  integrity sha512-Iq25XBt6zD5npPhlLVXGFN3/gyR2/qODcKNNyTMd4vbm39HUaOiAM4PMq0eMVC/Tkxz+Zjdsc55g9yyz+Yq00Q==\n+  integrity sha512-w89qg7PI8wAdvX60bMDP+bFoD5Dvhm9oLheFp5O4a2QF0cSBGsBX4qZmadPMvVqlLJBBci+WqGGOAPvcDeNSVg==\n \n tough-cookie@~2.3.0:\n   version \"2.3.2\"\n   resolved \"https://registry.yarnpkg.com/tough-cookie/-/tough-cookie-2.3.2.tgz#f081f76e4c85720e6c37a5faced737150d84072a\"\n   dependencies:\n     punycode \"^1.4.1\"\n \n-tough-cookie@~2.5.0:\n-  version \"2.5.0\"\n-  resolved \"https://registry.yarnpkg.com/tough-cookie/-/tough-cookie-2.5.0.tgz#cd9fb2a0aa1d5a12b473bd9fb96fa3dcff65ade2\"\n-  integrity sha512-nlLsUzgm1kfLXSXfRZMc1KLAugd4hqJHDTvc2hDIwS3mZAfMEuMbc03SujMF+GEcpaX/qboeycw6iO8JwVv2+g==\n-  dependencies:\n-    psl \"^1.1.28\"\n-    punycode \"^2.1.1\"\n+tr46@~0.0.3:\n+  version \"0.0.3\"\n+  resolved \"https://registry.yarnpkg.com/tr46/-/tr46-0.0.3.tgz#8184fd347dac9cdc185992f3a6622e14b9d9ab6a\"\n+  integrity sha512-N3WMsuqV66lT30CrXNbEjx4GEwlow3v6rr4mCcv6prnfwhS01rkgyFdjPNBYd9br7LpXV1+Emh01fHnq2Gdgrw==\n \n-tslib@^1.9.0:\n+tslib@^1.9.3:\n   version \"1.14.1\"\n   resolved \"https://registry.yarnpkg.com/tslib/-/tslib-1.14.1.tgz#cf2d38bdc34a134bcaf1091c41f6619e2f672d00\"\n   integrity sha512-Xni35NKzjgMrwevysHTCArtLDpPvye8zV/0E4EyYn43P7/7qvQwPh9BGkHewbMulVntbigmcT7rdX3BNo9wRJg==\n@@ -1984,16 +1570,6 @@ tweetnacl@^0.14.3, tweetnacl@~0.14.0:\n   version \"0.14.5\"\n   resolved \"https://registry.yarnpkg.com/tweetnacl/-/tweetnacl-0.14.5.tgz#5ae68177f192d4456269d108afa93ff8743f4f64\"\n \n-type-fest@^0.21.3:\n-  version \"0.21.3\"\n-  resolved \"https://registry.yarnpkg.com/type-fest/-/type-fest-0.21.3.tgz#d260a24b0198436e133fa26a524a6d65fa3b2e37\"\n-  integrity sha512-t0rzBq87m3fVcduHDUFhKmyyX+9eo6WQjZvf51Ea/M0Q7+T374Jp1aUiyUl0GKxp8M/OETVHSDvmkyPgvX+X2w==\n-\n-type-fest@^0.8.1:\n-  version \"0.8.1\"\n-  resolved \"https://registry.yarnpkg.com/type-fest/-/type-fest-0.8.1.tgz#09e249ebde851d3b1e48d27c105444667f17b83d\"\n-  integrity sha512-4dbzIzqvjtgiM5rw1k5rEHtBANKmdudhGyBEajN01fEyhaAIhsoKNy6y7+IN93IfpFtwY9iqi7kD+xwKhQsNJA==\n-\n typedarray-to-buffer@^3.1.5:\n   version \"3.1.5\"\n   resolved \"https://registry.yarnpkg.com/typedarray-to-buffer/-/typedarray-to-buffer-3.1.5.tgz#a97ee7a9ff42691b9f783ff1bc5112fe3fca9080\"\n@@ -2005,15 +1581,13 @@ uid-number@^0.0.6:\n   version \"0.0.6\"\n   resolved \"https://registry.yarnpkg.com/uid-number/-/uid-number-0.0.6.tgz#0ea10e8035e8eb5b8e4449f06da1c730663baa81\"\n \n-ultron@~1.1.0:\n-  version \"1.1.1\"\n-  resolved \"https://registry.yarnpkg.com/ultron/-/ultron-1.1.1.tgz#9fe1536a10a664a65266a1e3ccf85fd36302bc9c\"\n-  integrity sha512-UIEXBNeYmKptWH6z8ZnqTeS8fV74zG0/eRU9VGkpzz+LIJNs8W/zM/L+7ctCkRrgbNnnR0xxw4bKOr0cW0N0Og==\n-\n-underscore@^1.9.1:\n-  version \"1.13.6\"\n-  resolved \"https://registry.yarnpkg.com/underscore/-/underscore-1.13.6.tgz#04786a1f589dc6c09f761fc5f45b89e935136441\"\n-  integrity sha512-+A5Sja4HP1M08MaXya7p5LvjuM7K6q/2EaC0+iovj/wOcMsTzMvDFbasi/oSapiwOlt252IqsKqPjCl7huKS0A==\n+unbzip2-stream@1.4.3:\n+  version \"1.4.3\"\n+  resolved \"https://registry.yarnpkg.com/unbzip2-stream/-/unbzip2-stream-1.4.3.tgz#b0da04c4371311df771cdc215e87f2130991ace7\"\n+  integrity sha512-mlExGW4w71ebDJviH16lQLtZS32VKqsSfk80GCfUlwT/4/hNRFsoscrF/c++9xinkMzECL1uL9DDwXqFWkruPg==\n+  dependencies:\n+    buffer \"^5.2.1\"\n+    through \"^2.3.8\"\n \n union@~0.4.3:\n   version \"0.4.6\"\n@@ -2028,62 +1602,19 @@ unique-string@^2.0.0:\n   dependencies:\n     crypto-random-string \"^2.0.0\"\n \n-update-notifier@^4.1.0:\n-  version \"4.1.3\"\n-  resolved \"https://registry.yarnpkg.com/update-notifier/-/update-notifier-4.1.3.tgz#be86ee13e8ce48fb50043ff72057b5bd598e1ea3\"\n-  integrity sha512-Yld6Z0RyCYGB6ckIjffGOSOmHXj1gMeE7aROz4MG+XMkmixBX4jUngrGXNYz7wPKBmtoD4MnBa2Anu7RSKht/A==\n-  dependencies:\n-    boxen \"^4.2.0\"\n-    chalk \"^3.0.0\"\n-    configstore \"^5.0.1\"\n-    has-yarn \"^2.1.0\"\n-    import-lazy \"^2.1.0\"\n-    is-ci \"^2.0.0\"\n-    is-installed-globally \"^0.3.1\"\n-    is-npm \"^4.0.0\"\n-    is-yarn-global \"^0.3.0\"\n-    latest-version \"^5.0.0\"\n-    pupa \"^2.0.1\"\n-    semver-diff \"^3.1.1\"\n-    xdg-basedir \"^4.0.0\"\n-\n-uri-js@^4.2.2:\n-  version \"4.4.1\"\n-  resolved \"https://registry.yarnpkg.com/uri-js/-/uri-js-4.4.1.tgz#9b1a52595225859e55f669d928f88c6c57f2a77e\"\n-  integrity sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg==\n-  dependencies:\n-    punycode \"^2.1.0\"\n-\n url-join@^2.0.2:\n   version \"2.0.5\"\n   resolved \"https://registry.yarnpkg.com/url-join/-/url-join-2.0.5.tgz#5af22f18c052a000a48d7b82c5e9c2e2feeda728\"\n   integrity sha1-WvIvGMBSoACkjXuCxenC4v7tpyg=\n \n-url-parse-lax@^3.0.0:\n-  version \"3.0.0\"\n-  resolved \"https://registry.yarnpkg.com/url-parse-lax/-/url-parse-lax-3.0.0.tgz#16b5cafc07dbe3676c1b1999177823d6503acb0c\"\n-  integrity sha512-NjFKA0DidqPa5ciFcSrXnAltTtzz84ogy+NebPvfEgAck0+TNg4UJ4IN+fB7zRZfbgUf0syOo9MDxFkDSMuFaQ==\n-  dependencies:\n-    prepend-http \"^2.0.0\"\n-\n-util-deprecate@~1.0.1:\n+util-deprecate@^1.0.1, util-deprecate@~1.0.1:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/util-deprecate/-/util-deprecate-1.0.2.tgz#450d4dc9fa70de732762fbd2d4a28981419a0ccf\"\n \n-uuid@3.3.2:\n-  version \"3.3.2\"\n-  resolved \"https://registry.yarnpkg.com/uuid/-/uuid-3.3.2.tgz#1b4af4955eb3077c501c23872fc6513811587131\"\n-  integrity sha512-yXJmeNaw3DnnKAOKJE51sL/ZaYfWJRl1pK9dr19YFCu0ObS231AB1/LbqTKRAQ5kw8A90rA6fr4riOUpTZvQZA==\n-\n uuid@^3.0.0:\n   version \"3.1.0\"\n   resolved \"https://registry.yarnpkg.com/uuid/-/uuid-3.1.0.tgz#3dd3d3e790abc24d7b0d3a034ffababe28ebbc04\"\n \n-uuid@^3.3.2:\n-  version \"3.4.0\"\n-  resolved \"https://registry.yarnpkg.com/uuid/-/uuid-3.4.0.tgz#b23e4358afa8a202fe7a100af1f5f883f02007ee\"\n-  integrity sha512-HjSDRw6gZE5JMggctHBcjVak08+KEVhSIiDzFnT9S9aegmp85S/bReBVTb4QTFaRNptJ9kuYaNhnbNEOkbKb/A==\n-\n verror@1.10.0:\n   version \"1.10.0\"\n   resolved \"https://registry.yarnpkg.com/verror/-/verror-1.10.0.tgz#3a105ca17053af55d6e270c1f8288682e18da400\"\n@@ -2092,6 +1623,19 @@ verror@1.10.0:\n     core-util-is \"1.0.2\"\n     extsprintf \"^1.2.0\"\n \n+webidl-conversions@^3.0.0:\n+  version \"3.0.1\"\n+  resolved \"https://registry.yarnpkg.com/webidl-conversions/-/webidl-conversions-3.0.1.tgz#24534275e2a7bc6be7bc86611cc16ae0a5654871\"\n+  integrity sha512-2JAn3z8AR6rjK8Sm8orRC0h/bcl/DqL7tRPdGZ4I1CjdF+EaMLmYxBHyXuKL849eucPFhvBoxMsflfOb8kxaeQ==\n+\n+whatwg-url@^5.0.0:\n+  version \"5.0.0\"\n+  resolved \"https://registry.yarnpkg.com/whatwg-url/-/whatwg-url-5.0.0.tgz#966454e8765462e37644d3626f6742ce8b70965d\"\n+  integrity sha512-saE57nupxk6v3HY35+jzBwYa0rKSy0XR8JSxZPwgLr7ys0IBzhGviA1/TUGJLmSVqs8pb9AnvICXEuOHLprYTw==\n+  dependencies:\n+    tr46 \"~0.0.3\"\n+    webidl-conversions \"^3.0.0\"\n+\n which@1:\n   version \"1.3.0\"\n   resolved \"https://registry.yarnpkg.com/which/-/which-1.3.0.tgz#ff04bdfc010ee547d780bec38e1ac1c2777d253a\"\n@@ -2104,27 +1648,18 @@ wide-align@^1.1.0:\n   dependencies:\n     string-width \"^1.0.2\"\n \n-widest-line@^3.1.0:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/widest-line/-/widest-line-3.1.0.tgz#8292333bbf66cb45ff0de1603b136b7ae1496eca\"\n-  integrity sha512-NsmoXalsWVDMGupxZ5R08ka9flZjjiLvHVAWYOKtiKM8ujtZWr9cRffak+uSE48+Ob8ObalXpwyeUiyDD6QFgg==\n-  dependencies:\n-    string-width \"^4.0.0\"\n-\n-window-size@^0.1.4:\n-  version \"0.1.4\"\n-  resolved \"https://registry.yarnpkg.com/window-size/-/window-size-0.1.4.tgz#f8e1aa1ee5a53ec5bf151ffa09742a6ad7697876\"\n-\n wordwrap@~0.0.2:\n   version \"0.0.3\"\n   resolved \"https://registry.yarnpkg.com/wordwrap/-/wordwrap-0.0.3.tgz#a3d5da6cd5c0bc0008d37234bbaf1bed63059107\"\n \n-wrap-ansi@^2.0.0:\n-  version \"2.1.0\"\n-  resolved \"https://registry.yarnpkg.com/wrap-ansi/-/wrap-ansi-2.1.0.tgz#d8fc3d284dd05794fe84973caecdd1cf824fdd85\"\n+wrap-ansi@^7.0.0:\n+  version \"7.0.0\"\n+  resolved \"https://registry.yarnpkg.com/wrap-ansi/-/wrap-ansi-7.0.0.tgz#67e145cff510a6a6984bdf1152911d69d2eb9e43\"\n+  integrity sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==\n   dependencies:\n-    string-width \"^1.0.1\"\n-    strip-ansi \"^3.0.1\"\n+    ansi-styles \"^4.0.0\"\n+    string-width \"^4.1.0\"\n+    strip-ansi \"^6.0.0\"\n \n wrappy@1:\n   version \"1.0.2\"\n@@ -2140,45 +1675,48 @@ write-file-atomic@^3.0.0:\n     signal-exit \"^3.0.2\"\n     typedarray-to-buffer \"^3.1.5\"\n \n-ws@3.3.2:\n-  version \"3.3.2\"\n-  resolved \"https://registry.yarnpkg.com/ws/-/ws-3.3.2.tgz#96c1d08b3fefda1d5c1e33700d3bfaa9be2d5608\"\n-  integrity sha512-t+WGpsNxhMR4v6EClXS8r8km5ZljKJzyGhJf7goJz9k5Ye3+b5Bvno5rjqPuIBn5mnn5GBb7o8IrIWHxX1qOLQ==\n-  dependencies:\n-    async-limiter \"~1.0.0\"\n-    safe-buffer \"~5.1.0\"\n-    ultron \"~1.1.0\"\n+ws@8.5.0:\n+  version \"8.5.0\"\n+  resolved \"https://registry.yarnpkg.com/ws/-/ws-8.5.0.tgz#bfb4be96600757fe5382de12c670dab984a1ed4f\"\n+  integrity sha512-BWX0SWVgLPzYwF8lTzEy1egjhS4S4OEAHfsO8o65WOVsrnSRGaSiUaa9e0ggGlkMTtBlmOpEXiie9RUcBO86qg==\n+\n+ws@^7.0.0:\n+  version \"7.5.9\"\n+  resolved \"https://registry.yarnpkg.com/ws/-/ws-7.5.9.tgz#54fa7db29f4c7cec68b1ddd3a89de099942bb591\"\n+  integrity sha512-F+P9Jil7UiSKSkppIiD94dN07AwvFixvLIj1Og1Rl9GGMuNipJnV9JzjD6XuqmAeiswGvUmNLjr5cFuXwNS77Q==\n \n xdg-basedir@^4.0.0:\n   version \"4.0.0\"\n   resolved \"https://registry.yarnpkg.com/xdg-basedir/-/xdg-basedir-4.0.0.tgz#4bc8d9984403696225ef83a1573cbbcb4e79db13\"\n   integrity sha512-PSNhEJDejZYV7h50BohL09Er9VaIefr2LMAf3OEmpCkjOi34eYyQYAXUTjEQtZJTKcF0E2UKTh+osDLsgNim9Q==\n \n-xmldom@0.1.19:\n-  version \"0.1.19\"\n-  resolved \"https://registry.yarnpkg.com/xmldom/-/xmldom-0.1.19.tgz#631fc07776efd84118bf25171b37ed4d075a0abc\"\n-  integrity sha512-pDyxjQSFQgNHkU+yjvoF+GXVGJU7e9EnOg/KcGMDihBIKjTsOeDYaECwC/O9bsUWKY+Sd9izfE43JXC46EOHKA==\n-\n-y18n@^3.2.0:\n-  version \"3.2.1\"\n-  resolved \"https://registry.yarnpkg.com/y18n/-/y18n-3.2.1.tgz#6d15fba884c08679c0d77e88e7759e811e07fa41\"\n-\n-yargs-parser@^18.1.3:\n-  version \"18.1.3\"\n-  resolved \"https://registry.yarnpkg.com/yargs-parser/-/yargs-parser-18.1.3.tgz#be68c4975c6b2abf469236b0c870362fab09a7b0\"\n-  integrity sha512-o50j0JeToy/4K6OZcaQmW6lyXXKhq7csREXcDwk2omFPJEwUNOVtJKvmDr9EI1fAJZUyZcRF7kxGBWmRXudrCQ==\n-  dependencies:\n-    camelcase \"^5.0.0\"\n-    decamelize \"^1.2.0\"\n-\n-yargs@3.32.0:\n-  version \"3.32.0\"\n-  resolved \"https://registry.yarnpkg.com/yargs/-/yargs-3.32.0.tgz#03088e9ebf9e756b69751611d2a5ef591482c995\"\n-  dependencies:\n-    camelcase \"^2.0.1\"\n-    cliui \"^3.0.3\"\n-    decamelize \"^1.1.1\"\n-    os-locale \"^1.4.0\"\n-    string-width \"^1.0.1\"\n-    window-size \"^0.1.4\"\n-    y18n \"^3.2.0\"\n+y18n@^5.0.5:\n+  version \"5.0.8\"\n+  resolved \"https://registry.yarnpkg.com/y18n/-/y18n-5.0.8.tgz#7f4934d0f7ca8c56f95314939ddcd2dd91ce1d55\"\n+  integrity sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA==\n+\n+yargs-parser@^21.0.0, yargs-parser@^21.1.1:\n+  version \"21.1.1\"\n+  resolved \"https://registry.yarnpkg.com/yargs-parser/-/yargs-parser-21.1.1.tgz#9096bceebf990d21bb31fa9516e0ede294a77d35\"\n+  integrity sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw==\n+\n+yargs@^17.3.1:\n+  version \"17.7.2\"\n+  resolved \"https://registry.yarnpkg.com/yargs/-/yargs-17.7.2.tgz#991df39aca675a192b816e1e0363f9d75d2aa269\"\n+  integrity sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w==\n+  dependencies:\n+    cliui \"^8.0.1\"\n+    escalade \"^3.1.1\"\n+    get-caller-file \"^2.0.5\"\n+    require-directory \"^2.1.1\"\n+    string-width \"^4.2.3\"\n+    y18n \"^5.0.5\"\n+    yargs-parser \"^21.1.1\"\n+\n+yauzl@^2.10.0:\n+  version \"2.10.0\"\n+  resolved \"https://registry.yarnpkg.com/yauzl/-/yauzl-2.10.0.tgz#c7eb17c93e112cb1086fa6d8e51fb0667b79a5f9\"\n+  integrity sha512-p4a9I6X6nu6IhoGmBqAcbJy1mlC4j27vEPZX9F4L4/vZT3Lyq1VkFHw/V/PUcB9Buo+DG3iHkT0x3Qya58zc3g==\n+  dependencies:\n+    buffer-crc32 \"~0.2.3\"\n+    fd-slicer \"~1.1.0\""
            },
            {
                "file": ".eslintrc.js",
                "git_diff": "@@ -427,6 +427,7 @@ module.exports = {\n       files: ['packages/react-native-renderer/**/*.js'],\n       globals: {\n         nativeFabricUIManager: 'readonly',\n+        RN$enableMicrotasksInReact: 'readonly',\n       },\n     },\n     {"
            },
            {
                "file": "fixtures/attribute-behavior/AttributeTableSnapshot.md",
                "git_diff": "@@ -5427,20 +5427,20 @@\n | Test Case | Flags | Result |\n | --- | --- | --- |\n | `inert=(string)`| (changed)| `<boolean: true>` |\n-| `inert=(empty string)`| (changed)| `<boolean: true>` |\n+| `inert=(empty string)`| (initial, warning)| `<boolean: false>` |\n | `inert=(array with string)`| (changed)| `<boolean: true>` |\n | `inert=(empty array)`| (changed)| `<boolean: true>` |\n | `inert=(object)`| (changed)| `<boolean: true>` |\n | `inert=(numeric string)`| (changed)| `<boolean: true>` |\n | `inert=(-1)`| (changed)| `<boolean: true>` |\n-| `inert=(0)`| (changed)| `<boolean: true>` |\n+| `inert=(0)`| (initial)| `<boolean: false>` |\n | `inert=(integer)`| (changed)| `<boolean: true>` |\n-| `inert=(NaN)`| (changed, warning)| `<boolean: true>` |\n+| `inert=(NaN)`| (initial, warning)| `<boolean: false>` |\n | `inert=(float)`| (changed)| `<boolean: true>` |\n-| `inert=(true)`| (initial, warning)| `<boolean: false>` |\n-| `inert=(false)`| (initial, warning)| `<boolean: false>` |\n-| `inert=(string 'true')`| (changed)| `<boolean: true>` |\n-| `inert=(string 'false')`| (changed)| `<boolean: true>` |\n+| `inert=(true)`| (changed)| `<boolean: true>` |\n+| `inert=(false)`| (initial)| `<boolean: false>` |\n+| `inert=(string 'true')`| (changed, warning)| `<boolean: true>` |\n+| `inert=(string 'false')`| (changed, warning)| `<boolean: true>` |\n | `inert=(string 'on')`| (changed)| `<boolean: true>` |\n | `inert=(string 'off')`| (changed)| `<boolean: true>` |\n | `inert=(symbol)`| (initial, warning)| `<boolean: false>` |"
            },
            {
                "file": "fixtures/dom/src/toWarnDev.js",
                "git_diff": "@@ -7,11 +7,6 @@ const util = require('util');\n function shouldIgnoreConsoleError(format, args) {\n   if (__DEV__) {\n     if (typeof format === 'string') {\n-      if (format.indexOf('Error: Uncaught [') === 0) {\n-        // This looks like an uncaught error from invokeGuardedCallback() wrapper\n-        // in development that is reported by jsdom. Ignore because it's noisy.\n-        return true;\n-      }\n       if (format.indexOf('The above error occurred') === 0) {\n         // This looks like an error addendum from ReactFiberErrorLogger.\n         // Ignore it too."
            },
            {
                "file": "packages/eslint-plugin-react-hooks/__tests__/ESLintRuleExhaustiveDeps-test.js",
                "git_diff": "@@ -7774,6 +7774,16 @@ const testsTypescript = {\n         }\n       `,\n     },\n+    {\n+      code: normalizeIndent`\n+        function useMyThing<T>(): void {\n+          useEffect(() => {\n+            let foo: T;\n+            console.log(foo);\n+          }, []);\n+        }\n+      `,\n+    },\n   ],\n   invalid: [\n     {"
            },
            {
                "file": "packages/react-cache/src/__tests__/ReactCacheOld-test.internal.js",
                "git_diff": "@@ -12,7 +12,6 @@\n let ReactCache;\n let createResource;\n let React;\n-let ReactFeatureFlags;\n let ReactNoop;\n let Scheduler;\n let Suspense;\n@@ -27,9 +26,6 @@ describe('ReactCache', () => {\n   beforeEach(() => {\n     jest.resetModules();\n \n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     React = require('react');\n     Suspense = React.Suspense;\n     ReactCache = require('react-cache');"
            },
            {
                "file": "packages/react-debug-tools/src/ReactDebugHooks.js",
                "git_diff": "@@ -444,14 +444,15 @@ function useTransition(): [\n \n function useDeferredValue<T>(value: T, initialValue?: T): T {\n   const hook = nextHook();\n+  const prevValue = hook !== null ? hook.memoizedState : value;\n   hookLog.push({\n     displayName: null,\n     primitive: 'DeferredValue',\n     stackError: new Error(),\n-    value: hook !== null ? hook.memoizedState : value,\n+    value: prevValue,\n     debugInfo: null,\n   });\n-  return value;\n+  return prevValue;\n }\n \n function useId(): string {\n@@ -521,8 +522,9 @@ function useFormState<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialState: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   const hook = nextHook(); // FormState\n+  nextHook(); // PendingState\n   nextHook(); // ActionQueue\n   const stackError = new Error();\n   let value;\n@@ -580,7 +582,9 @@ function useFormState<S, P>(\n   // value being a Thenable is equivalent to error being not null\n   // i.e. we only reach this point with Awaited<S>\n   const state = ((value: any): Awaited<S>);\n-  return [state, (payload: P) => {}];\n+\n+  // TODO: support displaying pending value\n+  return [state, (payload: P) => {}, false];\n }\n \n const Dispatcher: DispatcherType = {"
            },
            {
                "file": "packages/react-debug-tools/src/__tests__/ReactHooksInspectionIntegration-test.js",
                "git_diff": "@@ -1206,6 +1206,264 @@ describe('ReactHooksInspectionIntegration', () => {\n     `);\n   });\n \n+  it('should return the deferred value', async () => {\n+    let unsuspend;\n+    function Lazy() {\n+      return 'Lazy';\n+    }\n+    const Suspender = React.lazy(\n+      () =>\n+        new Promise(resolve => {\n+          unsuspend = () => resolve({default: Lazy});\n+        }),\n+    );\n+    const Context = React.createContext('default');\n+    let setShow;\n+    function Foo(props) {\n+      const [show, _setShow] = React.useState(false);\n+      const deferredShow = React.useDeferredValue(show);\n+      const isPending = show !== deferredShow;\n+      const contextDisplay = isPending ? React.use(Context) : '<none>';\n+      React.useMemo(() => 'hello', []);\n+      React.useMemo(() => 'not used', []);\n+\n+      // Otherwise we capture the version from the react-debug-tools dispatcher.\n+      if (setShow === undefined) {\n+        setShow = _setShow;\n+      }\n+\n+      return (\n+        <React.Suspense fallback=\"Loading\">\n+          Context: {contextDisplay}, {isPending ? 'Pending' : 'Nothing Pending'}\n+          {deferredShow ? [', ', <Suspender key=\"suspender\" />] : null}\n+        </React.Suspense>\n+      );\n+    }\n+    const renderer = await act(() => {\n+      return ReactTestRenderer.create(\n+        <Context.Provider value=\"provided\">\n+          <Foo />\n+        </Context.Provider>,\n+        {isConcurrent: true},\n+      );\n+    });\n+    let childFiber = renderer.root.findByType(Foo)._currentFiber();\n+    let tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n+    expect(renderer).toMatchRenderedOutput('Context: <none>, Nothing Pending');\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": false,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"DeferredValue\",\n+          \"subHooks\": [],\n+          \"value\": false,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"hello\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n+\n+    await act(() => {\n+      setShow(true);\n+    });\n+\n+    expect(renderer).toMatchRenderedOutput('Context: provided, Pending');\n+    childFiber = renderer.root.findByType(Foo)._currentFiber();\n+    tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": true,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"DeferredValue\",\n+          \"subHooks\": [],\n+          \"value\": false,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": null,\n+          \"isStateEditable\": false,\n+          \"name\": \"Context\",\n+          \"subHooks\": [],\n+          \"value\": \"provided\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"hello\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n+\n+    await act(() => {\n+      unsuspend();\n+    });\n+\n+    expect(renderer).toMatchRenderedOutput(\n+      'Context: <none>, Nothing Pending, Lazy',\n+    );\n+    childFiber = renderer.root.findByType(Foo)._currentFiber();\n+    tree = ReactDebugTools.inspectHooksOfFiber(childFiber);\n+    expect(normalizeSourceLoc(tree)).toMatchInlineSnapshot(`\n+      [\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 0,\n+          \"isStateEditable\": true,\n+          \"name\": \"State\",\n+          \"subHooks\": [],\n+          \"value\": true,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 1,\n+          \"isStateEditable\": false,\n+          \"name\": \"DeferredValue\",\n+          \"subHooks\": [],\n+          \"value\": true,\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 2,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"hello\",\n+        },\n+        {\n+          \"debugInfo\": null,\n+          \"hookSource\": {\n+            \"columnNumber\": 0,\n+            \"fileName\": \"**\",\n+            \"functionName\": \"Foo\",\n+            \"lineNumber\": 0,\n+          },\n+          \"id\": 3,\n+          \"isStateEditable\": false,\n+          \"name\": \"Memo\",\n+          \"subHooks\": [],\n+          \"value\": \"not used\",\n+        },\n+      ]\n+    `);\n+  });\n+\n   it('should support useId hook', () => {\n     function Foo(props) {\n       const id = React.useId();"
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/TimelineProfiler-test.js",
                "git_diff": "@@ -870,15 +870,13 @@ describe('Timeline profiler', () => {\n           \"--component-render-start-ErrorBoundary\",\n           \"--component-render-stop\",\n           \"--component-render-start-ExampleThatThrows\",\n-          \"--component-render-start-ExampleThatThrows\",\n           \"--component-render-stop\",\n           \"--error-ExampleThatThrows-mount-Expected error\",\n           \"--render-stop\",\n           \"--render-start-32\",\n           \"--component-render-start-ErrorBoundary\",\n           \"--component-render-stop\",\n           \"--component-render-start-ExampleThatThrows\",\n-          \"--component-render-start-ExampleThatThrows\",\n           \"--component-render-stop\",\n           \"--error-ExampleThatThrows-mount-Expected error\",\n           \"--render-stop\",\n@@ -2161,10 +2159,8 @@ describe('Timeline profiler', () => {\n           await waitForAll([\n             'ErrorBoundary render',\n             'ExampleThatThrows',\n-            'ExampleThatThrows',\n             'ErrorBoundary render',\n             'ExampleThatThrows',\n-            'ExampleThatThrows',\n             'ErrorBoundary fallback',\n           ]);\n "
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/editing-test.js",
                "git_diff": "@@ -934,6 +934,7 @@ describe('editing interface', () => {\n     }\n \n     // @reactVersion >= 16.9\n+    // @gate !disableLegacyContext\n     it('should have editable values', async () => {\n       await mountTestApp();\n \n@@ -983,6 +984,7 @@ describe('editing interface', () => {\n     });\n \n     // @reactVersion >= 16.9\n+    // @gate !disableLegacyContext\n     // Tests the combination of older frontend (DevTools UI) with newer backend (embedded within a renderer).\n     it('should still support overriding context values with legacy backend methods', async () => {\n       await mountTestApp();\n@@ -1014,6 +1016,7 @@ describe('editing interface', () => {\n     });\n \n     // @reactVersion >= 16.9\n+    // @gate !disableLegacyContext\n     it('should have editable paths', async () => {\n       await mountTestApp();\n \n@@ -1055,6 +1058,7 @@ describe('editing interface', () => {\n     });\n \n     // @reactVersion >= 16.9\n+    // @gate !disableLegacyContext\n     it('should enable adding new object properties and array values', async () => {\n       await mountTestApp();\n \n@@ -1109,6 +1113,7 @@ describe('editing interface', () => {\n     });\n \n     // @reactVersion >= 16.9\n+    // @gate !disableLegacyContext\n     it('should have deletable keys', async () => {\n       await mountTestApp();\n "
            },
            {
                "file": "packages/react-devtools-shared/src/__tests__/profilingCache-test.js",
                "git_diff": "@@ -411,6 +411,21 @@ describe('ProfilingCache', () => {\n         },\n       }\n     `);\n+\n+    if (gate(flags => !flags.disableLegacyContext)) {\n+      expect(changeDescriptions[1].get(6).context).toEqual(['count']);\n+      expect(changeDescriptions[1].get(7).props).toEqual(['count']);\n+      expect(changeDescriptions[2].get(6).context).toEqual([]);\n+      expect(changeDescriptions[3].get(6).context).toEqual([]);\n+      expect(changeDescriptions[4].get(6).context).toEqual([]);\n+\n+      changeDescriptions[1].get(6).context = null;\n+      changeDescriptions[1].get(7).props = [];\n+      changeDescriptions[2].get(6).context = null;\n+      changeDescriptions[3].get(6).context = null;\n+      changeDescriptions[4].get(6).context = null;\n+    }\n+\n     expect(changeDescriptions[1]).toMatchInlineSnapshot(`\n       Map {\n         5 => {\n@@ -436,15 +451,11 @@ describe('ProfilingCache', () => {\n           \"didHooksChange\": false,\n           \"hooks\": [],\n           \"isFirstMount\": false,\n-          \"props\": [\n-            \"count\",\n-          ],\n+          \"props\": [],\n           \"state\": null,\n         },\n         6 => {\n-          \"context\": [\n-            \"count\",\n-          ],\n+          \"context\": null,\n           \"didHooksChange\": false,\n           \"hooks\": null,\n           \"isFirstMount\": false,\n@@ -490,7 +501,7 @@ describe('ProfilingCache', () => {\n           \"state\": null,\n         },\n         6 => {\n-          \"context\": [],\n+          \"context\": null,\n           \"didHooksChange\": false,\n           \"hooks\": null,\n           \"isFirstMount\": false,\n@@ -536,7 +547,7 @@ describe('ProfilingCache', () => {\n           \"state\": null,\n         },\n         6 => {\n-          \"context\": [],\n+          \"context\": null,\n           \"didHooksChange\": false,\n           \"hooks\": null,\n           \"isFirstMount\": false,\n@@ -583,7 +594,7 @@ describe('ProfilingCache', () => {\n           \"state\": null,\n         },\n         6 => {\n-          \"context\": [],\n+          \"context\": null,\n           \"didHooksChange\": false,\n           \"hooks\": null,\n           \"isFirstMount\": false,"
            },
            {
                "file": "packages/react-dom-bindings/src/client/ReactDOMComponent.js",
                "git_diff": "@@ -73,6 +73,7 @@ import {\n   disableIEWorkarounds,\n   enableTrustedTypesIntegration,\n   enableFilterEmptyStringAttributesDOM,\n+  enableNewBooleanProps,\n } from 'shared/ReactFeatureFlags';\n import {\n   mediaEventTypes,\n@@ -86,8 +87,10 @@ let didWarnFormActionType = false;\n let didWarnFormActionName = false;\n let didWarnFormActionTarget = false;\n let didWarnFormActionMethod = false;\n+let didWarnForNewBooleanPropsWithEmptyValue: {[string]: boolean};\n let canDiffStyleForHydrationWarning;\n if (__DEV__) {\n+  didWarnForNewBooleanPropsWithEmptyValue = {};\n   // IE 11 parses & normalizes the style attribute as opposed to other\n   // browsers. It adds spaces and sorts the properties in some\n   // non-alphabetical order. Handling that would require sorting CSS\n@@ -712,6 +715,25 @@ function setProp(\n       break;\n     }\n     // Boolean\n+    case 'inert':\n+      if (!enableNewBooleanProps) {\n+        setValueForAttribute(domElement, key, value);\n+        break;\n+      } else {\n+        if (__DEV__) {\n+          if (value === '' && !didWarnForNewBooleanPropsWithEmptyValue[key]) {\n+            didWarnForNewBooleanPropsWithEmptyValue[key] = true;\n+            console.error(\n+              'Received an empty string for a boolean attribute `%s`. ' +\n+                'This will treat the attribute as if it were false. ' +\n+                'Either pass `false` to silence this warning, or ' +\n+                'pass `true` if you used an empty string in earlier versions of React to indicate this attribute is true.',\n+              key,\n+            );\n+          }\n+        }\n+      }\n+    // fallthrough for new boolean props without the flag on\n     case 'allowFullScreen':\n     case 'async':\n     case 'autoPlay':\n@@ -2663,6 +2685,33 @@ function diffHydratedGenericElement(\n           extraAttributes,\n         );\n         continue;\n+      case 'inert':\n+        if (enableNewBooleanProps) {\n+          if (__DEV__) {\n+            if (\n+              value === '' &&\n+              !didWarnForNewBooleanPropsWithEmptyValue[propKey]\n+            ) {\n+              didWarnForNewBooleanPropsWithEmptyValue[propKey] = true;\n+              console.error(\n+                'Received an empty string for a boolean attribute `%s`. ' +\n+                  'This will treat the attribute as if it were false. ' +\n+                  'Either pass `false` to silence this warning, or ' +\n+                  'pass `true` if you used an empty string in earlier versions of React to indicate this attribute is true.',\n+                propKey,\n+              );\n+            }\n+          }\n+          hydrateBooleanAttribute(\n+            domElement,\n+            propKey,\n+            propKey,\n+            value,\n+            extraAttributes,\n+          );\n+          continue;\n+        }\n+      // fallthrough for new boolean props without the flag on\n       default: {\n         if (\n           // shouldIgnoreAttribute"
            },
            {
                "file": "packages/react-dom-bindings/src/events/DOMPluginEventSystem.js",
                "git_diff": "@@ -55,10 +55,6 @@ import {\n   enableFloat,\n   enableFormActions,\n } from 'shared/ReactFeatureFlags';\n-import {\n-  invokeGuardedCallbackAndCatchFirstError,\n-  rethrowCaughtError,\n-} from 'shared/ReactErrorUtils';\n import {createEventListenerWrapperWithPriority} from './ReactDOMEventListener';\n import {\n   removeEventListener,\n@@ -234,14 +230,25 @@ export const nonDelegatedEvents: Set<DOMEventName> = new Set([\n   ...mediaEventTypes,\n ]);\n \n+let hasError: boolean = false;\n+let caughtError: mixed = null;\n+\n function executeDispatch(\n   event: ReactSyntheticEvent,\n   listener: Function,\n   currentTarget: EventTarget,\n ): void {\n-  const type = event.type || 'unknown-event';\n   event.currentTarget = currentTarget;\n-  invokeGuardedCallbackAndCatchFirstError(type, listener, undefined, event);\n+  try {\n+    listener(event);\n+  } catch (error) {\n+    if (!hasError) {\n+      hasError = true;\n+      caughtError = error;\n+    } else {\n+      // TODO: Make sure this error gets logged somehow.\n+    }\n+  }\n   event.currentTarget = null;\n }\n \n@@ -283,7 +290,12 @@ export function processDispatchQueue(\n     //  event system doesn't use pooling.\n   }\n   // This would be a good time to rethrow if any of the event handlers threw.\n-  rethrowCaughtError();\n+  if (hasError) {\n+    const error = caughtError;\n+    hasError = false;\n+    caughtError = null;\n+    throw error;\n+  }\n }\n \n function dispatchEventsForPlugins("
            },
            {
                "file": "packages/react-dom-bindings/src/server/ReactFizzConfigDOM.js",
                "git_diff": "@@ -34,6 +34,7 @@ import {\n   enableFloat,\n   enableFormActions,\n   enableFizzExternalRuntime,\n+  enableNewBooleanProps,\n } from 'shared/ReactFeatureFlags';\n \n import type {\n@@ -345,6 +346,11 @@ const importMapScriptEnd = stringToPrecomputedChunk('</script>');\n // allow one more header to be captured which means in practice if the limit is approached it will be exceeded\n const DEFAULT_HEADERS_CAPACITY_IN_UTF16_CODE_UNITS = 2000;\n \n+let didWarnForNewBooleanPropsWithEmptyValue: {[string]: boolean};\n+if (__DEV__) {\n+  didWarnForNewBooleanPropsWithEmptyValue = {};\n+}\n+\n // Allows us to keep track of what we've already written so we can refer back to it.\n // if passed externalRuntimeConfig and the enableFizzExternalRuntime feature flag\n // is set, the server will send instructions via data attributes (instead of inline scripts)\n@@ -1398,6 +1404,32 @@ function pushAttribute(\n     case 'xmlSpace':\n       pushStringAttribute(target, 'xml:space', value);\n       return;\n+    case 'inert': {\n+      if (enableNewBooleanProps) {\n+        if (__DEV__) {\n+          if (value === '' && !didWarnForNewBooleanPropsWithEmptyValue[name]) {\n+            didWarnForNewBooleanPropsWithEmptyValue[name] = true;\n+            console.error(\n+              'Received an empty string for a boolean attribute `%s`. ' +\n+                'This will treat the attribute as if it were false. ' +\n+                'Either pass `false` to silence this warning, or ' +\n+                'pass `true` if you used an empty string in earlier versions of React to indicate this attribute is true.',\n+              name,\n+            );\n+          }\n+        }\n+        // Boolean\n+        if (value && typeof value !== 'function' && typeof value !== 'symbol') {\n+          target.push(\n+            attributeSeparator,\n+            stringToChunk(name),\n+            attributeEmptyString,\n+          );\n+        }\n+        return;\n+      }\n+    }\n+    // fallthrough for new boolean props without the flag on\n     default:\n       if (\n         // shouldIgnoreAttribute"
            },
            {
                "file": "packages/react-dom-bindings/src/shared/ReactDOMFormActions.js",
                "git_diff": "@@ -80,7 +80,7 @@ export function useFormState<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialState: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   if (!(enableFormActions && enableAsyncActions)) {\n     throw new Error('Not implemented.');\n   } else {"
            },
            {
                "file": "packages/react-dom-bindings/src/shared/ReactDOMUnknownPropertyHook.js",
                "git_diff": "@@ -12,6 +12,7 @@ import hasOwnProperty from 'shared/hasOwnProperty';\n import {\n   enableCustomElementPropertySupport,\n   enableFormActions,\n+  enableNewBooleanProps,\n } from 'shared/ReactFeatureFlags';\n \n const warnedProperties = {};\n@@ -240,6 +241,14 @@ function validateProperty(tagName, name, value, eventRegistry) {\n             // Boolean properties can accept boolean values\n             return true;\n           }\n+          // fallthrough\n+          case 'inert': {\n+            if (enableNewBooleanProps) {\n+              // Boolean properties can accept boolean values\n+              return true;\n+            }\n+          }\n+          // fallthrough for new boolean props without the flag on\n           default: {\n             const prefix = name.toLowerCase().slice(0, 5);\n             if (prefix === 'data-' || prefix === 'aria-') {\n@@ -314,6 +323,12 @@ function validateProperty(tagName, name, value, eventRegistry) {\n             case 'itemScope': {\n               break;\n             }\n+            case 'inert': {\n+              if (enableNewBooleanProps) {\n+                break;\n+              }\n+            }\n+            // fallthrough for new boolean props without the flag on\n             default: {\n               return true;\n             }"
            },
            {
                "file": "packages/react-dom-bindings/src/shared/possibleStandardNames.js",
                "git_diff": "@@ -4,6 +4,7 @@\n  * This source code is licensed under the MIT license found in the\n  * LICENSE file in the root directory of this source tree.\n  */\n+import {enableNewBooleanProps} from 'shared/ReactFeatureFlags';\n \n // When adding attributes to the HTML or SVG allowed attribute list, be sure to\n // also add them to this module to ensure casing and incorrect name\n@@ -502,4 +503,8 @@ const possibleStandardNames = {\n   zoomandpan: 'zoomAndPan',\n };\n \n+if (enableNewBooleanProps) {\n+  possibleStandardNames.inert = 'inert';\n+}\n+\n export default possibleStandardNames;"
            },
            {
                "file": "packages/react-dom/index.experimental.js",
                "git_diff": "@@ -45,7 +45,7 @@ export function experimental_useFormState<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialState: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   if (__DEV__) {\n     console.error(\n       'useFormState is now in canary. Remove the experimental_ prefix. ' +"
            },
            {
                "file": "packages/react-dom/server-rendering-stub.js",
                "git_diff": "@@ -50,7 +50,7 @@ export function experimental_useFormState<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialState: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   if (__DEV__) {\n     console.error(\n       'useFormState is now in canary. Remove the experimental_ prefix. ' +"
            },
            {
                "file": "packages/react-dom/src/__tests__/InvalidEventListeners-test.js",
                "git_diff": "@@ -43,7 +43,7 @@ describe('InvalidEventListeners', () => {\n     );\n     const node = container.firstChild;\n \n-    spyOnProd(console, 'error');\n+    console.error = jest.fn();\n \n     const uncaughtErrors = [];\n     function handleWindowError(e) {\n@@ -70,18 +70,16 @@ describe('InvalidEventListeners', () => {\n       }),\n     );\n \n-    if (!__DEV__) {\n-      expect(console.error).toHaveBeenCalledTimes(1);\n-      expect(console.error.mock.calls[0][0]).toEqual(\n-        expect.objectContaining({\n-          detail: expect.objectContaining({\n-            message:\n-              'Expected `onClick` listener to be a function, instead got a value of `string` type.',\n-          }),\n-          type: 'unhandled exception',\n+    expect(console.error).toHaveBeenCalledTimes(1);\n+    expect(console.error.mock.calls[0][0]).toEqual(\n+      expect.objectContaining({\n+        detail: expect.objectContaining({\n+          message:\n+            'Expected `onClick` listener to be a function, instead got a value of `string` type.',\n         }),\n-      );\n-    }\n+        type: 'unhandled exception',\n+      }),\n+    );\n   });\n \n   it('should not prevent null listeners, at dispatch', async () => {"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactBrowserEventEmitter-test.js",
                "git_diff": "@@ -202,21 +202,13 @@ describe('ReactBrowserEventEmitter', () => {\n       expect(idCallOrder[0]).toBe(CHILD);\n       expect(idCallOrder[1]).toBe(PARENT);\n       expect(idCallOrder[2]).toBe(GRANDPARENT);\n-      expect(errorHandler).toHaveBeenCalledTimes(__DEV__ ? 2 : 1);\n+      expect(errorHandler).toHaveBeenCalledTimes(1);\n       expect(errorHandler.mock.calls[0][0]).toEqual(\n         expect.objectContaining({\n           error: expect.any(Error),\n           message: 'Handler interrupted',\n         }),\n       );\n-      if (__DEV__) {\n-        expect(errorHandler.mock.calls[1][0]).toEqual(\n-          expect.objectContaining({\n-            error: expect.any(Error),\n-            message: 'Handler interrupted',\n-          }),\n-        );\n-      }\n     } finally {\n       window.removeEventListener('error', errorHandler);\n     }"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactComponentLifeCycle-test.js",
                "git_diff": "@@ -1112,6 +1112,7 @@ describe('ReactComponentLifeCycle', () => {\n   });\n \n   if (!require('shared/ReactFeatureFlags').disableModulePatternComponents) {\n+    // @gate !disableLegacyContext\n     it('calls effects on module-pattern component', async () => {\n       const log = [];\n "
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactCompositeComponent-test.js",
                "git_diff": "@@ -1231,13 +1231,6 @@ describe('ReactCompositeComponent', () => {\n         });\n       }).toThrow();\n     }).toErrorDev([\n-      // Expect two errors because invokeGuardedCallback will dispatch an error event,\n-      // Causing the warning to be logged again.\n-      'Warning: No `render` method found on the RenderTextInvalidConstructor instance: ' +\n-        'did you accidentally return an object from the constructor?',\n-      'Warning: No `render` method found on the RenderTextInvalidConstructor instance: ' +\n-        'did you accidentally return an object from the constructor?',\n-      // And then two more because we retry errors.\n       'Warning: No `render` method found on the RenderTextInvalidConstructor instance: ' +\n         'did you accidentally return an object from the constructor?',\n       'Warning: No `render` method found on the RenderTextInvalidConstructor instance: ' +\n@@ -1278,14 +1271,6 @@ describe('ReactCompositeComponent', () => {\n         });\n       }).toThrow();\n     }).toErrorDev([\n-      // Expect two errors because invokeGuardedCallback will dispatch an error event,\n-      // Causing the warning to be logged again.\n-      'Warning: No `render` method found on the RenderTestUndefinedRender instance: ' +\n-        'you may have forgotten to define `render`.',\n-      'Warning: No `render` method found on the RenderTestUndefinedRender instance: ' +\n-        'you may have forgotten to define `render`.',\n-\n-      // And then two more because we retry errors.\n       'Warning: No `render` method found on the RenderTestUndefinedRender instance: ' +\n         'you may have forgotten to define `render`.',\n       'Warning: No `render` method found on the RenderTestUndefinedRender instance: ' +"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMAttribute-test.js",
                "git_diff": "@@ -12,12 +12,14 @@\n describe('ReactDOM unknown attribute', () => {\n   let React;\n   let ReactDOMClient;\n+  let ReactFeatureFlags;\n   let act;\n \n   beforeEach(() => {\n     jest.resetModules();\n     React = require('react');\n     ReactDOMClient = require('react-dom/client');\n+    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n     act = require('internal-test-utils').act;\n   });\n \n@@ -88,6 +90,54 @@ describe('ReactDOM unknown attribute', () => {\n       expect(el.firstChild.hasAttribute('unknown')).toBe(false);\n     });\n \n+    it('removes new boolean props', async () => {\n+      const el = document.createElement('div');\n+      const root = ReactDOMClient.createRoot(el);\n+\n+      await expect(async () => {\n+        await act(() => {\n+          root.render(<div inert={true} />);\n+        });\n+      }).toErrorDev(\n+        ReactFeatureFlags.enableNewBooleanProps\n+          ? []\n+          : ['Warning: Received `true` for a non-boolean attribute `inert`.'],\n+      );\n+\n+      expect(el.firstChild.getAttribute('inert')).toBe(\n+        ReactFeatureFlags.enableNewBooleanProps ? '' : null,\n+      );\n+    });\n+\n+    it('warns once for empty strings in new boolean props', async () => {\n+      const el = document.createElement('div');\n+      const root = ReactDOMClient.createRoot(el);\n+\n+      await expect(async () => {\n+        await act(() => {\n+          root.render(<div inert=\"\" />);\n+        });\n+      }).toErrorDev(\n+        ReactFeatureFlags.enableNewBooleanProps\n+          ? [\n+              'Warning: Received an empty string for a boolean attribute `inert`. ' +\n+                'This will treat the attribute as if it were false. ' +\n+                'Either pass `false` to silence this warning, or ' +\n+                'pass `true` if you used an empty string in earlier versions of React to indicate this attribute is true.',\n+            ]\n+          : [],\n+      );\n+\n+      expect(el.firstChild.getAttribute('inert')).toBe(\n+        ReactFeatureFlags.enableNewBooleanProps ? null : '',\n+      );\n+\n+      // The warning is only printed once.\n+      await act(() => {\n+        root.render(<div inert=\"\" />);\n+      });\n+    });\n+\n     it('passes through strings', async () => {\n       await testUnknownAttributeAssignment('a string', 'a string');\n     });"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMConsoleErrorReporting-test.js",
                "git_diff": "@@ -56,7 +56,8 @@ describe('ReactDOMConsoleErrorReporting', () => {\n \n   describe('ReactDOMClient.createRoot', () => {\n     it('logs errors during event handlers', async () => {\n-      spyOnDevAndProd(console, 'error');\n+      const originalError = console.error;\n+      console.error = jest.fn();\n \n       function Foo() {\n         return (\n@@ -82,76 +83,34 @@ describe('ReactDOMConsoleErrorReporting', () => {\n         );\n       });\n \n-      if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported because we're in a browser click event:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-          [\n-            // This one is jsdom-only. Real browser deduplicates it.\n-            // (In DEV, we have a nested event due to guarded callback.)\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n-        expect(console.error.mock.calls).toEqual([\n-          [\n-            // Reported because we're in a browser click event:\n-            expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n-            }),\n-          ],\n-          [\n-            // This one is jsdom-only. Real browser deduplicates it.\n-            // (In DEV, we have a nested event due to guarded callback.)\n-            expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n-            }),\n-          ],\n-        ]);\n-      } else {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported because we're in a browser click event:\n-            expect.objectContaining({\n+      expect(windowOnError.mock.calls).toEqual([\n+        [\n+          // Reported because we're in a browser click event:\n+          expect.objectContaining({\n+            message: 'Boom',\n+          }),\n+        ],\n+      ]);\n+      expect(console.error.mock.calls).toEqual([\n+        [\n+          // Reported because we're in a browser click event:\n+          expect.objectContaining({\n+            detail: expect.objectContaining({\n               message: 'Boom',\n             }),\n-          ],\n-        ]);\n-        expect(console.error.mock.calls).toEqual([\n-          [\n-            // Reported because we're in a browser click event:\n-            expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n-            }),\n-          ],\n-        ]);\n-      }\n+            type: 'unhandled exception',\n+          }),\n+        ],\n+      ]);\n \n       // Check next render doesn't throw.\n       windowOnError.mockReset();\n-      console.error.mockReset();\n+      console.error = originalError;\n       await act(() => {\n         root.render(<NoError />);\n       });\n       expect(container.textContent).toBe('OK');\n       expect(windowOnError.mock.calls).toEqual([]);\n-      if (__DEV__) {\n-        expect(console.error.mock.calls).toEqual([]);\n-      }\n     });\n \n     it('logs render errors without an error boundary', async () => {\n@@ -168,50 +127,24 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-          [\n-            // This is only duplicated with createRoot\n-            // because it retries once with a sync render.\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [\n-            // Reported due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n-            }),\n-          ],\n-          [\n-            // This is only duplicated with createRoot\n-            // because it retries once with a sync render.\n-            expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('Consider adding an error boundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -254,50 +187,24 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-          [\n-            // This is only duplicated with createRoot\n-            // because it retries once with a sync render.\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [\n-            // Reported by jsdom due to the guarded callback:\n-            expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n-            }),\n-          ],\n-          [\n-            // This is only duplicated with createRoot\n-            // because it retries once with a sync render.\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('ErrorBoundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -340,33 +247,24 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [\n-            // Reported due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('Consider adding an error boundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -412,33 +310,24 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [\n-            // Reported by jsdom due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('ErrorBoundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -481,33 +370,24 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [\n-            // Reported due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('Consider adding an error boundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -553,33 +433,24 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [\n-            // Reported by jsdom due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('ErrorBoundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual(["
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMConsoleErrorReportingLegacy-test.js",
                "git_diff": "@@ -57,7 +57,8 @@ describe('ReactDOMConsoleErrorReporting', () => {\n   describe('ReactDOM.render', () => {\n     // @gate !disableLegacyMode\n     it('logs errors during event handlers', async () => {\n-      spyOnDevAndProd(console, 'error');\n+      const originalError = console.error;\n+      console.error = jest.fn();\n \n       function Foo() {\n         return (\n@@ -90,13 +91,6 @@ describe('ReactDOMConsoleErrorReporting', () => {\n               message: 'Boom',\n             }),\n           ],\n-          [\n-            // This one is jsdom-only. Real browser deduplicates it.\n-            // (In DEV, we have a nested event due to guarded callback.)\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n         ]);\n         expect(console.error.mock.calls).toEqual([\n           [expect.stringContaining('ReactDOM.render is no longer supported')],\n@@ -109,16 +103,6 @@ describe('ReactDOMConsoleErrorReporting', () => {\n               type: 'unhandled exception',\n             }),\n           ],\n-          [\n-            // This one is jsdom-only. Real browser deduplicates it.\n-            // (In DEV, we have a nested event due to guarded callback.)\n-            expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n-            }),\n-          ],\n         ]);\n       } else {\n         expect(windowOnError.mock.calls).toEqual([\n@@ -155,6 +139,8 @@ describe('ReactDOMConsoleErrorReporting', () => {\n           [expect.stringContaining('ReactDOM.render is no longer supported')],\n         ]);\n       }\n+\n+      console.error = originalError;\n     });\n \n     // @gate !disableLegacyMode\n@@ -170,34 +156,24 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       }).toThrow('Boom');\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n         expect(console.error.mock.calls).toEqual([\n           [expect.stringContaining('ReactDOM.render is no longer supported')],\n           [\n-            // Reported due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('Consider adding an error boundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -243,34 +219,25 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [expect.stringContaining('ReactDOM.render is no longer supported')],\n           [\n-            // Reported by jsdom due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('ErrorBoundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -314,34 +281,25 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       }).toThrow('Boom');\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [expect.stringContaining('ReactDOM.render is no longer supported')],\n           [\n-            // Reported due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('Consider adding an error boundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -390,34 +348,25 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [expect.stringContaining('ReactDOM.render is no longer supported')],\n           [\n-            // Reported by jsdom due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('ErrorBoundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -462,34 +411,25 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            // Reported due to guarded callback:\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [expect.stringContaining('ReactDOM.render is no longer supported')],\n           [\n-            // Reported due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('Consider adding an error boundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n@@ -538,34 +478,25 @@ describe('ReactDOMConsoleErrorReporting', () => {\n       });\n \n       if (__DEV__) {\n-        // Reported due to guarded callback:\n-        expect(windowOnError.mock.calls).toEqual([\n-          [\n-            expect.objectContaining({\n-              message: 'Boom',\n-            }),\n-          ],\n-        ]);\n+        expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual([\n           [expect.stringContaining('ReactDOM.render is no longer supported')],\n           [\n-            // Reported by jsdom due to the guarded callback:\n+            // Formatting\n+            expect.stringContaining('%o'),\n             expect.objectContaining({\n-              detail: expect.objectContaining({\n-                message: 'Boom',\n-              }),\n-              type: 'unhandled exception',\n+              message: 'Boom',\n             }),\n-          ],\n-          [\n             // Addendum by React:\n             expect.stringContaining(\n               'The above error occurred in the <Foo> component',\n             ),\n+            expect.stringContaining('Foo'),\n+            expect.stringContaining('ErrorBoundary'),\n           ],\n         ]);\n       } else {\n-        // The top-level error was caught with try/catch, and there's no guarded callback,\n+        // The top-level error was caught with try/catch,\n         // so in production we don't see an error event.\n         expect(windowOnError.mock.calls).toEqual([]);\n         expect(console.error.mock.calls).toEqual(["
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMFizzServer-test.js",
                "git_diff": "@@ -3234,7 +3234,7 @@ describe('ReactDOMFizzServer', () => {\n   it('logs regular (non-hydration) errors when the UI recovers', async () => {\n     let shouldThrow = true;\n \n-    function A() {\n+    function A({unused}) {\n       if (shouldThrow) {\n         Scheduler.log('Oops!');\n         throw new Error('Oops!');\n@@ -3267,7 +3267,7 @@ describe('ReactDOMFizzServer', () => {\n     });\n \n     // Partially render A, but yield before the render has finished\n-    await waitFor(['Oops!', 'Oops!']);\n+    await waitFor(['Oops!']);\n \n     // React will try rendering again synchronously. During the retry, A will\n     // not throw. This simulates a concurrent data race that is fixed by\n@@ -4643,8 +4643,7 @@ describe('ReactDOMFizzServer', () => {\n     await waitForAll([]);\n   });\n \n-  // @gate __DEV__\n-  it('does not invokeGuardedCallback for errors after the first hydration error', async () => {\n+  it('does not log for errors after the first hydration error', async () => {\n     // We can't use the toErrorDev helper here because this is async.\n     const originalConsoleError = console.error;\n     const mockError = jest.fn();\n@@ -4717,21 +4716,13 @@ describe('ReactDOMFizzServer', () => {\n       });\n       await waitForAll([\n         'throwing: first error',\n-        // this repeated first error is the invokeGuardedCallback throw\n-        'throwing: first error',\n \n         // onRecoverableError because the UI recovered without surfacing the\n         // error to the user.\n         'Logged recoverable error: first error',\n         'Logged recoverable error: There was an error while hydrating this Suspense boundary. Switched to client rendering.',\n       ]);\n-      // These Uncaught error calls are the error reported by the runtime (jsdom here, browser in actual use)\n-      // when invokeGuardedCallback is used to replay an error in dev using event dispatching in the document\n-      expect(mockError.mock.calls).toEqual([\n-        // we only get one because we suppress invokeGuardedCallback after the first one when hydrating in a\n-        // suspense boundary\n-        ['Error: Uncaught [Error: first error]'],\n-      ]);\n+      expect(mockError.mock.calls).toEqual([]);\n       mockError.mockClear();\n \n       expect(getVisibleChildren(container)).toEqual(\n@@ -4749,8 +4740,7 @@ describe('ReactDOMFizzServer', () => {\n     }\n   });\n \n-  // @gate __DEV__\n-  it('does not invokeGuardedCallback for errors after a preceding fiber suspends', async () => {\n+  it('does not log for errors after a preceding fiber suspends', async () => {\n     // We can't use the toErrorDev helper here because this is async.\n     const originalConsoleError = console.error;\n     const mockError = jest.fn();\n@@ -4853,7 +4843,6 @@ describe('ReactDOMFizzServer', () => {\n       );\n       await unsuspend();\n       await waitForAll([\n-        'throwing: first error',\n         'throwing: first error',\n         'Logged recoverable error: first error',\n         'Logged recoverable error: There was an error while hydrating this Suspense boundary. Switched to client rendering.',\n@@ -4870,7 +4859,6 @@ describe('ReactDOMFizzServer', () => {\n     }\n   });\n \n-  // @gate __DEV__\n   it('(outdated behavior) suspending after erroring will cause errors previously queued to be silenced until the boundary resolves', async () => {\n     // NOTE: This test was originally written to test a scenario that doesn't happen\n     // anymore. If something errors during hydration, we immediately unwind the\n@@ -4968,20 +4956,12 @@ describe('ReactDOMFizzServer', () => {\n         },\n       });\n       await waitForAll([\n-        'throwing: first error',\n-        // duplicate because first error is re-done in invokeGuardedCallback\n         'throwing: first error',\n         'suspending',\n         'Logged recoverable error: first error',\n         'Logged recoverable error: There was an error while hydrating this Suspense boundary. Switched to client rendering.',\n       ]);\n-      // These Uncaught error calls are the error reported by the runtime (jsdom here, browser in actual use)\n-      // when invokeGuardedCallback is used to replay an error in dev using event dispatching in the document\n-      expect(mockError.mock.calls).toEqual([\n-        // we only get one because we suppress invokeGuardedCallback after the first one when hydrating in a\n-        // suspense boundary\n-        ['Error: Uncaught [Error: first error]'],\n-      ]);\n+      expect(mockError.mock.calls).toEqual([]);\n       mockError.mockClear();\n \n       expect(getVisibleChildren(container)).toEqual("
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMForm-test.js",
                "git_diff": "@@ -63,21 +63,6 @@ describe('ReactDOMForm', () => {\n     textCache = new Map();\n   });\n \n-  function resolveText(text) {\n-    const record = textCache.get(text);\n-    if (record === undefined) {\n-      const newRecord = {\n-        status: 'resolved',\n-        value: text,\n-      };\n-      textCache.set(text, newRecord);\n-    } else if (record.status === 'pending') {\n-      const thenable = record.value;\n-      record.status = 'resolved';\n-      record.value = text;\n-      thenable.pings.forEach(t => t());\n-    }\n-  }\n   function resolveText(text) {\n     const record = textCache.get(text);\n     if (record === undefined) {\n@@ -997,19 +982,20 @@ describe('ReactDOMForm', () => {\n \n     let dispatch;\n     function App() {\n-      const [state, _dispatch] = useFormState(action, 0);\n+      const [state, _dispatch, isPending] = useFormState(action, 0);\n       dispatch = _dispatch;\n-      return <Text text={state} />;\n+      const pending = isPending ? 'Pending ' : '';\n+      return <Text text={pending + state} />;\n     }\n \n     const root = ReactDOMClient.createRoot(container);\n     await act(() => root.render(<App />));\n-    assertLog([0]);\n+    assertLog(['0']);\n     expect(container.textContent).toBe('0');\n \n     await act(() => dispatch('increment'));\n-    assertLog(['Async action started [1]']);\n-    expect(container.textContent).toBe('0');\n+    assertLog(['Async action started [1]', 'Pending 0']);\n+    expect(container.textContent).toBe('Pending 0');\n \n     // Dispatch a few more actions. None of these will start until the previous\n     // one finishes.\n@@ -1031,7 +1017,7 @@ describe('ReactDOMForm', () => {\n     await act(() => resolveText('Wait [4]'));\n \n     // Finally the last action finishes and we can render the result.\n-    assertLog([2]);\n+    assertLog(['2']);\n     expect(container.textContent).toBe('2');\n   });\n \n@@ -1040,40 +1026,42 @@ describe('ReactDOMForm', () => {\n   test('useFormState supports inline actions', async () => {\n     let increment;\n     function App({stepSize}) {\n-      const [state, dispatch] = useFormState(async prevState => {\n+      const [state, dispatch, isPending] = useFormState(async prevState => {\n         return prevState + stepSize;\n       }, 0);\n       increment = dispatch;\n-      return <Text text={state} />;\n+      const pending = isPending ? 'Pending ' : '';\n+      return <Text text={pending + state} />;\n     }\n \n     // Initial render\n     const root = ReactDOMClient.createRoot(container);\n     await act(() => root.render(<App stepSize={1} />));\n-    assertLog([0]);\n+    assertLog(['0']);\n \n     // Perform an action. This will increase the state by 1, as defined by the\n     // stepSize prop.\n     await act(() => increment());\n-    assertLog([1]);\n+    assertLog(['Pending 0', '1']);\n \n     // Now increase the stepSize prop to 10. Subsequent steps will increase\n     // by this amount.\n     await act(() => root.render(<App stepSize={10} />));\n-    assertLog([1]);\n+    assertLog(['1']);\n \n     // Increment again. The state should increase by 10.\n     await act(() => increment());\n-    assertLog([11]);\n+    assertLog(['Pending 1', '11']);\n   });\n \n   // @gate enableFormActions\n   // @gate enableAsyncActions\n   test('useFormState: dispatch throws if called during render', async () => {\n     function App() {\n-      const [state, dispatch] = useFormState(async () => {}, 0);\n+      const [state, dispatch, isPending] = useFormState(async () => {}, 0);\n       dispatch();\n-      return <Text text={state} />;\n+      const pending = isPending ? 'Pending ' : '';\n+      return <Text text={pending + state} />;\n     }\n \n     const root = ReactDOMClient.createRoot(container);\n@@ -1088,21 +1076,25 @@ describe('ReactDOMForm', () => {\n   test('queues multiple actions and runs them in order', async () => {\n     let action;\n     function App() {\n-      const [state, dispatch] = useFormState(\n+      const [state, dispatch, isPending] = useFormState(\n         async (s, a) => await getText(a),\n         'A',\n       );\n       action = dispatch;\n-      return <Text text={state} />;\n+      const pending = isPending ? 'Pending ' : '';\n+      return <Text text={pending + state} />;\n     }\n \n     const root = ReactDOMClient.createRoot(container);\n     await act(() => root.render(<App />));\n     assertLog(['A']);\n \n     await act(() => action('B'));\n+    // The first dispatch will update the pending state.\n+    assertLog(['Pending A']);\n     await act(() => action('C'));\n     await act(() => action('D'));\n+    assertLog([]);\n \n     await act(() => resolveText('B'));\n     await act(() => resolveText('C'));\n@@ -1117,51 +1109,56 @@ describe('ReactDOMForm', () => {\n   test('useFormState: works if action is sync', async () => {\n     let increment;\n     function App({stepSize}) {\n-      const [state, dispatch] = useFormState(prevState => {\n+      const [state, dispatch, isPending] = useFormState(prevState => {\n         return prevState + stepSize;\n       }, 0);\n       increment = dispatch;\n-      return <Text text={state} />;\n+      const pending = isPending ? 'Pending ' : '';\n+      return <Text text={pending + state} />;\n     }\n \n     // Initial render\n     const root = ReactDOMClient.createRoot(container);\n     await act(() => root.render(<App stepSize={1} />));\n-    assertLog([0]);\n+    assertLog(['0']);\n \n     // Perform an action. This will increase the state by 1, as defined by the\n     // stepSize prop.\n     await act(() => increment());\n-    assertLog([1]);\n+    assertLog(['Pending 0', '1']);\n \n     // Now increase the stepSize prop to 10. Subsequent steps will increase\n     // by this amount.\n     await act(() => root.render(<App stepSize={10} />));\n-    assertLog([1]);\n+    assertLog(['1']);\n \n     // Increment again. The state should increase by 10.\n     await act(() => increment());\n-    assertLog([11]);\n+    assertLog(['Pending 1', '11']);\n   });\n \n   // @gate enableFormActions\n   // @gate enableAsyncActions\n   test('useFormState: can mix sync and async actions', async () => {\n     let action;\n     function App() {\n-      const [state, dispatch] = useFormState((s, a) => a, 'A');\n+      const [state, dispatch, isPending] = useFormState((s, a) => a, 'A');\n       action = dispatch;\n-      return <Text text={state} />;\n+      const pending = isPending ? 'Pending ' : '';\n+      return <Text text={pending + state} />;\n     }\n \n     const root = ReactDOMClient.createRoot(container);\n     await act(() => root.render(<App />));\n     assertLog(['A']);\n \n     await act(() => action(getText('B')));\n+    // The first dispatch will update the pending state.\n+    assertLog(['Pending A']);\n     await act(() => action('C'));\n     await act(() => action(getText('D')));\n     await act(() => action('E'));\n+    assertLog([]);\n \n     await act(() => resolveText('B'));\n     await act(() => resolveText('D'));\n@@ -1189,14 +1186,15 @@ describe('ReactDOMForm', () => {\n \n     let action;\n     function App() {\n-      const [state, dispatch] = useFormState((s, a) => {\n+      const [state, dispatch, isPending] = useFormState((s, a) => {\n         if (a.endsWith('!')) {\n           throw new Error(a);\n         }\n         return a;\n       }, 'A');\n       action = dispatch;\n-      return <Text text={state} />;\n+      const pending = isPending ? 'Pending ' : '';\n+      return <Text text={pending + state} />;\n     }\n \n     const root = ReactDOMClient.createRoot(container);\n@@ -1210,7 +1208,13 @@ describe('ReactDOMForm', () => {\n     assertLog(['A']);\n \n     await act(() => action('Oops!'));\n-    assertLog(['Caught an error: Oops!', 'Caught an error: Oops!']);\n+    assertLog([\n+      // Action begins, error has not thrown yet.\n+      'Pending A',\n+      // Now the action runs and throws.\n+      'Caught an error: Oops!',\n+      'Caught an error: Oops!',\n+    ]);\n     expect(container.textContent).toBe('Caught an error: Oops!');\n \n     // Reset the error boundary\n@@ -1223,7 +1227,7 @@ describe('ReactDOMForm', () => {\n       action('Oops!');\n       action('B');\n     });\n-    assertLog(['B']);\n+    assertLog(['Pending A', 'B']);\n     expect(container.textContent).toBe('B');\n   });\n \n@@ -1247,15 +1251,16 @@ describe('ReactDOMForm', () => {\n \n     let action;\n     function App() {\n-      const [state, dispatch] = useFormState(async (s, a) => {\n+      const [state, dispatch, isPending] = useFormState(async (s, a) => {\n         const text = await getText(a);\n         if (text.endsWith('!')) {\n           throw new Error(text);\n         }\n         return text;\n       }, 'A');\n       action = dispatch;\n-      return <Text text={state} />;\n+      const pending = isPending ? 'Pending ' : '';\n+      return <Text text={pending + state} />;\n     }\n \n     const root = ReactDOMClient.createRoot(container);\n@@ -1269,7 +1274,8 @@ describe('ReactDOMForm', () => {\n     assertLog(['A']);\n \n     await act(() => action('Oops!'));\n-    assertLog([]);\n+    // The first dispatch will update the pending state.\n+    assertLog(['Pending A']);\n     await act(() => resolveText('Oops!'));\n     assertLog(['Caught an error: Oops!', 'Caught an error: Oops!']);\n     expect(container.textContent).toBe('Caught an error: Oops!');\n@@ -1284,7 +1290,7 @@ describe('ReactDOMForm', () => {\n       action('Oops!');\n       action('B');\n     });\n-    assertLog([]);\n+    assertLog(['Pending A']);\n     await act(() => resolveText('B'));\n     assertLog(['B']);\n     expect(container.textContent).toBe('B');"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMHydrationDiff-test.js",
                "git_diff": "@@ -51,15 +51,6 @@ describe('ReactDOMServerHydration', () => {\n     if (format instanceof Error) {\n       return 'Caught [' + format.message + ']';\n     }\n-    if (\n-      format !== null &&\n-      typeof format === 'object' &&\n-      String(format).indexOf('Error: Uncaught [') === 0\n-    ) {\n-      // Ignore errors captured by jsdom and their stacks.\n-      // We only want console errors in this suite.\n-      return null;\n-    }\n     rest[rest.length - 1] = normalizeCodeLocInfo(rest[rest.length - 1]);\n     return util.format(format, ...rest);\n   }"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationAttributes-test.js",
                "git_diff": "@@ -754,6 +754,41 @@ describe('ReactDOMServerIntegration', () => {\n       }\n     });\n \n+    itRenders('new boolean `true` attributes', async render => {\n+      const element = await render(\n+        <div inert={true} />,\n+        ReactFeatureFlags.enableNewBooleanProps ? 0 : 1,\n+      );\n+\n+      expect(element.getAttribute('inert')).toBe(\n+        ReactFeatureFlags.enableNewBooleanProps ? '' : null,\n+      );\n+    });\n+\n+    itRenders('new boolean `\"\"` attributes', async render => {\n+      const element = await render(\n+        <div inert=\"\" />,\n+        ReactFeatureFlags.enableNewBooleanProps\n+          ? // Warns since this used to render `inert=\"\"` like `inert={true}`\n+            // but now renders it like `inert={false}`.\n+            1\n+          : 0,\n+      );\n+\n+      expect(element.getAttribute('inert')).toBe(\n+        ReactFeatureFlags.enableNewBooleanProps ? null : '',\n+      );\n+    });\n+\n+    itRenders('new boolean `false` attributes', async render => {\n+      const element = await render(\n+        <div inert={false} />,\n+        ReactFeatureFlags.enableNewBooleanProps ? 0 : 1,\n+      );\n+\n+      expect(element.getAttribute('inert')).toBe(null);\n+    });\n+\n     itRenders(\n       'no unknown attributes for custom elements with null value',\n       async render => {"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationLegacyContext-test.js",
                "git_diff": "@@ -278,7 +278,7 @@ describe('ReactDOMServerIntegration', () => {\n         }\n         const e = await render(\n           <ForgetfulParent />,\n-          render === clientRenderOnBadMarkup ? 4 : 1,\n+          render === clientRenderOnBadMarkup ? 2 : 1,\n         );\n         expect(e.textContent).toBe('nope');\n       },"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationLegacyContextDisabled-test.internal.js",
                "git_diff": "@@ -105,7 +105,7 @@ describe('ReactDOMServerIntegrationLegacyContextDisabled', () => {\n           <RegularFn />\n         </span>\n       </LegacyProvider>,\n-      render === clientRenderOnBadMarkup ? 6 : 3,\n+      render === clientRenderOnBadMarkup ? 5 : 3,\n     );\n     expect(e.textContent).toBe('{}undefinedundefined');\n     expect(lifecycleContextLog).toEqual([]);"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerIntegrationSelect-test.js",
                "git_diff": "@@ -254,7 +254,7 @@ describe('ReactDOMServerIntegrationSelect', () => {\n           <option value=\"first\">First</option>\n           <option value=\"true\">True</option>\n         </select>,\n-        2,\n+        1,\n       );\n       expect(e.firstChild.selected).toBe(false);\n       expect(e.lastChild.selected).toBe(true);\n@@ -269,7 +269,7 @@ describe('ReactDOMServerIntegrationSelect', () => {\n           <option value=\"first\">First</option>\n           <option value=\"undefined\">Undefined</option>\n         </select>,\n-        2,\n+        1,\n       );\n       expect(e.firstChild.selected).toBe(true);\n       expect(e.lastChild.selected).toBe(false);"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactDOMServerPartialHydration-test.internal.js",
                "git_diff": "@@ -349,9 +349,8 @@ describe('ReactDOMServerPartialHydration', () => {\n       );\n \n       if (__DEV__) {\n-        const secondToLastCall =\n-          mockError.mock.calls[mockError.mock.calls.length - 2];\n-        expect(secondToLastCall).toEqual([\n+        const lastCall = mockError.mock.calls[mockError.mock.calls.length - 1];\n+        expect(lastCall).toEqual([\n           'Warning: Expected server HTML to contain a matching <%s> in <%s>.%s',\n           'article',\n           'section',"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactErrorBoundaries-test.internal.js",
                "git_diff": "@@ -14,7 +14,6 @@ let React;\n let ReactDOM;\n let ReactDOMClient;\n let act;\n-let ReactFeatureFlags;\n let Scheduler;\n \n describe('ReactErrorBoundaries', () => {\n@@ -42,8 +41,6 @@ describe('ReactErrorBoundaries', () => {\n     jest.useFakeTimers();\n     jest.resetModules();\n     PropTypes = require('prop-types');\n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     ReactDOM = require('react-dom');\n     ReactDOMClient = require('react-dom/client');\n     React = require('react');\n@@ -710,7 +707,7 @@ describe('ReactErrorBoundaries', () => {\n     });\n     if (__DEV__) {\n       expect(console.error).toHaveBeenCalledTimes(1);\n-      expect(console.error.mock.calls[0][0]).toContain(\n+      expect(console.error.mock.calls[0][2]).toContain(\n         'The above error occurred in the <BrokenRender> component:',\n       );\n     }\n@@ -883,7 +880,6 @@ describe('ReactErrorBoundaries', () => {\n   });\n \n   // @gate !disableModulePatternComponents\n-  // @gate !disableLegacyContext\n   it('renders an error state if module-style context provider throws in componentWillMount', async () => {\n     function BrokenComponentWillMountWithContext() {\n       return {\n@@ -904,23 +900,31 @@ describe('ReactErrorBoundaries', () => {\n \n     const container = document.createElement('div');\n     const root = ReactDOMClient.createRoot(container);\n-    await expect(\n-      async () =>\n-        await act(async () => {\n-          root.render(\n-            <ErrorBoundary>\n-              <BrokenComponentWillMountWithContext />\n-            </ErrorBoundary>,\n-          );\n-        }),\n-    ).toErrorDev(\n+\n+    await expect(async () => {\n+      await act(() => {\n+        root.render(\n+          <ErrorBoundary>\n+            <BrokenComponentWillMountWithContext />\n+          </ErrorBoundary>,\n+        );\n+      });\n+    }).toErrorDev([\n       'Warning: The <BrokenComponentWillMountWithContext /> component appears to be a function component that ' +\n         'returns a class instance. ' +\n         'Change BrokenComponentWillMountWithContext to a class that extends React.Component instead. ' +\n         \"If you can't use a class try assigning the prototype on the function as a workaround. \" +\n         '`BrokenComponentWillMountWithContext.prototype = React.Component.prototype`. ' +\n         \"Don't use an arrow function since it cannot be called with `new` by React.\",\n-    );\n+      ...gate(flags =>\n+        flags.disableLegacyContext\n+          ? [\n+              'Warning: BrokenComponentWillMountWithContext uses the legacy childContextTypes API which is no longer supported. Use React.createContext() instead.',\n+              'Warning: BrokenComponentWillMountWithContext uses the legacy childContextTypes API which is no longer supported. Use React.createContext() instead.',\n+            ]\n+          : [],\n+      ),\n+    ]);\n \n     expect(container.firstChild.textContent).toBe('Caught an error: Hello.');\n   });"
            },
            {
                "file": "packages/react-dom/src/__tests__/ReactLegacyErrorBoundaries-test.internal.js",
                "git_diff": "@@ -12,7 +12,6 @@\n let PropTypes;\n let React;\n let ReactDOM;\n-let ReactFeatureFlags;\n \n // TODO: Refactor this test once componentDidCatch setState is deprecated.\n describe('ReactLegacyErrorBoundaries', () => {\n@@ -39,8 +38,6 @@ describe('ReactLegacyErrorBoundaries', () => {\n   beforeEach(() => {\n     jest.resetModules();\n     PropTypes = require('prop-types');\n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     ReactDOM = require('react-dom');\n     React = require('react');\n \n@@ -689,7 +686,7 @@ describe('ReactLegacyErrorBoundaries', () => {\n       expect(console.error.mock.calls[0][0]).toContain(\n         'ReactDOM.render is no longer supported',\n       );\n-      expect(console.error.mock.calls[1][0]).toContain(\n+      expect(console.error.mock.calls[1][2]).toContain(\n         'The above error occurred in the <BrokenRender> component:',\n       );\n     }\n@@ -862,14 +859,22 @@ describe('ReactLegacyErrorBoundaries', () => {\n           </ErrorBoundary>,\n           container,\n         ),\n-      ).toErrorDev(\n+      ).toErrorDev([\n         'Warning: The <BrokenComponentWillMountWithContext /> component appears to be a function component that ' +\n           'returns a class instance. ' +\n           'Change BrokenComponentWillMountWithContext to a class that extends React.Component instead. ' +\n           \"If you can't use a class try assigning the prototype on the function as a workaround. \" +\n           '`BrokenComponentWillMountWithContext.prototype = React.Component.prototype`. ' +\n           \"Don't use an arrow function since it cannot be called with `new` by React.\",\n-      );\n+        ...gate(flags =>\n+          flags.disableLegacyContext\n+            ? [\n+                'Warning: BrokenComponentWillMountWithContext uses the legacy childContextTypes API which is no longer supported. Use React.createContext() instead.',\n+                'Warning: BrokenComponentWillMountWithContext uses the legacy childContextTypes API which is no longer supported. Use React.createContext() instead.',\n+              ]\n+            : [],\n+        ),\n+      ]);\n       expect(container.firstChild.textContent).toBe('Caught an error: Hello.');\n     });\n   }"
            },
            {
                "file": "packages/react-dom/src/test-utils/ReactTestUtils.js",
                "git_diff": "@@ -21,10 +21,6 @@ import {\n } from 'react-reconciler/src/ReactWorkTags';\n import {SyntheticEvent} from 'react-dom-bindings/src/events/SyntheticEvent';\n import {ELEMENT_NODE} from 'react-dom-bindings/src/client/HTMLNodeType';\n-import {\n-  rethrowCaughtError,\n-  invokeGuardedCallbackAndCatchFirstError,\n-} from 'shared/ReactErrorUtils';\n import {enableFloat} from 'shared/ReactFeatureFlags';\n import assign from 'shared/assign';\n import isArray from 'shared/isArray';\n@@ -354,16 +350,25 @@ function nativeTouchData(x, y) {\n // EventPropagator.js, as they deviated from ReactDOM's newer\n // implementations.\n \n+let hasError: boolean = false;\n+let caughtError: mixed = null;\n+\n /**\n  * Dispatch the event to the listener.\n  * @param {SyntheticEvent} event SyntheticEvent to handle\n  * @param {function} listener Application-level callback\n  * @param {*} inst Internal component instance\n  */\n function executeDispatch(event, listener, inst) {\n-  const type = event.type || 'unknown-event';\n   event.currentTarget = getNodeFromInstance(inst);\n-  invokeGuardedCallbackAndCatchFirstError(type, listener, undefined, event);\n+  try {\n+    listener(event);\n+  } catch (error) {\n+    if (!hasError) {\n+      hasError = true;\n+      caughtError = error;\n+    }\n+  }\n   event.currentTarget = null;\n }\n \n@@ -619,7 +624,12 @@ function makeSimulator(eventType) {\n       // do that since we're by-passing it here.\n       enqueueStateRestore(domNode);\n       executeDispatchesAndRelease(event);\n-      rethrowCaughtError();\n+      if (hasError) {\n+        const error = caughtError;\n+        hasError = false;\n+        caughtError = null;\n+        throw error;\n+      }\n     });\n     restoreStateIfNeeded();\n   };"
            },
            {
                "file": "packages/react-native-renderer/src/ReactFiberConfigFabric.js",
                "git_diff": "@@ -47,10 +47,7 @@ const {\n   unstable_getCurrentEventPriority: fabricGetCurrentEventPriority,\n } = nativeFabricUIManager;\n \n-import {\n-  useMicrotasksForSchedulingInFabric,\n-  passChildrenWhenCloningPersistedNodes,\n-} from 'shared/ReactFeatureFlags';\n+import {passChildrenWhenCloningPersistedNodes} from 'shared/ReactFeatureFlags';\n \n const {get: getViewConfigForType} = ReactNativeViewConfigRegistry;\n \n@@ -507,6 +504,10 @@ export const NotPendingTransition: TransitionStatus = null;\n // -------------------\n //     Microtasks\n // -------------------\n-export const supportsMicrotasks = useMicrotasksForSchedulingInFabric;\n+\n+export const supportsMicrotasks: boolean =\n+  typeof RN$enableMicrotasksInReact !== 'undefined' &&\n+  !!RN$enableMicrotasksInReact;\n+\n export const scheduleMicrotask: any =\n   typeof queueMicrotask === 'function' ? queueMicrotask : scheduleTimeout;"
            },
            {
                "file": "packages/react-native-renderer/src/legacy-events/EventBatching.js",
                "git_diff": "@@ -6,12 +6,10 @@\n  * @flow\n  */\n \n-import {rethrowCaughtError} from 'shared/ReactErrorUtils';\n-\n import type {ReactSyntheticEvent} from './ReactSyntheticEventType';\n import accumulateInto from './accumulateInto';\n import forEachAccumulated from './forEachAccumulated';\n-import {executeDispatchesInOrder} from './EventPluginUtils';\n+import {executeDispatchesInOrder, rethrowCaughtError} from './EventPluginUtils';\n \n /**\n  * Internal queue of events that have accumulated their dispatches and are"
            },
            {
                "file": "packages/react-native-renderer/src/legacy-events/EventPluginUtils.js",
                "git_diff": "@@ -5,9 +5,11 @@\n  * LICENSE file in the root directory of this source tree.\n  */\n \n-import {invokeGuardedCallbackAndCatchFirstError} from 'shared/ReactErrorUtils';\n import isArray from 'shared/isArray';\n \n+let hasError = false;\n+let caughtError = null;\n+\n export let getFiberCurrentPropsFromNode = null;\n export let getInstanceFromNode = null;\n export let getNodeFromInstance = null;\n@@ -62,9 +64,17 @@ function validateEventDispatches(event) {\n  * @param {*} inst Internal component instance\n  */\n export function executeDispatch(event, listener, inst) {\n-  const type = event.type || 'unknown-event';\n   event.currentTarget = getNodeFromInstance(inst);\n-  invokeGuardedCallbackAndCatchFirstError(type, listener, undefined, event);\n+  try {\n+    listener(event);\n+  } catch (error) {\n+    if (!hasError) {\n+      hasError = true;\n+      caughtError = error;\n+    } else {\n+      // TODO: Make sure this error gets logged somehow.\n+    }\n+  }\n   event.currentTarget = null;\n }\n \n@@ -170,3 +180,12 @@ export function executeDirectDispatch(event) {\n export function hasDispatches(event) {\n   return !!event._dispatchListeners;\n }\n+\n+export function rethrowCaughtError() {\n+  if (hasError) {\n+    const error = caughtError;\n+    hasError = false;\n+    caughtError = null;\n+    throw error;\n+  }\n+}"
            },
            {
                "file": "packages/react-reconciler/src/ReactChildFiber.js",
                "git_diff": "@@ -58,7 +58,7 @@ import {isCompatibleFamilyForHotReloading} from './ReactFiberHotReloading';\n import {getIsHydrating} from './ReactFiberHydrationContext';\n import {pushTreeFork} from './ReactFiberTreeContext';\n import {createThenableState, trackUsedThenable} from './ReactFiberThenable';\n-import {readContextDuringReconcilation} from './ReactFiberNewContext';\n+import {readContextDuringReconciliation} from './ReactFiberNewContext';\n \n // This tracks the thenables that are unwrapped during reconcilation.\n let thenableState: ThenableState | null = null;\n@@ -746,7 +746,7 @@ function createChildReconciler(\n         const context: ReactContext<mixed> = (newChild: any);\n         return createChild(\n           returnFiber,\n-          readContextDuringReconcilation(returnFiber, context, lanes),\n+          readContextDuringReconciliation(returnFiber, context, lanes),\n           lanes,\n           debugInfo,\n         );\n@@ -873,7 +873,7 @@ function createChildReconciler(\n         return updateSlot(\n           returnFiber,\n           oldFiber,\n-          readContextDuringReconcilation(returnFiber, context, lanes),\n+          readContextDuringReconciliation(returnFiber, context, lanes),\n           lanes,\n           debugInfo,\n         );\n@@ -994,7 +994,7 @@ function createChildReconciler(\n           existingChildren,\n           returnFiber,\n           newIdx,\n-          readContextDuringReconcilation(returnFiber, context, lanes),\n+          readContextDuringReconciliation(returnFiber, context, lanes),\n           lanes,\n           debugInfo,\n         );\n@@ -1710,7 +1710,7 @@ function createChildReconciler(\n         return reconcileChildFibersImpl(\n           returnFiber,\n           currentFirstChild,\n-          readContextDuringReconcilation(returnFiber, context, lanes),\n+          readContextDuringReconciliation(returnFiber, context, lanes),\n           lanes,\n           debugInfo,\n         );"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiber.js",
                "git_diff": "@@ -879,57 +879,3 @@ export function createFiberFromPortal(\n   };\n   return fiber;\n }\n-\n-// Used for stashing WIP properties to replay failed work in DEV.\n-export function assignFiberPropertiesInDEV(\n-  target: Fiber | null,\n-  source: Fiber,\n-): Fiber {\n-  if (target === null) {\n-    // This Fiber's initial properties will always be overwritten.\n-    // We only use a Fiber to ensure the same hidden class so DEV isn't slow.\n-    target = createFiber(IndeterminateComponent, null, null, NoMode);\n-  }\n-\n-  // This is intentionally written as a list of all properties.\n-  // We tried to use Object.assign() instead but this is called in\n-  // the hottest path, and Object.assign() was too slow:\n-  // https://github.com/facebook/react/issues/12502\n-  // This code is DEV-only so size is not a concern.\n-\n-  target.tag = source.tag;\n-  target.key = source.key;\n-  target.elementType = source.elementType;\n-  target.type = source.type;\n-  target.stateNode = source.stateNode;\n-  target.return = source.return;\n-  target.child = source.child;\n-  target.sibling = source.sibling;\n-  target.index = source.index;\n-  target.ref = source.ref;\n-  target.refCleanup = source.refCleanup;\n-  target.pendingProps = source.pendingProps;\n-  target.memoizedProps = source.memoizedProps;\n-  target.updateQueue = source.updateQueue;\n-  target.memoizedState = source.memoizedState;\n-  target.dependencies = source.dependencies;\n-  target.mode = source.mode;\n-  target.flags = source.flags;\n-  target.subtreeFlags = source.subtreeFlags;\n-  target.deletions = source.deletions;\n-  target.lanes = source.lanes;\n-  target.childLanes = source.childLanes;\n-  target.alternate = source.alternate;\n-  if (enableProfilerTimer) {\n-    target.actualDuration = source.actualDuration;\n-    target.actualStartTime = source.actualStartTime;\n-    target.selfBaseDuration = source.selfBaseDuration;\n-    target.treeBaseDuration = source.treeBaseDuration;\n-  }\n-\n-  target._debugInfo = source._debugInfo;\n-  target._debugOwner = source._debugOwner;\n-  target._debugNeedsRemount = source._debugNeedsRemount;\n-  target._debugHookTypes = source._debugHookTypes;\n-  return target;\n-}"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberCommitWork.js",
                "git_diff": "@@ -190,7 +190,6 @@ import {\n } from './ReactHookEffectTags';\n import {didWarnAboutReassigningProps} from './ReactFiberBeginWork';\n import {doesFiberContain} from './ReactFiberTreeReflection';\n-import {invokeGuardedCallback, clearCaughtError} from 'shared/ReactErrorUtils';\n import {\n   isDevToolsPresent,\n   markComponentPassiveEffectMountStarted,\n@@ -244,20 +243,6 @@ function shouldProfile(current: Fiber): boolean {\n   );\n }\n \n-export function reportUncaughtErrorInDEV(error: mixed) {\n-  // Wrapping each small part of the commit phase into a guarded\n-  // callback is a bit too slow (https://github.com/facebook/react/pull/21666).\n-  // But we rely on it to surface errors to DEV tools like overlays\n-  // (https://github.com/facebook/react/issues/21712).\n-  // As a compromise, rethrow only caught errors in a guard.\n-  if (__DEV__) {\n-    invokeGuardedCallback(null, () => {\n-      throw error;\n-    });\n-    clearCaughtError();\n-  }\n-}\n-\n function callComponentWillUnmountWithTimer(current: Fiber, instance: any) {\n   instance.props = current.memoizedProps;\n   instance.state = current.memoizedState;"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberErrorLogger.js",
                "git_diff": "@@ -11,7 +11,6 @@ import type {Fiber} from './ReactInternalTypes';\n import type {CapturedValue} from './ReactCapturedValue';\n \n import {showErrorDialog} from './ReactFiberErrorDialog';\n-import {ClassComponent} from './ReactWorkTags';\n import getComponentNameFromFiber from 'react-reconciler/src/getComponentNameFromFiber';\n import {HostRoot} from 'react-reconciler/src/ReactWorkTags';\n \n@@ -33,24 +32,8 @@ export function logCapturedError(\n       const source = errorInfo.source;\n       const stack = errorInfo.stack;\n       const componentStack = stack !== null ? stack : '';\n-      // Browsers support silencing uncaught errors by calling\n-      // `preventDefault()` in window `error` handler.\n-      // We record this information as an expando on the error.\n-      if (error != null && error._suppressLogging) {\n-        if (boundary.tag === ClassComponent) {\n-          // The error is recoverable and was silenced.\n-          // Ignore it and don't print the stack addendum.\n-          // This is handy for testing error boundaries without noise.\n-          return;\n-        }\n-        // The error is fatal. Since the silencing might have\n-        // been accidental, we'll surface it anyway.\n-        // However, the browser would have silenced the original error\n-        // so we'll print it first, and then print the stack addendum.\n-        console['error'](error); // Don't transform to our wrapper\n-        // For a more detailed description of this block, see:\n-        // https://github.com/facebook/react/pull/13384\n-      }\n+      // TODO: There's no longer a way to silence these warnings e.g. for tests.\n+      // See https://github.com/facebook/react/pull/13384\n \n       const componentName = source ? getComponentNameFromFiber(source) : null;\n       const componentNameMessage = componentName\n@@ -69,15 +52,17 @@ export function logCapturedError(\n           `React will try to recreate this component tree from scratch ` +\n           `using the error boundary you provided, ${errorBoundaryName}.`;\n       }\n-      const combinedMessage =\n-        `${componentNameMessage}\\n${componentStack}\\n\\n` +\n-        `${errorBoundaryMessage}`;\n \n-      // In development, we provide our own message with just the component stack.\n-      // We don't include the original error message and JS stack because the browser\n-      // has already printed it. Even if the application swallows the error, it is still\n-      // displayed by the browser thanks to the DEV-only fake event trick in ReactErrorUtils.\n-      console['error'](combinedMessage); // Don't transform to our wrapper\n+      // In development, we provide our own message which includes the component stack\n+      // in addition to the error.\n+      console['error'](\n+        // Don't transform to our wrapper\n+        '%o\\n\\n%s\\n%s\\n\\n%s',\n+        error,\n+        componentNameMessage,\n+        componentStack,\n+        errorBoundaryMessage,\n+      );\n     } else {\n       // In production, we print the error directly.\n       // This will include the message, the JS stack, and anything the browser wants to show."
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHooks.js",
                "git_diff": "@@ -1915,6 +1915,7 @@ type FormStateActionQueueNode<P> = {\n function dispatchFormState<S, P>(\n   fiber: Fiber,\n   actionQueue: FormStateActionQueue<S, P>,\n+  setPendingState: boolean => void,\n   setState: Dispatch<S | Awaited<S>>,\n   payload: P,\n ): void {\n@@ -1931,7 +1932,12 @@ function dispatchFormState<S, P>(\n     };\n     newLast.next = actionQueue.pending = newLast;\n \n-    runFormStateAction(actionQueue, (setState: any), payload);\n+    runFormStateAction(\n+      actionQueue,\n+      (setPendingState: any),\n+      (setState: any),\n+      payload,\n+    );\n   } else {\n     // There's already an action running. Add to the queue.\n     const first = last.next;\n@@ -1945,6 +1951,7 @@ function dispatchFormState<S, P>(\n \n function runFormStateAction<S, P>(\n   actionQueue: FormStateActionQueue<S, P>,\n+  setPendingState: boolean => void,\n   setState: Dispatch<S | Awaited<S>>,\n   payload: P,\n ) {\n@@ -1960,6 +1967,11 @@ function runFormStateAction<S, P>(\n   if (__DEV__) {\n     ReactCurrentBatchConfig.transition._updatedFibers = new Set();\n   }\n+\n+  // Optimistically update the pending state, similar to useTransition.\n+  // This will be reverted automatically when all actions are finished.\n+  setPendingState(true);\n+\n   try {\n     const returnValue = action(prevState, payload);\n     if (\n@@ -1976,9 +1988,18 @@ function runFormStateAction<S, P>(\n       thenable.then(\n         (nextState: Awaited<S>) => {\n           actionQueue.state = nextState;\n-          finishRunningFormStateAction(actionQueue, (setState: any));\n+          finishRunningFormStateAction(\n+            actionQueue,\n+            (setPendingState: any),\n+            (setState: any),\n+          );\n         },\n-        () => finishRunningFormStateAction(actionQueue, (setState: any)),\n+        () =>\n+          finishRunningFormStateAction(\n+            actionQueue,\n+            (setPendingState: any),\n+            (setState: any),\n+          ),\n       );\n \n       setState((thenable: any));\n@@ -1987,7 +2008,11 @@ function runFormStateAction<S, P>(\n \n       const nextState = ((returnValue: any): Awaited<S>);\n       actionQueue.state = nextState;\n-      finishRunningFormStateAction(actionQueue, (setState: any));\n+      finishRunningFormStateAction(\n+        actionQueue,\n+        (setPendingState: any),\n+        (setState: any),\n+      );\n     }\n   } catch (error) {\n     // This is a trick to get the `useFormState` hook to rethrow the error.\n@@ -2000,7 +2025,11 @@ function runFormStateAction<S, P>(\n       // $FlowFixMe: Not sure why this doesn't work\n     }: RejectedThenable<Awaited<S>>);\n     setState(rejectedThenable);\n-    finishRunningFormStateAction(actionQueue, (setState: any));\n+    finishRunningFormStateAction(\n+      actionQueue,\n+      (setPendingState: any),\n+      (setState: any),\n+    );\n   } finally {\n     ReactCurrentBatchConfig.transition = prevTransition;\n \n@@ -2022,6 +2051,7 @@ function runFormStateAction<S, P>(\n \n function finishRunningFormStateAction<S, P>(\n   actionQueue: FormStateActionQueue<S, P>,\n+  setPendingState: Dispatch<S | Awaited<S>>,\n   setState: Dispatch<S | Awaited<S>>,\n ) {\n   // The action finished running. Pop it from the queue and run the next pending\n@@ -2038,7 +2068,12 @@ function finishRunningFormStateAction<S, P>(\n       last.next = next;\n \n       // Run the next action.\n-      runFormStateAction(actionQueue, (setState: any), next.payload);\n+      runFormStateAction(\n+        actionQueue,\n+        (setPendingState: any),\n+        (setState: any),\n+        next.payload,\n+      );\n     }\n   }\n }\n@@ -2051,7 +2086,7 @@ function mountFormState<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialStateProp: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   let initialState: Awaited<S> = initialStateProp;\n   if (getIsHydrating()) {\n     const root: FiberRoot = (getWorkInProgressRoot(): any);\n@@ -2090,6 +2125,19 @@ function mountFormState<S, P>(\n   ): any);\n   stateQueue.dispatch = setState;\n \n+  // Pending state. This is used to store the pending state of the action.\n+  // Tracked optimistically, like a transition pending state.\n+  const pendingStateHook = mountStateImpl((false: Thenable<boolean> | boolean));\n+  const setPendingState: boolean => void = (dispatchOptimisticSetState.bind(\n+    null,\n+    currentlyRenderingFiber,\n+    false,\n+    ((pendingStateHook.queue: any): UpdateQueue<\n+      S | Awaited<S>,\n+      S | Awaited<S>,\n+    >),\n+  ): any);\n+\n   // Action queue hook. This is used to queue pending actions. The queue is\n   // shared between all instances of the hook. Similar to a regular state queue,\n   // but different because the actions are run sequentially, and they run in\n@@ -2106,6 +2154,7 @@ function mountFormState<S, P>(\n     null,\n     currentlyRenderingFiber,\n     actionQueue,\n+    setPendingState,\n     setState,\n   );\n   actionQueue.dispatch = dispatch;\n@@ -2115,14 +2164,14 @@ function mountFormState<S, P>(\n   // an effect.\n   actionQueueHook.memoizedState = action;\n \n-  return [initialState, dispatch];\n+  return [initialState, dispatch, false];\n }\n \n function updateFormState<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialState: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   const stateHook = updateWorkInProgressHook();\n   const currentStateHook = ((currentHook: any): Hook);\n   return updateFormStateImpl(\n@@ -2140,13 +2189,15 @@ function updateFormStateImpl<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialState: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   const [actionResult] = updateReducerImpl<S | Thenable<S>, S | Thenable<S>>(\n     stateHook,\n     currentStateHook,\n     formStateReducer,\n   );\n \n+  const [isPending] = updateState(false);\n+\n   // This will suspend until the action finishes.\n   const state: Awaited<S> =\n     typeof actionResult === 'object' &&\n@@ -2172,7 +2223,7 @@ function updateFormStateImpl<S, P>(\n     );\n   }\n \n-  return [state, dispatch];\n+  return [state, dispatch, isPending];\n }\n \n function formStateActionEffect<S, P>(\n@@ -2186,7 +2237,7 @@ function rerenderFormState<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialState: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   // Unlike useState, useFormState doesn't support render phase updates.\n   // Also unlike useState, we need to replay all pending updates again in case\n   // the passthrough value changed.\n@@ -2218,7 +2269,8 @@ function rerenderFormState<S, P>(\n   // This may have changed during the rerender.\n   actionQueueHook.memoizedState = action;\n \n-  return [state, dispatch];\n+  // For mount, pending is always false.\n+  return [state, dispatch, false];\n }\n \n function pushEffect(\n@@ -3765,7 +3817,7 @@ if (__DEV__) {\n         action: (Awaited<S>, P) => S,\n         initialState: Awaited<S>,\n         permalink?: string,\n-      ): [Awaited<S>, (P) => void] {\n+      ): [Awaited<S>, (P) => void, boolean] {\n         currentHookNameInDev = 'useFormState';\n         mountHookTypesDev();\n         return mountFormState(action, initialState, permalink);\n@@ -3935,7 +3987,7 @@ if (__DEV__) {\n         action: (Awaited<S>, P) => S,\n         initialState: Awaited<S>,\n         permalink?: string,\n-      ): [Awaited<S>, (P) => void] {\n+      ): [Awaited<S>, (P) => void, boolean] {\n         currentHookNameInDev = 'useFormState';\n         updateHookTypesDev();\n         return mountFormState(action, initialState, permalink);\n@@ -4107,7 +4159,7 @@ if (__DEV__) {\n         action: (Awaited<S>, P) => S,\n         initialState: Awaited<S>,\n         permalink?: string,\n-      ): [Awaited<S>, (P) => void] {\n+      ): [Awaited<S>, (P) => void, boolean] {\n         currentHookNameInDev = 'useFormState';\n         updateHookTypesDev();\n         return updateFormState(action, initialState, permalink);\n@@ -4279,7 +4331,7 @@ if (__DEV__) {\n         action: (Awaited<S>, P) => S,\n         initialState: Awaited<S>,\n         permalink?: string,\n-      ): [Awaited<S>, (P) => void] {\n+      ): [Awaited<S>, (P) => void, boolean] {\n         currentHookNameInDev = 'useFormState';\n         updateHookTypesDev();\n         return rerenderFormState(action, initialState, permalink);\n@@ -4472,7 +4524,7 @@ if (__DEV__) {\n         action: (Awaited<S>, P) => S,\n         initialState: Awaited<S>,\n         permalink?: string,\n-      ): [Awaited<S>, (P) => void] {\n+      ): [Awaited<S>, (P) => void, boolean] {\n         currentHookNameInDev = 'useFormState';\n         warnInvalidHookAccess();\n         mountHookTypesDev();\n@@ -4670,7 +4722,7 @@ if (__DEV__) {\n         action: (Awaited<S>, P) => S,\n         initialState: Awaited<S>,\n         permalink?: string,\n-      ): [Awaited<S>, (P) => void] {\n+      ): [Awaited<S>, (P) => void, boolean] {\n         currentHookNameInDev = 'useFormState';\n         warnInvalidHookAccess();\n         updateHookTypesDev();\n@@ -4868,7 +4920,7 @@ if (__DEV__) {\n         action: (Awaited<S>, P) => S,\n         initialState: Awaited<S>,\n         permalink?: string,\n-      ): [Awaited<S>, (P) => void] {\n+      ): [Awaited<S>, (P) => void, boolean] {\n         currentHookNameInDev = 'useFormState';\n         warnInvalidHookAccess();\n         updateHookTypesDev();"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberHydrationContext.js",
                "git_diff": "@@ -116,13 +116,6 @@ export function markDidThrowWhileHydratingDEV() {\n   }\n }\n \n-export function didSuspendOrErrorWhileHydratingDEV(): boolean {\n-  if (__DEV__) {\n-    return didSuspendOrErrorDEV;\n-  }\n-  return false;\n-}\n-\n function enterHydrationState(fiber: Fiber): boolean {\n   if (!supportsHydration) {\n     return false;"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberNewContext.js",
                "git_diff": "@@ -715,7 +715,7 @@ export function readContext<T>(context: ReactContext<T>): T {\n   return readContextForConsumer(currentlyRenderingFiber, context);\n }\n \n-export function readContextDuringReconcilation<T>(\n+export function readContextDuringReconciliation<T>(\n   consumer: Fiber,\n   context: ReactContext<T>,\n   renderLanes: Lanes,"
            },
            {
                "file": "packages/react-reconciler/src/ReactFiberWorkLoop.js",
                "git_diff": "@@ -25,7 +25,6 @@ import type {OffscreenInstance} from './ReactFiberActivityComponent';\n import type {RenderTaskFn} from './ReactFiberRootScheduler';\n \n import {\n-  replayFailedUnitOfWorkWithInvokeGuardedCallback,\n   enableCreateEventHandleAPI,\n   enableProfilerTimer,\n   enableProfilerCommitHooks,\n@@ -77,16 +76,9 @@ import {\n   preloadInstance,\n } from './ReactFiberConfig';\n \n-import {\n-  createWorkInProgress,\n-  assignFiberPropertiesInDEV,\n-  resetWorkInProgress,\n-} from './ReactFiber';\n+import {createWorkInProgress, resetWorkInProgress} from './ReactFiber';\n import {isRootDehydrated} from './ReactFiberShellHydration';\n-import {\n-  getIsHydrating,\n-  didSuspendOrErrorWhileHydratingDEV,\n-} from './ReactFiberHydrationContext';\n+import {getIsHydrating} from './ReactFiberHydrationContext';\n import {\n   NoMode,\n   ProfileMode,\n@@ -173,7 +165,7 @@ import {\n import {requestCurrentTransition} from './ReactFiberTransition';\n import {\n   SelectiveHydrationException,\n-  beginWork as originalBeginWork,\n+  beginWork,\n   replayFunctionComponent,\n } from './ReactFiberBeginWork';\n import {completeWork} from './ReactFiberCompleteWork';\n@@ -194,7 +186,6 @@ import {\n   reconnectPassiveEffects,\n   reappearLayoutEffects,\n   disconnectPassiveEffect,\n-  reportUncaughtErrorInDEV,\n   invokeLayoutEffectMountInDEV,\n   invokePassiveEffectMountInDEV,\n   invokeLayoutEffectUnmountInDEV,\n@@ -237,11 +228,6 @@ import {\n   resetCurrentFiber as resetCurrentDebugFiberInDEV,\n   setCurrentFiber as setCurrentDebugFiberInDEV,\n } from './ReactCurrentFiber';\n-import {\n-  invokeGuardedCallback,\n-  hasCaughtError,\n-  clearCaughtError,\n-} from 'shared/ReactErrorUtils';\n import {\n   isDevToolsPresent,\n   markCommitStarted,\n@@ -3397,7 +3383,6 @@ export function captureCommitPhaseError(\n   error: mixed,\n ) {\n   if (__DEV__) {\n-    reportUncaughtErrorInDEV(error);\n     setIsRunningInsertionEffect(false);\n   }\n   if (sourceFiber.tag === HostRoot) {\n@@ -3884,84 +3869,6 @@ export function warnAboutUpdateOnNotYetMountedFiberInDEV(fiber: Fiber) {\n   }\n }\n \n-let beginWork;\n-if (__DEV__ && replayFailedUnitOfWorkWithInvokeGuardedCallback) {\n-  const dummyFiber = null;\n-  beginWork = (current: null | Fiber, unitOfWork: Fiber, lanes: Lanes) => {\n-    // If a component throws an error, we replay it again in a synchronously\n-    // dispatched event, so that the debugger will treat it as an uncaught\n-    // error See ReactErrorUtils for more information.\n-\n-    // Before entering the begin phase, copy the work-in-progress onto a dummy\n-    // fiber. If beginWork throws, we'll use this to reset the state.\n-    const originalWorkInProgressCopy = assignFiberPropertiesInDEV(\n-      dummyFiber,\n-      unitOfWork,\n-    );\n-    try {\n-      return originalBeginWork(current, unitOfWork, lanes);\n-    } catch (originalError) {\n-      if (\n-        didSuspendOrErrorWhileHydratingDEV() ||\n-        originalError === SuspenseException ||\n-        originalError === SelectiveHydrationException ||\n-        (originalError !== null &&\n-          typeof originalError === 'object' &&\n-          typeof originalError.then === 'function')\n-      ) {\n-        // Don't replay promises.\n-        // Don't replay errors if we are hydrating and have already suspended or handled an error\n-        throw originalError;\n-      }\n-\n-      // Don't reset current debug fiber, since we're about to work on the\n-      // same fiber again.\n-\n-      // Unwind the failed stack frame\n-      resetSuspendedWorkLoopOnUnwind(unitOfWork);\n-      unwindInterruptedWork(current, unitOfWork, workInProgressRootRenderLanes);\n-\n-      // Restore the original properties of the fiber.\n-      assignFiberPropertiesInDEV(unitOfWork, originalWorkInProgressCopy);\n-\n-      if (enableProfilerTimer && unitOfWork.mode & ProfileMode) {\n-        // Reset the profiler timer.\n-        startProfilerTimer(unitOfWork);\n-      }\n-\n-      // Run beginWork again.\n-      invokeGuardedCallback(\n-        null,\n-        originalBeginWork,\n-        null,\n-        current,\n-        unitOfWork,\n-        lanes,\n-      );\n-\n-      if (hasCaughtError()) {\n-        const replayError = clearCaughtError();\n-        if (\n-          typeof replayError === 'object' &&\n-          replayError !== null &&\n-          replayError._suppressLogging &&\n-          typeof originalError === 'object' &&\n-          originalError !== null &&\n-          !originalError._suppressLogging\n-        ) {\n-          // If suppressed, let the flag carry over to the original error which is the one we'll rethrow.\n-          originalError._suppressLogging = true;\n-        }\n-      }\n-      // We always throw the original error in case the second render pass is not idempotent.\n-      // This can happen if a memoized function or CommonJS module doesn't throw after first invocation.\n-      throw originalError;\n-    }\n-  };\n-} else {\n-  beginWork = originalBeginWork;\n-}\n-\n let didWarnAboutUpdateInRender = false;\n let didWarnAboutUpdateInRenderForAnotherComponent;\n if (__DEV__) {"
            },
            {
                "file": "packages/react-reconciler/src/ReactInternalTypes.js",
                "git_diff": "@@ -413,7 +413,7 @@ export type Dispatcher = {\n     action: (Awaited<S>, P) => S,\n     initialState: Awaited<S>,\n     permalink?: string,\n-  ) => [Awaited<S>, (P) => void],\n+  ) => [Awaited<S>, (P) => void, boolean],\n };\n \n export type CacheDispatcher = {"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ErrorBoundaryReconciliation-test.internal.js",
                "git_diff": "@@ -3,17 +3,13 @@ describe('ErrorBoundaryReconciliation', () => {\n   let DidCatchErrorBoundary;\n   let GetDerivedErrorBoundary;\n   let React;\n-  let ReactFeatureFlags;\n   let ReactTestRenderer;\n   let span;\n   let act;\n \n   beforeEach(() => {\n     jest.resetModules();\n \n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     ReactTestRenderer = require('react-test-renderer');\n     React = require('react');\n     act = require('internal-test-utils').act;"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactBatching-test.internal.js",
                "git_diff": "@@ -1,5 +1,4 @@\n let React;\n-let ReactFeatureFlags;\n let ReactNoop;\n let Scheduler;\n let waitForAll;\n@@ -12,9 +11,6 @@ let act;\n describe('ReactBlockingMode', () => {\n   beforeEach(() => {\n     jest.resetModules();\n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     React = require('react');\n     ReactNoop = require('react-noop-renderer');\n     Scheduler = require('scheduler');"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactConcurrentErrorRecovery-test.js",
                "git_diff": "@@ -220,46 +220,15 @@ describe('ReactConcurrentErrorRecovery', () => {\n \n     // Because we're still suspended on A, we can't show an error boundary. We\n     // should wait for A to resolve.\n-    if (gate(flags => flags.replayFailedUnitOfWorkWithInvokeGuardedCallback)) {\n-      assertLog([\n-        'Suspend! [A2]',\n-        'Loading...',\n-\n-        'Error! [B2]',\n-        // This extra log happens when we replay the error\n-        // in invokeGuardedCallback\n-        'Error! [B2]',\n-        'Oops!',\n-      ]);\n-    } else {\n-      assertLog(['Suspend! [A2]', 'Loading...', 'Error! [B2]', 'Oops!']);\n-    }\n+    assertLog(['Suspend! [A2]', 'Loading...', 'Error! [B2]', 'Oops!']);\n     // Remain on previous screen.\n     expect(root).toMatchRenderedOutput('A1B1');\n \n     // A finishes loading.\n     await act(() => {\n       resolveText('A2');\n     });\n-    if (gate(flags => flags.replayFailedUnitOfWorkWithInvokeGuardedCallback)) {\n-      assertLog([\n-        'A2',\n-        'Error! [B2]',\n-        // This extra log happens when we replay the error\n-        // in invokeGuardedCallback\n-        'Error! [B2]',\n-        'Oops!',\n-\n-        'A2',\n-        'Error! [B2]',\n-        // This extra log happens when we replay the error\n-        // in invokeGuardedCallback\n-        'Error! [B2]',\n-        'Oops!',\n-      ]);\n-    } else {\n-      assertLog(['A2', 'Error! [B2]', 'Oops!', 'A2', 'Error! [B2]', 'Oops!']);\n-    }\n+    assertLog(['A2', 'Error! [B2]', 'Oops!', 'A2', 'Error! [B2]', 'Oops!']);\n     // Now we can show the error boundary that's wrapped around B.\n     expect(root).toMatchRenderedOutput('A2Oops!');\n   });\n@@ -323,46 +292,15 @@ describe('ReactConcurrentErrorRecovery', () => {\n \n     // Because we're still suspended on B, we can't show an error boundary. We\n     // should wait for B to resolve.\n-    if (gate(flags => flags.replayFailedUnitOfWorkWithInvokeGuardedCallback)) {\n-      assertLog([\n-        'Error! [A2]',\n-        // This extra log happens when we replay the error\n-        // in invokeGuardedCallback\n-        'Error! [A2]',\n-        'Oops!',\n-\n-        'Suspend! [B2]',\n-        'Loading...',\n-      ]);\n-    } else {\n-      assertLog(['Error! [A2]', 'Oops!', 'Suspend! [B2]', 'Loading...']);\n-    }\n+    assertLog(['Error! [A2]', 'Oops!', 'Suspend! [B2]', 'Loading...']);\n     // Remain on previous screen.\n     expect(root).toMatchRenderedOutput('A1B1');\n \n     // B finishes loading.\n     await act(() => {\n       resolveText('B2');\n     });\n-    if (gate(flags => flags.replayFailedUnitOfWorkWithInvokeGuardedCallback)) {\n-      assertLog([\n-        'Error! [A2]',\n-        // This extra log happens when we replay the error\n-        // in invokeGuardedCallback\n-        'Error! [A2]',\n-        'Oops!',\n-        'B2',\n-\n-        'Error! [A2]',\n-        // This extra log happens when we replay the error\n-        // in invokeGuardedCallback\n-        'Error! [A2]',\n-        'Oops!',\n-        'B2',\n-      ]);\n-    } else {\n-      assertLog(['Error! [A2]', 'Oops!', 'B2', 'Error! [A2]', 'Oops!', 'B2']);\n-    }\n+    assertLog(['Error! [A2]', 'Oops!', 'B2', 'Error! [A2]', 'Oops!', 'B2']);\n     // Now we can show the error boundary that's wrapped around B.\n     expect(root).toMatchRenderedOutput('Oops!B2');\n   });"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactHooks-test.internal.js",
                "git_diff": "@@ -1042,7 +1042,6 @@ describe('ReactHooks', () => {\n         'Update hook called on initial render. This is likely a bug in React. Please file an issue.',\n       );\n     }).toErrorDev([\n-      'Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks',\n       'Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks',\n       'Warning: React has detected a change in the order of Hooks called by App. ' +\n         'This will lead to bugs and errors if not fixed. For more information, ' +\n@@ -1105,9 +1104,6 @@ describe('ReactHooks', () => {\n         </Boundary>,\n       );\n     }).toErrorDev([\n-      // We see it twice due to replay\n-      'Context can only be read while React is rendering',\n-      'Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks',\n       'Context can only be read while React is rendering',\n       'Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks',\n     ]);\n@@ -1143,9 +1139,6 @@ describe('ReactHooks', () => {\n         </Boundary>,\n       );\n     }).toErrorDev([\n-      // We see it twice due to replay\n-      'Context can only be read while React is rendering',\n-      'Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks',\n       'Context can only be read while React is rendering',\n       'Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks',\n     ]);"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactIncrementalErrorHandling-test.internal.js",
                "git_diff": "@@ -10,7 +10,6 @@\n \n 'use strict';\n \n-let ReactFeatureFlags = require('shared/ReactFeatureFlags');\n let PropTypes;\n let React;\n let ReactNoop;\n@@ -24,8 +23,6 @@ let waitForThrow;\n describe('ReactIncrementalErrorHandling', () => {\n   beforeEach(() => {\n     jest.resetModules();\n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     PropTypes = require('prop-types');\n     React = require('react');\n     ReactNoop = require('react-noop-renderer');\n@@ -1513,7 +1510,8 @@ describe('ReactIncrementalErrorHandling', () => {\n \n     if (__DEV__) {\n       expect(console.error).toHaveBeenCalledTimes(1);\n-      expect(console.error.mock.calls[0][0]).toContain(\n+      expect(console.error.mock.calls[0][1]).toBe(notAnError);\n+      expect(console.error.mock.calls[0][2]).toContain(\n         'The above error occurred in the <BadRender> component:',\n       );\n     } else {\n@@ -1784,6 +1782,14 @@ describe('ReactIncrementalErrorHandling', () => {\n         \"If you can't use a class try assigning the prototype on the function as a workaround. \" +\n         '`Provider.prototype = React.Component.prototype`. ' +\n         \"Don't use an arrow function since it cannot be called with `new` by React.\",\n+      ...gate(flags =>\n+        flags.disableLegacyContext\n+          ? [\n+              'Warning: Provider uses the legacy childContextTypes API which is no longer supported. Use React.createContext() instead.',\n+              'Warning: Provider uses the legacy childContextTypes API which is no longer supported. Use React.createContext() instead.',\n+            ]\n+          : [],\n+      ),\n     ]);\n   });\n \n@@ -1914,7 +1920,7 @@ describe('ReactIncrementalErrorHandling', () => {\n       expect(console.error.mock.calls[0][0]).toContain(\n         'Cannot update a component (`%s`) while rendering a different component',\n       );\n-      expect(console.error.mock.calls[1][0]).toContain(\n+      expect(console.error.mock.calls[1][2]).toContain(\n         'The above error occurred in the <App> component',\n       );\n     }"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactIncrementalErrorLogging-test.js",
                "git_diff": "@@ -60,22 +60,34 @@ describe('ReactIncrementalErrorLogging', () => {\n     );\n     await waitForThrow('constructor error');\n     expect(console.error).toHaveBeenCalledTimes(1);\n-    expect(console.error).toHaveBeenCalledWith(\n-      __DEV__\n-        ? expect.stringMatching(\n-            new RegExp(\n-              'The above error occurred in the <ErrorThrowingComponent> component:\\n' +\n-                '\\\\s+(in|at) ErrorThrowingComponent (.*)\\n' +\n-                '\\\\s+(in|at) span(.*)\\n' +\n-                '\\\\s+(in|at) div(.*)\\n\\n' +\n-                'Consider adding an error boundary to your tree ' +\n-                'to customize error handling behavior\\\\.',\n-            ),\n-          )\n-        : expect.objectContaining({\n-            message: 'constructor error',\n-          }),\n-    );\n+    if (__DEV__) {\n+      expect(console.error).toHaveBeenCalledWith(\n+        expect.stringContaining('%o'),\n+        expect.objectContaining({\n+          message: 'constructor error',\n+        }),\n+        expect.stringContaining(\n+          'The above error occurred in the <ErrorThrowingComponent> component:',\n+        ),\n+        expect.stringMatching(\n+          new RegExp(\n+            '\\\\s+(in|at) ErrorThrowingComponent (.*)\\n' +\n+              '\\\\s+(in|at) span(.*)\\n' +\n+              '\\\\s+(in|at) div(.*)',\n+          ),\n+        ),\n+        expect.stringContaining(\n+          'Consider adding an error boundary to your tree ' +\n+            'to customize error handling behavior.',\n+        ),\n+      );\n+    } else {\n+      expect(console.error).toHaveBeenCalledWith(\n+        expect.objectContaining({\n+          message: 'constructor error',\n+        }),\n+      );\n+    }\n   });\n \n   it('should log errors that occur during the commit phase', async () => {\n@@ -96,22 +108,34 @@ describe('ReactIncrementalErrorLogging', () => {\n     );\n     await waitForThrow('componentDidMount error');\n     expect(console.error).toHaveBeenCalledTimes(1);\n-    expect(console.error).toHaveBeenCalledWith(\n-      __DEV__\n-        ? expect.stringMatching(\n-            new RegExp(\n-              'The above error occurred in the <ErrorThrowingComponent> component:\\n' +\n-                '\\\\s+(in|at) ErrorThrowingComponent (.*)\\n' +\n-                '\\\\s+(in|at) span(.*)\\n' +\n-                '\\\\s+(in|at) div(.*)\\n\\n' +\n-                'Consider adding an error boundary to your tree ' +\n-                'to customize error handling behavior\\\\.',\n-            ),\n-          )\n-        : expect.objectContaining({\n-            message: 'componentDidMount error',\n-          }),\n-    );\n+    if (__DEV__) {\n+      expect(console.error).toHaveBeenCalledWith(\n+        expect.stringContaining('%o'),\n+        expect.objectContaining({\n+          message: 'componentDidMount error',\n+        }),\n+        expect.stringContaining(\n+          'The above error occurred in the <ErrorThrowingComponent> component:',\n+        ),\n+        expect.stringMatching(\n+          new RegExp(\n+            '\\\\s+(in|at) ErrorThrowingComponent (.*)\\n' +\n+              '\\\\s+(in|at) span(.*)\\n' +\n+              '\\\\s+(in|at) div(.*)',\n+          ),\n+        ),\n+        expect.stringContaining(\n+          'Consider adding an error boundary to your tree ' +\n+            'to customize error handling behavior.',\n+        ),\n+      );\n+    } else {\n+      expect(console.error).toHaveBeenCalledWith(\n+        expect.objectContaining({\n+          message: 'componentDidMount error',\n+        }),\n+      );\n+    }\n   });\n \n   it('should ignore errors thrown in log method to prevent cycle', async () => {\n@@ -135,22 +159,34 @@ describe('ReactIncrementalErrorLogging', () => {\n     );\n     await waitForThrow('render error');\n     expect(logCapturedErrorCalls.length).toBe(1);\n-    expect(logCapturedErrorCalls[0]).toEqual(\n-      __DEV__\n-        ? expect.stringMatching(\n-            new RegExp(\n-              'The above error occurred in the <ErrorThrowingComponent> component:\\n' +\n-                '\\\\s+(in|at) ErrorThrowingComponent (.*)\\n' +\n-                '\\\\s+(in|at) span(.*)\\n' +\n-                '\\\\s+(in|at) div(.*)\\n\\n' +\n-                'Consider adding an error boundary to your tree ' +\n-                'to customize error handling behavior\\\\.',\n-            ),\n-          )\n-        : expect.objectContaining({\n-            message: 'render error',\n-          }),\n-    );\n+    if (__DEV__) {\n+      expect(console.error).toHaveBeenCalledWith(\n+        expect.stringContaining('%o'),\n+        expect.objectContaining({\n+          message: 'render error',\n+        }),\n+        expect.stringContaining(\n+          'The above error occurred in the <ErrorThrowingComponent> component:',\n+        ),\n+        expect.stringMatching(\n+          new RegExp(\n+            '\\\\s+(in|at) ErrorThrowingComponent (.*)\\n' +\n+              '\\\\s+(in|at) span(.*)\\n' +\n+              '\\\\s+(in|at) div(.*)',\n+          ),\n+        ),\n+        expect.stringContaining(\n+          'Consider adding an error boundary to your tree ' +\n+            'to customize error handling behavior.',\n+        ),\n+      );\n+    } else {\n+      expect(logCapturedErrorCalls[0]).toEqual(\n+        expect.objectContaining({\n+          message: 'render error',\n+        }),\n+      );\n+    }\n     // The error thrown in logCapturedError should be rethrown with a clean stack\n     expect(() => {\n       jest.runAllTimers();\n@@ -194,31 +230,40 @@ describe('ReactIncrementalErrorLogging', () => {\n         'render: 0',\n \n         'render: 1',\n-        __DEV__ && 'render: 1', // replay due to invokeGuardedCallback\n \n         // Retry one more time before handling error\n         'render: 1',\n-        __DEV__ && 'render: 1', // replay due to invokeGuardedCallback\n \n         'componentWillUnmount: 0',\n       ].filter(Boolean),\n     );\n \n     expect(console.error).toHaveBeenCalledTimes(1);\n-    expect(console.error).toHaveBeenCalledWith(\n-      __DEV__\n-        ? expect.stringMatching(\n-            new RegExp(\n-              'The above error occurred in the <Foo> component:\\n' +\n-                '\\\\s+(in|at) Foo (.*)\\n' +\n-                '\\\\s+(in|at) ErrorBoundary (.*)\\n\\n' +\n-                'React will try to recreate this component tree from scratch ' +\n-                'using the error boundary you provided, ErrorBoundary.',\n-            ),\n-          )\n-        : expect.objectContaining({\n-            message: 'oops',\n-          }),\n-    );\n+    if (__DEV__) {\n+      expect(console.error).toHaveBeenCalledWith(\n+        expect.stringContaining('%o'),\n+        expect.objectContaining({\n+          message: 'oops',\n+        }),\n+        expect.stringContaining(\n+          'The above error occurred in the <Foo> component:',\n+        ),\n+        expect.stringMatching(\n+          new RegExp(\n+            '\\\\s+(in|at) Foo (.*)\\n' + '\\\\s+(in|at) ErrorBoundary(.*)',\n+          ),\n+        ),\n+        expect.stringContaining(\n+          'React will try to recreate this component tree from scratch ' +\n+            'using the error boundary you provided, ErrorBoundary.',\n+        ),\n+      );\n+    } else {\n+      expect(console.error).toHaveBeenCalledWith(\n+        expect.objectContaining({\n+          message: 'oops',\n+        }),\n+      );\n+    }\n   });\n });"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactIncrementalErrorReplay-test.internal.js",
                "git_diff": "@@ -1,43 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- *\n- * @jest-environment node\n- */\n-\n-'use strict';\n-\n-describe('ReactIncrementalErrorReplay-test', () => {\n-  const React = require('react');\n-  const ReactTestRenderer = require('react-test-renderer');\n-\n-  it('copies all keys when stashing potentially failing work', () => {\n-    // Note: this test is fragile and relies on internals.\n-    // We almost always try to avoid such tests, but here the cost of\n-    // the list getting out of sync (and causing subtle bugs in rare cases)\n-    // is higher than the cost of maintaining the test.\n-\n-    // This is the method we're going to test.\n-    // If this is no longer used, you can delete this test file.;\n-    const {assignFiberPropertiesInDEV} = require('../ReactFiber');\n-\n-    // Get a real fiber.\n-    const realFiber = ReactTestRenderer.create(<div />).root._currentFiber();\n-    const stash = assignFiberPropertiesInDEV(null, realFiber);\n-\n-    // Verify we get all the same fields.\n-    expect(realFiber).toEqual(stash);\n-\n-    // Mutate the original.\n-    for (const key in realFiber) {\n-      realFiber[key] = key + '_' + Math.random();\n-    }\n-    expect(realFiber).not.toEqual(stash);\n-\n-    // Verify we can still \"revert\" to the stashed properties.\n-    expect(assignFiberPropertiesInDEV(realFiber, stash)).toBe(realFiber);\n-    expect(realFiber).toEqual(stash);\n-  });\n-});"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactLazy-test.internal.js",
                "git_diff": "@@ -1,7 +1,6 @@\n let React;\n let ReactTestRenderer;\n let Scheduler;\n-let ReactFeatureFlags;\n let Suspense;\n let lazy;\n let waitFor;\n@@ -24,9 +23,6 @@ function normalizeCodeLocInfo(str) {\n describe('ReactLazy', () => {\n   beforeEach(() => {\n     jest.resetModules();\n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     React = require('react');\n     Suspense = React.Suspense;\n     lazy = React.lazy;"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspense-test.internal.js",
                "git_diff": "@@ -1,7 +1,6 @@\n let React;\n let ReactDOMClient;\n let ReactDOM;\n-let ReactFeatureFlags;\n let Scheduler;\n let Suspense;\n let act;\n@@ -16,9 +15,6 @@ let waitFor;\n describe('ReactSuspense', () => {\n   beforeEach(() => {\n     jest.resetModules();\n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     React = require('react');\n     ReactDOM = require('react-dom');\n     ReactDOMClient = require('react-dom/client');"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspenseEffectsSemantics-test.js",
                "git_diff": "@@ -1980,11 +1980,10 @@ describe('ReactSuspenseEffectsSemantics', () => {\n       });\n \n       // @gate enableLegacyCache\n-      // @gate replayFailedUnitOfWorkWithInvokeGuardedCallback\n       it('are properly handled for layout effect creation', async () => {\n         let useLayoutEffectShouldThrow = false;\n \n-        function ThrowsInLayoutEffect() {\n+        function ThrowsInLayoutEffect({unused}) {\n           Scheduler.log('ThrowsInLayoutEffect render');\n           React.useLayoutEffect(() => {\n             Scheduler.log('ThrowsInLayoutEffect useLayoutEffect create');\n@@ -2117,9 +2116,8 @@ describe('ReactSuspenseEffectsSemantics', () => {\n       });\n \n       // @gate enableLegacyCache\n-      // @gate replayFailedUnitOfWorkWithInvokeGuardedCallback\n       it('are properly handled for layout effect destruction', async () => {\n-        function ThrowsInLayoutEffectDestroy() {\n+        function ThrowsInLayoutEffectDestroy({unused}) {\n           Scheduler.log('ThrowsInLayoutEffectDestroy render');\n           React.useLayoutEffect(() => {\n             Scheduler.log('ThrowsInLayoutEffectDestroy useLayoutEffect create');\n@@ -3013,11 +3011,10 @@ describe('ReactSuspenseEffectsSemantics', () => {\n \n     describe('that throw errors', () => {\n       // @gate enableLegacyCache\n-      // @gate replayFailedUnitOfWorkWithInvokeGuardedCallback\n       it('are properly handled in ref callbacks', async () => {\n         let useRefCallbackShouldThrow = false;\n \n-        function ThrowsInRefCallback() {\n+        function ThrowsInRefCallback({unused}) {\n           Scheduler.log('ThrowsInRefCallback render');\n           const refCallback = React.useCallback(value => {\n             Scheduler.log('ThrowsInRefCallback refCallback ref? ' + !!value);"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspenseFuzz-test.internal.js",
                "git_diff": "@@ -3,7 +3,6 @@ let Suspense;\n let ReactNoop;\n let Scheduler;\n let act;\n-let ReactFeatureFlags;\n let Random;\n \n const SEED = process.env.FUZZ_TEST_SEED || 'default';\n@@ -21,9 +20,6 @@ function prettyFormat(thing) {\n describe('ReactSuspenseFuzz', () => {\n   beforeEach(() => {\n     jest.resetModules();\n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     React = require('react');\n     Suspense = React.Suspense;\n     ReactNoop = require('react-noop-renderer');"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspensePlaceholder-test.internal.js",
                "git_diff": "@@ -28,7 +28,6 @@ describe('ReactSuspensePlaceholder', () => {\n     ReactFeatureFlags = require('shared/ReactFeatureFlags');\n \n     ReactFeatureFlags.enableProfilerTimer = true;\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     React = require('react');\n     ReactNoop = require('react-noop-renderer');\n     Scheduler = require('scheduler');"
            },
            {
                "file": "packages/react-reconciler/src/__tests__/ReactSuspenseWithNoopRenderer-test.js",
                "git_diff": "@@ -398,8 +398,6 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n   });\n \n   // Second condition is redundant but guarantees that the test runs in prod.\n-  // TODO: Delete this feature flag.\n-  // @gate !replayFailedUnitOfWorkWithInvokeGuardedCallback || !__DEV__\n   // @gate enableLegacyCache\n   it('retries on error', async () => {\n     class ErrorBoundary extends React.Component {\n@@ -458,8 +456,6 @@ describe('ReactSuspenseWithNoopRenderer', () => {\n   });\n \n   // Second condition is redundant but guarantees that the test runs in prod.\n-  // TODO: Delete this feature flag.\n-  // @gate !replayFailedUnitOfWorkWithInvokeGuardedCallback || !__DEV__\n   // @gate enableLegacyCache\n   it('retries on error after falling back to a placeholder', async () => {\n     class ErrorBoundary extends React.Component {"
            },
            {
                "file": "packages/react-server-dom-webpack/src/__tests__/ReactFlightDOMForm-test.js",
                "git_diff": "@@ -358,14 +358,16 @@ describe('ReactFlightDOMForm', () => {\n \n     const initialState = {count: 1};\n     function Client({action}) {\n-      const [state, dispatch] = useFormState(action, initialState);\n+      const [state, dispatch, isPending] = useFormState(action, initialState);\n       return (\n         <form action={dispatch}>\n+          <span>{isPending ? 'Pending...' : ''}</span>\n           <span>Count: {state.count}</span>\n           <input type=\"text\" name=\"incrementAmount\" defaultValue=\"5\" />\n         </form>\n       );\n     }\n+\n     const ClientRef = await clientExports(Client);\n \n     const rscStream = ReactServerDOMServer.renderToReadableStream(\n@@ -382,8 +384,10 @@ describe('ReactFlightDOMForm', () => {\n     await readIntoContainer(ssrStream);\n \n     const form = container.getElementsByTagName('form')[0];\n-    const span = container.getElementsByTagName('span')[0];\n-    expect(span.textContent).toBe('Count: 1');\n+    const pendingSpan = container.getElementsByTagName('span')[0];\n+    const stateSpan = container.getElementsByTagName('span')[1];\n+    expect(pendingSpan.textContent).toBe('');\n+    expect(stateSpan.textContent).toBe('Count: 1');\n \n     const {returnValue} = await submit(form);\n     expect(await returnValue).toEqual({count: 6});\n@@ -399,8 +403,13 @@ describe('ReactFlightDOMForm', () => {\n     );\n \n     function Form({action}) {\n-      const [count, dispatch] = useFormState(action, 1);\n-      return <form action={dispatch}>{count}</form>;\n+      const [count, dispatch, isPending] = useFormState(action, 1);\n+      return (\n+        <form action={dispatch}>\n+          {isPending ? 'Pending...' : ''}\n+          {count}\n+        </form>\n+      );\n     }\n \n     function Client({action}) {\n@@ -487,8 +496,13 @@ describe('ReactFlightDOMForm', () => {\n       );\n \n       function Form({action}) {\n-        const [count, dispatch] = useFormState(action, 1);\n-        return <form action={dispatch}>{count}</form>;\n+        const [count, dispatch, isPending] = useFormState(action, 1);\n+        return (\n+          <form action={dispatch}>\n+            {isPending ? 'Pending...' : ''}\n+            {count}\n+          </form>\n+        );\n       }\n \n       function Client({action}) {\n@@ -607,8 +621,13 @@ describe('ReactFlightDOMForm', () => {\n     );\n \n     function Form({action}) {\n-      const [count, dispatch] = useFormState(action, 1);\n-      return <form action={dispatch}>{count}</form>;\n+      const [count, dispatch, isPending] = useFormState(action, 1);\n+      return (\n+        <form action={dispatch}>\n+          {isPending ? 'Pending...' : ''}\n+          {count}\n+        </form>\n+      );\n     }\n \n     function Client({action}) {\n@@ -682,8 +701,13 @@ describe('ReactFlightDOMForm', () => {\n     );\n \n     function Form({action, permalink}) {\n-      const [count, dispatch] = useFormState(action, 1, permalink);\n-      return <form action={dispatch}>{count}</form>;\n+      const [count, dispatch, isPending] = useFormState(action, 1, permalink);\n+      return (\n+        <form action={dispatch}>\n+          {isPending ? 'Pending...' : ''}\n+          {count}\n+        </form>\n+      );\n     }\n \n     function Page1({action, permalink}) {\n@@ -783,17 +807,19 @@ describe('ReactFlightDOMForm', () => {\n \n     const initialState = {count: 1};\n     function Client({action}) {\n-      const [state, dispatch] = useFormState(\n+      const [state, dispatch, isPending] = useFormState(\n         action,\n         initialState,\n         '/permalink',\n       );\n       return (\n         <form action={dispatch}>\n+          <span>{isPending ? 'Pending...' : ''}</span>\n           <span>Count: {state.count}</span>\n         </form>\n       );\n     }\n+\n     const ClientRef = await clientExports(Client);\n \n     const rscStream = ReactServerDOMServer.renderToReadableStream(\n@@ -810,8 +836,10 @@ describe('ReactFlightDOMForm', () => {\n     await readIntoContainer(ssrStream);\n \n     const form = container.getElementsByTagName('form')[0];\n-    const span = container.getElementsByTagName('span')[0];\n-    expect(span.textContent).toBe('Count: 1');\n+    const pendingSpan = container.getElementsByTagName('span')[0];\n+    const stateSpan = container.getElementsByTagName('span')[1];\n+    expect(pendingSpan.textContent).toBe('');\n+    expect(stateSpan.textContent).toBe('Count: 1');\n \n     expect(form.action).toBe('http://localhost/permalink');\n   });\n@@ -833,13 +861,19 @@ describe('ReactFlightDOMForm', () => {\n \n     const initialState = {count: 1};\n     function Client({action}) {\n-      const [state, dispatch] = useFormState(action, initialState, permalink);\n+      const [state, dispatch, isPending] = useFormState(\n+        action,\n+        initialState,\n+        permalink,\n+      );\n       return (\n         <form action={dispatch}>\n+          <span>{isPending ? 'Pending...' : ''}</span>\n           <span>Count: {state.count}</span>\n         </form>\n       );\n     }\n+\n     const ClientRef = await clientExports(Client);\n \n     const rscStream = ReactServerDOMServer.renderToReadableStream(\n@@ -856,8 +890,10 @@ describe('ReactFlightDOMForm', () => {\n     await readIntoContainer(ssrStream);\n \n     const form = container.getElementsByTagName('form')[0];\n-    const span = container.getElementsByTagName('span')[0];\n-    expect(span.textContent).toBe('Count: 1');\n+    const pendingSpan = container.getElementsByTagName('span')[0];\n+    const stateSpan = container.getElementsByTagName('span')[1];\n+    expect(pendingSpan.textContent).toBe('');\n+    expect(stateSpan.textContent).toBe('Count: 1');\n \n     expect(form.action).toBe('http://localhost/permalink');\n   });"
            },
            {
                "file": "packages/react-server/src/ReactFizzHooks.js",
                "git_diff": "@@ -615,7 +615,7 @@ function useFormState<S, P>(\n   action: (Awaited<S>, P) => S,\n   initialState: Awaited<S>,\n   permalink?: string,\n-): [Awaited<S>, (P) => void] {\n+): [Awaited<S>, (P) => void, boolean] {\n   resolveCurrentlyRenderingComponent();\n \n   // Count the number of useFormState hooks per component. We also use this to\n@@ -708,7 +708,7 @@ function useFormState<S, P>(\n       };\n     }\n \n-    return [state, dispatch];\n+    return [state, dispatch, false];\n   } else {\n     // This is not a server action, so the implementation is much simpler.\n \n@@ -718,7 +718,7 @@ function useFormState<S, P>(\n     const dispatch = (payload: P): void => {\n       boundAction(payload);\n     };\n-    return [initialState, dispatch];\n+    return [initialState, dispatch, false];\n   }\n }\n "
            },
            {
                "file": "packages/react-test-renderer/src/__tests__/ReactTestRenderer-test.internal.js",
                "git_diff": "@@ -11,7 +11,6 @@\n 'use strict';\n \n const ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n const React = require('react');\n const ReactTestRenderer = require('react-test-renderer');\n const {format: prettyFormat} = require('pretty-format');"
            },
            {
                "file": "packages/react/src/__tests__/ReactCoffeeScriptClass-test.coffee",
                "git_diff": "@@ -55,9 +55,7 @@ describe 'ReactCoffeeScriptClass', ->\n           root.render React.createElement(Foo)\n       ).toThrow()\n     ).toErrorDev([\n-      # A failed component renders four times in DEV in concurrent mode\n-      'No `render` method found on the Foo instance',\n-      'No `render` method found on the Foo instance',\n+      # A failed component renders twice in DEV in concurrent mode\n       'No `render` method found on the Foo instance',\n       'No `render` method found on the Foo instance',\n     ])"
            },
            {
                "file": "packages/react/src/__tests__/ReactES6Class-test.js",
                "git_diff": "@@ -63,11 +63,7 @@ describe('ReactES6Class', () => {\n     expect(() => {\n       expect(() => ReactDOM.flushSync(() => root.render(<Foo />))).toThrow();\n     }).toErrorDev([\n-      // A failed component renders four times in DEV in concurrent mode\n-      'Warning: No `render` method found on the Foo instance: ' +\n-        'you may have forgotten to define `render`.',\n-      'Warning: No `render` method found on the Foo instance: ' +\n-        'you may have forgotten to define `render`.',\n+      // A failed component renders twice in DEV in concurrent mode\n       'Warning: No `render` method found on the Foo instance: ' +\n         'you may have forgotten to define `render`.',\n       'Warning: No `render` method found on the Foo instance: ' +"
            },
            {
                "file": "packages/react/src/__tests__/ReactElementValidator-test.internal.js",
                "git_diff": "@@ -19,16 +19,12 @@ let React;\n let ReactDOMClient;\n let act;\n \n-let ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-\n describe('ReactElementValidator', () => {\n   let ComponentClass;\n \n   beforeEach(() => {\n     jest.resetModules();\n \n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     React = require('react');\n     ReactDOMClient = require('react-dom/client');\n     act = require('internal-test-utils').act;"
            },
            {
                "file": "packages/react/src/__tests__/ReactProfiler-test.internal.js",
                "git_diff": "@@ -25,16 +25,13 @@ function loadModules({\n   enableProfilerTimer = true,\n   enableProfilerCommitHooks = true,\n   enableProfilerNestedUpdatePhase = true,\n-  replayFailedUnitOfWorkWithInvokeGuardedCallback = false,\n } = {}) {\n   ReactFeatureFlags = require('shared/ReactFeatureFlags');\n \n   ReactFeatureFlags.enableProfilerTimer = enableProfilerTimer;\n   ReactFeatureFlags.enableProfilerCommitHooks = enableProfilerCommitHooks;\n   ReactFeatureFlags.enableProfilerNestedUpdatePhase =\n     enableProfilerNestedUpdatePhase;\n-  ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback =\n-    replayFailedUnitOfWorkWithInvokeGuardedCallback;\n \n   React = require('react');\n   Scheduler = require('scheduler');\n@@ -1015,205 +1012,170 @@ describe(`onRender`, () => {\n       expect(call[5]).toBe(380); // commit time\n     });\n \n-    [true, false].forEach(replayFailedUnitOfWorkWithInvokeGuardedCallback => {\n-      describe(`replayFailedUnitOfWorkWithInvokeGuardedCallback ${\n-        replayFailedUnitOfWorkWithInvokeGuardedCallback ? 'enabled' : 'disabled'\n-      }`, () => {\n-        beforeEach(() => {\n-          jest.resetModules();\n-\n-          loadModules({\n-            replayFailedUnitOfWorkWithInvokeGuardedCallback,\n-          });\n-        });\n-\n-        it('should accumulate actual time after an error handled by componentDidCatch()', async () => {\n-          const callback = jest.fn();\n-\n-          const ThrowsError = ({unused}) => {\n-            Scheduler.unstable_advanceTime(3);\n-            throw Error('expected error');\n-          };\n-\n-          class ErrorBoundary extends React.Component {\n-            state = {error: null};\n-            componentDidCatch(error) {\n-              this.setState({error});\n-            }\n-            render() {\n-              Scheduler.unstable_advanceTime(2);\n-              return this.state.error === null ? (\n-                this.props.children\n-              ) : (\n-                <AdvanceTime byAmount={20} />\n-              );\n-            }\n-          }\n+    it('should accumulate actual time after an error handled by componentDidCatch()', async () => {\n+      const callback = jest.fn();\n \n-          Scheduler.unstable_advanceTime(5); // 0 -> 5\n-\n-          await act(() => {\n-            ReactNoop.render(\n-              <React.Profiler id=\"test\" onRender={callback}>\n-                <ErrorBoundary>\n-                  <AdvanceTime byAmount={9} />\n-                  <ThrowsError />\n-                </ErrorBoundary>\n-              </React.Profiler>,\n-            );\n-          });\n-\n-          expect(callback).toHaveBeenCalledTimes(2);\n-\n-          // Callbacks bubble (reverse order).\n-          const [mountCall, updateCall] = callback.mock.calls;\n-\n-          // The initial mount only includes the ErrorBoundary (which takes 2)\n-          // But it spends time rendering all of the failed subtree also.\n-          expect(mountCall[1]).toBe('mount');\n-          // actual time includes: 2 (ErrorBoundary) + 9 (AdvanceTime) + 3 (ThrowsError)\n-          // We don't count the time spent in replaying the failed unit of work (ThrowsError)\n-          expect(mountCall[2]).toBe(14);\n-          // base time includes: 2 (ErrorBoundary)\n-          // Since the tree is empty for the initial commit\n-          expect(mountCall[3]).toBe(2);\n-          // start time: 5 initially + 14 of work\n-          // Add an additional 3 (ThrowsError) if we replayed the failed work\n-          expect(mountCall[4]).toBe(\n-            __DEV__ && replayFailedUnitOfWorkWithInvokeGuardedCallback\n-              ? 22\n-              : 19,\n-          );\n-          // commit time: 19 initially + 14 of work\n-          // Add an additional 6 (ThrowsError *2) if we replayed the failed work\n-          expect(mountCall[5]).toBe(\n-            __DEV__ && replayFailedUnitOfWorkWithInvokeGuardedCallback\n-              ? 39\n-              : 33,\n-          );\n+      const ThrowsError = ({unused}) => {\n+        Scheduler.unstable_advanceTime(3);\n+        throw Error('expected error');\n+      };\n \n-          // The update includes the ErrorBoundary and its fallback child\n-          expect(updateCall[1]).toBe('nested-update');\n-          // actual time includes: 2 (ErrorBoundary) + 20 (AdvanceTime)\n-          expect(updateCall[2]).toBe(22);\n-          // base time includes: 2 (ErrorBoundary) + 20 (AdvanceTime)\n-          expect(updateCall[3]).toBe(22);\n-          // start time\n-          expect(updateCall[4]).toBe(\n-            __DEV__ && replayFailedUnitOfWorkWithInvokeGuardedCallback\n-              ? 39\n-              : 33,\n-          );\n-          // commit time: 33 (startTime) + 2 (ErrorBoundary) + 20 (AdvanceTime)\n-          // Add an additional 6 (ThrowsError *2) if we replayed the failed work\n-          expect(updateCall[5]).toBe(\n-            __DEV__ && replayFailedUnitOfWorkWithInvokeGuardedCallback\n-              ? 61\n-              : 55,\n+      class ErrorBoundary extends React.Component {\n+        state = {error: null};\n+        componentDidCatch(error) {\n+          this.setState({error});\n+        }\n+        render() {\n+          Scheduler.unstable_advanceTime(2);\n+          return this.state.error === null ? (\n+            this.props.children\n+          ) : (\n+            <AdvanceTime byAmount={20} />\n           );\n-        });\n-\n-        it('should accumulate actual time after an error handled by getDerivedStateFromError()', async () => {\n-          const callback = jest.fn();\n-\n-          const ThrowsError = ({unused}) => {\n-            Scheduler.unstable_advanceTime(10);\n-            throw Error('expected error');\n-          };\n-\n-          class ErrorBoundary extends React.Component {\n-            state = {error: null};\n-            static getDerivedStateFromError(error) {\n-              return {error};\n-            }\n-            render() {\n-              Scheduler.unstable_advanceTime(2);\n-              return this.state.error === null ? (\n-                this.props.children\n-              ) : (\n-                <AdvanceTime byAmount={20} />\n-              );\n-            }\n-          }\n+        }\n+      }\n \n-          Scheduler.unstable_advanceTime(5); // 0 -> 5\n-\n-          await act(() => {\n-            ReactNoop.render(\n-              <React.Profiler id=\"test\" onRender={callback}>\n-                <ErrorBoundary>\n-                  <AdvanceTime byAmount={5} />\n-                  <ThrowsError />\n-                </ErrorBoundary>\n-              </React.Profiler>,\n-            );\n-          });\n-\n-          expect(callback).toHaveBeenCalledTimes(1);\n-\n-          // Callbacks bubble (reverse order).\n-          const [mountCall] = callback.mock.calls;\n-\n-          // The initial mount includes the ErrorBoundary's error state,\n-          // But it also spends actual time rendering UI that fails and isn't included.\n-          expect(mountCall[1]).toBe('mount');\n-          // actual time includes: 2 (ErrorBoundary) + 5 (AdvanceTime) + 10 (ThrowsError)\n-          // Then the re-render: 2 (ErrorBoundary) + 20 (AdvanceTime)\n-          // We don't count the time spent in replaying the failed unit of work (ThrowsError)\n-          expect(mountCall[2]).toBe(39);\n-          // base time includes: 2 (ErrorBoundary) + 20 (AdvanceTime)\n-          expect(mountCall[3]).toBe(22);\n-          // start time\n-          expect(mountCall[4]).toBe(\n-            __DEV__ && replayFailedUnitOfWorkWithInvokeGuardedCallback\n-              ? 54\n-              : 44,\n-          );\n-          // commit time\n-          expect(mountCall[5]).toBe(\n-            __DEV__ && replayFailedUnitOfWorkWithInvokeGuardedCallback\n-              ? 103\n-              : 83,\n-          );\n-        });\n+      Scheduler.unstable_advanceTime(5); // 0 -> 5\n+\n+      const root = ReactNoop.createRoot();\n+      await act(() => {\n+        root.render(\n+          <React.Profiler id=\"test\" onRender={callback}>\n+            <ErrorBoundary>\n+              <AdvanceTime byAmount={9} />\n+              <ThrowsError />\n+            </ErrorBoundary>\n+          </React.Profiler>,\n+        );\n+      });\n \n-        it('should reset the fiber stack correct after a \"complete\" phase error', async () => {\n-          jest.resetModules();\n+      expect(callback).toHaveBeenCalledTimes(2);\n \n-          loadModules({\n-            replayFailedUnitOfWorkWithInvokeGuardedCallback,\n-          });\n+      // Callbacks bubble (reverse order).\n+      const [mountCall, updateCall] = callback.mock.calls;\n+\n+      // The initial mount only includes the ErrorBoundary (which takes 2)\n+      // But it spends time rendering all of the failed subtree also.\n+      expect(mountCall[1]).toBe('mount');\n+      // actual time includes: 2 (ErrorBoundary) + 9 (AdvanceTime) + 3 (ThrowsError)\n+      // We don't count the time spent in replaying the failed unit of work (ThrowsError)\n+      expect(mountCall[2]).toBe(14);\n+      // base time includes: 2 (ErrorBoundary)\n+      // Since the tree is empty for the initial commit\n+      expect(mountCall[3]).toBe(2);\n+\n+      // start time: 5 initially + 14 of work\n+      // Add an additional 3 (ThrowsError) if we replayed the failed work\n+      expect(mountCall[4]).toBe(19);\n+      // commit time: 19 initially + 14 of work\n+      // Add an additional 6 (ThrowsError *2) if we replayed the failed work\n+      expect(mountCall[5]).toBe(33);\n+\n+      // The update includes the ErrorBoundary and its fallback child\n+      expect(updateCall[1]).toBe('nested-update');\n+      // actual time includes: 2 (ErrorBoundary) + 20 (AdvanceTime)\n+      expect(updateCall[2]).toBe(22);\n+      // base time includes: 2 (ErrorBoundary) + 20 (AdvanceTime)\n+      expect(updateCall[3]).toBe(22);\n+      // start time\n+      expect(updateCall[4]).toBe(33);\n+      // commit time: 19 (startTime) + 2 (ErrorBoundary) + 20 (AdvanceTime)\n+      // Add an additional 3 (ThrowsError) if we replayed the failed work\n+      expect(updateCall[5]).toBe(55);\n+    });\n \n-          // Simulate a renderer error during the \"complete\" phase.\n-          // This mimics behavior like React Native's View/Text nesting validation.\n-          ReactNoop.render(\n-            <React.Profiler id=\"profiler\" onRender={jest.fn()}>\n-              <errorInCompletePhase>hi</errorInCompletePhase>\n-            </React.Profiler>,\n-          );\n-          await waitForThrow('Error in host config.');\n-\n-          // A similar case we've seen caused by an invariant in ReactDOM.\n-          // It didn't reproduce without a host component inside.\n-          ReactNoop.render(\n-            <React.Profiler id=\"profiler\" onRender={jest.fn()}>\n-              <errorInCompletePhase>\n-                <span>hi</span>\n-              </errorInCompletePhase>\n-            </React.Profiler>,\n-          );\n-          await waitForThrow('Error in host config.');\n-\n-          // So long as the profiler timer's fiber stack is reset correctly,\n-          // Subsequent renders should not error.\n-          ReactNoop.render(\n-            <React.Profiler id=\"profiler\" onRender={jest.fn()}>\n-              <span>hi</span>\n-            </React.Profiler>,\n+    it('should accumulate actual time after an error handled by getDerivedStateFromError()', async () => {\n+      const callback = jest.fn();\n+\n+      const ThrowsError = ({unused}) => {\n+        Scheduler.unstable_advanceTime(10);\n+        throw Error('expected error');\n+      };\n+\n+      class ErrorBoundary extends React.Component {\n+        state = {error: null};\n+        static getDerivedStateFromError(error) {\n+          return {error};\n+        }\n+        render() {\n+          Scheduler.unstable_advanceTime(2);\n+          return this.state.error === null ? (\n+            this.props.children\n+          ) : (\n+            <AdvanceTime byAmount={20} />\n           );\n-          await waitForAll([]);\n-        });\n+        }\n+      }\n+\n+      Scheduler.unstable_advanceTime(5); // 0 -> 5\n+\n+      await act(() => {\n+        const root = ReactNoop.createRoot();\n+        root.render(\n+          <React.Profiler id=\"test\" onRender={callback}>\n+            <ErrorBoundary>\n+              <AdvanceTime byAmount={5} />\n+              <ThrowsError />\n+            </ErrorBoundary>\n+          </React.Profiler>,\n+        );\n       });\n+\n+      expect(callback).toHaveBeenCalledTimes(1);\n+\n+      // Callbacks bubble (reverse order).\n+      const [mountCall] = callback.mock.calls;\n+\n+      // The initial mount includes the ErrorBoundary's error state,\n+      // But it also spends actual time rendering UI that fails and isn't included.\n+      expect(mountCall[1]).toBe('mount');\n+      // actual time includes: 2 (ErrorBoundary) + 5 (AdvanceTime) + 10 (ThrowsError)\n+      // Then the re-render: 2 (ErrorBoundary) + 20 (AdvanceTime)\n+      // We don't count the time spent in replaying the failed unit of work (ThrowsError)\n+      expect(mountCall[2]).toBe(39);\n+      // base time includes: 2 (ErrorBoundary) + 20 (AdvanceTime)\n+      expect(mountCall[3]).toBe(22);\n+      // start time\n+      expect(mountCall[4]).toBe(44);\n+      // commit time\n+      expect(mountCall[5]).toBe(83);\n+    });\n+\n+    it('should reset the fiber stack correct after a \"complete\" phase error', async () => {\n+      jest.resetModules();\n+\n+      loadModules({\n+        useNoopRenderer: true,\n+      });\n+\n+      // Simulate a renderer error during the \"complete\" phase.\n+      // This mimics behavior like React Native's View/Text nesting validation.\n+      ReactNoop.render(\n+        <React.Profiler id=\"profiler\" onRender={jest.fn()}>\n+          <errorInCompletePhase>hi</errorInCompletePhase>\n+        </React.Profiler>,\n+      );\n+      await waitForThrow('Error in host config.');\n+\n+      // A similar case we've seen caused by an invariant in ReactDOM.\n+      // It didn't reproduce without a host component inside.\n+      ReactNoop.render(\n+        <React.Profiler id=\"profiler\" onRender={jest.fn()}>\n+          <errorInCompletePhase>\n+            <span>hi</span>\n+          </errorInCompletePhase>\n+        </React.Profiler>,\n+      );\n+      await waitForThrow('Error in host config.');\n+\n+      // So long as the profiler timer's fiber stack is reset correctly,\n+      // Subsequent renders should not error.\n+      ReactNoop.render(\n+        <React.Profiler id=\"profiler\" onRender={jest.fn()}>\n+          <span>hi</span>\n+        </React.Profiler>,\n+      );\n+      await waitForAll([]);\n     });\n   });\n "
            },
            {
                "file": "packages/react/src/__tests__/ReactTypeScriptClass-test.ts",
                "git_diff": "@@ -332,11 +332,7 @@ describe('ReactTypeScriptClass', function() {\n         ReactDOM.flushSync(() => root.render(React.createElement(Empty)))\n       ).toThrow();\n     }).toErrorDev([\n-      // A failed component renders four times in DEV in concurrent mode\n-      'Warning: No `render` method found on the Empty instance: ' +\n-        'you may have forgotten to define `render`.',\n-      'Warning: No `render` method found on the Empty instance: ' +\n-        'you may have forgotten to define `render`.',\n+      // A failed component renders twice in DEV in concurrent mode\n       'Warning: No `render` method found on the Empty instance: ' +\n         'you may have forgotten to define `render`.',\n       'Warning: No `render` method found on the Empty instance: ' +"
            },
            {
                "file": "packages/react/src/__tests__/forwardRef-test.internal.js",
                "git_diff": "@@ -11,16 +11,13 @@\n \n describe('forwardRef', () => {\n   let React;\n-  let ReactFeatureFlags;\n   let ReactNoop;\n   let Scheduler;\n   let waitForAll;\n \n   beforeEach(() => {\n     jest.resetModules();\n-    ReactFeatureFlags = require('shared/ReactFeatureFlags');\n \n-    ReactFeatureFlags.replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n     React = require('react');\n     ReactNoop = require('react-noop-renderer');\n     Scheduler = require('scheduler');"
            },
            {
                "file": "packages/shared/ReactErrorUtils.js",
                "git_diff": "@@ -1,125 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- *\n- * @flow\n- */\n-\n-import invokeGuardedCallbackImpl from './invokeGuardedCallbackImpl';\n-\n-// Used by Fiber to simulate a try-catch.\n-let hasError: boolean = false;\n-let caughtError: mixed = null;\n-\n-// Used by event system to capture/rethrow the first error.\n-let hasRethrowError: boolean = false;\n-let rethrowError: mixed = null;\n-\n-const reporter = {\n-  onError(error: mixed) {\n-    hasError = true;\n-    caughtError = error;\n-  },\n-};\n-\n-/**\n- * Call a function while guarding against errors that happens within it.\n- * Returns an error if it throws, otherwise null.\n- *\n- * In production, this is implemented using a try-catch. The reason we don't\n- * use a try-catch directly is so that we can swap out a different\n- * implementation in DEV mode.\n- *\n- * @param {String} name of the guard to use for logging or debugging\n- * @param {Function} func The function to invoke\n- * @param {*} context The context to use when calling the function\n- * @param {...*} args Arguments for function\n- */\n-export function invokeGuardedCallback<A, B, C, D, E, F, Context>(\n-  name: string | null,\n-  func: (a: A, b: B, c: C, d: D, e: E, f: F) => mixed,\n-  context: Context,\n-  a: A,\n-  b: B,\n-  c: C,\n-  d: D,\n-  e: E,\n-  f: F,\n-): void {\n-  hasError = false;\n-  caughtError = null;\n-  invokeGuardedCallbackImpl.apply(reporter, arguments);\n-}\n-\n-/**\n- * Same as invokeGuardedCallback, but instead of returning an error, it stores\n- * it in a global so it can be rethrown by `rethrowCaughtError` later.\n- * TODO: See if caughtError and rethrowError can be unified.\n- *\n- * @param {String} name of the guard to use for logging or debugging\n- * @param {Function} func The function to invoke\n- * @param {*} context The context to use when calling the function\n- * @param {...*} args Arguments for function\n- */\n-export function invokeGuardedCallbackAndCatchFirstError<\n-  A,\n-  B,\n-  C,\n-  D,\n-  E,\n-  F,\n-  Context,\n->(\n-  this: mixed,\n-  name: string | null,\n-  func: (a: A, b: B, c: C, d: D, e: E, f: F) => void,\n-  context: Context,\n-  a: A,\n-  b: B,\n-  c: C,\n-  d: D,\n-  e: E,\n-  f: F,\n-): void {\n-  invokeGuardedCallback.apply(this, arguments);\n-  if (hasError) {\n-    const error = clearCaughtError();\n-    if (!hasRethrowError) {\n-      hasRethrowError = true;\n-      rethrowError = error;\n-    }\n-  }\n-}\n-\n-/**\n- * During execution of guarded functions we will capture the first error which\n- * we will rethrow to be handled by the top level error handler.\n- */\n-export function rethrowCaughtError() {\n-  if (hasRethrowError) {\n-    const error = rethrowError;\n-    hasRethrowError = false;\n-    rethrowError = null;\n-    throw error;\n-  }\n-}\n-\n-export function hasCaughtError(): boolean {\n-  return hasError;\n-}\n-\n-export function clearCaughtError(): mixed {\n-  if (hasError) {\n-    const error = caughtError;\n-    hasError = false;\n-    caughtError = null;\n-    return error;\n-  } else {\n-    throw new Error(\n-      'clearCaughtError was called but no error was captured. This error ' +\n-        'is likely caused by a bug in React. Please file an issue.',\n-    );\n-  }\n-}"
            },
            {
                "file": "packages/shared/ReactFeatureFlags.js",
                "git_diff": "@@ -115,8 +115,6 @@ export const enableFizzExternalRuntime = true;\n \n export const alwaysThrottleRetries = true;\n \n-export const useMicrotasksForSchedulingInFabric = false;\n-\n export const passChildrenWhenCloningPersistedNodes = false;\n \n export const enableUseDeferredValueInitialArg = __EXPERIMENTAL__;\n@@ -140,8 +138,8 @@ export const transitionLaneExpirationMs = 5000;\n // -----------------------------------------------------------------------------\n const __NEXT_MAJOR__ = __EXPERIMENTAL__;\n \n-// Not ready to break experimental yet.\n-export const disableLegacyContext = false;\n+// Removes legacy style context\n+export const disableLegacyContext = __NEXT_MAJOR__;\n \n // Not ready to break experimental yet.\n // Disable javascript: URL strings in href for XSS protection.\n@@ -200,6 +198,13 @@ export const enableReactTestRendererWarning = false;\n // before removing them in stable in the next Major\n export const disableLegacyMode = __NEXT_MAJOR__;\n \n+// HTML boolean attributes need a special PropertyInfoRecord.\n+// Between support of these attributes in browsers and React supporting them as\n+// boolean props library users can use them as `<div someBooleanAttribute=\"\" />`.\n+// However, once React considers them as boolean props an empty string will\n+// result in false property i.e. break existing usage.\n+export const enableNewBooleanProps = __NEXT_MAJOR__;\n+\n // -----------------------------------------------------------------------------\n // Chopping Block\n //\n@@ -251,10 +256,6 @@ export const enableSchedulingProfiler = __PROFILE__;\n // reducers by double invoking them in StrictLegacyMode.\n export const debugRenderPhaseSideEffectsForStrictMode = __DEV__;\n \n-// To preserve the \"Pause on caught exceptions\" behavior of the debugger, we\n-// replay the begin phase of a failed component inside invokeGuardedCallback.\n-export const replayFailedUnitOfWorkWithInvokeGuardedCallback = __DEV__;\n-\n // Gather advanced timing metrics for Profiler subtrees.\n export const enableProfilerTimer = __PROFILE__;\n "
            },
            {
                "file": "packages/shared/__tests__/ReactErrorUtils-test.internal.js",
                "git_diff": "@@ -1,210 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- *\n- * @emails react-core\n- */\n-\n-'use strict';\n-\n-let ReactErrorUtils;\n-\n-describe('ReactErrorUtils', () => {\n-  beforeEach(() => {\n-    // TODO: can we express this test with only public API?\n-    ReactErrorUtils = require('shared/ReactErrorUtils');\n-  });\n-\n-  it(`it should rethrow caught errors`, () => {\n-    const err = new Error('foo');\n-    const callback = function () {\n-      throw err;\n-    };\n-    ReactErrorUtils.invokeGuardedCallbackAndCatchFirstError(\n-      'foo',\n-      callback,\n-      null,\n-    );\n-    expect(ReactErrorUtils.hasCaughtError()).toBe(false);\n-    expect(() => ReactErrorUtils.rethrowCaughtError()).toThrow(err);\n-  });\n-\n-  it(`should call the callback the passed arguments`, () => {\n-    const callback = jest.fn();\n-    ReactErrorUtils.invokeGuardedCallback(\n-      'foo',\n-      callback,\n-      null,\n-      'arg1',\n-      'arg2',\n-    );\n-    expect(callback).toBeCalledWith('arg1', 'arg2');\n-  });\n-\n-  it(`should call the callback with the provided context`, () => {\n-    const context = {didCall: false};\n-    ReactErrorUtils.invokeGuardedCallback(\n-      'foo',\n-      function () {\n-        this.didCall = true;\n-      },\n-      context,\n-    );\n-    expect(context.didCall).toBe(true);\n-  });\n-\n-  it(`should catch errors`, () => {\n-    const error = new Error();\n-    const returnValue = ReactErrorUtils.invokeGuardedCallback(\n-      'foo',\n-      function () {\n-        throw error;\n-      },\n-      null,\n-      'arg1',\n-      'arg2',\n-    );\n-    expect(returnValue).toBe(undefined);\n-    expect(ReactErrorUtils.hasCaughtError()).toBe(true);\n-    expect(ReactErrorUtils.clearCaughtError()).toBe(error);\n-  });\n-\n-  it(`should return false from clearCaughtError if no error was thrown`, () => {\n-    const callback = jest.fn();\n-    ReactErrorUtils.invokeGuardedCallback('foo', callback, null);\n-    expect(ReactErrorUtils.hasCaughtError()).toBe(false);\n-    expect(ReactErrorUtils.clearCaughtError).toThrow('no error was captured');\n-  });\n-\n-  it(`can nest with same debug name`, () => {\n-    const err1 = new Error();\n-    let err2;\n-    const err3 = new Error();\n-    ReactErrorUtils.invokeGuardedCallback(\n-      'foo',\n-      function () {\n-        ReactErrorUtils.invokeGuardedCallback(\n-          'foo',\n-          function () {\n-            throw err1;\n-          },\n-          null,\n-        );\n-        err2 = ReactErrorUtils.clearCaughtError();\n-        throw err3;\n-      },\n-      null,\n-    );\n-    const err4 = ReactErrorUtils.clearCaughtError();\n-\n-    expect(err2).toBe(err1);\n-    expect(err4).toBe(err3);\n-  });\n-\n-  it(`handles nested errors`, () => {\n-    const err1 = new Error();\n-    let err2;\n-    ReactErrorUtils.invokeGuardedCallback(\n-      'foo',\n-      function () {\n-        ReactErrorUtils.invokeGuardedCallback(\n-          'foo',\n-          function () {\n-            throw err1;\n-          },\n-          null,\n-        );\n-        err2 = ReactErrorUtils.clearCaughtError();\n-      },\n-      null,\n-    );\n-    // Returns null because inner error was already captured\n-    expect(ReactErrorUtils.hasCaughtError()).toBe(false);\n-\n-    expect(err2).toBe(err1);\n-  });\n-\n-  it('handles nested errors in separate renderers', () => {\n-    const ReactErrorUtils1 = require('shared/ReactErrorUtils');\n-    jest.resetModules();\n-    const ReactErrorUtils2 = require('shared/ReactErrorUtils');\n-    expect(ReactErrorUtils1).not.toEqual(ReactErrorUtils2);\n-\n-    const ops = [];\n-\n-    ReactErrorUtils1.invokeGuardedCallback(\n-      null,\n-      () => {\n-        ReactErrorUtils2.invokeGuardedCallback(\n-          null,\n-          () => {\n-            throw new Error('nested error');\n-          },\n-          null,\n-        );\n-        // ReactErrorUtils2 should catch the error\n-        ops.push(ReactErrorUtils2.hasCaughtError());\n-        ops.push(ReactErrorUtils2.clearCaughtError().message);\n-      },\n-      null,\n-    );\n-\n-    // ReactErrorUtils1 should not catch the error\n-    ops.push(ReactErrorUtils1.hasCaughtError());\n-\n-    expect(ops).toEqual([true, 'nested error', false]);\n-  });\n-\n-  if (!__DEV__) {\n-    // jsdom doesn't handle this properly, but Chrome and Firefox should. Test\n-    // this with a fixture.\n-    it('catches null values', () => {\n-      ReactErrorUtils.invokeGuardedCallback(\n-        null,\n-        function () {\n-          throw null; // eslint-disable-line no-throw-literal\n-        },\n-        null,\n-      );\n-      expect(ReactErrorUtils.hasCaughtError()).toBe(true);\n-      expect(ReactErrorUtils.clearCaughtError()).toBe(null);\n-    });\n-  }\n-\n-  it(`can be shimmed`, () => {\n-    const ops = [];\n-    jest.resetModules();\n-    jest.mock(\n-      'shared/invokeGuardedCallbackImpl',\n-      () =>\n-        function invokeGuardedCallback(name, func, context, a) {\n-          ops.push(a);\n-          try {\n-            func.call(context, a);\n-          } catch (error) {\n-            this.onError(error);\n-          }\n-        },\n-    );\n-    ReactErrorUtils = require('shared/ReactErrorUtils');\n-\n-    try {\n-      const err = new Error('foo');\n-      const callback = function () {\n-        throw err;\n-      };\n-      ReactErrorUtils.invokeGuardedCallbackAndCatchFirstError(\n-        'foo',\n-        callback,\n-        null,\n-        'somearg',\n-      );\n-      expect(() => ReactErrorUtils.rethrowCaughtError()).toThrow(err);\n-      expect(ops).toEqual(['somearg']);\n-    } finally {\n-      jest.unmock('shared/invokeGuardedCallbackImpl');\n-    }\n-  });\n-});"
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.native-fb-dynamic.js",
                "git_diff": "@@ -30,7 +30,6 @@ export const enableRenderableContext = __VARIANT__;\n export const enableUnifiedSyncLane = __VARIANT__;\n export const enableUseRefAccessWarning = __VARIANT__;\n export const passChildrenWhenCloningPersistedNodes = __VARIANT__;\n-export const useMicrotasksForSchedulingInFabric = __VARIANT__;\n export const useModernStrictMode = __VARIANT__;\n \n // Flow magic to verify the exports of this file match the original version."
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.native-fb.js",
                "git_diff": "@@ -28,7 +28,6 @@ export const {\n   enableUnifiedSyncLane,\n   enableUseRefAccessWarning,\n   passChildrenWhenCloningPersistedNodes,\n-  useMicrotasksForSchedulingInFabric,\n   useModernStrictMode,\n } = dynamicFlags;\n \n@@ -54,7 +53,6 @@ export const disableJavaScriptURLs = true;\n export const disableCommentsAsDOMContainers = true;\n export const disableInputAttributeSyncing = false;\n export const disableIEWorkarounds = true;\n-export const replayFailedUnitOfWorkWithInvokeGuardedCallback = __DEV__;\n export const enableScopeAPI = false;\n export const enableCreateEventHandleAPI = false;\n export const enableSuspenseCallback = false;\n@@ -82,6 +80,7 @@ export const enableLegacyHidden = false;\n export const forceConcurrentByDefaultForTesting = false;\n export const allowConcurrentByDefault = false;\n export const enableCustomElementPropertySupport = true;\n+export const enableNewBooleanProps = true;\n \n export const enableTransitionTracing = false;\n "
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.native-oss.js",
                "git_diff": "@@ -10,16 +10,22 @@\n import typeof * as FeatureFlagsType from 'shared/ReactFeatureFlags';\n import typeof * as ExportsType from './ReactFeatureFlags.native-oss';\n \n+// -----------------------------------------------------------------------------\n+// Ready for next major.\n+//\n+// Alias __NEXT_MAJOR__ to false for easier skimming.\n+// -----------------------------------------------------------------------------\n+const __NEXT_MAJOR__ = false;\n+\n export const debugRenderPhaseSideEffectsForStrictMode = __DEV__;\n export const enableDebugTracing = false;\n export const enableAsyncDebugInfo = false;\n export const enableSchedulingProfiler = false;\n-export const replayFailedUnitOfWorkWithInvokeGuardedCallback = __DEV__;\n export const enableProfilerTimer = __PROFILE__;\n export const enableProfilerCommitHooks = __PROFILE__;\n export const enableProfilerNestedUpdatePhase = __PROFILE__;\n export const enableUpdaterTracking = __PROFILE__;\n-export const enableCache = true;\n+export const enableCache = __NEXT_MAJOR__;\n export const enableLegacyCache = false;\n export const enableCacheElement = true;\n export const enableFetchInstrumentation = false;\n@@ -64,6 +70,7 @@ export const forceConcurrentByDefaultForTesting = false;\n export const enableUnifiedSyncLane = true;\n export const allowConcurrentByDefault = false;\n export const enableCustomElementPropertySupport = true;\n+export const enableNewBooleanProps = true;\n \n export const consoleManagedByDevToolsDuringStrictMode = false;\n \n@@ -81,7 +88,6 @@ export const enableAsyncActions = false;\n \n export const alwaysThrottleRetries = false;\n \n-export const useMicrotasksForSchedulingInFabric = false;\n export const passChildrenWhenCloningPersistedNodes = false;\n export const enableUseDeferredValueInitialArg = __EXPERIMENTAL__;\n export const disableClientCache = true;"
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.test-renderer.js",
                "git_diff": "@@ -14,7 +14,6 @@ export const debugRenderPhaseSideEffectsForStrictMode = false;\n export const enableDebugTracing = false;\n export const enableAsyncDebugInfo = false;\n export const enableSchedulingProfiler = false;\n-export const replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n export const enableProfilerTimer = __PROFILE__;\n export const enableProfilerCommitHooks = __PROFILE__;\n export const enableProfilerNestedUpdatePhase = __PROFILE__;\n@@ -34,7 +33,6 @@ export const disableIEWorkarounds = true;\n export const enableScopeAPI = false;\n export const enableCreateEventHandleAPI = false;\n export const enableSuspenseCallback = false;\n-export const disableLegacyContext = false;\n export const enableTrustedTypesIntegration = false;\n export const disableTextareaChildren = false;\n export const disableModulePatternComponents = false;\n@@ -80,7 +78,6 @@ export const enableAsyncActions = true;\n \n export const alwaysThrottleRetries = true;\n \n-export const useMicrotasksForSchedulingInFabric = false;\n export const passChildrenWhenCloningPersistedNodes = false;\n export const enableUseDeferredValueInitialArg = __EXPERIMENTAL__;\n export const disableClientCache = true;\n@@ -101,6 +98,8 @@ export const disableStringRefs = __NEXT_MAJOR__;\n export const enableReactTestRendererWarning = false;\n export const enableBigIntSupport = __NEXT_MAJOR__;\n export const disableLegacyMode = __NEXT_MAJOR__;\n+export const disableLegacyContext = __NEXT_MAJOR__;\n+export const enableNewBooleanProps = __NEXT_MAJOR__;\n \n // Flow magic to verify the exports of this file match the original version.\n ((((null: any): ExportsType): FeatureFlagsType): ExportsType);"
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.test-renderer.native.js",
                "git_diff": "@@ -14,7 +14,6 @@ export const debugRenderPhaseSideEffectsForStrictMode = false;\n export const enableDebugTracing = false;\n export const enableAsyncDebugInfo = false;\n export const enableSchedulingProfiler = false;\n-export const replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n export const enableProfilerTimer = __PROFILE__;\n export const enableProfilerCommitHooks = __PROFILE__;\n export const enableProfilerNestedUpdatePhase = __PROFILE__;\n@@ -64,6 +63,7 @@ export const forceConcurrentByDefaultForTesting = false;\n export const enableUnifiedSyncLane = true;\n export const allowConcurrentByDefault = true;\n export const enableCustomElementPropertySupport = true;\n+export const enableNewBooleanProps = true;\n \n export const consoleManagedByDevToolsDuringStrictMode = false;\n \n@@ -79,7 +79,6 @@ export const enableAsyncActions = true;\n \n export const alwaysThrottleRetries = true;\n \n-export const useMicrotasksForSchedulingInFabric = false;\n export const passChildrenWhenCloningPersistedNodes = false;\n export const enableUseDeferredValueInitialArg = __EXPERIMENTAL__;\n export const disableClientCache = true;"
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.test-renderer.www.js",
                "git_diff": "@@ -14,7 +14,6 @@ export const debugRenderPhaseSideEffectsForStrictMode = false;\n export const enableDebugTracing = false;\n export const enableAsyncDebugInfo = false;\n export const enableSchedulingProfiler = false;\n-export const replayFailedUnitOfWorkWithInvokeGuardedCallback = false;\n export const enableProfilerTimer = __PROFILE__;\n export const enableProfilerCommitHooks = __PROFILE__;\n export const enableProfilerNestedUpdatePhase = __PROFILE__;\n@@ -64,6 +63,7 @@ export const forceConcurrentByDefaultForTesting = false;\n export const enableUnifiedSyncLane = true;\n export const allowConcurrentByDefault = true;\n export const enableCustomElementPropertySupport = false;\n+export const enableNewBooleanProps = false;\n \n export const consoleManagedByDevToolsDuringStrictMode = false;\n \n@@ -80,7 +80,6 @@ export const enableAsyncActions = true;\n \n export const alwaysThrottleRetries = true;\n \n-export const useMicrotasksForSchedulingInFabric = false;\n export const passChildrenWhenCloningPersistedNodes = false;\n export const enableUseDeferredValueInitialArg = true;\n export const disableClientCache = true;"
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.www-dynamic.js",
                "git_diff": "@@ -29,6 +29,8 @@ export const enableUseDeferredValueInitialArg = __VARIANT__;\n export const enableRenderableContext = __VARIANT__;\n export const useModernStrictMode = __VARIANT__;\n export const enableRefAsProp = __VARIANT__;\n+export const enableClientRenderFallbackOnTextMismatch = __VARIANT__;\n+export const enableNewBooleanProps = __VARIANT__;\n export const enableRetryLaneExpiration = __VARIANT__;\n export const retryLaneExpirationMs = 5000;\n export const syncLaneExpirationMs = 250;\n@@ -44,10 +46,6 @@ export const enableSchedulingProfiler = __VARIANT__;\n \n export const enableInfiniteRenderLoopDetection = __VARIANT__;\n \n-// These are already tested in both modes using the build type dimension,\n-// so we don't need to use __VARIANT__ to get extra coverage.\n-export const replayFailedUnitOfWorkWithInvokeGuardedCallback = __DEV__;\n-\n // TODO: These flags are hard-coded to the default values used in open source.\n // Update the tests so that they pass in either mode, then set these\n // to __VARIANT__."
            },
            {
                "file": "packages/shared/forks/ReactFeatureFlags.www.js",
                "git_diff": "@@ -18,7 +18,6 @@ export const {\n   disableInputAttributeSyncing,\n   disableIEWorkarounds,\n   enableTrustedTypesIntegration,\n-  replayFailedUnitOfWorkWithInvokeGuardedCallback,\n   enableLegacyFBSupport,\n   enableDebugTracing,\n   enableUseRefAccessWarning,\n@@ -38,6 +37,8 @@ export const {\n   enableRenderableContext,\n   useModernStrictMode,\n   enableRefAsProp,\n+  enableNewBooleanProps,\n+  enableClientRenderFallbackOnTextMismatch,\n } = dynamicFeatureFlags;\n \n // On WWW, __EXPERIMENTAL__ is used for a new modern build.\n@@ -48,7 +49,7 @@ export const enableProfilerTimer = __PROFILE__;\n export const enableProfilerCommitHooks = __PROFILE__;\n export const enableProfilerNestedUpdatePhase = __PROFILE__;\n export const enableUpdaterTracking = __PROFILE__;\n-export const enableClientRenderFallbackOnTextMismatch = true;\n+\n export const enableSuspenseAvoidThisFallback = true;\n export const enableSuspenseAvoidThisFallbackFizz = false;\n \n@@ -106,7 +107,6 @@ export const enableFizzExternalRuntime = true;\n \n export const forceConcurrentByDefaultForTesting = false;\n \n-export const useMicrotasksForSchedulingInFabric = false;\n export const passChildrenWhenCloningPersistedNodes = false;\n \n export const enableAsyncDebugInfo = false;"
            },
            {
                "file": "packages/shared/forks/invokeGuardedCallbackImpl.www.js",
                "git_diff": "@@ -1,34 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- *\n- * @noflow\n- */\n-\n-// Provided by www\n-const ReactFbErrorUtils = require('ReactFbErrorUtils');\n-\n-if (typeof ReactFbErrorUtils.invokeGuardedCallback !== 'function') {\n-  throw new Error(\n-    'Expected ReactFbErrorUtils.invokeGuardedCallback to be a function.',\n-  );\n-}\n-\n-function invokeGuardedCallbackImpl<A, B, C, D, E, F, Context>(\n-  name: string | null,\n-  func: (a: A, b: B, c: C, d: D, e: E, f: F) => mixed,\n-  context: Context,\n-  a: A,\n-  b: B,\n-  c: C,\n-  d: D,\n-  e: E,\n-  f: F,\n-) {\n-  // This will call `this.onError(err)` if an error was caught.\n-  ReactFbErrorUtils.invokeGuardedCallback.apply(this, arguments);\n-}\n-\n-export default invokeGuardedCallbackImpl;"
            },
            {
                "file": "packages/shared/invokeGuardedCallbackImpl.js",
                "git_diff": "@@ -1,215 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- *\n- * @flow\n- */\n-\n-let fakeNode: Element = (null: any);\n-if (__DEV__) {\n-  if (\n-    typeof window !== 'undefined' &&\n-    typeof window.dispatchEvent === 'function' &&\n-    typeof document !== 'undefined' &&\n-    // $FlowFixMe[method-unbinding]\n-    typeof document.createEvent === 'function'\n-  ) {\n-    fakeNode = document.createElement('react');\n-  }\n-}\n-\n-export default function invokeGuardedCallbackImpl<Args: Array<mixed>, Context>(\n-  this: {onError: (error: mixed) => void},\n-  name: string | null,\n-  func: (...Args) => mixed,\n-  context: Context,\n-): void {\n-  if (__DEV__) {\n-    // In DEV mode, we use a special version\n-    // that plays more nicely with the browser's DevTools. The idea is to preserve\n-    // \"Pause on exceptions\" behavior. Because React wraps all user-provided\n-    // functions in invokeGuardedCallback, and the production version of\n-    // invokeGuardedCallback uses a try-catch, all user exceptions are treated\n-    // like caught exceptions, and the DevTools won't pause unless the developer\n-    // takes the extra step of enabling pause on caught exceptions. This is\n-    // unintuitive, though, because even though React has caught the error, from\n-    // the developer's perspective, the error is uncaught.\n-    //\n-    // To preserve the expected \"Pause on exceptions\" behavior, we don't use a\n-    // try-catch in DEV. Instead, we synchronously dispatch a fake event to a fake\n-    // DOM node, and call the user-provided callback from inside an event handler\n-    // for that fake event. If the callback throws, the error is \"captured\" using\n-    // event loop context, it does not interrupt the normal program flow.\n-    // Effectively, this gives us try-catch behavior without actually using\n-    // try-catch. Neat!\n-\n-    // fakeNode signifies we are in an environment with a document and window object\n-    if (fakeNode) {\n-      const evt = document.createEvent('Event');\n-\n-      let didCall = false;\n-      // Keeps track of whether the user-provided callback threw an error. We\n-      // set this to true at the beginning, then set it to false right after\n-      // calling the function. If the function errors, `didError` will never be\n-      // set to false. This strategy works even if the browser is flaky and\n-      // fails to call our global error handler, because it doesn't rely on\n-      // the error event at all.\n-      let didError = true;\n-\n-      // Keeps track of the value of window.event so that we can reset it\n-      // during the callback to let user code access window.event in the\n-      // browsers that support it.\n-      const windowEvent = window.event;\n-\n-      // Keeps track of the descriptor of window.event to restore it after event\n-      // dispatching: https://github.com/facebook/react/issues/13688\n-      const windowEventDescriptor = Object.getOwnPropertyDescriptor(\n-        window,\n-        'event',\n-      );\n-\n-      const restoreAfterDispatch = () => {\n-        // We immediately remove the callback from event listeners so that\n-        // nested `invokeGuardedCallback` calls do not clash. Otherwise, a\n-        // nested call would trigger the fake event handlers of any call higher\n-        // in the stack.\n-        fakeNode.removeEventListener(evtType, callCallback, false);\n-\n-        // We check for window.hasOwnProperty('event') to prevent the\n-        // window.event assignment in both IE <= 10 as they throw an error\n-        // \"Member not found\" in strict mode, and in Firefox which does not\n-        // support window.event.\n-        if (\n-          typeof window.event !== 'undefined' &&\n-          window.hasOwnProperty('event')\n-        ) {\n-          window.event = windowEvent;\n-        }\n-      };\n-\n-      // Create an event handler for our fake event. We will synchronously\n-      // dispatch our fake event using `dispatchEvent`. Inside the handler, we\n-      // call the user-provided callback.\n-      // $FlowFixMe[method-unbinding]\n-      const funcArgs = Array.prototype.slice.call(arguments, 3);\n-      const callCallback = () => {\n-        didCall = true;\n-        restoreAfterDispatch();\n-        // $FlowFixMe[incompatible-call] Flow doesn't understand the arguments splicing.\n-        func.apply(context, funcArgs);\n-        didError = false;\n-      };\n-\n-      // Create a global error event handler. We use this to capture the value\n-      // that was thrown. It's possible that this error handler will fire more\n-      // than once; for example, if non-React code also calls `dispatchEvent`\n-      // and a handler for that event throws. We should be resilient to most of\n-      // those cases. Even if our error event handler fires more than once, the\n-      // last error event is always used. If the callback actually does error,\n-      // we know that the last error event is the correct one, because it's not\n-      // possible for anything else to have happened in between our callback\n-      // erroring and the code that follows the `dispatchEvent` call below. If\n-      // the callback doesn't error, but the error event was fired, we know to\n-      // ignore it because `didError` will be false, as described above.\n-      let error;\n-      // Use this to track whether the error event is ever called.\n-      let didSetError = false;\n-      let isCrossOriginError = false;\n-\n-      const handleWindowError = (event: ErrorEvent) => {\n-        error = event.error;\n-        didSetError = true;\n-        if (error === null && event.colno === 0 && event.lineno === 0) {\n-          isCrossOriginError = true;\n-        }\n-        if (event.defaultPrevented) {\n-          // Some other error handler has prevented default.\n-          // Browsers silence the error report if this happens.\n-          // We'll remember this to later decide whether to log it or not.\n-          if (error != null && typeof error === 'object') {\n-            try {\n-              error._suppressLogging = true;\n-            } catch (inner) {\n-              // Ignore.\n-            }\n-          }\n-        }\n-      };\n-\n-      // Create a fake event type.\n-      const evtType = `react-${name ? name : 'invokeguardedcallback'}`;\n-\n-      // Attach our event handlers\n-      window.addEventListener('error', handleWindowError);\n-      fakeNode.addEventListener(evtType, callCallback, false);\n-\n-      // Synchronously dispatch our fake event. If the user-provided function\n-      // errors, it will trigger our global error handler.\n-      evt.initEvent(evtType, false, false);\n-      fakeNode.dispatchEvent(evt);\n-      if (windowEventDescriptor) {\n-        Object.defineProperty(window, 'event', windowEventDescriptor);\n-      }\n-\n-      if (didCall && didError) {\n-        if (!didSetError) {\n-          // The callback errored, but the error event never fired.\n-          // eslint-disable-next-line react-internal/prod-error-codes\n-          error = new Error(\n-            'An error was thrown inside one of your components, but React ' +\n-              \"doesn't know what it was. This is likely due to browser \" +\n-              'flakiness. React does its best to preserve the \"Pause on ' +\n-              'exceptions\" behavior of the DevTools, which requires some ' +\n-              \"DEV-mode only tricks. It's possible that these don't work in \" +\n-              'your browser. Try triggering the error in production mode, ' +\n-              'or switching to a modern browser. If you suspect that this is ' +\n-              'actually an issue with React, please file an issue.',\n-          );\n-        } else if (isCrossOriginError) {\n-          // eslint-disable-next-line react-internal/prod-error-codes\n-          error = new Error(\n-            \"A cross-origin error was thrown. React doesn't have access to \" +\n-              'the actual error object in development. ' +\n-              'See https://react.dev/link/crossorigin-error for more information.',\n-          );\n-        }\n-        this.onError(error);\n-      }\n-\n-      // Remove our event listeners\n-      window.removeEventListener('error', handleWindowError);\n-\n-      if (didCall) {\n-        return;\n-      } else {\n-        // Something went really wrong, and our event was not dispatched.\n-        // https://github.com/facebook/react/issues/16734\n-        // https://github.com/facebook/react/issues/16585\n-        // Fall back to the production implementation.\n-        restoreAfterDispatch();\n-        // we fall through and call the prod version instead\n-      }\n-    }\n-    // We only get here if we are in an environment that either does not support the browser\n-    // variant or we had trouble getting the browser to emit the error.\n-    // $FlowFixMe[method-unbinding]\n-    const funcArgs = Array.prototype.slice.call(arguments, 3);\n-    try {\n-      // $FlowFixMe[incompatible-call] Flow doesn't understand the arguments splicing.\n-      func.apply(context, funcArgs);\n-    } catch (error) {\n-      this.onError(error);\n-    }\n-  } else {\n-    // $FlowFixMe[method-unbinding]\n-    const funcArgs = Array.prototype.slice.call(arguments, 3);\n-    try {\n-      // $FlowFixMe[incompatible-call] Flow doesn't understand the arguments splicing.\n-      func.apply(context, funcArgs);\n-    } catch (error) {\n-      this.onError(error);\n-    }\n-  }\n-}"
            },
            {
                "file": "packages/use-sync-external-store/src/__tests__/useSyncExternalStoreShared-test.js",
                "git_diff": "@@ -22,6 +22,8 @@ let useEffect;\n let useLayoutEffect;\n let assertLog;\n \n+let originalError;\n+\n // This tests shared behavior between the built-in and shim implementations of\n // of useSyncExternalStore.\n describe('Shared useSyncExternalStore behavior (shim and built-in)', () => {\n@@ -44,6 +46,9 @@ describe('Shared useSyncExternalStore behavior (shim and built-in)', () => {\n             : 'react-dom-17/umd/react-dom.production.min.js',\n         ),\n       );\n+      // Because React 17 prints extra logs we need to ignore them.\n+      originalError = console.error;\n+      console.error = jest.fn();\n     }\n \n     React = require('react');\n@@ -82,6 +87,12 @@ describe('Shared useSyncExternalStore behavior (shim and built-in)', () => {\n       require('use-sync-external-store/shim/with-selector').useSyncExternalStoreWithSelector;\n   });\n \n+  afterEach(() => {\n+    if (gate(flags => flags.enableUseSyncExternalStoreShim)) {\n+      console.error = originalError;\n+    }\n+  });\n+\n   function Text({text}) {\n     Scheduler.log(text);\n     return text;\n@@ -593,12 +604,20 @@ describe('Shared useSyncExternalStore behavior (shim and built-in)', () => {\n           'the number of nested updates to prevent infinite loops.',\n       );\n     }).toErrorDev(\n-      'The result of getSnapshot should be cached to avoid an infinite loop',\n+      gate(flags => flags.enableUseSyncExternalStoreShim)\n+        ? [\n+            'Uncaught [',\n+            'The result of getSnapshot should be cached to avoid an infinite loop',\n+            'The above error occurred in the',\n+          ]\n+        : [\n+            'The result of getSnapshot should be cached to avoid an infinite loop',\n+          ],\n       {\n         withoutStack: gate(flags => {\n           if (flags.enableUseSyncExternalStoreShim) {\n             // Stacks don't work when mixing the source and the npm package.\n-            return flags.source;\n+            return flags.source ? 1 : 0;\n           }\n           return false;\n         }),"
            },
            {
                "file": "scripts/flow/react-native-host-hooks.js",
                "git_diff": "@@ -167,6 +167,8 @@ declare module 'react-native/Libraries/ReactPrivate/ReactNativePrivateInterface'\n declare module 'react-native/Libraries/ReactPrivate/ReactNativePrivateInitializeCore' {\n }\n \n+declare const RN$enableMicrotasksInReact: boolean;\n+\n // This is needed for a short term solution.\n // See https://github.com/facebook/react/pull/15490 for more info\n declare var nativeFabricUIManager: {"
            },
            {
                "file": "scripts/flow/xplat.js",
                "git_diff": "@@ -18,6 +18,5 @@ declare module 'ReactNativeInternalFeatureFlags' {\n   declare export var enableUnifiedSyncLane: boolean;\n   declare export var enableUseRefAccessWarning: boolean;\n   declare export var passChildrenWhenCloningPersistedNodes: boolean;\n-  declare export var useMicrotasksForSchedulingInFabric: boolean;\n   declare export var useModernStrictMode: boolean;\n }"
            },
            {
                "file": "scripts/jest/shouldIgnoreConsoleError.js",
                "git_diff": "@@ -7,14 +7,13 @@ module.exports = function shouldIgnoreConsoleError(\n ) {\n   if (__DEV__) {\n     if (typeof format === 'string') {\n-      if (format.indexOf('Error: Uncaught [') === 0) {\n-        // This looks like an uncaught error from invokeGuardedCallback() wrapper\n-        // in development that is reported by jsdom. Ignore because it's noisy.\n-        return true;\n-      }\n-      if (format.indexOf('The above error occurred') === 0) {\n-        // This looks like an error addendum from ReactFiberErrorLogger.\n-        // Ignore it too.\n+      if (\n+        args[0] != null &&\n+        typeof args[0].message === 'string' &&\n+        typeof args[0].stack === 'string'\n+      ) {\n+        // This looks like an error with addendum from ReactFiberErrorLogger.\n+        // They are noisy too so we'll try to ignore them.\n         return true;\n       }\n       if (\n@@ -36,17 +35,6 @@ module.exports = function shouldIgnoreConsoleError(\n         // This also gets logged by onRecoverableError, so we can ignore it.\n         return true;\n       }\n-    } else if (\n-      format != null &&\n-      typeof format.message === 'string' &&\n-      typeof format.stack === 'string' &&\n-      args.length === 0\n-    ) {\n-      if (format.stack.indexOf('Error: Uncaught [') === 0) {\n-        // This looks like an uncaught error from invokeGuardedCallback() wrapper\n-        // in development that is reported by jest-environment-jsdom. Ignore because it's noisy.\n-        return true;\n-      }\n     }\n   } else {\n     if ("
            },
            {
                "file": "scripts/rollup/forks.js",
                "git_diff": "@@ -232,18 +232,6 @@ const forks = Object.freeze({\n     }\n   },\n \n-  // Different wrapping/reporting for caught errors.\n-  './packages/shared/invokeGuardedCallbackImpl.js': (bundleType, entry) => {\n-    switch (bundleType) {\n-      case FB_WWW_DEV:\n-      case FB_WWW_PROD:\n-      case FB_WWW_PROFILING:\n-        return './packages/shared/forks/invokeGuardedCallbackImpl.www.js';\n-      default:\n-        return null;\n-    }\n-  },\n-\n   // Different dialogs for caught errors.\n   './packages/react-reconciler/src/ReactFiberErrorDialog.js': (\n     bundleType,"
            },
            {
                "file": "scripts/rollup/shims/facebook-www/renderSubtreeIntoContainer_DO_NOT_USE.js",
                "git_diff": "@@ -1,12 +0,0 @@\n-/**\n- * Copyright (c) Meta Platforms, Inc. and affiliates.\n- *\n- * This source code is licensed under the MIT license found in the\n- * LICENSE file in the root directory of this source tree.\n- */\n-\n-'use strict';\n-\n-const ReactDOM = require('ReactDOM');\n-\n-module.exports = ReactDOM.unstable_renderSubtreeIntoContainer;"
            },
            {
                "file": "scripts/rollup/validate/eslintrc.rn.js",
                "git_diff": "@@ -42,6 +42,8 @@ module.exports = {\n     // Fabric. See https://github.com/facebook/react/pull/15490\n     // for more information\n     nativeFabricUIManager: 'readonly',\n+    // RN flag to enable microtasks\n+    RN$enableMicrotasksInReact: 'readonly',\n     // Trusted Types\n     trustedTypes: 'readonly',\n     // RN supports this"
            },
            {
                "file": "packages/react-devtools/package.json",
                "git_diff": "@@ -24,7 +24,7 @@\n   },\n   \"dependencies\": {\n     \"cross-spawn\": \"^5.0.1\",\n-    \"electron\": \"^23.1.2\",\n+    \"electron\": \"^26.6.6\",\n     \"ip\": \"^1.1.9\",\n     \"minimist\": \"^1.2.3\",\n     \"react-devtools-core\": \"5.0.2\","
            },
            {
                "file": "packages/react-devtools-extensions/package.json",
                "git_diff": "@@ -68,6 +68,6 @@\n     \"workerize-loader\": \"^2.0.2\"\n   },\n   \"dependencies\": {\n-    \"web-ext\": \"^4\"\n+    \"web-ext\": \"^6.0.0\"\n   }\n }"
            },
            {
                "file": "scripts/bench/package.json",
                "git_diff": "@@ -15,8 +15,8 @@\n     \"mime\": \"^1.3.6\",\n     \"minimist\": \"^1.2.3\",\n     \"ncp\": \"^2.0.0\",\n-    \"nodegit\": \"^0.18.3\",\n-    \"rimraf\": \"^2.6.1\",\n+    \"nodegit\": \"^0.23.0\",\n+    \"rimraf\": \"^4.3.1\",\n     \"stats-analysis\": \"^2.0.0\"\n   }\n }"
            },
            {
                "file": "scripts/bench/yarn.lock",
                "git_diff": "@@ -81,12 +81,15 @@ agent-base@6:\n   dependencies:\n     debug \"4\"\n \n-ajv@^4.9.1:\n-  version \"4.11.8\"\n-  resolved \"https://registry.yarnpkg.com/ajv/-/ajv-4.11.8.tgz#82ffb02b29e662ae53bdc20af15947706739c536\"\n+ajv@^6.12.3:\n+  version \"6.12.6\"\n+  resolved \"https://registry.yarnpkg.com/ajv/-/ajv-6.12.6.tgz#baf5a62e802b07d977034586f8c3baf5adf26df4\"\n+  integrity sha512-j3fVLgvTo527anyYyJOGTYJbG+vnnQYvE0m5mmkc1TK+nxAppkCLMIL0aZ4dblVCNoGShhm+kzE4ZUykBoMg4g==\n   dependencies:\n-    co \"^4.6.0\"\n-    json-stable-stringify \"^1.0.1\"\n+    fast-deep-equal \"^3.1.1\"\n+    fast-json-stable-stringify \"^2.0.0\"\n+    json-schema-traverse \"^0.4.1\"\n+    uri-js \"^4.2.2\"\n \n ansi-colors@^4.1.1:\n   version \"4.1.3\"\n@@ -138,10 +141,6 @@ assert-plus@1.0.0, assert-plus@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/assert-plus/-/assert-plus-1.0.0.tgz#f12e0f3c5d77b0b1cdd9146942e4e96c1e4dd525\"\n \n-assert-plus@^0.2.0:\n-  version \"0.2.0\"\n-  resolved \"https://registry.yarnpkg.com/assert-plus/-/assert-plus-0.2.0.tgz#d74e1b87e7affc0db8aadb7021f3fe48101ab234\"\n-\n async@^1.5.2:\n   version \"1.5.2\"\n   resolved \"https://registry.yarnpkg.com/async/-/async-1.5.2.tgz#ec6a61ae56480c0c3cb241c95618e20892f9672a\"\n@@ -150,13 +149,15 @@ asynckit@^0.4.0:\n   version \"0.4.0\"\n   resolved \"https://registry.yarnpkg.com/asynckit/-/asynckit-0.4.0.tgz#c79ed97f7f34cb8f2ba1bc9790bcc366474b4b79\"\n \n-aws-sign2@~0.6.0:\n-  version \"0.6.0\"\n-  resolved \"https://registry.yarnpkg.com/aws-sign2/-/aws-sign2-0.6.0.tgz#14342dd38dbcc94d0e5b87d763cd63612c0e794f\"\n+aws-sign2@~0.7.0:\n+  version \"0.7.0\"\n+  resolved \"https://registry.yarnpkg.com/aws-sign2/-/aws-sign2-0.7.0.tgz#b46e890934a9591f2d2f6f86d7e6a9f1b3fe76a8\"\n+  integrity sha512-08kcGqnYf/YmjoRhfxyu+CLxBjUtHLXLXX/vUfx9l2LYzG3c1m61nrpyFUZI6zeS+Li/wWMMidD9KgrqtGq3mA==\n \n-aws4@^1.2.1:\n-  version \"1.6.0\"\n-  resolved \"https://registry.yarnpkg.com/aws4/-/aws4-1.6.0.tgz#83ef5ca860b2b32e4a0deedee8c771b9db57471e\"\n+aws4@^1.8.0:\n+  version \"1.13.0\"\n+  resolved \"https://registry.yarnpkg.com/aws4/-/aws4-1.13.0.tgz#d9b802e9bb9c248d7be5f7f5ef178dc3684e9dcc\"\n+  integrity sha512-3AungXC4I8kKsS9PuS4JH2nc+0bVY/mjgrephHTIi8fpEeGsTHBUJeosp0Wc1myYMElmD0B3Oc4XL/HVJ4PV2g==\n \n axe-core@4.4.1:\n   version \"4.4.1\"\n@@ -178,6 +179,14 @@ bcrypt-pbkdf@^1.0.0:\n   dependencies:\n     tweetnacl \"^0.14.3\"\n \n+bl@^1.0.0:\n+  version \"1.2.3\"\n+  resolved \"https://registry.yarnpkg.com/bl/-/bl-1.2.3.tgz#1e8dd80142eac80d7158c9dccc047fb620e035e7\"\n+  integrity sha512-pvcNpa0UU69UT341rO6AYy4FVAIkUHuZXRIWbq+zHnsVcRzDDjIAhGuuYoi0d//cwIwtt4pkpKycWEfjdV+vww==\n+  dependencies:\n+    readable-stream \"^2.3.5\"\n+    safe-buffer \"^5.1.1\"\n+\n bl@^4.0.3:\n   version \"4.1.0\"\n   resolved \"https://registry.yarnpkg.com/bl/-/bl-4.1.0.tgz#451535264182bec2fbbc83a62ab98cf11d9f7b3a\"\n@@ -193,24 +202,43 @@ block-stream@*:\n   dependencies:\n     inherits \"~2.0.0\"\n \n-boom@2.x.x:\n-  version \"2.10.1\"\n-  resolved \"https://registry.yarnpkg.com/boom/-/boom-2.10.1.tgz#39c8918ceff5799f83f9492a848f625add0c766f\"\n-  dependencies:\n-    hoek \"2.x.x\"\n-\n brace-expansion@^1.1.7:\n   version \"1.1.8\"\n   resolved \"https://registry.yarnpkg.com/brace-expansion/-/brace-expansion-1.1.8.tgz#c07b211c7c952ec1f8efd51a77ef0d1d3990a292\"\n   dependencies:\n     balanced-match \"^1.0.0\"\n     concat-map \"0.0.1\"\n \n+brace-expansion@^2.0.1:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/brace-expansion/-/brace-expansion-2.0.1.tgz#1edc459e0f0c548486ecf9fc99f2221364b9a0ae\"\n+  integrity sha512-XnAIvQ8eM+kC6aULx6wuQiwVsnzsi9d3WxzV3FpWTGA19F621kwdbsAcFKXgKUHZWsy+mY6iL1sHTxWEFCytDA==\n+  dependencies:\n+    balanced-match \"^1.0.0\"\n+\n+buffer-alloc-unsafe@^1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/buffer-alloc-unsafe/-/buffer-alloc-unsafe-1.1.0.tgz#bd7dc26ae2972d0eda253be061dba992349c19f0\"\n+  integrity sha512-TEM2iMIEQdJ2yjPJoSIsldnleVaAk1oW3DBVUykyOLsEsFmEc9kn+SFFPz+gl54KQNxlDnAwCXosOS9Okx2xAg==\n+\n+buffer-alloc@^1.2.0:\n+  version \"1.2.0\"\n+  resolved \"https://registry.yarnpkg.com/buffer-alloc/-/buffer-alloc-1.2.0.tgz#890dd90d923a873e08e10e5fd51a57e5b7cce0ec\"\n+  integrity sha512-CFsHQgjtW1UChdXgbyJGtnm+O/uLQeZdtbDo8mfUgYXCHSM1wgrVxXm6bSyrUuErEb+4sYVGCzASBRot7zyrow==\n+  dependencies:\n+    buffer-alloc-unsafe \"^1.1.0\"\n+    buffer-fill \"^1.0.0\"\n+\n buffer-crc32@~0.2.3:\n   version \"0.2.13\"\n   resolved \"https://registry.yarnpkg.com/buffer-crc32/-/buffer-crc32-0.2.13.tgz#0d333e3f00eac50aa1454abd30ef8c2a5d9a7242\"\n   integrity sha512-VO9Ht/+p3SN7SKWqcrgEzjGbRSJYTx+Q1pTQC0wrWqHx0vpJraQ6GtHx8tvcg1rlK1byhU5gccxgOgj7B0TDkQ==\n \n+buffer-fill@^1.0.0:\n+  version \"1.0.0\"\n+  resolved \"https://registry.yarnpkg.com/buffer-fill/-/buffer-fill-1.0.0.tgz#f8f78b76789888ef39f205cd637f68e702122b2c\"\n+  integrity sha512-T7zexNBwiiaCOGDg9xNX9PBmjrubblRkENuptryuI64URkXDFum9il/JGL8Lm8wYfAXpredVXXZz7eMHilimiQ==\n+\n buffer@^5.2.1, buffer@^5.5.0:\n   version \"5.7.1\"\n   resolved \"https://registry.yarnpkg.com/buffer/-/buffer-5.7.1.tgz#ba62e7c13133053582197160851a8f648e99eed0\"\n@@ -231,7 +259,7 @@ chalk@^2.1.0:\n     escape-string-regexp \"^1.0.5\"\n     supports-color \"^4.0.0\"\n \n-chownr@^1.1.1:\n+chownr@^1.0.1, chownr@^1.1.1, chownr@^1.1.4:\n   version \"1.1.4\"\n   resolved \"https://registry.yarnpkg.com/chownr/-/chownr-1.1.4.tgz#6fc9d7b42d32a583596337666e7d08084da2cc6b\"\n   integrity sha512-jJ0bqzaylmJtVnNgzTeSOs8DPavpbYgEr/b0YL8/2GO3xJEhInFmhKMUnEJQjZumK7KXGFhUy89PrsJWlakBVg==\n@@ -273,10 +301,6 @@ cliui@^8.0.1:\n     strip-ansi \"^6.0.1\"\n     wrap-ansi \"^7.0.0\"\n \n-co@^4.6.0:\n-  version \"4.6.0\"\n-  resolved \"https://registry.yarnpkg.com/co/-/co-4.6.0.tgz#6ea6bdf3d853ae54ccb8e47bfa0bf3f9031fb184\"\n-\n code-point-at@^1.0.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/code-point-at/-/code-point-at-1.1.0.tgz#0d070b4d043a5bea33a2f1a40e2edb3d9a4ccf77\"\n@@ -307,9 +331,10 @@ colors@1.0.3:\n   version \"1.0.3\"\n   resolved \"https://registry.yarnpkg.com/colors/-/colors-1.0.3.tgz#0433f44d809680fdeb60ed260f1b0c262e82a40b\"\n \n-combined-stream@^1.0.5, combined-stream@~1.0.5:\n-  version \"1.0.5\"\n-  resolved \"https://registry.yarnpkg.com/combined-stream/-/combined-stream-1.0.5.tgz#938370a57b4a51dea2c77c15d5c5fdf895164009\"\n+combined-stream@^1.0.6, combined-stream@~1.0.6:\n+  version \"1.0.8\"\n+  resolved \"https://registry.yarnpkg.com/combined-stream/-/combined-stream-1.0.8.tgz#c3d45a8b34fd730631a110a8a2520682b31d5a7f\"\n+  integrity sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==\n   dependencies:\n     delayed-stream \"~1.0.0\"\n \n@@ -353,12 +378,6 @@ cross-fetch@3.1.5:\n   dependencies:\n     node-fetch \"2.6.7\"\n \n-cryptiles@2.x.x:\n-  version \"2.0.5\"\n-  resolved \"https://registry.yarnpkg.com/cryptiles/-/cryptiles-2.0.5.tgz#3bdfecdc608147c1c67202fa291e7dca59eaa3b8\"\n-  dependencies:\n-    boom \"2.x.x\"\n-\n crypto-random-string@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/crypto-random-string/-/crypto-random-string-2.0.0.tgz#ef2a7a966ec11083388369baa02ebead229b30d5\"\n@@ -407,9 +426,17 @@ debug@^2.6.8, debug@^2.6.9:\n   dependencies:\n     ms \"2.0.0\"\n \n-deep-extend@~0.4.0:\n-  version \"0.4.2\"\n-  resolved \"https://registry.yarnpkg.com/deep-extend/-/deep-extend-0.4.2.tgz#48b699c27e334bf89f10892be432f6e4c7d34a7f\"\n+debug@^3.2.6:\n+  version \"3.2.7\"\n+  resolved \"https://registry.yarnpkg.com/debug/-/debug-3.2.7.tgz#72580b7e9145fb39b6676f9c5e5fb100b934179a\"\n+  integrity sha512-CFjzYYAi4ThfiQvizrFQevTTXHtnCqWfe7x1AhgEscTz6ZbLbfoLRLPugTQyBth6f8ZERVUSyWHFD/7Wu4t1XQ==\n+  dependencies:\n+    ms \"^2.1.1\"\n+\n+deep-extend@^0.6.0:\n+  version \"0.6.0\"\n+  resolved \"https://registry.yarnpkg.com/deep-extend/-/deep-extend-0.6.0.tgz#c4fa7c95404a17a9c3e8ca7e1537312b736330ac\"\n+  integrity sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA==\n \n define-lazy-prop@^2.0.0:\n   version \"2.0.0\"\n@@ -424,6 +451,11 @@ delegates@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/delegates/-/delegates-1.0.0.tgz#84c6e159b81904fdca59a0ef44cd870d31250f9a\"\n \n+detect-libc@^1.0.2:\n+  version \"1.0.3\"\n+  resolved \"https://registry.yarnpkg.com/detect-libc/-/detect-libc-1.0.3.tgz#fa137c4bd698edf55cd5cd02ac559f91a4c4ba9b\"\n+  integrity sha512-pGjwhsmsp4kL2RTz08wcOlGN83otlqHeD/Z5T8GXZB+/YcpQ/dgo+lbU8ZsGxV0HIvqqxo9l7mqYwyYMD9bKDg==\n+\n devtools-protocol@0.0.981744:\n   version \"0.0.981744\"\n   resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.981744.tgz#9960da0370284577d46c28979a0b32651022bacf\"\n@@ -457,7 +489,7 @@ emoji-regex@^8.0.0:\n   resolved \"https://registry.yarnpkg.com/emoji-regex/-/emoji-regex-8.0.0.tgz#e818fd69ce5ccfcb404594f842963bf53164cc37\"\n   integrity sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==\n \n-end-of-stream@^1.1.0, end-of-stream@^1.4.1:\n+end-of-stream@^1.0.0, end-of-stream@^1.1.0, end-of-stream@^1.4.1:\n   version \"1.4.4\"\n   resolved \"https://registry.yarnpkg.com/end-of-stream/-/end-of-stream-1.4.4.tgz#5ae64a5f45057baf3626ec14da0ca5e4b2431eb0\"\n   integrity sha512-+uw1inIHVPQoaVuHzRyXd21icM+cnt4CzD5rW+NC1wjOUSTOs+Te7FOv7AhN7vS9x/oIyhLP5PR1H+phQAHu5Q==\n@@ -490,9 +522,10 @@ eventemitter3@1.x.x:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/eventemitter3/-/eventemitter3-1.2.0.tgz#1c86991d816ad1e504750e73874224ecf3bec508\"\n \n-extend@~3.0.0:\n-  version \"3.0.1\"\n-  resolved \"https://registry.yarnpkg.com/extend/-/extend-3.0.1.tgz#a755ea7bc1adfcc5a31ce7e762dbaadc5e636444\"\n+extend@~3.0.2:\n+  version \"3.0.2\"\n+  resolved \"https://registry.yarnpkg.com/extend/-/extend-3.0.2.tgz#f8b1136b4071fbd8eb140aff858b1019ec2915fa\"\n+  integrity sha512-fjquC59cD7CyW6urNXK0FBufkZcoiGG80wTuPujX590cB5Ttln20E2UB4S/WARVqhXffZl2LNgS+gQdPIIim/g==\n \n extract-zip@2.0.1:\n   version \"2.0.1\"\n@@ -509,6 +542,16 @@ extsprintf@1.3.0, extsprintf@^1.2.0:\n   version \"1.3.0\"\n   resolved \"https://registry.yarnpkg.com/extsprintf/-/extsprintf-1.3.0.tgz#96918440e3041a7a414f8c52e3c574eb3c3e1e05\"\n \n+fast-deep-equal@^3.1.1:\n+  version \"3.1.3\"\n+  resolved \"https://registry.yarnpkg.com/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz#3a7d56b559d6cbc3eb512325244e619a65c6c525\"\n+  integrity sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==\n+\n+fast-json-stable-stringify@^2.0.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz#874bf69c6f404c2b5d99c481341399fd55892633\"\n+  integrity sha512-lhd/wF+Lk98HZoTCtlVraHtfh5XYijIjalXck7saUtuanSDyLMxnHhSXEDJqHxD7msR8D0uCmqlkwjCV8xvwHw==\n+\n fd-slicer@~1.1.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/fd-slicer/-/fd-slicer-1.1.0.tgz#25c7c89cb1f9077f8891bbe61d8f390eae256f1e\"\n@@ -528,42 +571,41 @@ forever-agent@~0.6.1:\n   version \"0.6.1\"\n   resolved \"https://registry.yarnpkg.com/forever-agent/-/forever-agent-0.6.1.tgz#fbc71f0c41adeb37f96c577ad1ed42d8fdacca91\"\n \n-form-data@~2.1.1:\n-  version \"2.1.4\"\n-  resolved \"https://registry.yarnpkg.com/form-data/-/form-data-2.1.4.tgz#33c183acf193276ecaa98143a69e94bfee1750d1\"\n+form-data@~2.3.2:\n+  version \"2.3.3\"\n+  resolved \"https://registry.yarnpkg.com/form-data/-/form-data-2.3.3.tgz#dcce52c05f644f298c6a7ab936bd724ceffbf3a6\"\n+  integrity sha512-1lLKB2Mu3aGP1Q/2eCOx0fNbRMe7XdwktwOruhfqqd0rIJWwN4Dh+E3hrPSlDCXnSR7UtZ1N38rVXm+6+MEhJQ==\n   dependencies:\n     asynckit \"^0.4.0\"\n-    combined-stream \"^1.0.5\"\n+    combined-stream \"^1.0.6\"\n     mime-types \"^2.1.12\"\n \n fs-constants@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/fs-constants/-/fs-constants-1.0.0.tgz#6be0de9be998ce16af8afc24497b9ee9b7ccd9ad\"\n   integrity sha512-y6OAwoSIf7FyjMIv94u+b5rdheZEjzR63GTyZJm5qh4Bi+2YgwLCcI/fPFZkL5PSixOt6ZNKm+w+Hfp/Bciwow==\n \n-fs-extra@~0.26.2:\n-  version \"0.26.7\"\n-  resolved \"https://registry.yarnpkg.com/fs-extra/-/fs-extra-0.26.7.tgz#9ae1fdd94897798edab76d0918cf42d0c3184fa9\"\n+fs-extra@^7.0.0:\n+  version \"7.0.1\"\n+  resolved \"https://registry.yarnpkg.com/fs-extra/-/fs-extra-7.0.1.tgz#4f189c44aa123b895f722804f55ea23eadc348e9\"\n+  integrity sha512-YJDaCJZEnBmcbw13fvdAM9AwNOJwOzrE4pqMqBq5nFiEqXUqHwlK4B+3pUw6JNvfSPtX05xFHtYy/1ni01eGCw==\n   dependencies:\n     graceful-fs \"^4.1.2\"\n-    jsonfile \"^2.1.0\"\n-    klaw \"^1.0.0\"\n-    path-is-absolute \"^1.0.0\"\n-    rimraf \"^2.2.8\"\n+    jsonfile \"^4.0.0\"\n+    universalify \"^0.1.0\"\n+\n+fs-minipass@^1.2.7:\n+  version \"1.2.7\"\n+  resolved \"https://registry.yarnpkg.com/fs-minipass/-/fs-minipass-1.2.7.tgz#ccff8570841e7fe4265693da88936c55aed7f7c7\"\n+  integrity sha512-GWSSJGFy4e9GUeCcbIkED+bgAoFyj7XF1mV8rma3QW4NIqX9Kyx79N/PF61H5udOV3aY1IaMLs6pGbH71nlCTA==\n+  dependencies:\n+    minipass \"^2.6.0\"\n \n fs.realpath@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/fs.realpath/-/fs.realpath-1.0.0.tgz#1504ad2523158caa40db4a2787cb01411994ea4f\"\n \n-fstream-ignore@^1.0.5:\n-  version \"1.0.5\"\n-  resolved \"https://registry.yarnpkg.com/fstream-ignore/-/fstream-ignore-1.0.5.tgz#9c31dae34767018fe1d249b24dada67d092da105\"\n-  dependencies:\n-    fstream \"^1.0.0\"\n-    inherits \"2\"\n-    minimatch \"^3.0.0\"\n-\n-fstream@^1.0.0, fstream@^1.0.10, fstream@^1.0.2:\n+fstream@^1.0.0, fstream@^1.0.2:\n   version \"1.0.11\"\n   resolved \"https://registry.yarnpkg.com/fstream/-/fstream-1.0.11.tgz#5c1fb1f117477114f0632a0eb4b71b3cb0fd3171\"\n   dependencies:\n@@ -626,20 +668,32 @@ glob@^7.1.3:\n     once \"^1.3.0\"\n     path-is-absolute \"^1.0.0\"\n \n-graceful-fs@^4.1.2, graceful-fs@^4.1.6, graceful-fs@^4.1.9:\n+glob@^9.2.0:\n+  version \"9.3.5\"\n+  resolved \"https://registry.yarnpkg.com/glob/-/glob-9.3.5.tgz#ca2ed8ca452781a3009685607fdf025a899dfe21\"\n+  integrity sha512-e1LleDykUz2Iu+MTYdkSsuWX8lvAjAcs0Xef0lNIu0S2wOAzuTxCJtcd9S3cijlwYF18EsU3rzb8jPVobxDh9Q==\n+  dependencies:\n+    fs.realpath \"^1.0.0\"\n+    minimatch \"^8.0.2\"\n+    minipass \"^4.2.4\"\n+    path-scurry \"^1.6.1\"\n+\n+graceful-fs@^4.1.2, graceful-fs@^4.1.6:\n   version \"4.1.11\"\n   resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.1.11.tgz#0e8bdfe4d1ddb8854d64e04ea7c00e2a026e5658\"\n \n-har-schema@^1.0.5:\n-  version \"1.0.5\"\n-  resolved \"https://registry.yarnpkg.com/har-schema/-/har-schema-1.0.5.tgz#d263135f43307c02c602afc8fe95970c0151369e\"\n+har-schema@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/har-schema/-/har-schema-2.0.0.tgz#a94c2224ebcac04782a0d9035521f24735b7ec92\"\n+  integrity sha512-Oqluz6zhGX8cyRaTQlFMPw80bSJVG2x/cFb8ZPhUILGgHka9SsokCCOQgpveePerqidZOrT14ipqfJb7ILcW5Q==\n \n-har-validator@~4.2.1:\n-  version \"4.2.1\"\n-  resolved \"https://registry.yarnpkg.com/har-validator/-/har-validator-4.2.1.tgz#33481d0f1bbff600dd203d75812a6a5fba002e2a\"\n+har-validator@~5.1.3:\n+  version \"5.1.5\"\n+  resolved \"https://registry.yarnpkg.com/har-validator/-/har-validator-5.1.5.tgz#1f0803b9f8cb20c0fa13822df1ecddb36bde1efd\"\n+  integrity sha512-nmT2T0lljbxdQZfspsno9hgrG3Uir6Ks5afism62poxqBM6sDnMEuPmzTq8XN0OEwqKLLdh1jQI3qyE66Nzb3w==\n   dependencies:\n-    ajv \"^4.9.1\"\n-    har-schema \"^1.0.5\"\n+    ajv \"^6.12.3\"\n+    har-schema \"^2.0.0\"\n \n has-flag@^2.0.0:\n   version \"2.0.0\"\n@@ -649,24 +703,11 @@ has-unicode@^2.0.0:\n   version \"2.0.1\"\n   resolved \"https://registry.yarnpkg.com/has-unicode/-/has-unicode-2.0.1.tgz#e0e6fe6a28cf51138855e086d1691e771de2a8b9\"\n \n-hawk@~3.1.3:\n-  version \"3.1.3\"\n-  resolved \"https://registry.yarnpkg.com/hawk/-/hawk-3.1.3.tgz#078444bd7c1640b0fe540d2c9b73d59678e8e1c4\"\n-  dependencies:\n-    boom \"2.x.x\"\n-    cryptiles \"2.x.x\"\n-    hoek \"2.x.x\"\n-    sntp \"1.x.x\"\n-\n he@^1.1.1:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/he/-/he-1.2.0.tgz#84ae65fa7eafb165fddb61566ae14baf05664f0f\"\n   integrity sha512-F/1DnUGPopORZi0ni+CvrCgHQ5FyEAHRLSApuYWMmrbSwoN2Mn/7k+Gl38gJnR7yyDZk6WLXwiGod1JOWNDKGw==\n \n-hoek@2.x.x:\n-  version \"2.16.3\"\n-  resolved \"https://registry.yarnpkg.com/hoek/-/hoek-2.16.3.tgz#20bb7403d3cea398e91dc4710a8ff1b8274a25ed\"\n-\n http-link-header@^0.8.0:\n   version \"0.8.0\"\n   resolved \"https://registry.yarnpkg.com/http-link-header/-/http-link-header-0.8.0.tgz#a22b41a0c9b1e2d8fac1bf1b697c6bd532d5f5e4\"\n@@ -692,11 +733,12 @@ http-server@^0.10.0:\n     portfinder \"^1.0.13\"\n     union \"~0.4.3\"\n \n-http-signature@~1.1.0:\n-  version \"1.1.1\"\n-  resolved \"https://registry.yarnpkg.com/http-signature/-/http-signature-1.1.1.tgz#df72e267066cd0ac67fb76adf8e134a8fbcf91bf\"\n+http-signature@~1.2.0:\n+  version \"1.2.0\"\n+  resolved \"https://registry.yarnpkg.com/http-signature/-/http-signature-1.2.0.tgz#9aecd925114772f3d95b65a60abb8f7c18fbace1\"\n+  integrity sha512-CAbnr6Rz4CYQkLYUtSNXxQPUH2gK8f3iWexVlsnMeD+GjlsQ0Xsy1cOX+mN3dtxYomRy21CiOzU8Uhw6OwncEQ==\n   dependencies:\n-    assert-plus \"^0.2.0\"\n+    assert-plus \"^1.0.0\"\n     jsprim \"^1.2.2\"\n     sshpk \"^1.7.0\"\n \n@@ -712,11 +754,25 @@ https-proxy-agent@5.0.1, https-proxy-agent@^5.0.0:\n     agent-base \"6\"\n     debug \"4\"\n \n+iconv-lite@^0.4.4:\n+  version \"0.4.24\"\n+  resolved \"https://registry.yarnpkg.com/iconv-lite/-/iconv-lite-0.4.24.tgz#2022b4b25fbddc21d2f524974a474aafe733908b\"\n+  integrity sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==\n+  dependencies:\n+    safer-buffer \">= 2.1.2 < 3\"\n+\n ieee754@^1.1.13:\n   version \"1.2.1\"\n   resolved \"https://registry.yarnpkg.com/ieee754/-/ieee754-1.2.1.tgz#8eb7a10a63fff25d15a57b001586d177d1b0d352\"\n   integrity sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==\n \n+ignore-walk@^3.0.1:\n+  version \"3.0.4\"\n+  resolved \"https://registry.yarnpkg.com/ignore-walk/-/ignore-walk-3.0.4.tgz#c9a09f69b7c7b479a5d74ac1a3c0d4236d2a6335\"\n+  integrity sha512-PY6Ii8o1jMRA1z4F2hRkH/xN59ox43DavKvD3oDpfurRlOJyAHpifIwpbdv1n4jt4ov0jSpw3kQ4GhJnpBL6WQ==\n+  dependencies:\n+    minimatch \"^3.0.4\"\n+\n image-ssim@^0.2.0:\n   version \"0.2.0\"\n   resolved \"https://registry.yarnpkg.com/image-ssim/-/image-ssim-0.2.0.tgz#83b42c7a2e6e4b85505477fe6917f5dbc56420e5\"\n@@ -815,30 +871,31 @@ jsbn@~0.1.0:\n   version \"0.1.1\"\n   resolved \"https://registry.yarnpkg.com/jsbn/-/jsbn-0.1.1.tgz#a5e654c2e5a2deb5f201d96cefbca80c0ef2f513\"\n \n+json-schema-traverse@^0.4.1:\n+  version \"0.4.1\"\n+  resolved \"https://registry.yarnpkg.com/json-schema-traverse/-/json-schema-traverse-0.4.1.tgz#69f6a87d9513ab8bb8fe63bdb0979c448e684660\"\n+  integrity sha512-xbbCH5dCYU5T8LcEhhuh7HJ88HXuW3qsI3Y0zOZFKfZEHcpWiHU/Jxzk629Brsab/mMiHQti9wMP+845RPe3Vg==\n+\n json-schema@0.2.3:\n   version \"0.2.3\"\n   resolved \"https://registry.yarnpkg.com/json-schema/-/json-schema-0.2.3.tgz#b480c892e59a2f05954ce727bd3f2a4e882f9e13\"\n \n-json-stable-stringify@^1.0.1:\n-  version \"1.0.1\"\n-  resolved \"https://registry.yarnpkg.com/json-stable-stringify/-/json-stable-stringify-1.0.1.tgz#9a759d39c5f2ff503fd5300646ed445f88c4f9af\"\n-  dependencies:\n-    jsonify \"~0.0.0\"\n-\n json-stringify-safe@~5.0.1:\n   version \"5.0.1\"\n   resolved \"https://registry.yarnpkg.com/json-stringify-safe/-/json-stringify-safe-5.0.1.tgz#1296a2d58fd45f19a0f6ce01d65701e2c735b6eb\"\n \n-jsonfile@^2.1.0:\n-  version \"2.4.0\"\n-  resolved \"https://registry.yarnpkg.com/jsonfile/-/jsonfile-2.4.0.tgz#3736a2b428b87bbda0cc83b53fa3d633a35c2ae8\"\n+json5@^2.1.0:\n+  version \"2.2.3\"\n+  resolved \"https://registry.yarnpkg.com/json5/-/json5-2.2.3.tgz#78cd6f1a19bdc12b73db5ad0c61efd66c1e29283\"\n+  integrity sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==\n+\n+jsonfile@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/jsonfile/-/jsonfile-4.0.0.tgz#8771aae0799b64076b76640fca058f9c10e33ecb\"\n+  integrity sha512-m6F1R3z8jjlf2imQHS2Qez5sjKWQzbuuhuJ/FKYFRZvPE3PuHcSMVZzfsLhGVOkfd20obL5SWEBew5ShlquNxg==\n   optionalDependencies:\n     graceful-fs \"^4.1.6\"\n \n-jsonify@~0.0.0:\n-  version \"0.0.0\"\n-  resolved \"https://registry.yarnpkg.com/jsonify/-/jsonify-0.0.0.tgz#2c74b6ee41d93ca51b7b5aaee8f503631d252a73\"\n-\n jsprim@^1.2.2:\n   version \"1.4.1\"\n   resolved \"https://registry.yarnpkg.com/jsprim/-/jsprim-1.4.1.tgz#313e66bc1e5cc06e438bc1b7499c2e5c56acb6a2\"\n@@ -848,12 +905,6 @@ jsprim@^1.2.2:\n     json-schema \"0.2.3\"\n     verror \"1.10.0\"\n \n-klaw@^1.0.0:\n-  version \"1.3.1\"\n-  resolved \"https://registry.yarnpkg.com/klaw/-/klaw-1.3.1.tgz#4088433b46b3b1ba259d78785d8e96f73ba02439\"\n-  optionalDependencies:\n-    graceful-fs \"^4.1.9\"\n-\n lighthouse-logger@^1.0.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/lighthouse-logger/-/lighthouse-logger-1.2.0.tgz#b76d56935e9c137e86a04741f6bb9b2776e886ca\"\n@@ -915,11 +966,7 @@ locate-path@^5.0.0:\n   dependencies:\n     p-locate \"^4.1.0\"\n \n-lodash@^4.13.1:\n-  version \"4.17.4\"\n-  resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.4.tgz#78203a4d1c328ae1d86dca6460e369b57f4055ae\"\n-\n-lodash@^4.17.21:\n+lodash@^4.17.11, lodash@^4.17.19, lodash@^4.17.21:\n   version \"4.17.21\"\n   resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.21.tgz#679591c564c3bffaae8454cf0b3df370c3d6911c\"\n   integrity sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==\n@@ -929,6 +976,11 @@ lookup-closest-locale@6.2.0:\n   resolved \"https://registry.yarnpkg.com/lookup-closest-locale/-/lookup-closest-locale-6.2.0.tgz#57f665e604fd26f77142d48152015402b607bcf3\"\n   integrity sha512-/c2kL+Vnp1jnV6K6RpDTHK3dgg0Tu2VVp+elEiJpjfS1UyY7AjOYHohRug6wT0OpoX2qFgNORndE9RqesfVxWQ==\n \n+lru-cache@^10.2.0:\n+  version \"10.2.2\"\n+  resolved \"https://registry.yarnpkg.com/lru-cache/-/lru-cache-10.2.2.tgz#48206bc114c1252940c41b25b41af5b545aca878\"\n+  integrity sha512-9hp3Vp2/hFQUiIwKo8XCeFVnrg8Pk3TYNPIR7tJADKi5YfcF7vEaK7avFHTlSy3kOKYaJQaalfEo6YuXdceBOQ==\n+\n lru_map@^0.3.3:\n   version \"0.3.3\"\n   resolved \"https://registry.yarnpkg.com/lru_map/-/lru_map-0.3.3.tgz#b5c8351b9464cbd750335a79650a0ec0e56118dd\"\n@@ -956,22 +1008,34 @@ metaviewport-parser@0.2.0:\n   resolved \"https://registry.yarnpkg.com/metaviewport-parser/-/metaviewport-parser-0.2.0.tgz#535c3ce1ccf6223a5025fddc6a1c36505f7e7db1\"\n   integrity sha1-U1w84cz2IjpQJf3cahw2UF9+fbE=\n \n+mime-db@1.52.0:\n+  version \"1.52.0\"\n+  resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.52.0.tgz#bbabcdc02859f4987301c856e3387ce5ec43bf70\"\n+  integrity sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==\n+\n mime-db@~1.29.0:\n   version \"1.29.0\"\n   resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.29.0.tgz#48d26d235589651704ac5916ca06001914266878\"\n \n-mime-types@^2.1.12, mime-types@~2.1.7:\n+mime-types@^2.1.12:\n   version \"2.1.16\"\n   resolved \"https://registry.yarnpkg.com/mime-types/-/mime-types-2.1.16.tgz#2b858a52e5ecd516db897ac2be87487830698e23\"\n   dependencies:\n     mime-db \"~1.29.0\"\n \n+mime-types@~2.1.19:\n+  version \"2.1.35\"\n+  resolved \"https://registry.yarnpkg.com/mime-types/-/mime-types-2.1.35.tgz#381a871b62a734450660ae3deee44813f70d959a\"\n+  integrity sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==\n+  dependencies:\n+    mime-db \"1.52.0\"\n+\n mime@^1.2.11, mime@^1.3.6:\n   version \"1.6.0\"\n   resolved \"https://registry.yarnpkg.com/mime/-/mime-1.6.0.tgz#32cd9e5c64553bd58d19a568af452acff04981b1\"\n   integrity sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==\n \n-minimatch@^3.0.0, minimatch@^3.0.2, minimatch@^3.0.4:\n+minimatch@^3.0.4:\n   version \"3.0.4\"\n   resolved \"https://registry.yarnpkg.com/minimatch/-/minimatch-3.0.4.tgz#5166e286457f03306064be5497e8dbb0c3d32083\"\n   dependencies:\n@@ -984,6 +1048,13 @@ minimatch@^3.1.1:\n   dependencies:\n     brace-expansion \"^1.1.7\"\n \n+minimatch@^8.0.2:\n+  version \"8.0.4\"\n+  resolved \"https://registry.yarnpkg.com/minimatch/-/minimatch-8.0.4.tgz#847c1b25c014d4e9a7f68aaf63dedd668a626229\"\n+  integrity sha512-W0Wvr9HyFXZRGIDgCicunpQ299OKXs9RgZfaukz4qAW/pJhcpUfupc9c+OObPOFueNy8VSrZgEmDtk6Kh4WzDA==\n+  dependencies:\n+    brace-expansion \"^2.0.1\"\n+\n minimist@0.0.8:\n   version \"0.0.8\"\n   resolved \"https://registry.yarnpkg.com/minimist/-/minimist-0.0.8.tgz#857fcabfc3397d2625b8228262e86aa7a011b05d\"\n@@ -1002,6 +1073,31 @@ minimist@~0.0.1:\n   version \"0.0.10\"\n   resolved \"https://registry.yarnpkg.com/minimist/-/minimist-0.0.10.tgz#de3f98543dbf96082be48ad1a0c7cda836301dcf\"\n \n+minipass@^2.6.0, minipass@^2.9.0:\n+  version \"2.9.0\"\n+  resolved \"https://registry.yarnpkg.com/minipass/-/minipass-2.9.0.tgz#e713762e7d3e32fed803115cf93e04bca9fcc9a6\"\n+  integrity sha512-wxfUjg9WebH+CUDX/CdbRlh5SmfZiy/hpkxaRI16Y9W56Pa75sWgd/rvFilSgrauD9NyFymP/+JFV3KwzIsJeg==\n+  dependencies:\n+    safe-buffer \"^5.1.2\"\n+    yallist \"^3.0.0\"\n+\n+minipass@^4.2.4:\n+  version \"4.2.8\"\n+  resolved \"https://registry.yarnpkg.com/minipass/-/minipass-4.2.8.tgz#f0010f64393ecfc1d1ccb5f582bcaf45f48e1a3a\"\n+  integrity sha512-fNzuVyifolSLFL4NzpF+wEF4qrgqaaKX0haXPQEdQ7NKAN+WecoKMHV09YcuL/DHxrUsYQOK3MiuDf7Ip2OXfQ==\n+\n+\"minipass@^5.0.0 || ^6.0.2 || ^7.0.0\":\n+  version \"7.1.2\"\n+  resolved \"https://registry.yarnpkg.com/minipass/-/minipass-7.1.2.tgz#93a9626ce5e5e66bd4db86849e7515e92340a707\"\n+  integrity sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==\n+\n+minizlib@^1.3.3:\n+  version \"1.3.3\"\n+  resolved \"https://registry.yarnpkg.com/minizlib/-/minizlib-1.3.3.tgz#2290de96818a34c29551c8a8d301216bd65a861d\"\n+  integrity sha512-6ZYMOEnmVsdCeTJVE0W9ZD+pVnE8h9Hma/iOwwRDsdQoePpoX56/8B6z3P9VNwppJuBKNRuFDRNRqRWexT9G9Q==\n+  dependencies:\n+    minipass \"^2.9.0\"\n+\n mkdirp-classic@^0.5.2:\n   version \"0.5.3\"\n   resolved \"https://registry.yarnpkg.com/mkdirp-classic/-/mkdirp-classic-0.5.3.tgz#fa10c9115cc6d8865be221ba47ee9bed78601113\"\n@@ -1013,7 +1109,7 @@ mkdirp@0.5.x, \"mkdirp@>=0.5 0\", mkdirp@^0.5.0, mkdirp@^0.5.1:\n   dependencies:\n     minimist \"0.0.8\"\n \n-mkdirp@^0.5.3:\n+mkdirp@^0.5.3, mkdirp@^0.5.5:\n   version \"0.5.6\"\n   resolved \"https://registry.yarnpkg.com/mkdirp/-/mkdirp-0.5.6.tgz#7def03d2432dcae4ba1d611445c48396062255f6\"\n   integrity sha512-FP+p8RB8OWpF3YZBCrP5gtADmtXApB5AMLn+vdyA+PyxCjrCs00mjyUozssO33cwDeT3wNGdLxJ5M//YqtHAJw==\n@@ -1029,69 +1125,91 @@ ms@2.1.2:\n   resolved \"https://registry.yarnpkg.com/ms/-/ms-2.1.2.tgz#d09d1f357b443f493382a8eb3ccd183872ae6009\"\n   integrity sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w==\n \n-nan@^2.2.0:\n-  version \"2.6.2\"\n-  resolved \"https://registry.yarnpkg.com/nan/-/nan-2.6.2.tgz#e4ff34e6c95fdfb5aecc08de6596f43605a7db45\"\n+ms@^2.1.1:\n+  version \"2.1.3\"\n+  resolved \"https://registry.yarnpkg.com/ms/-/ms-2.1.3.tgz#574c8138ce1d2b5861f0b44579dbadd60c6615b2\"\n+  integrity sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==\n+\n+nan@^2.11.1:\n+  version \"2.19.0\"\n+  resolved \"https://registry.yarnpkg.com/nan/-/nan-2.19.0.tgz#bb58122ad55a6c5bc973303908d5b16cfdd5a8c0\"\n+  integrity sha512-nO1xXxfh/RWNxfd/XPfbIfFk5vgLsAxUR9y5O0cHMJu/AW9U95JLXqthYHjEp+8gQ5p96K9jUp8nbVOxCdRbtw==\n \n ncp@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/ncp/-/ncp-2.0.0.tgz#195a21d6c46e361d2fb1281ba38b91e9df7bdbb3\"\n \n+needle@^2.2.1:\n+  version \"2.9.1\"\n+  resolved \"https://registry.yarnpkg.com/needle/-/needle-2.9.1.tgz#22d1dffbe3490c2b83e301f7709b6736cd8f2684\"\n+  integrity sha512-6R9fqJ5Zcmf+uYaFgdIHmLwNldn5HbK8L5ybn7Uz+ylX/rnOsSp1AHcvQSrCaFN+qNM1wpymHqD7mVasEOlHGQ==\n+  dependencies:\n+    debug \"^3.2.6\"\n+    iconv-lite \"^0.4.4\"\n+    sax \"^1.2.4\"\n+\n node-fetch@2.6.7:\n   version \"2.6.7\"\n   resolved \"https://registry.yarnpkg.com/node-fetch/-/node-fetch-2.6.7.tgz#24de9fba827e3b4ae44dc8b20256a379160052ad\"\n   integrity sha512-ZjMPFEfVx5j+y2yF35Kzx5sF7kDzxuDj6ziH4FFbOp87zKDZNx8yExJIb05OGF4Nlt9IHFIMBkRl41VdvcNdbQ==\n   dependencies:\n     whatwg-url \"^5.0.0\"\n \n-node-gyp@^3.5.0:\n-  version \"3.6.2\"\n-  resolved \"https://registry.yarnpkg.com/node-gyp/-/node-gyp-3.6.2.tgz#9bfbe54562286284838e750eac05295853fa1c60\"\n+node-gyp@^3.8.0:\n+  version \"3.8.0\"\n+  resolved \"https://registry.yarnpkg.com/node-gyp/-/node-gyp-3.8.0.tgz#540304261c330e80d0d5edce253a68cb3964218c\"\n+  integrity sha512-3g8lYefrRRzvGeSowdJKAKyks8oUpLEd/DyPV4eMhVlhJ0aNaZqIrNUIPuEWWTAoPqyFkfGrM67MC69baqn6vA==\n   dependencies:\n     fstream \"^1.0.0\"\n     glob \"^7.0.3\"\n     graceful-fs \"^4.1.2\"\n-    minimatch \"^3.0.2\"\n     mkdirp \"^0.5.0\"\n     nopt \"2 || 3\"\n     npmlog \"0 || 1 || 2 || 3 || 4\"\n     osenv \"0\"\n-    request \"2\"\n+    request \"^2.87.0\"\n     rimraf \"2\"\n     semver \"~5.3.0\"\n     tar \"^2.0.0\"\n     which \"1\"\n \n-node-pre-gyp@~0.6.32:\n-  version \"0.6.36\"\n-  resolved \"https://registry.yarnpkg.com/node-pre-gyp/-/node-pre-gyp-0.6.36.tgz#db604112cb74e0d477554e9b505b17abddfab786\"\n+node-pre-gyp@^0.11.0:\n+  version \"0.11.0\"\n+  resolved \"https://registry.yarnpkg.com/node-pre-gyp/-/node-pre-gyp-0.11.0.tgz#db1f33215272f692cd38f03238e3e9b47c5dd054\"\n+  integrity sha512-TwWAOZb0j7e9eGaf9esRx3ZcLaE5tQ2lvYy1pb5IAaG1a2e2Kv5Lms1Y4hpj+ciXJRofIxxlt5haeQ/2ANeE0Q==\n   dependencies:\n+    detect-libc \"^1.0.2\"\n     mkdirp \"^0.5.1\"\n+    needle \"^2.2.1\"\n     nopt \"^4.0.1\"\n+    npm-packlist \"^1.1.6\"\n     npmlog \"^4.0.2\"\n-    rc \"^1.1.7\"\n-    request \"^2.81.0\"\n+    rc \"^1.2.7\"\n     rimraf \"^2.6.1\"\n     semver \"^5.3.0\"\n-    tar \"^2.2.1\"\n-    tar-pack \"^3.4.0\"\n+    tar \"^4\"\n \n nodegit-promise@~4.0.0:\n   version \"4.0.0\"\n   resolved \"https://registry.yarnpkg.com/nodegit-promise/-/nodegit-promise-4.0.0.tgz#5722b184f2df7327161064a791d2e842c9167b34\"\n   dependencies:\n     asap \"~2.0.3\"\n \n-nodegit@^0.18.3:\n-  version \"0.18.3\"\n-  resolved \"https://registry.yarnpkg.com/nodegit/-/nodegit-0.18.3.tgz#305b6a305ea485fe5f1679fe37e6224a669ae9fc\"\n-  dependencies:\n-    fs-extra \"~0.26.2\"\n-    lodash \"^4.13.1\"\n-    nan \"^2.2.0\"\n-    node-gyp \"^3.5.0\"\n-    node-pre-gyp \"~0.6.32\"\n+nodegit@^0.23.0:\n+  version \"0.23.1\"\n+  resolved \"https://registry.yarnpkg.com/nodegit/-/nodegit-0.23.1.tgz#937c2cc998bbed3cef0b138131fee3a2672458af\"\n+  integrity sha512-k1bCg260yZlmfLGYPrinqAQNbQ6PnBJhKq6wWfe94yIO3WnOOyoSuweAkAGPR6FhrGq2LkCKHdJaitwhKCEGyA==\n+  dependencies:\n+    fs-extra \"^7.0.0\"\n+    json5 \"^2.1.0\"\n+    lodash \"^4.17.11\"\n+    nan \"^2.11.1\"\n+    node-gyp \"^3.8.0\"\n+    node-pre-gyp \"^0.11.0\"\n     promisify-node \"~0.3.0\"\n+    ramda \"^0.25.0\"\n+    request-promise-native \"^1.0.5\"\n+    tar-fs \"^1.16.3\"\n \n \"nopt@2 || 3\":\n   version \"3.0.6\"\n@@ -1106,6 +1224,27 @@ nopt@^4.0.1:\n     abbrev \"1\"\n     osenv \"^0.1.4\"\n \n+npm-bundled@^1.0.1:\n+  version \"1.1.2\"\n+  resolved \"https://registry.yarnpkg.com/npm-bundled/-/npm-bundled-1.1.2.tgz#944c78789bd739035b70baa2ca5cc32b8d860bc1\"\n+  integrity sha512-x5DHup0SuyQcmL3s7Rx/YQ8sbw/Hzg0rj48eN0dV7hf5cmQq5PXIeioroH3raV1QC1yh3uTYuMThvEQF3iKgGQ==\n+  dependencies:\n+    npm-normalize-package-bin \"^1.0.1\"\n+\n+npm-normalize-package-bin@^1.0.1:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/npm-normalize-package-bin/-/npm-normalize-package-bin-1.0.1.tgz#6e79a41f23fd235c0623218228da7d9c23b8f6e2\"\n+  integrity sha512-EPfafl6JL5/rU+ot6P3gRSCpPDW5VmIzX959Ob1+ySFUuuYHWHekXpwdUZcKP5C+DS4GEtdJluwBjnsNDl+fSA==\n+\n+npm-packlist@^1.1.6:\n+  version \"1.4.8\"\n+  resolved \"https://registry.yarnpkg.com/npm-packlist/-/npm-packlist-1.4.8.tgz#56ee6cc135b9f98ad3d51c1c95da22bbb9b2ef3e\"\n+  integrity sha512-5+AZgwru5IevF5ZdnFglB5wNlHG1AOOuw28WhUq8/8emhBmLv6jX5by4WJCh7lW0uSYZYS6DXqIsyZVIXRZU9A==\n+  dependencies:\n+    ignore-walk \"^3.0.1\"\n+    npm-bundled \"^1.0.1\"\n+    npm-normalize-package-bin \"^1.0.1\"\n+\n \"npmlog@0 || 1 || 2 || 3 || 4\", npmlog@^4.0.2:\n   version \"4.1.2\"\n   resolved \"https://registry.yarnpkg.com/npmlog/-/npmlog-4.1.2.tgz#08a7f2a8bf734604779a9efa4ad5cc717abb954b\"\n@@ -1119,15 +1258,16 @@ number-is-nan@^1.0.0:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/number-is-nan/-/number-is-nan-1.0.1.tgz#097b602b53422a522c1afb8790318336941a011d\"\n \n-oauth-sign@~0.8.1:\n-  version \"0.8.2\"\n-  resolved \"https://registry.yarnpkg.com/oauth-sign/-/oauth-sign-0.8.2.tgz#46a6ab7f0aead8deae9ec0565780b7d4efeb9d43\"\n+oauth-sign@~0.9.0:\n+  version \"0.9.0\"\n+  resolved \"https://registry.yarnpkg.com/oauth-sign/-/oauth-sign-0.9.0.tgz#47a7b016baa68b5fa0ecf3dee08a85c679ac6455\"\n+  integrity sha512-fexhUFFPTGV8ybAtSIGbV6gOkSv8UtRbDBnAyLQw4QPKkgNlsH2ByPGtMUqdWkos6YCRmAqViwgZrJc/mRDzZQ==\n \n object-assign@^4.1.0:\n   version \"4.1.1\"\n   resolved \"https://registry.yarnpkg.com/object-assign/-/object-assign-4.1.1.tgz#2109adc7965887cfc05cbbd442cac8bfbb360863\"\n \n-once@^1.3.0, once@^1.3.1, once@^1.3.3, once@^1.4.0:\n+once@^1.3.0, once@^1.3.1, once@^1.4.0:\n   version \"1.4.0\"\n   resolved \"https://registry.yarnpkg.com/once/-/once-1.4.0.tgz#583b1aa775961d4b113ac17d9c50baef9dd76bd1\"\n   dependencies:\n@@ -1201,14 +1341,23 @@ path-is-absolute@^1.0.0:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/path-is-absolute/-/path-is-absolute-1.0.1.tgz#174b9268735534ffbc7ace6bf53a5a9e1b5c5f5f\"\n \n+path-scurry@^1.6.1:\n+  version \"1.11.1\"\n+  resolved \"https://registry.yarnpkg.com/path-scurry/-/path-scurry-1.11.1.tgz#7960a668888594a0720b12a911d1a742ab9f11d2\"\n+  integrity sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==\n+  dependencies:\n+    lru-cache \"^10.2.0\"\n+    minipass \"^5.0.0 || ^6.0.2 || ^7.0.0\"\n+\n pend@~1.2.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/pend/-/pend-1.2.0.tgz#7a57eb550a6783f9115331fcf4663d5c8e007a50\"\n   integrity sha512-F3asv42UuXchdzt+xXqfW1OGlVBe+mxa2mqI0pg5yAHZPvFmY3Y6drSf/GQ1A86WgWEN9Kzh/WrgKa6iGcHXLg==\n \n-performance-now@^0.2.0:\n-  version \"0.2.0\"\n-  resolved \"https://registry.yarnpkg.com/performance-now/-/performance-now-0.2.0.tgz#33ef30c5c77d4ea21c5a53869d91b56d8f2555e5\"\n+performance-now@^2.1.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/performance-now/-/performance-now-2.1.0.tgz#6309f4e0e5fa913ec1c69307ae364b4b377c9e7b\"\n+  integrity sha512-7EAHlyLHI56VEIdK57uwHdHKIaAGbnXPiw0yWbarQZOKaKpvUIgW0jWRVLiatnM+XXlSwsanIBH/hzGMJulMow==\n \n pkg-dir@4.2.0:\n   version \"4.2.0\"\n@@ -1229,6 +1378,11 @@ process-nextick-args@~1.0.6:\n   version \"1.0.7\"\n   resolved \"https://registry.yarnpkg.com/process-nextick-args/-/process-nextick-args-1.0.7.tgz#150e20b756590ad3f91093f25a4f2ad8bff30ba3\"\n \n+process-nextick-args@~2.0.0:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/process-nextick-args/-/process-nextick-args-2.0.1.tgz#7820d9b16120cc55ca9ae7792680ae7dba6d7fe2\"\n+  integrity sha512-3ouUOpQhtgrbOa17J7+uxOTpITYWaGP7/AhoR3+A+/1e9skrzelGi/dXzEYyvbxubEF6Wn2ypscTKiKJFFn1ag==\n+\n progress@2.0.3:\n   version \"2.0.3\"\n   resolved \"https://registry.yarnpkg.com/progress/-/progress-2.0.3.tgz#7e8cf8d8f5b8f239c1bc68beb4eb78567d572ef8\"\n@@ -1250,6 +1404,19 @@ ps-list@^8.0.0:\n   resolved \"https://registry.yarnpkg.com/ps-list/-/ps-list-8.1.1.tgz#9ff1952b26a9a07fcc05270407e60544237ae581\"\n   integrity sha512-OPS9kEJYVmiO48u/B9qneqhkMvgCxT+Tm28VCEJpheTpl8cJ0ffZRRNgS5mrQRTrX5yRTpaJ+hRDeefXYmmorQ==\n \n+psl@^1.1.28:\n+  version \"1.9.0\"\n+  resolved \"https://registry.yarnpkg.com/psl/-/psl-1.9.0.tgz#d0df2a137f00794565fcaf3b2c00cd09f8d5a5a7\"\n+  integrity sha512-E/ZsdU4HLs/68gYzgGTkMicWTLPdAftJLfJFlLUAAKZGkStNU72sZjT66SnMDVOfOWY/YAoiD7Jxa9iHvngcag==\n+\n+pump@^1.0.0:\n+  version \"1.0.3\"\n+  resolved \"https://registry.yarnpkg.com/pump/-/pump-1.0.3.tgz#5dfe8311c33bbf6fc18261f9f34702c47c08a954\"\n+  integrity sha512-8k0JupWme55+9tCVE+FS5ULT3K6AbgqrGa58lTT49RpyfwwcGedHqaC5LlQNdEAumn/wFsu6aPwkuPMioy8kqw==\n+  dependencies:\n+    end-of-stream \"^1.1.0\"\n+    once \"^1.3.1\"\n+\n pump@^3.0.0:\n   version \"3.0.0\"\n   resolved \"https://registry.yarnpkg.com/pump/-/pump-3.0.0.tgz#b4a2116815bde2f4e1ea602354e8c75565107a64\"\n@@ -1258,9 +1425,10 @@ pump@^3.0.0:\n     end-of-stream \"^1.1.0\"\n     once \"^1.3.1\"\n \n-punycode@^1.4.1:\n-  version \"1.4.1\"\n-  resolved \"https://registry.yarnpkg.com/punycode/-/punycode-1.4.1.tgz#c0d5a63b2718800ad8e1eb0fa5269c84dd41845e\"\n+punycode@^2.1.0, punycode@^2.1.1:\n+  version \"2.3.1\"\n+  resolved \"https://registry.yarnpkg.com/punycode/-/punycode-2.3.1.tgz#027422e2faec0b25e1549c3e1bd8309b9133b6e5\"\n+  integrity sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==\n \n puppeteer-core@^13.7.0:\n   version \"13.7.0\"\n@@ -1284,20 +1452,27 @@ qs@~2.3.3:\n   version \"2.3.3\"\n   resolved \"https://registry.yarnpkg.com/qs/-/qs-2.3.3.tgz#e9e85adbe75da0bbe4c8e0476a086290f863b404\"\n \n-qs@~6.4.0:\n-  version \"6.4.0\"\n-  resolved \"https://registry.yarnpkg.com/qs/-/qs-6.4.0.tgz#13e26d28ad6b0ffaa91312cd3bf708ed351e7233\"\n+qs@~6.5.2:\n+  version \"6.5.3\"\n+  resolved \"https://registry.yarnpkg.com/qs/-/qs-6.5.3.tgz#3aeeffc91967ef6e35c0e488ef46fb296ab76aad\"\n+  integrity sha512-qxXIEh4pCGfHICj1mAJQ2/2XVZkjCDTcEgfoSQxc/fYivUZxTkk7L3bDBJSoNrEzXI17oUO5Dp07ktqE5KzczA==\n \n-rc@^1.1.7:\n-  version \"1.2.1\"\n-  resolved \"https://registry.yarnpkg.com/rc/-/rc-1.2.1.tgz#2e03e8e42ee450b8cb3dce65be1bf8974e1dfd95\"\n+ramda@^0.25.0:\n+  version \"0.25.0\"\n+  resolved \"https://registry.yarnpkg.com/ramda/-/ramda-0.25.0.tgz#8fdf68231cffa90bc2f9460390a0cb74a29b29a9\"\n+  integrity sha512-GXpfrYVPwx3K7RQ6aYT8KPS8XViSXUVJT1ONhoKPE9VAleW42YE+U+8VEyGWt41EnEQW7gwecYJriTI0pKoecQ==\n+\n+rc@^1.2.7:\n+  version \"1.2.8\"\n+  resolved \"https://registry.yarnpkg.com/rc/-/rc-1.2.8.tgz#cd924bf5200a075b83c188cd6b9e211b7fc0d3ed\"\n+  integrity sha512-y3bGgqKj3QBdxLbLkomlohkvsA8gdAiUQlSBJnBhfn+BPxg4bc62d8TcBW15wavDfgexCgccckhcZvywyQYPOw==\n   dependencies:\n-    deep-extend \"~0.4.0\"\n+    deep-extend \"^0.6.0\"\n     ini \"~1.3.0\"\n     minimist \"^1.2.0\"\n     strip-json-comments \"~2.0.1\"\n \n-readable-stream@^2.0.6, readable-stream@^2.1.4:\n+readable-stream@^2.0.6:\n   version \"2.3.3\"\n   resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-2.3.3.tgz#368f2512d79f9d46fdfc71349ae7878bbc1eb95c\"\n   dependencies:\n@@ -1309,6 +1484,19 @@ readable-stream@^2.0.6, readable-stream@^2.1.4:\n     string_decoder \"~1.0.3\"\n     util-deprecate \"~1.0.1\"\n \n+readable-stream@^2.3.0, readable-stream@^2.3.5:\n+  version \"2.3.8\"\n+  resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-2.3.8.tgz#91125e8042bba1b9887f49345f6277027ce8be9b\"\n+  integrity sha512-8p0AUk4XODgIewSi0l8Epjs+EVnWiK7NoDIEGU0HhE7+ZyY8D1IMY7odu5lRrFXGg71L15KG8QrPmum45RTtdA==\n+  dependencies:\n+    core-util-is \"~1.0.0\"\n+    inherits \"~2.0.3\"\n+    isarray \"~1.0.0\"\n+    process-nextick-args \"~2.0.0\"\n+    safe-buffer \"~5.1.1\"\n+    string_decoder \"~1.1.1\"\n+    util-deprecate \"~1.0.1\"\n+\n readable-stream@^3.1.1, readable-stream@^3.4.0:\n   version \"3.6.2\"\n   resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-3.6.2.tgz#56a9b36ea965c00c5a93ef31eb111a0f11056967\"\n@@ -1318,32 +1506,47 @@ readable-stream@^3.1.1, readable-stream@^3.4.0:\n     string_decoder \"^1.1.1\"\n     util-deprecate \"^1.0.1\"\n \n-request@2, request@^2.81.0:\n-  version \"2.81.0\"\n-  resolved \"https://registry.yarnpkg.com/request/-/request-2.81.0.tgz#c6928946a0e06c5f8d6f8a9333469ffda46298a0\"\n+request-promise-core@1.1.4:\n+  version \"1.1.4\"\n+  resolved \"https://registry.yarnpkg.com/request-promise-core/-/request-promise-core-1.1.4.tgz#3eedd4223208d419867b78ce815167d10593a22f\"\n+  integrity sha512-TTbAfBBRdWD7aNNOoVOBH4pN/KigV6LyapYNNlAPA8JwbovRti1E88m3sYAwsLi5ryhPKsE9APwnjFTgdUjTpw==\n   dependencies:\n-    aws-sign2 \"~0.6.0\"\n-    aws4 \"^1.2.1\"\n+    lodash \"^4.17.19\"\n+\n+request-promise-native@^1.0.5:\n+  version \"1.0.9\"\n+  resolved \"https://registry.yarnpkg.com/request-promise-native/-/request-promise-native-1.0.9.tgz#e407120526a5efdc9a39b28a5679bf47b9d9dc28\"\n+  integrity sha512-wcW+sIUiWnKgNY0dqCpOZkUbF/I+YPi+f09JZIDa39Ec+q82CpSYniDp+ISgTTbKmnpJWASeJBPZmoxH84wt3g==\n+  dependencies:\n+    request-promise-core \"1.1.4\"\n+    stealthy-require \"^1.1.1\"\n+    tough-cookie \"^2.3.3\"\n+\n+request@^2.87.0:\n+  version \"2.88.2\"\n+  resolved \"https://registry.yarnpkg.com/request/-/request-2.88.2.tgz#d73c918731cb5a87da047e207234146f664d12b3\"\n+  integrity sha512-MsvtOrfG9ZcrOwAW+Qi+F6HbD0CWXEh9ou77uOb7FM2WPhwT7smM833PzanhJLsgXjN89Ir6V2PczXNnMpwKhw==\n+  dependencies:\n+    aws-sign2 \"~0.7.0\"\n+    aws4 \"^1.8.0\"\n     caseless \"~0.12.0\"\n-    combined-stream \"~1.0.5\"\n-    extend \"~3.0.0\"\n+    combined-stream \"~1.0.6\"\n+    extend \"~3.0.2\"\n     forever-agent \"~0.6.1\"\n-    form-data \"~2.1.1\"\n-    har-validator \"~4.2.1\"\n-    hawk \"~3.1.3\"\n-    http-signature \"~1.1.0\"\n+    form-data \"~2.3.2\"\n+    har-validator \"~5.1.3\"\n+    http-signature \"~1.2.0\"\n     is-typedarray \"~1.0.0\"\n     isstream \"~0.1.2\"\n     json-stringify-safe \"~5.0.1\"\n-    mime-types \"~2.1.7\"\n-    oauth-sign \"~0.8.1\"\n-    performance-now \"^0.2.0\"\n-    qs \"~6.4.0\"\n-    safe-buffer \"^5.0.1\"\n-    stringstream \"~0.0.4\"\n-    tough-cookie \"~2.3.0\"\n+    mime-types \"~2.1.19\"\n+    oauth-sign \"~0.9.0\"\n+    performance-now \"^2.1.0\"\n+    qs \"~6.5.2\"\n+    safe-buffer \"^5.1.2\"\n+    tough-cookie \"~2.5.0\"\n     tunnel-agent \"^0.6.0\"\n-    uuid \"^3.0.0\"\n+    uuid \"^3.3.2\"\n \n require-directory@^2.1.1:\n   version \"2.1.1\"\n@@ -1354,7 +1557,7 @@ requires-port@1.x.x:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/requires-port/-/requires-port-1.0.0.tgz#925d2601d39ac485e091cf0da5c6e694dc3dcaff\"\n \n-rimraf@2, rimraf@^2.2.8, rimraf@^2.5.1, rimraf@^2.6.1:\n+rimraf@2, rimraf@^2.6.1:\n   version \"2.6.1\"\n   resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-2.6.1.tgz#c2338ec643df7a1b7fe5c54fa86f57428a55f33d\"\n   dependencies:\n@@ -1367,6 +1570,13 @@ rimraf@3.0.2, rimraf@^3.0.2:\n   dependencies:\n     glob \"^7.1.3\"\n \n+rimraf@^4.3.1:\n+  version \"4.4.1\"\n+  resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-4.4.1.tgz#bd33364f67021c5b79e93d7f4fa0568c7c21b755\"\n+  integrity sha512-Gk8NlF062+T9CqNGn6h4tls3k6T1+/nXdOcSZVikNVtlRdYpA7wRJJMoXmuvOnLW844rPjdQ7JgXCYM6PPC/og==\n+  dependencies:\n+    glob \"^9.2.0\"\n+\n robots-parser@^3.0.0:\n   version \"3.0.1\"\n   resolved \"https://registry.yarnpkg.com/robots-parser/-/robots-parser-3.0.1.tgz#3d8a3cdfa8ac240cbb062a4bd16fcc0e0fb9ed23\"\n@@ -1376,11 +1586,21 @@ safe-buffer@^5.0.1, safe-buffer@~5.1.0, safe-buffer@~5.1.1:\n   version \"5.1.1\"\n   resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.1.1.tgz#893312af69b2123def71f57889001671eeb2c853\"\n \n-safe-buffer@~5.2.0:\n+safe-buffer@^5.1.1, safe-buffer@^5.1.2, safe-buffer@^5.2.1, safe-buffer@~5.2.0:\n   version \"5.2.1\"\n   resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.2.1.tgz#1eaf9fa9bdb1fdd4ec75f58f9cdb4e6b7827eec6\"\n   integrity sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==\n \n+\"safer-buffer@>= 2.1.2 < 3\":\n+  version \"2.1.2\"\n+  resolved \"https://registry.yarnpkg.com/safer-buffer/-/safer-buffer-2.1.2.tgz#44fa161b0187b9549dd84bb91802f9bd8385cd6a\"\n+  integrity sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==\n+\n+sax@^1.2.4:\n+  version \"1.3.0\"\n+  resolved \"https://registry.yarnpkg.com/sax/-/sax-1.3.0.tgz#a5dbe77db3be05c9d1ee7785dbd3ea9de51593d0\"\n+  integrity sha512-0s+oAmw9zLl1V1cS9BtZN7JAd0cW5e0QH4W3LWEK6a4LaLEA2OTpGYWDY+6XasBLtz6wkm3u1xRw95mRuJ59WA==\n+\n semver@^5.3.0:\n   version \"5.4.1\"\n   resolved \"https://registry.yarnpkg.com/semver/-/semver-5.4.1.tgz#e059c09d8571f0540823733433505d3a2f00b18e\"\n@@ -1402,12 +1622,6 @@ signal-exit@^3.0.0, signal-exit@^3.0.2:\n   version \"3.0.2\"\n   resolved \"https://registry.yarnpkg.com/signal-exit/-/signal-exit-3.0.2.tgz#b5fdc08f1287ea1178628e415e25132b73646c6d\"\n \n-sntp@1.x.x:\n-  version \"1.0.9\"\n-  resolved \"https://registry.yarnpkg.com/sntp/-/sntp-1.0.9.tgz#6541184cc90aeea6c6e7b35e2659082443c66198\"\n-  dependencies:\n-    hoek \"2.x.x\"\n-\n speedline-core@^1.4.3:\n   version \"1.4.3\"\n   resolved \"https://registry.yarnpkg.com/speedline-core/-/speedline-core-1.4.3.tgz#4d6e7276e2063c2d36a375cb25a523ac73475319\"\n@@ -1435,6 +1649,11 @@ stats-analysis@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/stats-analysis/-/stats-analysis-2.0.0.tgz#f45c516ff5c5d26c26f2d8c7b3d57592802d6187\"\n \n+stealthy-require@^1.1.1:\n+  version \"1.1.1\"\n+  resolved \"https://registry.yarnpkg.com/stealthy-require/-/stealthy-require-1.1.1.tgz#35b09875b4ff49f26a777e509b3090a3226bf24b\"\n+  integrity sha512-ZnWpYnYugiOVEY5GkcuJK1io5V8QmNYChG62gSit9pQVGErXtrKuPC55ITaVSukmMta5qpMU7vqLt2Lnni4f/g==\n+\n string-width@^1.0.1, string-width@^1.0.2:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/string-width/-/string-width-1.0.2.tgz#118bdf5b8cdc51a2a7e70d211e07e2b0b9b107d3\"\n@@ -1465,9 +1684,12 @@ string_decoder@~1.0.3:\n   dependencies:\n     safe-buffer \"~5.1.0\"\n \n-stringstream@~0.0.4:\n-  version \"0.0.5\"\n-  resolved \"https://registry.yarnpkg.com/stringstream/-/stringstream-0.0.5.tgz#4e484cd4de5a0bbbee18e46307710a8a81621878\"\n+string_decoder@~1.1.1:\n+  version \"1.1.1\"\n+  resolved \"https://registry.yarnpkg.com/string_decoder/-/string_decoder-1.1.1.tgz#9cf1611ba62685d7030ae9e4ba34149c3af03fc8\"\n+  integrity sha512-n/ShnvDi6FHbbVfviro+WojiFzv+s8MPMHBczVePfUpDJLwoLT0ht1l4YwBCbi8pJAveEEdnkHyPyTP/mzRfwg==\n+  dependencies:\n+    safe-buffer \"~5.1.0\"\n \n strip-ansi@^3.0.0, strip-ansi@^3.0.1:\n   version \"3.0.1\"\n@@ -1502,18 +1724,28 @@ tar-fs@2.1.1:\n     pump \"^3.0.0\"\n     tar-stream \"^2.1.4\"\n \n-tar-pack@^3.4.0:\n-  version \"3.4.0\"\n-  resolved \"https://registry.yarnpkg.com/tar-pack/-/tar-pack-3.4.0.tgz#23be2d7f671a8339376cbdb0b8fe3fdebf317984\"\n+tar-fs@^1.16.3:\n+  version \"1.16.3\"\n+  resolved \"https://registry.yarnpkg.com/tar-fs/-/tar-fs-1.16.3.tgz#966a628841da2c4010406a82167cbd5e0c72d509\"\n+  integrity sha512-NvCeXpYx7OsmOh8zIOP/ebG55zZmxLE0etfWRbWok+q2Qo8x/vOR/IJT1taADXPe+jsiu9axDb3X4B+iIgNlKw==\n   dependencies:\n-    debug \"^2.2.0\"\n-    fstream \"^1.0.10\"\n-    fstream-ignore \"^1.0.5\"\n-    once \"^1.3.3\"\n-    readable-stream \"^2.1.4\"\n-    rimraf \"^2.5.1\"\n-    tar \"^2.2.1\"\n-    uid-number \"^0.0.6\"\n+    chownr \"^1.0.1\"\n+    mkdirp \"^0.5.1\"\n+    pump \"^1.0.0\"\n+    tar-stream \"^1.1.2\"\n+\n+tar-stream@^1.1.2:\n+  version \"1.6.2\"\n+  resolved \"https://registry.yarnpkg.com/tar-stream/-/tar-stream-1.6.2.tgz#8ea55dab37972253d9a9af90fdcd559ae435c555\"\n+  integrity sha512-rzS0heiNf8Xn7/mpdSVVSMAWAoy9bfb1WOTYC78Z0UQKeKa/CWS8FOq0lKGNa8DWKAn9gxjCvMLYc5PGXYlK2A==\n+  dependencies:\n+    bl \"^1.0.0\"\n+    buffer-alloc \"^1.2.0\"\n+    end-of-stream \"^1.0.0\"\n+    fs-constants \"^1.0.0\"\n+    readable-stream \"^2.3.0\"\n+    to-buffer \"^1.1.1\"\n+    xtend \"^4.0.0\"\n \n tar-stream@^2.1.4:\n   version \"2.2.0\"\n@@ -1526,14 +1758,27 @@ tar-stream@^2.1.4:\n     inherits \"^2.0.3\"\n     readable-stream \"^3.1.1\"\n \n-tar@^2.0.0, tar@^2.2.1:\n+tar@^2.0.0:\n   version \"2.2.1\"\n   resolved \"https://registry.yarnpkg.com/tar/-/tar-2.2.1.tgz#8e4d2a256c0e2185c6b18ad694aec968b83cb1d1\"\n   dependencies:\n     block-stream \"*\"\n     fstream \"^1.0.2\"\n     inherits \"2\"\n \n+tar@^4:\n+  version \"4.4.19\"\n+  resolved \"https://registry.yarnpkg.com/tar/-/tar-4.4.19.tgz#2e4d7263df26f2b914dee10c825ab132123742f3\"\n+  integrity sha512-a20gEsvHnWe0ygBY8JbxoM4w3SJdhc7ZAuxkLqh+nvNQN2IOt0B5lLgM490X5Hl8FF0dl0tOf2ewFYAlIFgzVA==\n+  dependencies:\n+    chownr \"^1.1.4\"\n+    fs-minipass \"^1.2.7\"\n+    minipass \"^2.9.0\"\n+    minizlib \"^1.3.3\"\n+    mkdirp \"^0.5.5\"\n+    safe-buffer \"^5.2.1\"\n+    yallist \"^3.1.1\"\n+\n third-party-web@^0.17.1:\n   version \"0.17.1\"\n   resolved \"https://registry.yarnpkg.com/third-party-web/-/third-party-web-0.17.1.tgz#22e03f1ff519a6380bae4594b704b9bb28e15158\"\n@@ -1544,11 +1789,18 @@ through@^2.3.8:\n   resolved \"https://registry.yarnpkg.com/through/-/through-2.3.8.tgz#0dd4c9ffaabc357960b1b724115d7e0e86a2e1f5\"\n   integrity sha512-w89qg7PI8wAdvX60bMDP+bFoD5Dvhm9oLheFp5O4a2QF0cSBGsBX4qZmadPMvVqlLJBBci+WqGGOAPvcDeNSVg==\n \n-tough-cookie@~2.3.0:\n-  version \"2.3.2\"\n-  resolved \"https://registry.yarnpkg.com/tough-cookie/-/tough-cookie-2.3.2.tgz#f081f76e4c85720e6c37a5faced737150d84072a\"\n+to-buffer@^1.1.1:\n+  version \"1.1.1\"\n+  resolved \"https://registry.yarnpkg.com/to-buffer/-/to-buffer-1.1.1.tgz#493bd48f62d7c43fcded313a03dcadb2e1213a80\"\n+  integrity sha512-lx9B5iv7msuFYE3dytT+KE5tap+rNYw+K4jVkb9R/asAb+pbBSM17jtunHplhBe6RRJdZx3Pn2Jph24O32mOVg==\n+\n+tough-cookie@^2.3.3, tough-cookie@~2.5.0:\n+  version \"2.5.0\"\n+  resolved \"https://registry.yarnpkg.com/tough-cookie/-/tough-cookie-2.5.0.tgz#cd9fb2a0aa1d5a12b473bd9fb96fa3dcff65ade2\"\n+  integrity sha512-nlLsUzgm1kfLXSXfRZMc1KLAugd4hqJHDTvc2hDIwS3mZAfMEuMbc03SujMF+GEcpaX/qboeycw6iO8JwVv2+g==\n   dependencies:\n-    punycode \"^1.4.1\"\n+    psl \"^1.1.28\"\n+    punycode \"^2.1.1\"\n \n tr46@~0.0.3:\n   version \"0.0.3\"\n@@ -1577,10 +1829,6 @@ typedarray-to-buffer@^3.1.5:\n   dependencies:\n     is-typedarray \"^1.0.0\"\n \n-uid-number@^0.0.6:\n-  version \"0.0.6\"\n-  resolved \"https://registry.yarnpkg.com/uid-number/-/uid-number-0.0.6.tgz#0ea10e8035e8eb5b8e4449f06da1c730663baa81\"\n-\n unbzip2-stream@1.4.3:\n   version \"1.4.3\"\n   resolved \"https://registry.yarnpkg.com/unbzip2-stream/-/unbzip2-stream-1.4.3.tgz#b0da04c4371311df771cdc215e87f2130991ace7\"\n@@ -1602,6 +1850,18 @@ unique-string@^2.0.0:\n   dependencies:\n     crypto-random-string \"^2.0.0\"\n \n+universalify@^0.1.0:\n+  version \"0.1.2\"\n+  resolved \"https://registry.yarnpkg.com/universalify/-/universalify-0.1.2.tgz#b646f69be3942dabcecc9d6639c80dc105efaa66\"\n+  integrity sha512-rBJeI5CXAlmy1pV+617WB9J63U6XcazHHF2f2dbJix4XzpUF0RS3Zbj0FGIOCAva5P/d/GBOYaACQ1w+0azUkg==\n+\n+uri-js@^4.2.2:\n+  version \"4.4.1\"\n+  resolved \"https://registry.yarnpkg.com/uri-js/-/uri-js-4.4.1.tgz#9b1a52595225859e55f669d928f88c6c57f2a77e\"\n+  integrity sha512-7rKUyy33Q1yc98pQ1DAmLtwX109F7TIfWlW1Ydo8Wl1ii1SeHieeh0HHfPeL2fMXK6z0s8ecKs9frCuLJvndBg==\n+  dependencies:\n+    punycode \"^2.1.0\"\n+\n url-join@^2.0.2:\n   version \"2.0.5\"\n   resolved \"https://registry.yarnpkg.com/url-join/-/url-join-2.0.5.tgz#5af22f18c052a000a48d7b82c5e9c2e2feeda728\"\n@@ -1611,9 +1871,10 @@ util-deprecate@^1.0.1, util-deprecate@~1.0.1:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/util-deprecate/-/util-deprecate-1.0.2.tgz#450d4dc9fa70de732762fbd2d4a28981419a0ccf\"\n \n-uuid@^3.0.0:\n-  version \"3.1.0\"\n-  resolved \"https://registry.yarnpkg.com/uuid/-/uuid-3.1.0.tgz#3dd3d3e790abc24d7b0d3a034ffababe28ebbc04\"\n+uuid@^3.3.2:\n+  version \"3.4.0\"\n+  resolved \"https://registry.yarnpkg.com/uuid/-/uuid-3.4.0.tgz#b23e4358afa8a202fe7a100af1f5f883f02007ee\"\n+  integrity sha512-HjSDRw6gZE5JMggctHBcjVak08+KEVhSIiDzFnT9S9aegmp85S/bReBVTb4QTFaRNptJ9kuYaNhnbNEOkbKb/A==\n \n verror@1.10.0:\n   version \"1.10.0\"\n@@ -1690,11 +1951,21 @@ xdg-basedir@^4.0.0:\n   resolved \"https://registry.yarnpkg.com/xdg-basedir/-/xdg-basedir-4.0.0.tgz#4bc8d9984403696225ef83a1573cbbcb4e79db13\"\n   integrity sha512-PSNhEJDejZYV7h50BohL09Er9VaIefr2LMAf3OEmpCkjOi34eYyQYAXUTjEQtZJTKcF0E2UKTh+osDLsgNim9Q==\n \n+xtend@^4.0.0:\n+  version \"4.0.2\"\n+  resolved \"https://registry.yarnpkg.com/xtend/-/xtend-4.0.2.tgz#bb72779f5fa465186b1f438f674fa347fdb5db54\"\n+  integrity sha512-LKYU1iAXJXUgAXn9URjiu+MWhyUXHsvfp7mcuYm9dSUKK0/CjtrUwFAxD82/mCWbtLsGjFIad0wIsod4zrTAEQ==\n+\n y18n@^5.0.5:\n   version \"5.0.8\"\n   resolved \"https://registry.yarnpkg.com/y18n/-/y18n-5.0.8.tgz#7f4934d0f7ca8c56f95314939ddcd2dd91ce1d55\"\n   integrity sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA==\n \n+yallist@^3.0.0, yallist@^3.1.1:\n+  version \"3.1.1\"\n+  resolved \"https://registry.yarnpkg.com/yallist/-/yallist-3.1.1.tgz#dbb7daf9bfd8bac9ab45ebf602b8cbad0d5d08fd\"\n+  integrity sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==\n+\n yargs-parser@^21.0.0, yargs-parser@^21.1.1:\n   version \"21.1.1\"\n   resolved \"https://registry.yarnpkg.com/yargs-parser/-/yargs-parser-21.1.1.tgz#9096bceebf990d21bb31fa9516e0ede294a77d35\""
            },
            {
                "file": "scripts/bench/package.json",
                "git_diff": "@@ -15,7 +15,7 @@\n     \"mime\": \"^1.3.6\",\n     \"minimist\": \"^1.2.3\",\n     \"ncp\": \"^2.0.0\",\n-    \"nodegit\": \"^0.23.0\",\n+    \"nodegit\": \"^0.27.0\",\n     \"rimraf\": \"^4.3.1\",\n     \"stats-analysis\": \"^2.0.0\"\n   }"
            },
            {
                "file": "scripts/bench/yarn.lock",
                "git_diff": "@@ -58,11 +58,52 @@\n     \"@sentry/types\" \"6.19.7\"\n     tslib \"^1.9.3\"\n \n+\"@sindresorhus/is@^2.0.0\":\n+  version \"2.1.1\"\n+  resolved \"https://registry.yarnpkg.com/@sindresorhus/is/-/is-2.1.1.tgz#ceff6a28a5b4867c2dd4a1ba513de278ccbe8bb1\"\n+  integrity sha512-/aPsuoj/1Dw/kzhkgz+ES6TxG0zfTMGLwuK2ZG00k/iJzYHTLCE8mVU8EPqEOp/lmxPoq1C1C9RYToRKb2KEfg==\n+\n+\"@szmarczak/http-timer@^4.0.0\":\n+  version \"4.0.6\"\n+  resolved \"https://registry.yarnpkg.com/@szmarczak/http-timer/-/http-timer-4.0.6.tgz#b4a914bb62e7c272d4e5989fe4440f812ab1d807\"\n+  integrity sha512-4BAffykYOgO+5nzBWYwE3W90sBgLJoUPRWWcL8wlyiM8IB8ipJz3UMJ9KXQd1RKQXpKp8Tutn80HZtWsu2u76w==\n+  dependencies:\n+    defer-to-connect \"^2.0.0\"\n+\n+\"@types/cacheable-request@^6.0.1\":\n+  version \"6.0.3\"\n+  resolved \"https://registry.yarnpkg.com/@types/cacheable-request/-/cacheable-request-6.0.3.tgz#a430b3260466ca7b5ca5bfd735693b36e7a9d183\"\n+  integrity sha512-IQ3EbTzGxIigb1I3qPZc1rWJnH0BmSKv5QYTalEwweFvyBDLSAe24zP0le/hyi7ecGfZVlIVAg4BZqb8WBwKqw==\n+  dependencies:\n+    \"@types/http-cache-semantics\" \"*\"\n+    \"@types/keyv\" \"^3.1.4\"\n+    \"@types/node\" \"*\"\n+    \"@types/responselike\" \"^1.0.0\"\n+\n+\"@types/http-cache-semantics@*\":\n+  version \"4.0.4\"\n+  resolved \"https://registry.yarnpkg.com/@types/http-cache-semantics/-/http-cache-semantics-4.0.4.tgz#b979ebad3919799c979b17c72621c0bc0a31c6c4\"\n+  integrity sha512-1m0bIFVc7eJWyve9S0RnuRgcQqF/Xd5QsUZAZeQFr1Q3/p9JWoQQEqmVy+DPTNpGXwhgIetAoYF8JSc33q29QA==\n+\n+\"@types/keyv@^3.1.1\", \"@types/keyv@^3.1.4\":\n+  version \"3.1.4\"\n+  resolved \"https://registry.yarnpkg.com/@types/keyv/-/keyv-3.1.4.tgz#3ccdb1c6751b0c7e52300bcdacd5bcbf8faa75b6\"\n+  integrity sha512-BQ5aZNSCpj7D6K2ksrRCTmKRLEpnPvWDiLPfoGyhZ++8YtiK9d/3DBKPJgry359X/P1PfruyYwvnvwFjuEiEIg==\n+  dependencies:\n+    \"@types/node\" \"*\"\n+\n \"@types/node@*\":\n   version \"10.12.0\"\n   resolved \"https://registry.yarnpkg.com/@types/node/-/node-10.12.0.tgz#ea6dcbddbc5b584c83f06c60e82736d8fbb0c235\"\n   integrity sha512-3TUHC3jsBAB7qVRGxT6lWyYo2v96BMmD2PTcl47H25Lu7UXtFH/2qqmKiVrnel6Ne//0TFYf6uvNX+HW2FRkLQ==\n \n+\"@types/responselike@^1.0.0\":\n+  version \"1.0.3\"\n+  resolved \"https://registry.yarnpkg.com/@types/responselike/-/responselike-1.0.3.tgz#cc29706f0a397cfe6df89debfe4bf5cea159db50\"\n+  integrity sha512-H/+L+UkTV33uf49PH5pCAUBVPNj2nDBXTN+qS1dOwyyg24l3CcicicCA7ca+HMvJBZcFgl5r8e+RR6elsb4Lyw==\n+  dependencies:\n+    \"@types/node\" \"*\"\n+\n \"@types/yauzl@^2.9.1\":\n   version \"2.10.3\"\n   resolved \"https://registry.yarnpkg.com/@types/yauzl/-/yauzl-2.10.3.tgz#e9b2808b4f109504a03cda958259876f61017999\"\n@@ -129,10 +170,6 @@ are-we-there-yet@~1.1.2:\n     delegates \"^1.0.0\"\n     readable-stream \"^2.0.6\"\n \n-asap@~2.0.3:\n-  version \"2.0.6\"\n-  resolved \"https://registry.yarnpkg.com/asap/-/asap-2.0.6.tgz#e50347611d7e690943208bbdafebcbc2fb866d46\"\n-\n asn1@~0.2.3:\n   version \"0.2.3\"\n   resolved \"https://registry.yarnpkg.com/asn1/-/asn1-0.2.3.tgz#dac8787713c9966849fc8180777ebe9c1ddf3b86\"\n@@ -196,12 +233,6 @@ bl@^4.0.3:\n     inherits \"^2.0.4\"\n     readable-stream \"^3.4.0\"\n \n-block-stream@*:\n-  version \"0.0.9\"\n-  resolved \"https://registry.yarnpkg.com/block-stream/-/block-stream-0.0.9.tgz#13ebfe778a03205cfe03751481ebb4b3300c126a\"\n-  dependencies:\n-    inherits \"~2.0.0\"\n-\n brace-expansion@^1.1.7:\n   version \"1.1.8\"\n   resolved \"https://registry.yarnpkg.com/brace-expansion/-/brace-expansion-1.1.8.tgz#c07b211c7c952ec1f8efd51a77ef0d1d3990a292\"\n@@ -247,6 +278,27 @@ buffer@^5.2.1, buffer@^5.5.0:\n     base64-js \"^1.3.1\"\n     ieee754 \"^1.1.13\"\n \n+cacheable-lookup@^2.0.0:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/cacheable-lookup/-/cacheable-lookup-2.0.1.tgz#87be64a18b925234875e10a9bb1ebca4adce6b38\"\n+  integrity sha512-EMMbsiOTcdngM/K6gV/OxF2x0t07+vMOWxZNSCRQMjO2MY2nhZQ6OYhOOpyQrbhqsgtvKGI7hcq6xjnA92USjg==\n+  dependencies:\n+    \"@types/keyv\" \"^3.1.1\"\n+    keyv \"^4.0.0\"\n+\n+cacheable-request@^7.0.1:\n+  version \"7.0.4\"\n+  resolved \"https://registry.yarnpkg.com/cacheable-request/-/cacheable-request-7.0.4.tgz#7a33ebf08613178b403635be7b899d3e69bbe817\"\n+  integrity sha512-v+p6ongsrp0yTGbJXjgxPow2+DL93DASP4kXCDKb8/bwRtt9OEF3whggkkDkGNzgcWy2XaF4a8nZglC7uElscg==\n+  dependencies:\n+    clone-response \"^1.0.2\"\n+    get-stream \"^5.1.0\"\n+    http-cache-semantics \"^4.0.0\"\n+    keyv \"^4.0.0\"\n+    lowercase-keys \"^2.0.0\"\n+    normalize-url \"^6.0.1\"\n+    responselike \"^2.0.0\"\n+\n caseless@~0.12.0:\n   version \"0.12.0\"\n   resolved \"https://registry.yarnpkg.com/caseless/-/caseless-0.12.0.tgz#1b681c21ff84033c826543090689420d187151dc\"\n@@ -301,6 +353,13 @@ cliui@^8.0.1:\n     strip-ansi \"^6.0.1\"\n     wrap-ansi \"^7.0.0\"\n \n+clone-response@^1.0.2:\n+  version \"1.0.3\"\n+  resolved \"https://registry.yarnpkg.com/clone-response/-/clone-response-1.0.3.tgz#af2032aa47816399cf5f0a1d0db902f517abb8c3\"\n+  integrity sha512-ROoL94jJH2dUVML2Y/5PEDNaSHgeOdSDicUyS7izcF63G6sTc/FTjLub4b8Il9S8S0beOfYt0TaA5qvFK+w0wA==\n+  dependencies:\n+    mimic-response \"^1.0.0\"\n+\n code-point-at@^1.0.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/code-point-at/-/code-point-at-1.1.0.tgz#0d070b4d043a5bea33a2f1a40e2edb3d9a4ccf77\"\n@@ -433,11 +492,23 @@ debug@^3.2.6:\n   dependencies:\n     ms \"^2.1.1\"\n \n+decompress-response@^5.0.0:\n+  version \"5.0.0\"\n+  resolved \"https://registry.yarnpkg.com/decompress-response/-/decompress-response-5.0.0.tgz#7849396e80e3d1eba8cb2f75ef4930f76461cb0f\"\n+  integrity sha512-TLZWWybuxWgoW7Lykv+gq9xvzOsUjQ9tF09Tj6NSTYGMTCHNXzrPnD6Hi+TgZq19PyTAGH4Ll/NIM/eTGglnMw==\n+  dependencies:\n+    mimic-response \"^2.0.0\"\n+\n deep-extend@^0.6.0:\n   version \"0.6.0\"\n   resolved \"https://registry.yarnpkg.com/deep-extend/-/deep-extend-0.6.0.tgz#c4fa7c95404a17a9c3e8ca7e1537312b736330ac\"\n   integrity sha512-LOHxIOaPYdHlJRtCQfDIVZtfw/ufM8+rVj649RIHzcm/vGwQRXFt6OPqIFWsm2XEMrNIEtWR64sY1LEKD2vAOA==\n \n+defer-to-connect@^2.0.0:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/defer-to-connect/-/defer-to-connect-2.0.1.tgz#8016bdb4143e4632b77a3449c6236277de520587\"\n+  integrity sha512-4tvttepXG1VaYGrRibk5EwJd1t4udunSOVMdLSAL6mId1ix438oPwPZMALY41FCijukO1L0twNcGsdzS7dHgDg==\n+\n define-lazy-prop@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/define-lazy-prop/-/define-lazy-prop-2.0.0.tgz#3f7ae421129bcaaac9bc74905c98a0009ec9ee7f\"\n@@ -468,6 +539,11 @@ dot-prop@^5.2.0:\n   dependencies:\n     is-obj \"^2.0.0\"\n \n+duplexer3@^0.1.4:\n+  version \"0.1.5\"\n+  resolved \"https://registry.yarnpkg.com/duplexer3/-/duplexer3-0.1.5.tgz#0b5e4d7bad5de8901ea4440624c8e1d20099217e\"\n+  integrity sha512-1A8za6ws41LQgv9HrE/66jyC5yuSjQ3L/KOpFtoBilsAK2iA2wuS5rTt1OCzIvtS2V7nVmedsUU+DGRcjBmOYA==\n+\n ecc-jsbn@~0.1.1:\n   version \"0.1.1\"\n   resolved \"https://registry.yarnpkg.com/ecc-jsbn/-/ecc-jsbn-0.1.1.tgz#0fc73a9ed5f0d53c38193398523ef7e543777505\"\n@@ -605,15 +681,6 @@ fs.realpath@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/fs.realpath/-/fs.realpath-1.0.0.tgz#1504ad2523158caa40db4a2787cb01411994ea4f\"\n \n-fstream@^1.0.0, fstream@^1.0.2:\n-  version \"1.0.11\"\n-  resolved \"https://registry.yarnpkg.com/fstream/-/fstream-1.0.11.tgz#5c1fb1f117477114f0632a0eb4b71b3cb0fd3171\"\n-  dependencies:\n-    graceful-fs \"^4.1.2\"\n-    inherits \"~2.0.0\"\n-    mkdirp \">=0.5 0\"\n-    rimraf \"2\"\n-\n gauge@~2.7.3:\n   version \"2.7.4\"\n   resolved \"https://registry.yarnpkg.com/gauge/-/gauge-2.7.4.tgz#2c03405c7538c39d7eb37b317022e325fb018bf7\"\n@@ -632,7 +699,7 @@ get-caller-file@^2.0.5:\n   resolved \"https://registry.yarnpkg.com/get-caller-file/-/get-caller-file-2.0.5.tgz#4f94412a82db32f36e3b0b9741f8a97feb031f7e\"\n   integrity sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg==\n \n-get-stream@^5.1.0:\n+get-stream@^5.0.0, get-stream@^5.1.0:\n   version \"5.2.0\"\n   resolved \"https://registry.yarnpkg.com/get-stream/-/get-stream-5.2.0.tgz#4966a1795ee5ace65e706c4b7beb71257d6e22d3\"\n   integrity sha512-nBF+F1rAZVCu/p7rjzgA+Yb4lfYXrpl7a6VmJrU8wF9I1CKvP/QwPNZHnOlwbTkY6dvtFIzFMSyQXbLoTQPRpA==\n@@ -678,6 +745,27 @@ glob@^9.2.0:\n     minipass \"^4.2.4\"\n     path-scurry \"^1.6.1\"\n \n+got@^10.7.0:\n+  version \"10.7.0\"\n+  resolved \"https://registry.yarnpkg.com/got/-/got-10.7.0.tgz#62889dbcd6cca32cd6a154cc2d0c6895121d091f\"\n+  integrity sha512-aWTDeNw9g+XqEZNcTjMMZSy7B7yE9toWOFYip7ofFTLleJhvZwUxxTxkTpKvF+p1SAA4VHmuEy7PiHTHyq8tJg==\n+  dependencies:\n+    \"@sindresorhus/is\" \"^2.0.0\"\n+    \"@szmarczak/http-timer\" \"^4.0.0\"\n+    \"@types/cacheable-request\" \"^6.0.1\"\n+    cacheable-lookup \"^2.0.0\"\n+    cacheable-request \"^7.0.1\"\n+    decompress-response \"^5.0.0\"\n+    duplexer3 \"^0.1.4\"\n+    get-stream \"^5.0.0\"\n+    lowercase-keys \"^2.0.0\"\n+    mimic-response \"^2.1.0\"\n+    p-cancelable \"^2.0.0\"\n+    p-event \"^4.0.0\"\n+    responselike \"^2.0.0\"\n+    to-readable-stream \"^2.0.0\"\n+    type-fest \"^0.10.0\"\n+\n graceful-fs@^4.1.2, graceful-fs@^4.1.6:\n   version \"4.1.11\"\n   resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.1.11.tgz#0e8bdfe4d1ddb8854d64e04ea7c00e2a026e5658\"\n@@ -708,6 +796,11 @@ he@^1.1.1:\n   resolved \"https://registry.yarnpkg.com/he/-/he-1.2.0.tgz#84ae65fa7eafb165fddb61566ae14baf05664f0f\"\n   integrity sha512-F/1DnUGPopORZi0ni+CvrCgHQ5FyEAHRLSApuYWMmrbSwoN2Mn/7k+Gl38gJnR7yyDZk6WLXwiGod1JOWNDKGw==\n \n+http-cache-semantics@^4.0.0:\n+  version \"4.1.1\"\n+  resolved \"https://registry.yarnpkg.com/http-cache-semantics/-/http-cache-semantics-4.1.1.tgz#abe02fcb2985460bf0323be664436ec3476a6d5a\"\n+  integrity sha512-er295DKPVsV82j5kw1Gjt+ADA/XYHsajl82cGNQG2eyoPkvgUhX+nDIyelzhIWbbsXP39EHcI6l5tYs2FYqYXQ==\n+\n http-link-header@^0.8.0:\n   version \"0.8.0\"\n   resolved \"https://registry.yarnpkg.com/http-link-header/-/http-link-header-0.8.0.tgz#a22b41a0c9b1e2d8fac1bf1b697c6bd532d5f5e4\"\n@@ -788,7 +881,7 @@ inflight@^1.0.4:\n     once \"^1.3.0\"\n     wrappy \"1\"\n \n-inherits@2, inherits@~2.0.0, inherits@~2.0.3:\n+inherits@2, inherits@~2.0.3:\n   version \"2.0.3\"\n   resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.3.tgz#633c2c83e3da42a502f52466022480f4208261de\"\n \n@@ -871,6 +964,11 @@ jsbn@~0.1.0:\n   version \"0.1.1\"\n   resolved \"https://registry.yarnpkg.com/jsbn/-/jsbn-0.1.1.tgz#a5e654c2e5a2deb5f201d96cefbca80c0ef2f513\"\n \n+json-buffer@3.0.1:\n+  version \"3.0.1\"\n+  resolved \"https://registry.yarnpkg.com/json-buffer/-/json-buffer-3.0.1.tgz#9338802a30d3b6605fbe0613e094008ca8c05a13\"\n+  integrity sha512-4bV5BfR2mqfQTJm+V5tPPdf+ZpuhiIvTuAB5g8kcrXOZpTT/QwwVRWBywX1ozr6lEuPdbHxwaJlm9G6mI2sfSQ==\n+\n json-schema-traverse@^0.4.1:\n   version \"0.4.1\"\n   resolved \"https://registry.yarnpkg.com/json-schema-traverse/-/json-schema-traverse-0.4.1.tgz#69f6a87d9513ab8bb8fe63bdb0979c448e684660\"\n@@ -905,6 +1003,13 @@ jsprim@^1.2.2:\n     json-schema \"0.2.3\"\n     verror \"1.10.0\"\n \n+keyv@^4.0.0:\n+  version \"4.5.4\"\n+  resolved \"https://registry.yarnpkg.com/keyv/-/keyv-4.5.4.tgz#a879a99e29452f942439f2a405e3af8b31d4de93\"\n+  integrity sha512-oxVHkHR/EJf2CNXnWxRLW6mg7JyCCUcG0DtEGmL2ctUo1PNTin1PUil+r/+4r5MpVgC/fn1kjsx7mjSujKqIpw==\n+  dependencies:\n+    json-buffer \"3.0.1\"\n+\n lighthouse-logger@^1.0.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/lighthouse-logger/-/lighthouse-logger-1.2.0.tgz#b76d56935e9c137e86a04741f6bb9b2776e886ca\"\n@@ -966,7 +1071,7 @@ locate-path@^5.0.0:\n   dependencies:\n     p-locate \"^4.1.0\"\n \n-lodash@^4.17.11, lodash@^4.17.19, lodash@^4.17.21:\n+lodash@^4.17.14, lodash@^4.17.21:\n   version \"4.17.21\"\n   resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.21.tgz#679591c564c3bffaae8454cf0b3df370c3d6911c\"\n   integrity sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==\n@@ -976,6 +1081,11 @@ lookup-closest-locale@6.2.0:\n   resolved \"https://registry.yarnpkg.com/lookup-closest-locale/-/lookup-closest-locale-6.2.0.tgz#57f665e604fd26f77142d48152015402b607bcf3\"\n   integrity sha512-/c2kL+Vnp1jnV6K6RpDTHK3dgg0Tu2VVp+elEiJpjfS1UyY7AjOYHohRug6wT0OpoX2qFgNORndE9RqesfVxWQ==\n \n+lowercase-keys@^2.0.0:\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/lowercase-keys/-/lowercase-keys-2.0.0.tgz#2603e78b7b4b0006cbca2fbcc8a3202558ac9479\"\n+  integrity sha512-tqNXrS78oMOE73NMxK4EMLQsQowWf8jKooH9g7xPavRT706R6bkQJ6DY2Te7QukaZsulxa30wQ7bk0pm4XiHmA==\n+\n lru-cache@^10.2.0:\n   version \"10.2.2\"\n   resolved \"https://registry.yarnpkg.com/lru-cache/-/lru-cache-10.2.2.tgz#48206bc114c1252940c41b25b41af5b545aca878\"\n@@ -1035,6 +1145,16 @@ mime@^1.2.11, mime@^1.3.6:\n   resolved \"https://registry.yarnpkg.com/mime/-/mime-1.6.0.tgz#32cd9e5c64553bd58d19a568af452acff04981b1\"\n   integrity sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==\n \n+mimic-response@^1.0.0:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/mimic-response/-/mimic-response-1.0.1.tgz#4923538878eef42063cb8a3e3b0798781487ab1b\"\n+  integrity sha512-j5EctnkH7amfV/q5Hgmoal1g2QHFJRraOtmx0JpIqkxhBhI/lJSl1nMpQ45hVarwNETOoWEimndZ4QK0RHxuxQ==\n+\n+mimic-response@^2.0.0, mimic-response@^2.1.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/mimic-response/-/mimic-response-2.1.0.tgz#d13763d35f613d09ec37ebb30bac0469c0ee8f43\"\n+  integrity sha512-wXqjST+SLt7R009ySCglWBCFpjUygmCIfD790/kVbiGmUgfYGuB14PiTd5DwVxSV4NcYHjzMkoj5LjQZwTQLEA==\n+\n minimatch@^3.0.4:\n   version \"3.0.4\"\n   resolved \"https://registry.yarnpkg.com/minimatch/-/minimatch-3.0.4.tgz#5166e286457f03306064be5497e8dbb0c3d32083\"\n@@ -1103,7 +1223,7 @@ mkdirp-classic@^0.5.2:\n   resolved \"https://registry.yarnpkg.com/mkdirp-classic/-/mkdirp-classic-0.5.3.tgz#fa10c9115cc6d8865be221ba47ee9bed78601113\"\n   integrity sha512-gKLcREMhtuZRwRAfqP3RFW+TK4JqApVBtOIftVgjuABpAtpxhPGaDcfvbhNvD0B8iD1oUr/txX35NjcaY6Ns/A==\n \n-mkdirp@0.5.x, \"mkdirp@>=0.5 0\", mkdirp@^0.5.0, mkdirp@^0.5.1:\n+mkdirp@0.5.x, mkdirp@^0.5.0, mkdirp@^0.5.1:\n   version \"0.5.1\"\n   resolved \"https://registry.yarnpkg.com/mkdirp/-/mkdirp-0.5.1.tgz#30057438eac6cf7f8c4767f38648d6697d75c903\"\n   dependencies:\n@@ -1130,7 +1250,7 @@ ms@^2.1.1:\n   resolved \"https://registry.yarnpkg.com/ms/-/ms-2.1.3.tgz#574c8138ce1d2b5861f0b44579dbadd60c6615b2\"\n   integrity sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==\n \n-nan@^2.11.1:\n+nan@^2.14.0:\n   version \"2.19.0\"\n   resolved \"https://registry.yarnpkg.com/nan/-/nan-2.19.0.tgz#bb58122ad55a6c5bc973303908d5b16cfdd5a8c0\"\n   integrity sha512-nO1xXxfh/RWNxfd/XPfbIfFk5vgLsAxUR9y5O0cHMJu/AW9U95JLXqthYHjEp+8gQ5p96K9jUp8nbVOxCdRbtw==\n@@ -1155,12 +1275,11 @@ node-fetch@2.6.7:\n   dependencies:\n     whatwg-url \"^5.0.0\"\n \n-node-gyp@^3.8.0:\n-  version \"3.8.0\"\n-  resolved \"https://registry.yarnpkg.com/node-gyp/-/node-gyp-3.8.0.tgz#540304261c330e80d0d5edce253a68cb3964218c\"\n-  integrity sha512-3g8lYefrRRzvGeSowdJKAKyks8oUpLEd/DyPV4eMhVlhJ0aNaZqIrNUIPuEWWTAoPqyFkfGrM67MC69baqn6vA==\n+node-gyp@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/node-gyp/-/node-gyp-4.0.0.tgz#972654af4e5dd0cd2a19081b4b46fe0442ba6f45\"\n+  integrity sha512-2XiryJ8sICNo6ej8d0idXDEMKfVfFK7kekGCtJAuelGsYHQxhj13KTf95swTCN2dZ/4lTfZ84Fu31jqJEEgjWA==\n   dependencies:\n-    fstream \"^1.0.0\"\n     glob \"^7.0.3\"\n     graceful-fs \"^4.1.2\"\n     mkdirp \"^0.5.0\"\n@@ -1170,13 +1289,13 @@ node-gyp@^3.8.0:\n     request \"^2.87.0\"\n     rimraf \"2\"\n     semver \"~5.3.0\"\n-    tar \"^2.0.0\"\n+    tar \"^4.4.8\"\n     which \"1\"\n \n-node-pre-gyp@^0.11.0:\n-  version \"0.11.0\"\n-  resolved \"https://registry.yarnpkg.com/node-pre-gyp/-/node-pre-gyp-0.11.0.tgz#db1f33215272f692cd38f03238e3e9b47c5dd054\"\n-  integrity sha512-TwWAOZb0j7e9eGaf9esRx3ZcLaE5tQ2lvYy1pb5IAaG1a2e2Kv5Lms1Y4hpj+ciXJRofIxxlt5haeQ/2ANeE0Q==\n+node-pre-gyp@^0.13.0:\n+  version \"0.13.0\"\n+  resolved \"https://registry.yarnpkg.com/node-pre-gyp/-/node-pre-gyp-0.13.0.tgz#df9ab7b68dd6498137717838e4f92a33fc9daa42\"\n+  integrity sha512-Md1D3xnEne8b/HGVQkZZwV27WUi1ZRuZBij24TNaZwUPU3ZAFtvT6xxJGaUVillfmMKnn5oD1HoGsp2Ftik7SQ==\n   dependencies:\n     detect-libc \"^1.0.2\"\n     mkdirp \"^0.5.1\"\n@@ -1189,26 +1308,19 @@ node-pre-gyp@^0.11.0:\n     semver \"^5.3.0\"\n     tar \"^4\"\n \n-nodegit-promise@~4.0.0:\n-  version \"4.0.0\"\n-  resolved \"https://registry.yarnpkg.com/nodegit-promise/-/nodegit-promise-4.0.0.tgz#5722b184f2df7327161064a791d2e842c9167b34\"\n-  dependencies:\n-    asap \"~2.0.3\"\n-\n-nodegit@^0.23.0:\n-  version \"0.23.1\"\n-  resolved \"https://registry.yarnpkg.com/nodegit/-/nodegit-0.23.1.tgz#937c2cc998bbed3cef0b138131fee3a2672458af\"\n-  integrity sha512-k1bCg260yZlmfLGYPrinqAQNbQ6PnBJhKq6wWfe94yIO3WnOOyoSuweAkAGPR6FhrGq2LkCKHdJaitwhKCEGyA==\n+nodegit@^0.27.0:\n+  version \"0.27.0\"\n+  resolved \"https://registry.yarnpkg.com/nodegit/-/nodegit-0.27.0.tgz#4e8cc236f60e1c97324a5acff99056fe116a6ebe\"\n+  integrity sha512-E9K4gPjWiA0b3Tx5lfWCzG7Cvodi2idl3V5UD2fZrOrHikIfrN7Fc2kWLtMUqqomyoToYJLeIC8IV7xb1CYRLA==\n   dependencies:\n     fs-extra \"^7.0.0\"\n+    got \"^10.7.0\"\n     json5 \"^2.1.0\"\n-    lodash \"^4.17.11\"\n-    nan \"^2.11.1\"\n-    node-gyp \"^3.8.0\"\n-    node-pre-gyp \"^0.11.0\"\n-    promisify-node \"~0.3.0\"\n+    lodash \"^4.17.14\"\n+    nan \"^2.14.0\"\n+    node-gyp \"^4.0.0\"\n+    node-pre-gyp \"^0.13.0\"\n     ramda \"^0.25.0\"\n-    request-promise-native \"^1.0.5\"\n     tar-fs \"^1.16.3\"\n \n \"nopt@2 || 3\":\n@@ -1224,6 +1336,11 @@ nopt@^4.0.1:\n     abbrev \"1\"\n     osenv \"^0.1.4\"\n \n+normalize-url@^6.0.1:\n+  version \"6.1.0\"\n+  resolved \"https://registry.yarnpkg.com/normalize-url/-/normalize-url-6.1.0.tgz#40d0885b535deffe3f3147bec877d05fe4c5668a\"\n+  integrity sha512-DlL+XwOy3NxAQ8xuC0okPgK46iuVNAK01YN7RueYBqqFeGsBjV9XmCAzAdgt+667bCl5kPh9EqKKDwnaPG1I7A==\n+\n npm-bundled@^1.0.1:\n   version \"1.1.2\"\n   resolved \"https://registry.yarnpkg.com/npm-bundled/-/npm-bundled-1.1.2.tgz#944c78789bd739035b70baa2ca5cc32b8d860bc1\"\n@@ -1308,6 +1425,23 @@ osenv@0, osenv@^0.1.4:\n     os-homedir \"^1.0.0\"\n     os-tmpdir \"^1.0.0\"\n \n+p-cancelable@^2.0.0:\n+  version \"2.1.1\"\n+  resolved \"https://registry.yarnpkg.com/p-cancelable/-/p-cancelable-2.1.1.tgz#aab7fbd416582fa32a3db49859c122487c5ed2cf\"\n+  integrity sha512-BZOr3nRQHOntUjTrH8+Lh54smKHoHyur8We1V8DSMVrl5A2malOOwuJRnKRDjSnkoeBh4at6BwEnb5I7Jl31wg==\n+\n+p-event@^4.0.0:\n+  version \"4.2.0\"\n+  resolved \"https://registry.yarnpkg.com/p-event/-/p-event-4.2.0.tgz#af4b049c8acd91ae81083ebd1e6f5cae2044c1b5\"\n+  integrity sha512-KXatOjCRXXkSePPb1Nbi0p0m+gQAwdlbhi4wQKJPI1HsMQS9g+Sqp2o+QHziPr7eYJyOZet836KoHEVM1mwOrQ==\n+  dependencies:\n+    p-timeout \"^3.1.0\"\n+\n+p-finally@^1.0.0:\n+  version \"1.0.0\"\n+  resolved \"https://registry.yarnpkg.com/p-finally/-/p-finally-1.0.0.tgz#3fbcfb15b899a44123b34b6dcc18b724336a2cae\"\n+  integrity sha512-LICb2p9CB7FS+0eR1oqWnHhp0FljGLZCWBE9aix0Uye9W8LTQPwMTYVGWQWIw9RdQiDg4+epXQODwIYJtSJaow==\n+\n p-limit@^2.2.0:\n   version \"2.3.0\"\n   resolved \"https://registry.yarnpkg.com/p-limit/-/p-limit-2.3.0.tgz#3dd33c647a214fdfffd835933eb086da0dc21db1\"\n@@ -1322,6 +1456,13 @@ p-locate@^4.1.0:\n   dependencies:\n     p-limit \"^2.2.0\"\n \n+p-timeout@^3.1.0:\n+  version \"3.2.0\"\n+  resolved \"https://registry.yarnpkg.com/p-timeout/-/p-timeout-3.2.0.tgz#c7e17abc971d2a7962ef83626b35d635acf23dfe\"\n+  integrity sha512-rhIwUycgwwKcP9yTOOFK/AKsAopjjCakVqLHePO3CC6Mir1Z99xT+R63jZxAT5lFZLa2inS5h+ZS2GvR99/FBg==\n+  dependencies:\n+    p-finally \"^1.0.0\"\n+\n p-try@^2.0.0:\n   version \"2.2.0\"\n   resolved \"https://registry.yarnpkg.com/p-try/-/p-try-2.2.0.tgz#cb2868540e313d61de58fafbe35ce9004d5540e6\"\n@@ -1388,12 +1529,6 @@ progress@2.0.3:\n   resolved \"https://registry.yarnpkg.com/progress/-/progress-2.0.3.tgz#7e8cf8d8f5b8f239c1bc68beb4eb78567d572ef8\"\n   integrity sha512-7PiHtLll5LdnKIMw100I+8xJXR5gW2QwWYkT6iJva0bXitZKa/XMrSbdmg3r2Xnaidz9Qumd0VPaMrZlF9V9sA==\n \n-promisify-node@~0.3.0:\n-  version \"0.3.0\"\n-  resolved \"https://registry.yarnpkg.com/promisify-node/-/promisify-node-0.3.0.tgz#b4b55acf90faa7d2b8b90ca396899086c03060cf\"\n-  dependencies:\n-    nodegit-promise \"~4.0.0\"\n-\n proxy-from-env@1.1.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/proxy-from-env/-/proxy-from-env-1.1.0.tgz#e102f16ca355424865755d2c9e8ea4f24d58c3e2\"\n@@ -1506,22 +1641,6 @@ readable-stream@^3.1.1, readable-stream@^3.4.0:\n     string_decoder \"^1.1.1\"\n     util-deprecate \"^1.0.1\"\n \n-request-promise-core@1.1.4:\n-  version \"1.1.4\"\n-  resolved \"https://registry.yarnpkg.com/request-promise-core/-/request-promise-core-1.1.4.tgz#3eedd4223208d419867b78ce815167d10593a22f\"\n-  integrity sha512-TTbAfBBRdWD7aNNOoVOBH4pN/KigV6LyapYNNlAPA8JwbovRti1E88m3sYAwsLi5ryhPKsE9APwnjFTgdUjTpw==\n-  dependencies:\n-    lodash \"^4.17.19\"\n-\n-request-promise-native@^1.0.5:\n-  version \"1.0.9\"\n-  resolved \"https://registry.yarnpkg.com/request-promise-native/-/request-promise-native-1.0.9.tgz#e407120526a5efdc9a39b28a5679bf47b9d9dc28\"\n-  integrity sha512-wcW+sIUiWnKgNY0dqCpOZkUbF/I+YPi+f09JZIDa39Ec+q82CpSYniDp+ISgTTbKmnpJWASeJBPZmoxH84wt3g==\n-  dependencies:\n-    request-promise-core \"1.1.4\"\n-    stealthy-require \"^1.1.1\"\n-    tough-cookie \"^2.3.3\"\n-\n request@^2.87.0:\n   version \"2.88.2\"\n   resolved \"https://registry.yarnpkg.com/request/-/request-2.88.2.tgz#d73c918731cb5a87da047e207234146f664d12b3\"\n@@ -1557,6 +1676,13 @@ requires-port@1.x.x:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/requires-port/-/requires-port-1.0.0.tgz#925d2601d39ac485e091cf0da5c6e694dc3dcaff\"\n \n+responselike@^2.0.0:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/responselike/-/responselike-2.0.1.tgz#9a0bc8fdc252f3fb1cca68b016591059ba1422bc\"\n+  integrity sha512-4gl03wn3hj1HP3yzgdI7d3lCkF95F21Pz4BPGvKHinyQzALR5CapwC8yIi0Rh58DEMQ/SguC03wFj2k0M/mHhw==\n+  dependencies:\n+    lowercase-keys \"^2.0.0\"\n+\n rimraf@2, rimraf@^2.6.1:\n   version \"2.6.1\"\n   resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-2.6.1.tgz#c2338ec643df7a1b7fe5c54fa86f57428a55f33d\"\n@@ -1649,11 +1775,6 @@ stats-analysis@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/stats-analysis/-/stats-analysis-2.0.0.tgz#f45c516ff5c5d26c26f2d8c7b3d57592802d6187\"\n \n-stealthy-require@^1.1.1:\n-  version \"1.1.1\"\n-  resolved \"https://registry.yarnpkg.com/stealthy-require/-/stealthy-require-1.1.1.tgz#35b09875b4ff49f26a777e509b3090a3226bf24b\"\n-  integrity sha512-ZnWpYnYugiOVEY5GkcuJK1io5V8QmNYChG62gSit9pQVGErXtrKuPC55ITaVSukmMta5qpMU7vqLt2Lnni4f/g==\n-\n string-width@^1.0.1, string-width@^1.0.2:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/string-width/-/string-width-1.0.2.tgz#118bdf5b8cdc51a2a7e70d211e07e2b0b9b107d3\"\n@@ -1758,15 +1879,7 @@ tar-stream@^2.1.4:\n     inherits \"^2.0.3\"\n     readable-stream \"^3.1.1\"\n \n-tar@^2.0.0:\n-  version \"2.2.1\"\n-  resolved \"https://registry.yarnpkg.com/tar/-/tar-2.2.1.tgz#8e4d2a256c0e2185c6b18ad694aec968b83cb1d1\"\n-  dependencies:\n-    block-stream \"*\"\n-    fstream \"^1.0.2\"\n-    inherits \"2\"\n-\n-tar@^4:\n+tar@^4, tar@^4.4.8:\n   version \"4.4.19\"\n   resolved \"https://registry.yarnpkg.com/tar/-/tar-4.4.19.tgz#2e4d7263df26f2b914dee10c825ab132123742f3\"\n   integrity sha512-a20gEsvHnWe0ygBY8JbxoM4w3SJdhc7ZAuxkLqh+nvNQN2IOt0B5lLgM490X5Hl8FF0dl0tOf2ewFYAlIFgzVA==\n@@ -1794,7 +1907,12 @@ to-buffer@^1.1.1:\n   resolved \"https://registry.yarnpkg.com/to-buffer/-/to-buffer-1.1.1.tgz#493bd48f62d7c43fcded313a03dcadb2e1213a80\"\n   integrity sha512-lx9B5iv7msuFYE3dytT+KE5tap+rNYw+K4jVkb9R/asAb+pbBSM17jtunHplhBe6RRJdZx3Pn2Jph24O32mOVg==\n \n-tough-cookie@^2.3.3, tough-cookie@~2.5.0:\n+to-readable-stream@^2.0.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/to-readable-stream/-/to-readable-stream-2.1.0.tgz#82880316121bea662cdc226adb30addb50cb06e8\"\n+  integrity sha512-o3Qa6DGg1CEXshSdvWNX2sN4QHqg03SPq7U6jPXRahlQdl5dK8oXjkU/2/sGrnOZKeGV1zLSO8qPwyKklPPE7w==\n+\n+tough-cookie@~2.5.0:\n   version \"2.5.0\"\n   resolved \"https://registry.yarnpkg.com/tough-cookie/-/tough-cookie-2.5.0.tgz#cd9fb2a0aa1d5a12b473bd9fb96fa3dcff65ade2\"\n   integrity sha512-nlLsUzgm1kfLXSXfRZMc1KLAugd4hqJHDTvc2hDIwS3mZAfMEuMbc03SujMF+GEcpaX/qboeycw6iO8JwVv2+g==\n@@ -1822,6 +1940,11 @@ tweetnacl@^0.14.3, tweetnacl@~0.14.0:\n   version \"0.14.5\"\n   resolved \"https://registry.yarnpkg.com/tweetnacl/-/tweetnacl-0.14.5.tgz#5ae68177f192d4456269d108afa93ff8743f4f64\"\n \n+type-fest@^0.10.0:\n+  version \"0.10.0\"\n+  resolved \"https://registry.yarnpkg.com/type-fest/-/type-fest-0.10.0.tgz#7f06b2b9fbfc581068d1341ffabd0349ceafc642\"\n+  integrity sha512-EUV9jo4sffrwlg8s0zDhP0T2WD3pru5Xi0+HTE3zTUmBaZNhfkite9PdSJwdXLwPVW0jnAHT56pZHIOYckPEiw==\n+\n typedarray-to-buffer@^3.1.5:\n   version \"3.1.5\"\n   resolved \"https://registry.yarnpkg.com/typedarray-to-buffer/-/typedarray-to-buffer-3.1.5.tgz#a97ee7a9ff42691b9f783ff1bc5112fe3fca9080\""
            },
            {
                "file": "scripts/release/package.json",
                "git_diff": "@@ -17,7 +17,7 @@\n     \"log-update\": \"^2.1.0\",\n     \"progress-estimator\": \"^0.2.1\",\n     \"prompt-promise\": \"^1.0.3\",\n-    \"puppeteer\": \"^1.11.0\",\n+    \"puppeteer\": \"^22.6.4\",\n     \"pushstate-server\": \"^3.0.1\",\n     \"semver\": \"^5.4.1\"\n   }"
            },
            {
                "file": "scripts/release/yarn.lock",
                "git_diff": "@@ -2,6 +2,62 @@\n # yarn lockfile v1\n \n \n+\"@babel/code-frame@^7.0.0\":\n+  version \"7.24.7\"\n+  resolved \"https://registry.yarnpkg.com/@babel/code-frame/-/code-frame-7.24.7.tgz#882fd9e09e8ee324e496bd040401c6f046ef4465\"\n+  integrity sha512-BcYH1CVJBO9tvyIZ2jVeXgSIMvGZ2FDRvDdOIVQyuklNKSsx+eppDEBq/g47Ayw+RqNFE+URvOShmf+f/qwAlA==\n+  dependencies:\n+    \"@babel/highlight\" \"^7.24.7\"\n+    picocolors \"^1.0.0\"\n+\n+\"@babel/helper-validator-identifier@^7.24.7\":\n+  version \"7.24.7\"\n+  resolved \"https://registry.yarnpkg.com/@babel/helper-validator-identifier/-/helper-validator-identifier-7.24.7.tgz#75b889cfaf9e35c2aaf42cf0d72c8e91719251db\"\n+  integrity sha512-rR+PBcQ1SMQDDyF6X0wxtG8QyLCgUB0eRAGguqRLfkCA87l7yAP7ehq8SNj96OOGTO8OBV70KhuFYcIkHXOg0w==\n+\n+\"@babel/highlight@^7.24.7\":\n+  version \"7.24.7\"\n+  resolved \"https://registry.yarnpkg.com/@babel/highlight/-/highlight-7.24.7.tgz#a05ab1df134b286558aae0ed41e6c5f731bf409d\"\n+  integrity sha512-EStJpq4OuY8xYfhGVXngigBJRWxftKX9ksiGDnmlY3o7B/V7KIAc9X4oiK87uPJSc/vs5L869bem5fhZa8caZw==\n+  dependencies:\n+    \"@babel/helper-validator-identifier\" \"^7.24.7\"\n+    chalk \"^2.4.2\"\n+    js-tokens \"^4.0.0\"\n+    picocolors \"^1.0.0\"\n+\n+\"@puppeteer/browsers@2.2.3\":\n+  version \"2.2.3\"\n+  resolved \"https://registry.yarnpkg.com/@puppeteer/browsers/-/browsers-2.2.3.tgz#ad6b79129c50825e77ddaba082680f4dad0b674e\"\n+  integrity sha512-bJ0UBsk0ESOs6RFcLXOt99a3yTDcOKlzfjad+rhFwdaG1Lu/Wzq58GHYCDTlZ9z6mldf4g+NTb+TXEfe0PpnsQ==\n+  dependencies:\n+    debug \"4.3.4\"\n+    extract-zip \"2.0.1\"\n+    progress \"2.0.3\"\n+    proxy-agent \"6.4.0\"\n+    semver \"7.6.0\"\n+    tar-fs \"3.0.5\"\n+    unbzip2-stream \"1.4.3\"\n+    yargs \"17.7.2\"\n+\n+\"@tootallnate/quickjs-emscripten@^0.23.0\":\n+  version \"0.23.0\"\n+  resolved \"https://registry.yarnpkg.com/@tootallnate/quickjs-emscripten/-/quickjs-emscripten-0.23.0.tgz#db4ecfd499a9765ab24002c3b696d02e6d32a12c\"\n+  integrity sha512-C5Mc6rdnsaJDjO3UpGW/CQTHtCKaYlScZTly4JIu97Jxo/odCiH0ITnDXSJPTOrEKk/ycSZ0AOgTmkDtkOsvIA==\n+\n+\"@types/node@*\":\n+  version \"20.14.6\"\n+  resolved \"https://registry.yarnpkg.com/@types/node/-/node-20.14.6.tgz#f3c19ffc98c2220e18de259bb172dd4d892a6075\"\n+  integrity sha512-JbA0XIJPL1IiNnU7PFxDXyfAwcwVVrOoqyzzyQTyMeVhBzkJVMSkC1LlVsRQ2lpqiY4n6Bb9oCS6lzDKVQxbZw==\n+  dependencies:\n+    undici-types \"~5.26.4\"\n+\n+\"@types/yauzl@^2.9.1\":\n+  version \"2.10.3\"\n+  resolved \"https://registry.yarnpkg.com/@types/yauzl/-/yauzl-2.10.3.tgz#e9b2808b4f109504a03cda958259876f61017999\"\n+  integrity sha512-oJoftv0LSuaDZE3Le4DbKX+KS9G36NzOeSap90UIK0yMA/NhKJhqlSGtNDORNRaIbQfzjXDrQa0ytJ6mNRGz/Q==\n+  dependencies:\n+    \"@types/node\" \"*\"\n+\n accepts@^1.2.5, accepts@~1.3.3:\n   version \"1.3.5\"\n   resolved \"https://registry.yarnpkg.com/accepts/-/accepts-1.3.5.tgz#eb777df6011723a3b14e8a72c0805c8e86746bd2\"\n@@ -10,12 +66,12 @@ accepts@^1.2.5, accepts@~1.3.3:\n     mime-types \"~2.1.18\"\n     negotiator \"0.6.1\"\n \n-agent-base@^4.3.0:\n-  version \"4.3.0\"\n-  resolved \"https://registry.yarnpkg.com/agent-base/-/agent-base-4.3.0.tgz#8165f01c436009bccad0b1d122f05ed770efc6ee\"\n-  integrity sha512-salcGninV0nPrwpGNn4VTXBb1SOuXQBiqbrNXoeizJsHrsL6ERFM2Ne3JUSBWRE6aeNJI2ROP/WEEIDUiDe3cg==\n+agent-base@^7.0.2, agent-base@^7.1.0, agent-base@^7.1.1:\n+  version \"7.1.1\"\n+  resolved \"https://registry.yarnpkg.com/agent-base/-/agent-base-7.1.1.tgz#bdbded7dfb096b751a2a087eeeb9664725b2e317\"\n+  integrity sha512-H0TSyFNDMomMNJQBn8wFV5YC/2eJ+VXECwOadZJT554xP6cODZHPX3H9QMQECxvrgiSOP1pHjy1sMWQVYJOUOA==\n   dependencies:\n-    es6-promisify \"^5.0.0\"\n+    debug \"^4.3.4\"\n \n ansi-escape-sequences@^4.0.0:\n   version \"4.0.0\"\n@@ -36,6 +92,11 @@ ansi-regex@^3.0.0:\n   version \"3.0.0\"\n   resolved \"https://registry.yarnpkg.com/ansi-regex/-/ansi-regex-3.0.0.tgz#ed0317c322064f79466c02966bddb605ab37d998\"\n \n+ansi-regex@^5.0.1:\n+  version \"5.0.1\"\n+  resolved \"https://registry.yarnpkg.com/ansi-regex/-/ansi-regex-5.0.1.tgz#082cb2c89c9fe8659a311a53bd6a4dc5301db304\"\n+  integrity sha512-quJQXlTSUGL2LH9SUXo8VwsY4soanhgo6LNSm84E1LBcE8s3O0wpdiRzyR9z/ZZJMlMWv37qOOb9pdJlMUEKFQ==\n+\n ansi-styles@^3.1.0:\n   version \"3.2.0\"\n   resolved \"https://registry.yarnpkg.com/ansi-styles/-/ansi-styles-3.2.0.tgz#c159b8d5be0f9e5a6f346dab94f16ce022161b88\"\n@@ -49,6 +110,18 @@ ansi-styles@^3.2.1:\n   dependencies:\n     color-convert \"^1.9.0\"\n \n+ansi-styles@^4.0.0:\n+  version \"4.3.0\"\n+  resolved \"https://registry.yarnpkg.com/ansi-styles/-/ansi-styles-4.3.0.tgz#edd803628ae71c04c85ae7a0906edad34b648937\"\n+  integrity sha512-zbB9rCJAT1rbjiVDb2hqKFHNYLxgtk8NURxZ3IZwD3F6NtxbXZQCnnSi1Lkx+IDohdPlFp222wVALIheZJQSEg==\n+  dependencies:\n+    color-convert \"^2.0.1\"\n+\n+argparse@^2.0.1:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/argparse/-/argparse-2.0.1.tgz#246f50f3ca78a3240f6c997e8a9bd1eac49e4b38\"\n+  integrity sha512-8+9WqebbFzpX9OR+Wa6O29asIogeRMzcGtAINdpMHHyAg10f05aSFVBbcEqGf/PXw1EjAZ+q2/bEBg3DvurK3Q==\n+\n array-back@^1.0.3, array-back@^1.0.4:\n   version \"1.0.4\"\n   resolved \"https://registry.yarnpkg.com/array-back/-/array-back-1.0.4.tgz#644ba7f095f7ffcf7c43b5f0dc39d3c1f03c063b\"\n@@ -61,16 +134,66 @@ array-back@^2.0.0:\n   dependencies:\n     typical \"^2.6.1\"\n \n-async-limiter@~1.0.0:\n-  version \"1.0.1\"\n-  resolved \"https://registry.yarnpkg.com/async-limiter/-/async-limiter-1.0.1.tgz#dd379e94f0db8310b08291f9d64c3209766617fd\"\n-  integrity sha512-csOlWGAcRFJaI6m+F2WKdnMKr4HhdhFVBk0H/QbJFMCr+uO2kwohwXQPxw/9OCxp05r5ghVBFSyioixx3gfkNQ==\n+ast-types@^0.13.4:\n+  version \"0.13.4\"\n+  resolved \"https://registry.yarnpkg.com/ast-types/-/ast-types-0.13.4.tgz#ee0d77b343263965ecc3fb62da16e7222b2b6782\"\n+  integrity sha512-x1FCFnFifvYDDzTaLII71vG5uvDwgtmDTEVWAxrgeiR8VjMONcCXJx7E+USjDtHlwFmt9MysbqgF9b9Vjr6w+w==\n+  dependencies:\n+    tslib \"^2.0.1\"\n+\n+b4a@^1.6.4:\n+  version \"1.6.6\"\n+  resolved \"https://registry.yarnpkg.com/b4a/-/b4a-1.6.6.tgz#a4cc349a3851987c3c4ac2d7785c18744f6da9ba\"\n+  integrity sha512-5Tk1HLk6b6ctmjIkAcU/Ujv/1WqiDl0F0JdRCR80VsOcUlHcu7pWeWRlOqQLHfDEsVx9YH/aif5AG4ehoCtTmg==\n \n balanced-match@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/balanced-match/-/balanced-match-1.0.0.tgz#89b4d199ab2bee49de164ea02b89ce462d71b767\"\n   integrity sha1-ibTRmasr7kneFk6gK4nORi1xt2c=\n \n+bare-events@^2.0.0, bare-events@^2.2.0:\n+  version \"2.4.2\"\n+  resolved \"https://registry.yarnpkg.com/bare-events/-/bare-events-2.4.2.tgz#3140cca7a0e11d49b3edc5041ab560659fd8e1f8\"\n+  integrity sha512-qMKFd2qG/36aA4GwvKq8MxnPgCQAmBWmSyLWsJcbn8v03wvIPQ/hG1Ms8bPzndZxMDoHpxez5VOS+gC9Yi24/Q==\n+\n+bare-fs@^2.1.1:\n+  version \"2.3.1\"\n+  resolved \"https://registry.yarnpkg.com/bare-fs/-/bare-fs-2.3.1.tgz#cdbd63dac7a552dfb2b87d18c822298d1efd213d\"\n+  integrity sha512-W/Hfxc/6VehXlsgFtbB5B4xFcsCl+pAh30cYhoFyXErf6oGrwjh8SwiPAdHgpmWonKuYpZgGywN0SXt7dgsADA==\n+  dependencies:\n+    bare-events \"^2.0.0\"\n+    bare-path \"^2.0.0\"\n+    bare-stream \"^2.0.0\"\n+\n+bare-os@^2.1.0:\n+  version \"2.4.0\"\n+  resolved \"https://registry.yarnpkg.com/bare-os/-/bare-os-2.4.0.tgz#5de5e3ba7704f459c9656629edca7cc736e06608\"\n+  integrity sha512-v8DTT08AS/G0F9xrhyLtepoo9EJBJ85FRSMbu1pQUlAf6A8T0tEEQGMVObWeqpjhSPXsE0VGlluFBJu2fdoTNg==\n+\n+bare-path@^2.0.0, bare-path@^2.1.0:\n+  version \"2.1.3\"\n+  resolved \"https://registry.yarnpkg.com/bare-path/-/bare-path-2.1.3.tgz#594104c829ef660e43b5589ec8daef7df6cedb3e\"\n+  integrity sha512-lh/eITfU8hrj9Ru5quUp0Io1kJWIk1bTjzo7JH1P5dWmQ2EL4hFUlfI8FonAhSlgIfhn63p84CDY/x+PisgcXA==\n+  dependencies:\n+    bare-os \"^2.1.0\"\n+\n+bare-stream@^2.0.0:\n+  version \"2.1.3\"\n+  resolved \"https://registry.yarnpkg.com/bare-stream/-/bare-stream-2.1.3.tgz#070b69919963a437cc9e20554ede079ce0a129b2\"\n+  integrity sha512-tiDAH9H/kP+tvNO5sczyn9ZAA7utrSMobyDchsnyyXBuUe2FSQWbxhtuHB8jwpHYYevVo2UJpcmvvjrbHboUUQ==\n+  dependencies:\n+    streamx \"^2.18.0\"\n+\n+base64-js@^1.3.1:\n+  version \"1.5.1\"\n+  resolved \"https://registry.yarnpkg.com/base64-js/-/base64-js-1.5.1.tgz#1b1b440160a5bf7ad40b650f095963481903930a\"\n+  integrity sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==\n+\n+basic-ftp@^5.0.2:\n+  version \"5.0.5\"\n+  resolved \"https://registry.yarnpkg.com/basic-ftp/-/basic-ftp-5.0.5.tgz#14a474f5fffecca1f4f406f1c26b18f800225ac0\"\n+  integrity sha512-4Bcg1P8xhUuqcii/S0Z9wiHIrQVPMermM1any+MX5GeGD7faD3/msQUDGLol9wOcz4/jbg/WJnGqoJF6LiBdtg==\n+\n brace-expansion@^1.1.7:\n   version \"1.1.11\"\n   resolved \"https://registry.yarnpkg.com/brace-expansion/-/brace-expansion-1.1.11.tgz#3c7fcbf529d87226f3d2f52b966ff5271eb441dd\"\n@@ -79,16 +202,29 @@ brace-expansion@^1.1.7:\n     balanced-match \"^1.0.0\"\n     concat-map \"0.0.1\"\n \n-buffer-from@^1.0.0:\n-  version \"1.1.1\"\n-  resolved \"https://registry.yarnpkg.com/buffer-from/-/buffer-from-1.1.1.tgz#32713bc028f75c02fdb710d7c7bcec1f2c6070ef\"\n-  integrity sha512-MQcXEUbCKtEo7bhqEs6560Hyd4XaovZlO/k9V3hjVUF/zwW7KBVdSK4gIt/bzwS9MbR5qob+F5jusZsb0YQK2A==\n+buffer-crc32@~0.2.3:\n+  version \"0.2.13\"\n+  resolved \"https://registry.yarnpkg.com/buffer-crc32/-/buffer-crc32-0.2.13.tgz#0d333e3f00eac50aa1454abd30ef8c2a5d9a7242\"\n+  integrity sha512-VO9Ht/+p3SN7SKWqcrgEzjGbRSJYTx+Q1pTQC0wrWqHx0vpJraQ6GtHx8tvcg1rlK1byhU5gccxgOgj7B0TDkQ==\n+\n+buffer@^5.2.1:\n+  version \"5.7.1\"\n+  resolved \"https://registry.yarnpkg.com/buffer/-/buffer-5.7.1.tgz#ba62e7c13133053582197160851a8f648e99eed0\"\n+  integrity sha512-EHcyIPBQ4BSGlvjB16k5KgAJ27CIsHY/2JBmCRReo48y9rQ3MaUzWX3KVlBa4U7MyX02HdVj0K7C3WaB3ju7FQ==\n+  dependencies:\n+    base64-js \"^1.3.1\"\n+    ieee754 \"^1.1.13\"\n \n bytes@2.5.0:\n   version \"2.5.0\"\n   resolved \"https://registry.yarnpkg.com/bytes/-/bytes-2.5.0.tgz#4c9423ea2d252c270c41b2bdefeff9bb6b62c06a\"\n   integrity sha1-TJQj6i0lLCcMQbK97+/5u2tiwGo=\n \n+callsites@^3.0.0:\n+  version \"3.1.0\"\n+  resolved \"https://registry.yarnpkg.com/callsites/-/callsites-3.1.0.tgz#b3630abd8943432f54b3f0519238e33cd7df2f73\"\n+  integrity sha512-P8BjAsXvZS+VIDUI11hHCQEv74YT67YUi5JJFNWIqL235sBmjX4+qx9Muvls5ivyNENctx46xQLQ3aTuE7ssaQ==\n+\n chalk@^2.1.0:\n   version \"2.1.0\"\n   resolved \"https://registry.yarnpkg.com/chalk/-/chalk-2.1.0.tgz#ac5becf14fa21b99c6c92ca7a7d7cfd5b17e743e\"\n@@ -106,6 +242,15 @@ chalk@^2.4.1:\n     escape-string-regexp \"^1.0.5\"\n     supports-color \"^5.3.0\"\n \n+chalk@^2.4.2:\n+  version \"2.4.2\"\n+  resolved \"https://registry.yarnpkg.com/chalk/-/chalk-2.4.2.tgz#cd42541677a54333cf541a49108c1432b44c9424\"\n+  integrity sha512-Mti+f9lpJNcwF4tWV8/OrTTtF1gZi+f8FqlyAdouralcFWFQWF2+NgCHShjkCb+IFBLq9buZwE1xckQU4peSuQ==\n+  dependencies:\n+    ansi-styles \"^3.2.1\"\n+    escape-string-regexp \"^1.0.5\"\n+    supports-color \"^5.3.0\"\n+\n child-process-promise@^2.2.1:\n   version \"2.2.1\"\n   resolved \"https://registry.yarnpkg.com/child-process-promise/-/child-process-promise-2.2.1.tgz#4730a11ef610fad450b8f223c79d31d7bdad8074\"\n@@ -114,6 +259,15 @@ child-process-promise@^2.2.1:\n     node-version \"^1.0.0\"\n     promise-polyfill \"^6.0.1\"\n \n+chromium-bidi@0.5.23:\n+  version \"0.5.23\"\n+  resolved \"https://registry.yarnpkg.com/chromium-bidi/-/chromium-bidi-0.5.23.tgz#0fbebc8b0c908d33f870b961d04fca3e2d4fa0ba\"\n+  integrity sha512-1o/gLU9wDqbN5nL2MtfjykjOuighGXc3/hnWueO1haiEoFgX8h5vbvcA4tgdQfjw1mkZ1OEF4x/+HVeqEX6NoA==\n+  dependencies:\n+    mitt \"3.0.1\"\n+    urlpattern-polyfill \"10.0.0\"\n+    zod \"3.23.8\"\n+\n clear@^0.1.0:\n   version \"0.1.0\"\n   resolved \"https://registry.yarnpkg.com/clear/-/clear-0.1.0.tgz#b81b1e03437a716984fd7ac97c87d73bdfe7048a\"\n@@ -134,16 +288,37 @@ cli-spinners@^1.3.1:\n   resolved \"https://registry.yarnpkg.com/cli-spinners/-/cli-spinners-1.3.1.tgz#002c1990912d0d59580c93bd36c056de99e4259a\"\n   integrity sha512-1QL4544moEsDVH9T/l6Cemov/37iv1RtoKf7NJ04A60+4MREXNfx/QvavbH6QoGdsD4N4Mwy49cmaINR/o2mdg==\n \n+cliui@^8.0.1:\n+  version \"8.0.1\"\n+  resolved \"https://registry.yarnpkg.com/cliui/-/cliui-8.0.1.tgz#0c04b075db02cbfe60dc8e6cf2f5486b1a3608aa\"\n+  integrity sha512-BSeNnyus75C4//NQ9gQt1/csTXyo/8Sb+afLAkzAptFuMsod9HFokGNudZpi/oQV73hnVK+sR+5PVRMd+Dr7YQ==\n+  dependencies:\n+    string-width \"^4.2.0\"\n+    strip-ansi \"^6.0.1\"\n+    wrap-ansi \"^7.0.0\"\n+\n color-convert@^1.9.0:\n   version \"1.9.0\"\n   resolved \"https://registry.yarnpkg.com/color-convert/-/color-convert-1.9.0.tgz#1accf97dd739b983bf994d56fec8f95853641b7a\"\n   dependencies:\n     color-name \"^1.1.1\"\n \n+color-convert@^2.0.1:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/color-convert/-/color-convert-2.0.1.tgz#72d3a68d598c9bdb3af2ad1e84f21d896abd4de3\"\n+  integrity sha512-RRECPsj7iu/xb5oKYcsFHSppFNnsj/52OVTRKb4zP5onXwVF3zVmmToNcOfGC+CRDpfK/U584fMg38ZHCaElKQ==\n+  dependencies:\n+    color-name \"~1.1.4\"\n+\n color-name@^1.1.1:\n   version \"1.1.3\"\n   resolved \"https://registry.yarnpkg.com/color-name/-/color-name-1.1.3.tgz#a7d0558bd89c42f795dd42328f740831ca53bc25\"\n \n+color-name@~1.1.4:\n+  version \"1.1.4\"\n+  resolved \"https://registry.yarnpkg.com/color-name/-/color-name-1.1.4.tgz#c2a09a87acbde69543de6f63fa3995c826c536a2\"\n+  integrity sha512-dOy+3AuW3a2wNbZHIuMZpTcgjGuLU/uBL/ubcZF9OXbDo8ff4O8yVp5Bf0efS8uEoYo5q4Fx7dY9OgQGXgAsQA==\n+\n command-line-args@^4.0.7:\n   version \"4.0.7\"\n   resolved \"https://registry.yarnpkg.com/command-line-args/-/command-line-args-4.0.7.tgz#f8d1916ecb90e9e121eda6428e41300bfb64cc46\"\n@@ -186,16 +361,6 @@ concat-map@0.0.1:\n   resolved \"https://registry.yarnpkg.com/concat-map/-/concat-map-0.0.1.tgz#d8a96bd77fd68df7793a73036a3ba0d5405d477b\"\n   integrity sha1-2Klr13/Wjfd5OnMDajug1UBdR3s=\n \n-concat-stream@1.6.2:\n-  version \"1.6.2\"\n-  resolved \"https://registry.yarnpkg.com/concat-stream/-/concat-stream-1.6.2.tgz#904bdf194cd3122fc675c77fc4ac3d4ff0fd1a34\"\n-  integrity sha512-27HBghJxjiZtIk3Ycvn/4kbJk/1uZuJFfuPEns6LaEvpvG1f0hTea8lilrouyo9mVc2GWdcEZ8OLoGmSADlrCw==\n-  dependencies:\n-    buffer-from \"^1.0.0\"\n-    inherits \"^2.0.3\"\n-    readable-stream \"^2.2.2\"\n-    typedarray \"^0.0.6\"\n-\n connect-static-file@1.2.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/connect-static-file/-/connect-static-file-1.2.0.tgz#ad7c2ce423acf0808b15a18ad3268035098e3747\"\n@@ -215,9 +380,15 @@ connect@3.6.2:\n     parseurl \"~1.3.1\"\n     utils-merge \"1.0.0\"\n \n-core-util-is@~1.0.0:\n-  version \"1.0.2\"\n-  resolved \"https://registry.yarnpkg.com/core-util-is/-/core-util-is-1.0.2.tgz#b5fd54220aa2bc5ab57aab7140c940754503c1a7\"\n+cosmiconfig@9.0.0:\n+  version \"9.0.0\"\n+  resolved \"https://registry.yarnpkg.com/cosmiconfig/-/cosmiconfig-9.0.0.tgz#34c3fc58287b915f3ae905ab6dc3de258b55ad9d\"\n+  integrity sha512-itvL5h8RETACmOTFc4UfIyB2RfEHi71Ax6E/PivVxq9NseKbOWpeyHEOIbmAw1rs8Ak0VursQNww7lf7YtUwzg==\n+  dependencies:\n+    env-paths \"^2.2.1\"\n+    import-fresh \"^3.3.0\"\n+    js-yaml \"^4.1.0\"\n+    parse-json \"^5.2.0\"\n \n cross-spawn@^4.0.2:\n   version \"4.0.2\"\n@@ -226,6 +397,11 @@ cross-spawn@^4.0.2:\n     lru-cache \"^4.0.1\"\n     which \"^1.2.9\"\n \n+data-uri-to-buffer@^6.0.2:\n+  version \"6.0.2\"\n+  resolved \"https://registry.yarnpkg.com/data-uri-to-buffer/-/data-uri-to-buffer-6.0.2.tgz#8a58bb67384b261a38ef18bea1810cb01badd28b\"\n+  integrity sha512-7hvf7/GW8e86rW0ptuwS3OcBGDjIi6SZva7hCyWC0yYry2cOPmLIjXAUHI6DK2HsnwJd9ifmt57i8eV2n4YNpw==\n+\n debug@2.6.7:\n   version \"2.6.7\"\n   resolved \"https://registry.yarnpkg.com/debug/-/debug-2.6.7.tgz#92bad1f6d05bbb6bba22cca88bcd0ec894c2861e\"\n@@ -247,24 +423,40 @@ debug@2.6.9:\n   dependencies:\n     ms \"2.0.0\"\n \n+debug@4, debug@4.3.5, debug@^4.1.1, debug@^4.3.4:\n+  version \"4.3.5\"\n+  resolved \"https://registry.yarnpkg.com/debug/-/debug-4.3.5.tgz#e83444eceb9fedd4a1da56d671ae2446a01a6e1e\"\n+  integrity sha512-pt0bNEmneDIvdL1Xsd9oDQ/wrQRkXDT4AUWlNZNPKvW5x/jyO9VFXkJUP07vQ2upmw5PlaITaPKc31jK13V+jg==\n+  dependencies:\n+    ms \"2.1.2\"\n+\n+debug@4.3.4:\n+  version \"4.3.4\"\n+  resolved \"https://registry.yarnpkg.com/debug/-/debug-4.3.4.tgz#1319f6579357f2338d3337d2cdd4914bb5dcc865\"\n+  integrity sha512-PRWFHuSU3eDtQJPvnNY7Jcket1j0t5OuOsFzPPzsekD52Zl8qUfFIPEiswXqIvHWGVHOgX+7G/vCNNhehwxfkQ==\n+  dependencies:\n+    ms \"2.1.2\"\n+\n debug@^3.1.0:\n   version \"3.2.6\"\n   resolved \"https://registry.yarnpkg.com/debug/-/debug-3.2.6.tgz#e83d17de16d8a7efb7717edbe5fb10135eee629b\"\n   integrity sha512-mel+jf7nrtEl5Pn1Qx46zARXKDpBbvzezse7p7LqINmdoIk8PYP5SySaxEmYv6TZ0JyEKA1hsCId6DIhgITtWQ==\n   dependencies:\n     ms \"^2.1.1\"\n \n-debug@^4.1.0:\n-  version \"4.1.0\"\n-  resolved \"https://registry.yarnpkg.com/debug/-/debug-4.1.0.tgz#373687bffa678b38b1cd91f861b63850035ddc87\"\n-  integrity sha512-heNPJUJIqC+xB6ayLAMHaIrmN9HKa7aQO8MGqKpvCA+uJYVcvR6l5kgdrhRuwPFHU7P5/A1w0BjByPHwpfTDKg==\n-  dependencies:\n-    ms \"^2.1.1\"\n-\n deep-extend@~0.5.0:\n   version \"0.5.0\"\n   resolved \"https://registry.yarnpkg.com/deep-extend/-/deep-extend-0.5.0.tgz#6ef4a09b05f98b0e358d6d93d4ca3caec6672803\"\n \n+degenerator@^5.0.0:\n+  version \"5.0.1\"\n+  resolved \"https://registry.yarnpkg.com/degenerator/-/degenerator-5.0.1.tgz#9403bf297c6dad9a1ece409b37db27954f91f2f5\"\n+  integrity sha512-TllpMR/t0M5sqCXfj85i4XaAzxmS5tVA16dqvdkMwGmzI+dXLXnw3J+3Vdv7VKw+ThlTMboK6i9rnZ6Nntj5CQ==\n+  dependencies:\n+    ast-types \"^0.13.4\"\n+    escodegen \"^2.1.0\"\n+    esprima \"^4.0.1\"\n+\n depd@~1.1.0, depd@~1.1.1, depd@~1.1.2:\n   version \"1.1.2\"\n   resolved \"https://registry.yarnpkg.com/depd/-/depd-1.1.2.tgz#9bcd52e14c097763e749b274c4346ed2e560b5a9\"\n@@ -275,6 +467,11 @@ destroy@~1.0.4:\n   resolved \"https://registry.yarnpkg.com/destroy/-/destroy-1.0.4.tgz#978857442c44749e4206613e37946205826abd80\"\n   integrity sha1-l4hXRCxEdJ5CBmE+N5RiBYJqvYA=\n \n+devtools-protocol@0.0.1299070:\n+  version \"0.0.1299070\"\n+  resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.1299070.tgz#b3e4cf0b678a46f0f907ae6e07e03ad3a53c00df\"\n+  integrity sha512-+qtL3eX50qsJ7c+qVyagqi7AWMoQCBGNfoyJZMwm/NSXVqLYbuitrWEEIzxfUmTNy7//Xe8yhMmQ+elj3uAqSg==\n+\n diff@^3.5.0:\n   version \"3.5.0\"\n   resolved \"https://registry.yarnpkg.com/diff/-/diff-3.5.0.tgz#800c0dd1e0a8bfbc95835c202ad220fe317e5a12\"\n@@ -285,22 +482,39 @@ ee-first@1.1.1:\n   resolved \"https://registry.yarnpkg.com/ee-first/-/ee-first-1.1.1.tgz#590c61156b0ae2f4f0255732a158b266bc56b21d\"\n   integrity sha1-WQxhFWsK4vTwJVcyoViyZrxWsh0=\n \n+emoji-regex@^8.0.0:\n+  version \"8.0.0\"\n+  resolved \"https://registry.yarnpkg.com/emoji-regex/-/emoji-regex-8.0.0.tgz#e818fd69ce5ccfcb404594f842963bf53164cc37\"\n+  integrity sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==\n+\n encodeurl@~1.0.1:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/encodeurl/-/encodeurl-1.0.2.tgz#ad3ff4c86ec2d029322f5a02c3a9a606c95b3f59\"\n   integrity sha1-rT/0yG7C0CkyL1oCw6mmBslbP1k=\n \n-es6-promise@^4.0.3:\n-  version \"4.2.8\"\n-  resolved \"https://registry.yarnpkg.com/es6-promise/-/es6-promise-4.2.8.tgz#4eb21594c972bc40553d276e510539143db53e0a\"\n-  integrity sha512-HJDGx5daxeIvxdBxvG2cb9g4tEvwIk3i8+nhX0yGrYmZUzbkdg8QbDevheDB8gd0//uPj4c1EQua8Q+MViT0/w==\n+end-of-stream@^1.1.0:\n+  version \"1.4.4\"\n+  resolved \"https://registry.yarnpkg.com/end-of-stream/-/end-of-stream-1.4.4.tgz#5ae64a5f45057baf3626ec14da0ca5e4b2431eb0\"\n+  integrity sha512-+uw1inIHVPQoaVuHzRyXd21icM+cnt4CzD5rW+NC1wjOUSTOs+Te7FOv7AhN7vS9x/oIyhLP5PR1H+phQAHu5Q==\n+  dependencies:\n+    once \"^1.4.0\"\n+\n+env-paths@^2.2.1:\n+  version \"2.2.1\"\n+  resolved \"https://registry.yarnpkg.com/env-paths/-/env-paths-2.2.1.tgz#420399d416ce1fbe9bc0a07c62fa68d67fd0f8f2\"\n+  integrity sha512-+h1lkLKhZMTYjog1VEpJNG7NZJWcuc2DDk/qsqSTRRCOXiLjeQ1d1/udrUGhqMxUgAlwKNZ0cf2uqan5GLuS2A==\n \n-es6-promisify@^5.0.0:\n-  version \"5.0.0\"\n-  resolved \"https://registry.yarnpkg.com/es6-promisify/-/es6-promisify-5.0.0.tgz#5109d62f3e56ea967c4b63505aef08291c8a5203\"\n-  integrity sha1-UQnWLz5W6pZ8S2NQWu8IKRyKUgM=\n+error-ex@^1.3.1:\n+  version \"1.3.2\"\n+  resolved \"https://registry.yarnpkg.com/error-ex/-/error-ex-1.3.2.tgz#b4ac40648107fdcdcfae242f428bea8a14d4f1bf\"\n+  integrity sha512-7dFHNmqeFSEt2ZBsCriorKnn3Z2pj+fd9kmI6QoWw4//DL+icEBfc0U7qJCisqrTsKTjw4fNFy2pW9OqStD84g==\n   dependencies:\n-    es6-promise \"^4.0.3\"\n+    is-arrayish \"^0.2.1\"\n+\n+escalade@^3.1.1:\n+  version \"3.1.2\"\n+  resolved \"https://registry.yarnpkg.com/escalade/-/escalade-3.1.2.tgz#54076e9ab29ea5bf3d8f1ed62acffbb88272df27\"\n+  integrity sha512-ErCHMCae19vR8vQGe50xIsVomy19rg6gFu3+r3jkEO46suLMWBksvVyoGgQV+jOfl84ZSOSlmv6Gxa89PmTGmA==\n \n escape-html@~1.0.3:\n   version \"1.0.3\"\n@@ -311,25 +525,57 @@ escape-string-regexp@^1.0.5:\n   version \"1.0.5\"\n   resolved \"https://registry.yarnpkg.com/escape-string-regexp/-/escape-string-regexp-1.0.5.tgz#1b61c0562190a8dff6ae3bb2cf0200ca130b86d4\"\n \n+escodegen@^2.1.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/escodegen/-/escodegen-2.1.0.tgz#ba93bbb7a43986d29d6041f99f5262da773e2e17\"\n+  integrity sha512-2NlIDTwUWJN0mRPQOdtQBzbUHvdGY2P1VXSyU83Q3xKxM7WHX2Ql8dKq782Q9TgQUNOLEzEYu9bzLNj1q88I5w==\n+  dependencies:\n+    esprima \"^4.0.1\"\n+    estraverse \"^5.2.0\"\n+    esutils \"^2.0.2\"\n+  optionalDependencies:\n+    source-map \"~0.6.1\"\n+\n+esprima@^4.0.1:\n+  version \"4.0.1\"\n+  resolved \"https://registry.yarnpkg.com/esprima/-/esprima-4.0.1.tgz#13b04cdb3e6c5d19df91ab6987a8695619b0aa71\"\n+  integrity sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==\n+\n+estraverse@^5.2.0:\n+  version \"5.3.0\"\n+  resolved \"https://registry.yarnpkg.com/estraverse/-/estraverse-5.3.0.tgz#2eea5290702f26ab8fe5370370ff86c965d21123\"\n+  integrity sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==\n+\n+esutils@^2.0.2:\n+  version \"2.0.3\"\n+  resolved \"https://registry.yarnpkg.com/esutils/-/esutils-2.0.3.tgz#74d2eb4de0b8da1293711910d50775b9b710ef64\"\n+  integrity sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==\n+\n etag@~1.8.0, etag@~1.8.1:\n   version \"1.8.1\"\n   resolved \"https://registry.yarnpkg.com/etag/-/etag-1.8.1.tgz#41ae2eeb65efa62268aebfea83ac7d79299b0887\"\n   integrity sha1-Qa4u62XvpiJorr/qg6x9eSmbCIc=\n \n-extract-zip@^1.6.6:\n-  version \"1.6.7\"\n-  resolved \"https://registry.yarnpkg.com/extract-zip/-/extract-zip-1.6.7.tgz#a840b4b8af6403264c8db57f4f1a74333ef81fe9\"\n-  integrity sha1-qEC0uK9kAyZMjbV/Txp0Mz74H+k=\n+extract-zip@2.0.1:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/extract-zip/-/extract-zip-2.0.1.tgz#663dca56fe46df890d5f131ef4a06d22bb8ba13a\"\n+  integrity sha512-GDhU9ntwuKyGXdZBUgTIe+vXnWj0fppUEtMDL0+idd5Sta8TGpHssn/eusA9mrPr9qNDym6SxAYZjNvCn/9RBg==\n   dependencies:\n-    concat-stream \"1.6.2\"\n-    debug \"2.6.9\"\n-    mkdirp \"0.5.1\"\n-    yauzl \"2.4.1\"\n+    debug \"^4.1.1\"\n+    get-stream \"^5.1.0\"\n+    yauzl \"^2.10.0\"\n+  optionalDependencies:\n+    \"@types/yauzl\" \"^2.9.1\"\n \n-fd-slicer@~1.0.1:\n-  version \"1.0.1\"\n-  resolved \"https://registry.yarnpkg.com/fd-slicer/-/fd-slicer-1.0.1.tgz#8b5bcbd9ec327c5041bf9ab023fd6750f1177e65\"\n-  integrity sha1-i1vL2ewyfFBBv5qwI/1nUPEXfmU=\n+fast-fifo@^1.2.0, fast-fifo@^1.3.2:\n+  version \"1.3.2\"\n+  resolved \"https://registry.yarnpkg.com/fast-fifo/-/fast-fifo-1.3.2.tgz#286e31de96eb96d38a97899815740ba2a4f3640c\"\n+  integrity sha512-/d9sfos4yxzpwkDkuN7k2SqFKtYNmCTzgfEpz82x34IM9/zc8KGxQoXg1liNC/izpRM/MBdt44Nmx41ZWqk+FQ==\n+\n+fd-slicer@~1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/fd-slicer/-/fd-slicer-1.1.0.tgz#25c7c89cb1f9077f8891bbe61d8f390eae256f1e\"\n+  integrity sha512-cE1qsB/VwyQozZ+q1dGxR8LBYNZeofhEdUNGSMbQD3Gw2lAzX9Zb3uIU6Ebc/Fmyjo9AWWfnn0AUCHqtevs/8g==\n   dependencies:\n     pend \"~1.2.0\"\n \n@@ -372,6 +618,15 @@ fresh@0.5.2:\n   resolved \"https://registry.yarnpkg.com/fresh/-/fresh-0.5.2.tgz#3d8cadd90d976569fa835ab1f8e4b23a105605a7\"\n   integrity sha1-PYyt2Q2XZWn6g1qx+OSyOhBWBac=\n \n+fs-extra@^11.2.0:\n+  version \"11.2.0\"\n+  resolved \"https://registry.yarnpkg.com/fs-extra/-/fs-extra-11.2.0.tgz#e70e17dfad64232287d01929399e0ea7c86b0e5b\"\n+  integrity sha512-PmDi3uwK5nFuXh7XDTlVnS17xJS7vW36is2+w3xcv8SVxiB4NyATf4ctkVY5bkSjX0Y4nbvZCq1/EjtEyr9ktw==\n+  dependencies:\n+    graceful-fs \"^4.2.0\"\n+    jsonfile \"^6.0.1\"\n+    universalify \"^2.0.0\"\n+\n fs-extra@^4.0.2:\n   version \"4.0.2\"\n   resolved \"https://registry.yarnpkg.com/fs-extra/-/fs-extra-4.0.2.tgz#f91704c53d1b461f893452b0c307d9997647ab6b\"\n@@ -380,27 +635,37 @@ fs-extra@^4.0.2:\n     jsonfile \"^4.0.0\"\n     universalify \"^0.1.0\"\n \n-fs.realpath@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/fs.realpath/-/fs.realpath-1.0.0.tgz#1504ad2523158caa40db4a2787cb01411994ea4f\"\n-  integrity sha1-FQStJSMVjKpA20onh8sBQRmU6k8=\n+get-caller-file@^2.0.5:\n+  version \"2.0.5\"\n+  resolved \"https://registry.yarnpkg.com/get-caller-file/-/get-caller-file-2.0.5.tgz#4f94412a82db32f36e3b0b9741f8a97feb031f7e\"\n+  integrity sha512-DyFP3BM/3YHTQOCUL/w0OZHR0lpKeGrxotcHWcqNEdnltqFwXVfhEBQ94eIo34AfQpo0rGki4cyIiftY06h2Fg==\n+\n+get-stream@^5.1.0:\n+  version \"5.2.0\"\n+  resolved \"https://registry.yarnpkg.com/get-stream/-/get-stream-5.2.0.tgz#4966a1795ee5ace65e706c4b7beb71257d6e22d3\"\n+  integrity sha512-nBF+F1rAZVCu/p7rjzgA+Yb4lfYXrpl7a6VmJrU8wF9I1CKvP/QwPNZHnOlwbTkY6dvtFIzFMSyQXbLoTQPRpA==\n+  dependencies:\n+    pump \"^3.0.0\"\n \n-glob@^7.0.5:\n-  version \"7.1.3\"\n-  resolved \"https://registry.yarnpkg.com/glob/-/glob-7.1.3.tgz#3960832d3f1574108342dafd3a67b332c0969df1\"\n-  integrity sha512-vcfuiIxogLV4DlGBHIUOwI0IbrJ8HWPc4MU7HzviGeNho/UJDfi6B5p3sHeWIQ0KGIU0Jpxi5ZHxemQfLkkAwQ==\n+get-uri@^6.0.1:\n+  version \"6.0.3\"\n+  resolved \"https://registry.yarnpkg.com/get-uri/-/get-uri-6.0.3.tgz#0d26697bc13cf91092e519aa63aa60ee5b6f385a\"\n+  integrity sha512-BzUrJBS9EcUb4cFol8r4W3v1cPsSyajLSthNkz5BxbpDcHN5tIrM10E2eNvfnvBn3DaT3DUgx0OpsBKkaOpanw==\n   dependencies:\n-    fs.realpath \"^1.0.0\"\n-    inflight \"^1.0.4\"\n-    inherits \"2\"\n-    minimatch \"^3.0.4\"\n-    once \"^1.3.0\"\n-    path-is-absolute \"^1.0.0\"\n+    basic-ftp \"^5.0.2\"\n+    data-uri-to-buffer \"^6.0.2\"\n+    debug \"^4.3.4\"\n+    fs-extra \"^11.2.0\"\n \n graceful-fs@^4.1.2, graceful-fs@^4.1.6:\n   version \"4.1.11\"\n   resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.1.11.tgz#0e8bdfe4d1ddb8854d64e04ea7c00e2a026e5658\"\n \n+graceful-fs@^4.2.0:\n+  version \"4.2.11\"\n+  resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.2.11.tgz#4183e4e8bf08bb6e05bbb2f7d2e0c8f712ca40e3\"\n+  integrity sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==\n+\n graceful-fs@~4.1.11:\n   version \"4.1.15\"\n   resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.1.15.tgz#ffb703e1066e8a0eeaa4c8b80ba9253eeefbfb00\"\n@@ -425,55 +690,117 @@ http-errors@~1.6.1, http-errors@~1.6.2:\n     setprototypeof \"1.1.0\"\n     statuses \">= 1.4.0 < 2\"\n \n-https-proxy-agent@^2.2.1:\n-  version \"2.2.4\"\n-  resolved \"https://registry.yarnpkg.com/https-proxy-agent/-/https-proxy-agent-2.2.4.tgz#4ee7a737abd92678a293d9b34a1af4d0d08c787b\"\n-  integrity sha512-OmvfoQ53WLjtA9HeYP9RNrWMJzzAz1JGaSFr1nijg0PVR1JaD/xbJq1mdEIIlxGpXp9eSe/O2LgU9DJmTPd0Eg==\n+http-proxy-agent@^7.0.0, http-proxy-agent@^7.0.1:\n+  version \"7.0.2\"\n+  resolved \"https://registry.yarnpkg.com/http-proxy-agent/-/http-proxy-agent-7.0.2.tgz#9a8b1f246866c028509486585f62b8f2c18c270e\"\n+  integrity sha512-T1gkAiYYDWYx3V5Bmyu7HcfcvL7mUrTWiM6yOfa3PIphViJ/gFPbvidQ+veqSOHci/PxBcDabeUNCzpOODJZig==\n   dependencies:\n-    agent-base \"^4.3.0\"\n-    debug \"^3.1.0\"\n+    agent-base \"^7.1.0\"\n+    debug \"^4.3.4\"\n+\n+https-proxy-agent@^7.0.2, https-proxy-agent@^7.0.3:\n+  version \"7.0.4\"\n+  resolved \"https://registry.yarnpkg.com/https-proxy-agent/-/https-proxy-agent-7.0.4.tgz#8e97b841a029ad8ddc8731f26595bad868cb4168\"\n+  integrity sha512-wlwpilI7YdjSkWaQ/7omYBMTliDcmCN8OLihO6I9B86g06lMyAoqgoDpV0XqoaPOKj+0DIdAvnsWfyAAhmimcg==\n+  dependencies:\n+    agent-base \"^7.0.2\"\n+    debug \"4\"\n \n humanize-duration@^3.15.3:\n   version \"3.15.3\"\n   resolved \"https://registry.yarnpkg.com/humanize-duration/-/humanize-duration-3.15.3.tgz#600a939bd9d9a16b696e907b3fc08d1a4f15e8c9\"\n   integrity sha512-BMz6w8p3NVa6QP9wDtqUkXfwgBqDaZ5z/np0EYdoWrLqL849Onp6JWMXMhbHtuvO9jUThLN5H1ThRQ8dUWnYkA==\n \n-inflight@^1.0.4:\n-  version \"1.0.6\"\n-  resolved \"https://registry.yarnpkg.com/inflight/-/inflight-1.0.6.tgz#49bd6331d7d02d0c09bc910a1075ba8165b56df9\"\n-  integrity sha1-Sb1jMdfQLQwJvJEKEHW6gWW1bfk=\n+ieee754@^1.1.13:\n+  version \"1.2.1\"\n+  resolved \"https://registry.yarnpkg.com/ieee754/-/ieee754-1.2.1.tgz#8eb7a10a63fff25d15a57b001586d177d1b0d352\"\n+  integrity sha512-dcyqhDvX1C46lXZcVqCpK+FtMRQVdIMN6/Df5js2zouUsqG7I6sFxitIC+7KYK29KdXOLHdu9zL4sFnoVQnqaA==\n+\n+import-fresh@^3.3.0:\n+  version \"3.3.0\"\n+  resolved \"https://registry.yarnpkg.com/import-fresh/-/import-fresh-3.3.0.tgz#37162c25fcb9ebaa2e6e53d5b4d88ce17d9e0c2b\"\n+  integrity sha512-veYYhQa+D1QBKznvhUHxb8faxlrwUnxseDAbAp457E0wLNio2bOSKnjYDhMj+YiAq61xrMGhQk9iXVk5FzgQMw==\n   dependencies:\n-    once \"^1.3.0\"\n-    wrappy \"1\"\n+    parent-module \"^1.0.0\"\n+    resolve-from \"^4.0.0\"\n \n-inherits@2, inherits@2.0.3, inherits@^2.0.3, inherits@~2.0.3:\n+inherits@2.0.3:\n   version \"2.0.3\"\n   resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.3.tgz#633c2c83e3da42a502f52466022480f4208261de\"\n   integrity sha1-Yzwsg+PaQqUC9SRmAiSA9CCCYd4=\n \n+ip-address@^9.0.5:\n+  version \"9.0.5\"\n+  resolved \"https://registry.yarnpkg.com/ip-address/-/ip-address-9.0.5.tgz#117a960819b08780c3bd1f14ef3c1cc1d3f3ea5a\"\n+  integrity sha512-zHtQzGojZXTwZTHQqra+ETKd4Sn3vgi7uBmlPoXVWZqYvuKmtI0l/VZTjqGmJY9x88GGOaZ9+G9ES8hC4T4X8g==\n+  dependencies:\n+    jsbn \"1.1.0\"\n+    sprintf-js \"^1.1.3\"\n+\n+is-arrayish@^0.2.1:\n+  version \"0.2.1\"\n+  resolved \"https://registry.yarnpkg.com/is-arrayish/-/is-arrayish-0.2.1.tgz#77c99840527aa8ecb1a8ba697b80645a7a926a9d\"\n+  integrity sha512-zz06S8t0ozoDXMG+ube26zeCTNXcKIPJZJi8hBrF4idCLms4CG9QtK7qBl1boi5ODzFpjswb5JPmHCbMpjaYzg==\n+\n is-fullwidth-code-point@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/is-fullwidth-code-point/-/is-fullwidth-code-point-2.0.0.tgz#a3b30a5c4f199183167aaab93beefae3ddfb654f\"\n \n-isarray@~1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/isarray/-/isarray-1.0.0.tgz#bb935d48582cba168c06834957a54a3e07124f11\"\n-  integrity sha1-u5NdSFgsuhaMBoNJV6VKPgcSTxE=\n+is-fullwidth-code-point@^3.0.0:\n+  version \"3.0.0\"\n+  resolved \"https://registry.yarnpkg.com/is-fullwidth-code-point/-/is-fullwidth-code-point-3.0.0.tgz#f116f8064fe90b3f7844a38997c0b75051269f1d\"\n+  integrity sha512-zymm5+u+sCsSWyD9qNaejV3DFvhCKclKdizYaJUuHA83RLjb7nSuGnddCHGv0hk+KY7BMAlsWeK4Ueg6EV6XQg==\n \n isexe@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/isexe/-/isexe-2.0.0.tgz#e8fbf374dc556ff8947a10dcb0572d633f2cfa10\"\n \n+js-tokens@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/js-tokens/-/js-tokens-4.0.0.tgz#19203fb59991df98e3a287050d4647cdeaf32499\"\n+  integrity sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==\n+\n+js-yaml@^4.1.0:\n+  version \"4.1.0\"\n+  resolved \"https://registry.yarnpkg.com/js-yaml/-/js-yaml-4.1.0.tgz#c1fb65f8f5017901cdd2c951864ba18458a10602\"\n+  integrity sha512-wpxZs9NoxZaJESJGIZTyDEaYpl0FKSA+FB9aJiyemKhMwkxQg63h4T1KJgUGHpTqPDNRcmmYLugrRjJlBtWvRA==\n+  dependencies:\n+    argparse \"^2.0.1\"\n+\n+jsbn@1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/jsbn/-/jsbn-1.1.0.tgz#b01307cb29b618a1ed26ec79e911f803c4da0040\"\n+  integrity sha512-4bYVV3aAMtDTTu4+xsDYa6sy9GyJ69/amsu9sYF2zqjiEoZA5xJi3BrfX3uY+/IekIu7MwdObdbDWpoZdBv3/A==\n+\n+json-parse-even-better-errors@^2.3.0:\n+  version \"2.3.1\"\n+  resolved \"https://registry.yarnpkg.com/json-parse-even-better-errors/-/json-parse-even-better-errors-2.3.1.tgz#7c47805a94319928e05777405dc12e1f7a4ee02d\"\n+  integrity sha512-xyFwyhro/JEof6Ghe2iz2NcXoj2sloNsWr/XsERDK/oiPCfaNhl5ONfp+jQdAZRQQ0IJWNzH9zIZF7li91kh2w==\n+\n jsonfile@^4.0.0:\n   version \"4.0.0\"\n   resolved \"https://registry.yarnpkg.com/jsonfile/-/jsonfile-4.0.0.tgz#8771aae0799b64076b76640fca058f9c10e33ecb\"\n   optionalDependencies:\n     graceful-fs \"^4.1.6\"\n \n+jsonfile@^6.0.1:\n+  version \"6.1.0\"\n+  resolved \"https://registry.yarnpkg.com/jsonfile/-/jsonfile-6.1.0.tgz#bc55b2634793c679ec6403094eb13698a6ec0aae\"\n+  integrity sha512-5dgndWOriYSm5cnYaJNhalLNDKOqFwyDB/rr1E9ZsGciGvKPs8R2xYGCacuf3z6K1YKDz182fd+fY3cn3pMqXQ==\n+  dependencies:\n+    universalify \"^2.0.0\"\n+  optionalDependencies:\n+    graceful-fs \"^4.1.6\"\n+\n keypress@~0.2.1:\n   version \"0.2.1\"\n   resolved \"https://registry.yarnpkg.com/keypress/-/keypress-0.2.1.tgz#1e80454250018dbad4c3fe94497d6e67b6269c77\"\n \n+lines-and-columns@^1.1.6:\n+  version \"1.2.4\"\n+  resolved \"https://registry.yarnpkg.com/lines-and-columns/-/lines-and-columns-1.2.4.tgz#eca284f75d2965079309dc0ad9255abb2ebc1632\"\n+  integrity sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==\n+\n lodash.padend@^4.6.1:\n   version \"4.6.1\"\n   resolved \"https://registry.yarnpkg.com/lodash.padend/-/lodash.padend-4.6.1.tgz#53ccba047d06e158d311f45da625f4e49e6f166e\"\n@@ -502,6 +829,18 @@ lru-cache@^4.0.1:\n     pseudomap \"^1.0.2\"\n     yallist \"^2.1.2\"\n \n+lru-cache@^6.0.0:\n+  version \"6.0.0\"\n+  resolved \"https://registry.yarnpkg.com/lru-cache/-/lru-cache-6.0.0.tgz#6d6fe6570ebd96aaf90fcad1dafa3b2566db3a94\"\n+  integrity sha512-Jo6dJ04CmSjuznwJSS3pUeWmd/H0ffTlkXXgwZi+eq1UCmqQwCh+eLsYOYCwY991i2Fah4h1BEMCx4qThGbsiA==\n+  dependencies:\n+    yallist \"^4.0.0\"\n+\n+lru-cache@^7.14.1:\n+  version \"7.18.3\"\n+  resolved \"https://registry.yarnpkg.com/lru-cache/-/lru-cache-7.18.3.tgz#f793896e0fd0e954a59dfdd82f0773808df6aa89\"\n+  integrity sha512-jumlc0BIUrS3qJGgIkWZsyfAM7NCWiBcCDhnd+3NNM5KbBmLTgHVfWBcg6W+rLUsIpzpERPsvwUP7CckAQSOoA==\n+\n \"mime-db@>= 1.36.0 < 2\", mime-db@~1.37.0:\n   version \"1.37.0\"\n   resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.37.0.tgz#0b6a0ce6fdbe9576e25f1f2d2fde8830dc0ad0d8\"\n@@ -524,40 +863,28 @@ mime@^1.3.4:\n   resolved \"https://registry.yarnpkg.com/mime/-/mime-1.6.0.tgz#32cd9e5c64553bd58d19a568af452acff04981b1\"\n   integrity sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==\n \n-mime@^2.0.3:\n-  version \"2.4.0\"\n-  resolved \"https://registry.yarnpkg.com/mime/-/mime-2.4.0.tgz#e051fd881358585f3279df333fe694da0bcffdd6\"\n-  integrity sha512-ikBcWwyqXQSHKtciCcctu9YfPbFYZ4+gbHEmE0Q8jzcTYQg5dHCr3g2wwAZjPoJfQVXZq6KXAjpXOTf5/cjT7w==\n-\n mimic-fn@^1.0.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/mimic-fn/-/mimic-fn-1.1.0.tgz#e667783d92e89dbd342818b5230b9d62a672ad18\"\n \n-minimatch@^3.0.4, minimatch@~3.0.4:\n+minimatch@~3.0.4:\n   version \"3.0.4\"\n   resolved \"https://registry.yarnpkg.com/minimatch/-/minimatch-3.0.4.tgz#5166e286457f03306064be5497e8dbb0c3d32083\"\n   integrity sha512-yJHVQEhyqPLUTgt9B83PXu6W3rx4MvvHvSUvToogpwoGDOUQ+yDrR0HRot+yOCdCO7u4hX3pWft6kWBBcqh0UA==\n   dependencies:\n     brace-expansion \"^1.1.7\"\n \n-minimist@0.0.8:\n-  version \"0.0.8\"\n-  resolved \"https://registry.yarnpkg.com/minimist/-/minimist-0.0.8.tgz#857fcabfc3397d2625b8228262e86aa7a011b05d\"\n-  integrity sha1-hX/Kv8M5fSYluCKCYuhqp6ARsF0=\n-\n-mkdirp@0.5.1:\n-  version \"0.5.1\"\n-  resolved \"https://registry.yarnpkg.com/mkdirp/-/mkdirp-0.5.1.tgz#30057438eac6cf7f8c4767f38648d6697d75c903\"\n-  integrity sha1-MAV0OOrGz3+MR2fzhkjWaX11yQM=\n-  dependencies:\n-    minimist \"0.0.8\"\n+mitt@3.0.1:\n+  version \"3.0.1\"\n+  resolved \"https://registry.yarnpkg.com/mitt/-/mitt-3.0.1.tgz#ea36cf0cc30403601ae074c8f77b7092cdab36d1\"\n+  integrity sha512-vKivATfr97l2/QBCYAkXYDbrIWPM2IIKEl7YPhjCvKlG3kE2gm+uBo6nEXK3M5/Ffh/FLpKExzOQ3JJoJGFKBw==\n \n ms@2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/ms/-/ms-2.0.0.tgz#5608aeadfc00be6c2901df5f9861788de0d597c8\"\n   integrity sha1-VgiurfwAvmwpAd9fmGF4jeDVl8g=\n \n-ms@^2.1.1:\n+ms@2.1.2, ms@^2.1.1:\n   version \"2.1.2\"\n   resolved \"https://registry.yarnpkg.com/ms/-/ms-2.1.2.tgz#d09d1f357b443f493382a8eb3ccd183872ae6009\"\n   integrity sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w==\n@@ -577,6 +904,11 @@ negotiator@0.6.1:\n   resolved \"https://registry.yarnpkg.com/negotiator/-/negotiator-0.6.1.tgz#2b327184e8992101177b28563fb5e7102acd0ca9\"\n   integrity sha1-KzJxhOiZIQEXeyhWP7XnECrNDKk=\n \n+netmask@^2.0.2:\n+  version \"2.0.2\"\n+  resolved \"https://registry.yarnpkg.com/netmask/-/netmask-2.0.2.tgz#8b01a07644065d536383835823bc52004ebac5e7\"\n+  integrity sha512-dBpDMdxv9Irdq66304OLfEmQ9tbNRFnFTuZiLo+bD+r332bBmMJ8GBLXklIXXgxd3+v9+KUnZaUR5PJMa75Gsg==\n+\n node-version@^1.0.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/node-version/-/node-version-1.1.0.tgz#f437d7ba407e65e2c4eaef8887b1718ba523d4f0\"\n@@ -593,10 +925,10 @@ on-headers@~1.0.1:\n   resolved \"https://registry.yarnpkg.com/on-headers/-/on-headers-1.0.1.tgz#928f5d0f470d49342651ea6794b0857c100693f7\"\n   integrity sha1-ko9dD0cNSTQmUepnlLCFfBAGk/c=\n \n-once@^1.3.0:\n+once@^1.3.1, once@^1.4.0:\n   version \"1.4.0\"\n   resolved \"https://registry.yarnpkg.com/once/-/once-1.4.0.tgz#583b1aa775961d4b113ac17d9c50baef9dd76bd1\"\n-  integrity sha1-WDsap3WWHUsROsF9nFC6753Xa9E=\n+  integrity sha512-lNaJgI+2Q5URQBkccEKHTQOPaXdUxnZZElQTZY0MFUAuaEqe1E+Nyvgdz/aIyNi6Z9MzO5dv1H8n58/GELp3+w==\n   dependencies:\n     wrappy \"1\"\n \n@@ -606,25 +938,59 @@ onetime@^2.0.0:\n   dependencies:\n     mimic-fn \"^1.0.0\"\n \n+pac-proxy-agent@^7.0.1:\n+  version \"7.0.1\"\n+  resolved \"https://registry.yarnpkg.com/pac-proxy-agent/-/pac-proxy-agent-7.0.1.tgz#6b9ddc002ec3ff0ba5fdf4a8a21d363bcc612d75\"\n+  integrity sha512-ASV8yU4LLKBAjqIPMbrgtaKIvxQri/yh2OpI+S6hVa9JRkUI3Y3NPFbfngDtY7oFtSMD3w31Xns89mDa3Feo5A==\n+  dependencies:\n+    \"@tootallnate/quickjs-emscripten\" \"^0.23.0\"\n+    agent-base \"^7.0.2\"\n+    debug \"^4.3.4\"\n+    get-uri \"^6.0.1\"\n+    http-proxy-agent \"^7.0.0\"\n+    https-proxy-agent \"^7.0.2\"\n+    pac-resolver \"^7.0.0\"\n+    socks-proxy-agent \"^8.0.2\"\n+\n+pac-resolver@^7.0.0:\n+  version \"7.0.1\"\n+  resolved \"https://registry.yarnpkg.com/pac-resolver/-/pac-resolver-7.0.1.tgz#54675558ea368b64d210fd9c92a640b5f3b8abb6\"\n+  integrity sha512-5NPgf87AT2STgwa2ntRMr45jTKrYBGkVU36yT0ig/n/GMAa3oPqhZfIQ2kMEimReg0+t9kZViDVZ83qfVUlckg==\n+  dependencies:\n+    degenerator \"^5.0.0\"\n+    netmask \"^2.0.2\"\n+\n+parent-module@^1.0.0:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/parent-module/-/parent-module-1.0.1.tgz#691d2709e78c79fae3a156622452d00762caaaa2\"\n+  integrity sha512-GQ2EWRpQV8/o+Aw8YqtfZZPfNRWZYkbidE9k5rpl/hC3vtHHBfGm2Ifi6qWV+coDGkrUKZAxE3Lot5kcsRlh+g==\n+  dependencies:\n+    callsites \"^3.0.0\"\n+\n+parse-json@^5.2.0:\n+  version \"5.2.0\"\n+  resolved \"https://registry.yarnpkg.com/parse-json/-/parse-json-5.2.0.tgz#c76fc66dee54231c962b22bcc8a72cf2f99753cd\"\n+  integrity sha512-ayCKvm/phCGxOkYRSCM82iDwct8/EonSEgCSxWxD7ve6jHggsFl4fZVQBPRNgQoKiuV/odhFrGzQXZwbifC8Rg==\n+  dependencies:\n+    \"@babel/code-frame\" \"^7.0.0\"\n+    error-ex \"^1.3.1\"\n+    json-parse-even-better-errors \"^2.3.0\"\n+    lines-and-columns \"^1.1.6\"\n+\n parseurl@~1.3.1:\n   version \"1.3.2\"\n   resolved \"https://registry.yarnpkg.com/parseurl/-/parseurl-1.3.2.tgz#fc289d4ed8993119460c156253262cdc8de65bf3\"\n   integrity sha1-/CidTtiZMRlGDBViUyYs3I3mW/M=\n \n-path-is-absolute@^1.0.0:\n-  version \"1.0.1\"\n-  resolved \"https://registry.yarnpkg.com/path-is-absolute/-/path-is-absolute-1.0.1.tgz#174b9268735534ffbc7ace6bf53a5a9e1b5c5f5f\"\n-  integrity sha1-F0uSaHNVNP+8es5r9TpanhtcX18=\n-\n pend@~1.2.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/pend/-/pend-1.2.0.tgz#7a57eb550a6783f9115331fcf4663d5c8e007a50\"\n   integrity sha1-elfrVQpng/kRUzH89GY9XI4AelA=\n \n-process-nextick-args@~2.0.0:\n-  version \"2.0.0\"\n-  resolved \"https://registry.yarnpkg.com/process-nextick-args/-/process-nextick-args-2.0.0.tgz#a37d732f4271b4ab1ad070d35508e8290788ffaa\"\n-  integrity sha512-MtEC1TqN0EU5nephaJ4rAtThHtC86dNN9qCuEhtshvpVBkAW5ZO7BASN9REnF9eoXGcRub+pFuKEpOHE+HbEMw==\n+picocolors@^1.0.0:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/picocolors/-/picocolors-1.0.1.tgz#a8ad579b571952f0e5d25892de5445bcfe25aaa1\"\n+  integrity sha512-anP1Z8qwhkbmu7MFP5iTt+wQKXgwzf7zTyGlcdzabySa9vd0Xt392U0rVmz9poOaBj0uHJKyyo9/upk0HrEQew==\n \n progress-estimator@^0.2.1:\n   version \"0.2.1\"\n@@ -636,10 +1002,10 @@ progress-estimator@^0.2.1:\n     humanize-duration \"^3.15.3\"\n     log-update \"^2.3.0\"\n \n-progress@^2.0.1:\n-  version \"2.0.1\"\n-  resolved \"https://registry.yarnpkg.com/progress/-/progress-2.0.1.tgz#c9242169342b1c29d275889c95734621b1952e31\"\n-  integrity sha512-OE+a6vzqazc+K6LxJrX5UPyKFvGnL5CYmq2jFGNIBWHpc4QyE49/YOumcrpQFJpfejmvRtbJzgO1zPmMCqlbBg==\n+progress@2.0.3:\n+  version \"2.0.3\"\n+  resolved \"https://registry.yarnpkg.com/progress/-/progress-2.0.3.tgz#7e8cf8d8f5b8f239c1bc68beb4eb78567d572ef8\"\n+  integrity sha512-7PiHtLll5LdnKIMw100I+8xJXR5gW2QwWYkT6iJva0bXitZKa/XMrSbdmg3r2Xnaidz9Qumd0VPaMrZlF9V9sA==\n \n promise-polyfill@^6.0.1:\n   version \"6.0.2\"\n@@ -652,28 +1018,57 @@ prompt-promise@^1.0.3:\n     keypress \"~0.2.1\"\n     native-or-another \"~2.0.0\"\n \n-proxy-from-env@^1.0.0:\n-  version \"1.0.0\"\n-  resolved \"https://registry.yarnpkg.com/proxy-from-env/-/proxy-from-env-1.0.0.tgz#33c50398f70ea7eb96d21f7b817630a55791c7ee\"\n-  integrity sha1-M8UDmPcOp+uW0h97gXYwpVeRx+4=\n+proxy-agent@6.4.0:\n+  version \"6.4.0\"\n+  resolved \"https://registry.yarnpkg.com/proxy-agent/-/proxy-agent-6.4.0.tgz#b4e2dd51dee2b377748aef8d45604c2d7608652d\"\n+  integrity sha512-u0piLU+nCOHMgGjRbimiXmA9kM/L9EHh3zL81xCdp7m+Y2pHIsnmbdDoEDoAz5geaonNR6q6+yOPQs6n4T6sBQ==\n+  dependencies:\n+    agent-base \"^7.0.2\"\n+    debug \"^4.3.4\"\n+    http-proxy-agent \"^7.0.1\"\n+    https-proxy-agent \"^7.0.3\"\n+    lru-cache \"^7.14.1\"\n+    pac-proxy-agent \"^7.0.1\"\n+    proxy-from-env \"^1.1.0\"\n+    socks-proxy-agent \"^8.0.2\"\n+\n+proxy-from-env@^1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/proxy-from-env/-/proxy-from-env-1.1.0.tgz#e102f16ca355424865755d2c9e8ea4f24d58c3e2\"\n+  integrity sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==\n \n pseudomap@^1.0.2:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/pseudomap/-/pseudomap-1.0.2.tgz#f052a28da70e618917ef0a8ac34c1ae5a68286b3\"\n \n-puppeteer@^1.11.0:\n-  version \"1.11.0\"\n-  resolved \"https://registry.yarnpkg.com/puppeteer/-/puppeteer-1.11.0.tgz#63cdbe12b07275cd6e0b94bce41f3fcb20305770\"\n-  integrity sha512-iG4iMOHixc2EpzqRV+pv7o3GgmU2dNYEMkvKwSaQO/vMZURakwSOn/EYJ6OIRFYOque1qorzIBvrytPIQB3YzQ==\n+pump@^3.0.0:\n+  version \"3.0.0\"\n+  resolved \"https://registry.yarnpkg.com/pump/-/pump-3.0.0.tgz#b4a2116815bde2f4e1ea602354e8c75565107a64\"\n+  integrity sha512-LwZy+p3SFs1Pytd/jYct4wpv49HiYCqd9Rlc5ZVdk0V+8Yzv6jR5Blk3TRmPL1ft69TxP0IMZGJ+WPFU2BFhww==\n   dependencies:\n-    debug \"^4.1.0\"\n-    extract-zip \"^1.6.6\"\n-    https-proxy-agent \"^2.2.1\"\n-    mime \"^2.0.3\"\n-    progress \"^2.0.1\"\n-    proxy-from-env \"^1.0.0\"\n-    rimraf \"^2.6.1\"\n-    ws \"^6.1.0\"\n+    end-of-stream \"^1.1.0\"\n+    once \"^1.3.1\"\n+\n+puppeteer-core@22.11.2:\n+  version \"22.11.2\"\n+  resolved \"https://registry.yarnpkg.com/puppeteer-core/-/puppeteer-core-22.11.2.tgz#6c2eb1b17be075e2f6e8cf82061d67af6267ecf8\"\n+  integrity sha512-vQo+YDuePyvj+92Z9cdtxi/HalKf+k/R4tE80nGtQqJRNqU81eHaHkbVfnLszdaLlvwFF5tipnnSCzqWlEddtw==\n+  dependencies:\n+    \"@puppeteer/browsers\" \"2.2.3\"\n+    chromium-bidi \"0.5.23\"\n+    debug \"4.3.5\"\n+    devtools-protocol \"0.0.1299070\"\n+    ws \"8.17.1\"\n+\n+puppeteer@^22.6.4:\n+  version \"22.11.2\"\n+  resolved \"https://registry.yarnpkg.com/puppeteer/-/puppeteer-22.11.2.tgz#39cbcdbf1ae0505f60a49d697d8b23e1b0f371b1\"\n+  integrity sha512-8fjdQSgW0sq7471ftca24J7sXK+jXZ7OW7Gx+NEBFNyXrcTiBfukEI46gNq6hiMhbLEDT30NeylK/1ZoPdlKSA==\n+  dependencies:\n+    \"@puppeteer/browsers\" \"2.2.3\"\n+    cosmiconfig \"9.0.0\"\n+    devtools-protocol \"0.0.1299070\"\n+    puppeteer-core \"22.11.2\"\n \n pushstate-server@^3.0.1:\n   version \"3.0.1\"\n@@ -685,50 +1080,47 @@ pushstate-server@^3.0.1:\n     connect-static-file \"1.2.0\"\n     serve-static \"1.12.3\"\n \n+queue-tick@^1.0.1:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/queue-tick/-/queue-tick-1.0.1.tgz#f6f07ac82c1fd60f82e098b417a80e52f1f4c142\"\n+  integrity sha512-kJt5qhMxoszgU/62PLP1CJytzd2NKetjSRnyuj31fDd3Rlcz3fzlFdFLD1SItunPwyqEOkca6GbV612BWfaBag==\n+\n range-parser@~1.2.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/range-parser/-/range-parser-1.2.0.tgz#f49be6b487894ddc40dcc94a322f611092e00d5e\"\n   integrity sha1-9JvmtIeJTdxA3MlKMi9hEJLgDV4=\n \n-readable-stream@^2.2.2:\n-  version \"2.3.6\"\n-  resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-2.3.6.tgz#b11c27d88b8ff1fbe070643cf94b0c79ae1b0aaf\"\n-  integrity sha512-tQtKA9WIAhBF3+VLAseyMqZeBjW0AHJoxOtYqSUZNJxauErmLbVm2FW1y+J/YA9dUrAC39ITejlZWhVIwawkKw==\n-  dependencies:\n-    core-util-is \"~1.0.0\"\n-    inherits \"~2.0.3\"\n-    isarray \"~1.0.0\"\n-    process-nextick-args \"~2.0.0\"\n-    safe-buffer \"~5.1.1\"\n-    string_decoder \"~1.1.1\"\n-    util-deprecate \"~1.0.1\"\n-\n reduce-flatten@^1.0.1:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/reduce-flatten/-/reduce-flatten-1.0.1.tgz#258c78efd153ddf93cb561237f61184f3696e327\"\n \n+require-directory@^2.1.1:\n+  version \"2.1.1\"\n+  resolved \"https://registry.yarnpkg.com/require-directory/-/require-directory-2.1.1.tgz#8c64ad5fd30dab1c976e2344ffe7f792a6a6df42\"\n+  integrity sha512-fGxEI7+wsG9xrvdjsrlmL22OMTTiHRwAMroiEeMgq8gzoLC/PQr7RsRDSTLUg/bZAZtF+TVIkHc6/4RIKrui+Q==\n+\n+resolve-from@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/resolve-from/-/resolve-from-4.0.0.tgz#4abcd852ad32dd7baabfe9b40e00a36db5f392e6\"\n+  integrity sha512-pb/MYmXstAkysRFx8piNI1tGFNQIFA3vkE3Gq4EuA1dF6gHp/+vgZqsCGJapvy8N3Q+4o7FwvquPJcnZ7RYy4g==\n+\n restore-cursor@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/restore-cursor/-/restore-cursor-2.0.0.tgz#9f7ee287f82fd326d4fd162923d62129eee0dfaf\"\n   dependencies:\n     onetime \"^2.0.0\"\n     signal-exit \"^3.0.2\"\n \n-rimraf@^2.6.1:\n-  version \"2.6.2\"\n-  resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-2.6.2.tgz#2ed8150d24a16ea8651e6d6ef0f47c4158ce7a36\"\n-  integrity sha512-lreewLK/BlghmxtfH36YYVg1i8IAce4TI7oao75I1g245+6BctqTVQiBP3YUJ9C6DQOXJmkYR9X9fCLtCOJc5w==\n-  dependencies:\n-    glob \"^7.0.5\"\n-\n safe-buffer@5.1.1:\n   version \"5.1.1\"\n   resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.1.1.tgz#893312af69b2123def71f57889001671eeb2c853\"\n \n-safe-buffer@~5.1.0, safe-buffer@~5.1.1:\n-  version \"5.1.2\"\n-  resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.1.2.tgz#991ec69d296e0313747d59bdfd2b745c35f8828d\"\n-  integrity sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==\n+semver@7.6.0:\n+  version \"7.6.0\"\n+  resolved \"https://registry.yarnpkg.com/semver/-/semver-7.6.0.tgz#1a46a4db4bffcccd97b743b5005c8325f23d4e2d\"\n+  integrity sha512-EnwXhrlwXMk9gKu5/flx5sv/an57AkRplG3hTK68W7FRDN+k+OWBj65M7719OkA82XLBxrcX0KSHj+X5COhOVg==\n+  dependencies:\n+    lru-cache \"^6.0.0\"\n \n semver@^5.4.1:\n   version \"5.4.1\"\n@@ -791,6 +1183,38 @@ signal-exit@^3.0.2:\n   version \"3.0.2\"\n   resolved \"https://registry.yarnpkg.com/signal-exit/-/signal-exit-3.0.2.tgz#b5fdc08f1287ea1178628e415e25132b73646c6d\"\n \n+smart-buffer@^4.2.0:\n+  version \"4.2.0\"\n+  resolved \"https://registry.yarnpkg.com/smart-buffer/-/smart-buffer-4.2.0.tgz#6e1d71fa4f18c05f7d0ff216dd16a481d0e8d9ae\"\n+  integrity sha512-94hK0Hh8rPqQl2xXc3HsaBoOXKV20MToPkcXvwbISWLEs+64sBq5kFgn2kJDHb1Pry9yrP0dxrCI9RRci7RXKg==\n+\n+socks-proxy-agent@^8.0.2:\n+  version \"8.0.3\"\n+  resolved \"https://registry.yarnpkg.com/socks-proxy-agent/-/socks-proxy-agent-8.0.3.tgz#6b2da3d77364fde6292e810b496cb70440b9b89d\"\n+  integrity sha512-VNegTZKhuGq5vSD6XNKlbqWhyt/40CgoEw8XxD6dhnm8Jq9IEa3nIa4HwnM8XOqU0CdB0BwWVXusqiFXfHB3+A==\n+  dependencies:\n+    agent-base \"^7.1.1\"\n+    debug \"^4.3.4\"\n+    socks \"^2.7.1\"\n+\n+socks@^2.7.1:\n+  version \"2.8.3\"\n+  resolved \"https://registry.yarnpkg.com/socks/-/socks-2.8.3.tgz#1ebd0f09c52ba95a09750afe3f3f9f724a800cb5\"\n+  integrity sha512-l5x7VUUWbjVFbafGLxPWkYsHIhEvmF85tbIeFZWc8ZPtoMyybuEhL7Jye/ooC4/d48FgOjSJXgsF/AJPYCW8Zw==\n+  dependencies:\n+    ip-address \"^9.0.5\"\n+    smart-buffer \"^4.2.0\"\n+\n+source-map@~0.6.1:\n+  version \"0.6.1\"\n+  resolved \"https://registry.yarnpkg.com/source-map/-/source-map-0.6.1.tgz#74722af32e9614e9c287a8d0bbde48b5e2f1a263\"\n+  integrity sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==\n+\n+sprintf-js@^1.1.3:\n+  version \"1.1.3\"\n+  resolved \"https://registry.yarnpkg.com/sprintf-js/-/sprintf-js-1.1.3.tgz#4914b903a2f8b685d17fdf78a70e917e872e444a\"\n+  integrity sha512-Oo+0REFV59/rz3gfJNKQiBlwfHaSESl1pcGyABQsnnIfWOFt6JNj5gCog2U6MLZ//IGYD+nA8nI+mTShREReaA==\n+\n \"statuses@>= 1.4.0 < 2\":\n   version \"1.5.0\"\n   resolved \"https://registry.yarnpkg.com/statuses/-/statuses-1.5.0.tgz#161c7dac177659fd9811f43771fa99381478628c\"\n@@ -801,26 +1225,46 @@ statuses@~1.3.1:\n   resolved \"https://registry.yarnpkg.com/statuses/-/statuses-1.3.1.tgz#faf51b9eb74aaef3b3acf4ad5f61abf24cb7b93e\"\n   integrity sha1-+vUbnrdKrvOzrPStX2Gr8ky3uT4=\n \n+streamx@^2.15.0, streamx@^2.18.0:\n+  version \"2.18.0\"\n+  resolved \"https://registry.yarnpkg.com/streamx/-/streamx-2.18.0.tgz#5bc1a51eb412a667ebfdcd4e6cf6a6fc65721ac7\"\n+  integrity sha512-LLUC1TWdjVdn1weXGcSxyTR3T4+acB6tVGXT95y0nGbca4t4o/ng1wKAGTljm9VicuCVLvRlqFYXYy5GwgM7sQ==\n+  dependencies:\n+    fast-fifo \"^1.3.2\"\n+    queue-tick \"^1.0.1\"\n+    text-decoder \"^1.1.0\"\n+  optionalDependencies:\n+    bare-events \"^2.2.0\"\n+\n string-width@^2.1.1:\n   version \"2.1.1\"\n   resolved \"https://registry.yarnpkg.com/string-width/-/string-width-2.1.1.tgz#ab93f27a8dc13d28cac815c462143a6d9012ae9e\"\n   dependencies:\n     is-fullwidth-code-point \"^2.0.0\"\n     strip-ansi \"^4.0.0\"\n \n-string_decoder@~1.1.1:\n-  version \"1.1.1\"\n-  resolved \"https://registry.yarnpkg.com/string_decoder/-/string_decoder-1.1.1.tgz#9cf1611ba62685d7030ae9e4ba34149c3af03fc8\"\n-  integrity sha512-n/ShnvDi6FHbbVfviro+WojiFzv+s8MPMHBczVePfUpDJLwoLT0ht1l4YwBCbi8pJAveEEdnkHyPyTP/mzRfwg==\n+string-width@^4.1.0, string-width@^4.2.0, string-width@^4.2.3:\n+  version \"4.2.3\"\n+  resolved \"https://registry.yarnpkg.com/string-width/-/string-width-4.2.3.tgz#269c7117d27b05ad2e536830a8ec895ef9c6d010\"\n+  integrity sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==\n   dependencies:\n-    safe-buffer \"~5.1.0\"\n+    emoji-regex \"^8.0.0\"\n+    is-fullwidth-code-point \"^3.0.0\"\n+    strip-ansi \"^6.0.1\"\n \n strip-ansi@^4.0.0:\n   version \"4.0.0\"\n   resolved \"https://registry.yarnpkg.com/strip-ansi/-/strip-ansi-4.0.0.tgz#a8479022eb1ac368a871389b635262c505ee368f\"\n   dependencies:\n     ansi-regex \"^3.0.0\"\n \n+strip-ansi@^6.0.0, strip-ansi@^6.0.1:\n+  version \"6.0.1\"\n+  resolved \"https://registry.yarnpkg.com/strip-ansi/-/strip-ansi-6.0.1.tgz#9e26c63d30f53443e9489495b2105d37b67a85d9\"\n+  integrity sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==\n+  dependencies:\n+    ansi-regex \"^5.0.1\"\n+\n supports-color@^4.0.0:\n   version \"4.4.0\"\n   resolved \"https://registry.yarnpkg.com/supports-color/-/supports-color-4.4.0.tgz#883f7ddabc165142b2a61427f3352ded195d1a3e\"\n@@ -844,35 +1288,85 @@ table-layout@^0.4.1:\n     typical \"^2.6.1\"\n     wordwrapjs \"^3.0.0\"\n \n+tar-fs@3.0.5:\n+  version \"3.0.5\"\n+  resolved \"https://registry.yarnpkg.com/tar-fs/-/tar-fs-3.0.5.tgz#f954d77767e4e6edf973384e1eb95f8f81d64ed9\"\n+  integrity sha512-JOgGAmZyMgbqpLwct7ZV8VzkEB6pxXFBVErLtb+XCOqzc6w1xiWKI9GVd6bwk68EX7eJ4DWmfXVmq8K2ziZTGg==\n+  dependencies:\n+    pump \"^3.0.0\"\n+    tar-stream \"^3.1.5\"\n+  optionalDependencies:\n+    bare-fs \"^2.1.1\"\n+    bare-path \"^2.1.0\"\n+\n+tar-stream@^3.1.5:\n+  version \"3.1.7\"\n+  resolved \"https://registry.yarnpkg.com/tar-stream/-/tar-stream-3.1.7.tgz#24b3fb5eabada19fe7338ed6d26e5f7c482e792b\"\n+  integrity sha512-qJj60CXt7IU1Ffyc3NJMjh6EkuCFej46zUqJ4J7pqYlThyd9bO0XBTmcOIhSzZJVWfsLks0+nle/j538YAW9RQ==\n+  dependencies:\n+    b4a \"^1.6.4\"\n+    fast-fifo \"^1.2.0\"\n+    streamx \"^2.15.0\"\n+\n test-value@^2.1.0:\n   version \"2.1.0\"\n   resolved \"https://registry.yarnpkg.com/test-value/-/test-value-2.1.0.tgz#11da6ff670f3471a73b625ca4f3fdcf7bb748291\"\n   dependencies:\n     array-back \"^1.0.3\"\n     typical \"^2.6.0\"\n \n-typedarray@^0.0.6:\n-  version \"0.0.6\"\n-  resolved \"https://registry.yarnpkg.com/typedarray/-/typedarray-0.0.6.tgz#867ac74e3864187b1d3d47d996a78ec5c8830777\"\n-  integrity sha1-hnrHTjhkGHsdPUfZlqeOxciDB3c=\n+text-decoder@^1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/text-decoder/-/text-decoder-1.1.0.tgz#3379e728fcf4d3893ec1aea35e8c2cac215ef190\"\n+  integrity sha512-TmLJNj6UgX8xcUZo4UDStGQtDiTzF7BzWlzn9g7UWrjkpHr5uJTK1ld16wZ3LXb2vb6jH8qU89dW5whuMdXYdw==\n+  dependencies:\n+    b4a \"^1.6.4\"\n+\n+through@^2.3.8:\n+  version \"2.3.8\"\n+  resolved \"https://registry.yarnpkg.com/through/-/through-2.3.8.tgz#0dd4c9ffaabc357960b1b724115d7e0e86a2e1f5\"\n+  integrity sha512-w89qg7PI8wAdvX60bMDP+bFoD5Dvhm9oLheFp5O4a2QF0cSBGsBX4qZmadPMvVqlLJBBci+WqGGOAPvcDeNSVg==\n+\n+tslib@^2.0.1:\n+  version \"2.6.3\"\n+  resolved \"https://registry.yarnpkg.com/tslib/-/tslib-2.6.3.tgz#0438f810ad7a9edcde7a241c3d80db693c8cbfe0\"\n+  integrity sha512-xNvxJEOUiWPGhUuUdQgAJPKOOJfGnIyKySOc09XkKsgdUV/3E2zvwZYdejjmRgPCgcym1juLH3226yA7sEFJKQ==\n \n typical@^2.6.0, typical@^2.6.1:\n   version \"2.6.1\"\n   resolved \"https://registry.yarnpkg.com/typical/-/typical-2.6.1.tgz#5c080e5d661cbbe38259d2e70a3c7253e873881d\"\n \n+unbzip2-stream@1.4.3:\n+  version \"1.4.3\"\n+  resolved \"https://registry.yarnpkg.com/unbzip2-stream/-/unbzip2-stream-1.4.3.tgz#b0da04c4371311df771cdc215e87f2130991ace7\"\n+  integrity sha512-mlExGW4w71ebDJviH16lQLtZS32VKqsSfk80GCfUlwT/4/hNRFsoscrF/c++9xinkMzECL1uL9DDwXqFWkruPg==\n+  dependencies:\n+    buffer \"^5.2.1\"\n+    through \"^2.3.8\"\n+\n+undici-types@~5.26.4:\n+  version \"5.26.5\"\n+  resolved \"https://registry.yarnpkg.com/undici-types/-/undici-types-5.26.5.tgz#bcd539893d00b56e964fd2657a4866b221a65617\"\n+  integrity sha512-JlCMO+ehdEIKqlFxk6IfVoAUVmgz7cU7zD/h9XZ0qzeosSHmUJVOzSQvvYSYWXkFXC+IfLKSIffhv0sVZup6pA==\n+\n universalify@^0.1.0:\n   version \"0.1.1\"\n   resolved \"https://registry.yarnpkg.com/universalify/-/universalify-0.1.1.tgz#fa71badd4437af4c148841e3b3b165f9e9e590b7\"\n \n+universalify@^2.0.0:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/universalify/-/universalify-2.0.1.tgz#168efc2180964e6386d061e094df61afe239b18d\"\n+  integrity sha512-gptHNQghINnc/vTGIk0SOFGFNXw7JVrlRUtConJRlvaw6DuX0wO5Jeko9sWrMBhh+PsYAZ7oXAiOnf/UKogyiw==\n+\n unpipe@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/unpipe/-/unpipe-1.0.0.tgz#b2bf4ee8514aae6165b4817829d21b2ef49904ec\"\n   integrity sha1-sr9O6FFKrmFltIF4KdIbLvSZBOw=\n \n-util-deprecate@~1.0.1:\n-  version \"1.0.2\"\n-  resolved \"https://registry.yarnpkg.com/util-deprecate/-/util-deprecate-1.0.2.tgz#450d4dc9fa70de732762fbd2d4a28981419a0ccf\"\n-  integrity sha1-RQ1Nyfpw3nMnYvvS1KKJgUGaDM8=\n+urlpattern-polyfill@10.0.0:\n+  version \"10.0.0\"\n+  resolved \"https://registry.yarnpkg.com/urlpattern-polyfill/-/urlpattern-polyfill-10.0.0.tgz#f0a03a97bfb03cdf33553e5e79a2aadd22cac8ec\"\n+  integrity sha512-H/A06tKD7sS1O1X2SshBVeA5FLycRpjqiBeqGKmBwBDBy28EnRjORxTNe269KSSr5un5qyWi1iL61wLxpd+ZOg==\n \n utils-merge@1.0.0:\n   version \"1.0.0\"\n@@ -904,25 +1398,66 @@ wrap-ansi@^3.0.1:\n     string-width \"^2.1.1\"\n     strip-ansi \"^4.0.0\"\n \n+wrap-ansi@^7.0.0:\n+  version \"7.0.0\"\n+  resolved \"https://registry.yarnpkg.com/wrap-ansi/-/wrap-ansi-7.0.0.tgz#67e145cff510a6a6984bdf1152911d69d2eb9e43\"\n+  integrity sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==\n+  dependencies:\n+    ansi-styles \"^4.0.0\"\n+    string-width \"^4.1.0\"\n+    strip-ansi \"^6.0.0\"\n+\n wrappy@1:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/wrappy/-/wrappy-1.0.2.tgz#b5243d8f3ec1aa35f1364605bc0d1036e30ab69f\"\n   integrity sha1-tSQ9jz7BqjXxNkYFvA0QNuMKtp8=\n \n-ws@^6.1.0:\n-  version \"6.2.2\"\n-  resolved \"https://registry.yarnpkg.com/ws/-/ws-6.2.2.tgz#dd5cdbd57a9979916097652d78f1cc5faea0c32e\"\n-  integrity sha512-zmhltoSR8u1cnDsD43TX59mzoMZsLKqUweyYBAIvTngR3shc0W6aOZylZmq/7hqyVxPdi+5Ud2QInblgyE72fw==\n-  dependencies:\n-    async-limiter \"~1.0.0\"\n+ws@8.17.1:\n+  version \"8.17.1\"\n+  resolved \"https://registry.yarnpkg.com/ws/-/ws-8.17.1.tgz#9293da530bb548febc95371d90f9c878727d919b\"\n+  integrity sha512-6XQFvXTkbfUOZOKKILFG1PDK2NDQs4azKQl26T0YS5CxqWLgXajbPZ+h4gZekJyRqFU8pvnbAbbs/3TgRPy+GQ==\n+\n+y18n@^5.0.5:\n+  version \"5.0.8\"\n+  resolved \"https://registry.yarnpkg.com/y18n/-/y18n-5.0.8.tgz#7f4934d0f7ca8c56f95314939ddcd2dd91ce1d55\"\n+  integrity sha512-0pfFzegeDWJHJIAmTLRP2DwHjdF5s7jo9tuztdQxAhINCdvS+3nGINqPd00AphqJR/0LhANUS6/+7SCb98YOfA==\n \n yallist@^2.1.2:\n   version \"2.1.2\"\n   resolved \"https://registry.yarnpkg.com/yallist/-/yallist-2.1.2.tgz#1c11f9218f076089a47dd512f93c6699a6a81d52\"\n \n-yauzl@2.4.1:\n-  version \"2.4.1\"\n-  resolved \"https://registry.yarnpkg.com/yauzl/-/yauzl-2.4.1.tgz#9528f442dab1b2284e58b4379bb194e22e0c4005\"\n-  integrity sha1-lSj0QtqxsihOWLQ3m7GU4i4MQAU=\n-  dependencies:\n-    fd-slicer \"~1.0.1\"\n+yallist@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/yallist/-/yallist-4.0.0.tgz#9bb92790d9c0effec63be73519e11a35019a3a72\"\n+  integrity sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==\n+\n+yargs-parser@^21.1.1:\n+  version \"21.1.1\"\n+  resolved \"https://registry.yarnpkg.com/yargs-parser/-/yargs-parser-21.1.1.tgz#9096bceebf990d21bb31fa9516e0ede294a77d35\"\n+  integrity sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw==\n+\n+yargs@17.7.2:\n+  version \"17.7.2\"\n+  resolved \"https://registry.yarnpkg.com/yargs/-/yargs-17.7.2.tgz#991df39aca675a192b816e1e0363f9d75d2aa269\"\n+  integrity sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w==\n+  dependencies:\n+    cliui \"^8.0.1\"\n+    escalade \"^3.1.1\"\n+    get-caller-file \"^2.0.5\"\n+    require-directory \"^2.1.1\"\n+    string-width \"^4.2.3\"\n+    y18n \"^5.0.5\"\n+    yargs-parser \"^21.1.1\"\n+\n+yauzl@^2.10.0:\n+  version \"2.10.0\"\n+  resolved \"https://registry.yarnpkg.com/yauzl/-/yauzl-2.10.0.tgz#c7eb17c93e112cb1086fa6d8e51fb0667b79a5f9\"\n+  integrity sha512-p4a9I6X6nu6IhoGmBqAcbJy1mlC4j27vEPZX9F4L4/vZT3Lyq1VkFHw/V/PUcB9Buo+DG3iHkT0x3Qya58zc3g==\n+  dependencies:\n+    buffer-crc32 \"~0.2.3\"\n+    fd-slicer \"~1.1.0\"\n+\n+zod@3.23.8:\n+  version \"3.23.8\"\n+  resolved \"https://registry.yarnpkg.com/zod/-/zod-3.23.8.tgz#e37b957b5d52079769fb8097099b592f0ef4067d\"\n+  integrity sha512-XBx9AXhXktjUqnepgTiE5flcKIYWi/rme0Eaj+5Y0lftuGBq+jyRu/md4WnuxqgP1ubdpNCsYEYPxrzVHD8d6g=="
            },
            {
                "file": "packages/react-devtools-core/package.json",
                "git_diff": "@@ -26,7 +26,7 @@\n   },\n   \"dependencies\": {\n     \"shell-quote\": \"^1.6.1\",\n-    \"ws\": \"^7\"\n+    \"ws\": \"^7.5.10\"\n   },\n   \"devDependencies\": {\n     \"cross-env\": \"^3.1.4\","
            },
            {
                "file": "scripts/bench/package.json",
                "git_diff": "@@ -11,7 +11,7 @@\n     \"cli-table\": \"^0.3.1\",\n     \"http-server\": \"^0.10.0\",\n     \"http2\": \"^3.3.6\",\n-    \"lighthouse\": \"^9.5.0\",\n+    \"lighthouse\": \"^11.6.0\",\n     \"mime\": \"^1.3.6\",\n     \"minimist\": \"^1.2.3\",\n     \"ncp\": \"^2.0.0\","
            },
            {
                "file": "scripts/bench/yarn.lock",
                "git_diff": "@@ -2,6 +2,64 @@\n # yarn lockfile v1\n \n \n+\"@formatjs/ecma402-abstract@2.0.0\":\n+  version \"2.0.0\"\n+  resolved \"https://registry.yarnpkg.com/@formatjs/ecma402-abstract/-/ecma402-abstract-2.0.0.tgz#39197ab90b1c78b7342b129a56a7acdb8f512e17\"\n+  integrity sha512-rRqXOqdFmk7RYvj4khklyqzcfQl9vEL/usogncBHRZfZBDOwMGuSRNFl02fu5KGHXdbinju+YXyuR+Nk8xlr/g==\n+  dependencies:\n+    \"@formatjs/intl-localematcher\" \"0.5.4\"\n+    tslib \"^2.4.0\"\n+\n+\"@formatjs/fast-memoize@2.2.0\":\n+  version \"2.2.0\"\n+  resolved \"https://registry.yarnpkg.com/@formatjs/fast-memoize/-/fast-memoize-2.2.0.tgz#33bd616d2e486c3e8ef4e68c99648c196887802b\"\n+  integrity sha512-hnk/nY8FyrL5YxwP9e4r9dqeM6cAbo8PeU9UjyXojZMNvVad2Z06FAVHyR3Ecw6fza+0GH7vdJgiKIVXTMbSBA==\n+  dependencies:\n+    tslib \"^2.4.0\"\n+\n+\"@formatjs/icu-messageformat-parser@2.7.8\":\n+  version \"2.7.8\"\n+  resolved \"https://registry.yarnpkg.com/@formatjs/icu-messageformat-parser/-/icu-messageformat-parser-2.7.8.tgz#f6d7643001e9bb5930d812f1f9a9856f30fa0343\"\n+  integrity sha512-nBZJYmhpcSX0WeJ5SDYUkZ42AgR3xiyhNCsQweFx3cz/ULJjym8bHAzWKvG5e2+1XO98dBYC0fWeeAECAVSwLA==\n+  dependencies:\n+    \"@formatjs/ecma402-abstract\" \"2.0.0\"\n+    \"@formatjs/icu-skeleton-parser\" \"1.8.2\"\n+    tslib \"^2.4.0\"\n+\n+\"@formatjs/icu-skeleton-parser@1.8.2\":\n+  version \"1.8.2\"\n+  resolved \"https://registry.yarnpkg.com/@formatjs/icu-skeleton-parser/-/icu-skeleton-parser-1.8.2.tgz#2252c949ae84ee66930e726130ea66731a123c9f\"\n+  integrity sha512-k4ERKgw7aKGWJZgTarIcNEmvyTVD9FYh0mTrrBMHZ1b8hUu6iOJ4SzsZlo3UNAvHYa+PnvntIwRPt1/vy4nA9Q==\n+  dependencies:\n+    \"@formatjs/ecma402-abstract\" \"2.0.0\"\n+    tslib \"^2.4.0\"\n+\n+\"@formatjs/intl-localematcher@0.5.4\":\n+  version \"0.5.4\"\n+  resolved \"https://registry.yarnpkg.com/@formatjs/intl-localematcher/-/intl-localematcher-0.5.4.tgz#caa71f2e40d93e37d58be35cfffe57865f2b366f\"\n+  integrity sha512-zTwEpWOzZ2CiKcB93BLngUX59hQkuZjT2+SAQEscSm52peDW/getsawMcWF1rGRpMCX6D7nSJA3CzJ8gn13N/g==\n+  dependencies:\n+    tslib \"^2.4.0\"\n+\n+\"@paulirish/trace_engine@^0.0.19\":\n+  version \"0.0.19\"\n+  resolved \"https://registry.yarnpkg.com/@paulirish/trace_engine/-/trace_engine-0.0.19.tgz#794642d6b4947fc2a4b5724a57e3af61606029e2\"\n+  integrity sha512-3tjEzXBBtU83DkCJAdU2UwBBunspiwTCn+Y5jOxm592cfEuLr/T7Lcn+QhRerVqkSik2mnjN4X6NgHZjI9Biwg==\n+\n+\"@puppeteer/browsers@2.2.3\":\n+  version \"2.2.3\"\n+  resolved \"https://registry.yarnpkg.com/@puppeteer/browsers/-/browsers-2.2.3.tgz#ad6b79129c50825e77ddaba082680f4dad0b674e\"\n+  integrity sha512-bJ0UBsk0ESOs6RFcLXOt99a3yTDcOKlzfjad+rhFwdaG1Lu/Wzq58GHYCDTlZ9z6mldf4g+NTb+TXEfe0PpnsQ==\n+  dependencies:\n+    debug \"4.3.4\"\n+    extract-zip \"2.0.1\"\n+    progress \"2.0.3\"\n+    proxy-agent \"6.4.0\"\n+    semver \"7.6.0\"\n+    tar-fs \"3.0.5\"\n+    unbzip2-stream \"1.4.3\"\n+    yargs \"17.7.2\"\n+\n \"@sentry/core@6.19.7\":\n   version \"6.19.7\"\n   resolved \"https://registry.yarnpkg.com/@sentry/core/-/core-6.19.7.tgz#156aaa56dd7fad8c89c145be6ad7a4f7209f9785\"\n@@ -70,6 +128,11 @@\n   dependencies:\n     defer-to-connect \"^2.0.0\"\n \n+\"@tootallnate/quickjs-emscripten@^0.23.0\":\n+  version \"0.23.0\"\n+  resolved \"https://registry.yarnpkg.com/@tootallnate/quickjs-emscripten/-/quickjs-emscripten-0.23.0.tgz#db4ecfd499a9765ab24002c3b696d02e6d32a12c\"\n+  integrity sha512-C5Mc6rdnsaJDjO3UpGW/CQTHtCKaYlScZTly4JIu97Jxo/odCiH0ITnDXSJPTOrEKk/ycSZ0AOgTmkDtkOsvIA==\n+\n \"@types/cacheable-request@^6.0.1\":\n   version \"6.0.3\"\n   resolved \"https://registry.yarnpkg.com/@types/cacheable-request/-/cacheable-request-6.0.3.tgz#a430b3260466ca7b5ca5bfd735693b36e7a9d183\"\n@@ -122,6 +185,13 @@ agent-base@6:\n   dependencies:\n     debug \"4\"\n \n+agent-base@^7.0.2, agent-base@^7.1.0, agent-base@^7.1.1:\n+  version \"7.1.1\"\n+  resolved \"https://registry.yarnpkg.com/agent-base/-/agent-base-7.1.1.tgz#bdbded7dfb096b751a2a087eeeb9664725b2e317\"\n+  integrity sha512-H0TSyFNDMomMNJQBn8wFV5YC/2eJ+VXECwOadZJT554xP6cODZHPX3H9QMQECxvrgiSOP1pHjy1sMWQVYJOUOA==\n+  dependencies:\n+    debug \"^4.3.4\"\n+\n ajv@^6.12.3:\n   version \"6.12.6\"\n   resolved \"https://registry.yarnpkg.com/ajv/-/ajv-6.12.6.tgz#baf5a62e802b07d977034586f8c3baf5adf26df4\"\n@@ -178,6 +248,13 @@ assert-plus@1.0.0, assert-plus@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/assert-plus/-/assert-plus-1.0.0.tgz#f12e0f3c5d77b0b1cdd9146942e4e96c1e4dd525\"\n \n+ast-types@^0.13.4:\n+  version \"0.13.4\"\n+  resolved \"https://registry.yarnpkg.com/ast-types/-/ast-types-0.13.4.tgz#ee0d77b343263965ecc3fb62da16e7222b2b6782\"\n+  integrity sha512-x1FCFnFifvYDDzTaLII71vG5uvDwgtmDTEVWAxrgeiR8VjMONcCXJx7E+USjDtHlwFmt9MysbqgF9b9Vjr6w+w==\n+  dependencies:\n+    tslib \"^2.0.1\"\n+\n async@^1.5.2:\n   version \"1.5.2\"\n   resolved \"https://registry.yarnpkg.com/async/-/async-1.5.2.tgz#ec6a61ae56480c0c3cb241c95618e20892f9672a\"\n@@ -196,20 +273,63 @@ aws4@^1.8.0:\n   resolved \"https://registry.yarnpkg.com/aws4/-/aws4-1.13.0.tgz#d9b802e9bb9c248d7be5f7f5ef178dc3684e9dcc\"\n   integrity sha512-3AungXC4I8kKsS9PuS4JH2nc+0bVY/mjgrephHTIi8fpEeGsTHBUJeosp0Wc1myYMElmD0B3Oc4XL/HVJ4PV2g==\n \n-axe-core@4.4.1:\n-  version \"4.4.1\"\n-  resolved \"https://registry.yarnpkg.com/axe-core/-/axe-core-4.4.1.tgz#7dbdc25989298f9ad006645cd396782443757413\"\n-  integrity sha512-gd1kmb21kwNuWr6BQz8fv6GNECPBnUasepcoLbekws23NVBLODdsClRZ+bQ8+9Uomf3Sm3+Vwn0oYG9NvwnJCw==\n+axe-core@^4.9.0:\n+  version \"4.9.1\"\n+  resolved \"https://registry.yarnpkg.com/axe-core/-/axe-core-4.9.1.tgz#fcd0f4496dad09e0c899b44f6c4bb7848da912ae\"\n+  integrity sha512-QbUdXJVTpvUTHU7871ppZkdOLBeGUKBQWHkHrvN2V9IQWGMt61zf3B45BtzjxEJzYuj0JBjBZP/hmYS/R9pmAw==\n+\n+b4a@^1.6.4:\n+  version \"1.6.6\"\n+  resolved \"https://registry.yarnpkg.com/b4a/-/b4a-1.6.6.tgz#a4cc349a3851987c3c4ac2d7785c18744f6da9ba\"\n+  integrity sha512-5Tk1HLk6b6ctmjIkAcU/Ujv/1WqiDl0F0JdRCR80VsOcUlHcu7pWeWRlOqQLHfDEsVx9YH/aif5AG4ehoCtTmg==\n \n balanced-match@^1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/balanced-match/-/balanced-match-1.0.0.tgz#89b4d199ab2bee49de164ea02b89ce462d71b767\"\n \n+bare-events@^2.0.0, bare-events@^2.2.0:\n+  version \"2.4.2\"\n+  resolved \"https://registry.yarnpkg.com/bare-events/-/bare-events-2.4.2.tgz#3140cca7a0e11d49b3edc5041ab560659fd8e1f8\"\n+  integrity sha512-qMKFd2qG/36aA4GwvKq8MxnPgCQAmBWmSyLWsJcbn8v03wvIPQ/hG1Ms8bPzndZxMDoHpxez5VOS+gC9Yi24/Q==\n+\n+bare-fs@^2.1.1:\n+  version \"2.3.1\"\n+  resolved \"https://registry.yarnpkg.com/bare-fs/-/bare-fs-2.3.1.tgz#cdbd63dac7a552dfb2b87d18c822298d1efd213d\"\n+  integrity sha512-W/Hfxc/6VehXlsgFtbB5B4xFcsCl+pAh30cYhoFyXErf6oGrwjh8SwiPAdHgpmWonKuYpZgGywN0SXt7dgsADA==\n+  dependencies:\n+    bare-events \"^2.0.0\"\n+    bare-path \"^2.0.0\"\n+    bare-stream \"^2.0.0\"\n+\n+bare-os@^2.1.0:\n+  version \"2.4.0\"\n+  resolved \"https://registry.yarnpkg.com/bare-os/-/bare-os-2.4.0.tgz#5de5e3ba7704f459c9656629edca7cc736e06608\"\n+  integrity sha512-v8DTT08AS/G0F9xrhyLtepoo9EJBJ85FRSMbu1pQUlAf6A8T0tEEQGMVObWeqpjhSPXsE0VGlluFBJu2fdoTNg==\n+\n+bare-path@^2.0.0, bare-path@^2.1.0:\n+  version \"2.1.3\"\n+  resolved \"https://registry.yarnpkg.com/bare-path/-/bare-path-2.1.3.tgz#594104c829ef660e43b5589ec8daef7df6cedb3e\"\n+  integrity sha512-lh/eITfU8hrj9Ru5quUp0Io1kJWIk1bTjzo7JH1P5dWmQ2EL4hFUlfI8FonAhSlgIfhn63p84CDY/x+PisgcXA==\n+  dependencies:\n+    bare-os \"^2.1.0\"\n+\n+bare-stream@^2.0.0:\n+  version \"2.1.3\"\n+  resolved \"https://registry.yarnpkg.com/bare-stream/-/bare-stream-2.1.3.tgz#070b69919963a437cc9e20554ede079ce0a129b2\"\n+  integrity sha512-tiDAH9H/kP+tvNO5sczyn9ZAA7utrSMobyDchsnyyXBuUe2FSQWbxhtuHB8jwpHYYevVo2UJpcmvvjrbHboUUQ==\n+  dependencies:\n+    streamx \"^2.18.0\"\n+\n base64-js@^1.3.1:\n   version \"1.5.1\"\n   resolved \"https://registry.yarnpkg.com/base64-js/-/base64-js-1.5.1.tgz#1b1b440160a5bf7ad40b650f095963481903930a\"\n   integrity sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==\n \n+basic-ftp@^5.0.2:\n+  version \"5.0.5\"\n+  resolved \"https://registry.yarnpkg.com/basic-ftp/-/basic-ftp-5.0.5.tgz#14a474f5fffecca1f4f406f1c26b18f800225ac0\"\n+  integrity sha512-4Bcg1P8xhUuqcii/S0Z9wiHIrQVPMermM1any+MX5GeGD7faD3/msQUDGLol9wOcz4/jbg/WJnGqoJF6LiBdtg==\n+\n bcrypt-pbkdf@^1.0.0:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/bcrypt-pbkdf/-/bcrypt-pbkdf-1.0.1.tgz#63bc5dcb61331b92bc05fd528953c33462a06f8d\"\n@@ -224,15 +344,6 @@ bl@^1.0.0:\n     readable-stream \"^2.3.5\"\n     safe-buffer \"^5.1.1\"\n \n-bl@^4.0.3:\n-  version \"4.1.0\"\n-  resolved \"https://registry.yarnpkg.com/bl/-/bl-4.1.0.tgz#451535264182bec2fbbc83a62ab98cf11d9f7b3a\"\n-  integrity sha512-1W07cM9gS6DcLperZfFSj+bWLtaPGSOHWhPiGzXmvVJbRLdG82sH/Kn8EtW1VqWVA54AKf2h5k5BbnIbwF3h6w==\n-  dependencies:\n-    buffer \"^5.5.0\"\n-    inherits \"^2.0.4\"\n-    readable-stream \"^3.4.0\"\n-\n brace-expansion@^1.1.7:\n   version \"1.1.8\"\n   resolved \"https://registry.yarnpkg.com/brace-expansion/-/brace-expansion-1.1.8.tgz#c07b211c7c952ec1f8efd51a77ef0d1d3990a292\"\n@@ -270,7 +381,7 @@ buffer-fill@^1.0.0:\n   resolved \"https://registry.yarnpkg.com/buffer-fill/-/buffer-fill-1.0.0.tgz#f8f78b76789888ef39f205cd637f68e702122b2c\"\n   integrity sha512-T7zexNBwiiaCOGDg9xNX9PBmjrubblRkENuptryuI64URkXDFum9il/JGL8Lm8wYfAXpredVXXZz7eMHilimiQ==\n \n-buffer@^5.2.1, buffer@^5.5.0:\n+buffer@^5.2.1:\n   version \"5.7.1\"\n   resolved \"https://registry.yarnpkg.com/buffer/-/buffer-5.7.1.tgz#ba62e7c13133053582197160851a8f648e99eed0\"\n   integrity sha512-EHcyIPBQ4BSGlvjB16k5KgAJ27CIsHY/2JBmCRReo48y9rQ3MaUzWX3KVlBa4U7MyX02HdVj0K7C3WaB3ju7FQ==\n@@ -311,7 +422,7 @@ chalk@^2.1.0:\n     escape-string-regexp \"^1.0.5\"\n     supports-color \"^4.0.0\"\n \n-chownr@^1.0.1, chownr@^1.1.1, chownr@^1.1.4:\n+chownr@^1.0.1, chownr@^1.1.4:\n   version \"1.1.4\"\n   resolved \"https://registry.yarnpkg.com/chownr/-/chownr-1.1.4.tgz#6fc9d7b42d32a583596337666e7d08084da2cc6b\"\n   integrity sha512-jJ0bqzaylmJtVnNgzTeSOs8DPavpbYgEr/b0YL8/2GO3xJEhInFmhKMUnEJQjZumK7KXGFhUy89PrsJWlakBVg==\n@@ -328,15 +439,24 @@ chrome-launcher@^0.13.2:\n     mkdirp \"^0.5.3\"\n     rimraf \"^3.0.2\"\n \n-chrome-launcher@^0.15.0:\n-  version \"0.15.2\"\n-  resolved \"https://registry.yarnpkg.com/chrome-launcher/-/chrome-launcher-0.15.2.tgz#4e6404e32200095fdce7f6a1e1004f9bd36fa5da\"\n-  integrity sha512-zdLEwNo3aUVzIhKhTtXfxhdvZhUghrnmkvcAq2NoDd+LeOHKf03H5jwZ8T/STsAlzyALkBVK552iaG1fGf1xVQ==\n+chrome-launcher@^1.1.1:\n+  version \"1.1.2\"\n+  resolved \"https://registry.yarnpkg.com/chrome-launcher/-/chrome-launcher-1.1.2.tgz#52eff6b3fd7f24b65192b2624a108dadbcca4b9d\"\n+  integrity sha512-YclTJey34KUm5jB1aEJCq807bSievi7Nb/TU4Gu504fUYi3jw3KCIaH6L7nFWQhdEgH3V+wCh+kKD1P5cXnfxw==\n   dependencies:\n     \"@types/node\" \"*\"\n     escape-string-regexp \"^4.0.0\"\n     is-wsl \"^2.2.0\"\n-    lighthouse-logger \"^1.0.0\"\n+    lighthouse-logger \"^2.0.1\"\n+\n+chromium-bidi@0.5.24:\n+  version \"0.5.24\"\n+  resolved \"https://registry.yarnpkg.com/chromium-bidi/-/chromium-bidi-0.5.24.tgz#0fe672fa30b1e6bcc63ae818442b21c41849c435\"\n+  integrity sha512-5xQNN2SVBdZv4TxeMLaI+PelrnZsHDhn8h2JtyriLr+0qHcZS8BMuo93qN6J1VmtmrgYP+rmcLHcbpnA8QJh+w==\n+  dependencies:\n+    mitt \"3.0.1\"\n+    urlpattern-polyfill \"10.0.0\"\n+    zod \"3.23.8\"\n \n cli-table@^0.3.1:\n   version \"0.3.1\"\n@@ -430,13 +550,6 @@ corser@~2.0.0:\n   version \"2.0.1\"\n   resolved \"https://registry.yarnpkg.com/corser/-/corser-2.0.1.tgz#8eda252ecaab5840dcd975ceb90d9370c819ff87\"\n \n-cross-fetch@3.1.5:\n-  version \"3.1.5\"\n-  resolved \"https://registry.yarnpkg.com/cross-fetch/-/cross-fetch-3.1.5.tgz#e1389f44d9e7ba767907f7af8454787952ab534f\"\n-  integrity sha512-lvb1SBsI0Z7GDwmuid+mU3kWVBwTVUbe7S0H52yaaAdQOXq2YktTCZdlAcNKFzE6QtRz0snpw9bNiPeOIkkQvw==\n-  dependencies:\n-    node-fetch \"2.6.7\"\n-\n crypto-random-string@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/crypto-random-string/-/crypto-random-string-2.0.0.tgz#ef2a7a966ec11083388369baa02ebead229b30d5\"\n@@ -447,31 +560,31 @@ csp_evaluator@1.1.1:\n   resolved \"https://registry.yarnpkg.com/csp_evaluator/-/csp_evaluator-1.1.1.tgz#12b7bb0c6ae9053d30c86e8ddc52a1e920e6c0f7\"\n   integrity sha512-N3ASg0C4kNPUaNxt1XAvzHIVuzdtr8KLgfk1O8WDyimp1GisPAHESupArO2ieHk9QWbrJ/WkQODyh21Ps/xhxw==\n \n-cssom@0.3.x:\n-  version \"0.3.4\"\n-  resolved \"https://registry.yarnpkg.com/cssom/-/cssom-0.3.4.tgz#8cd52e8a3acfd68d3aed38ee0a640177d2f9d797\"\n-  integrity sha512-+7prCSORpXNeR4/fUP3rL+TzqtiFfhMvTd7uEqMdgPvLPt4+uzFUeufx5RHjGTACCargg/DiEt/moMQmvnfkog==\n-\n-cssstyle@1.2.1:\n-  version \"1.2.1\"\n-  resolved \"https://registry.yarnpkg.com/cssstyle/-/cssstyle-1.2.1.tgz#3aceb2759eaf514ac1a21628d723d6043a819495\"\n-  integrity sha512-7DYm8qe+gPx/h77QlCyFmX80+fGaE/6A/Ekl0zaszYOubvySO2saYFdQ78P29D0UsULxFKCetDGNaNRUdSF+2A==\n-  dependencies:\n-    cssom \"0.3.x\"\n-\n dashdash@^1.12.0:\n   version \"1.14.1\"\n   resolved \"https://registry.yarnpkg.com/dashdash/-/dashdash-1.14.1.tgz#853cfa0f7cbe2fed5de20326b8dd581035f6e2f0\"\n   dependencies:\n     assert-plus \"^1.0.0\"\n \n+data-uri-to-buffer@^6.0.2:\n+  version \"6.0.2\"\n+  resolved \"https://registry.yarnpkg.com/data-uri-to-buffer/-/data-uri-to-buffer-6.0.2.tgz#8a58bb67384b261a38ef18bea1810cb01badd28b\"\n+  integrity sha512-7hvf7/GW8e86rW0ptuwS3OcBGDjIi6SZva7hCyWC0yYry2cOPmLIjXAUHI6DK2HsnwJd9ifmt57i8eV2n4YNpw==\n+\n debug@4, debug@4.3.4, debug@^4.1.1:\n   version \"4.3.4\"\n   resolved \"https://registry.yarnpkg.com/debug/-/debug-4.3.4.tgz#1319f6579357f2338d3337d2cdd4914bb5dcc865\"\n   integrity sha512-PRWFHuSU3eDtQJPvnNY7Jcket1j0t5OuOsFzPPzsekD52Zl8qUfFIPEiswXqIvHWGVHOgX+7G/vCNNhehwxfkQ==\n   dependencies:\n     ms \"2.1.2\"\n \n+debug@4.3.5, debug@^4.3.4:\n+  version \"4.3.5\"\n+  resolved \"https://registry.yarnpkg.com/debug/-/debug-4.3.5.tgz#e83444eceb9fedd4a1da56d671ae2446a01a6e1e\"\n+  integrity sha512-pt0bNEmneDIvdL1Xsd9oDQ/wrQRkXDT4AUWlNZNPKvW5x/jyO9VFXkJUP07vQ2upmw5PlaITaPKc31jK13V+jg==\n+  dependencies:\n+    ms \"2.1.2\"\n+\n debug@^2.2.0:\n   version \"2.6.8\"\n   resolved \"https://registry.yarnpkg.com/debug/-/debug-2.6.8.tgz#e731531ca2ede27d188222427da17821d68ff4fc\"\n@@ -514,6 +627,15 @@ define-lazy-prop@^2.0.0:\n   resolved \"https://registry.yarnpkg.com/define-lazy-prop/-/define-lazy-prop-2.0.0.tgz#3f7ae421129bcaaac9bc74905c98a0009ec9ee7f\"\n   integrity sha512-Ds09qNh8yw3khSjiJjiUInaGX9xlqZDY7JVryGxdxV7NPeuqQfplOpQ66yJFZut3jLa5zOwkXw1g9EI2uKh4Og==\n \n+degenerator@^5.0.0:\n+  version \"5.0.1\"\n+  resolved \"https://registry.yarnpkg.com/degenerator/-/degenerator-5.0.1.tgz#9403bf297c6dad9a1ece409b37db27954f91f2f5\"\n+  integrity sha512-TllpMR/t0M5sqCXfj85i4XaAzxmS5tVA16dqvdkMwGmzI+dXLXnw3J+3Vdv7VKw+ThlTMboK6i9rnZ6Nntj5CQ==\n+  dependencies:\n+    ast-types \"^0.13.4\"\n+    escodegen \"^2.1.0\"\n+    esprima \"^4.0.1\"\n+\n delayed-stream@~1.0.0:\n   version \"1.0.0\"\n   resolved \"https://registry.yarnpkg.com/delayed-stream/-/delayed-stream-1.0.0.tgz#df3ae199acadfb7d440aaae0b29e2272b24ec619\"\n@@ -527,10 +649,15 @@ detect-libc@^1.0.2:\n   resolved \"https://registry.yarnpkg.com/detect-libc/-/detect-libc-1.0.3.tgz#fa137c4bd698edf55cd5cd02ac559f91a4c4ba9b\"\n   integrity sha512-pGjwhsmsp4kL2RTz08wcOlGN83otlqHeD/Z5T8GXZB+/YcpQ/dgo+lbU8ZsGxV0HIvqqxo9l7mqYwyYMD9bKDg==\n \n-devtools-protocol@0.0.981744:\n-  version \"0.0.981744\"\n-  resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.981744.tgz#9960da0370284577d46c28979a0b32651022bacf\"\n-  integrity sha512-0cuGS8+jhR67Fy7qG3i3Pc7Aw494sb9yG9QgpG97SFVWwolgYjlhJg7n+UaHxOQT30d1TYu/EYe9k01ivLErIg==\n+devtools-protocol@0.0.1232444:\n+  version \"0.0.1232444\"\n+  resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.1232444.tgz#406345a90a871ba852c530d73482275234936eed\"\n+  integrity sha512-pM27vqEfxSxRkTMnF+XCmxSEb6duO5R+t8A9DEEJgy4Wz2RVanje2mmj99B6A3zv2r/qGfYlOvYznUhuokizmg==\n+\n+devtools-protocol@0.0.1299070:\n+  version \"0.0.1299070\"\n+  resolved \"https://registry.yarnpkg.com/devtools-protocol/-/devtools-protocol-0.0.1299070.tgz#b3e4cf0b678a46f0f907ae6e07e03ad3a53c00df\"\n+  integrity sha512-+qtL3eX50qsJ7c+qVyagqi7AWMoQCBGNfoyJZMwm/NSXVqLYbuitrWEEIzxfUmTNy7//Xe8yhMmQ+elj3uAqSg==\n \n dot-prop@^5.2.0:\n   version \"5.3.0\"\n@@ -565,7 +692,7 @@ emoji-regex@^8.0.0:\n   resolved \"https://registry.yarnpkg.com/emoji-regex/-/emoji-regex-8.0.0.tgz#e818fd69ce5ccfcb404594f842963bf53164cc37\"\n   integrity sha512-MSjYzcWNOA0ewAHpz0MxpYFvwg6yjy1NG3xteoqz644VCo/RPgnr1/GGt+ic3iJTzQ8Eu3TdM14SawnVUmGE6A==\n \n-end-of-stream@^1.0.0, end-of-stream@^1.1.0, end-of-stream@^1.4.1:\n+end-of-stream@^1.0.0, end-of-stream@^1.1.0:\n   version \"1.4.4\"\n   resolved \"https://registry.yarnpkg.com/end-of-stream/-/end-of-stream-1.4.4.tgz#5ae64a5f45057baf3626ec14da0ca5e4b2431eb0\"\n   integrity sha512-+uw1inIHVPQoaVuHzRyXd21icM+cnt4CzD5rW+NC1wjOUSTOs+Te7FOv7AhN7vS9x/oIyhLP5PR1H+phQAHu5Q==\n@@ -594,6 +721,32 @@ escape-string-regexp@^4.0.0:\n   resolved \"https://registry.yarnpkg.com/escape-string-regexp/-/escape-string-regexp-4.0.0.tgz#14ba83a5d373e3d311e5afca29cf5bfad965bf34\"\n   integrity sha512-TtpcNJ3XAzx3Gq8sWRzJaVajRs0uVxA2YAkdb1jm2YkPz4G6egUFAyA3n5vtEIZefPk5Wa4UXbKuS5fKkJWdgA==\n \n+escodegen@^2.1.0:\n+  version \"2.1.0\"\n+  resolved \"https://registry.yarnpkg.com/escodegen/-/escodegen-2.1.0.tgz#ba93bbb7a43986d29d6041f99f5262da773e2e17\"\n+  integrity sha512-2NlIDTwUWJN0mRPQOdtQBzbUHvdGY2P1VXSyU83Q3xKxM7WHX2Ql8dKq782Q9TgQUNOLEzEYu9bzLNj1q88I5w==\n+  dependencies:\n+    esprima \"^4.0.1\"\n+    estraverse \"^5.2.0\"\n+    esutils \"^2.0.2\"\n+  optionalDependencies:\n+    source-map \"~0.6.1\"\n+\n+esprima@^4.0.1:\n+  version \"4.0.1\"\n+  resolved \"https://registry.yarnpkg.com/esprima/-/esprima-4.0.1.tgz#13b04cdb3e6c5d19df91ab6987a8695619b0aa71\"\n+  integrity sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==\n+\n+estraverse@^5.2.0:\n+  version \"5.3.0\"\n+  resolved \"https://registry.yarnpkg.com/estraverse/-/estraverse-5.3.0.tgz#2eea5290702f26ab8fe5370370ff86c965d21123\"\n+  integrity sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==\n+\n+esutils@^2.0.2:\n+  version \"2.0.3\"\n+  resolved \"https://registry.yarnpkg.com/esutils/-/esutils-2.0.3.tgz#74d2eb4de0b8da1293711910d50775b9b710ef64\"\n+  integrity sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==\n+\n eventemitter3@1.x.x:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/eventemitter3/-/eventemitter3-1.2.0.tgz#1c86991d816ad1e504750e73874224ecf3bec508\"\n@@ -623,6 +776,11 @@ fast-deep-equal@^3.1.1:\n   resolved \"https://registry.yarnpkg.com/fast-deep-equal/-/fast-deep-equal-3.1.3.tgz#3a7d56b559d6cbc3eb512325244e619a65c6c525\"\n   integrity sha512-f3qQ9oQy9j2AhBe/H9VC91wLmKBCCU/gDOnKNAYG5hswO7BLKj09Hc5HYNz9cGI++xlpDCIgDaitVs03ATR84Q==\n \n+fast-fifo@^1.2.0, fast-fifo@^1.3.2:\n+  version \"1.3.2\"\n+  resolved \"https://registry.yarnpkg.com/fast-fifo/-/fast-fifo-1.3.2.tgz#286e31de96eb96d38a97899815740ba2a4f3640c\"\n+  integrity sha512-/d9sfos4yxzpwkDkuN7k2SqFKtYNmCTzgfEpz82x34IM9/zc8KGxQoXg1liNC/izpRM/MBdt44Nmx41ZWqk+FQ==\n+\n fast-json-stable-stringify@^2.0.0:\n   version \"2.1.0\"\n   resolved \"https://registry.yarnpkg.com/fast-json-stable-stringify/-/fast-json-stable-stringify-2.1.0.tgz#874bf69c6f404c2b5d99c481341399fd55892633\"\n@@ -635,14 +793,6 @@ fd-slicer@~1.1.0:\n   dependencies:\n     pend \"~1.2.0\"\n \n-find-up@^4.0.0:\n-  version \"4.1.0\"\n-  resolved \"https://registry.yarnpkg.com/find-up/-/find-up-4.1.0.tgz#97afe7d6cdc0bc5928584b7c8d7b16e8a9aa5d19\"\n-  integrity sha512-PpOwAdQ/YlXQ2vj8a3h8IipDuYRi3wceVQQGYWxNINccq40Anw7BlsEXCMbt1Zt+OLA6Fq9suIpIWD0OsnISlw==\n-  dependencies:\n-    locate-path \"^5.0.0\"\n-    path-exists \"^4.0.0\"\n-\n forever-agent@~0.6.1:\n   version \"0.6.1\"\n   resolved \"https://registry.yarnpkg.com/forever-agent/-/forever-agent-0.6.1.tgz#fbc71f0c41adeb37f96c577ad1ed42d8fdacca91\"\n@@ -661,6 +811,15 @@ fs-constants@^1.0.0:\n   resolved \"https://registry.yarnpkg.com/fs-constants/-/fs-constants-1.0.0.tgz#6be0de9be998ce16af8afc24497b9ee9b7ccd9ad\"\n   integrity sha512-y6OAwoSIf7FyjMIv94u+b5rdheZEjzR63GTyZJm5qh4Bi+2YgwLCcI/fPFZkL5PSixOt6ZNKm+w+Hfp/Bciwow==\n \n+fs-extra@^11.2.0:\n+  version \"11.2.0\"\n+  resolved \"https://registry.yarnpkg.com/fs-extra/-/fs-extra-11.2.0.tgz#e70e17dfad64232287d01929399e0ea7c86b0e5b\"\n+  integrity sha512-PmDi3uwK5nFuXh7XDTlVnS17xJS7vW36is2+w3xcv8SVxiB4NyATf4ctkVY5bkSjX0Y4nbvZCq1/EjtEyr9ktw==\n+  dependencies:\n+    graceful-fs \"^4.2.0\"\n+    jsonfile \"^6.0.1\"\n+    universalify \"^2.0.0\"\n+\n fs-extra@^7.0.0:\n   version \"7.0.1\"\n   resolved \"https://registry.yarnpkg.com/fs-extra/-/fs-extra-7.0.1.tgz#4f189c44aa123b895f722804f55ea23eadc348e9\"\n@@ -706,6 +865,16 @@ get-stream@^5.0.0, get-stream@^5.1.0:\n   dependencies:\n     pump \"^3.0.0\"\n \n+get-uri@^6.0.1:\n+  version \"6.0.3\"\n+  resolved \"https://registry.yarnpkg.com/get-uri/-/get-uri-6.0.3.tgz#0d26697bc13cf91092e519aa63aa60ee5b6f385a\"\n+  integrity sha512-BzUrJBS9EcUb4cFol8r4W3v1cPsSyajLSthNkz5BxbpDcHN5tIrM10E2eNvfnvBn3DaT3DUgx0OpsBKkaOpanw==\n+  dependencies:\n+    basic-ftp \"^5.0.2\"\n+    data-uri-to-buffer \"^6.0.2\"\n+    debug \"^4.3.4\"\n+    fs-extra \"^11.2.0\"\n+\n getpass@^0.1.1:\n   version \"0.1.7\"\n   resolved \"https://registry.yarnpkg.com/getpass/-/getpass-0.1.7.tgz#5eff8e3e684d569ae4cb2b1282604e8ba62149fa\"\n@@ -770,6 +939,11 @@ graceful-fs@^4.1.2, graceful-fs@^4.1.6:\n   version \"4.1.11\"\n   resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.1.11.tgz#0e8bdfe4d1ddb8854d64e04ea7c00e2a026e5658\"\n \n+graceful-fs@^4.2.0:\n+  version \"4.2.11\"\n+  resolved \"https://registry.yarnpkg.com/graceful-fs/-/graceful-fs-4.2.11.tgz#4183e4e8bf08bb6e05bbb2f7d2e0c8f712ca40e3\"\n+  integrity sha512-RbJ5/jmFcNNCcDV5o9eTnBLJ/HszWV0P73bc+Ff4nS/rJj+YaS6IGyiOL0VoBYX+l1Wrl3k63h/KrH+nhJ0XvQ==\n+\n har-schema@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/har-schema/-/har-schema-2.0.0.tgz#a94c2224ebcac04782a0d9035521f24735b7ec92\"\n@@ -801,10 +975,18 @@ http-cache-semantics@^4.0.0:\n   resolved \"https://registry.yarnpkg.com/http-cache-semantics/-/http-cache-semantics-4.1.1.tgz#abe02fcb2985460bf0323be664436ec3476a6d5a\"\n   integrity sha512-er295DKPVsV82j5kw1Gjt+ADA/XYHsajl82cGNQG2eyoPkvgUhX+nDIyelzhIWbbsXP39EHcI6l5tYs2FYqYXQ==\n \n-http-link-header@^0.8.0:\n-  version \"0.8.0\"\n-  resolved \"https://registry.yarnpkg.com/http-link-header/-/http-link-header-0.8.0.tgz#a22b41a0c9b1e2d8fac1bf1b697c6bd532d5f5e4\"\n-  integrity sha1-oitBoMmx4tj6wb8baXxr1TLV9eQ=\n+http-link-header@^1.1.1:\n+  version \"1.1.3\"\n+  resolved \"https://registry.yarnpkg.com/http-link-header/-/http-link-header-1.1.3.tgz#b367b7a0ad1cf14027953f31aa1df40bb433da2a\"\n+  integrity sha512-3cZ0SRL8fb9MUlU3mKM61FcQvPfXx2dBrZW3Vbg5CXa8jFlK8OaEpePenLe1oEXQduhz8b0QjsqfS59QP4AJDQ==\n+\n+http-proxy-agent@^7.0.0, http-proxy-agent@^7.0.1:\n+  version \"7.0.2\"\n+  resolved \"https://registry.yarnpkg.com/http-proxy-agent/-/http-proxy-agent-7.0.2.tgz#9a8b1f246866c028509486585f62b8f2c18c270e\"\n+  integrity sha512-T1gkAiYYDWYx3V5Bmyu7HcfcvL7mUrTWiM6yOfa3PIphViJ/gFPbvidQ+veqSOHci/PxBcDabeUNCzpOODJZig==\n+  dependencies:\n+    agent-base \"^7.1.0\"\n+    debug \"^4.3.4\"\n \n http-proxy@^1.8.1:\n   version \"1.16.2\"\n@@ -839,14 +1021,22 @@ http2@^3.3.6:\n   version \"3.3.6\"\n   resolved \"https://registry.yarnpkg.com/http2/-/http2-3.3.6.tgz#7df06227e02b5b5a5841deea08239b3198d04bec\"\n \n-https-proxy-agent@5.0.1, https-proxy-agent@^5.0.0:\n+https-proxy-agent@^5.0.0:\n   version \"5.0.1\"\n   resolved \"https://registry.yarnpkg.com/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz#c59ef224a04fe8b754f3db0063a25ea30d0005d6\"\n   integrity sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==\n   dependencies:\n     agent-base \"6\"\n     debug \"4\"\n \n+https-proxy-agent@^7.0.2, https-proxy-agent@^7.0.3:\n+  version \"7.0.4\"\n+  resolved \"https://registry.yarnpkg.com/https-proxy-agent/-/https-proxy-agent-7.0.4.tgz#8e97b841a029ad8ddc8731f26595bad868cb4168\"\n+  integrity sha512-wlwpilI7YdjSkWaQ/7omYBMTliDcmCN8OLihO6I9B86g06lMyAoqgoDpV0XqoaPOKj+0DIdAvnsWfyAAhmimcg==\n+  dependencies:\n+    agent-base \"^7.0.2\"\n+    debug \"4\"\n+\n iconv-lite@^0.4.4:\n   version \"0.4.24\"\n   resolved \"https://registry.yarnpkg.com/iconv-lite/-/iconv-lite-0.4.24.tgz#2022b4b25fbddc21d2f524974a474aafe733908b\"\n@@ -885,26 +1075,27 @@ inherits@2, inherits@~2.0.3:\n   version \"2.0.3\"\n   resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.3.tgz#633c2c83e3da42a502f52466022480f4208261de\"\n \n-inherits@^2.0.3, inherits@^2.0.4:\n-  version \"2.0.4\"\n-  resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.4.tgz#0fa2c64f932917c3433a0ded55363aae37416b7c\"\n-  integrity sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==\n-\n ini@~1.3.0:\n   version \"1.3.4\"\n   resolved \"https://registry.yarnpkg.com/ini/-/ini-1.3.4.tgz#0537cb79daf59b59a1a517dff706c86ec039162e\"\n \n-intl-messageformat-parser@^1.8.1:\n-  version \"1.8.1\"\n-  resolved \"https://registry.yarnpkg.com/intl-messageformat-parser/-/intl-messageformat-parser-1.8.1.tgz#0eb14c5618333be4c95c409457b66c8c33ddcc01\"\n-  integrity sha512-IMSCKVf0USrM/959vj3xac7s8f87sc+80Y/ipBzdKy4ifBv5Gsj2tZ41EAaURVg01QU71fYr77uA8Meh6kELbg==\n+intl-messageformat@^10.5.3:\n+  version \"10.5.14\"\n+  resolved \"https://registry.yarnpkg.com/intl-messageformat/-/intl-messageformat-10.5.14.tgz#e5bb373f8a37b88fbe647d7b941f3ab2a37ed00a\"\n+  integrity sha512-IjC6sI0X7YRjjyVH9aUgdftcmZK7WXdHeil4KwbjDnRWjnVitKpAx3rr6t6di1joFp5188VqKcobOPA6mCLG/w==\n+  dependencies:\n+    \"@formatjs/ecma402-abstract\" \"2.0.0\"\n+    \"@formatjs/fast-memoize\" \"2.2.0\"\n+    \"@formatjs/icu-messageformat-parser\" \"2.7.8\"\n+    tslib \"^2.4.0\"\n \n-intl-messageformat@^4.4.0:\n-  version \"4.4.0\"\n-  resolved \"https://registry.yarnpkg.com/intl-messageformat/-/intl-messageformat-4.4.0.tgz#aa196a4d04b573f4090bc417f982d81de4f74fad\"\n-  integrity sha512-z+Bj2rS3LZSYU4+sNitdHrwnBhr0wO80ZJSW8EzKDBowwUe3Q/UsvgCGjrwa+HPzoGCLEb9HAjfJgo4j2Sac8w==\n+ip-address@^9.0.5:\n+  version \"9.0.5\"\n+  resolved \"https://registry.yarnpkg.com/ip-address/-/ip-address-9.0.5.tgz#117a960819b08780c3bd1f14ef3c1cc1d3f3ea5a\"\n+  integrity sha512-zHtQzGojZXTwZTHQqra+ETKd4Sn3vgi7uBmlPoXVWZqYvuKmtI0l/VZTjqGmJY9x88GGOaZ9+G9ES8hC4T4X8g==\n   dependencies:\n-    intl-messageformat-parser \"^1.8.1\"\n+    jsbn \"1.1.0\"\n+    sprintf-js \"^1.1.3\"\n \n is-docker@^2.0.0, is-docker@^2.1.1:\n   version \"2.2.1\"\n@@ -950,16 +1141,21 @@ isstream@~0.1.2:\n   version \"0.1.2\"\n   resolved \"https://registry.yarnpkg.com/isstream/-/isstream-0.1.2.tgz#47e63f7af55afa6f92e1500e690eb8b8529c099a\"\n \n-jpeg-js@^0.4.1, jpeg-js@^0.4.3:\n+jpeg-js@^0.4.1, jpeg-js@^0.4.4:\n   version \"0.4.4\"\n   resolved \"https://registry.yarnpkg.com/jpeg-js/-/jpeg-js-0.4.4.tgz#a9f1c6f1f9f0fa80cdb3484ed9635054d28936aa\"\n   integrity sha512-WZzeDOEtTOBK4Mdsar0IqEU5sMr3vSV2RqkAIzUEV2BHnUfKGyswWFPFwK5EeDo93K3FohSHbLAjj0s1Wzd+dg==\n \n-js-library-detector@^6.5.0:\n+js-library-detector@^6.7.0:\n   version \"6.7.0\"\n   resolved \"https://registry.yarnpkg.com/js-library-detector/-/js-library-detector-6.7.0.tgz#5075c71fcf835b71133bca13363b91509a39235a\"\n   integrity sha512-c80Qupofp43y4cJ7+8TTDN/AsDwLi5oOm/plBrWI+iQt485vKXCco+yVmOwEgdo9VOdsYTuV0UlTeetVPTriXA==\n \n+jsbn@1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/jsbn/-/jsbn-1.1.0.tgz#b01307cb29b618a1ed26ec79e911f803c4da0040\"\n+  integrity sha512-4bYVV3aAMtDTTu4+xsDYa6sy9GyJ69/amsu9sYF2zqjiEoZA5xJi3BrfX3uY+/IekIu7MwdObdbDWpoZdBv3/A==\n+\n jsbn@~0.1.0:\n   version \"0.1.1\"\n   resolved \"https://registry.yarnpkg.com/jsbn/-/jsbn-0.1.1.tgz#a5e654c2e5a2deb5f201d96cefbca80c0ef2f513\"\n@@ -994,6 +1190,15 @@ jsonfile@^4.0.0:\n   optionalDependencies:\n     graceful-fs \"^4.1.6\"\n \n+jsonfile@^6.0.1:\n+  version \"6.1.0\"\n+  resolved \"https://registry.yarnpkg.com/jsonfile/-/jsonfile-6.1.0.tgz#bc55b2634793c679ec6403094eb13698a6ec0aae\"\n+  integrity sha512-5dgndWOriYSm5cnYaJNhalLNDKOqFwyDB/rr1E9ZsGciGvKPs8R2xYGCacuf3z6K1YKDz182fd+fY3cn3pMqXQ==\n+  dependencies:\n+    universalify \"^2.0.0\"\n+  optionalDependencies:\n+    graceful-fs \"^4.1.6\"\n+\n jsprim@^1.2.2:\n   version \"1.4.1\"\n   resolved \"https://registry.yarnpkg.com/jsprim/-/jsprim-1.4.1.tgz#313e66bc1e5cc06e438bc1b7499c2e5c56acb6a2\"\n@@ -1018,59 +1223,54 @@ lighthouse-logger@^1.0.0:\n     debug \"^2.6.8\"\n     marky \"^1.2.0\"\n \n-lighthouse-logger@^1.3.0:\n-  version \"1.4.2\"\n-  resolved \"https://registry.yarnpkg.com/lighthouse-logger/-/lighthouse-logger-1.4.2.tgz#aef90f9e97cd81db367c7634292ee22079280aaa\"\n-  integrity sha512-gPWxznF6TKmUHrOQjlVo2UbaL2EJ71mb2CCeRs/2qBpi4L/g4LUVc9+3lKQ6DTUZwJswfM7ainGrLO1+fOqa2g==\n+lighthouse-logger@^2.0.1:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/lighthouse-logger/-/lighthouse-logger-2.0.1.tgz#48895f639b61cca89346bb6f47f7403a3895fa02\"\n+  integrity sha512-ioBrW3s2i97noEmnXxmUq7cjIcVRjT5HBpAYy8zE11CxU9HqlWHHeRxfeN1tn8F7OEMVPIC9x1f8t3Z7US9ehQ==\n   dependencies:\n     debug \"^2.6.9\"\n     marky \"^1.2.2\"\n \n-lighthouse-stack-packs@1.8.2:\n-  version \"1.8.2\"\n-  resolved \"https://registry.yarnpkg.com/lighthouse-stack-packs/-/lighthouse-stack-packs-1.8.2.tgz#55111bebe50ed516de3fad0a474795a2556ac36e\"\n-  integrity sha512-vlCUxxQAB8Nu6LQHqPpDRiMi06Du593/my/6JbMttQeEfJ7pf4OS8obSTh5xSOS80U/O7fq59Q8rQGAUxQatUQ==\n+lighthouse-stack-packs@1.12.1:\n+  version \"1.12.1\"\n+  resolved \"https://registry.yarnpkg.com/lighthouse-stack-packs/-/lighthouse-stack-packs-1.12.1.tgz#1dbebf795d50e6a96454ece7754bd4aa5be546ae\"\n+  integrity sha512-i4jTmg7tvZQFwNFiwB+nCK6a7ICR68Xcwo+VIVd6Spi71vBNFUlds5HiDrSbClZdkQDON2Bhqv+KKJIo5zkPeA==\n \n-lighthouse@^9.5.0:\n-  version \"9.6.8\"\n-  resolved \"https://registry.yarnpkg.com/lighthouse/-/lighthouse-9.6.8.tgz#7ec52f37070b557f8dc57cf4f0c68536fdf5205b\"\n-  integrity sha512-5aRSvnqazci8D2oE7GJM6C7IStvUuMVV+74cGyBuS4n4NCixsDd6+uJdX834XiInSfo+OuVbAJCX4Xu6d2+N9Q==\n+lighthouse@^11.6.0:\n+  version \"11.7.1\"\n+  resolved \"https://registry.yarnpkg.com/lighthouse/-/lighthouse-11.7.1.tgz#468ec7e3114ff319ae67a7f298fa20744a3627b6\"\n+  integrity sha512-QuvkZvobZ8Gjv2Jkxl6TKhV5JYBzU+lzpqTY+Y1iH5IUc1SMYK4IOpBnSpp6PkM2FbNyur9uoNutPhsuLLqGTg==\n   dependencies:\n+    \"@paulirish/trace_engine\" \"^0.0.19\"\n     \"@sentry/node\" \"^6.17.4\"\n-    axe-core \"4.4.1\"\n-    chrome-launcher \"^0.15.0\"\n+    axe-core \"^4.9.0\"\n+    chrome-launcher \"^1.1.1\"\n     configstore \"^5.0.1\"\n     csp_evaluator \"1.1.1\"\n-    cssstyle \"1.2.1\"\n+    devtools-protocol \"0.0.1232444\"\n     enquirer \"^2.3.6\"\n-    http-link-header \"^0.8.0\"\n-    intl-messageformat \"^4.4.0\"\n-    jpeg-js \"^0.4.3\"\n-    js-library-detector \"^6.5.0\"\n-    lighthouse-logger \"^1.3.0\"\n-    lighthouse-stack-packs \"1.8.2\"\n+    http-link-header \"^1.1.1\"\n+    intl-messageformat \"^10.5.3\"\n+    jpeg-js \"^0.4.4\"\n+    js-library-detector \"^6.7.0\"\n+    lighthouse-logger \"^2.0.1\"\n+    lighthouse-stack-packs \"1.12.1\"\n     lodash \"^4.17.21\"\n     lookup-closest-locale \"6.2.0\"\n-    metaviewport-parser \"0.2.0\"\n+    metaviewport-parser \"0.3.0\"\n     open \"^8.4.0\"\n     parse-cache-control \"1.0.1\"\n     ps-list \"^8.0.0\"\n-    puppeteer-core \"^13.7.0\"\n-    robots-parser \"^3.0.0\"\n+    puppeteer-core \"^22.5.0\"\n+    robots-parser \"^3.0.1\"\n     semver \"^5.3.0\"\n     speedline-core \"^1.4.3\"\n-    third-party-web \"^0.17.1\"\n+    third-party-web \"^0.24.1\"\n+    tldts-icann \"^6.1.0\"\n     ws \"^7.0.0\"\n     yargs \"^17.3.1\"\n     yargs-parser \"^21.0.0\"\n \n-locate-path@^5.0.0:\n-  version \"5.0.0\"\n-  resolved \"https://registry.yarnpkg.com/locate-path/-/locate-path-5.0.0.tgz#1afba396afd676a6d42504d0a67a3a7eb9f62aa0\"\n-  integrity sha512-t7hw9pI+WvuwNJXwk5zVHpyhIqzg2qTlklJOf0mVxGSbe3Fp2VieZcduNYjaLDoy6p9uGpQEGWG87WpMKlNq8g==\n-  dependencies:\n-    p-locate \"^4.1.0\"\n-\n lodash@^4.17.14, lodash@^4.17.21:\n   version \"4.17.21\"\n   resolved \"https://registry.yarnpkg.com/lodash/-/lodash-4.17.21.tgz#679591c564c3bffaae8454cf0b3df370c3d6911c\"\n@@ -1091,6 +1291,18 @@ lru-cache@^10.2.0:\n   resolved \"https://registry.yarnpkg.com/lru-cache/-/lru-cache-10.2.2.tgz#48206bc114c1252940c41b25b41af5b545aca878\"\n   integrity sha512-9hp3Vp2/hFQUiIwKo8XCeFVnrg8Pk3TYNPIR7tJADKi5YfcF7vEaK7avFHTlSy3kOKYaJQaalfEo6YuXdceBOQ==\n \n+lru-cache@^6.0.0:\n+  version \"6.0.0\"\n+  resolved \"https://registry.yarnpkg.com/lru-cache/-/lru-cache-6.0.0.tgz#6d6fe6570ebd96aaf90fcad1dafa3b2566db3a94\"\n+  integrity sha512-Jo6dJ04CmSjuznwJSS3pUeWmd/H0ffTlkXXgwZi+eq1UCmqQwCh+eLsYOYCwY991i2Fah4h1BEMCx4qThGbsiA==\n+  dependencies:\n+    yallist \"^4.0.0\"\n+\n+lru-cache@^7.14.1:\n+  version \"7.18.3\"\n+  resolved \"https://registry.yarnpkg.com/lru-cache/-/lru-cache-7.18.3.tgz#f793896e0fd0e954a59dfdd82f0773808df6aa89\"\n+  integrity sha512-jumlc0BIUrS3qJGgIkWZsyfAM7NCWiBcCDhnd+3NNM5KbBmLTgHVfWBcg6W+rLUsIpzpERPsvwUP7CckAQSOoA==\n+\n lru_map@^0.3.3:\n   version \"0.3.3\"\n   resolved \"https://registry.yarnpkg.com/lru_map/-/lru_map-0.3.3.tgz#b5c8351b9464cbd750335a79650a0ec0e56118dd\"\n@@ -1113,10 +1325,10 @@ marky@^1.2.2:\n   resolved \"https://registry.yarnpkg.com/marky/-/marky-1.2.5.tgz#55796b688cbd72390d2d399eaaf1832c9413e3c0\"\n   integrity sha512-q9JtQJKjpsVxCRVgQ+WapguSbKC3SQ5HEzFGPAJMStgh3QjCawp00UKv3MTTAArTmGmmPUvllHZoNbZ3gs0I+Q==\n \n-metaviewport-parser@0.2.0:\n-  version \"0.2.0\"\n-  resolved \"https://registry.yarnpkg.com/metaviewport-parser/-/metaviewport-parser-0.2.0.tgz#535c3ce1ccf6223a5025fddc6a1c36505f7e7db1\"\n-  integrity sha1-U1w84cz2IjpQJf3cahw2UF9+fbE=\n+metaviewport-parser@0.3.0:\n+  version \"0.3.0\"\n+  resolved \"https://registry.yarnpkg.com/metaviewport-parser/-/metaviewport-parser-0.3.0.tgz#6af1e99b5eaf250c049e0af1e84143a39750dea6\"\n+  integrity sha512-EoYJ8xfjQ6kpe9VbVHvZTZHiOl4HL1Z18CrZ+qahvLXT7ZO4YTC2JMyt5FaUp9JJp6J4Ybb/z7IsCXZt86/QkQ==\n \n mime-db@1.52.0:\n   version \"1.52.0\"\n@@ -1218,10 +1430,10 @@ minizlib@^1.3.3:\n   dependencies:\n     minipass \"^2.9.0\"\n \n-mkdirp-classic@^0.5.2:\n-  version \"0.5.3\"\n-  resolved \"https://registry.yarnpkg.com/mkdirp-classic/-/mkdirp-classic-0.5.3.tgz#fa10c9115cc6d8865be221ba47ee9bed78601113\"\n-  integrity sha512-gKLcREMhtuZRwRAfqP3RFW+TK4JqApVBtOIftVgjuABpAtpxhPGaDcfvbhNvD0B8iD1oUr/txX35NjcaY6Ns/A==\n+mitt@3.0.1:\n+  version \"3.0.1\"\n+  resolved \"https://registry.yarnpkg.com/mitt/-/mitt-3.0.1.tgz#ea36cf0cc30403601ae074c8f77b7092cdab36d1\"\n+  integrity sha512-vKivATfr97l2/QBCYAkXYDbrIWPM2IIKEl7YPhjCvKlG3kE2gm+uBo6nEXK3M5/Ffh/FLpKExzOQ3JJoJGFKBw==\n \n mkdirp@0.5.x, mkdirp@^0.5.0, mkdirp@^0.5.1:\n   version \"0.5.1\"\n@@ -1268,12 +1480,10 @@ needle@^2.2.1:\n     iconv-lite \"^0.4.4\"\n     sax \"^1.2.4\"\n \n-node-fetch@2.6.7:\n-  version \"2.6.7\"\n-  resolved \"https://registry.yarnpkg.com/node-fetch/-/node-fetch-2.6.7.tgz#24de9fba827e3b4ae44dc8b20256a379160052ad\"\n-  integrity sha512-ZjMPFEfVx5j+y2yF35Kzx5sF7kDzxuDj6ziH4FFbOp87zKDZNx8yExJIb05OGF4Nlt9IHFIMBkRl41VdvcNdbQ==\n-  dependencies:\n-    whatwg-url \"^5.0.0\"\n+netmask@^2.0.2:\n+  version \"2.0.2\"\n+  resolved \"https://registry.yarnpkg.com/netmask/-/netmask-2.0.2.tgz#8b01a07644065d536383835823bc52004ebac5e7\"\n+  integrity sha512-dBpDMdxv9Irdq66304OLfEmQ9tbNRFnFTuZiLo+bD+r332bBmMJ8GBLXklIXXgxd3+v9+KUnZaUR5PJMa75Gsg==\n \n node-gyp@^4.0.0:\n   version \"4.0.0\"\n@@ -1442,42 +1652,40 @@ p-finally@^1.0.0:\n   resolved \"https://registry.yarnpkg.com/p-finally/-/p-finally-1.0.0.tgz#3fbcfb15b899a44123b34b6dcc18b724336a2cae\"\n   integrity sha512-LICb2p9CB7FS+0eR1oqWnHhp0FljGLZCWBE9aix0Uye9W8LTQPwMTYVGWQWIw9RdQiDg4+epXQODwIYJtSJaow==\n \n-p-limit@^2.2.0:\n-  version \"2.3.0\"\n-  resolved \"https://registry.yarnpkg.com/p-limit/-/p-limit-2.3.0.tgz#3dd33c647a214fdfffd835933eb086da0dc21db1\"\n-  integrity sha512-//88mFWSJx8lxCzwdAABTJL2MyWB12+eIY7MDL2SqLmAkeKU9qxRvWuSyTjm3FUmpBEMuFfckAIqEaVGUDxb6w==\n-  dependencies:\n-    p-try \"^2.0.0\"\n-\n-p-locate@^4.1.0:\n-  version \"4.1.0\"\n-  resolved \"https://registry.yarnpkg.com/p-locate/-/p-locate-4.1.0.tgz#a3428bb7088b3a60292f66919278b7c297ad4f07\"\n-  integrity sha512-R79ZZ/0wAxKGu3oYMlz8jy/kbhsNrS7SKZ7PxEHBgJ5+F2mtFW2fK2cOtBh1cHYkQsbzFV7I+EoRKe6Yt0oK7A==\n-  dependencies:\n-    p-limit \"^2.2.0\"\n-\n p-timeout@^3.1.0:\n   version \"3.2.0\"\n   resolved \"https://registry.yarnpkg.com/p-timeout/-/p-timeout-3.2.0.tgz#c7e17abc971d2a7962ef83626b35d635acf23dfe\"\n   integrity sha512-rhIwUycgwwKcP9yTOOFK/AKsAopjjCakVqLHePO3CC6Mir1Z99xT+R63jZxAT5lFZLa2inS5h+ZS2GvR99/FBg==\n   dependencies:\n     p-finally \"^1.0.0\"\n \n-p-try@^2.0.0:\n-  version \"2.2.0\"\n-  resolved \"https://registry.yarnpkg.com/p-try/-/p-try-2.2.0.tgz#cb2868540e313d61de58fafbe35ce9004d5540e6\"\n-  integrity sha512-R4nPAVTAU0B9D35/Gk3uJf/7XYbQcyohSKdvAxIRSNghFl4e71hVoGnBNQz9cWaXxO2I10KTC+3jMdvvoKw6dQ==\n+pac-proxy-agent@^7.0.1:\n+  version \"7.0.1\"\n+  resolved \"https://registry.yarnpkg.com/pac-proxy-agent/-/pac-proxy-agent-7.0.1.tgz#6b9ddc002ec3ff0ba5fdf4a8a21d363bcc612d75\"\n+  integrity sha512-ASV8yU4LLKBAjqIPMbrgtaKIvxQri/yh2OpI+S6hVa9JRkUI3Y3NPFbfngDtY7oFtSMD3w31Xns89mDa3Feo5A==\n+  dependencies:\n+    \"@tootallnate/quickjs-emscripten\" \"^0.23.0\"\n+    agent-base \"^7.0.2\"\n+    debug \"^4.3.4\"\n+    get-uri \"^6.0.1\"\n+    http-proxy-agent \"^7.0.0\"\n+    https-proxy-agent \"^7.0.2\"\n+    pac-resolver \"^7.0.0\"\n+    socks-proxy-agent \"^8.0.2\"\n+\n+pac-resolver@^7.0.0:\n+  version \"7.0.1\"\n+  resolved \"https://registry.yarnpkg.com/pac-resolver/-/pac-resolver-7.0.1.tgz#54675558ea368b64d210fd9c92a640b5f3b8abb6\"\n+  integrity sha512-5NPgf87AT2STgwa2ntRMr45jTKrYBGkVU36yT0ig/n/GMAa3oPqhZfIQ2kMEimReg0+t9kZViDVZ83qfVUlckg==\n+  dependencies:\n+    degenerator \"^5.0.0\"\n+    netmask \"^2.0.2\"\n \n parse-cache-control@1.0.1:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/parse-cache-control/-/parse-cache-control-1.0.1.tgz#8eeab3e54fa56920fe16ba38f77fa21aacc2d74e\"\n   integrity sha1-juqz5U+laSD+Fro493+iGqzC104=\n \n-path-exists@^4.0.0:\n-  version \"4.0.0\"\n-  resolved \"https://registry.yarnpkg.com/path-exists/-/path-exists-4.0.0.tgz#513bdbe2d3b95d7762e8c1137efa195c6c61b5b3\"\n-  integrity sha512-ak9Qy5Q7jYb2Wwcey5Fpvg2KoAc/ZIhLSLOSBmRmygPsGwkVVt0fZa0qrtMz+m6tJTAHfZQ8FnmB4MG4LWy7/w==\n-\n path-is-absolute@^1.0.0:\n   version \"1.0.1\"\n   resolved \"https://registry.yarnpkg.com/path-is-absolute/-/path-is-absolute-1.0.1.tgz#174b9268735534ffbc7ace6bf53a5a9e1b5c5f5f\"\n@@ -1500,13 +1708,6 @@ performance-now@^2.1.0:\n   resolved \"https://registry.yarnpkg.com/performance-now/-/performance-now-2.1.0.tgz#6309f4e0e5fa913ec1c69307ae364b4b377c9e7b\"\n   integrity sha512-7EAHlyLHI56VEIdK57uwHdHKIaAGbnXPiw0yWbarQZOKaKpvUIgW0jWRVLiatnM+XXlSwsanIBH/hzGMJulMow==\n \n-pkg-dir@4.2.0:\n-  version \"4.2.0\"\n-  resolved \"https://registry.yarnpkg.com/pkg-dir/-/pkg-dir-4.2.0.tgz#f099133df7ede422e81d1d8448270eeb3e4261f3\"\n-  integrity sha512-HRDzbaKjC+AOWVXxAU/x54COGeIv9eb+6CkDSQoNTt4XyWoIJvuPsXizxu/Fr23EiekbtZwmh1IcIG/l/a10GQ==\n-  dependencies:\n-    find-up \"^4.0.0\"\n-\n portfinder@^1.0.13:\n   version \"1.0.13\"\n   resolved \"https://registry.yarnpkg.com/portfinder/-/portfinder-1.0.13.tgz#bb32ecd87c27104ae6ee44b5a3ccbf0ebb1aede9\"\n@@ -1529,7 +1730,21 @@ progress@2.0.3:\n   resolved \"https://registry.yarnpkg.com/progress/-/progress-2.0.3.tgz#7e8cf8d8f5b8f239c1bc68beb4eb78567d572ef8\"\n   integrity sha512-7PiHtLll5LdnKIMw100I+8xJXR5gW2QwWYkT6iJva0bXitZKa/XMrSbdmg3r2Xnaidz9Qumd0VPaMrZlF9V9sA==\n \n-proxy-from-env@1.1.0:\n+proxy-agent@6.4.0:\n+  version \"6.4.0\"\n+  resolved \"https://registry.yarnpkg.com/proxy-agent/-/proxy-agent-6.4.0.tgz#b4e2dd51dee2b377748aef8d45604c2d7608652d\"\n+  integrity sha512-u0piLU+nCOHMgGjRbimiXmA9kM/L9EHh3zL81xCdp7m+Y2pHIsnmbdDoEDoAz5geaonNR6q6+yOPQs6n4T6sBQ==\n+  dependencies:\n+    agent-base \"^7.0.2\"\n+    debug \"^4.3.4\"\n+    http-proxy-agent \"^7.0.1\"\n+    https-proxy-agent \"^7.0.3\"\n+    lru-cache \"^7.14.1\"\n+    pac-proxy-agent \"^7.0.1\"\n+    proxy-from-env \"^1.1.0\"\n+    socks-proxy-agent \"^8.0.2\"\n+\n+proxy-from-env@^1.1.0:\n   version \"1.1.0\"\n   resolved \"https://registry.yarnpkg.com/proxy-from-env/-/proxy-from-env-1.1.0.tgz#e102f16ca355424865755d2c9e8ea4f24d58c3e2\"\n   integrity sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==\n@@ -1565,23 +1780,16 @@ punycode@^2.1.0, punycode@^2.1.1:\n   resolved \"https://registry.yarnpkg.com/punycode/-/punycode-2.3.1.tgz#027422e2faec0b25e1549c3e1bd8309b9133b6e5\"\n   integrity sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==\n \n-puppeteer-core@^13.7.0:\n-  version \"13.7.0\"\n-  resolved \"https://registry.yarnpkg.com/puppeteer-core/-/puppeteer-core-13.7.0.tgz#3344bee3994163f49120a55ddcd144a40575ba5b\"\n-  integrity sha512-rXja4vcnAzFAP1OVLq/5dWNfwBGuzcOARJ6qGV7oAZhnLmVRU8G5MsdeQEAOy332ZhkIOnn9jp15R89LKHyp2Q==\n+puppeteer-core@^22.5.0:\n+  version \"22.12.0\"\n+  resolved \"https://registry.yarnpkg.com/puppeteer-core/-/puppeteer-core-22.12.0.tgz#2022b1f05cdf7ee7bb201c890f07628a4979de4e\"\n+  integrity sha512-9gY+JwBW/Fp3/x9+cOGK7ZcwqjvtvY2xjqRqsAA0B3ZFMzBauVTSZ26iWTmvOQX2sk78TN/rd5rnetxVxmK5CQ==\n   dependencies:\n-    cross-fetch \"3.1.5\"\n-    debug \"4.3.4\"\n-    devtools-protocol \"0.0.981744\"\n-    extract-zip \"2.0.1\"\n-    https-proxy-agent \"5.0.1\"\n-    pkg-dir \"4.2.0\"\n-    progress \"2.0.3\"\n-    proxy-from-env \"1.1.0\"\n-    rimraf \"3.0.2\"\n-    tar-fs \"2.1.1\"\n-    unbzip2-stream \"1.4.3\"\n-    ws \"8.5.0\"\n+    \"@puppeteer/browsers\" \"2.2.3\"\n+    chromium-bidi \"0.5.24\"\n+    debug \"4.3.5\"\n+    devtools-protocol \"0.0.1299070\"\n+    ws \"8.17.1\"\n \n qs@~2.3.3:\n   version \"2.3.3\"\n@@ -1592,6 +1800,11 @@ qs@~6.5.2:\n   resolved \"https://registry.yarnpkg.com/qs/-/qs-6.5.3.tgz#3aeeffc91967ef6e35c0e488ef46fb296ab76aad\"\n   integrity sha512-qxXIEh4pCGfHICj1mAJQ2/2XVZkjCDTcEgfoSQxc/fYivUZxTkk7L3bDBJSoNrEzXI17oUO5Dp07ktqE5KzczA==\n \n+queue-tick@^1.0.1:\n+  version \"1.0.1\"\n+  resolved \"https://registry.yarnpkg.com/queue-tick/-/queue-tick-1.0.1.tgz#f6f07ac82c1fd60f82e098b417a80e52f1f4c142\"\n+  integrity sha512-kJt5qhMxoszgU/62PLP1CJytzd2NKetjSRnyuj31fDd3Rlcz3fzlFdFLD1SItunPwyqEOkca6GbV612BWfaBag==\n+\n ramda@^0.25.0:\n   version \"0.25.0\"\n   resolved \"https://registry.yarnpkg.com/ramda/-/ramda-0.25.0.tgz#8fdf68231cffa90bc2f9460390a0cb74a29b29a9\"\n@@ -1632,15 +1845,6 @@ readable-stream@^2.3.0, readable-stream@^2.3.5:\n     string_decoder \"~1.1.1\"\n     util-deprecate \"~1.0.1\"\n \n-readable-stream@^3.1.1, readable-stream@^3.4.0:\n-  version \"3.6.2\"\n-  resolved \"https://registry.yarnpkg.com/readable-stream/-/readable-stream-3.6.2.tgz#56a9b36ea965c00c5a93ef31eb111a0f11056967\"\n-  integrity sha512-9u/sniCrY3D5WdsERHzHE4G2YCXqoG5FTHUiCC4SIbr6XcLZBY05ya9EKjYek9O5xOAwjGq+1JdGBAS7Q9ScoA==\n-  dependencies:\n-    inherits \"^2.0.3\"\n-    string_decoder \"^1.1.1\"\n-    util-deprecate \"^1.0.1\"\n-\n request@^2.87.0:\n   version \"2.88.2\"\n   resolved \"https://registry.yarnpkg.com/request/-/request-2.88.2.tgz#d73c918731cb5a87da047e207234146f664d12b3\"\n@@ -1689,7 +1893,7 @@ rimraf@2, rimraf@^2.6.1:\n   dependencies:\n     glob \"^7.0.5\"\n \n-rimraf@3.0.2, rimraf@^3.0.2:\n+rimraf@^3.0.2:\n   version \"3.0.2\"\n   resolved \"https://registry.yarnpkg.com/rimraf/-/rimraf-3.0.2.tgz#f1a5402ba6220ad52cc1282bac1ae3aa49fd061a\"\n   integrity sha512-JZkJMZkAGFFPP2YqXZXPbMlMBgsxzE8ILs4lMIX/2o0L9UBw9O/Y3o6wFw/i9YLapcUJWwqbi3kdxIPdC62TIA==\n@@ -1703,7 +1907,7 @@ rimraf@^4.3.1:\n   dependencies:\n     glob \"^9.2.0\"\n \n-robots-parser@^3.0.0:\n+robots-parser@^3.0.1:\n   version \"3.0.1\"\n   resolved \"https://registry.yarnpkg.com/robots-parser/-/robots-parser-3.0.1.tgz#3d8a3cdfa8ac240cbb062a4bd16fcc0e0fb9ed23\"\n   integrity sha512-s+pyvQeIKIZ0dx5iJiQk1tPLJAWln39+MI5jtM8wnyws+G5azk+dMnMX0qfbqNetKKNgcWWOdi0sfm+FbQbgdQ==\n@@ -1712,7 +1916,7 @@ safe-buffer@^5.0.1, safe-buffer@~5.1.0, safe-buffer@~5.1.1:\n   version \"5.1.1\"\n   resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.1.1.tgz#893312af69b2123def71f57889001671eeb2c853\"\n \n-safe-buffer@^5.1.1, safe-buffer@^5.1.2, safe-buffer@^5.2.1, safe-buffer@~5.2.0:\n+safe-buffer@^5.1.1, safe-buffer@^5.1.2, safe-buffer@^5.2.1:\n   version \"5.2.1\"\n   resolved \"https://registry.yarnpkg.com/safe-buffer/-/safe-buffer-5.2.1.tgz#1eaf9fa9bdb1fdd4ec75f58f9cdb4e6b7827eec6\"\n   integrity sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==\n@@ -1727,6 +1931,13 @@ sax@^1.2.4:\n   resolved \"https://registry.yarnpkg.com/sax/-/sax-1.3.0.tgz#a5dbe77db3be05c9d1ee7785dbd3ea9de51593d0\"\n   integrity sha512-0s+oAmw9zLl1V1cS9BtZN7JAd0cW5e0QH4W3LWEK6a4LaLEA2OTpGYWDY+6XasBLtz6wkm3u1xRw95mRuJ59WA==\n \n+semver@7.6.0:\n+  version \"7.6.0\"\n+  resolved \"https://registry.yarnpkg.com/semver/-/semver-7.6.0.tgz#1a46a4db4bffcccd97b743b5005c8325f23d4e2d\"\n+  integrity sha512-EnwXhrlwXMk9gKu5/flx5sv/an57AkRplG3hTK68W7FRDN+k+OWBj65M7719OkA82XLBxrcX0KSHj+X5COhOVg==\n+  dependencies:\n+    lru-cache \"^6.0.0\"\n+\n semver@^5.3.0:\n   version \"5.4.1\"\n   resolved \"https://registry.yarnpkg.com/semver/-/semver-5.4.1.tgz#e059c09d8571f0540823733433505d3a2f00b18e\"\n@@ -1748,6 +1959,33 @@ signal-exit@^3.0.0, signal-exit@^3.0.2:\n   version \"3.0.2\"\n   resolved \"https://registry.yarnpkg.com/signal-exit/-/signal-exit-3.0.2.tgz#b5fdc08f1287ea1178628e415e25132b73646c6d\"\n \n+smart-buffer@^4.2.0:\n+  version \"4.2.0\"\n+  resolved \"https://registry.yarnpkg.com/smart-buffer/-/smart-buffer-4.2.0.tgz#6e1d71fa4f18c05f7d0ff216dd16a481d0e8d9ae\"\n+  integrity sha512-94hK0Hh8rPqQl2xXc3HsaBoOXKV20MToPkcXvwbISWLEs+64sBq5kFgn2kJDHb1Pry9yrP0dxrCI9RRci7RXKg==\n+\n+socks-proxy-agent@^8.0.2:\n+  version \"8.0.3\"\n+  resolved \"https://registry.yarnpkg.com/socks-proxy-agent/-/socks-proxy-agent-8.0.3.tgz#6b2da3d77364fde6292e810b496cb70440b9b89d\"\n+  integrity sha512-VNegTZKhuGq5vSD6XNKlbqWhyt/40CgoEw8XxD6dhnm8Jq9IEa3nIa4HwnM8XOqU0CdB0BwWVXusqiFXfHB3+A==\n+  dependencies:\n+    agent-base \"^7.1.1\"\n+    debug \"^4.3.4\"\n+    socks \"^2.7.1\"\n+\n+socks@^2.7.1:\n+  version \"2.8.3\"\n+  resolved \"https://registry.yarnpkg.com/socks/-/socks-2.8.3.tgz#1ebd0f09c52ba95a09750afe3f3f9f724a800cb5\"\n+  integrity sha512-l5x7VUUWbjVFbafGLxPWkYsHIhEvmF85tbIeFZWc8ZPtoMyybuEhL7Jye/ooC4/d48FgOjSJXgsF/AJPYCW8Zw==\n+  dependencies:\n+    ip-address \"^9.0.5\"\n+    smart-buffer \"^4.2.0\"\n+\n+source-map@~0.6.1:\n+  version \"0.6.1\"\n+  resolved \"https://registry.yarnpkg.com/source-map/-/source-map-0.6.1.tgz#74722af32e9614e9c287a8d0bbde48b5e2f1a263\"\n+  integrity sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==\n+\n speedline-core@^1.4.3:\n   version \"1.4.3\"\n   resolved \"https://registry.yarnpkg.com/speedline-core/-/speedline-core-1.4.3.tgz#4d6e7276e2063c2d36a375cb25a523ac73475319\"\n@@ -1757,6 +1995,11 @@ speedline-core@^1.4.3:\n     image-ssim \"^0.2.0\"\n     jpeg-js \"^0.4.1\"\n \n+sprintf-js@^1.1.3:\n+  version \"1.1.3\"\n+  resolved \"https://registry.yarnpkg.com/sprintf-js/-/sprintf-js-1.1.3.tgz#4914b903a2f8b685d17fdf78a70e917e872e444a\"\n+  integrity sha512-Oo+0REFV59/rz3gfJNKQiBlwfHaSESl1pcGyABQsnnIfWOFt6JNj5gCog2U6MLZ//IGYD+nA8nI+mTShREReaA==\n+\n sshpk@^1.7.0:\n   version \"1.13.1\"\n   resolved \"https://registry.yarnpkg.com/sshpk/-/sshpk-1.13.1.tgz#512df6da6287144316dc4c18fe1cf1d940739be3\"\n@@ -1775,6 +2018,17 @@ stats-analysis@^2.0.0:\n   version \"2.0.0\"\n   resolved \"https://registry.yarnpkg.com/stats-analysis/-/stats-analysis-2.0.0.tgz#f45c516ff5c5d26c26f2d8c7b3d57592802d6187\"\n \n+streamx@^2.15.0, streamx@^2.18.0:\n+  version \"2.18.0\"\n+  resolved \"https://registry.yarnpkg.com/streamx/-/streamx-2.18.0.tgz#5bc1a51eb412a667ebfdcd4e6cf6a6fc65721ac7\"\n+  integrity sha512-LLUC1TWdjVdn1weXGcSxyTR3T4+acB6tVGXT95y0nGbca4t4o/ng1wKAGTljm9VicuCVLvRlqFYXYy5GwgM7sQ==\n+  dependencies:\n+    fast-fifo \"^1.3.2\"\n+    queue-tick \"^1.0.1\"\n+    text-decoder \"^1.1.0\"\n+  optionalDependencies:\n+    bare-events \"^2.2.0\"\n+\n string-width@^1.0.1, string-width@^1.0.2:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/string-width/-/string-width-1.0.2.tgz#118bdf5b8cdc51a2a7e70d211e07e2b0b9b107d3\"\n@@ -1792,13 +2046,6 @@ string-width@^4.1.0, string-width@^4.2.0, string-width@^4.2.3:\n     is-fullwidth-code-point \"^3.0.0\"\n     strip-ansi \"^6.0.1\"\n \n-string_decoder@^1.1.1:\n-  version \"1.3.0\"\n-  resolved \"https://registry.yarnpkg.com/string_decoder/-/string_decoder-1.3.0.tgz#42f114594a46cf1a8e30b0a84f56c78c3edac21e\"\n-  integrity sha512-hkRX8U1WjJFd8LsDJ2yQ/wWWxaopEsABU1XfkM8A+j0+85JAGppt16cr1Whg6KIbb4okU6Mql6BOj+uup/wKeA==\n-  dependencies:\n-    safe-buffer \"~5.2.0\"\n-\n string_decoder@~1.0.3:\n   version \"1.0.3\"\n   resolved \"https://registry.yarnpkg.com/string_decoder/-/string_decoder-1.0.3.tgz#0fc67d7c141825de94282dd536bec6b9bce860ab\"\n@@ -1835,15 +2082,16 @@ supports-color@^4.0.0:\n   dependencies:\n     has-flag \"^2.0.0\"\n \n-tar-fs@2.1.1:\n-  version \"2.1.1\"\n-  resolved \"https://registry.yarnpkg.com/tar-fs/-/tar-fs-2.1.1.tgz#489a15ab85f1f0befabb370b7de4f9eb5cbe8784\"\n-  integrity sha512-V0r2Y9scmbDRLCNex/+hYzvp/zyYjvFbHPNgVTKfQvVrb6guiE/fxP+XblDNR011utopbkex2nM4dHNV6GDsng==\n+tar-fs@3.0.5:\n+  version \"3.0.5\"\n+  resolved \"https://registry.yarnpkg.com/tar-fs/-/tar-fs-3.0.5.tgz#f954d77767e4e6edf973384e1eb95f8f81d64ed9\"\n+  integrity sha512-JOgGAmZyMgbqpLwct7ZV8VzkEB6pxXFBVErLtb+XCOqzc6w1xiWKI9GVd6bwk68EX7eJ4DWmfXVmq8K2ziZTGg==\n   dependencies:\n-    chownr \"^1.1.1\"\n-    mkdirp-classic \"^0.5.2\"\n     pump \"^3.0.0\"\n-    tar-stream \"^2.1.4\"\n+    tar-stream \"^3.1.5\"\n+  optionalDependencies:\n+    bare-fs \"^2.1.1\"\n+    bare-path \"^2.1.0\"\n \n tar-fs@^1.16.3:\n   version \"1.16.3\"\n@@ -1868,16 +2116,14 @@ tar-stream@^1.1.2:\n     to-buffer \"^1.1.1\"\n     xtend \"^4.0.0\"\n \n-tar-stream@^2.1.4:\n-  version \"2.2.0\"\n-  resolved \"https://registry.yarnpkg.com/tar-stream/-/tar-stream-2.2.0.tgz#acad84c284136b060dc3faa64474aa9aebd77287\"\n-  integrity sha512-ujeqbceABgwMZxEJnk2HDY2DlnUZ+9oEcb1KzTVfYHio0UE6dG71n60d8D2I4qNvleWrrXpmjpt7vZeF1LnMZQ==\n+tar-stream@^3.1.5:\n+  version \"3.1.7\"\n+  resolved \"https://registry.yarnpkg.com/tar-stream/-/tar-stream-3.1.7.tgz#24b3fb5eabada19fe7338ed6d26e5f7c482e792b\"\n+  integrity sha512-qJj60CXt7IU1Ffyc3NJMjh6EkuCFej46zUqJ4J7pqYlThyd9bO0XBTmcOIhSzZJVWfsLks0+nle/j538YAW9RQ==\n   dependencies:\n-    bl \"^4.0.3\"\n-    end-of-stream \"^1.4.1\"\n-    fs-constants \"^1.0.0\"\n-    inherits \"^2.0.3\"\n-    readable-stream \"^3.1.1\"\n+    b4a \"^1.6.4\"\n+    fast-fifo \"^1.2.0\"\n+    streamx \"^2.15.0\"\n \n tar@^4, tar@^4.4.8:\n   version \"4.4.19\"\n@@ -1892,16 +2138,35 @@ tar@^4, tar@^4.4.8:\n     safe-buffer \"^5.2.1\"\n     yallist \"^3.1.1\"\n \n-third-party-web@^0.17.1:\n-  version \"0.17.1\"\n-  resolved \"https://registry.yarnpkg.com/third-party-web/-/third-party-web-0.17.1.tgz#22e03f1ff519a6380bae4594b704b9bb28e15158\"\n-  integrity sha512-X9Mha8cVeBwakunlZXkXL6xRzw8VCcDGWqT59EzeTYAJIi8ien3CuufnEGEx4ZUFahumNQdoOwf4H2T9Ca6lBg==\n+text-decoder@^1.1.0:\n+  version \"1.1.0\"\n+  resolved \"https://registry.yarnpkg.com/text-decoder/-/text-decoder-1.1.0.tgz#3379e728fcf4d3893ec1aea35e8c2cac215ef190\"\n+  integrity sha512-TmLJNj6UgX8xcUZo4UDStGQtDiTzF7BzWlzn9g7UWrjkpHr5uJTK1ld16wZ3LXb2vb6jH8qU89dW5whuMdXYdw==\n+  dependencies:\n+    b4a \"^1.6.4\"\n+\n+third-party-web@^0.24.1:\n+  version \"0.24.3\"\n+  resolved \"https://registry.yarnpkg.com/third-party-web/-/third-party-web-0.24.3.tgz#d0281dc37a919f29b4b16110bd4bf64de552d529\"\n+  integrity sha512-imE6hXZyaCeGinGFCvpWsv0oelsEaufSG39qYBQhp3urGq4OLOtsuEddf3XgKxmAAczBD/I1Tnp8L3gJ3ksTuQ==\n \n through@^2.3.8:\n   version \"2.3.8\"\n   resolved \"https://registry.yarnpkg.com/through/-/through-2.3.8.tgz#0dd4c9ffaabc357960b1b724115d7e0e86a2e1f5\"\n   integrity sha512-w89qg7PI8wAdvX60bMDP+bFoD5Dvhm9oLheFp5O4a2QF0cSBGsBX4qZmadPMvVqlLJBBci+WqGGOAPvcDeNSVg==\n \n+tldts-core@^6.1.29:\n+  version \"6.1.29\"\n+  resolved \"https://registry.yarnpkg.com/tldts-core/-/tldts-core-6.1.29.tgz#a37a5ff726cc5169579ca7a607fbeee1464314c2\"\n+  integrity sha512-ZhgwrF9P697hrsO8PZ4dFL8UZLLmczYcFwiknsPEk81BTC0xauqQfepPefIfS/YK2z2VVRQmyg0hZujShTlH7A==\n+\n+tldts-icann@^6.1.0:\n+  version \"6.1.29\"\n+  resolved \"https://registry.yarnpkg.com/tldts-icann/-/tldts-icann-6.1.29.tgz#a549ef62d7a534e2a461c579784ef0944edb9438\"\n+  integrity sha512-EMN6Y25sN+pgwYaisBvorac27NAY80OAQ9CLF6ae82oS8ak0IKDQMis3DnT5ExrFWUirZbaKEq5f1ryHcJNdMQ==\n+  dependencies:\n+    tldts-core \"^6.1.29\"\n+\n to-buffer@^1.1.1:\n   version \"1.1.1\"\n   resolved \"https://registry.yarnpkg.com/to-buffer/-/to-buffer-1.1.1.tgz#493bd48f62d7c43fcded313a03dcadb2e1213a80\"\n@@ -1920,16 +2185,16 @@ tough-cookie@~2.5.0:\n     psl \"^1.1.28\"\n     punycode \"^2.1.1\"\n \n-tr46@~0.0.3:\n-  version \"0.0.3\"\n-  resolved \"https://registry.yarnpkg.com/tr46/-/tr46-0.0.3.tgz#8184fd347dac9cdc185992f3a6622e14b9d9ab6a\"\n-  integrity sha512-N3WMsuqV66lT30CrXNbEjx4GEwlow3v6rr4mCcv6prnfwhS01rkgyFdjPNBYd9br7LpXV1+Emh01fHnq2Gdgrw==\n-\n tslib@^1.9.3:\n   version \"1.14.1\"\n   resolved \"https://registry.yarnpkg.com/tslib/-/tslib-1.14.1.tgz#cf2d38bdc34a134bcaf1091c41f6619e2f672d00\"\n   integrity sha512-Xni35NKzjgMrwevysHTCArtLDpPvye8zV/0E4EyYn43P7/7qvQwPh9BGkHewbMulVntbigmcT7rdX3BNo9wRJg==\n \n+tslib@^2.0.1, tslib@^2.4.0:\n+  version \"2.6.3\"\n+  resolved \"https://registry.yarnpkg.com/tslib/-/tslib-2.6.3.tgz#0438f810ad7a9edcde7a241c3d80db693c8cbfe0\"\n+  integrity sha512-xNvxJEOUiWPGhUuUdQgAJPKOOJfGnIyKySOc09XkKsgdUV/3E2zvwZYdejjmRgPCgcym1juLH3226yA7sEFJKQ==\n+\n tunnel-agent@^0.6.0:\n   version \"0.6.0\"\n   resolved \"https://registry.yarnpkg.com/tunnel-agent/-/tunnel-agent-0.6.0.tgz#27a5dea06b36b04a0a9966774b290868f0fc40fd\"\n@@ -1978,6 +2243,11 @@ universalify@^0.1.0:\n   resolved \"https://registry.yarnpkg.com/universalify/-/universalify-0.1.2.tgz#b646f69be3942dabcecc9d6639c80dc105efaa66\"\n   integrity sha512-rBJeI5CXAlmy1pV+617WB9J63U6XcazHHF2f2dbJix4XzpUF0RS3Zbj0FGIOCAva5P/d/GBOYaACQ1w+0azUkg==\n \n+universalify@^2.0.0:\n+  version \"2.0.1\"\n+  resolved \"https://registry.yarnpkg.com/universalify/-/universalify-2.0.1.tgz#168efc2180964e6386d061e094df61afe239b18d\"\n+  integrity sha512-gptHNQghINnc/vTGIk0SOFGFNXw7JVrlRUtConJRlvaw6DuX0wO5Jeko9sWrMBhh+PsYAZ7oXAiOnf/UKogyiw==\n+\n uri-js@^4.2.2:\n   version \"4.4.1\"\n   resolved \"https://registry.yarnpkg.com/uri-js/-/uri-js-4.4.1.tgz#9b1a52595225859e55f669d928f88c6c57f2a77e\"\n@@ -1990,7 +2260,12 @@ url-join@^2.0.2:\n   resolved \"https://registry.yarnpkg.com/url-join/-/url-join-2.0.5.tgz#5af22f18c052a000a48d7b82c5e9c2e2feeda728\"\n   integrity sha1-WvIvGMBSoACkjXuCxenC4v7tpyg=\n \n-util-deprecate@^1.0.1, util-deprecate@~1.0.1:\n+urlpattern-polyfill@10.0.0:\n+  version \"10.0.0\"\n+  resolved \"https://registry.yarnpkg.com/urlpattern-polyfill/-/urlpattern-polyfill-10.0.0.tgz#f0a03a97bfb03cdf33553e5e79a2aadd22cac8ec\"\n+  integrity sha512-H/A06tKD7sS1O1X2SshBVeA5FLycRpjqiBeqGKmBwBDBy28EnRjORxTNe269KSSr5un5qyWi1iL61wLxpd+ZOg==\n+\n+util-deprecate@~1.0.1:\n   version \"1.0.2\"\n   resolved \"https://registry.yarnpkg.com/util-deprecate/-/util-deprecate-1.0.2.tgz#450d4dc9fa70de732762fbd2d4a28981419a0ccf\"\n \n@@ -2007,19 +2282,6 @@ verror@1.10.0:\n     core-util-is \"1.0.2\"\n     extsprintf \"^1.2.0\"\n \n-webidl-conversions@^3.0.0:\n-  version \"3.0.1\"\n-  resolved \"https://registry.yarnpkg.com/webidl-conversions/-/webidl-conversions-3.0.1.tgz#24534275e2a7bc6be7bc86611cc16ae0a5654871\"\n-  integrity sha512-2JAn3z8AR6rjK8Sm8orRC0h/bcl/DqL7tRPdGZ4I1CjdF+EaMLmYxBHyXuKL849eucPFhvBoxMsflfOb8kxaeQ==\n-\n-whatwg-url@^5.0.0:\n-  version \"5.0.0\"\n-  resolved \"https://registry.yarnpkg.com/whatwg-url/-/whatwg-url-5.0.0.tgz#966454e8765462e37644d3626f6742ce8b70965d\"\n-  integrity sha512-saE57nupxk6v3HY35+jzBwYa0rKSy0XR8JSxZPwgLr7ys0IBzhGviA1/TUGJLmSVqs8pb9AnvICXEuOHLprYTw==\n-  dependencies:\n-    tr46 \"~0.0.3\"\n-    webidl-conversions \"^3.0.0\"\n-\n which@1:\n   version \"1.3.0\"\n   resolved \"https://registry.yarnpkg.com/which/-/which-1.3.0.tgz#ff04bdfc010ee547d780bec38e1ac1c2777d253a\"\n@@ -2059,10 +2321,10 @@ write-file-atomic@^3.0.0:\n     signal-exit \"^3.0.2\"\n     typedarray-to-buffer \"^3.1.5\"\n \n-ws@8.5.0:\n-  version \"8.5.0\"\n-  resolved \"https://registry.yarnpkg.com/ws/-/ws-8.5.0.tgz#bfb4be96600757fe5382de12c670dab984a1ed4f\"\n-  integrity sha512-BWX0SWVgLPzYwF8lTzEy1egjhS4S4OEAHfsO8o65WOVsrnSRGaSiUaa9e0ggGlkMTtBlmOpEXiie9RUcBO86qg==\n+ws@8.17.1:\n+  version \"8.17.1\"\n+  resolved \"https://registry.yarnpkg.com/ws/-/ws-8.17.1.tgz#9293da530bb548febc95371d90f9c878727d919b\"\n+  integrity sha512-6XQFvXTkbfUOZOKKILFG1PDK2NDQs4azKQl26T0YS5CxqWLgXajbPZ+h4gZekJyRqFU8pvnbAbbs/3TgRPy+GQ==\n \n ws@^7.0.0:\n   version \"7.5.9\"\n@@ -2089,12 +2351,17 @@ yallist@^3.0.0, yallist@^3.1.1:\n   resolved \"https://registry.yarnpkg.com/yallist/-/yallist-3.1.1.tgz#dbb7daf9bfd8bac9ab45ebf602b8cbad0d5d08fd\"\n   integrity sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==\n \n+yallist@^4.0.0:\n+  version \"4.0.0\"\n+  resolved \"https://registry.yarnpkg.com/yallist/-/yallist-4.0.0.tgz#9bb92790d9c0effec63be73519e11a35019a3a72\"\n+  integrity sha512-3wdGidZyq5PB084XLES5TpOSRA3wjXAlIWMhum2kRcv/41Sn2emQ0dycQW4uZXLejwKvg6EsvbdlVL+FYEct7A==\n+\n yargs-parser@^21.0.0, yargs-parser@^21.1.1:\n   version \"21.1.1\"\n   resolved \"https://registry.yarnpkg.com/yargs-parser/-/yargs-parser-21.1.1.tgz#9096bceebf990d21bb31fa9516e0ede294a77d35\"\n   integrity sha512-tVpsJW7DdjecAiFpbIB1e3qxIQsE6NoPc5/eTdrbbIC4h0LVsWhnoa3g+m2HclBIujHzsxZ4VJVA+GUuc2/LBw==\n \n-yargs@^17.3.1:\n+yargs@17.7.2, yargs@^17.3.1:\n   version \"17.7.2\"\n   resolved \"https://registry.yarnpkg.com/yargs/-/yargs-17.7.2.tgz#991df39aca675a192b816e1e0363f9d75d2aa269\"\n   integrity sha512-7dSzzRQ++CKnNI/krKnYRV7JKKPUXMEh61soaHKg9mrWEhzFWhFnxPxGl+69cD1Ou63C13NUPCnmIcrvqCuM6w==\n@@ -2114,3 +2381,8 @@ yauzl@^2.10.0:\n   dependencies:\n     buffer-crc32 \"~0.2.3\"\n     fd-slicer \"~1.1.0\"\n+\n+zod@3.23.8:\n+  version \"3.23.8\"\n+  resolved \"https://registry.yarnpkg.com/zod/-/zod-3.23.8.tgz#e37b957b5d52079769fb8097099b592f0ef4067d\"\n+  integrity sha512-XBx9AXhXktjUqnepgTiE5flcKIYWi/rme0Eaj+5Y0lftuGBq+jyRu/md4WnuxqgP1ubdpNCsYEYPxrzVHD8d6g=="
            },
            {
                "file": "scripts/bench/yarn.lock",
                "git_diff": "@@ -2155,6 +2155,19 @@ through@^2.3.8:\n   resolved \"https://registry.yarnpkg.com/through/-/through-2.3.8.tgz#0dd4c9ffaabc357960b1b724115d7e0e86a2e1f5\"\n   integrity sha512-w89qg7PI8wAdvX60bMDP+bFoD5Dvhm9oLheFp5O4a2QF0cSBGsBX4qZmadPMvVqlLJBBci+WqGGOAPvcDeNSVg==\n \n+<<<<<< snyk-fix-049f8677e79143706eaea3bec7836bb8\n+tldts-core@^6.1.28:\n+  version \"6.1.28\"\n+  resolved \"https://registry.yarnpkg.com/tldts-core/-/tldts-core-6.1.28.tgz#123e125ff1a4cb65a685d6140c7957641bfb616b\"\n+  integrity sha512-MJIfu8oVA4GVEuZKxk1GaaLpdq45w8b/UoWwuq3k+oIWbFBFtFG37xCTe3qz7D/ZBcHFZ2LmQb66grE1/Q93Hw==\n+\n+tldts-icann@^6.1.0:\n+  version \"6.1.28\"\n+  resolved \"https://registry.yarnpkg.com/tldts-icann/-/tldts-icann-6.1.28.tgz#1c39c654cd3359d2ae986db8c408e4eee21e3e44\"\n+  integrity sha512-SSfJKL9q0ZyW32JApyeC6ad96sXRJ+jo1QLcAMsCPcD03vjJqAqY0wddeI4VhQZRkaLr5gUOu59BOAgIcYRp+A==\n+  dependencies:\n+    tldts-core \"^6.1.28\"\n+=======\n tldts-core@^6.1.29:\n   version \"6.1.29\"\n   resolved \"https://registry.yarnpkg.com/tldts-core/-/tldts-core-6.1.29.tgz#a37a5ff726cc5169579ca7a607fbeee1464314c2\"\n@@ -2166,6 +2179,7 @@ tldts-icann@^6.1.0:\n   integrity sha512-EMN6Y25sN+pgwYaisBvorac27NAY80OAQ9CLF6ae82oS8ak0IKDQMis3DnT5ExrFWUirZbaKEq5f1ryHcJNdMQ==\n   dependencies:\n     tldts-core \"^6.1.29\"\n+>>>>>> master\n \n to-buffer@^1.1.1:\n   version \"1.1.1\""
            },
            {
                "file": ".circleci/config.yml",
                "git_diff": "@@ -1,682 +0,0 @@\n-version: 2.1\n-\n-aliases:\n-  - &docker\n-    - image: cimg/openjdk:18.0-node\n-\n-  - &environment\n-    TZ: /usr/share/zoneinfo/America/Los_Angeles\n-\n-  - &restore_yarn_cache_fixtures_dom\n-    restore_cache:\n-      name: Restore yarn cache for fixtures/dom\n-      keys:\n-        - v2-yarn_cache-{{ arch }}-{{ checksum \"yarn.lock\" }}-fixtures/dom\n-\n-  - &yarn_install_fixtures_dom\n-    run:\n-      name: Install dependencies in fixtures/dom\n-      working_directory: fixtures/dom\n-      command: yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n-\n-  - &yarn_install_fixtures_dom_retry\n-    run:\n-      name: Install dependencies in fixtures/dom (retry)\n-      when: on_fail\n-      working_directory: fixtures/dom\n-      command: yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n-\n-  - &save_yarn_cache_fixtures_dom\n-    save_cache:\n-      name: Save yarn cache for fixtures/dom\n-      key: v2-yarn_cache-{{ arch }}-{{ checksum \"yarn.lock\" }}-fixtures/dom\n-      paths:\n-        - ~/.cache/yarn\n-\n-  - &TEST_PARALLELISM 20\n-\n-  - &attach_workspace\n-    at: build\n-\n-commands:\n-  setup_node_modules:\n-    description: \"Restore node_modules\"\n-    steps:\n-      - restore_cache:\n-          name: Restore yarn cache\n-          keys:\n-            - v2-yarn_cache-{{ arch }}-{{ checksum \"yarn.lock\" }}\n-      - run:\n-          name: Install dependencies\n-          command: |\n-            yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n-            if [ $? -ne 0 ]; then\n-              yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n-            fi\n-          environment:\n-          # If we start needing the Electron binary, please ensure the binary is cached in CI following https://www.electronjs.org/docs/latest/tutorial/installation\n-            ELECTRON_SKIP_BINARY_DOWNLOAD: 1\n-      - save_cache:\n-          name: Save yarn cache\n-          key: v2-yarn_cache-{{ arch }}-{{ checksum \"yarn.lock\" }}\n-          paths:\n-            - ~/.cache/yarn\n-\n-# The CircleCI API doesn't yet support triggering a specific workflow, but it\n-# does support triggering a pipeline. So as a workaround you can triggger the\n-# entire pipeline and use parameters to disable everything except the workflow\n-# you want. CircleCI recommends this workaround here:\n-# https://support.circleci.com/hc/en-us/articles/360050351292-How-to-trigger-a-workflow-via-CircleCI-API-v2-\n-parameters:\n-  # This is only set when triggering the CI pipeline via an API request.\n-  prerelease_commit_sha:\n-    type: string\n-    default: ''\n-\n-jobs:\n-  yarn_lint:\n-    docker: *docker\n-    environment: *environment\n-\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run: node ./scripts/prettier/index\n-      - run: node ./scripts/tasks/eslint\n-      - run: ./scripts/circleci/check_license.sh\n-      - run: ./scripts/circleci/check_modules.sh\n-      - run: ./scripts/circleci/test_print_warnings.sh\n-\n-  yarn_flow:\n-    docker: *docker\n-    environment: *environment\n-    parallelism: 5\n-\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run: node ./scripts/tasks/flow-ci\n-\n-\n-  yarn_flags:\n-    docker: *docker\n-    environment: *environment\n-\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run: yarn flags\n-\n-  scrape_warning_messages:\n-    docker: *docker\n-    environment: *environment\n-\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run:\n-          command: |\n-            mkdir -p ./build/__test_utils__\n-            node ./scripts/print-warnings/print-warnings.js > build/__test_utils__/ReactAllWarnings.js\n-      - persist_to_workspace:\n-          root: .\n-          paths:\n-            - build\n-\n-  yarn_build:\n-    docker: *docker\n-    environment: *environment\n-    parallelism: 40\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run: yarn build\n-      - persist_to_workspace:\n-          root: .\n-          paths:\n-            - build\n-\n-  download_build:\n-    docker: *docker\n-    environment: *environment\n-    parameters:\n-      revision:\n-        type: string\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run:\n-          name: Download artifacts for revision\n-          command: |\n-              git fetch origin main\n-              cd ./scripts/release && yarn && cd ../../\n-              scripts/release/download-experimental-build.js --commit=<< parameters.revision >> --allowBrokenCI\n-      - persist_to_workspace:\n-          root: .\n-          paths:\n-            - build\n-\n-  download_base_build_for_sizebot:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run:\n-          name: Download artifacts for base revision\n-          command: |\n-            git fetch origin main\n-            cd ./scripts/release && yarn && cd ../../\n-            scripts/release/download-experimental-build.js --commit=$(git merge-base HEAD origin/main) --allowBrokenCI\n-            mv ./build ./base-build\n-\n-      - run:\n-          # TODO: The `download-experimental-build` script copies the npm\n-          # packages into the `node_modules` directory. This is a historical\n-          # quirk of how the release script works. Let's pretend they\n-          # don't exist.\n-          name: Delete extraneous files\n-          command: rm -rf ./base-build/node_modules\n-\n-      - persist_to_workspace:\n-          root: .\n-          paths:\n-            - base-build\n-\n-  process_artifacts_combined:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - run: echo \"<< pipeline.git.revision\t>>\" >> build/COMMIT_SHA\n-        # Compress build directory into a single tarball for easy download\n-      - run: tar -zcvf ./build.tgz ./build\n-        # TODO: Migrate scripts to use `build` directory instead of `build2`\n-      - run: cp ./build.tgz ./build2.tgz\n-      - store_artifacts:\n-          path: ./build2.tgz\n-      - store_artifacts:\n-          path: ./build.tgz\n-\n-  sizebot:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - run: echo \"<< pipeline.git.revision\t>>\" >> build/COMMIT_SHA\n-      - setup_node_modules\n-      - run:\n-          command: node ./scripts/tasks/danger\n-\n-  build_devtools_and_process_artifacts:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - run:\n-          environment:\n-            RELEASE_CHANNEL: experimental\n-          command: ./scripts/circleci/pack_and_store_devtools_artifacts.sh\n-      - store_artifacts:\n-          path: ./build/devtools.tgz\n-\n-  run_devtools_e2e_tests:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - run:\n-          name: Playwright install deps\n-          command: |\n-            npx playwright install\n-            sudo npx playwright install-deps\n-      - run:\n-          environment:\n-            RELEASE_CHANNEL: experimental\n-          command: ./scripts/circleci/run_devtools_e2e_tests.js\n-\n-  run_fixtures_flight_tests:\n-    docker:\n-      - image: cimg/openjdk:20.0-node\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      # Fixture copies some built packages from the workroot after install.\n-      # That means dependencies of the built packages are not installed.\n-      # We need to install dependencies of the workroot to fulfill all dependency constraints\n-      - setup_node_modules\n-      - restore_cache:\n-          name: Restore yarn cache of fixture\n-          keys:\n-            - v2-yarn_cache_fixtures_flight-{{ arch }}-{{ checksum \"yarn.lock\" }}\n-      - run:\n-          name: Install fixture dependencies\n-          working_directory: fixtures/flight\n-          command: |\n-            yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n-            if [ $? -ne 0 ]; then\n-              yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n-            fi\n-      - save_cache:\n-          name: Save yarn cache of fixture\n-          key: v2-yarn_cache_fixtures_flight-{{ arch }}-{{ checksum \"yarn.lock\" }}\n-          paths:\n-            - ~/.cache/yarn\n-      - run:\n-          working_directory: fixtures/flight\n-          name: Playwright install deps\n-          command: |\n-            npx playwright install\n-            sudo npx playwright install-deps\n-      - run:\n-          name: Run tests\n-          working_directory: fixtures/flight\n-          command: yarn test\n-          environment:\n-          # Otherwise the webserver is a blackbox\n-            DEBUG: pw:webserver\n-      - store_artifacts:\n-          path: fixtures/flight/playwright-report\n-      - store_artifacts:\n-          path: fixtures/flight/test-results\n-\n-  run_devtools_tests_for_versions:\n-    docker: *docker\n-    environment: *environment\n-    parallelism: *TEST_PARALLELISM\n-    parameters:\n-      version:\n-        type: string\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - run: ./scripts/circleci/download_devtools_regression_build.js << parameters.version >> --replaceBuild\n-      - run: node ./scripts/jest/jest-cli.js --build --project devtools --release-channel=experimental --reactVersion << parameters.version >> --ci\n-\n-  run_devtools_e2e_tests_for_versions:\n-    docker: *docker\n-    environment: *environment\n-    parallelism: *TEST_PARALLELISM\n-    parameters:\n-      version:\n-        type: string\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - run:\n-          name: Playwright install deps\n-          command: |\n-            npx playwright install\n-            sudo npx playwright install-deps\n-      - run: ./scripts/circleci/download_devtools_regression_build.js << parameters.version >>\n-      - run:\n-          environment:\n-            RELEASE_CHANNEL: experimental\n-          command: ./scripts/circleci/run_devtools_e2e_tests.js << parameters.version >>\n-      - run:\n-          name: Cleanup build regression folder\n-          command: rm -r ./build-regression\n-      - store_artifacts:\n-          path: ./tmp/screenshots\n-\n-  yarn_lint_build:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - run: yarn lint-build\n-\n-  yarn_check_release_dependencies:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - run: yarn check-release-dependencies\n-\n-\n-  check_error_codes:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace: *attach_workspace\n-      - setup_node_modules\n-      - run:\n-          name: Search build artifacts for unminified errors\n-          command: |\n-            yarn extract-errors\n-            git diff --quiet || (echo \"Found unminified errors. Either update the error codes map or disable error minification for the affected build, if appropriate.\" && false)\n-\n-  check_generated_fizz_runtime:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace: *attach_workspace\n-      - setup_node_modules\n-      - run:\n-          name: Confirm generated inline Fizz runtime is up to date\n-          command: |\n-            yarn generate-inline-fizz-runtime\n-            git diff --quiet || (echo \"There was a change to the Fizz runtime. Run `yarn generate-inline-fizz-runtime` and check in the result.\" && false)\n-\n-  yarn_test:\n-    docker: *docker\n-    environment: *environment\n-    parallelism: *TEST_PARALLELISM\n-    parameters:\n-      args:\n-        type: string\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run: yarn test <<parameters.args>> --ci\n-\n-  yarn_test_build:\n-    docker: *docker\n-    environment: *environment\n-    parallelism: *TEST_PARALLELISM\n-    parameters:\n-      args:\n-        type: string\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - run: yarn test --build <<parameters.args>> --ci\n-\n-  RELEASE_CHANNEL_stable_yarn_test_dom_fixtures:\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - attach_workspace:\n-          at: .\n-      - setup_node_modules\n-      - *restore_yarn_cache_fixtures_dom\n-      - *yarn_install_fixtures_dom\n-      - *yarn_install_fixtures_dom_retry\n-      - *save_yarn_cache_fixtures_dom\n-      - run:\n-          name: Run DOM fixture tests\n-          environment:\n-            RELEASE_CHANNEL: stable\n-          working_directory: fixtures/dom\n-          command: |\n-            yarn predev\n-            yarn test --maxWorkers=2\n-\n-  publish_prerelease:\n-    parameters:\n-      commit_sha:\n-        type: string\n-      release_channel:\n-        type: string\n-      dist_tag:\n-        type: string\n-    docker: *docker\n-    environment: *environment\n-    steps:\n-      - checkout\n-      - setup_node_modules\n-      - run:\n-          name: Run publish script\n-          command: |\n-            git fetch origin main\n-            cd ./scripts/release && yarn && cd ../../\n-            scripts/release/prepare-release-from-ci.js --skipTests -r << parameters.release_channel >> --commit=<< parameters.commit_sha >>\n-            cp ./scripts/release/ci-npmrc ~/.npmrc\n-            scripts/release/publish.js --ci --tags << parameters.dist_tag >>\n-\n-workflows:\n-\n-  build_and_test:\n-    unless: << pipeline.parameters.prerelease_commit_sha >>\n-    jobs:\n-      - yarn_flags:\n-          filters:\n-            branches:\n-              ignore:\n-                - builds/facebook-www\n-      - yarn_flow:\n-          filters:\n-            branches:\n-              ignore:\n-                - builds/facebook-www\n-      - check_generated_fizz_runtime:\n-          filters:\n-            branches:\n-              ignore:\n-                - builds/facebook-www\n-      - yarn_lint:\n-          filters:\n-            branches:\n-              ignore:\n-                - builds/facebook-www\n-      - yarn_test:\n-          filters:\n-            branches:\n-              ignore:\n-                - builds/facebook-www\n-          matrix:\n-            parameters:\n-              args:\n-                # Intentionally passing these as strings instead of creating a\n-                # separate parameter per CLI argument, since it's easier to\n-                # control/see which combinations we want to run.\n-                - \"-r=stable --env=development\"\n-                - \"-r=stable --env=production\"\n-                - \"-r=experimental --env=development\"\n-                - \"-r=experimental --env=production\"\n-                - \"-r=www-classic --env=development --variant=false\"\n-                - \"-r=www-classic --env=production --variant=false\"\n-                - \"-r=www-classic --env=development --variant=true\"\n-                - \"-r=www-classic --env=production --variant=true\"\n-                - \"-r=www-modern --env=development --variant=false\"\n-                - \"-r=www-modern --env=production --variant=false\"\n-                - \"-r=www-modern --env=development --variant=true\"\n-                - \"-r=www-modern --env=production --variant=true\"\n-\n-                # TODO: Test more persistent configurations?\n-                - '-r=stable --env=development --persistent'\n-                - '-r=experimental --env=development --persistent'\n-      - yarn_build:\n-          filters:\n-            branches:\n-              ignore:\n-                - builds/facebook-www\n-      - scrape_warning_messages:\n-          filters:\n-            branches:\n-              ignore:\n-                - builds/facebook-www\n-      - process_artifacts_combined:\n-          requires:\n-            - scrape_warning_messages\n-            - yarn_build\n-      - yarn_test_build:\n-          requires:\n-            - yarn_build\n-          matrix:\n-            parameters:\n-              args:\n-                # Intentionally passing these as strings instead of creating a\n-                # separate parameter per CLI argument, since it's easier to\n-                # control/see which combinations we want to run.\n-                - \"-r=stable --env=development\"\n-                - \"-r=stable --env=production\"\n-                - \"-r=experimental --env=development\"\n-                - \"-r=experimental --env=production\"\n-\n-                # Dev Tools\n-                - \"--project=devtools -r=experimental\"\n-\n-                # TODO: Update test config to support www build tests\n-                # - \"-r=www-classic --env=development --variant=false\"\n-                # - \"-r=www-classic --env=production --variant=false\"\n-                # - \"-r=www-classic --env=development --variant=true\"\n-                # - \"-r=www-classic --env=production --variant=true\"\n-                # - \"-r=www-modern --env=development --variant=false\"\n-                # - \"-r=www-modern --env=production --variant=false\"\n-                # - \"-r=www-modern --env=development --variant=true\"\n-                # - \"-r=www-modern --env=production --variant=true\"\n-\n-                # TODO: Test more persistent configurations?\n-      - download_base_build_for_sizebot:\n-          filters:\n-            branches:\n-              ignore:\n-                - main\n-                - builds/facebook-www\n-      - sizebot:\n-          filters:\n-            branches:\n-              ignore:\n-                - main\n-          requires:\n-            - download_base_build_for_sizebot\n-            - yarn_build\n-      - yarn_lint_build:\n-          requires:\n-            - yarn_build\n-      - yarn_check_release_dependencies:\n-          requires:\n-            - yarn_build\n-      - check_error_codes:\n-          requires:\n-            - yarn_build\n-      - RELEASE_CHANNEL_stable_yarn_test_dom_fixtures:\n-          requires:\n-            - yarn_build\n-      - build_devtools_and_process_artifacts:\n-          requires:\n-            - yarn_build\n-      - run_devtools_e2e_tests:\n-          requires:\n-            - build_devtools_and_process_artifacts\n-      - run_fixtures_flight_tests:\n-          requires:\n-            - yarn_build\n-\n-  devtools_regression_tests:\n-    unless: << pipeline.parameters.prerelease_commit_sha >>\n-    triggers:\n-      - schedule:\n-          # DevTools regression tests run once a day\n-          cron: \"0 0 * * *\"\n-          filters:\n-            branches:\n-              only:\n-                - main\n-    jobs:\n-      - download_build:\n-          revision: << pipeline.git.revision >>\n-      - build_devtools_and_process_artifacts:\n-          requires:\n-            - download_build\n-      - run_devtools_tests_for_versions:\n-          requires:\n-            - build_devtools_and_process_artifacts\n-          matrix:\n-            parameters:\n-              version:\n-                - \"16.0\"\n-                - \"16.5\" # schedule package\n-                - \"16.8\" # hooks\n-                - \"17.0\"\n-                - \"18.0\"\n-      - run_devtools_e2e_tests_for_versions:\n-          requires:\n-            - build_devtools_and_process_artifacts\n-          matrix:\n-            parameters:\n-              version:\n-                - \"16.0\"\n-                - \"16.5\" # schedule package\n-                - \"16.8\" # hooks\n-                - \"17.0\"\n-                - \"18.0\"\n-\n-  # Used to publish a prerelease manually via the command line\n-  publish_preleases:\n-    when: << pipeline.parameters.prerelease_commit_sha >>\n-    jobs:\n-      - publish_prerelease:\n-          name: Publish to Canary channel\n-          commit_sha: << pipeline.parameters.prerelease_commit_sha >>\n-          release_channel: stable\n-          # The tags to use when publishing canaries. The main one we should\n-          # always include is \"canary\" but we can use multiple (e.g. alpha,\n-          # beta, rc). To declare multiple, use a comma-separated string, like\n-          # this:\n-          #   dist_tag: \"canary,alpha,beta,rc\"\n-          #\n-          # TODO: We currently tag canaries with \"next\" in addition to \"canary\"\n-          # because this used to be called the \"next\" channel and some\n-          # downstream consumers might still expect that tag. We can remove this\n-          # after some time has elapsed and the change has been communicated.\n-          dist_tag: \"canary,next\"\n-      - publish_prerelease:\n-          name: Publish to Experimental channel\n-          requires:\n-            # NOTE: Intentionally running these jobs sequentially because npm\n-            # will sometimes fail if you try to concurrently publish two\n-            # different versions of the same package, even if they use different\n-            # dist tags.\n-            - Publish to Canary channel\n-          commit_sha: << pipeline.parameters.prerelease_commit_sha >>\n-          release_channel: experimental\n-          dist_tag: experimental\n-\n-  # Publishes on a cron schedule\n-  publish_preleases_nightly:\n-    unless: << pipeline.parameters.prerelease_commit_sha >>\n-    triggers:\n-      - schedule:\n-          # At 10 minutes past 16:00 on Mon, Tue, Wed, Thu, and Fri\n-          cron: \"10 16 * * 1,2,3,4,5\"\n-          filters:\n-            branches:\n-              only:\n-                - main\n-    jobs:\n-      - publish_prerelease:\n-          name: Publish to Canary channel\n-          commit_sha: << pipeline.git.revision >>\n-          release_channel: stable\n-          dist_tag: \"canary,next\"\n-      - publish_prerelease:\n-          name: Publish to Experimental channel\n-          requires:\n-            # NOTE: Intentionally running these jobs sequentially because npm\n-            # will sometimes fail if you try to concurrently publish two\n-            # different versions of the same package, even if they use different\n-            # dist tags.\n-            - Publish to Canary channel\n-          commit_sha: << pipeline.git.revision >>\n-          release_channel: experimental\n-          dist_tag: experimental"
            },
            {
                "file": ".eslintignore",
                "git_diff": "@@ -13,11 +13,15 @@ scripts/bench/benchmarks/**/*.js\n # React repository clone\n scripts/bench/remote-repo/\n \n+# Compiler uses its own lint setup\n+compiler/\n+\n packages/react-devtools-core/dist\n packages/react-devtools-extensions/chrome/build\n packages/react-devtools-extensions/firefox/build\n packages/react-devtools-extensions/shared/build\n packages/react-devtools-extensions/src/ErrorTesterCompiled.js\n+packages/react-devtools-fusebox/dist\n packages/react-devtools-inline/dist\n packages/react-devtools-shared/src/hooks/__tests__/__source__/__compiled__/\n packages/react-devtools-shared/src/hooks/__tests__/__source__/__untransformed__/"
            },
            {
                "file": ".eslintrc.js",
                "git_diff": "@@ -12,11 +12,13 @@ const WARNING = 1;\n const ERROR = 2;\n \n module.exports = {\n-  extends: ['prettier'],\n+  extends: ['prettier', 'plugin:jest/recommended'],\n \n   // Stop ESLint from looking for a configuration file in parent folders\n   root: true,\n \n+  reportUnusedDisableDirectives: true,\n+\n   plugins: [\n     'babel',\n     'ft-flow',\n@@ -245,7 +247,7 @@ module.exports = {\n       },\n     ],\n     'no-shadow': ERROR,\n-    'no-unused-vars': [ERROR, {args: 'none'}],\n+    'no-unused-vars': [ERROR, {args: 'none', ignoreRestSiblings: true}],\n     'no-use-before-define': OFF,\n     'no-useless-concat': OFF,\n     quotes: [ERROR, 'single', {avoidEscape: true, allowTemplateLiterals: true}],\n@@ -376,16 +378,49 @@ module.exports = {\n       files: ['**/__tests__/*.js'],\n       rules: {\n         // https://github.com/jest-community/eslint-plugin-jest\n-        'jest/no-focused-tests': ERROR,\n-        'jest/valid-expect': ERROR,\n-        'jest/valid-expect-in-promise': ERROR,\n+        // Meh, who cares.\n+        'jest/consistent-test-it': OFF,\n+        // Meh, we have a lot of these, who cares.\n+        'jest/no-alias-methods': OFF,\n+        // We do conditions based on feature flags.\n+        'jest/no-conditional-expect': OFF,\n+        // We have our own assertion helpers.\n+        'jest/expect-expect': OFF,\n+        // Lame rule that fires in itRender helpers or in render methods.\n+        'jest/no-standalone-expect': OFF,\n       },\n     },\n     {\n-      // disable no focused tests for test setup helper files even if they are inside __tests__ directory\n-      files: ['**/setupTests.js'],\n+      // Rules specific to test setup helper files.\n+      files: [\n+        '**/setupTests.js',\n+        '**/setupEnv.js',\n+        '**/jest/TestFlags.js',\n+        '**/dom-event-testing-library/testHelpers.js',\n+        '**/utils/ReactDOMServerIntegrationTestUtils.js',\n+        '**/babel/transform-react-version-pragma.js',\n+        '**/babel/transform-test-gate-pragma.js',\n+      ],\n       rules: {\n+        // Some helpers intentionally focus tests.\n         'jest/no-focused-tests': OFF,\n+        // Test fn helpers don't use static text names.\n+        'jest/valid-title': OFF,\n+        // We have our own assertion helpers.\n+        'jest/expect-expect': OFF,\n+        // Some helpers intentionally disable tests.\n+        'jest/no-disabled-tests': OFF,\n+        // Helpers export text function helpers.\n+        'jest/no-export': OFF,\n+        // The examples in comments trigger false errors.\n+        'jest/no-commented-out-tests': OFF,\n+      },\n+    },\n+    {\n+      files: ['**/jest/TestFlags.js'],\n+      rules: {\n+        // The examples in comments trigger false errors.\n+        'jest/no-commented-out-tests': OFF,\n       },\n     },\n     {\n@@ -451,11 +486,17 @@ module.exports = {\n       },\n     },\n     {\n-      files: ['packages/react-devtools-extensions/**/*.js'],\n+      files: [\n+        'packages/react-devtools-extensions/**/*.js',\n+        'packages/react-devtools-shared/src/hook.js',\n+        'packages/react-devtools-shared/src/backend/console.js',\n+        'packages/react-devtools-shared/src/backend/shared/DevToolsComponentStackFrame.js',\n+      ],\n       globals: {\n         __IS_CHROME__: 'readonly',\n         __IS_FIREFOX__: 'readonly',\n         __IS_EDGE__: 'readonly',\n+        __IS_NATIVE__: 'readonly',\n         __IS_INTERNAL_VERSION__: 'readonly',\n       },\n     },\n@@ -486,6 +527,8 @@ module.exports = {\n     $ReadOnlyArray: 'readonly',\n     $ArrayBufferView: 'readonly',\n     $Shape: 'readonly',\n+    CallSite: 'readonly',\n+    ConsoleTask: 'readonly', // TOOD: Figure out what the official name of this will be.\n     ReturnType: 'readonly',\n     AnimationFrameID: 'readonly',\n     // For Flow type annotation. Only `BigInt` is valid at runtime.\n@@ -499,7 +542,12 @@ module.exports = {\n     DOMHighResTimeStamp: 'readonly',\n     EventListener: 'readonly',\n     Iterable: 'readonly',\n+    AsyncIterable: 'readonly',\n+    $AsyncIterable: 'readonly',\n+    $AsyncIterator: 'readonly',\n     Iterator: 'readonly',\n+    AsyncIterator: 'readonly',\n+    IteratorResult: 'readonly',\n     JSONValue: 'readonly',\n     JSResourceReference: 'readonly',\n     MouseEventHandler: 'readonly',\n@@ -520,6 +568,7 @@ module.exports = {\n     React$Portal: 'readonly',\n     React$Ref: 'readonly',\n     ReadableStreamController: 'readonly',\n+    ReadableStreamReader: 'readonly',\n     RequestInfo: 'readonly',\n     RequestOptions: 'readonly',\n     StoreAsGlobal: 'readonly',\n@@ -530,6 +579,7 @@ module.exports = {\n     TimeoutID: 'readonly',\n     WheelEventHandler: 'readonly',\n     FinalizationRegistry: 'readonly',\n+    Omit: 'readonly',\n \n     spyOnDev: 'readonly',\n     spyOnDevAndProd: 'readonly',\n@@ -539,7 +589,6 @@ module.exports = {\n     __EXTENSION__: 'readonly',\n     __PROFILE__: 'readonly',\n     __TEST__: 'readonly',\n-    __UMD__: 'readonly',\n     __VARIANT__: 'readonly',\n     __unmockReact: 'readonly',\n     gate: 'readonly',"
            },
            {
                "file": ".git-blame-ignore-revs",
                "git_diff": "@@ -0,0 +1,2 @@\n+c998bb1ed4b3285398c9c7797135d3f060243c6a\n+fd2b3e13d330a4559f5aa21462e1cb2cbbcf144b"
            },
            {
                "file": ".github/ISSUE_TEMPLATE/19.md",
                "git_diff": "@@ -0,0 +1,18 @@\n+---\n+name: \"\u269bReact 19 beta issue\"\n+about: Report a issue with React 19 beta.\n+title: '[React 19]'\n+labels: 'React 19'\n+\n+---\n+\n+\n+## Summary\n+\n+<!--\n+  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a\n+  repository on GitHub, or provide a minimal code example that reproduces the\n+  problem. You may provide a screenshot of the application if you think it is\n+  relevant to your bug report. Here are some tips for providing a minimal\n+  example: https://stackoverflow.com/help/mcve.\n+-->"
            },
            {
                "file": ".github/ISSUE_TEMPLATE/compiler_bug_report.yml",
                "git_diff": "@@ -0,0 +1,57 @@\n+name: \"\u269b\ufe0f \u2728 Compiler bug report\"\n+description: \"Report a problem with React Compiler. Please provide enough information that we can reproduce the problem.\"\n+title: \"[Compiler Bug]: \"\n+labels: [\"Component: Optimizing Compiler\", \"Type: Bug\", \"Status: Unconfirmed\"]\n+body:\n+- type: checkboxes\n+  attributes:\n+    label: What kind of issue is this?\n+    description: |\n+      Please indicate if this issue affects the following tools provided by React Compiler.\n+    options:\n+      - label: React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)\n+      - label: babel-plugin-react-compiler (build issue installing or using the Babel plugin)\n+      - label: eslint-plugin-react-compiler (build issue installing or using the eslint plugin)\n+      - label: react-compiler-healthcheck (build issue installing or using the healthcheck script)\n+- type: input\n+  attributes:\n+    label: Link to repro\n+    description: |\n+      Please provide a repro by either sharing a [Playground link](https://playground.react.dev), or a public GitHub repo so the React team can reproduce the error being reported. Please do not share localhost links!\n+    placeholder: |\n+      e.g. public GitHub repo, or Playground link\n+  validations:\n+    required: true\n+- type: textarea\n+  attributes:\n+    label: Repro steps\n+    description: |\n+      What were you doing when the bug happened? Detailed information helps maintainers reproduce and fix bugs.\n+\n+      Issues filed without repro steps will be closed.\n+    placeholder: |\n+      Example bug report:\n+      1. Log in with username/password\n+      2. Click \"Messages\" on the left menu\n+      3. Open any message in the list\n+  validations:\n+    required: true\n+- type: dropdown\n+  attributes:\n+    label: How often does this bug happen?\n+    description: |\n+      Following the repro steps above, how easily are you able to reproduce this bug?\n+    options:\n+      - Every time\n+      - Often\n+      - Sometimes\n+      - Only once\n+  validations:\n+    required: true\n+- type: input\n+  attributes:\n+    label: What version of React are you using?\n+    description: |\n+      Please provide your React version in the app where this issue occurred.\n+  validations:\n+    required: true"
            },
            {
                "file": ".github/ISSUE_TEMPLATE/config.yml",
                "git_diff": "@@ -1,3 +1,4 @@\n+blank_issues_enabled: false\n contact_links:\n     - name: \ud83d\udcc3 Documentation Issue\n       url: https://github.com/reactjs/react.dev/issues/new/choose"
            },
            {
                "file": ".github/stale.yml",
                "git_diff": "@@ -1,34 +0,0 @@\n-# Configuration for probot-stale - https://github.com/probot/stale\n-# Number of days of inactivity before an issue becomes stale\n-daysUntilStale: 90\n-# Number of days of inactivity before a stale issue is closed\n-daysUntilClose: 7\n-# Issues with these labels will never be considered stale\n-exemptLabels:\n-  - \"Partner\"\n-  - \"React Core Team\"\n-  - \"Resolution: Backlog\"\n-  - \"Type: Bug\"\n-  - \"Type: Discussion\"\n-  - \"Type: Needs Investigation\"\n-  - \"Type: Regression\"\n-# Label to use when marking an issue as stale\n-staleLabel: \"Resolution: Stale\"\n-issues:\n-  # Comment to post when marking an issue as stale.\n-  markComment: >\n-    This issue has been automatically marked as stale.\n-    **If this issue is still affecting you, please leave any comment** (for example, \"bump\"), and we'll keep it open.\n-    We are sorry that we haven't been able to prioritize it yet. If you have any new additional information, please include it with your comment!\n-  # Comment to post when closing a stale issue.\n-  closeComment: >\n-    Closing this issue after a prolonged period of inactivity. If this issue is still present in the latest release, please create a new issue with up-to-date information. Thank you!\n-pulls:\n-  # Comment to post when marking a pull request as stale.\n-  markComment: >\n-    This pull request has been automatically marked as stale.\n-    **If this pull request is still relevant, please leave any comment** (for example, \"bump\"), and we'll keep it open.\n-    We are sorry that we haven't been able to prioritize reviewing it yet. Your contribution is very much appreciated.\n-  # Comment to post when closing a stale pull request.\n-  closeComment: >\n-    Closing this pull request after a prolonged period of inactivity. If this issue is still present in the latest release, please ask for this pull request to be reopened. Thank you!"
            },
            {
                "file": ".github/workflows/commit_artifacts.yml",
                "git_diff": "@@ -1,247 +0,0 @@\n-name: Commit Artifacts for Meta WWW and fbsource\n-\n-on:\n-  push:\n-    branches: [main, meta-www, meta-fbsource]\n-\n-jobs:\n-  download_artifacts:\n-    runs-on: ubuntu-latest\n-    outputs:\n-      www_branch_count: ${{ steps.check_branches.outputs.www_branch_count }}\n-      fbsource_branch_count: ${{ steps.check_branches.outputs.fbsource_branch_count }}\n-    steps:\n-      - uses: actions/checkout@v4\n-      - name: \"Check branches\"\n-        id: check_branches\n-        run: |\n-          echo \"www_branch_count=$(git ls-remote --heads origin \"refs/heads/meta-www\" | wc -l)\" >> \"$GITHUB_OUTPUT\"\n-          echo \"fbsource_branch_count=$(git ls-remote --heads origin \"refs/heads/meta-fbsource\" | wc -l)\" >> \"$GITHUB_OUTPUT\"\n-      - name: Download and unzip artifacts\n-        uses: actions/github-script@v6\n-        env:\n-          CIRCLECI_TOKEN: ${{secrets.CIRCLECI_TOKEN_DIFFTRAIN}}\n-        with:\n-          script: |\n-            const cp = require('child_process');\n-\n-            function sleep(ms) {\n-              return new Promise(resolve => setTimeout(resolve, ms));\n-            }\n-\n-            function execHelper(command, options, streamStdout = false) {\n-              return new Promise((resolve, reject) => {\n-                const proc = cp.exec(\n-                  command,\n-                  options,\n-                  (error, stdout) => (error ? reject(error) : resolve(stdout.trim())),\n-                );\n-                if (streamStdout) {\n-                  proc.stdout.pipe(process.stdout);\n-                }\n-              });\n-            }\n-\n-            let artifactsUrl = null;\n-            // This is a temporary, dirty hack to avoid needing a GitHub auth token in the circleci\n-            // workflow to notify this GitHub action. Sorry!\n-            let iter = 0;\n-            spinloop: while (iter < 15) {\n-              const res = await github.rest.repos.listCommitStatusesForRef({\n-                owner: context.repo.owner,\n-                repo: context.repo.repo,\n-                ref: context.sha\n-              });\n-              for (const status of res.data) {\n-                if (/process_artifacts_combined/.test(status.context)) {\n-                  switch (status.state) {\n-                    case 'pending': {\n-                      console.log(`${status.context} is still pending`);\n-                      break;\n-                    }\n-                    case 'failure':\n-                    case 'error': {\n-                      throw new Error(`${status.context} has failed or errored`);\n-                    }\n-                    case 'success': {\n-                      // The status does not include a build ID, but we can extract it\n-                      // from the URL. I couldn't find a better way to do this.\n-                      const ciBuildId = /\\/facebook\\/react\\/([0-9]+)/.exec(\n-                        status.target_url,\n-                      )[1];\n-                      if (Number.parseInt(ciBuildId, 10) + '' === ciBuildId) {\n-                        artifactsUrl =\n-                          `https://circleci.com/api/v1.1/project/github/facebook/react/${ciBuildId}/artifacts`;\n-                        console.log(`Found artifactsUrl: ${artifactsUrl}`);\n-                        break spinloop;\n-                      } else {\n-                        throw new Error(`${ciBuildId} isn't a number`);\n-                      }\n-                      break;\n-                    }\n-                    default: {\n-                      throw new Error(`Unhandled status state: ${status.state}`);\n-                      break;\n-                    }\n-                  }\n-                }\n-              }\n-              iter++;\n-              console.log(\"Sleeping for 60s...\");\n-              await sleep(60_000);\n-            }\n-            if (artifactsUrl != null) {\n-              const {CIRCLECI_TOKEN} = process.env;\n-              const res = await fetch(artifactsUrl, {\n-                headers: {\n-                  'Circle-Token': CIRCLECI_TOKEN\n-                }\n-              });\n-              const data = await res.json();\n-              if (!Array.isArray(data) && data.message != null) {\n-                throw `CircleCI returned: ${data.message}`;\n-              }\n-              for (const artifact of data) {\n-                if (artifact.path === 'build.tgz') {\n-                  console.log(`Downloading and unzipping ${artifact.url}`);\n-                  await execHelper(\n-                    `curl -L ${artifact.url} -H \"Circle-Token: ${CIRCLECI_TOKEN}\" | tar -xvz`\n-                  );\n-                }\n-              }\n-            } else {\n-              process.exitCode = 1;\n-            }\n-      - name: Strip @license from eslint plugin and react-refresh\n-        run: |\n-          sed -i -e 's/ @license React*//' \\\n-            build/oss-experimental/eslint-plugin-react-hooks/cjs/eslint-plugin-react-hooks.development.js \\\n-            build/oss-experimental/react-refresh/cjs/react-refresh-babel.development.js\n-      - name: Move relevant files for React in www into compiled\n-        run: |\n-          # Move the facebook-www folder into compiled\n-          mkdir ./compiled\n-          mv build/facebook-www ./compiled\n-\n-          # Move ReactAllWarnings.js to facebook-www\n-          mkdir ./compiled/facebook-www/__test_utils__\n-          mv build/__test_utils__/ReactAllWarnings.js ./compiled/facebook-www/__test_utils__/ReactAllWarnings.js\n-\n-          # Move eslint-plugin-react-hooks into facebook-www\n-          mv build/oss-experimental/eslint-plugin-react-hooks/cjs/eslint-plugin-react-hooks.development.js \\\n-            ./compiled/facebook-www/eslint-plugin-react-hooks.js\n-\n-          # Move unstable_server-external-runtime.js into facebook-www\n-          mv build/oss-stable/react-dom/unstable_server-external-runtime.js \\\n-            ./compiled/facebook-www/unstable_server-external-runtime.js\n-\n-          # Move react-refresh-babel.development.js into babel-plugin-react-refresh\n-          mkdir ./compiled/babel-plugin-react-refresh\n-          mv build/oss-experimental/react-refresh/cjs/react-refresh-babel.development.js \\\n-            ./compiled/babel-plugin-react-refresh/index.js\n-\n-          ls -R ./compiled\n-      - name: Move relevant files for React in fbsource into compiled-rn\n-        run: |\n-          BASE_FOLDER='compiled-rn/facebook-fbsource/xplat/js'\n-          mkdir -p ${BASE_FOLDER}/react-native-github/Libraries/Renderer/\n-          mkdir -p ${BASE_FOLDER}/RKJSModules/vendor/{scheduler,react,react-is,react-test-renderer}/\n-\n-          # Move React Native renderer \n-          mv build/react-native/implementations/ $BASE_FOLDER/react-native-github/Libraries/Renderer/\n-          mv build/react-native/shims/ $BASE_FOLDER/react-native-github/Libraries/Renderer/\n-          mv build/facebook-react-native/scheduler/cjs/ $BASE_FOLDER/RKJSModules/vendor/scheduler/\n-          mv build/facebook-react-native/react/cjs/ $BASE_FOLDER/RKJSModules/vendor/react/\n-          mv build/facebook-react-native/react-is/cjs/ $BASE_FOLDER/RKJSModules/vendor/react-is/\n-          mv build/facebook-react-native/react-test-renderer/cjs/ $BASE_FOLDER/RKJSModules/vendor/react-test-renderer/\n-\n-          # Delete OSS renderer. OSS renderer is synced through internal script.\n-          RENDERER_FOLDER=$BASE_FOLDER/react-native-github/Libraries/Renderer/implementations/\n-          rm $RENDERER_FOLDER/ReactFabric-{dev,prod,profiling}.js\n-          rm $RENDERER_FOLDER/ReactNativeRenderer-{dev,prod,profiling}.js\n-\n-          ls -R ./compiled\n-      - name: Add REVISION file\n-        run: |\n-          echo ${{ github.sha }} >> ./compiled/facebook-www/REVISION\n-          echo ${{ github.sha }} >> ./compiled-rn/facebook-fbsource/xplat/js/react-native-github/Libraries/Renderer/REVISION\n-      - uses: actions/upload-artifact@v3\n-        with:\n-          name: compiled\n-          path: compiled/\n-      - uses: actions/upload-artifact@v3\n-        with:\n-          name: compiled-rn\n-          path: compiled-rn/\n-\n-  commit_www_artifacts:\n-    needs: download_artifacts\n-    if: ${{ (github.ref == 'refs/heads/main' && needs.download_artifacts.outputs.www_branch_count == '0') || github.ref == 'refs/heads/meta-www' }}\n-    runs-on: ubuntu-latest\n-    steps:\n-      - uses: actions/checkout@v4\n-        with:\n-          ref: builds/facebook-www\n-      - name: Ensure clean directory\n-        run: rm -rf compiled\n-      - uses: actions/download-artifact@v3\n-        with:\n-          name: compiled\n-          path: compiled/\n-      - run: git status -u\n-      - name: Check if only the REVISION file has changed\n-        id: check_should_commit\n-        run: |\n-          if git status --porcelain | grep -qv '/REVISION$'; then\n-            echo \"should_commit=true\" >> \"$GITHUB_OUTPUT\"\n-          else\n-            echo \"should_commit=false\" >> \"$GITHUB_OUTPUT\"\n-          fi\n-      - name: Commit changes to branch\n-        if: steps.check_should_commit.outputs.should_commit == 'true'\n-        uses: stefanzweifel/git-auto-commit-action@v4\n-        with:\n-          commit_message: |\n-            ${{ github.event.head_commit.message }}\n-\n-            DiffTrain build for [${{ github.sha }}](https://github.com/facebook/react/commit/${{ github.sha }})\n-          branch: builds/facebook-www\n-          commit_user_name: ${{ github.actor }}\n-          commit_user_email: ${{ github.actor }}@users.noreply.github.com\n-          create_branch: true\n-\n-  commit_fbsource_artifacts:\n-    needs: download_artifacts\n-    runs-on: ubuntu-latest\n-    if: ${{ (github.ref == 'refs/heads/main' && needs.download_artifacts.outputs.fbsource_branch_count == '0') || github.ref == 'refs/heads/meta-fbsource' }}\n-    steps:\n-      - uses: actions/checkout@v4\n-        with:\n-          ref: main\n-          repository: facebook/react-fbsource-import\n-          token: ${{secrets.FBSOURCE_SYNC_PUSH_TOKEN}}\n-      - name: Ensure clean directory\n-        run: rm -rf compiled-rn\n-      - uses: actions/download-artifact@v3\n-        with:\n-          name: compiled-rn\n-          path: compiled-rn/\n-      - run: git status -u\n-      - name: Check if only the REVISION file has changed\n-        id: check_should_commit\n-        run: |\n-          if git status --porcelain | grep -qv '/REVISION$'; then\n-            echo \"should_commit=true\" >> \"$GITHUB_OUTPUT\"\n-          else\n-            echo \"should_commit=false\" >> \"$GITHUB_OUTPUT\"\n-          fi\n-      - name: Commit changes to branch\n-        if: steps.check_should_commit.outputs.should_commit == 'true'\n-        uses: stefanzweifel/git-auto-commit-action@v4\n-        with:\n-          commit_message: |\n-            ${{ github.event.head_commit.message }}\n-\n-            DiffTrain build for commit https://github.com/facebook/react/commit/${{ github.sha }}.\n-          commit_user_name: ${{ github.actor }}\n-          commit_user_email: ${{ github.actor }}@users.noreply.github.com"
            },
            {
                "file": ".github/workflows/compiler_playground.yml",
                "git_diff": "@@ -0,0 +1,39 @@\n+name: (Compiler) Playground\n+\n+on:\n+  push:\n+    branches: [main]\n+  pull_request:\n+    paths:\n+      - compiler/**\n+      - .github/workflows/compiler-playground.yml\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+  # https://github.com/actions/cache/blob/main/tips-and-workarounds.md#cache-segment-restore-timeout\n+  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 1\n+\n+defaults:\n+  run:\n+    working-directory: compiler\n+\n+jobs:\n+  playground:\n+    name: Test playground\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: compiler/yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('compiler/**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: npx playwright install --with-deps chromium\n+      - run: yarn workspace playground test"
            },
            {
                "file": ".github/workflows/compiler_prereleases.yml",
                "git_diff": "@@ -0,0 +1,52 @@\n+name: (Compiler) Publish Prereleases\n+\n+on:\n+  workflow_call:\n+    inputs:\n+      commit_sha:\n+        required: true\n+        default: ''\n+        type: string\n+      release_channel:\n+        required: true\n+        type: string\n+      dist_tag:\n+        required: true\n+        type: string\n+    secrets:\n+      NPM_TOKEN:\n+        required: true\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+  # https://github.com/actions/cache/blob/main/tips-and-workarounds.md#cache-segment-restore-timeout\n+  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 1\n+  GH_TOKEN: ${{ github.token }}\n+  NPM_TOKEN: ${{ secrets.NPM_TOKEN }}\n+\n+defaults:\n+  run:\n+    working-directory: compiler\n+\n+jobs:\n+  publish_prerelease:\n+    name: Publish prelease (${{ inputs.release_channel }}) ${{ inputs.commit_sha }} @${{ inputs.dist_tag }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: compiler/yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('compiler/**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Publish packages to npm\n+        run: |\n+          cp ./scripts/release/ci-npmrc ~/.npmrc\n+          scripts/release/publish.js --frfr --ci --tags ${{ inputs.dist_tag }}"
            },
            {
                "file": ".github/workflows/compiler_prereleases_manual.yml",
                "git_diff": "@@ -0,0 +1,21 @@\n+name: (Compiler) Publish Prereleases Manual\n+\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      prerelease_commit_sha:\n+        required: false\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+\n+jobs:\n+  publish_prerelease_experimental:\n+    name: Publish to Experimental channel\n+    uses: facebook/react/.github/workflows/compiler_prereleases.yml@main\n+    with:\n+      commit_sha: ${{ inputs.prerelease_commit_sha || github.sha }}\n+      release_channel: experimental\n+      dist_tag: experimental\n+    secrets:\n+      NPM_TOKEN: ${{ secrets.NPM_TOKEN }}"
            },
            {
                "file": ".github/workflows/compiler_prereleases_nightly.yml",
                "git_diff": "@@ -0,0 +1,20 @@\n+name: (Compiler) Publish Prereleases Nightly\n+\n+on:\n+  schedule:\n+    # At 10 minutes past 16:00 on Mon, Tue, Wed, Thu, and Fri\n+    - cron: 10 16 * * 1,2,3,4,5\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+\n+jobs:\n+  publish_prerelease_experimental:\n+    name: Publish to Experimental channel\n+    uses: facebook/react/.github/workflows/compiler_prereleases.yml@main\n+    with:\n+      commit_sha: ${{ github.sha }}\n+      release_channel: experimental\n+      dist_tag: experimental\n+    secrets:\n+      NPM_TOKEN: ${{ secrets.NPM_TOKEN }}"
            },
            {
                "file": ".github/workflows/compiler_rust.yml",
                "git_diff": "@@ -0,0 +1,73 @@\n+name: (Compiler) Rust\n+\n+on:\n+  push:\n+    branches: [\"main\"]\n+    paths:\n+      - .github/workflows/**\n+      - compiler/crates/**\n+      - compiler/Cargo.*\n+      - compiler/*.toml\n+  pull_request:\n+    paths:\n+      - .github/workflows/**\n+      - compiler/crates/**\n+      - compiler/Cargo.*\n+      - compiler/*.toml\n+\n+env:\n+  CARGO_TERM_COLOR: always\n+  RUSTFLAGS: -Dwarnings\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+\n+defaults:\n+  run:\n+    working-directory: compiler\n+\n+jobs:\n+  test:\n+    name: Rust Test (${{ matrix.target.os }})\n+    strategy:\n+      matrix:\n+        target:\n+          - target: ubuntu-latest\n+            os: ubuntu-latest\n+          # TODO: run on more platforms\n+          # - target: macos-latest\n+          #   os: macos-latest\n+          # - target: windows-latest\n+          #   os: windows-latest\n+    runs-on: ${{ matrix.target.os }}\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: Swatinem/rust-cache@v2\n+      - name: cargo test\n+        run: cargo test --manifest-path=Cargo.toml --locked ${{ matrix.target.features && '--features' }} ${{ matrix.target.features }}\n+\n+  lint:\n+    name: Rust Lint\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions-rs/toolchain@v1\n+        with:\n+          # NOTE: use `rustup run <toolchain> <command>` in commands below\n+          # with this exact same toolchain value\n+          toolchain: nightly-2023-08-01\n+          override: true\n+          components: rustfmt, clippy\n+      - uses: Swatinem/rust-cache@v2\n+      - name: rustfmt\n+        run: grep -r --include \"*.rs\" --files-without-match \"@generated\" crates | xargs rustup run nightly-2023-08-01 rustfmt --check --config=\"skip_children=true\"\n+      # - name: cargo clippy\n+      #   run: rustup run nightly-2023-08-01 cargo clippy -- -Dclippy::correctness\n+\n+  build:\n+    name: Rust Build\n+    runs-on: ubuntu-latest\n+    # TODO: build on more platforms, deploy, etc\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: Swatinem/rust-cache@v2\n+      - name: cargo build\n+        run: cargo build --release"
            },
            {
                "file": ".github/workflows/compiler_typescript.yml",
                "git_diff": "@@ -0,0 +1,92 @@\n+name: (Compiler) TypeScript\n+\n+on:\n+  push:\n+    branches: [main]\n+  pull_request:\n+    paths:\n+      - compiler/**\n+      - .github/workflows/compiler_typescript.yml\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+  # https://github.com/actions/cache/blob/main/tips-and-workarounds.md#cache-segment-restore-timeout\n+  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 1\n+\n+defaults:\n+  run:\n+    working-directory: compiler\n+\n+jobs:\n+  discover_yarn_workspaces:\n+    name: Discover yarn workspaces\n+    runs-on: ubuntu-latest\n+    outputs:\n+      matrix: ${{ steps.set-matrix.outputs.matrix }}\n+    steps:\n+      - uses: actions/checkout@v4\n+      - id: set-matrix\n+        run: echo \"matrix=$(find packages -mindepth 1 -maxdepth 1 -type d | sed 's!packages/!!g' | tr '\\n' ',' | sed s/.$// | jq -Rsc '. / \",\" - [\"\"]')\" >> $GITHUB_OUTPUT\n+\n+  # Hardcoded to improve parallelism\n+  lint:\n+    name: Lint babel-plugin-react-compiler\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: compiler/yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('compiler/**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn workspace babel-plugin-react-compiler lint\n+\n+  # Hardcoded to improve parallelism\n+  jest:\n+    name: Jest babel-plugin-react-compiler\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: compiler/yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('compiler/**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn workspace babel-plugin-react-compiler jest\n+\n+  test:\n+    name: Test ${{ matrix.workspace_name }}\n+    needs: discover_yarn_workspaces\n+    runs-on: ubuntu-latest\n+    continue-on-error: true\n+    strategy:\n+      matrix:\n+        workspace_name: ${{ fromJSON(needs.discover_yarn_workspaces.outputs.matrix) }}\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: compiler/yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('compiler/**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn workspace ${{ matrix.workspace_name }} test"
            },
            {
                "file": ".github/workflows/devtools_check_repro.yml",
                "git_diff": "@@ -1,205 +0,0 @@\n-name: DevTools Check for bug repro\n-on:\n-  issues:\n-    types: [opened, edited]\n-  issue_comment:\n-    types: [created, edited]\n-\n-jobs:\n-  check-repro:\n-    runs-on: ubuntu-latest\n-    steps:\n-      - uses: actions/github-script@v3\n-        with:\n-          github-token: ${{ secrets.GITHUB_TOKEN }}\n-          script: |\n-            const URL_REGEXP = /### Website or app[\\r\\n]+([^#]+)###/m;\n-            const REPRO_STEPS_REGEXP = /### Repro steps[\\r\\n]+([^#]+)###/m;\n-            const LABEL_NEEDS_MORE_INFORMATION = \"Resolution: Needs More Information\";\n-            const LABEL_UNCONFIRMED = \"Status: Unconfirmed\";\n-\n-            function debug(...args) {\n-              core.info(args.map(JSON.stringify).join(' '));\n-            }\n-\n-            if (context.payload.comment) {\n-              debug('Ignoring comment update.');\n-              return;\n-            }\n-\n-            const user = context.payload.sender.login;\n-            const issue = context.payload.issue;\n-            const body = issue.body;\n-\n-            const urlMatch = body.match(URL_REGEXP);\n-            const reproStepsMatch = body.match(REPRO_STEPS_REGEXP);\n-\n-            const url = urlMatch !== null ? urlMatch[1].trim() : null;\n-            const reproSteps = reproStepsMatch !== null ? reproStepsMatch[1].trim() : null;\n-\n-            if (!url || !reproSteps) {\n-              debug('This issue is not a DevTools bug report.');\n-              return;\n-            }\n-\n-            debug(`found URL \"${url}\"`);\n-            debug(`found repro steps \"${reproSteps}\"`);\n-\n-            async function createComment(comment) {\n-              // Format\n-              comment = comment\n-                .split(\"\\n\")\n-                .map((line) => line.trim())\n-                .join(\"\\n\")\n-                .trim();\n-\n-              await github.issues.createComment({\n-                issue_number: context.issue.number,\n-                owner: context.repo.owner,\n-                repo: context.repo.repo,\n-                body: comment,\n-              });\n-            }\n-\n-            async function getGitHubActionComments() {\n-              debug(`Loading existing comments...`);\n-\n-              const comments = await github.issues.listComments({\n-                issue_number: context.issue.number,\n-                owner: context.repo.owner,\n-                repo: context.repo.repo,\n-              });\n-\n-              return comments.data.filter(comment => {\n-                debug(`comment by user: \"${comment.user.login}\"`);\n-                return comment.user.login === 'github-actions[bot]';\n-              });\n-            }\n-\n-            async function getIssueLabels() {\n-              const issues = await github.issues.listLabelsOnIssue({\n-                issue_number: context.issue.number,\n-                owner: context.repo.owner,\n-                repo: context.repo.repo,\n-              });\n-\n-              return issues.data;\n-            }\n-\n-            async function updateIssue(state, assignees = []) {\n-              await github.issues.update({\n-                issue_number: context.issue.number,\n-                owner: context.repo.owner,\n-                repo: context.repo.repo,\n-                state,\n-                assignees,\n-              });\n-            }\n-\n-            async function closeWithComment(comment) {\n-              if (issue.state !== 'open') {\n-                debug(`Issue is not open`);\n-                return;\n-              }\n-\n-              const labels = await getIssueLabels();\n-              const label = labels.find(label => label.name === LABEL_UNCONFIRMED);\n-              if (!label) {\n-                debug(`Issue was not opened via DevTools bug report template`);\n-                return;\n-              }\n-\n-              const comments = await getGitHubActionComments();\n-              if (comments.length > 0) {\n-                debug(`Already commented on issue; won't comment again`);\n-                return;\n-              }\n-\n-              debug(`Missing required information`);\n-\n-              await github.issues.addLabels({\n-                issue_number: context.issue.number,\n-                owner: context.repo.owner,\n-                repo: context.repo.repo,\n-                labels: [LABEL_NEEDS_MORE_INFORMATION],\n-              });\n-\n-              await createComment(comment);\n-              await updateIssue('closed', [user]);\n-            }\n-\n-            async function openWithComment(comment) {\n-              if (issue.state !== 'closed') {\n-                debug(`Issue is already open`);\n-                return;\n-              }\n-\n-              const labels = await getIssueLabels();\n-              const label = labels.find(label => label.name === LABEL_NEEDS_MORE_INFORMATION);\n-              if (!label) {\n-                debug(`Issue was not tagged as needs information`);\n-                return;\n-              }\n-\n-              const comments = await getGitHubActionComments();\n-              if (comments.length === 0) {\n-                debug(`Issue was closed by someone else; won't reopen`);\n-                return;\n-              }\n-\n-              debug(`Re-opening closed issue`);\n-\n-              await github.issues.removeLabel({\n-                issue_number: context.issue.number,\n-                owner: context.repo.owner,\n-                repo: context.repo.repo,\n-                name: LABEL_NEEDS_MORE_INFORMATION,\n-              });\n-\n-              await createComment(comment);\n-              await updateIssue('open');\n-            }\n-\n-            const PROBABLY_NOT_A_URL_REGEX = /(^Chrome$|^Firefox$| Website)/i;\n-\n-            const COMMENT_HEADER = `\n-              @${user}: We're sorry you've seen this error. \u2764\ufe0f\n-            `.trim();\n-\n-            const COMMENT_FOOTER = `\n-              Please help us by providing a link to a CodeSandbox (https://codesandbox.io/s/new), a repository on GitHub, or a minimal code example that reproduces the problem. (Screenshots or videos can also be helpful if they help provide context on how to repro the bug.)\n-\n-              Here are some tips for providing a minimal example: https://stackoverflow.com/help/mcve\n-\n-              Issues without repros are automatically closed but we will re-open if you update with repro info.\n-            `.trim();\n-\n-            if (url.includes(\"localhost\")) {\n-              closeWithComment(`\n-                ${COMMENT_HEADER}\n-\n-                Unfortunately the URL you provided (\"localhost\") is not publicly accessible. (This means that we will not be able to reproduce the problem you're reporting.)\n-\n-                ${COMMENT_FOOTER}\n-              `);\n-            } else if (url.length < 10 || url.match(PROBABLY_NOT_A_URL_REGEX)) {\n-              closeWithComment(`\n-                ${COMMENT_HEADER}\n-\n-                It looks like you forgot to specify a valid URL. (This means that we will not be able to reproduce the problem you're reporting.)\n-\n-                ${COMMENT_FOOTER}\n-              `);\n-            } else if (reproSteps.length < 25) {\n-              closeWithComment(`\n-                ${COMMENT_HEADER}\n-\n-                Unfortunately, it doesn't look like this issue has enough info for one of us to reproduce and fix it though.\n-\n-                ${COMMENT_FOOTER}\n-              `);\n-            } else {\n-              openWithComment(`\n-                Thank you for providing repro steps! Re-opening issue now for triage.\n-              `);\n-            }"
            },
            {
                "file": ".github/workflows/devtools_regression_tests.yml",
                "git_diff": "@@ -0,0 +1,173 @@\n+name: (DevTools) Regression Tests\n+\n+on:\n+  schedule:\n+    - cron: 0 0 * * *\n+  workflow_dispatch:\n+    inputs:\n+      commit_sha:\n+        required: false\n+        type: string\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+  # https://github.com/actions/cache/blob/main/tips-and-workarounds.md#cache-segment-restore-timeout\n+  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 1\n+\n+jobs:\n+  download_build:\n+    name: Download base build\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock', 'scripts/release/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn install --frozen-lockfile\n+        working-directory: scripts/release\n+      - name: Download react-devtools artifacts for base revision\n+        run: |\n+          git fetch origin main\n+          GH_TOKEN=${{ github.token }} scripts/release/download-experimental-build.js --commit=${{ inputs.commit_sha || '$(git rev-parse origin/main)' }}\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Archive build\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: build\n+          path: build\n+\n+  build_devtools_and_process_artifacts:\n+    name: Build DevTools and process artifacts\n+    needs: download_build\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          name: build\n+          path: build\n+      - run: ./scripts/ci/pack_and_store_devtools_artifacts.sh\n+        env:\n+          RELEASE_CHANNEL: experimental\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Archive devtools build\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: react-devtools\n+          path: build/devtools.tgz\n+      # Simplifies getting the extension for local testing\n+      - name: Archive chrome extension\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: react-devtools-chrome-extension\n+          path: build/devtools/chrome-extension.zip\n+      - name: Archive firefox extension\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: react-devtools-firefox-extension\n+          path: build/devtools/firefox-extension.zip\n+\n+  run_devtools_tests_for_versions:\n+    name: Run DevTools tests for versions\n+    needs: build_devtools_and_process_artifacts\n+    runs-on: ubuntu-latest\n+    strategy:\n+      matrix:\n+        version:\n+          - \"16.0\"\n+          - \"16.5\" # schedule package\n+          - \"16.8\" # hooks\n+          - \"17.0\"\n+          - \"18.0\"\n+    continue-on-error: true\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore all archived build artifacts\n+        uses: actions/download-artifact@v4\n+      - name: Display structure of build\n+        run: ls -R build\n+      - run: ./scripts/ci/download_devtools_regression_build.js ${{ matrix.version }} --replaceBuild\n+      - run: node ./scripts/jest/jest-cli.js --build --project devtools --release-channel=experimental --reactVersion ${{ matrix.version }} --ci\n+\n+  run_devtools_e2e_tests_for_versions:\n+    name: Run DevTools e2e tests for versions\n+    needs: build_devtools_and_process_artifacts\n+    runs-on: ubuntu-latest\n+    strategy:\n+      matrix:\n+        version:\n+          - \"16.0\"\n+          - \"16.5\" # schedule package\n+          - \"16.8\" # hooks\n+          - \"17.0\"\n+          - \"18.0\"\n+    continue-on-error: true\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore all archived build artifacts\n+        uses: actions/download-artifact@v4\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Playwright install deps\n+        run: |\n+          npx playwright install\n+          sudo npx playwright install-deps\n+      - run: ./scripts/ci/download_devtools_regression_build.js ${{ matrix.version }}\n+      - run: ls -R build-regression\n+      - run: ./scripts/ci/run_devtools_e2e_tests.js ${{ matrix.version }}\n+        env:\n+          RELEASE_CHANNEL: experimental\n+      - name: Cleanup build regression folder\n+        run: rm -r ./build-regression\n+      - uses: actions/upload-artifact@v4\n+        with:\n+          name: screenshots\n+          path: ./tmp/screenshots"
            },
            {
                "file": ".github/workflows/fuzz_tests.yml",
                "git_diff": "@@ -1,32 +0,0 @@\n-name: facebook/react/fuzz_tests\n-on:\n-  schedule:\n-  - cron: 0 * * * *\n-  push:\n-    branches:\n-      - main\n-  workflow_dispatch:\n-    inputs:\n-      prerelease_commit_sha:\n-        required: false\n-jobs:\n-  test_fuzz:\n-    if: inputs.prerelease_commit_sha == ''\n-    runs-on: ubuntu-latest\n-    env:\n-      TZ: \"/usr/share/zoneinfo/America/Los_Angeles\"\n-    steps:\n-    - uses: actions/checkout@v4.1.0\n-    - uses: actions/setup-node@v4\n-      with:\n-        node-version-file: '.nvmrc'\n-        cache: 'yarn'\n-    - name: Install dependencies\n-      run: yarn install --frozen-lockfile\n-      env:\n-        ELECTRON_SKIP_BINARY_DOWNLOAD: \"1\"\n-      shell: bash\n-    - name: Run fuzz tests\n-      run: |-\n-        FUZZ_TEST_SEED=$RANDOM yarn test fuzz --ci\n-        FUZZ_TEST_SEED=$RANDOM yarn test --prod fuzz --ci"
            },
            {
                "file": ".github/workflows/runtime_build_and_test.yml",
                "git_diff": "@@ -0,0 +1,611 @@\n+name: (Runtime) Build and Test\n+\n+on:\n+  push:\n+    branches: [main]\n+  pull_request:\n+    paths-ignore:\n+      - compiler/**\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+  # https://github.com/actions/cache/blob/main/tips-and-workarounds.md#cache-segment-restore-timeout\n+  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 1\n+\n+jobs:\n+  # ----- FLOW -----\n+  discover_flow_inline_configs:\n+    name: Discover flow inline configs\n+    runs-on: ubuntu-latest\n+    outputs:\n+      matrix: ${{ steps.set-matrix.outputs.result }}\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/github-script@v7\n+        id: set-matrix\n+        with:\n+          script: |\n+            const inlinedHostConfigs = require('./scripts/shared/inlinedHostConfigs.js');\n+            return inlinedHostConfigs.map(config => config.shortName);\n+\n+  flow:\n+    name: Flow check ${{ matrix.flow_inline_config_shortname }}\n+    needs: discover_flow_inline_configs\n+    runs-on: ubuntu-latest\n+    continue-on-error: true\n+    strategy:\n+      matrix:\n+        flow_inline_config_shortname: ${{ fromJSON(needs.discover_flow_inline_configs.outputs.matrix) }}\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: node ./scripts/tasks/flow-ci ${{ matrix.flow_inline_config_shortname }}\n+\n+  # ----- FIZZ -----\n+  check_generated_fizz_runtime:\n+    name: Confirm generated inline Fizz runtime is up to date\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: |\n+          yarn generate-inline-fizz-runtime\n+          git diff --quiet || (echo \"There was a change to the Fizz runtime. Run `yarn generate-inline-fizz-runtime` and check in the result.\" && false)\n+\n+  # ----- FEATURE FLAGS -----\n+  flags:\n+    name: Check flags\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn flags\n+\n+  # ----- TESTS -----\n+  test:\n+    name: yarn test ${{ matrix.params }} (Shard ${{ matrix.shard }})\n+    runs-on: ubuntu-latest\n+    strategy:\n+      matrix:\n+        params:\n+          - \"-r=stable --env=development\"\n+          - \"-r=stable --env=production\"\n+          - \"-r=experimental --env=development\"\n+          - \"-r=experimental --env=production\"\n+          - \"-r=www-classic --env=development --variant=false\"\n+          - \"-r=www-classic --env=production --variant=false\"\n+          - \"-r=www-classic --env=development --variant=true\"\n+          - \"-r=www-classic --env=production --variant=true\"\n+          - \"-r=www-modern --env=development --variant=false\"\n+          - \"-r=www-modern --env=production --variant=false\"\n+          - \"-r=www-modern --env=development --variant=true\"\n+          - \"-r=www-modern --env=production --variant=true\"\n+          - \"-r=xplat --env=development --variant=false\"\n+          - \"-r=xplat --env=development --variant=true\"\n+          - \"-r=xplat --env=production --variant=false\"\n+          - \"-r=xplat --env=production --variant=true\"\n+          # TODO: Test more persistent configurations?\n+          - \"-r=stable --env=development --persistent\"\n+          - \"-r=experimental --env=development --persistent\"\n+        shard:\n+          - 1/5\n+          - 2/5\n+          - 3/5\n+          - 4/5\n+          - 5/5\n+    continue-on-error: true\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn test ${{ matrix.params }} --ci --shard=${{ matrix.shard }}\n+\n+  # ----- BUILD -----\n+  build_and_lint:\n+    name: yarn build and lint\n+    runs-on: ubuntu-latest\n+    strategy:\n+      matrix:\n+        # yml is dumb. update the --total arg to yarn build if you change the number of workers\n+        worker_id: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]\n+        release_channel: [stable, experimental]\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - uses: actions/setup-java@v4\n+        with:\n+          distribution: temurin\n+          java-version: 11.0.22\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn build --index=${{ matrix.worker_id }} --total=20 --r=${{ matrix.release_channel }} --ci\n+        env:\n+          CI: github\n+          RELEASE_CHANNEL: ${{ matrix.release_channel }}\n+          NODE_INDEX: ${{ matrix.worker_id }}\n+      - name: Lint build\n+        run: yarn lint-build\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Archive build\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: _build_${{ matrix.worker_id }}_${{ matrix.release_channel }}\n+          path: build\n+\n+  test_build:\n+    name: yarn test-build\n+    needs: build_and_lint\n+    strategy:\n+      matrix:\n+        test_params: [\n+          # Intentionally passing these as strings instead of creating a\n+          # separate parameter per CLI argument, since it's easier to\n+          # control/see which combinations we want to run.\n+          -r=stable --env=development,\n+          -r=stable --env=production,\n+          -r=experimental --env=development,\n+          -r=experimental --env=production,\n+\n+          # Dev Tools\n+          --project=devtools -r=experimental,\n+\n+          # TODO: Update test config to support www build tests\n+          # - \"-r=www-classic --env=development --variant=false\"\n+          # - \"-r=www-classic --env=production --variant=false\"\n+          # - \"-r=www-classic --env=development --variant=true\"\n+          # - \"-r=www-classic --env=production --variant=true\"\n+          # - \"-r=www-modern --env=development --variant=false\"\n+          # - \"-r=www-modern --env=production --variant=false\"\n+          # - \"-r=www-modern --env=development --variant=true\"\n+          # - \"-r=www-modern --env=production --variant=true\"\n+\n+          # TODO: Update test config to support xplat build tests\n+          # - \"-r=xplat --env=development --variant=false\"\n+          # - \"-r=xplat --env=development --variant=true\"\n+          # - \"-r=xplat --env=production --variant=false\"\n+          # - \"-r=xplat --env=production --variant=true\"\n+\n+          # TODO: Test more persistent configurations?\n+        ]\n+        shard:\n+          - 1/3\n+          - 2/3\n+          - 3/3\n+    continue-on-error: true\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - name: Display structure of build\n+        run: ls -R build\n+      - run: yarn test --build ${{ matrix.test_params }} --shard=${{ matrix.shard }} --ci\n+\n+  process_artifacts_combined:\n+    name: Process artifacts combined\n+    needs: build_and_lint\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - name: Display structure of build\n+        run: ls -R build\n+      - run: echo ${{ github.sha }} >> build/COMMIT_SHA\n+      - name: Scrape warning messages\n+        run: |\n+          mkdir -p ./build/__test_utils__\n+          node ./scripts/print-warnings/print-warnings.js > build/__test_utils__/ReactAllWarnings.js\n+        # Compress build directory into a single tarball for easy download\n+      - run: tar -zcvf ./build.tgz ./build\n+        # TODO: Migrate scripts to use `build` directory instead of `build2`\n+      - run: cp ./build.tgz ./build2.tgz\n+      - name: Archive build artifacts\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: artifacts_combined\n+          path: |\n+            ./build.tgz\n+            ./build2.tgz\n+\n+  check_error_codes:\n+    name: Search build artifacts for unminified errors\n+    needs: build_and_lint\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Search build artifacts for unminified errors\n+        run: |\n+          yarn extract-errors\n+          git diff --quiet || (echo \"Found unminified errors. Either update the error codes map or disable error minification for the affected build, if appropriate.\" && false)\n+\n+  check_release_dependencies:\n+    name: Check release dependencies\n+    needs: build_and_lint\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - name: Display structure of build\n+        run: ls -R build\n+      - run: yarn check-release-dependencies\n+\n+  RELEASE_CHANNEL_stable_yarn_test_dom_fixtures:\n+    name: Check fixtures DOM (stable)\n+    needs: build_and_lint\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: v2-yarn_cache_fixtures_dom-${{ runner.arch }}-${{ runner.os }}-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n+        working-directory: fixtures/dom\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Run DOM fixture tests\n+        run: |\n+          yarn predev\n+          yarn test\n+        working-directory: fixtures/dom\n+        env:\n+          RELEASE_CHANNEL: stable\n+\n+  # ----- FLIGHT -----\n+  run_fixtures_flight_tests:\n+    name: Run fixtures Flight tests\n+    needs: build_and_lint\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      # Fixture copies some built packages from the workroot after install.\n+      # That means dependencies of the built packages are not installed.\n+      # We need to install dependencies of the workroot to fulfill all dependency constraints\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: v2-yarn_cache_fixtures_flight-${{ runner.arch }}-${{ runner.os }}-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Install fixture dependencies\n+        working-directory: fixtures/flight\n+        run: |\n+          yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n+          if [ $? -ne 0 ]; then\n+            yarn install --frozen-lockfile --cache-folder ~/.cache/yarn\n+          fi\n+      - name: Playwright install deps\n+        working-directory: fixtures/flight\n+        run: |\n+          npx playwright install\n+          sudo npx playwright install-deps\n+      - name: Run tests\n+        working-directory: fixtures/flight\n+        run: yarn test\n+        env:\n+          # Otherwise the webserver is a blackbox\n+          DEBUG: pw:webserver\n+      - name: Archive Flight fixture artifacts\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: flight-playwright-report\n+          path: fixtures/flight/playwright-report\n+      - name: Archive Flight fixture artifacts\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: flight-test-results\n+          path: fixtures/flight/test-results\n+\n+  # ----- DEVTOOLS -----\n+  build_devtools_and_process_artifacts:\n+    name: Build DevTools and process artifacts\n+    needs: build_and_lint\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - run: ./scripts/ci/pack_and_store_devtools_artifacts.sh\n+        env:\n+          RELEASE_CHANNEL: experimental\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Archive devtools build\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: react-devtools\n+          path: build/devtools.tgz\n+      # Simplifies getting the extension for local testing\n+      - name: Archive chrome extension\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: react-devtools-chrome-extension\n+          path: build/devtools/chrome-extension.zip\n+      - name: Archive firefox extension\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: react-devtools-firefox-extension\n+          path: build/devtools/firefox-extension.zip\n+\n+  run_devtools_e2e_tests:\n+    name: Run DevTools e2e tests\n+    needs: build_devtools_and_process_artifacts\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - run: |\n+          npx playwright install\n+          sudo npx playwright install-deps\n+      - run: ./scripts/ci/run_devtools_e2e_tests.js\n+        env:\n+          RELEASE_CHANNEL: experimental\n+\n+  # ----- SIZEBOT -----\n+  download_base_build_for_sizebot:\n+    if: ${{ github.event_name == 'pull_request' && github.ref_name != 'main' }}\n+    name: Download base build for sizebot\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock', 'scripts/release/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn install --frozen-lockfile\n+        working-directory: scripts/release\n+      - name: Download artifacts for base revision\n+        run: |\n+          git fetch origin main\n+          GH_TOKEN=${{ github.token }} scripts/release/download-experimental-build.js --commit=$(git rev-parse origin/main)\n+          mv ./build ./base-build\n+      # TODO: The `download-experimental-build` script copies the npm\n+      # packages into the `node_modules` directory. This is a historical\n+      # quirk of how the release script works. Let's pretend they\n+      # don't exist.\n+      - name: Delete extraneous files\n+        run: rm -rf ./base-build/node_modules\n+      - name: Display structure of base-build\n+        run: ls -R base-build\n+      - name: Archive base-build\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: base-build\n+          path: base-build\n+\n+  sizebot:\n+    name: Run sizebot\n+    needs: [build_and_lint, download_base_build_for_sizebot]\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - name: Restore archived build for PR\n+        uses: actions/download-artifact@v4\n+        with:\n+          pattern: _build_*\n+          path: build\n+          merge-multiple: true\n+      - name: Scrape warning messages\n+        run: |\n+          mkdir -p ./build/__test_utils__\n+          node ./scripts/print-warnings/print-warnings.js > build/__test_utils__/ReactAllWarnings.js\n+      - name: Display structure of build for PR\n+        run: ls -R build\n+      - name: Restore archived base-build from origin/main\n+        uses: actions/download-artifact@v4\n+        with:\n+          name: base-build\n+          path: base-build\n+      - name: Display structure of base-build from origin/main\n+        run: ls -R base-build\n+      - run: echo ${{ github.sha }} >> build/COMMIT_SHA\n+      - run: node ./scripts/tasks/danger\n+      - name: Archive sizebot results\n+        uses: actions/upload-artifact@v4\n+        with:\n+          name: sizebot-message\n+          path: sizebot-message.md"
            },
            {
                "file": ".github/workflows/runtime_commit_artifacts.yml",
                "git_diff": "@@ -0,0 +1,405 @@\n+name: (Runtime) Commit Artifacts for Meta WWW and fbsource V2\n+\n+on:\n+  workflow_run:\n+    workflows: [\"(Runtime) Build and Test\"]\n+    types: [completed]\n+    branches:\n+      - main\n+  workflow_dispatch:\n+    inputs:\n+      commit_sha:\n+        required: false\n+        type: string\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+  # https://github.com/actions/cache/blob/main/tips-and-workarounds.md#cache-segment-restore-timeout\n+  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 1\n+\n+jobs:\n+  download_artifacts:\n+    runs-on: ubuntu-latest\n+    outputs:\n+      www_branch_count: ${{ steps.check_branches.outputs.www_branch_count }}\n+      fbsource_branch_count: ${{ steps.check_branches.outputs.fbsource_branch_count }}\n+      last_version_classic: ${{ steps.get_last_version_www.outputs.last_version_classic }}\n+      last_version_modern: ${{ steps.get_last_version_www.outputs.last_version_modern }}\n+      last_version_rn: ${{ steps.get_last_version_rn.outputs.last_version_rn }}\n+      current_version_classic: ${{ steps.get_current_version.outputs.current_version_classic }}\n+      current_version_modern: ${{ steps.get_current_version.outputs.current_version_modern }}\n+      current_version_rn: ${{ steps.get_current_version.outputs.current_version_rn }}\n+    steps:\n+      - uses: actions/checkout@v4\n+        with:\n+          ref: builds/facebook-www\n+      - name: \"Get last version string for www\"\n+        id: get_last_version_www\n+        run: |\n+          # Empty checks only needed for backwards compatibility,can remove later.\n+          VERSION_CLASSIC=$( [ -f ./compiled/facebook-www/VERSION_CLASSIC ] && cat ./compiled/facebook-www/VERSION_CLASSIC || echo '' )\n+          VERSION_MODERN=$( [ -f ./compiled/facebook-www/VERSION_MODERN ] && cat ./compiled/facebook-www/VERSION_MODERN || echo '' )\n+          echo \"Last classic version is $VERSION_CLASSIC\"\n+          echo \"Last modern version is $VERSION_MODERN\"\n+          echo \"last_version_classic=$VERSION_CLASSIC\" >> \"$GITHUB_OUTPUT\"\n+          echo \"last_version_modern=$VERSION_MODERN\" >> \"$GITHUB_OUTPUT\"\n+      - uses: actions/checkout@v4\n+        with:\n+          ref: builds/facebook-fbsource\n+      - name: \"Get last version string for rn\"\n+        id: get_last_version_rn\n+        run: |\n+          # Empty checks only needed for backwards compatibility,can remove later.\n+          VERSION_NATIVE_FB=$( [ -f ./compiled-rn/VERSION_NATIVE_FB ] && cat ./compiled-rn/VERSION_NATIVE_FB || echo '' )\n+          echo \"Last rn version is $VERSION_NATIVE_FB\"\n+          echo \"last_version_rn=$VERSION_NATIVE_FB\" >> \"$GITHUB_OUTPUT\"\n+      - uses: actions/checkout@v4\n+      - name: \"Check branches\"\n+        id: check_branches\n+        run: |\n+          echo \"www_branch_count=$(git ls-remote --heads origin \"refs/heads/meta-www\" | wc -l)\" >> \"$GITHUB_OUTPUT\"\n+          echo \"fbsource_branch_count=$(git ls-remote --heads origin \"refs/heads/meta-fbsource\" | wc -l)\" >> \"$GITHUB_OUTPUT\"\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock', 'scripts/release/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+        name: yarn install (react)\n+      - run: yarn install --frozen-lockfile\n+        name: yarn install (scripts/release)\n+        working-directory: scripts/release\n+      - name: Download artifacts for base revision\n+        run: |\n+          GH_TOKEN=${{ github.token }} scripts/release/download-experimental-build.js --commit=${{ inputs.commit_sha || github.event.workflow_run.head_sha }}\n+      - name: Display structure of build\n+        run: ls -R build\n+      - name: Strip @license from eslint plugin and react-refresh\n+        run: |\n+          sed -i -e 's/ @license React*//' \\\n+            build/oss-experimental/eslint-plugin-react-hooks/cjs/eslint-plugin-react-hooks.development.js \\\n+            build/oss-experimental/react-refresh/cjs/react-refresh-babel.development.js\n+      - name: Insert @headers into eslint plugin and react-refresh\n+        run: |\n+          sed -i -e 's/ LICENSE file in the root directory of this source tree./ LICENSE file in the root directory of this source tree.\\n *\\n * @noformat\\n * @nolint\\n * @lightSyntaxTransform\\n * @preventMunge\\n * @oncall react_core/' \\\n+            build/oss-experimental/eslint-plugin-react-hooks/cjs/eslint-plugin-react-hooks.development.js \\\n+            build/oss-experimental/react-refresh/cjs/react-refresh-babel.development.js\n+      - name: Move relevant files for React in www into compiled\n+        run: |\n+          # Move the facebook-www folder into compiled\n+          mkdir ./compiled\n+          mv build/facebook-www ./compiled\n+\n+          # Move ReactAllWarnings.js to facebook-www\n+          mkdir ./compiled/facebook-www/__test_utils__\n+          mv build/__test_utils__/ReactAllWarnings.js ./compiled/facebook-www/__test_utils__/ReactAllWarnings.js\n+\n+          # Move eslint-plugin-react-hooks into facebook-www\n+          mv build/oss-experimental/eslint-plugin-react-hooks/cjs/eslint-plugin-react-hooks.development.js \\\n+            ./compiled/facebook-www/eslint-plugin-react-hooks.js\n+\n+          # Move unstable_server-external-runtime.js into facebook-www\n+          mv build/oss-experimental/react-dom/unstable_server-external-runtime.js \\\n+            ./compiled/facebook-www/unstable_server-external-runtime.js\n+\n+          # Move react-refresh-babel.development.js into babel-plugin-react-refresh\n+          mkdir ./compiled/babel-plugin-react-refresh\n+          mv build/oss-experimental/react-refresh/cjs/react-refresh-babel.development.js \\\n+            ./compiled/babel-plugin-react-refresh/index.js\n+\n+          ls -R ./compiled\n+      - name: Move relevant files for React in fbsource into compiled-rn\n+        run: |\n+          BASE_FOLDER='compiled-rn/facebook-fbsource/xplat/js'\n+          mkdir -p ${BASE_FOLDER}/react-native-github/Libraries/Renderer/\n+          mkdir -p ${BASE_FOLDER}/RKJSModules/vendor/react/{scheduler,react,react-is,react-test-renderer}/\n+\n+          # Move React Native renderer\n+          mv build/react-native/implementations/ $BASE_FOLDER/react-native-github/Libraries/Renderer/\n+          mv build/react-native/shims/ $BASE_FOLDER/react-native-github/Libraries/Renderer/\n+          mv build/facebook-react-native/scheduler/cjs/ $BASE_FOLDER/RKJSModules/vendor/react/scheduler/\n+          mv build/facebook-react-native/react/cjs/ $BASE_FOLDER/RKJSModules/vendor/react/react/\n+          mv build/facebook-react-native/react-is/cjs/ $BASE_FOLDER/RKJSModules/vendor/react/react-is/\n+          mv build/facebook-react-native/react-test-renderer/cjs/ $BASE_FOLDER/RKJSModules/vendor/react/react-test-renderer/\n+\n+          # Delete OSS renderer. OSS renderer is synced through internal script.\n+          RENDERER_FOLDER=$BASE_FOLDER/react-native-github/Libraries/Renderer/implementations/\n+          rm $RENDERER_FOLDER/ReactFabric-{dev,prod,profiling}.js\n+          rm $RENDERER_FOLDER/ReactNativeRenderer-{dev,prod,profiling}.js\n+\n+          # Move React Native version file\n+          mv build/facebook-react-native/VERSION_NATIVE_FB ./compiled-rn/VERSION_NATIVE_FB\n+\n+          ls -R ./compiled-rn\n+      - name: Add REVISION files\n+        run: |\n+          echo ${{ github.event.workflow_run.head_sha }} >> ./compiled/facebook-www/REVISION\n+          cp ./compiled/facebook-www/REVISION ./compiled/facebook-www/REVISION_TRANSFORMS\n+          echo ${{ github.event.workflow_run.head_sha}} >> ./compiled-rn/facebook-fbsource/xplat/js/react-native-github/Libraries/Renderer/REVISION\n+      - name: \"Get current version string\"\n+        id: get_current_version\n+        run: |\n+          VERSION_CLASSIC=$(cat ./compiled/facebook-www/VERSION_CLASSIC)\n+          VERSION_MODERN=$(cat ./compiled/facebook-www/VERSION_MODERN)\n+          VERSION_NATIVE_FB=$(cat ./compiled-rn/VERSION_NATIVE_FB)\n+          echo \"Current classic version is $VERSION_CLASSIC\"\n+          echo \"Current modern version is $VERSION_MODERN\"\n+          echo \"Current rn version is $VERSION_NATIVE_FB\"\n+          echo \"current_version_classic=$VERSION_CLASSIC\" >> \"$GITHUB_OUTPUT\"\n+          echo \"current_version_modern=$VERSION_MODERN\" >> \"$GITHUB_OUTPUT\"\n+          echo \"current_version_rn=$VERSION_NATIVE_FB\" >> \"$GITHUB_OUTPUT\"\n+      - uses: actions/upload-artifact@v4\n+        with:\n+          name: compiled\n+          path: compiled/\n+      - uses: actions/upload-artifact@v4\n+        with:\n+          name: compiled-rn\n+          path: compiled-rn/\n+\n+  commit_www_artifacts:\n+    needs: download_artifacts\n+    if: ${{ (github.ref == 'refs/heads/main' && needs.download_artifacts.outputs.www_branch_count == '0') || github.ref == 'refs/heads/meta-www' }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+        with:\n+          ref: builds/facebook-www\n+      - name: Ensure clean directory\n+        run: rm -rf compiled\n+      - uses: actions/download-artifact@v4\n+        with:\n+          name: compiled\n+          path: compiled/\n+      - name: Revert version changes\n+        if: needs.download_artifacts.outputs.last_version_classic != '' && needs.download_artifacts.outputs.last_version_modern != ''\n+        env:\n+          CURRENT_VERSION_CLASSIC: ${{ needs.download_artifacts.outputs.current_version_classic }}\n+          CURRENT_VERSION_MODERN: ${{ needs.download_artifacts.outputs.current_version_modern }}\n+          LAST_VERSION_CLASSIC: ${{ needs.download_artifacts.outputs.last_version_classic }}\n+          LAST_VERSION_MODERN: ${{ needs.download_artifacts.outputs.last_version_modern }}\n+        run: |\n+          echo \"Reverting $CURRENT_VERSION_CLASSIC to $LAST_VERSION_CLASSIC\"\n+          grep -rl \"$CURRENT_VERSION_CLASSIC\" ./compiled || echo \"No files found with $CURRENT_VERSION_CLASSIC\"\n+          grep -rl \"$CURRENT_VERSION_CLASSIC\" ./compiled | xargs -r sed -i -e \"s/$CURRENT_VERSION_CLASSIC/$LAST_VERSION_CLASSIC/g\"\n+          grep -rl \"$CURRENT_VERSION_CLASSIC\" ./compiled || echo \"Classic version reverted\"\n+          echo \"====================\"\n+          echo \"Reverting $CURRENT_VERSION_MODERN to $LAST_VERSION_MODERN\"\n+          grep -rl \"$CURRENT_VERSION_MODERN\" ./compiled || echo \"No files found with $CURRENT_VERSION_MODERN\"\n+          grep -rl \"$CURRENT_VERSION_MODERN\" ./compiled | xargs -r sed -i -e \"s/$CURRENT_VERSION_MODERN/$LAST_VERSION_MODERN/g\"\n+          grep -rl \"$CURRENT_VERSION_MODERN\" ./compiled || echo \"Modern version reverted\"\n+      - name: Check for changes\n+        id: check_should_commit\n+        run: |\n+          echo \"Full git status\"\n+          git add .\n+          git status\n+          echo \"====================\"\n+          if git status --porcelain | grep -qv '/REVISION'; then\n+            echo \"Changes detected\"\n+            echo \"===== Changes =====\"\n+            git --no-pager diff -U0 | grep '^[+-]' | head -n 50\n+            echo \"===================\"\n+            echo \"should_commit=true\" >> \"$GITHUB_OUTPUT\"\n+          else\n+            echo \"No Changes detected\"\n+            echo \"should_commit=false\" >> \"$GITHUB_OUTPUT\"\n+          fi\n+      - name: Re-apply version changes\n+        if: steps.check_should_commit.outputs.should_commit == 'true' && needs.download_artifacts.outputs.last_version_classic != '' && needs.download_artifacts.outputs.last_version_modern != ''\n+        env:\n+          CURRENT_VERSION_CLASSIC: ${{ needs.download_artifacts.outputs.current_version_classic }}\n+          CURRENT_VERSION_MODERN: ${{ needs.download_artifacts.outputs.current_version_modern }}\n+          LAST_VERSION_CLASSIC: ${{ needs.download_artifacts.outputs.last_version_classic }}\n+          LAST_VERSION_MODERN: ${{ needs.download_artifacts.outputs.last_version_modern }}\n+        run: |\n+          echo \"Re-applying $LAST_VERSION_CLASSIC to $CURRENT_VERSION_CLASSIC\"\n+          grep -rl \"$LAST_VERSION_CLASSIC\" ./compiled || echo \"No files found with $LAST_VERSION_CLASSIC\"\n+          grep -rl \"$LAST_VERSION_CLASSIC\" ./compiled | xargs -r sed -i -e \"s/$LAST_VERSION_CLASSIC/$CURRENT_VERSION_CLASSIC/g\"\n+          grep -rl \"$LAST_VERSION_CLASSIC\" ./compiled || echo \"Classic version re-applied\"\n+          echo \"====================\"\n+          echo \"Re-applying $LAST_VERSION_MODERN to $CURRENT_VERSION_MODERN\"\n+          grep -rl \"$LAST_VERSION_MODERN\" ./compiled || echo \"No files found with $LAST_VERSION_MODERN\"\n+          grep -rl \"$LAST_VERSION_MODERN\" ./compiled | xargs -r sed -i -e \"s/$LAST_VERSION_MODERN/$CURRENT_VERSION_MODERN/g\"\n+          grep -rl \"$LAST_VERSION_MODERN\" ./compiled || echo \"Classic version re-applied\"\n+      - name: Will commit these changes\n+        if: steps.check_should_commit.outputs.should_commit == 'true'\n+        run: |\n+          echo \":\"\n+          git status -u\n+      - name: Commit changes to branch\n+        if: steps.check_should_commit.outputs.should_commit == 'true'\n+        uses: stefanzweifel/git-auto-commit-action@v4\n+        with:\n+          commit_message: |\n+            ${{ github.event.workflow_run.head_commit.message }}\n+\n+            DiffTrain build for [${{ github.event.workflow_run.head_sha }}](https://github.com/facebook/react/commit/${{ github.event.workflow_run.head_sha }})\n+          branch: builds/facebook-www\n+          commit_user_name: ${{ github.event.workflow_run.triggering_actor.login }}\n+          commit_user_email: ${{ github.event.workflow_run.triggering_actor.email || format('{0}@users.noreply.github.com', github.event.workflow_run.triggering_actor.login) }}\n+          create_branch: true\n+\n+  commit_fbsource_artifacts:\n+    needs: download_artifacts\n+    if: ${{ (github.ref == 'refs/heads/main' && needs.download_artifacts.outputs.fbsource_branch_count == '0') || github.ref == 'refs/heads/meta-fbsource' }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+        with:\n+          ref: builds/facebook-fbsource\n+      - name: Ensure clean directory\n+        run: rm -rf compiled-rn\n+      - uses: actions/download-artifact@v4\n+        with:\n+          name: compiled-rn\n+          path: compiled-rn/\n+      - name: Revert version changes\n+        if: needs.download_artifacts.outputs.last_version_rn != ''\n+        env:\n+          CURRENT_VERSION: ${{ needs.download_artifacts.outputs.current_version_rn }}\n+          LAST_VERSION: ${{ needs.download_artifacts.outputs.last_version_rn }}\n+        run: |\n+          echo \"Reverting $CURRENT_VERSION to $LAST_VERSION\"\n+          grep -rl \"$CURRENT_VERSION\" ./compiled-rn || echo \"No files found with $CURRENT_VERSION\"\n+          grep -rl \"$CURRENT_VERSION\" ./compiled-rn | xargs -r sed -i -e \"s/$CURRENT_VERSION/$LAST_VERSION/g\"\n+          grep -rl \"$CURRENT_VERSION\" ./compiled-rn || echo \"Version reverted\"\n+      - name: Check for changes\n+        id: check_should_commit\n+        run: |\n+          echo \"Full git status\"\n+          git add .\n+          git --no-pager diff -U0 --cached | grep '^[+-]' | head -n 100\n+          echo \"====================\"\n+          # Ignore REVISION or lines removing @generated headers.\n+          if git diff --cached ':(exclude)*REVISION' | grep -vE \"^(@@|diff|index|\\-\\-\\-|\\+\\+\\+|\\- \\* @generated SignedSource)\" | grep \"^[+-]\" > /dev/null; then\n+            echo \"Changes detected\"\n+            echo \"===== Changes =====\"\n+            git --no-pager diff --cached ':(exclude)*REVISION' | grep -vE \"^(@@|diff|index|\\-\\-\\-|\\+\\+\\+|\\- \\* @generated SignedSource)\" | grep \"^[+-]\" | head -n 50\n+            echo \"===================\"\n+            echo \"should_commit=true\" >> \"$GITHUB_OUTPUT\"\n+          else\n+            echo \"No Changes detected\"\n+            echo \"should_commit=false\" >> \"$GITHUB_OUTPUT\"\n+          fi\n+      - name: Re-apply version changes\n+        if: steps.check_should_commit.outputs.should_commit == 'true' && needs.download_artifacts.outputs.last_version_rn != ''\n+        env:\n+          CURRENT_VERSION: ${{ needs.download_artifacts.outputs.current_version_rn }}\n+          LAST_VERSION: ${{ needs.download_artifacts.outputs.last_version_rn }}\n+        run: |\n+          echo \"Re-applying $LAST_VERSION to $CURRENT_VERSION\"\n+          grep -rl \"$LAST_VERSION\" ./compiled-rn || echo \"No files found with $LAST_VERSION\"\n+          grep -rl \"$LAST_VERSION\" ./compiled-rn | xargs -r sed -i -e \"s/$LAST_VERSION/$CURRENT_VERSION/g\"\n+          grep -rl \"$LAST_VERSION\" ./compiled-rn || echo \"Version re-applied\"\n+      - name: Add files for signing\n+        if: steps.check_should_commit.outputs.should_commit == 'true'\n+        run: |\n+          echo \":\"\n+          git add .\n+      - name: Signing files\n+        if: steps.check_should_commit.outputs.should_commit == 'true'\n+        uses: actions/github-script@v7\n+        with:\n+          script: |\n+            // TODO: Move this to a script file.\n+            // We currently can't call scripts from the repo because\n+            // at this point in the workflow, we're on the compiled\n+            // artifact branch (so the scripts don't exist).\n+            // We can fix this with a composite action in the main repo.\n+            // This script is duplicated above.\n+            const fs = require('fs');\n+            const crypto = require('crypto');\n+            const {execSync} = require('child_process');\n+\n+            // TODO: when we move this to a script, we can use this from npm.\n+            // Copy of signedsource since we can't install deps on this branch.\n+            const GENERATED = '@' + 'generated';\n+            const NEWTOKEN = '<<SignedSource::*O*zOeWoEQle#+L!plEphiEmie@IsG>>';\n+            const PATTERN = new RegExp(`${GENERATED} (?:SignedSource<<([a-f0-9]{32})>>)`);\n+\n+            const TokenNotFoundError = new Error(\n+              `SignedSource.signFile(...): Cannot sign file without token: ${NEWTOKEN}`\n+            );\n+\n+            function hash(data, encoding) {\n+              const md5sum = crypto.createHash('md5');\n+              md5sum.update(data, encoding);\n+              return md5sum.digest('hex');\n+            }\n+\n+            const SignedSource = {\n+              getSigningToken() {\n+                return `${GENERATED} ${NEWTOKEN}`;\n+              },\n+              isSigned(data) {\n+                return PATTERN.exec(data) != null;\n+              },\n+              signFile(data) {\n+                if (!data.includes(NEWTOKEN)) {\n+                  if (SignedSource.isSigned(data)) {\n+                    // Signing a file that was previously signed.\n+                   data = data.replace(PATTERN, SignedSource.getSigningToken());\n+                  } else {\n+                    throw TokenNotFoundError;\n+                  }\n+                }\n+                return data.replace(NEWTOKEN, `SignedSource<<${hash(data, 'utf8')}>>`);\n+              },\n+            };\n+\n+            const directory = './compiled-rn';\n+            console.log('Signing files in directory:', directory);\n+            try {\n+              const result = execSync(`git status --porcelain ${directory}`, {encoding: 'utf8'});\n+\n+              // Parse the git status output to get file paths\n+              const files = result.split('\\n').filter(file => file.endsWith('.js'));\n+\n+              if (files.length === 0) {\n+                throw new Error(\n+                  'git status returned no files to sign. this job should not have run.'\n+                );\n+              } else {\n+                files.forEach(line => {\n+                  const file = line.slice(3).trim();\n+                  if (file) {\n+                    console.log('  Signing file:', file);\n+                    const originalContents = fs.readFileSync(file, 'utf8');\n+                    const signedContents = SignedSource.signFile(\n+                      originalContents\n+                        // Need to add the header in, since it's not inserted at build time.\n+                        .replace(' */\\n', ` * ${SignedSource.getSigningToken()}\\n */\\n`)\n+                    );\n+\n+                    fs.writeFileSync(file, signedContents, 'utf8');\n+                  }\n+                });\n+              }\n+            } catch (e) {\n+              process.exitCode = 1;\n+              console.error('Error signing files:', e);\n+            }\n+      - name: Will commit these changes\n+        if: steps.check_should_commit.outputs.should_commit == 'true'\n+        run: |\n+          git add .\n+          git status\n+      - name: Commit changes to branch\n+        if: steps.check_should_commit.outputs.should_commit == 'true'\n+        uses: stefanzweifel/git-auto-commit-action@v4\n+        with:\n+          commit_message: |\n+            ${{ github.event.workflow_run.head_commit.message }}\n+\n+            DiffTrain build for commit https://github.com/facebook/react/commit/${{ github.event.workflow_run.head_sha }}.\n+          branch: builds/facebook-fbsource\n+          commit_user_name: ${{ github.event.workflow_run.triggering_actor.login }}\n+          commit_user_email: ${{ github.event.workflow_run.triggering_actor.email || format('{0}@users.noreply.github.com', github.event.workflow_run.triggering_actor.login) }}\n+          create_branch: true"
            },
            {
                "file": ".github/workflows/runtime_fuzz_tests.yml",
                "git_diff": "@@ -0,0 +1,31 @@\n+name: (Runtime) Fuzz tests\n+\n+on:\n+  schedule:\n+    - cron: 0 * * * *\n+  push:\n+    branches:\n+      - main\n+  workflow_dispatch:\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+\n+jobs:\n+  test_fuzz:\n+    runs-on: ubuntu-latest\n+    steps:\n+    - uses: actions/checkout@v4.1.0\n+    - uses: actions/setup-node@v4\n+      with:\n+        node-version-file: '.nvmrc'\n+        cache: 'yarn'\n+    - name: Install dependencies\n+      run: yarn install --frozen-lockfile\n+      env:\n+        ELECTRON_SKIP_BINARY_DOWNLOAD: \"1\"\n+      shell: bash\n+    - name: Run fuzz tests\n+      run: |-\n+        FUZZ_TEST_SEED=$RANDOM yarn test fuzz --ci\n+        FUZZ_TEST_SEED=$RANDOM yarn test --prod fuzz --ci"
            },
            {
                "file": ".github/workflows/runtime_prereleases.yml",
                "git_diff": "@@ -0,0 +1,50 @@\n+name: (Runtime) Publish Prereleases\n+\n+on:\n+  workflow_call:\n+    inputs:\n+      commit_sha:\n+        required: true\n+        default: ''\n+        type: string\n+      release_channel:\n+        required: true\n+        type: string\n+      dist_tag:\n+        required: true\n+        type: string\n+    secrets:\n+      NPM_TOKEN:\n+        required: true\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+  # https://github.com/actions/cache/blob/main/tips-and-workarounds.md#cache-segment-restore-timeout\n+  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 1\n+  GH_TOKEN: ${{ github.token }}\n+  NPM_TOKEN: ${{ secrets.NPM_TOKEN }}\n+\n+jobs:\n+  publish_prerelease:\n+    name: Publish prelease (${{ inputs.release_channel }}) ${{ inputs.commit_sha }} @${{ inputs.dist_tag }}\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        id: node_modules\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('yarn.lock', 'scripts/release/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn install --frozen-lockfile\n+        working-directory: scripts/release\n+      - run: |\n+          scripts/release/prepare-release-from-ci.js --skipTests -r ${{ inputs.release_channel }} --commit=${{ inputs.commit_sha }}\n+          cp ./scripts/release/ci-npmrc ~/.npmrc\n+          scripts/release/publish.js --ci --tags ${{ inputs.dist_tag }}"
            },
            {
                "file": ".github/workflows/runtime_prereleases_manual.yml",
                "git_diff": "@@ -0,0 +1,47 @@\n+name: (Runtime) Publish Prereleases Manual\n+\n+on:\n+  workflow_dispatch:\n+    inputs:\n+      prerelease_commit_sha:\n+        required: true\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+\n+jobs:\n+\n+  publish_prerelease_canary:\n+    name: Publish to Canary channel\n+    uses: facebook/react/.github/workflows/runtime_prereleases.yml@main\n+    with:\n+      commit_sha: ${{ inputs.prerelease_commit_sha }}\n+      release_channel: stable\n+      # The tags to use when publishing canaries. The main one we should\n+      # always include is \"canary\" but we can use multiple (e.g. alpha,\n+      # beta, rc). To declare multiple, use a comma-separated string, like\n+      # this:\n+      #   dist_tag: \"canary,alpha,beta,rc\"\n+      #\n+      # TODO: We currently tag canaries with \"next\" in addition to \"canary\"\n+      # because this used to be called the \"next\" channel and some\n+      # downstream consumers might still expect that tag. We can remove this\n+      # after some time has elapsed and the change has been communicated.\n+      dist_tag: canary,next,rc\n+    secrets:\n+      NPM_TOKEN: ${{ secrets.NPM_TOKEN }}\n+\n+  publish_prerelease_experimental:\n+    name: Publish to Experimental channel\n+    uses: facebook/react/.github/workflows/runtime_prereleases.yml@main\n+    # NOTE: Intentionally running these jobs sequentially because npm\n+    # will sometimes fail if you try to concurrently publish two\n+    # different versions of the same package, even if they use different\n+    # dist tags.\n+    needs: publish_prerelease_canary\n+    with:\n+      commit_sha: ${{ inputs.prerelease_commit_sha }}\n+      release_channel: experimental\n+      dist_tag: experimental\n+    secrets:\n+      NPM_TOKEN: ${{ secrets.NPM_TOKEN }}"
            },
            {
                "file": ".github/workflows/runtime_prereleases_nightly.yml",
                "git_diff": "@@ -0,0 +1,35 @@\n+name: (Runtime) Publish Prereleases Nightly\n+\n+on:\n+  schedule:\n+    # At 10 minutes past 16:00 on Mon, Tue, Wed, Thu, and Fri\n+    - cron: 10 16 * * 1,2,3,4,5\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+\n+jobs:\n+  publish_prerelease_canary:\n+    name: Publish to Canary channel\n+    uses: facebook/react/.github/workflows/runtime_prereleases.yml@main\n+    with:\n+      commit_sha: ${{ github.sha }}\n+      release_channel: stable\n+      dist_tag: canary,next,rc\n+    secrets:\n+      NPM_TOKEN: ${{ secrets.NPM_TOKEN }}\n+\n+  publish_prerelease_experimental:\n+    name: Publish to Experimental channel\n+    uses: facebook/react/.github/workflows/runtime_prereleases.yml@main\n+    # NOTE: Intentionally running these jobs sequentially because npm\n+    # will sometimes fail if you try to concurrently publish two\n+    # different versions of the same package, even if they use different\n+    # dist tags.\n+    needs: publish_prerelease_canary\n+    with:\n+      commit_sha: ${{ github.sha }}\n+      release_channel: experimental\n+      dist_tag: experimental\n+    secrets:\n+      NPM_TOKEN: ${{ secrets.NPM_TOKEN }}"
            },
            {
                "file": ".github/workflows/shared_lint.yml",
                "git_diff": "@@ -0,0 +1,84 @@\n+name: (Shared) Lint\n+\n+on:\n+  push:\n+    branches: [main]\n+  pull_request:\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+  # https://github.com/actions/cache/blob/main/tips-and-workarounds.md#cache-segment-restore-timeout\n+  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 1\n+\n+jobs:\n+  prettier:\n+    name: Run prettier\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: yarn prettier-check\n+\n+  eslint:\n+    name: Run eslint\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: node ./scripts/tasks/eslint\n+\n+  check_license:\n+    name: Check license\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: ./scripts/ci/check_license.sh\n+\n+  test_print_warnings:\n+    name: Test print warnings\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/checkout@v4\n+      - uses: actions/setup-node@v4\n+        with:\n+          node-version-file: '.nvmrc'\n+          cache: yarn\n+          cache-dependency-path: yarn.lock\n+      - name: Restore cached node_modules\n+        uses: actions/cache@v4\n+        with:\n+          path: \"**/node_modules\"\n+          key: ${{ runner.arch }}-${{ runner.os }}-modules-${{ hashFiles('**/yarn.lock') }}\n+      - run: yarn install --frozen-lockfile\n+      - run: ./scripts/ci/test_print_warnings.sh"
            },
            {
                "file": ".github/workflows/shared_stale.yml",
                "git_diff": "@@ -0,0 +1,50 @@\n+# Configuration for stale action workflow - https://github.com/actions/stale\n+name: (Shared) Manage stale issues and PRs\n+on:\n+  schedule:\n+    # Run hourly\n+    - cron: '0 * * * *'\n+  workflow_dispatch:\n+\n+env:\n+  TZ: /usr/share/zoneinfo/America/Los_Angeles\n+\n+jobs:\n+  stale:\n+    runs-on: ubuntu-latest\n+    steps:\n+      - uses: actions/stale@v9\n+        with:\n+          # --- Issues & PRs ---\n+          # Number of days of inactivity before an issue or PR becomes stale\n+          days-before-stale: 90\n+          # Number of days of inactivity before a stale issue or PR is closed\n+          days-before-close: 7\n+          # API calls per run\n+          operations-per-run: 100\n+\n+          # --- Issues ---\n+          stale-issue-label: \"Resolution: Stale\"\n+          # Comment to post when marking an issue as stale\n+          stale-issue-message: >\n+            This issue has been automatically marked as stale.\n+            **If this issue is still affecting you, please leave any comment** (for example, \"bump\"), and we'll keep it open.\n+            We are sorry that we haven't been able to prioritize it yet. If you have any new additional information, please include it with your comment!\n+          # Comment to post when closing a stale issue\n+          close-issue-message: >\n+            Closing this issue after a prolonged period of inactivity. If this issue is still present in the latest release, please create a new issue with up-to-date information. Thank you!\n+          # Issues with these labels will never be considered stale\n+          exempt-issue-labels: \"Partner,React Core Team,Resolution: Backlog,Type: Bug,Type: Discussion,Type: Needs Investigation,Type: Regression,Type: Feature Request,Type: Enhancement\"\n+\n+          # --- PRs ---\n+          stale-pr-label: \"Resolution: Stale\"\n+          # Comment to post when marking a pull request as stale\n+          stale-pr-message: >\n+            This pull request has been automatically marked as stale.\n+            **If this pull request is still relevant, please leave any comment** (for example, \"bump\"), and we'll keep it open.\n+            We are sorry that we haven't been able to prioritize reviewing it yet. Your contribution is very much appreciated.\n+          # Comment to post when closing a stale pull request\n+          close-pr-message: >\n+            Closing this pull request after a prolonged period of inactivity. If this issue is still present in the latest release, please ask for this pull request to be reopened. Thank you!\n+          # PRs with these labels will never be considered stale\n+          exempt-pr-labels: \"Partner,React Core Team,Resolution: Backlog,Type: Bug,Type: Discussion,Type: Needs Investigation,Type: Regression,Type: Feature Request,Type: Enhancement\""
            },
            {
                "file": ".gitignore",
                "git_diff": "@@ -33,6 +33,7 @@ packages/react-devtools-extensions/firefox/*.xpi\n packages/react-devtools-extensions/firefox/*.pem\n packages/react-devtools-extensions/shared/build\n packages/react-devtools-extensions/.tempUserDataDir\n+packages/react-devtools-fusebox/dist\n packages/react-devtools-inline/dist\n packages/react-devtools-shell/dist\n packages/react-devtools-timeline/dist"
            },
            {
                "file": ".nvmrc",
                "git_diff": "@@ -1 +1 @@\n-v16.19.1\n+v18.20.1"
            },
            {
                "file": ".prettierignore",
                "git_diff": "@@ -1,3 +1,4 @@\n+# react runtime\n build\n \n packages/react-devtools-core/dist\n@@ -6,9 +7,34 @@ packages/react-devtools-extensions/firefox/build\n packages/react-devtools-extensions/edge/build\n packages/react-devtools-extensions/shared/build\n packages/react-devtools-extensions/src/ErrorTesterCompiled.js\n+packages/react-devtools-fusebox/dist\n packages/react-devtools-inline/dist\n packages/react-devtools-shared/src/hooks/__tests__/__source__/__compiled__/\n packages/react-devtools-shared/src/hooks/__tests__/__source__/__untransformed__/\n packages/react-devtools-shell/dist\n packages/react-devtools-timeline/dist\n packages/react-devtools-timeline/static\n+\n+# react compiler\n+compiler/**/dist\n+compiler/**/__tests__/fixtures/**/*.expect.md\n+compiler/**/.next\n+\n+# contains invalid graphql`...` which results in a promise rejection error from `yarn prettier-all`.\n+compiler/packages/babel-plugin-react-compiler/src/__tests__/fixtures/compiler/error.todo-kitchensink.js\n+\n+compiler/crates\n+compiler/apps/playground/public\n+\n+compiler/**/LICENSE\n+compiler/*.md*\n+compiler/*.json\n+compiler/*.css\n+compiler/*.webmanifest\n+compiler/*.map\n+compiler/*.sh\n+compiler/*.txt\n+compiler/*.ico\n+compiler/*.svg\n+compiler/*.lock\n+compiler/*.toml"
            },
            {
                "file": ".prettierrc.js",
                "git_diff": "@@ -3,19 +3,33 @@\n const {esNextPaths} = require('./scripts/shared/pathsByLanguageVersion');\n \n module.exports = {\n+  plugins: ['prettier-plugin-hermes-parser'],\n   bracketSpacing: false,\n   singleQuote: true,\n   bracketSameLine: true,\n   trailingComma: 'es5',\n   printWidth: 80,\n-  parser: 'flow',\n+  parser: 'hermes',\n   arrowParens: 'avoid',\n   overrides: [\n+    {\n+      files: ['*.code-workspace'],\n+      options: {\n+        parser: 'json-stringify',\n+      },\n+    },\n     {\n       files: esNextPaths,\n       options: {\n         trailingComma: 'all',\n       },\n     },\n+    {\n+      files: ['*.ts', '*.tsx'],\n+      options: {\n+        trailingComma: 'all',\n+        parser: 'typescript',\n+      },\n+    },\n   ],\n };"
            },
            {
                "file": "AUTHORS",
                "git_diff": "@@ -1,1130 +0,0 @@\n-839 <8398a7@gmail.com>\n-Aaron Ackerman <theron17@gmail.com>\n-Aaron Cannon <cannona@fireantproductions.com>\n-Aaron Franks <aaron.franks@gmail.com>\n-Aaron Gelter <aaron.gelter@harman.com>\n-Abhay Nikam <nikam.abhay1@gmail.com>\n-Abhishek Soni <abhisheksoni2720@gmail.com>\n-Adam <gadtfly@users.noreply.github.com>\n-Adam Bloomston <adam@glitterfram.es>\n-Adam Krebs <amk528@cs.nyu.edu>\n-Adam Mark <adammark75@gmail.com>\n-Adam Solove <asolove@gmail.com>\n-Adam Stankiewicz <sheerun@sher.pl>\n-Adam Timberlake <adam.timberlake@gmail.com>\n-Adam Zapletal <adamzap@gmail.com>\n-Addy Osmani <addyosmani@gmail.com>\n-Adrian Sieber <mail@adriansieber.com>\n-Aesop Wolf <aesopwolf@users.noreply.github.com>\n-Ahmad Wali Sidiqi <wali-s@users.noreply.github.com>\n-Alan Plum <me@pluma.io>\n-Alan Souza <alansouzati@gmail.com>\n-Alan deLevie <adelevie@gmail.com>\n-Alastair Hole <afhole@gmail.com>\n-Alex <itaieps+github@fastmail.fm>\n-Alex <ultrafez@users.noreply.github.com>\n-Alex Babkov <alex.babkov@rexsoftware.com.au>\n-Alex Baumgertner <alex.baumgertner@gmail.com>\n-Alex Boatwright <drdelambre@gmail.com>\n-Alex Boyd <alex@opengroove.org>\n-Alex Dajani <xelad1@gmail.com>\n-Alex Jacobs <lex.jacobs@gmail.com>\n-Alex Katopodis <akatopo@users.noreply.github.com>\n-Alex Lopatin <alex@alexlopatin.com>\n-Alex Mykyta <dancingwithcows@gmail.com>\n-Alex Pien <alexpien@gmail.com>\n-Alex Smith <iqwz@ya.ru>\n-Alex Zelenskiy <azelenskiy@fb.com>\n-Alex Zherdev <alex.zherdev@gmail.com>\n-Alexander <alexander.chisler@gmail.com>\n-Alexander <alx.safari@gmail.com>\n-Alexander Shtuchkin <ashtuchkin@gmail.com>\n-Alexander Solovyov <alexander@solovyov.net>\n-Alexander Tseung <alextsg@gmail.com>\n-Alexandre Gaudencio <shahor@shahor.fr>\n-Alexandre Kirszenberg <a.kirszenberg@gmail.com>\n-Alexey Raspopov <avenger7x13@gmail.com>\n-Alexey Shamrin <shamrin@gmail.com>\n-Ali Taheri Moghaddar <ali.taheri.m@gmail.com>\n-Ali Ukani <ali.ukani@gmail.com>\n-Alireza Mostafizi <ar.mostafizi@gmail.com>\n-Almero Steyn <almero.steyn@gmail.com>\n-Amanvir Sangha <amanvir@users.noreply.github.com>\n-Amjad Masad <amjad.masad@gmail.com>\n-Anastasia A <sacret@nm.ru>\n-Andre Giron <agiron123@gmail.com>\n-Andre Z Sanchez <andrezacsanchez@gmail.com>\n-Andreas M\u00f6ller <am@localheinz.com>\n-Andreas Savvides <asavvides@twitter.com>\n-Andreas Svensson <andreas@syranide.com>\n-Andres Kalle <mjomble@gmail.com>\n-Andres Suarez <zertosh@gmail.com>\n-Andrew Clark <acdlite@me.com>\n-Andrew Cobby <cobbweb@users.noreply.github.com>\n-Andrew Davey <andrew@equin.co.uk>\n-Andrew Henderson <andrew.m.henderson@gmail.com>\n-Andrew Imm <aimm22@gmail.com>\n-Andrew Kulakov <avk@8xx8.ru>\n-Andrew Lo <andrew.lo@rangle.io>\n-Andrew Poliakov <pavlin99th@me.com>\n-Andrew Rasmussen <andras@fb.com>\n-Andrew Rota <rota.andrew@gmail.com>\n-Andrew Sokolov <asokolov@atlassian.com>\n-Andrew Zich <azich@fb.com>\n-Andrey Marchenko <tom910ru@gmail.com>\n-Andrey Okonetchnikov <okonet@users.noreply.github.com>\n-Andrey Popp <8mayday@gmail.com>\n-Andrey Safronov <a.safronov87@gmail.com>\n-Andy Edwards <jedwards@fastmail.com>\n-Ankeet Maini <ankeet.maini@gmail.com>\n-Anthony van der Hoorn <anthony.vanderhoorn@gmail.com>\n-Anto Aravinth <anto.aravinth.cse@gmail.com>\n-Antonio Ruberto <anto.ruberto@gmail.com>\n-Antti Ahti <antti.ahti@gmail.com>\n-Ant\u00f3nio Nuno Monteiro <anmonteiro@gmail.com>\n-Anuj Tomar <ankuto@gmail.com>\n-Anuja Ware <anuja@joshsoftware.com>\n-AoDev <AoDev@users.noreply.github.com>\n-April Arcus <april.arcus@gmail.com>\n-Areeb Malik <areeb.malik91@gmail.com>\n-Aria Buckles <aria@khanacademy.org>\n-Aria Stewart <aredridel@dinhe.net>\n-Arian Faurtosh <arian@icloud.com>\n-Arni Fannar <arnifa@gmail.com>\n-Arshabh Kumar Agarwal <arshabh.agarwal.it@gmail.com>\n-Artem Nezvigin <artem@artnez.com>\n-Arthur Gunn <arthur@gunn.co.nz>\n-Ashish <ashishgupta.3197@gmail.com>\n-Austin Wright <aaa@bzfx.net>\n-Avinash Kondeti <avi.kondeti@gmail.com>\n-Ayman Osman <aymano.osman@gmail.com>\n-B.Orlov <bgnorlov@gmail.com>\n-BDav24 <BDav24@users.noreply.github.com>\n-BEAUDRU Manuel <beaudru.manuel@gmail.com>\n-Baraa Hamodi <bhamodi@uwaterloo.ca>\n-Bartosz Kaszubowski <gosimek@gmail.com>\n-Basarat Ali Syed <basaratali@gmail.com>\n-Battaile Fauber <battaile@gmail.com>\n-Beau Smith <beau@beausmith.com>\n-Ben Anderson <banderson@constantcontact.com>\n-Ben Berman <ben.m.berman@gmail.com>\n-Ben Brooks <ben@benbrooks.net>\n-Ben Foxall <benfoxall@gmail.com>\n-Ben Halpern <bendhalpern@gmail.com>\n-Ben Jaffe <jaffe.ben@gmail.com>\n-Ben Moss <ben@mossity.com>\n-Ben Newman <bn@cs.stanford.edu>\n-Ben Ripkens <bripkens.dev@gmail.com>\n-Benedikt Meurer <benedikt.meurer@googlemail.com>\n-Benjamin Keen <ben.keen@gmail.com>\n-Benjamin Leiken <benleiken@gmail.com>\n-Benjamin Woodruff <github@benjam.info>\n-Benjy Cui <benjytrys@gmail.com>\n-Benoit Girard <b56girard@gmail.com>\n-Benton Rochester <bentonrochester@gmail.com>\n-Bernard Lin <bernardlin12@gmail.com>\n-Bill Blanchard <bill@plumbdev.com>\n-Bill Fisher <fisherwebdev@gmail.com>\n-Billy Shih <me@billyshih.com>\n-Blaine Hatab <jbhatab@gmail.com>\n-Blaine Kasten <blainekasten@gmail.com>\n-Bob Eagan <bob@synapsestudios.com>\n-Bob Ralian <bob.ralian@gmail.com>\n-Bob Renwick <bob.renwick@gmail.com>\n-Bobby <puppybytes@gmail.com>\n-Bogdan Chadkin <trysound@yandex.ru>\n-Bojan Mihelac <bmihelac@mihelac.org>\n-Boris Yankov <borisyankov@gmail.com>\n-Brad Vogel <bradavogel@gmail.com>\n-Bradford <brad.lamson@gmail.com>\n-Bradley Spaulding <brad.spaulding@gmail.com>\n-Brandon Bloom <brandon@brandonbloom.name>\n-Brandon Dail <aweary@users.noreply.github.com>\n-Brandon Tilley <brandon@brandontilley.com>\n-Brenard Cubacub <bcbcb@users.noreply.github.com>\n-Brent Vatne <brentvatne@gmail.com>\n-Brian Cooke <bri@bricooke.com>\n-Brian Emil Hartz <brianhartz@gmail.com>\n-Brian Holt <btholt@gmail.com>\n-Brian Hsu <brianhsu@Brians-MacBook-Pro.local>\n-Brian Kim <briankimpossible@gmail.com>\n-Brian Kung <brian@callmekung.com>\n-Brian Reavis <brian@thirdroute.com>\n-Brian Rue <brian@rollbar.com>\n-Brian Vaughn <brian.david.vaughn@gmail.com>\n-Bruce Harris <bharris845@gmail.com>\n-Bruno Heridet <delapouite@gmail.com>\n-Bruno \u0160kvorc <bruno@skvorc.me>\n-Bryan Braun <bbraun7@gmail.com>\n-CT Wu <wu.chingting@gmail.com>\n-Cam Song <neosoyn@gmail.com>\n-Cam Spiers <camspiers@gmail.com>\n-Cameron Chamberlain <git@camjc.com>\n-Cameron Matheson <cameron@instructure.com>\n-Carolina Powers <carolinapoloni@gmail.com>\n-Carter Chung <carterchung@users.noreply.github.com>\n-Cassus Adam Banko <banko.adam@gmail.com>\n-Cat Chen <catchen@fb.com>\n-Cedric Sohrauer <cedric.sohrauer@infopark.de>\n-Cesar William Alvarenga <cesarwbr@gmail.com>\n-Chad Fawcett <me@chadf.ca>\n-Changsoon Bok <winmain@gmail.com>\n-Charles Marsh <charlie@khanacademy.org>\n-Charlie Garcia <cgarcia@intellisys.com.do>\n-Chase Adams <realchaseadams@gmail.com>\n-Cheng Lou <chenglou92@gmail.com>\n-Chitharanjan Das <das.chitharanjan@gmail.com>\n-Chris <thisguychris@users.noreply.github.com>\n-Chris Bolin <bolin.chris@gmail.com>\n-Chris Grovers <chrisgrovers@users.noreply.github.com>\n-Chris Ha <chriskevinha@gmail.com>\n-Chris Pearce <hello@chrispearce.me>\n-Chris Rebert <github@rebertia.com>\n-Chris Sciolla <csciolla1@gmail.com>\n-Christian Alfoni <christianalfoni@gmail.com>\n-Christian Oliff <christianoliff@yahoo.com>\n-Christian Roman <chroman16@gmail.com>\n-Christoffer Sawicki <christoffer.sawicki@gmail.com>\n-Christoph Pojer <christoph.pojer@gmail.com>\n-Christophe Hurpeau <christophe@hurpeau.com>\n-Christopher Monsanto <chris@monsan.to>\n-Claudio Brandolino <cbrandolino@gmail.com>\n-Clay Allsopp <clay.allsopp@gmail.com>\n-Clay Miller <clay@smockle.com>\n-Clement Hoang <clement.hoang24@gmail.com>\n-CodinCat <a55951234@gmail.com>\n-Cody Reichert <codyreichert@gmail.com>\n-Colin Wren <colinwren@users.noreply.github.com>\n-Connor McSheffrey <c@conr.me>\n-Conor Hastings <hastings.conorm@gmail.com>\n-Constantin Gavrilete <cgav@users.noreply.github.com>\n-Cory House <housecor@gmail.com>\n-Cotton Hou <himcotton@gmail.com>\n-Craig Akimoto <strawbrary@users.noreply.github.com>\n-Cristovao Verstraeten <cristovao@apleasantview.com>\n-DQNEO <dqneoo@gmail.com>\n-Dai Nguyen <dainguyenhuu@users.noreply.github.com>\n-Damian Nicholson <damian.nicholson21@gmail.com>\n-Damien Pellier <dpellier@leadformance.com>\n-Damien Soulard <iDams@users.noreply.github.com>\n-Dan Abramov <dan.abramov@gmail.com>\n-Dan Fox <iamdanfox@gmail.com>\n-Dan Schafer <dschafer@fb.com>\n-DanZeuss <danvc@zeuss.com>\n-Daniel Carlsson <daniel.carlsson.1987@gmail.com>\n-Daniel Cousens <dcousens@users.noreply.github.com>\n-Daniel Friesen <daniel@nadir-seen-fire.com>\n-Daniel Gasienica <daniel@gasienica.ch>\n-Daniel Hejl <daniel.hejl@hotmail.com>\n-Daniel Hejl <hejldaniel@gmail.com>\n-Daniel Liburd <daniel.liburd@gmail.com>\n-Daniel Lo Nigro <daniel@dan.cx>\n-Daniel Man\u00e9 <danmane@gmail.com>\n-Daniel Miladinov <dmiladinov@wingspan.com>\n-Daniel Rodgers-Pryor <djrodgerspryor@gmail.com>\n-Daniel Rosenwasser <DanielRosenwasser@users.noreply.github.com>\n-Daniel Rotter <daniel.rotter@gmail.com>\n-Daniel Schonfeld <daniel@schonfeld.org>\n-Daniela Borges <alunassertiva@gmail.com>\n-Danilo Vitoriano <vitoriano08@gmail.com>\n-Danny Ben-David <dannybd@fb.com>\n-Danny Hurlburt <dhurlburtusa@users.noreply.github.com>\n-Darcy <smadad@me.com>\n-Daryl Lau <daryl@weak.io>\n-Dar\u00edo Javier Cravero <dario@uxtemple.com>\n-Dave Galbraith <dave@jut.io>\n-Dave Lunny <d@velunny.com>\n-Dave Voyles <Dnvoyles@gmail.com>\n-David Aurelio <dev@david-aurelio.com>\n-David Baker <djbaker2@gmail.com>\n-David Beitey <david@davidjb.com>\n-David Ed Mellum <david@edmellum.com>\n-David Goldberg <gberg1@users.noreply.github.com>\n-David Granado <davidjgranado@gmail.com>\n-David Greenspan <dgreenspan@alum.mit.edu>\n-David Hellsing <david@aino.se>\n-David Hu <davidhu91@gmail.com>\n-David Khourshid <davidkpiano@gmail.com>\n-David Mininger <dmininger@gmail.com>\n-David Neubauer <davidneub@gmail.com>\n-David Percy <davetp425@gmail.com>\n-Dean Shi <dnshi@users.noreply.github.com>\n-Denis Laxalde <denis@laxalde.org>\n-Denis Pismenny <dpismenny@users.noreply.github.com>\n-Denis Sokolov <denis@sokolov.cc>\n-Deniss Jacenko <deniss.jacenko+github@gmail.com>\n-Dennis Johnson <djohnson@rallydev.com>\n-Desmond Brand <dmnd@desmondbrand.com>\n-Devedse <2350015+devedse@users.noreply.github.com>\n-Devinsuit <r.poryvaev@hotmail.com>\n-Devon Blandin <dblandin@gmail.com>\n-Devon Harvey <devonharvey@gmail.com>\n-Dheeraj Kumar <a.dheeraj.kumar@gmail.com>\n-Dhyey Thakore <dhyey35@gmail.com>\n-Diego Muracciole <diegomuracciole@gmail.com>\n-Dima Beznos <beznos.d@gmail.com>\n-Dimzel Sobolev <disobolev@icloud.com>\n-Dmitri Zaitsev <dmitri14@gmail.com>\n-Dmitrii Abramov <dmitrii@rheia.us>\n-Dmitriy Kubyshkin <grassator@gmail.com>\n-Dmitriy Rozhkov <dmitriy.rozhkov@xing.com>\n-Dmitry Blues <dmitri.blyus@gmail.com>\n-Dmitry Mazuro <dmitry.mazuro@icloud.com>\n-Dmitry Zhuravlev-Nevsky <dmitry.nevsky@gmail.com>\n-Domenico Matteo <matteo.domenico@gmail.com>\n-Dominic Gannaway <dg@domgan.com>\n-Don Abrams <donabrams@gmail.com>\n-Dongsheng Liu <bellanchor@gmail.com>\n-Duke Pham <dookpham@gmail.com>\n-Dustan Kasten <dustan.kasten@gmail.com>\n-Dustin Getz <dgetz@wingspan.com>\n-Dylan Harrington <dylanharrington@gmail.com>\n-Dylan Kirby <djkirby@users.noreply.github.com>\n-Edgar (Algebr) <edgar.factorial@gmail.com>\n-Eduard <ghinea.eduard@yahoo.com>\n-Eduardo Garcia <emumaniacx@gmail.com>\n-Edvin Erikson <edvin@rocketblast.com>\n-Elaine Fang <elainefang@Elaines-MacBook-Pro.local>\n-Eli White <github@eli-white.com>\n-Enguerran <engcolson@gmail.com>\n-Eoin Hennessy <eoin.hennessy@gmail.com>\n-Eric Churchill <eric.churchill2@gmail.com>\n-Eric Clemmons <eric@smarterspam.com>\n-Eric Douglas <eric.douglas.mail@gmail.com>\n-Eric Eastwood <contact@ericeastwood.com>\n-Eric Elliott <support@paralleldrive.com>\n-Eric Florenzano <floguy@gmail.com>\n-Eric Matthys <ericmatthys@gmail.com>\n-Eric Nakagawa <ericnakagawa@gmail.com>\n-Eric O'Connell <eric.oconnell@idealist.org>\n-Eric Pitcher <ericpitcher@live.com>\n-Eric Sakmar <eric.sakmar@gmail.com>\n-Eric Schoffstall <contra@wearefractal.com>\n-Erik Harper <eharper@mixpo.com>\n-Erik Hellman <iam@erikhellman.com>\n-Espen Hovlandsdal <rexxars@gmail.com>\n-Esteban <elas7@users.noreply.github.com>\n-Eugene <elforastero@ya.ru>\n-EugeneGarbuzov <ridaim@yandex.ru>\n-Evan Coonrod <evan@paloalto.com>\n-Evan Jacobs <evan@yaycmyk.com>\n-Evan Scott <glitterbyte@gmail.com>\n-Evan Vosberg <evanvosberg@urban.to>\n-Fabio M. Costa <fabiomcosta@gmail.com>\n-Fabrizio Castellarin <f.castellarin@gmail.com>\n-Faheel Ahmad <faheel@live.in>\n-Fatih <frontsideair@users.noreply.github.com>\n-Federico Rampazzo <frampone@gmail.com>\n-Felipe Oliveira Carvalho <felipekde@gmail.com>\n-Felix Gnass <fgnass@gmail.com>\n-Felix Kling <felix.kling@gmx.net>\n-Fernando Alex Helwanger <fhelwanger@gmail.com>\n-Fernando Correia <fernando@servicero.com>\n-Fernando Montoya <montogeek@gmail.com>\n-Filip Ho\u0161ko <filiphosko@gmail.com>\n-Filip Spiridonov <filip.spiridonov@gmail.com>\n-Flarnie Marchan <flarnie@users.noreply.github.com>\n-Fokke Zandbergen <mail@fokkezb.nl>\n-Frank Yan <fryn@users.noreply.github.com>\n-Frankie Bagnardi <f.bagnardi@gmail.com>\n-Fran\u00e7ois Chalifour <francoischalifour@users.noreply.github.com>\n-Fran\u00e7ois-Xavier Bois <fxbois@gmail.com>\n-Fraser Haer <fraser.haer@hotmail.com>\n-Fred Zhao <fredz@fb.com>\n-Freddy Rangel <frederick.rangel@gmail.com>\n-Fyodor Ivanishchev <cbrwizard@gmail.com>\n-G Scott Olson <gscottolson@gmail.com>\n-G. Kay Lee <balancetraveller+github@gmail.com>\n-Gabe Levi <gabelevi@gmail.com>\n-Gabriel Lett Viviani <gm.lett@gmail.com>\n-Gajus Kuizinas <g.kuizinas@anuary.com>\n-Gant Laborde <gantman@gmail.com>\n-Gareth Nicholson <gareth.nic@gmail.com>\n-Garmash Nikolay <garmash.nikolay@gmail.com>\n-Garren Smith <garren.smith@gmail.com>\n-Garrett McCullough <gwmccull@yahoo.com>\n-Gavin McQuistin <gavin@kickfiredesign.com>\n-Ga\u00ebtan Renaudeau <renaudeau.gaetan@gmail.com>\n-Geert Pasteels <geert.pasteels@gmail.com>\n-Geert-Jan Brits <gbrits@gmail.com>\n-George A Sisco III <george.sisco@gmail.com>\n-Georgii Dolzhykov <thorn.mailbox@gmail.com>\n-Gert Hengeveld <info@ghengeveld.nl>\n-Giamir Buoncristiani <giamir@thoughtworks.com>\n-Gil Chen-Zion <gilchenzion@users.noreply.github.com>\n-Gilbert <gilbertbgarza@gmail.com>\n-Giorgio Polvara <polvara@gmail.com>\n-Giuseppe <ggurgone@gmail.com>\n-Glen Mailer <glenjamin@gmail.com>\n-Grant Timmerman <granttimmerman@gmail.com>\n-Greg Hurrell <glh@fb.com>\n-Greg Palmer <g-palmer@users.noreply.github.com>\n-Greg Perkins <gregrperkins@fb.com>\n-Greg Roodt <groodt@gmail.com>\n-Gregory <g.marcilhacy@gmail.com>\n-Grgur Grisogono <grguru@gmail.com>\n-Griffin Michl <griffinmichl@gmail.com>\n-Guangqiang Dong <gqdong@fb.com>\n-Guido Bouman <m@guido.vc>\n-Guilherme Oenning <me@goenning.net>\n-Guilherme Ruiz <guiiruiz@hotmail.com>\n-Guillaume Claret <guillaume@ouicar.fr>\n-Harry Hull <harry.hull1@gmail.com>\n-Harry Marr <harry.marr@gmail.com>\n-Harry Moreno <morenoh149@gmail.com>\n-Harshad Sabne <harshadsabne@users.noreply.github.com>\n-Hekar Khani <hekark@gmail.com>\n-Hendrik Swanepoel <hendrik.swanepoel@gmail.com>\n-Henrik Nyh <henrik@nyh.se>\n-Henry Harris <henrythomasharris@gmail.com>\n-Henry Wong <henryw4k@gmail.com>\n-Henry Zhu <hi@henryzoo.com>\n-Hideo Matsumoto <hideo-m@pekeq.com>\n-Hikaru Suido <hikaru.suido@gmail.com>\n-Hiroyuki Wada <wadahiro@gmail.com>\n-Hou Chia <kchia87@gmail.com>\n-Huang-Wei Chang <chang.huangwei.01@gmail.com>\n-Hugo Agbonon <hugo@agbonon.fr>\n-Hugo Jobling <me@thisishugo.com>\n-Hyeock Kwon <doublus@gmail.com>\n-H\u00e9ctor Ramos <hramos@users.noreply.github.com>\n-H\u00e9liton Nordt <hnordt@hnordt.com>\n-Ian Obermiller <ian@obermillers.com>\n-Ian Sutherland <ian@iansutherland.ca>\n-Ignacio Carbajo <icarbajop@gmail.com>\n-Igor Scekic <igorscekic2@gmail.com>\n-Ike Peters <ikedpeters21@gmail.com>\n-Ilia Pavlenkov <dortonway@gmail.com>\n-Ilya Gelman <ilyagelman@ilyagelman.com>\n-Ilya Shuklin <ilya.shuklin@gmail.com>\n-Ily\u00e1 Belsky <gelias.gbelsky@gmail.com>\n-Ingvar Stepanyan <me@rreverser.com>\n-Irae Carvalho <irae@irae.pro.br>\n-Isaac Salier-Hellendag <isaac@fb.com>\n-Islam Sharabash <islam.sharabash@gmail.com>\n-Iurii Kucherov <yuyokk@gmail.com>\n-Ivan <15101126742@163.com>\n-Ivan Kozik <ivan@ludios.org>\n-Ivan Krechetov <ikr@ikr.su>\n-Ivan Vergiliev <ivan.vergiliev@gmail.com>\n-Ivan Zotov <ivanzotov@gmail.com>\n-J. Andrew Brassington <jabbrass@zoho.com>\n-J. Ren\u00e9e Beach <splendidnoise@gmail.com>\n-JD Isaacks <jd@jisaacks.com>\n-JJ Weber <jj.weber@gmail.com>\n-JW <JW00000@gmail.com>\n-Jack <jack@jackmarchant.com>\n-Jack Cross <jackjocross@gmail.com>\n-Jack Ford <jford8820@gmail.com>\n-Jack Zhang <jzhang31191@gmail.com>\n-Jackie Wung <jacquelinewung@gmail.com>\n-Jackson Huang <jackson888888@gmail.com>\n-Jacob Gable <jacob.gable@gmail.com>\n-Jacob Greenleaf <jake@imgur.com>\n-Jacob Lamont <cob@jacoblamont.com>\n-Jae Hun Lee <jaehlee11@gmail.com>\n-Jae Hun Ro <jhr24@duke.edu>\n-Jaeho Lee <me@jaeholee.org>\n-Jaime Mingo <j.mingov@3boll.com>\n-Jake Boone <jakeboone02@gmail.com>\n-Jake Worth <jakeworth82@gmail.com>\n-Jakub Malinowski <jakubmal@gmail.com>\n-James <james@mystrata.com>\n-James Brantly <james@jbrantly.com>\n-James Burnett <jtburnett@tribune.com>\n-James Friend <james@jsdf.co>\n-James Ide <ide@fb.com>\n-James Long <longster@gmail.com>\n-James Pearce <jpearce@fb.com>\n-James Seppi <james.seppi@gmail.com>\n-James South <james_south@hotmail.com>\n-James Wen <jrw2175@columbia.edu>\n-Jamie Wong <jamie.lf.wong@gmail.com>\n-Jamis Charles <jacharles@paypal.com>\n-Jamison Dance <jergason@gmail.com>\n-Jan Hancic <jan.hancic@gmail.com>\n-Jan Kassens <jan@kassens.net>\n-Jan Raasch <jan@janraasch.com>\n-Jan Sch\u00e4r <jscissr@gmail.com>\n-Jane Manchun Wong <wongmjane@icloud.com>\n-Jared Forsyth <jared@jaredforsyth.com>\n-Jared Fox <jalexanderfox@gmail.com>\n-Jarrod Mosen <jarrod.mosen@me.com>\n-Jason <usaman2010us@gmail.com>\n-Jason Bonta <jbonta@gmail.com>\n-Jason Grlicky <jgrlicky@gmail.com>\n-Jason Ly <jason.ly@gmail.com>\n-Jason Miller <aidenn0@geocities.com>\n-Jason Quense <monastic.panic@gmail.com>\n-Jason Trill <jason@jasontrill.com>\n-Jason Webster <jason@metalabdesign.com>\n-Jay Jaeho Lee <jay@spoqa.com>\n-Jay Phelps <hello@jayphelps.com>\n-Jayen Ashar <jayenashar@users.noreply.github.com>\n-Jean Lauliac <lauliacj@gmail.com>\n-Jed Watson <jed.watson@me.com>\n-Jeff Barczewski <jeff.barczewski@gmail.com>\n-Jeff Carpenter <gcarpenterv@gmail.com>\n-Jeff Chan <jefftchan@gmail.com>\n-Jeff Hicken <jhicken@gmail.com>\n-Jeff Kolesky <github@kolesky.com>\n-Jeff Morrison <jeff@anafx.com>\n-Jeff Welch <whatthejeff@gmail.com>\n-Jeffrey Lin <lin.jeffrey@gmail.com>\n-Jeffrey Wan <jeffrey.wan@blueapron.com>\n-Jen Wong <jenjwong@gmail.com>\n-Jeremy Fairbank <elpapapollo@gmail.com>\n-Jess Telford <jess+github@jes.st>\n-Jesse Skinner <jesse@thefutureoftheweb.com>\n-Jignesh Kakadiya <jigneshhk1992@gmail.com>\n-Jim OBrien <jimobrien930@gmail.com>\n-Jim Sproch <jsproch@fb.com>\n-Jiminikiz <jiminikiz@users.noreply.github.com>\n-Jimmy Jea <jimjea@gmail.com>\n-Jing Chen <jingc@fb.com>\n-Jinwoo Oh <arkist@gmail.com>\n-Jinxiu Lee <lee.jinxiu@gmail.com>\n-Jirat Ki <saakyz@gmail.com>\n-Jiyeon Seo <zzzeons@gmail.com>\n-Jody McIntyre <scjody@modernduck.com>\n-Joe Critchley <joecritch@gmail.com>\n-Joe Stein <joeaarons@gmail.com>\n-Joel Auterson <joel.auterson@googlemail.com>\n-Joel Denning <joeldenning@gmail.com>\n-Joel Sequeira <joelseq96@gmail.com>\n-Johan Tingl\u00f6f <karljohantinglof@gmail.com>\n-Johannes Baiter <johannes.baiter@gmail.com>\n-Johannes Emerich <johannes@emerich.de>\n-Johannes Lumpe <johannes@johanneslumpe.de>\n-John Heroy <johnheroy@users.noreply.github.com>\n-John Longanecker <johnlonganecker@gmail.com>\n-John Ryan <tjfryan@fb.com>\n-John Watson <jwatson@fb.com>\n-John-David Dalton <john.david.dalton@gmail.com>\n-Jon Beebe <jon.beebe@daveramsey.com>\n-Jon Bretman <jon.bretman@gmail.com>\n-Jon Chester <jonchester@fb.com>\n-Jon Hester <jon.d.hester@gmail.com>\n-Jon Madison <jon@tfftech.com>\n-Jon Scott Clark <jonscottclark@gmail.com>\n-Jon Tewksbury <jontewks@gmail.com>\n-Jonas Enlund <jonas.enlund@gmail.com>\n-Jonas Gebhardt <jonas@instagram.com>\n-Jonathan Hsu <jhiswin@gmail.com>\n-Jonathan Persson <persson.jonathan@gmail.com>\n-Jordan Harband <ljharb@gmail.com>\n-Jordan Walke <jordojw@gmail.com>\n-Jorrit Schippers <jorrit@ncode.nl>\n-Joseph Nudell <joenudell@gmail.com>\n-Joseph Savona <joesavona@fb.com>\n-Josh Bassett <josh.bassett@gmail.com>\n-Josh Duck <josh@fb.com>\n-Josh Hunt <josh@trtr.co>\n-Josh Perez <josh.perez@airbnb.com>\n-Josh Yudaken <yud@instagram.com>\n-Joshua Evans <joshua.evans@quantified.co>\n-Joshua Go <joshuago@gmail.com>\n-Joshua Goldberg <jsgoldberg90@gmail.com>\n-Joshua Ma <me@joshma.com>\n-Jo\u00e3o Valente <filipevalente@gmail.com>\n-Juan <juan@juansoto.me>\n-Juan Serrano <germ13@users.noreply.github.com>\n-Julen Ruiz Aizpuru <julenx@gmail.com>\n-Julian Viereck <julian.viereck@gmail.com>\n-Julien Bordellier <git@julienbordellier.com>\n-Julio Lopez <ljuliom@gmail.com>\n-Jun Kim <i2r.jun@gmail.com>\n-Jun Wu <quark@lihdd.net>\n-Juraj Dudak <jdudak@fb.com>\n-Justas Brazauskas <brazauskasjustas@gmail.com>\n-Justin <abigsmall@users.noreply.github.com>\n-Justin Grant <justingrant@users.noreply.github.com>\n-Justin Jaffray <justinjaffray@khanacademy.org>\n-Justin Robison <jrobison151@gmail.com>\n-Justin Woo <moomoowoo@gmail.com>\n-KB <karol.borkowski@syzygy.pl>\n-Kale <krydrogen@gmail.com>\n-Kamron Batman <kamronbatman@users.noreply.github.com>\n-Karl Horky <karl.horky@gmail.com>\n-Karl Mikkelsen <karl@kingkarl.com>\n-Karpich Dmitry <karpich@gollard.ru>\n-Karthik Balakrishnan <karthikb351@gmail.com>\n-Karthik Chintapalli <karthik.chintapalli@gmail.com>\n-Kateryna <k.porshnieva@gmail.com>\n-Kaylee Knowles <kayleeknowles42@gmail.com>\n-KeicaM <zawiasam@users.noreply.github.com>\n-Keito Uchiyama <projects@keito.me>\n-Ken Powers <ken@kenpowers.net>\n-Kenneth Chau <kenotron@users.noreply.github.com>\n-Kent C. Dodds <kent@doddsfamily.us>\n-Kevin Cheng <09chengk@gmail.com>\n-Kevin Coughlin <kevintcoughlin@gmail.com>\n-Kevin Huang <huang.kev@gmail.com>\n-Kevin Lacker <kevin@parse.com>\n-Kevin Lau <thekevlau@gmail.com>\n-Kevin Lin <kevinslin8@gmail.com>\n-Kevin Old <kevin@kevinold.com>\n-Kevin Robinson <krobinson@twitter.com>\n-Kevin Suttle <kevin@suttle.email>\n-Kewei Jiang <jkewei328@hotmail.com>\n-Keyan Zhang <root@keyanzhang.com>\n-Kier Borromeo <seraphipod@gmail.com>\n-Kiho \u00b7 Cham <monkindey@163.com>\n-KimCoding <jeokrang@hanmail.net>\n-Kirk Steven Hansen <hanski07@kirk-hansens-macbook.local>\n-Kit Randel <kit@nocturne.net.nz>\n-Kite <ixkaito@gmail.com>\n-Kohei TAKATA <kt.koheitakata@gmail.com>\n-Koo Youngmin <youngmin@youngminz.kr>\n-Krystian Karczewski <karcz.k@gmail.com>\n-Kunal Mehta <k.mehta@berkeley.edu>\n-Kurt Furbush <kurtfurbush@gmail.com>\n-Kurt Ruppel <me@kurtruppel.com>\n-Kurt Weiberth <kweiberth@users.noreply.github.com>\n-Kyle Kelley <rgbkrk@gmail.com>\n-Kyle Mathews <mathews.kyle@gmail.com>\n-Laurence Rowe <l@lrowe.co.uk>\n-Laurent Etiemble <laurent.etiemble@monobjc.net>\n-Lee Byron <lee@leebyron.com>\n-Lee Jaeyoung <jaeyoung@monodiary.net>\n-Lee Sanghyeon <yongdamsh@gmail.com>\n-Lei <tendant@gmail.com>\n-Leland Richardson <leland.m.richardson@gmail.com>\n-Leon Fedotov <LeonFedotov@users.noreply.github.com>\n-Leon Yip <lyip1992@users.noreply.github.com>\n-Leonardo YongUk Kim <dalinaum@gmail.com>\n-Levi Buzolic <levibuzolic@gmail.com>\n-Levi McCallum <levi@levimccallum.com>\n-Lewis Blackwood <lewis.blackwood@gmail.com>\n-Liangzhen Zhu <zhudx6512@163.com>\n-Lily <qvang.j@gmail.com>\n-Linus Unneb\u00e4ck <linus@folkdatorn.se>\n-Lipis <lipiridis@gmail.com>\n-Liz <feministy@users.noreply.github.com>\n-Logan Allen <loganfynne@gmail.com>\n-Lovisa Svallingson <lovisasvallingson@gmail.com>\n-Lucas <AgtLucas@users.noreply.github.com>\n-Ludovico Fischer <livrerie@gmail.com>\n-Luigy Leon <luichi.19@gmail.com>\n-Luke Belliveau <luke.belliveau@gmail.com>\n-Luke Horvat <lukehorvat@gmail.com>\n-MICHAEL JACKSON <mjijackson@gmail.com>\n-MIKAMI Yoshiyuki <yoshuki@saikyoline.jp>\n-Maciej Kasprzyk <kapustka.maciek@gmail.com>\n-Maher Beg <maherbeg@gmail.com>\n-Maksim Shastsel <max.shastik@yandex.ru>\n-Manas <prometheansacrifice@gmail.com>\n-Marcelo Alves <selfmadecelo@gmail.com>\n-Marcin K. <katzoo@github.mail>\n-Marcin Kwiatkowski <marcin.kwiatkowski@hotmail.com>\n-Marcin Mazurek <marcin@mazurek.pro>\n-Marcin Szczepanski <marcins@gmail.com>\n-Marcio Puga <marciopuga@gmail.com>\n-Marcos Ojeda <subliminal@gmail.com>\n-Marcy Sutton <holla@marcysutton.com>\n-Mariano Desanze <protronm@gmail.com>\n-Mario Souto <mariosouto@outlook.com>\n-Marius Skaar Ludvigsen <marius.ludvigsen@gmail.com>\n-Marjan <marjan.georgiev@gmail.com>\n-Mark Anderson <undernewmanagement@users.noreply.github.com>\n-Mark Funk <mfunk86@gmail.com>\n-Mark Hintz <markohintz@gmail.com>\n-Mark IJbema <markijbema@gmail.com>\n-Mark Murphy <murphy.mark@live.ca>\n-Mark Pedrotti <pedrottimark@gmail.com>\n-Mark Penner <mnpenner@users.noreply.github.com>\n-Mark Richardson <echo@fb.com>\n-Mark Rushakoff <mark@influxdb.com>\n-Mark Sun <sunmark14@gmail.com>\n-Marks Polakovs <marks@markspolakovs.me>\n-Marlon Landaverde <milanlandaverde@gmail.com>\n-Marshall Bowers <elliott.codes@gmail.com>\n-Marshall Roch <mroch@fb.com>\n-Martin Andert <mandert@gmail.com>\n-Martin Hochel <hochelmartin@gmail.com>\n-Martin Hujer <mhujer@gmail.com>\n-Martin Jul <martin@mjul.com>\n-Martin Konicek <mkonicek@fb.com>\n-Martin Mihaylov <martomi@users.noreply.github.com>\n-Martin V <ndresx@gmail.com>\n-Masaki KOBAYASHI <makky.4d6b.3f5@gmail.com>\n-Mateusz Burzy\u0144ski <mateuszburzynski@gmail.com>\n-Mathieu M-Gosselin <mathieumg@gmail.com>\n-Mathieu Savy <savy.mathieu@gmail.com>\n-Matias Singers <mail@matiassingers.com>\n-Matsunoki <himkt@klis.tsukuba.ac.jp>\n-Matt Brookes <matt@brookes.net>\n-Matt Dunn-Rankin <mdunnrankin@gmail.com>\n-Matt Harrison <mt.harrison86@gmail.com>\n-Matt Huggins <matt.huggins@gmail.com>\n-Matt Stow <matt.stow@foxsports.com.au>\n-Matt Zabriskie <mzabriskie@gmail.com>\n-Matthew Dapena-Tretter <m@tthewwithanm.com>\n-Matthew Herbst <mherbst@chegg.com>\n-Matthew Hodgson <matthew@matrix.org>\n-Matthew Johnston <matthewjohnston4@outlook.com>\n-Matthew King <mking@users.noreply.github.com>\n-Matthew Looi <looi.matthew@gmail.com>\n-Matthew Miner <matthew@matthewminer.com>\n-Matthew Shotton <matthew.shotton@bbc.co.uk>\n-Matthias Le Brun <mlbli@me.com>\n-Matti Nelimarkka <matti.nelimarkka@hiit.fi>\n-Mattijs Kneppers <mattijs@arttech.nl>\n-Max Donchenko <maxx.donchenko@gmail.com>\n-Max F. Albrecht <1@178.is>\n-Max Heiber <max.heiber@gmail.com>\n-Max Stoiber <contact@mstoiber.com>\n-Maxi Ferreira <charca@gmail.com>\n-Maxim Abramchuk <MaximAbramchuck@gmail.com>\n-Maxwel D'souza <maxellusionist@gmail.com>\n-Merrick Christensen <merrick.christensen@gmail.com>\n-Mert Kahyao\u011flu <mertkahyaoglu93@gmail.com>\n-Michael Chan <mijoch@gmail.com>\n-Michael Jackson <mjijackson@gmail.com>\n-Michael McDermott <michael@mgmcdermott.com>\n-Michael O'Brien <mcobrien@users.noreply.github.com>\n-Michael Randers-Pehrson <michael.rp@gmail.com>\n-Michael Ridgway <mridgway@yahoo-inc.com>\n-Michael Sinov <sihaelov@gmail.com>\n-Michael Terry <michael@michaelterry.org>\n-Michael Warner <MichaelJWarner@hotmail.com>\n-Michael Wiencek <mwtuea@gmail.com>\n-Michael Ziwisky <mikezx@gmail.com>\n-Michal Srb <xixixao@seznam.cz>\n-Micha\u0142 Ordon <designorant@users.noreply.github.com>\n-Micha\u0142 Pierzcha\u0142a <thymikee@gmail.com>\n-Michele Bertoli <MicheleBertoli@users.noreply.github.com>\n-Michelle Todd <himichelletodd@gmail.com>\n-Michiya <mhibino@users.noreply.github.com>\n-Mihai Parparita <mihai.parparita@gmail.com>\n-Mike D Pilsbury <mike.pilsbury@gmail.com>\n-Mike Groseclose <mike.groseclose@gmail.com>\n-Mike Nordick <mnordick>\n-Mikhail Osher <yo@miraage.io>\n-Mikolaj Dadela <mikolaj.dadela@hgv-online.de>\n-Miles Johnson <mileswjohnson@gmail.com>\n-Miller Medeiros <miller@millermedeiros.com>\n-Minwe LUO <minwe@yunshipei.com>\n-Minwei Xu <faceswilliam@gmail.com>\n-Miorel Palii <miorel@fb.com>\n-Mitchel Humpherys <mitch.special@gmail.com>\n-Mitermayer Reis <mitermayer.reis@gmail.com>\n-Moacir Rosa <paulomoacir.junior@gmail.com>\n-Mojtaba Dashtinejad <mojtaba@gmail.com>\n-Morhaus <alexandre.kirszenberg@gmail.com>\n-Moshe Kolodny <kolodny.github@gmail.com>\n-Mouad Debbar <mdebbar@fb.com>\n-Murad <rogozhnikoff@users.noreply.github.com>\n-Murray M. Moss <murray@mmoss.name>\n-Murtaza Haveliwala <murtaza.sh@gmail.com>\n-NE-SmallTown <ne_smalltown@163.com>\n-Nadeesha Cabral <nadeesha.cabral@gmail.com>\n-Naman Goel <naman34@gmail.com>\n-Nate <nchristensen@deseretdigital.com>\n-Nate Hunzaker <nate.hunzaker@gmail.com>\n-Nate Lee <nathaniel.jy.lee88@gmail.com>\n-Nate Norberg <natenorberg@gmail.com>\n-Nathan Hardy <nhardy@users.noreply.github.com>\n-Nathan Smith <NogsMPLS@users.noreply.github.com>\n-Nathan White <nw@nwhite.net>\n-Nee <944316342@qq.com>\n-Neo <nihgwu@live.com>\n-Neri Marschik <marschik_neri@cyberagent.co.jp>\n-NestorTejero <webeafix@gmail.com>\n-Nguyen Truong Duy <truongduy134@yahoo.com>\n-Nicholas Bergson-Shilcock <me@nicholasbs.net>\n-Nicholas Clawson <nickclaw@users.noreply.github.com>\n-Nick Balestra <nickbalestra@users.noreply.github.com>\n-Nick Fitzgerald <fitzgen@gmail.com>\n-Nick Gavalas <njg57@cornell.edu>\n-Nick Kasten <kastencode@gmail.com>\n-Nick Merwin <nick@lemurheavy.com>\n-Nick Presta <nick@nickpresta.ca>\n-Nick Raienko <enaqxx@gmail.com>\n-Nick Thompson <ncthom91@gmail.com>\n-Nick Williams <WickyNilliams@users.noreply.github.com>\n-Nik Nyby <nnyby@columbia.edu>\n-Nikita Lebedev <bloomber111@gmail.com>\n-Niklas Bostr\u00f6m <nbostrom@gmail.com>\n-Nikoloz Buligini <nbuligini11@gmail.com>\n-Nima Jahanshahi <nbjahan@gmail.com>\n-Ning Xia <ning-github@users.noreply.github.com>\n-Niole Nelson <niolenelson@gmail.com>\n-Nolan Lawson <nolan@nolanlawson.com>\n-Nuno Campos <nuno@crowdprocess.com>\n-OJ Kwon <kwon.ohjoong@gmail.com>\n-Oiva Eskola <oiva.eskola@gmail.com>\n-Oleg <o.yanchinskiy@gmail.com>\n-Oleksii Markhovskyi <olexiy.markhovsky@gmail.com>\n-Oliver Zeigermann <oliver.zeigermann@gmail.com>\n-Olivier Tassinari <Olivier.tassinari@gmail.com>\n-Omid Hezaveh <omidfi@users.noreply.github.com>\n-Oscar Bolmsten <oscar-b@users.noreply.github.com>\n-Oskari Mantere <osku.mantere@gmail.com>\n-Owen Coutts <owenc@fb.com>\n-Pablo Lacerda de Miranda <pablolm@yahoo-inc.com>\n-Paolo Moretti <moretti@users.noreply.github.com>\n-Pascal Hartig <passy@twitter.com>\n-Patrick <info@telepark.de>\n-Patrick Finnigan <patrick.k.finnigan@gmail.com>\n-Patrick Laughlin <patrick@laughl.info>\n-Patrick Stapleton <github@gdi2290.com>\n-Paul Benigeri <me@benigeri.com>\n-Paul Harper <benekastah@gmail.com>\n-Paul Kehrer <paul.l.kehrer@gmail.com>\n-Paul Manta <paulmanta@users.noreply.github.com>\n-Paul O\u2019Shannessy <paul@oshannessy.com>\n-Paul Seiffert <paul.seiffert@gmail.com>\n-Paul Shen <paul@mnml0.com>\n-Pedro Nauck <pedronauck@gmail.com>\n-Pete Hunt <floydophone@gmail.com>\n-Peter Blazejewicz <peter.blazejewicz@gmail.com>\n-Peter Cottle <pcottle@fb.com>\n-Peter Jaros <peter.a.jaros@gmail.com>\n-Peter Newnham <peter.newnham@appsbroker.com>\n-Peter Ruibal <ruibalp@gmail.com>\n-Petri Lehtinen <petri@digip.org>\n-Petri Lievonen <plievone@cc.hut.fi>\n-Phil Quinn <philquinn90@gmail.com>\n-Phil Rajchgot <tophil@outlook.com>\n-Philip Jackson <p-jackson@live.com>\n-Philipp Spie\u00df <hello@philippspiess.com>\n-Pieter De Baets <pieter.debaets@gmail.com>\n-Pieter Vanderwerff <me@pieter.io>\n-Piotr Czajkowski <czajkowski.piotr@gmail.com>\n-Piper Chester <piperchester@gmail.com>\n-Pontus Abrahamsson <info@wdlinkoping.se>\n-Pouja Nikray <poujanik@gmail.com>\n-Prathamesh Sonpatki <csonpatki@gmail.com>\n-Prayag Verma <prayag.verma@gmail.com>\n-Preston Parry <ClimbsRocks@users.noreply.github.com>\n-Qin Junwen <kjj10@163.com>\n-RSG <Radi123@users.noreply.github.com>\n-Rachel D. Cartwright <stormchica@gmail.com>\n-Rafael <rafael.garcia@clever.com>\n-Rafael Angeline <me@rafaelangeline.com>\n-Rafal Dittwald <rafal.dittwald@gmail.com>\n-Ragnar \u00de\u00f3r Valgeirsson <ragnar.valgeirsson@gmail.com>\n-Rahul Gupta <rahulgupta4@practo.com>\n-Rainer Oviir <roviir@gmail.com>\n-Raito Bezarius <masterancpp@gmail.com>\n-Rajat Sehgal <rajatsehgal1988@gmail.com>\n-Rajiv Tirumalareddy <rajivtreddy@gmail.com>\n-Ram Kaniyur <quadrupleslap@users.noreply.github.com>\n-Randall Randall <randall@randallsquared.com>\n-Ray <ray@tomo.im>\n-Ray Dai <exiadbq@gmail.com>\n-Raymond Ha <raymond@shraymonks.com>\n-Reed Loden <reed@reedloden.com>\n-Remko Tron\u00e7on <git@el-tramo.be>\n-Ricardo <ddrjm@users.noreply.github.com>\n-Rich Harris <richard.a.harris@gmail.com>\n-Richard <riscarrott@googlemail.com>\n-Richard D. Worth <rdworth@gmail.com>\n-Richard Feldman <richard.t.feldman@gmail.com>\n-Richard Kho <hello@richardkho.com>\n-Richard Littauer <richard.littauer@gmail.com>\n-Richard Livesey <Livesey7@hotmail.co.uk>\n-Richard Maisano <rickmaisano@gmail.com>\n-Richard Roncancio <batusai513@msn.com>\n-Richard Wood <rwoodnz@gmail.com>\n-Richie Thomas <rickthomas1980@gmail.com>\n-Rick Beerendonk <rick@beerendonk.com>\n-Rick Ford <rickfordrick@gmail.com>\n-Riley Tomasek <riley.tomasek@gmail.com>\n-Rob Arnold <robarnold@cs.cmu.edu>\n-Robert Binna <rbinna@gmail.com>\n-Robert Chang <cht8687@gmail.com>\n-Robert Haritonov <r@rhr.me>\n-Robert Kielty <rob.kielty@gmail.com>\n-Robert Knight <robert.knight@mendeley.com>\n-Robert Martin <rmartin@rmart.in>\n-Robert Sedovsek <robert.sedovsek@gmail.com>\n-Robin Berjon <robin@berjon.com>\n-Robin Frischmann <robin@rofrischmann.de>\n-Robin Ricard <ricard.robin@gmail.com>\n-Roderick Hsiao <roderickhsiao@users.noreply.github.com>\n-Rodrigo Pombo <pombopombopombo@gmail.com>\n-Rohan Nair <rohan@objectiveiq.com>\n-Roman Liutikov <roman01la@romanliutikov.com>\n-Roman Matusevich <roma.matusevich@gmail.com>\n-Roman Pominov <rpominov+github@gmail.com>\n-Roman Vanesyan <roman.vanesyan@gmail.com>\n-Rui Ara\u00fajo <ruka.araujo@gmail.com>\n-Russ <russwirtz@gmail.com>\n-Ryan Lahfa <masterancpp@gmail.com>\n-Ryan Seddon <seddon.ryan@gmail.com>\n-Ryo Shibayama <j02521@gmail.com>\n-Sahat Yalkabov <sakhat@gmail.com>\n-Saif Hakim <saif@benchling.com>\n-Saiichi Hashimoto <saiichihashimoto@gmail.com>\n-Sakina Crocker <sakinac@gmail.com>\n-Sam Balana <sam.balana@ardentacademy.com>\n-Sam Beveridge <sbeveridge@saltstack.com>\n-Sam Saccone <samccone@gmail.com>\n-Sam Selikoff <sam.selikoff@gmail.com>\n-Samer Buna <samerbuna@users.noreply.github.com>\n-Samuel <savepointsam@gmail.com>\n-Samuel Hap\u00e1k <samuel.hapak@gmail.com>\n-Samuel Reed <samuel.trace.reed@gmail.com>\n-Samuel Scheiderich <samsch@users.noreply.github.com>\n-Samy Al Zahrani <samy@sadeem.net>\n-Sander Spies <sandermail@gmail.com>\n-Sasha Aickin <xander76@yahoo.com>\n-Sassan Haradji <sassanh@gmail.com>\n-Satoshi Nakajima <satoshi.nakajima@gmail.com>\n-Scott <scottdomes@gmail.com>\n-Scott Burch <scott@bulldoginfo.com>\n-Scott Feeney <scott@oceanbase.org>\n-Sean Gransee <sean.gransee@gmail.com>\n-Sean Kinsey <oyvind@fb.com>\n-Sean Smith <sean.smith.2009@gmail.com>\n-Seba <sebaest77@gmail.com>\n-Sebastian Markb\u00e5ge <sebastian@calyptus.eu>\n-Sebastian McKenzie <sebmck@gmail.com>\n-Senin Roman <Rastopyr@gmail.com>\n-Seoh Char <devthewild@gmail.com>\n-Sercan Eraslan <sercan.eraslan@sahibinden.com>\n-Serg <undrdog@yandex.ru>\n-Sergey Generalov <sergey@genbit.ru>\n-Sergey Rubanov <chi187@gmail.com>\n-Seyi Adebajo <hello@seyinanigans.com>\n-Shane O'Sullivan <shaneosullivan1@gmail.com>\n-Shaun Trennery <shaun.trennery@gmail.com>\n-ShihChi Huang <hhuang@netflix.com>\n-Shim Won <marocchino@gmail.com>\n-Shinnosuke Watanabe <snnskwtnb@gmail.com>\n-Shogun Sea <shogunsea08@gmail.com>\n-Shota Kubota <kubosho@users.noreply.github.com>\n-Shripad K <assortmentofsorts@gmail.com>\n-Shubheksha Jalan <jshubheksha@gmail.com>\n-Shuhei Kagawa <shuhei.kagawa@gmail.com>\n-Sibi <psibi2000@gmail.com>\n-Simen Bekkhus <sbekkhus91@gmail.com>\n-Simon H\u00f8jberg <r.hackr@gmail.com>\n-Simon Welsh <simon@simon.geek.nz>\n-Simone Vittori <hello@simonewebdesign.it>\n-Skasi <skasski@gmx.at>\n-Snowmanzzz(Zhengzhong Zhao) <zhengzhongzhao@gmail.com>\n-Soichiro Kawamura <mail@w-st.com>\n-Soo Jae Hwang <misoguy1985@gmail.com>\n-Sophia <szensius@gmail.com>\n-Sophia Westwood <sophia@quip.com>\n-Sophie Alpert <git@sophiebits.com>\n-Sota Ohara <ohrst.18@gmail.com>\n-Spen Taylor <spen_@hotmail.co.uk>\n-Spencer Ahrens <sahrens@users.noreply.github.com>\n-Spencer Handley <spencerhandley@gmail.com>\n-Sriram Thiagarajan <sri.sjc@gmail.com>\n-Stefan Dombrowski <sdo451@gmail.com>\n-Stephen John Sorensen <spudly@users.noreply.github.com>\n-Stephen Murphy <smurphy3@apple.com>\n-Stephie <Stephie@users.noreply.github.com>\n-Sterling Cobb <sterlingcobb@gmail.com>\n-Steve Baker <_steve_@outlook.com>\n-Steve Mao <maochenyan@gmail.com>\n-Steven Luscher <react@steveluscher.com>\n-Steven Syrek <sjsyrek@users.noreply.github.com>\n-Steven Vachon <contact@svachon.com>\n-Stolenkid <stolen.kid7@gmail.com>\n-Stoyan Stefanov <ssttoo@ymail.com>\n-Stuart Harris <stuart.harris@red-badger.com>\n-SunHuawei <stonesun@aliyun.com>\n-Sundeep Malladi <sundeep.malladi@gmail.com>\n-Sung Won Cho <mikeswcho@gmail.com>\n-Sunny Juneja <me@sunnyjuneja.com>\n-Sunny Ripert <sunny@sunfox.org>\n-Superlaziness <shemyakin@me.com>\n-Sven Helmberger <fforw@gmx.de>\n-Sverre Johansen <sverre.johansen@gmail.com>\n-Swaroop SM <swaroop.striker@gmail.com>\n-S\u00e9bastien Lorber <lorber.sebastien@gmail.com>\n-S\u0142awomir Laskowski <laskowski.box@gmail.com>\n-Taegon Kim <gonom9@gmail.com>\n-Taeho Kim <dittos@gmail.com>\n-Taehwan, No <taehwanno.dev@gmail.com>\n-Tanase Hagi <TanaseHagi@users.noreply.github.com>\n-Tanner <devtanc@gmail.com>\n-Tay Yang Shun <tay.yang.shun@gmail.com>\n-Ted Kim <ted@vcnc.co.kr>\n-TedPowers <TedPowers@users.noreply.github.com>\n-Tengfei Guo <terryr3rd@yeah.net>\n-Teodor Szente <teodor98sz@gmail.com>\n-Tetsuharu OHZEKI <saneyuki.s.snyk@gmail.com>\n-Tetsuya Hasegawa <tetsuya.chicago@gmail.com>\n-Thibaut Rizzi <zoom@rhizom.fr>\n-Thomas Aylott <oblivious@subtlegradient.com>\n-Thomas Boyt <thomas.boyt@venmo.com>\n-Thomas Broadley <buriedunderbooks@hotmail.com>\n-Thomas Reggi <socialtr@gmail.com>\n-Thomas R\u00f6ggla <t.roggla@cwi.nl>\n-Thomas Shaddox <thomas@heyzap.com>\n-Thomas Shafer <thomasjshafer@gmail.com>\n-ThomasCrvsr <crevoisier.thomas@gmail.com>\n-Tiago Fernandez <tiago.fernandez@gmail.com>\n-Tienchai Wirojsaksaree <tienchai@fb.com>\n-Tim Routowicz <troutowicz@gmail.com>\n-Tim Schaub <tschaub@users.noreply.github.com>\n-Timothy Yung <yungsters@gmail.com>\n-Timur Carpeev <timuric@users.noreply.github.com>\n-Tobias Reiss <tag+github@basecode.de>\n-Tom Duncalf <tom@tomduncalf.com>\n-Tom Gasson <tom.gasson@arup.com>\n-Tom Haggie <thaggie@gmail.com>\n-Tom Hauburger <thauburger@gmail.com>\n-Tom MacWright <tom@macwright.org>\n-Tom Occhino <tomocchino@gmail.com>\n-Tomasz Ko\u0142odziejski <tkolodziejski@gmail.com>\n-Tomoya Suzuki <tmysz.dev@gmail.com>\n-Tom\u00e1\u0161 Hromada <Gyfis@seznam.cz>\n-Tony Rossi <tony@iamrossi.com>\n-Tony Spiro <tspiro@tonyspiro.com>\n-Toru Kobayashi <koba0004@gmail.com>\n-Trevor Smith <trevorlynnsmith@gmail.com>\n-Trinh Hoang Nhu <trinhhoangnhu@gmail.com>\n-Troy DeMonbreun <github@troyd.net>\n-Tsung Hung <thung@me.com>\n-Tyler Brock <tyler.brock@gmail.com>\n-Tyler Buchea <tyler@buchea.com>\n-Tyler Deitz <tylerdeitz@gmail.com>\n-Ujjwal Ojha <ojhaujjwal@users.noreply.github.com>\n-Uladzimir Havenchyk <uladzimir@toptal.com>\n-Usman <syedusmanajmal@gmail.com>\n-Ustin Zarubin <ustin.zarubin@campusbellhops.com>\n-Vadim Chernysh <chernysh.vadim@gmail.com>\n-Valentin Shergin <valentin@shergin.com>\n-Van der Auwermeulen Gr\u00e9goire <gregoirevandera@gmail.com>\n-Varayut Lerdkanlayanawat <l.varayut@gmail.com>\n-Varun Bhuvanendran <varunbhuvanendran@users.noreply.github.com>\n-Varun Rau <varunrau@gmail.com>\n-Vasiliy Loginevskiy <Yeti.or@gmail.com>\n-Vedat Mahir YILMAZ <mahir@vedatmahir.com>\n-Veljko Tornjanski <tornjanski.veljko@gmail.com>\n-Vesa Laakso <laakso.vesa@gmail.com>\n-Victor Alvarez <v.alvarez312@gmail.com>\n-Victor Homyakov <vkhomyackov@gmail.com>\n-Victor Koenders <victor.koenders@gmail.com>\n-Victoria Quirante <victoria.quirante@gmail.com>\n-Vikash Agrawal <vikashagrawal1990@gmail.com>\n-Ville Immonen <ville.immonen@iki.fi>\n-Vincent Riemer <vincentriemer@gmail.com>\n-Vincent Siao <vincent@asana.com>\n-Vincent Taing <taing.vincent@gmail.com>\n-Vipul A M <vipulnsward@gmail.com>\n-Vitaliy Potapov <noginsk@rambler.ru>\n-Vitaly Kramskikh <vkramskikh@gmail.com>\n-Vitor Balocco <vitorbal@gmail.com>\n-Vjeux <vjeuxx@gmail.com>\n-Vladimir Kovpak <cn007b@gmail.com>\n-Vladimir Tikunov <vtikunov@yandex.ru>\n-Volkan Unsal <spocksplanet@gmail.com>\n-Wander Wang <wander.wang@ismole.com>\n-Wayne Larsen <wayne@larsen.st>\n-Weizenlol <winliveweiz@gmail.com>\n-Whien <sal95610@gmail.com>\n-WickyNilliams <WickyNilliams@MBA>\n-Will Myers <will@usebutton.com>\n-William Hoffmann <whoffpen@gmail.com>\n-Wincent Colaiuta <win@wincent.com>\n-Wout Mertens <Wout.Mertens@gmail.com>\n-Xavier Morel <xmo-odoo@users.noreply.github.com>\n-XuefengWu <benewu@gmail.com>\n-Yakov Dalinchuk <murashki@users.noreply.github.com>\n-Yan Li <mangakjd@gmail.com>\n-Yasar icli <hello@yasaricli.com>\n-Yaxian <yaxian.gu@gmail.com>\n-YouBao Nong <noyobo@gmail.com>\n-Yuichi Hagio <yhagio87@gmail.com>\n-Yura Chuchola <smhfanda@gmail.com>\n-Yuriy Dybskiy <yuriy@dybskiy.com>\n-Yusong Liu <lysnku@gmail.com>\n-Yutaka Nakajima <nakazye@gmail.com>\n-Yuval Dekel <thedekel@fb.com>\n-Zac Braddy <zacharybraddy@gmail.com>\n-Zac Smith <billyzacsmith@gmail.com>\n-Zach Bruggeman <mail@bruggie.com>\n-Zach Ramaekers <zramaekers@gmail.com>\n-Zacharias <zachasme@users.noreply.github.com>\n-Zeke Sikelianos <zeke@sikelianos.com>\n-Zhangjd <zhang.jd@qq.com>\n-adraeth <jerzy.mirecki@gmail.com>\n-ankitml <ankitml@gmail.com>\n-arush <arush@ilovebrands.net>\n-bel3atar <bel3atar@aol.com>\n-brafdlog <brafdlog@gmail.com>\n-brillout <brillout@users.noreply.github.com>\n-chen <kikyous@163.com>\n-chocolateboy <chocolate@cpan.org>\n-cjshawMIT <cjshaw@mit.edu>\n-clariroid <clarinette.uranus@gmail.com>\n-claudiopro <claudio.procida@gmail.com>\n-cloudy1 <mohaned@cloudypedia.com>\n-comerc <comerc@users.noreply.github.com>\n-cutbko <kutsenko.eugene@hotmail.com>\n-davidxi <davidgraycn@gmail.com>\n-dfrownfelter <davidrfrownfelter@gmail.com>\n-djskinner <skinner@destiny-denied.co.uk>\n-dongmeng.ldm <dongmeng.ldm@alibaba-inc.com>\n-everdimension <everdimension@gmail.com>\n-gillchristian <gillchristiang@gmail.com>\n-gitanupam <anupamjain@gmail.com>\n-guoyong yi <451417726@qq.com>\n-hanumanthan <hanu.sas@gmail.com>\n-hao.huang <hao.huang@aliyun.com>\n-hjmoss <hjmoss@users.noreply.github.com>\n-hkal <hkal@users.noreply.github.com>\n-iamchenxin <iamchenxin@gmail.com>\n-iamdoron <doronpagot@gmail.com>\n-iawia002 <z2d@jifangcheng.com>\n-imagentleman <imagentlemail@gmail.com>\n-imjanghyuk <im.janghyuk@gmail.com>\n-inkinworld <inkinworld@live.com>\n-jaaberg <aaberg89@gmail.com>\n-jddxf <740531372@qq.com>\n-jinmmd <jinmmd@gmail.com>\n-koh-taka <koh-taka@users.noreply.github.com>\n-kohashi85 <hako584@gmail.com>\n-ksvitkovsky <ksvitkovsky@yandex.ru>\n-laiso <laiso@lai.so>\n-lamo2k123 <lamo2k123@gmail.com>\n-leeyoungalias <leeyoungalias@qq.com>\n-li.li <li.li@ele.me>\n-lucas <lucas.aragno157@gmail.com>\n-maxprafferty <maxprafferty@gmail.com>\n-mdogadailo <m.dogadailo@gmail.com>\n-mfijas <michal.fijas@gmail.com>\n-mguidotto <j8.matteo@gmail.com>\n-mondaychen <monday.chen@gmail.com>\n-najisawas <naji_sawas@gmx.com>\n-neeldeep <neeldeep@users.noreply.github.com>\n-newvlad <vladdr@live.com>\n-nhducit <nhducit@users.noreply.github.com>\n-ogom <ogom@outlook.com>\n-pingan1927 <pengsencai1986@gmail.com>\n-rgarifullin <ringarifullin@gmail.com>\n-saiyagg <saiyagg@gmail.com>\n-scloudyy <onecloud.shen@gmail.com>\n-segmentationfaulter <segmentationfaulter@users.noreply.github.com>\n-shifengchen <shifengchen10@gmail.com>\n-songawee <dennis@songawee.com>\n-starkch <chp.sitark@autodesk.com>\n-sugarshin <shinsugar@gmail.com>\n-tokikuch <msmania@users.noreply.github.com>\n-ventuno <ventuno@users.noreply.github.com>\n-wacii <w.a.cunningham.ii@gmail.com>\n-wali-s <ahmad3y2k@hotmail.com>\n-walrusfruitcake <walrusfruitcake@users.noreply.github.com>\n-yiminghe <yiminghe@gmail.com>\n-youmoo <youmoolee@gmail.com>\n-yuntao.qyt <yuntao.qyt@alibaba-inc.com>\n-z.ky <zky829@users.noreply.github.com>\n-zhangjg <jinguozhang@qq.com>\n-zhangs <zhangtreefish@yahoo.com>\n-zombieJ <smith3816@gmail.com>\n-zwhitchcox <zwhitchcox@gmail.com>\n-\u00c1rni Hermann Reynisson <arnihr@gmail.com>\n-\u5143\u5f66 <yuanyan@users.noreply.github.com>\n-\u51cc\u6052 <jiakun.dujk@alibaba-inc.com>\n-\u5f20\u654f <cookfront@gmail.com>\n-\u738b\u6653\u52c7 <Plortinus@gmail.com>\n-\u9f99\u6d77\u71d5 <1250766229@qq.com>"
            },
            {
                "file": "CHANGELOG-canary.md",
                "git_diff": "@@ -1,3 +1,8 @@\n+## March 22, 2024 (18.3.0-canary-670811593-20240322)\n+\n+## React\n+- Added `useActionState` to replace `useFormState` and added `pending` value ([#28491](https://github.com/facebook/react/pull/28491)).\n+\n ## October 5, 2023 (18.3.0-canary-546178f91-20231005)\n \n ### React"
            },
            {
                "file": "CHANGELOG.md",
                "git_diff": "@@ -1,3 +1,28 @@\n+## 18.3.1 (April 26, 2024)\n+\n+- Export `act` from `react` [f1338f](https://github.com/facebook/react/commit/f1338f8080abd1386454a10bbf93d67bfe37ce85)\n+\n+## 18.3.0 (April 25, 2024)\n+\n+This release is identical to 18.2 but adds warnings for deprecated APIs and other changes that are needed for React 19.\n+\n+Read the [React 19 Upgrade Guide](https://react.dev/blog/2024/04/25/react-19-upgrade-guide) for more info.\n+\n+### React\n+\n+- Allow writing to `this.refs` to support string ref codemod [909071](https://github.com/facebook/react/commit/9090712fd3ca4e1099e1f92e67933c2cb4f32552)\n+- Warn for deprecated `findDOMNode` outside StrictMode [c3b283](https://github.com/facebook/react/commit/c3b283964108b0e8dbcf1f9eb2e7e67815e39dfb)\n+- Warn for deprecated `test-utils` methods [d4ea75](https://github.com/facebook/react/commit/d4ea75dc4258095593b6ac764289f42bddeb835c)\n+- Warn for deprecated Legacy Context outside StrictMode [415ee0](https://github.com/facebook/react/commit/415ee0e6ea0fe3e288e65868df2e3241143d5f7f)\n+- Warn for deprecated string refs outside StrictMode [#25383](https://github.com/facebook/react/pull/25383)\n+- Warn for deprecated `defaultProps` for function components [#25699](https://github.com/facebook/react/pull/25699)\n+- Warn when spreading `key` [#25697](https://github.com/facebook/react/pull/25697)\n+- Warn when using `act` from `test-utils` [d4ea75](https://github.com/facebook/react/commit/d4ea75dc4258095593b6ac764289f42bddeb835c)\n+\n+### React DOM\n+- Warn for deprecated `unmountComponentAtNode` [8a015b](https://github.com/facebook/react/commit/8a015b68cc060079878e426610e64e86fb328f8d)\n+- Warn for deprecated `renderToStaticNodeStream` [#28874](https://github.com/facebook/react/pull/28874)\n+\n ## 18.2.0 (June 14, 2022)\n \n ### React DOM"
            },
            {
                "file": "README.md",
                "git_diff": "@@ -1,10 +1,10 @@\n-# [React](https://react.dev/) &middot; [![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://github.com/facebook/react/blob/main/LICENSE) [![npm version](https://img.shields.io/npm/v/react.svg?style=flat)](https://www.npmjs.com/package/react) [![CircleCI Status](https://circleci.com/gh/facebook/react.svg?style=shield)](https://circleci.com/gh/facebook/react) [![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://legacy.reactjs.org/docs/how-to-contribute.html#your-first-pull-request)\n+# [React](https://react.dev/) &middot; [![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://github.com/facebook/react/blob/main/LICENSE) [![npm version](https://img.shields.io/npm/v/react.svg?style=flat)](https://www.npmjs.com/package/react) [![(Runtime) Build and Test](https://github.com/facebook/react/actions/workflows/runtime_build_and_test.yml/badge.svg)](https://github.com/facebook/react/actions/workflows/runtime_build_and_test.yml) [![(Compiler) TypeScript](https://github.com/facebook/react/actions/workflows/compiler_typescript.yml/badge.svg?branch=main)](https://github.com/facebook/react/actions/workflows/compiler_typescript.yml) [![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](https://legacy.reactjs.org/docs/how-to-contribute.html#your-first-pull-request)\n \n React is a JavaScript library for building user interfaces.\n \n * **Declarative:** React makes it painless to create interactive UIs. Design simple views for each state in your application, and React will efficiently update and render just the right components when your data changes. Declarative views make your code more predictable, simpler to understand, and easier to debug.\n * **Component-Based:** Build encapsulated components that manage their own state, then compose them to make complex UIs. Since component logic is written in JavaScript instead of templates, you can easily pass rich data through your app and keep the state out of the DOM.\n-* **Learn Once, Write Anywhere:** We don't make assumptions about the rest of your technology stack, so you can develop new features in React without rewriting existing code. React can also render on the server using Node and power mobile apps using [React Native](https://reactnative.dev/).\n+* **Learn Once, Write Anywhere:** We don't make assumptions about the rest of your technology stack, so you can develop new features in React without rewriting existing code. React can also render on the server using [Node](https://nodejs.org/en) and power mobile apps using [React Native](https://reactnative.dev/).\n \n [Learn how to use React in your project](https://react.dev/learn).\n \n@@ -18,7 +18,7 @@ React has been designed for gradual adoption from the start, and **you can use a\n \n ## Documentation\n \n-You can find the React documentation [on the website](https://react.dev/).  \n+You can find the React documentation [on the website](https://react.dev/).\n \n Check out the [Getting Started](https://react.dev/learn) page for a quick overview.\n \n@@ -55,7 +55,7 @@ root.render(<HelloMessage name=\"Taylor\" />);\n \n This example will render \"Hello Taylor\" into a container on the page.\n \n-You'll notice that we used an HTML-like syntax; [we call it JSX](https://react.dev/learn#writing-markup-with-jsx). JSX is not required to use React, but it makes code more readable, and writing it feels like writing HTML. \n+You'll notice that we used an HTML-like syntax; [we call it JSX](https://react.dev/learn#writing-markup-with-jsx). JSX is not required to use React, but it makes code more readable, and writing it feels like writing HTML.\n \n ## Contributing\n \n@@ -69,7 +69,7 @@ Facebook has adopted a Code of Conduct that we expect project participants to ad\n \n Read our [contributing guide](https://legacy.reactjs.org/docs/how-to-contribute.html) to learn about our development process, how to propose bugfixes and improvements, and how to build and test your changes to React.\n \n-### Good First Issues\n+### [Good First Issues](https://github.com/facebook/react/labels/good%20first%20issue)\n \n To help you get your feet wet and get you familiar with our contribution process, we have a list of [good first issues](https://github.com/facebook/react/labels/good%20first%20issue) that contain bugs that have a relatively limited scope. This is a great place to get started.\n "
            },
            {
                "file": "ReactVersions.js",
                "git_diff": "@@ -7,52 +7,57 @@\n //\n // The @latest channel uses the version as-is, e.g.:\n //\n-//   18.3.0\n+//   19.0.0\n //\n // The @canary channel appends additional information, with the scheme\n // <version>-<label>-<commit_sha>, e.g.:\n //\n-//   18.3.0-canary-a1c2d3e4\n+//   19.0.0-canary-a1c2d3e4\n //\n // The @experimental channel doesn't include a version, only a date and a sha, e.g.:\n //\n //   0.0.0-experimental-241c4467e-20200129\n \n-const ReactVersion = '18.3.0';\n+const ReactVersion = '19.0.0';\n \n // The label used by the @canary channel. Represents the upcoming release's\n // stability. Most of the time, this will be \"canary\", but we may temporarily\n // choose to change it to \"alpha\", \"beta\", \"rc\", etc.\n //\n // It only affects the label used in the version string. To customize the\n-// npm dist tags used during publish, refer to .circleci/config.yml.\n-const canaryChannelLabel = 'canary';\n+// npm dist tags used during publish, refer to .github/workflows/runtime_prereleases_*.yml.\n+const canaryChannelLabel = 'rc';\n+\n+// If the canaryChannelLabel is \"rc\", the build pipeline will use this to build\n+// an RC version of the packages.\n+const rcNumber = 0;\n \n const stablePackages = {\n-  'eslint-plugin-react-hooks': '5.0.0',\n-  'jest-react': '0.15.0',\n+  'eslint-plugin-react-hooks': '5.1.0',\n+  'jest-react': '0.16.0',\n   react: ReactVersion,\n   'react-art': ReactVersion,\n   'react-dom': ReactVersion,\n   'react-server-dom-webpack': ReactVersion,\n   'react-server-dom-turbopack': ReactVersion,\n   'react-is': ReactVersion,\n-  'react-reconciler': '0.30.0',\n-  'react-refresh': '0.15.0',\n+  'react-reconciler': '0.31.0',\n+  'react-refresh': '0.16.0',\n   'react-test-renderer': ReactVersion,\n-  'use-subscription': '1.9.0',\n-  'use-sync-external-store': '1.3.0',\n-  scheduler: '0.24.0',\n+  'use-subscription': '1.10.0',\n+  'use-sync-external-store': '1.4.0',\n+  scheduler: '0.25.0',\n };\n \n // These packages do not exist in the @canary or @latest channel, only\n // @experimental. We don't use semver, just the commit sha, so this is just a\n // list of package names instead of a map.\n-const experimentalPackages = [];\n+const experimentalPackages = ['react-markup'];\n \n module.exports = {\n   ReactVersion,\n   canaryChannelLabel,\n+  rcNumber,\n   stablePackages,\n   experimentalPackages,\n };"
            },
            {
                "file": "compiler/.eslintrc.js",
                "git_diff": "@@ -0,0 +1,106 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+/**\n+ * Our philosophy for linting is that lints should be very high-signal:\n+ * - Error, don't warn. If it's worth mentioning it's worth fixing.\n+ * - Enable rules that consistently identify real problems. If we frequently would have to\n+ *   disable the rule due to false positives, it isn't high-signal.\n+ * - Enable rules that help improve consistent style (to avoid code review about style rather\n+ *   than substance).\n+ */\n+module.exports = {\n+  extends: [\"eslint:recommended\", \"plugin:@typescript-eslint/recommended\"],\n+  rules: {\n+    /*\n+     * We prefer using const where variables are not reassigned, but occassional mistakes\n+     * aren't a major issue\n+     */\n+    \"prefer-const\": \"off\",\n+\n+    // Not valuable enough to enable\n+    \"no-useless-escape\": \"off\",\n+\n+    /*\n+     * There are valid use cases for loops with constant conditions where the body contains the\n+     * break\n+     */\n+    \"no-constant-condition\": \"off\",\n+\n+    // eslint only knows about builtin control flow (eg throw, return, break) and not custom ones\n+    // like invariant.\n+    \"no-fallthrough\": \"off\",\n+\n+    /*\n+     * Low-value: this fires even for declarations that capture references which wouldn't be as\n+     * obvious if the declaration was lifted to the parent root\n+     */\n+    \"no-inner-declarations\": \"off\",\n+\n+    \"multiline-comment-style\": [\"error\", \"starred-block\"],\n+\n+    /**\n+     * We sometimes need to check for control characters in regexes for things like preserving input\n+     * strings\n+     */\n+    \"no-control-regex\": \"off\",\n+\n+    \"@typescript-eslint/no-empty-function\": \"off\",\n+\n+    /*\n+     * Explicitly casting to/through any is sometimes required, often for error messages to\n+     * assertExhaustive()\n+     */\n+    \"@typescript-eslint/no-explicit-any\": \"off\",\n+\n+    /*\n+     * We use non-null assertions carefully. Ideally, there would be a TS option to codegen\n+     * a non-null check at the assertion site.\n+     */\n+    \"@typescript-eslint/no-non-null-assertion\": \"off\",\n+\n+    // Being explicit provides value in cases where inference may later change\n+    \"@typescript-eslint/no-inferrable-types\": \"off\",\n+    \"@typescript-eslint/explicit-function-return-type\": \"error\",\n+\n+    /*\n+     * Unused variables are frequently a bug. Prefix unused variables with an _ to fix, but note\n+     * that eslint won't warn you that an underscore prefixed variable is used and that the prefix\n+     * should be dropped.\n+     */\n+    \"@typescript-eslint/no-unused-vars\": [\n+      \"error\",\n+      {\n+        argsIgnorePattern: \"^_\",\n+        varsIgnorePattern: \"^_\",\n+        caughtErrorsIgnorePattern: \"^_\",\n+      },\n+    ],\n+\n+    // Consider enabling for consistency. Ideally violations could be auto-fixed.\n+    \"@typescript-eslint/consistent-generic-constructors\": [\n+      \"off\",\n+      \"constructor\",\n+    ],\n+    \"@typescript-eslint/array-type\": [\"error\", { default: \"generic\" }],\n+    \"@typescript-eslint/triple-slash-reference\": \"off\",\n+    \"@typescript-eslint/no-var-requires\": \"off\",\n+  },\n+  parser: \"@typescript-eslint/parser\",\n+  plugins: [\"@typescript-eslint\"],\n+  root: true,\n+  ignorePatterns: [\"**/__tests__/**/*\", \"**/*.d.ts\", \"**/dist/**/*\"],\n+  env: {\n+    node: true,\n+  },\n+  /*\n+   * If rules need to be disabled then the rule is insufficiently high signal\n+   * and should be diasbled altogether or customized (in either case via a standalone PR)\n+   */\n+  noInlineConfig: true,\n+  reportUnusedDisableDirectives: true,\n+};"
            },
            {
                "file": "compiler/.gitignore",
                "git_diff": "@@ -0,0 +1,24 @@\n+.DS_Store\n+.spr.yml\n+\n+# Generated by Cargo\n+# will have compiled files and executables\n+debug/\n+target/\n+\n+# These are backup files generated by rustfmt\n+**/*.rs.bk\n+\n+# MSVC Windows builds of rustc generate these, which store debugging information\n+*.pdb\n+\n+node_modules\n+.watchmanconfig\n+.watchman-cookie-*\n+dist\n+.vscode\n+!packages/playground/.vscode\n+.spr.yml\n+testfilter.txt\n+\n+bundle-oss.sh\n\\ No newline at end of file"
            },
            {
                "file": "compiler/Cargo.lock",
                "git_diff": "@@ -0,0 +1,1217 @@\n+# This file is automatically @generated by Cargo.\n+# It is not intended for manual editing.\n+version = 3\n+\n+[[package]]\n+name = \"addr2line\"\n+version = \"0.20.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"f4fa78e18c64fce05e902adecd7a5eed15a5e0a3439f7b0e169f0252214865e3\"\n+dependencies = [\n+ \"gimli\",\n+]\n+\n+[[package]]\n+name = \"adler\"\n+version = \"1.0.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"f26201604c87b1e01bd3d98f8d5d9a8fcbb815e8cedb41ffccbeb4bf593a35fe\"\n+\n+[[package]]\n+name = \"ahash\"\n+version = \"0.7.6\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"fcb51a0695d8f838b1ee009b3fbf66bda078cd64590202a864a8f3e8c4315c47\"\n+dependencies = [\n+ \"getrandom\",\n+ \"once_cell\",\n+ \"version_check\",\n+]\n+\n+[[package]]\n+name = \"aho-corasick\"\n+version = \"0.7.20\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"cc936419f96fa211c1b9166887b38e5e40b19958e5b895be7c1f93adec7071ac\"\n+dependencies = [\n+ \"memchr\",\n+]\n+\n+[[package]]\n+name = \"aho-corasick\"\n+version = \"1.0.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"43f6cb1bf222025340178f382c426f13757b2960e89779dfcb319c32542a5a41\"\n+dependencies = [\n+ \"memchr\",\n+]\n+\n+[[package]]\n+name = \"anyhow\"\n+version = \"1.0.71\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"9c7d0618f0e0b7e8ff11427422b64564d5fb0be1940354bfe2e0529b18a9d9b8\"\n+\n+[[package]]\n+name = \"backtrace\"\n+version = \"0.3.68\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"4319208da049c43661739c5fade2ba182f09d1dc2299b32298d3a31692b17e12\"\n+dependencies = [\n+ \"addr2line\",\n+ \"cc\",\n+ \"cfg-if\",\n+ \"libc\",\n+ \"miniz_oxide\",\n+ \"object\",\n+ \"rustc-demangle\",\n+]\n+\n+[[package]]\n+name = \"backtrace-ext\"\n+version = \"0.2.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"537beee3be4a18fb023b570f80e3ae28003db9167a751266b259926e25539d50\"\n+dependencies = [\n+ \"backtrace\",\n+]\n+\n+[[package]]\n+name = \"base64\"\n+version = \"0.13.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"9e1b586273c5702936fe7b7d6896644d8be71e6314cfe09d3167c95f712589e8\"\n+\n+[[package]]\n+name = \"bitflags\"\n+version = \"1.3.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"bef38d45163c2f1dde094a7dfd33ccf595c92905c8f8f4fdc18d06fb1037718a\"\n+\n+[[package]]\n+name = \"bitflags\"\n+version = \"2.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b4682ae6287fcf752ecaabbfcc7b6f9b72aa33933dc23a554d853aea8eea8635\"\n+\n+[[package]]\n+name = \"bstr\"\n+version = \"1.5.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"a246e68bb43f6cd9db24bea052a53e40405417c5fb372e3d1a8a7f770a564ef5\"\n+dependencies = [\n+ \"memchr\",\n+ \"serde\",\n+]\n+\n+[[package]]\n+name = \"cc\"\n+version = \"1.0.79\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"50d30906286121d95be3d479533b458f87493b30a4b5f79a607db8f5d11aa91f\"\n+\n+[[package]]\n+name = \"cfg-if\"\n+version = \"1.0.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"baf1de4339761588bc0619e3cbc0120ee582ebb74b53b4efbf79117bd2da40fd\"\n+\n+[[package]]\n+name = \"cmake\"\n+version = \"0.1.50\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"a31c789563b815f77f4250caee12365734369f942439b7defd71e18a48197130\"\n+dependencies = [\n+ \"cc\",\n+]\n+\n+[[package]]\n+name = \"console\"\n+version = \"0.15.7\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c926e00cc70edefdc64d3a5ff31cc65bb97a3460097762bd23afb4d8145fccf8\"\n+dependencies = [\n+ \"encode_unicode\",\n+ \"lazy_static\",\n+ \"libc\",\n+ \"windows-sys 0.45.0\",\n+]\n+\n+[[package]]\n+name = \"convert_case\"\n+version = \"0.6.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"ec182b0ca2f35d8fc196cf3404988fd8b8c739a4d270ff118a398feb0cbec1ca\"\n+dependencies = [\n+ \"unicode-segmentation\",\n+]\n+\n+[[package]]\n+name = \"ctor\"\n+version = \"0.2.4\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"1f34ba9a9bcb8645379e9de8cb3ecfcf4d1c85ba66d90deb3259206fa5aa193b\"\n+dependencies = [\n+ \"quote\",\n+ \"syn 2.0.23\",\n+]\n+\n+[[package]]\n+name = \"encode_unicode\"\n+version = \"0.3.6\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"a357d28ed41a50f9c765dbfe56cbc04a64e53e5fc58ba79fbc34c10ef3df831f\"\n+\n+[[package]]\n+name = \"equivalent\"\n+version = \"1.0.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"88bffebc5d80432c9b140ee17875ff173a8ab62faad5b257da912bd2f6c1c0a1\"\n+\n+[[package]]\n+name = \"errno\"\n+version = \"0.3.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"4bcfec3a70f97c962c307b2d2c56e358cf1d00b558d74262b5f929ee8cc7e73a\"\n+dependencies = [\n+ \"errno-dragonfly\",\n+ \"libc\",\n+ \"windows-sys 0.48.0\",\n+]\n+\n+[[package]]\n+name = \"errno-dragonfly\"\n+version = \"0.1.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"aa68f1b12764fab894d2755d2518754e71b4fd80ecfb822714a1206c2aab39bf\"\n+dependencies = [\n+ \"cc\",\n+ \"libc\",\n+]\n+\n+[[package]]\n+name = \"fnv\"\n+version = \"1.0.7\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"3f9eec918d3f24069decb9af1554cad7c880e2da24a9afd88aca000531ab82c1\"\n+\n+[[package]]\n+name = \"form_urlencoded\"\n+version = \"1.2.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"a62bc1cf6f830c2ec14a513a9fb124d0a213a629668a4186f329db21fe045652\"\n+dependencies = [\n+ \"percent-encoding\",\n+]\n+\n+[[package]]\n+name = \"getrandom\"\n+version = \"0.2.10\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"be4136b2a15dd319360be1c07d9933517ccf0be8f16bf62a3bee4f0d618df427\"\n+dependencies = [\n+ \"cfg-if\",\n+ \"libc\",\n+ \"wasi\",\n+]\n+\n+[[package]]\n+name = \"gimli\"\n+version = \"0.27.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b6c80984affa11d98d1b88b66ac8853f143217b399d3c74116778ff8fdb4ed2e\"\n+\n+[[package]]\n+name = \"globset\"\n+version = \"0.4.10\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"029d74589adefde59de1a0c4f4732695c32805624aec7b68d91503d4dba79afc\"\n+dependencies = [\n+ \"aho-corasick 0.7.20\",\n+ \"bstr\",\n+ \"fnv\",\n+ \"log\",\n+ \"regex\",\n+]\n+\n+[[package]]\n+name = \"hashbrown\"\n+version = \"0.12.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"8a9ee70c43aaf417c914396645a0fa852624801b24ebb7ae78fe8272889ac888\"\n+dependencies = [\n+ \"ahash\",\n+]\n+\n+[[package]]\n+name = \"hashbrown\"\n+version = \"0.14.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"2c6201b9ff9fd90a5a3bac2e56a830d0caa509576f0e503818ee82c181b3437a\"\n+\n+[[package]]\n+name = \"hermes\"\n+version = \"0.1.0\"\n+source = \"git+https://github.com/facebook/hermes.git#b2618410b4093e780a04228a2ce87a3626983506\"\n+dependencies = [\n+ \"cmake\",\n+ \"juno_support\",\n+ \"libc\",\n+ \"libcplusplus\",\n+ \"thiserror\",\n+]\n+\n+[[package]]\n+name = \"hermit-abi\"\n+version = \"0.3.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"443144c8cdadd93ebf52ddb4056d257f5b52c04d3c804e657d19eb73fc33668b\"\n+\n+[[package]]\n+name = \"idna\"\n+version = \"0.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"7d20d6b07bfbc108882d88ed8e37d39636dcc260e15e30c45e6ba089610b917c\"\n+dependencies = [\n+ \"unicode-bidi\",\n+ \"unicode-normalization\",\n+]\n+\n+[[package]]\n+name = \"indexmap\"\n+version = \"2.0.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"d5477fe2230a79769d8dc68e0eabf5437907c0457a5614a9e8dddb67f65eb65d\"\n+dependencies = [\n+ \"equivalent\",\n+ \"hashbrown 0.14.0\",\n+ \"serde\",\n+]\n+\n+[[package]]\n+name = \"insta\"\n+version = \"1.30.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"28491f7753051e5704d4d0ae7860d45fae3238d7d235bc4289dcd45c48d3cec3\"\n+dependencies = [\n+ \"console\",\n+ \"globset\",\n+ \"lazy_static\",\n+ \"linked-hash-map\",\n+ \"similar\",\n+ \"walkdir\",\n+ \"yaml-rust\",\n+]\n+\n+[[package]]\n+name = \"io-lifetimes\"\n+version = \"1.0.11\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"eae7b9aee968036d54dce06cebaefd919e4472e753296daccd6d344e3e2df0c2\"\n+dependencies = [\n+ \"hermit-abi\",\n+ \"libc\",\n+ \"windows-sys 0.48.0\",\n+]\n+\n+[[package]]\n+name = \"is-terminal\"\n+version = \"0.4.7\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"adcf93614601c8129ddf72e2d5633df827ba6551541c6d8c59520a371475be1f\"\n+dependencies = [\n+ \"hermit-abi\",\n+ \"io-lifetimes\",\n+ \"rustix\",\n+ \"windows-sys 0.48.0\",\n+]\n+\n+[[package]]\n+name = \"is_ci\"\n+version = \"1.1.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"616cde7c720bb2bb5824a224687d8f77bfd38922027f01d825cd7453be5099fb\"\n+\n+[[package]]\n+name = \"itoa\"\n+version = \"1.0.8\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"62b02a5381cc465bd3041d84623d0fa3b66738b52b8e2fc3bab8ad63ab032f4a\"\n+\n+[[package]]\n+name = \"juno_support\"\n+version = \"0.1.0\"\n+source = \"git+https://github.com/facebook/hermes.git#b2618410b4093e780a04228a2ce87a3626983506\"\n+dependencies = [\n+ \"anyhow\",\n+ \"base64\",\n+ \"cmake\",\n+ \"libcplusplus\",\n+ \"thiserror\",\n+ \"url\",\n+]\n+\n+[[package]]\n+name = \"lazy_static\"\n+version = \"1.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"e2abad23fbc42b3700f2f279844dc832adb2b2eb069b2df918f455c4e18cc646\"\n+\n+[[package]]\n+name = \"libc\"\n+version = \"0.2.147\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b4668fb0ea861c1df094127ac5f1da3409a82116a4ba74fca2e58ef927159bb3\"\n+\n+[[package]]\n+name = \"libcplusplus\"\n+version = \"0.1.0\"\n+source = \"git+https://github.com/facebook/hermes.git#b2618410b4093e780a04228a2ce87a3626983506\"\n+\n+[[package]]\n+name = \"libloading\"\n+version = \"0.7.4\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b67380fd3b2fbe7527a606e18729d21c6f3951633d0500574c4dc22d2d638b9f\"\n+dependencies = [\n+ \"cfg-if\",\n+ \"winapi\",\n+]\n+\n+[[package]]\n+name = \"linked-hash-map\"\n+version = \"0.5.6\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"0717cef1bc8b636c6e1c1bbdefc09e6322da8a9321966e8928ef80d20f7f770f\"\n+\n+[[package]]\n+name = \"linux-raw-sys\"\n+version = \"0.3.8\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"ef53942eb7bf7ff43a617b3e2c1c4a5ecf5944a7c1bc12d7ee39bbb15e5c1519\"\n+\n+[[package]]\n+name = \"log\"\n+version = \"0.4.19\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b06a4cde4c0f271a446782e3eff8de789548ce57dbc8eca9292c27f4a42004b4\"\n+\n+[[package]]\n+name = \"memchr\"\n+version = \"2.5.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"2dffe52ecf27772e601905b7522cb4ef790d2cc203488bbd0e2fe85fcb74566d\"\n+\n+[[package]]\n+name = \"miette\"\n+version = \"5.9.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"a236ff270093b0b67451bc50a509bd1bad302cb1d3c7d37d5efe931238581fa9\"\n+dependencies = [\n+ \"backtrace\",\n+ \"backtrace-ext\",\n+ \"is-terminal\",\n+ \"miette-derive\",\n+ \"once_cell\",\n+ \"owo-colors\",\n+ \"supports-color\",\n+ \"supports-hyperlinks\",\n+ \"supports-unicode\",\n+ \"terminal_size\",\n+ \"textwrap\",\n+ \"thiserror\",\n+ \"unicode-width\",\n+]\n+\n+[[package]]\n+name = \"miette-derive\"\n+version = \"5.9.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"4901771e1d44ddb37964565c654a3223ba41a594d02b8da471cc4464912b5cfa\"\n+dependencies = [\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"syn 2.0.23\",\n+]\n+\n+[[package]]\n+name = \"miniz_oxide\"\n+version = \"0.7.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"e7810e0be55b428ada41041c41f32c9f1a42817901b4ccf45fa3d4b6561e74c7\"\n+dependencies = [\n+ \"adler\",\n+]\n+\n+[[package]]\n+name = \"napi\"\n+version = \"2.13.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"fd063c93b900149304e3ba96ce5bf210cd4f81ef5eb80ded0d100df3e85a3ac0\"\n+dependencies = [\n+ \"bitflags 2.4.0\",\n+ \"ctor\",\n+ \"napi-derive\",\n+ \"napi-sys\",\n+ \"once_cell\",\n+ \"serde\",\n+ \"serde_json\",\n+ \"tokio\",\n+]\n+\n+[[package]]\n+name = \"napi-build\"\n+version = \"2.0.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"882a73d9ef23e8dc2ebbffb6a6ae2ef467c0f18ac10711e4cc59c5485d41df0e\"\n+\n+[[package]]\n+name = \"napi-derive\"\n+version = \"2.13.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"da1c6a8fa84d549aa8708fcd062372bf8ec6e849de39016ab921067d21bde367\"\n+dependencies = [\n+ \"cfg-if\",\n+ \"convert_case\",\n+ \"napi-derive-backend\",\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"syn 1.0.109\",\n+]\n+\n+[[package]]\n+name = \"napi-derive-backend\"\n+version = \"1.0.52\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"20bbc7c69168d06a848f925ec5f0e0997f98e8c8d4f2cc30157f0da51c009e17\"\n+dependencies = [\n+ \"convert_case\",\n+ \"once_cell\",\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"regex\",\n+ \"semver\",\n+ \"syn 1.0.109\",\n+]\n+\n+[[package]]\n+name = \"napi-sys\"\n+version = \"2.2.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"166b5ef52a3ab5575047a9fe8d4a030cdd0f63c96f071cd6907674453b07bae3\"\n+dependencies = [\n+ \"libloading\",\n+]\n+\n+[[package]]\n+name = \"num_cpus\"\n+version = \"1.16.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"4161fcb6d602d4d2081af7c3a45852d875a03dd337a6bfdd6e06407b61342a43\"\n+dependencies = [\n+ \"hermit-abi\",\n+ \"libc\",\n+]\n+\n+[[package]]\n+name = \"object\"\n+version = \"0.31.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"8bda667d9f2b5051b8833f59f3bf748b28ef54f850f4fcb389a252aa383866d1\"\n+dependencies = [\n+ \"memchr\",\n+]\n+\n+[[package]]\n+name = \"once_cell\"\n+version = \"1.18.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"dd8b5dd2ae5ed71462c540258bedcb51965123ad7e7ccf4b9a8cafaa4a63576d\"\n+\n+[[package]]\n+name = \"owo-colors\"\n+version = \"3.5.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c1b04fb49957986fdce4d6ee7a65027d55d4b6d2265e5848bbb507b58ccfdb6f\"\n+\n+[[package]]\n+name = \"percent-encoding\"\n+version = \"2.3.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"9b2a4787296e9989611394c33f193f676704af1686e70b8f8033ab5ba9a35a94\"\n+\n+[[package]]\n+name = \"pin-project-lite\"\n+version = \"0.2.12\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"12cc1b0bf1727a77a54b6654e7b5f1af8604923edc8b81885f8ec92f9e3f0a05\"\n+\n+[[package]]\n+name = \"prettyplease\"\n+version = \"0.2.10\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"92139198957b410250d43fad93e630d956499a625c527eda65175c8680f83387\"\n+dependencies = [\n+ \"proc-macro2\",\n+ \"syn 2.0.23\",\n+]\n+\n+[[package]]\n+name = \"proc-macro2\"\n+version = \"1.0.63\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"7b368fba921b0dce7e60f5e04ec15e565b3303972b42bcfde1d0713b881959eb\"\n+dependencies = [\n+ \"unicode-ident\",\n+]\n+\n+[[package]]\n+name = \"psm\"\n+version = \"0.1.21\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"5787f7cda34e3033a72192c018bc5883100330f362ef279a8cbccfce8bb4e874\"\n+dependencies = [\n+ \"cc\",\n+]\n+\n+[[package]]\n+name = \"quote\"\n+version = \"1.0.29\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"573015e8ab27661678357f27dc26460738fd2b6c86e46f386fde94cb5d913105\"\n+dependencies = [\n+ \"proc-macro2\",\n+]\n+\n+[[package]]\n+name = \"react_build_hir\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"indexmap\",\n+ \"react_diagnostics\",\n+ \"react_estree\",\n+ \"react_hir\",\n+ \"react_semantic_analysis\",\n+ \"thiserror\",\n+]\n+\n+[[package]]\n+name = \"react_diagnostics\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"miette\",\n+ \"react_estree\",\n+ \"static_assertions\",\n+ \"thiserror\",\n+]\n+\n+[[package]]\n+name = \"react_estree\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"insta\",\n+ \"react_estree_codegen\",\n+ \"serde\",\n+ \"serde_json\",\n+ \"static_assertions\",\n+]\n+\n+[[package]]\n+name = \"react_estree_codegen\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"indexmap\",\n+ \"prettyplease\",\n+ \"quote\",\n+ \"serde\",\n+ \"serde_json\",\n+ \"syn 2.0.23\",\n+]\n+\n+[[package]]\n+name = \"react_fixtures\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"insta\",\n+ \"miette\",\n+ \"react_build_hir\",\n+ \"react_estree\",\n+ \"react_hermes_parser\",\n+ \"react_hir\",\n+ \"react_optimization\",\n+ \"react_semantic_analysis\",\n+ \"react_ssa\",\n+]\n+\n+[[package]]\n+name = \"react_hermes_parser\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"hermes\",\n+ \"insta\",\n+ \"juno_support\",\n+ \"react_diagnostics\",\n+ \"react_estree\",\n+ \"react_estree_codegen\",\n+ \"serde_json\",\n+]\n+\n+[[package]]\n+name = \"react_hir\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"indexmap\",\n+ \"react_diagnostics\",\n+ \"react_estree\",\n+ \"react_semantic_analysis\",\n+ \"react_utils\",\n+ \"serde\",\n+ \"thiserror\",\n+]\n+\n+[[package]]\n+name = \"react_napi\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"napi\",\n+ \"napi-build\",\n+ \"napi-derive\",\n+ \"react_diagnostics\",\n+ \"react_estree\",\n+ \"react_hermes_parser\",\n+ \"react_semantic_analysis\",\n+ \"serde_json\",\n+]\n+\n+[[package]]\n+name = \"react_optimization\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"indexmap\",\n+ \"miette\",\n+ \"react_build_hir\",\n+ \"react_diagnostics\",\n+ \"react_estree\",\n+ \"react_hir\",\n+ \"react_ssa\",\n+ \"react_utils\",\n+ \"thiserror\",\n+]\n+\n+[[package]]\n+name = \"react_semantic_analysis\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"indexmap\",\n+ \"insta\",\n+ \"miette\",\n+ \"react_diagnostics\",\n+ \"react_estree\",\n+ \"react_hermes_parser\",\n+ \"react_utils\",\n+ \"serde_json\",\n+]\n+\n+[[package]]\n+name = \"react_ssa\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"indexmap\",\n+ \"miette\",\n+ \"react_diagnostics\",\n+ \"react_hir\",\n+ \"react_utils\",\n+ \"thiserror\",\n+]\n+\n+[[package]]\n+name = \"react_utils\"\n+version = \"0.1.0\"\n+dependencies = [\n+ \"stacker\",\n+]\n+\n+[[package]]\n+name = \"regex\"\n+version = \"1.8.4\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"d0ab3ca65655bb1e41f2a8c8cd662eb4fb035e67c3f78da1d61dffe89d07300f\"\n+dependencies = [\n+ \"aho-corasick 1.0.2\",\n+ \"memchr\",\n+ \"regex-syntax\",\n+]\n+\n+[[package]]\n+name = \"regex-syntax\"\n+version = \"0.7.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"436b050e76ed2903236f032a59761c1eb99e1b0aead2c257922771dab1fc8c78\"\n+\n+[[package]]\n+name = \"rustc-demangle\"\n+version = \"0.1.23\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"d626bb9dae77e28219937af045c257c28bfd3f69333c512553507f5f9798cb76\"\n+\n+[[package]]\n+name = \"rustix\"\n+version = \"0.37.27\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"fea8ca367a3a01fe35e6943c400addf443c0f57670e6ec51196f71a4b8762dd2\"\n+dependencies = [\n+ \"bitflags 1.3.2\",\n+ \"errno\",\n+ \"io-lifetimes\",\n+ \"libc\",\n+ \"linux-raw-sys\",\n+ \"windows-sys 0.48.0\",\n+]\n+\n+[[package]]\n+name = \"ryu\"\n+version = \"1.0.14\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"fe232bdf6be8c8de797b22184ee71118d63780ea42ac85b61d1baa6d3b782ae9\"\n+\n+[[package]]\n+name = \"same-file\"\n+version = \"1.0.6\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"93fc1dc3aaa9bfed95e02e6eadabb4baf7e3078b0bd1b4d7b6b0b68378900502\"\n+dependencies = [\n+ \"winapi-util\",\n+]\n+\n+[[package]]\n+name = \"semver\"\n+version = \"1.0.18\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b0293b4b29daaf487284529cc2f5675b8e57c61f70167ba415a463651fd6a918\"\n+\n+[[package]]\n+name = \"serde\"\n+version = \"1.0.167\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"7daf513456463b42aa1d94cff7e0c24d682b429f020b9afa4f5ba5c40a22b237\"\n+dependencies = [\n+ \"serde_derive\",\n+]\n+\n+[[package]]\n+name = \"serde_derive\"\n+version = \"1.0.167\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b69b106b68bc8054f0e974e70d19984040f8a5cf9215ca82626ea4853f82c4b9\"\n+dependencies = [\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"syn 2.0.23\",\n+]\n+\n+[[package]]\n+name = \"serde_json\"\n+version = \"1.0.100\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"0f1e14e89be7aa4c4b78bdbdc9eb5bf8517829a600ae8eaa39a6e1d960b5185c\"\n+dependencies = [\n+ \"itoa\",\n+ \"ryu\",\n+ \"serde\",\n+]\n+\n+[[package]]\n+name = \"similar\"\n+version = \"2.2.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"420acb44afdae038210c99e69aae24109f32f15500aa708e81d46c9f29d55fcf\"\n+\n+[[package]]\n+name = \"smawk\"\n+version = \"0.3.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"f67ad224767faa3c7d8b6d91985b78e70a1324408abcb1cfcc2be4c06bc06043\"\n+\n+[[package]]\n+name = \"stacker\"\n+version = \"0.1.15\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c886bd4480155fd3ef527d45e9ac8dd7118a898a46530b7b94c3e21866259fce\"\n+dependencies = [\n+ \"cc\",\n+ \"cfg-if\",\n+ \"libc\",\n+ \"psm\",\n+ \"winapi\",\n+]\n+\n+[[package]]\n+name = \"static_assertions\"\n+version = \"1.1.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"a2eb9349b6444b326872e140eb1cf5e7c522154d69e7a0ffb0fb81c06b37543f\"\n+\n+[[package]]\n+name = \"supports-color\"\n+version = \"2.0.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"4950e7174bffabe99455511c39707310e7e9b440364a2fcb1cc21521be57b354\"\n+dependencies = [\n+ \"is-terminal\",\n+ \"is_ci\",\n+]\n+\n+[[package]]\n+name = \"supports-hyperlinks\"\n+version = \"2.1.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"f84231692eb0d4d41e4cdd0cabfdd2e6cd9e255e65f80c9aa7c98dd502b4233d\"\n+dependencies = [\n+ \"is-terminal\",\n+]\n+\n+[[package]]\n+name = \"supports-unicode\"\n+version = \"2.0.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"4b6c2cb240ab5dd21ed4906895ee23fe5a48acdbd15a3ce388e7b62a9b66baf7\"\n+dependencies = [\n+ \"is-terminal\",\n+]\n+\n+[[package]]\n+name = \"syn\"\n+version = \"1.0.109\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"72b64191b275b66ffe2469e8af2c1cfe3bafa67b529ead792a6d0160888b4237\"\n+dependencies = [\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"unicode-ident\",\n+]\n+\n+[[package]]\n+name = \"syn\"\n+version = \"2.0.23\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"59fb7d6d8281a51045d62b8eb3a7d1ce347b76f312af50cd3dc0af39c87c1737\"\n+dependencies = [\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"unicode-ident\",\n+]\n+\n+[[package]]\n+name = \"terminal_size\"\n+version = \"0.1.17\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"633c1a546cee861a1a6d0dc69ebeca693bf4296661ba7852b9d21d159e0506df\"\n+dependencies = [\n+ \"libc\",\n+ \"winapi\",\n+]\n+\n+[[package]]\n+name = \"textwrap\"\n+version = \"0.15.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b7b3e525a49ec206798b40326a44121291b530c963cfb01018f63e135bac543d\"\n+dependencies = [\n+ \"smawk\",\n+ \"unicode-linebreak\",\n+ \"unicode-width\",\n+]\n+\n+[[package]]\n+name = \"thiserror\"\n+version = \"1.0.41\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c16a64ba9387ef3fdae4f9c1a7f07a0997fce91985c0336f1ddc1822b3b37802\"\n+dependencies = [\n+ \"thiserror-impl\",\n+]\n+\n+[[package]]\n+name = \"thiserror-impl\"\n+version = \"1.0.41\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"d14928354b01c4d6a4f0e549069adef399a284e7995c7ccca94e8a07a5346c59\"\n+dependencies = [\n+ \"proc-macro2\",\n+ \"quote\",\n+ \"syn 2.0.23\",\n+]\n+\n+[[package]]\n+name = \"tinyvec\"\n+version = \"1.6.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"87cc5ceb3875bb20c2890005a4e226a4651264a5c75edb2421b52861a0a0cb50\"\n+dependencies = [\n+ \"tinyvec_macros\",\n+]\n+\n+[[package]]\n+name = \"tinyvec_macros\"\n+version = \"0.1.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"1f3ccbac311fea05f86f61904b462b55fb3df8837a366dfc601a0161d0532f20\"\n+\n+[[package]]\n+name = \"tokio\"\n+version = \"1.32.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"17ed6077ed6cd6c74735e21f37eb16dc3935f96878b1fe961074089cc80893f9\"\n+dependencies = [\n+ \"backtrace\",\n+ \"num_cpus\",\n+ \"pin-project-lite\",\n+]\n+\n+[[package]]\n+name = \"unicode-bidi\"\n+version = \"0.3.13\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"92888ba5573ff080736b3648696b70cafad7d250551175acbaa4e0385b3e1460\"\n+\n+[[package]]\n+name = \"unicode-ident\"\n+version = \"1.0.10\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"22049a19f4a68748a168c0fc439f9516686aa045927ff767eca0a85101fb6e73\"\n+\n+[[package]]\n+name = \"unicode-linebreak\"\n+version = \"0.1.4\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c5faade31a542b8b35855fff6e8def199853b2da8da256da52f52f1316ee3137\"\n+dependencies = [\n+ \"hashbrown 0.12.3\",\n+ \"regex\",\n+]\n+\n+[[package]]\n+name = \"unicode-normalization\"\n+version = \"0.1.22\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"5c5713f0fc4b5db668a2ac63cdb7bb4469d8c9fed047b1d0292cc7b0ce2ba921\"\n+dependencies = [\n+ \"tinyvec\",\n+]\n+\n+[[package]]\n+name = \"unicode-segmentation\"\n+version = \"1.10.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"1dd624098567895118886609431a7c3b8f516e41d30e0643f03d94592a147e36\"\n+\n+[[package]]\n+name = \"unicode-width\"\n+version = \"0.1.10\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c0edd1e5b14653f783770bce4a4dabb4a5108a5370a5f5d8cfe8710c361f6c8b\"\n+\n+[[package]]\n+name = \"url\"\n+version = \"2.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"50bff7831e19200a85b17131d085c25d7811bc4e186efdaf54bbd132994a88cb\"\n+dependencies = [\n+ \"form_urlencoded\",\n+ \"idna\",\n+ \"percent-encoding\",\n+]\n+\n+[[package]]\n+name = \"version_check\"\n+version = \"0.9.4\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"49874b5167b65d7193b8aba1567f5c7d93d001cafc34600cee003eda787e483f\"\n+\n+[[package]]\n+name = \"walkdir\"\n+version = \"2.3.3\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"36df944cda56c7d8d8b7496af378e6b16de9284591917d307c9b4d313c44e698\"\n+dependencies = [\n+ \"same-file\",\n+ \"winapi-util\",\n+]\n+\n+[[package]]\n+name = \"wasi\"\n+version = \"0.11.0+wasi-snapshot-preview1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"9c8d87e72b64a3b4db28d11ce29237c246188f4f51057d65a7eab63b7987e423\"\n+\n+[[package]]\n+name = \"winapi\"\n+version = \"0.3.9\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"5c839a674fcd7a98952e593242ea400abe93992746761e38641405d28b00f419\"\n+dependencies = [\n+ \"winapi-i686-pc-windows-gnu\",\n+ \"winapi-x86_64-pc-windows-gnu\",\n+]\n+\n+[[package]]\n+name = \"winapi-i686-pc-windows-gnu\"\n+version = \"0.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"ac3b87c63620426dd9b991e5ce0329eff545bccbbb34f3be09ff6fb6ab51b7b6\"\n+\n+[[package]]\n+name = \"winapi-util\"\n+version = \"0.1.5\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"70ec6ce85bb158151cae5e5c87f95a8e97d2c0c4b001223f33a334e3ce5de178\"\n+dependencies = [\n+ \"winapi\",\n+]\n+\n+[[package]]\n+name = \"winapi-x86_64-pc-windows-gnu\"\n+version = \"0.4.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"712e227841d057c1ee1cd2fb22fa7e5a5461ae8e48fa2ca79ec42cfc1931183f\"\n+\n+[[package]]\n+name = \"windows-sys\"\n+version = \"0.45.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"75283be5efb2831d37ea142365f009c02ec203cd29a3ebecbc093d52315b66d0\"\n+dependencies = [\n+ \"windows-targets 0.42.2\",\n+]\n+\n+[[package]]\n+name = \"windows-sys\"\n+version = \"0.48.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"677d2418bec65e3338edb076e806bc1ec15693c5d0104683f2efe857f61056a9\"\n+dependencies = [\n+ \"windows-targets 0.48.1\",\n+]\n+\n+[[package]]\n+name = \"windows-targets\"\n+version = \"0.42.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"8e5180c00cd44c9b1c88adb3693291f1cd93605ded80c250a75d472756b4d071\"\n+dependencies = [\n+ \"windows_aarch64_gnullvm 0.42.2\",\n+ \"windows_aarch64_msvc 0.42.2\",\n+ \"windows_i686_gnu 0.42.2\",\n+ \"windows_i686_msvc 0.42.2\",\n+ \"windows_x86_64_gnu 0.42.2\",\n+ \"windows_x86_64_gnullvm 0.42.2\",\n+ \"windows_x86_64_msvc 0.42.2\",\n+]\n+\n+[[package]]\n+name = \"windows-targets\"\n+version = \"0.48.1\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"05d4b17490f70499f20b9e791dcf6a299785ce8af4d709018206dc5b4953e95f\"\n+dependencies = [\n+ \"windows_aarch64_gnullvm 0.48.0\",\n+ \"windows_aarch64_msvc 0.48.0\",\n+ \"windows_i686_gnu 0.48.0\",\n+ \"windows_i686_msvc 0.48.0\",\n+ \"windows_x86_64_gnu 0.48.0\",\n+ \"windows_x86_64_gnullvm 0.48.0\",\n+ \"windows_x86_64_msvc 0.48.0\",\n+]\n+\n+[[package]]\n+name = \"windows_aarch64_gnullvm\"\n+version = \"0.42.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"597a5118570b68bc08d8d59125332c54f1ba9d9adeedeef5b99b02ba2b0698f8\"\n+\n+[[package]]\n+name = \"windows_aarch64_gnullvm\"\n+version = \"0.48.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"91ae572e1b79dba883e0d315474df7305d12f569b400fcf90581b06062f7e1bc\"\n+\n+[[package]]\n+name = \"windows_aarch64_msvc\"\n+version = \"0.42.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"e08e8864a60f06ef0d0ff4ba04124db8b0fb3be5776a5cd47641e942e58c4d43\"\n+\n+[[package]]\n+name = \"windows_aarch64_msvc\"\n+version = \"0.48.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"b2ef27e0d7bdfcfc7b868b317c1d32c641a6fe4629c171b8928c7b08d98d7cf3\"\n+\n+[[package]]\n+name = \"windows_i686_gnu\"\n+version = \"0.42.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"c61d927d8da41da96a81f029489353e68739737d3beca43145c8afec9a31a84f\"\n+\n+[[package]]\n+name = \"windows_i686_gnu\"\n+version = \"0.48.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"622a1962a7db830d6fd0a69683c80a18fda201879f0f447f065a3b7467daa241\"\n+\n+[[package]]\n+name = \"windows_i686_msvc\"\n+version = \"0.42.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"44d840b6ec649f480a41c8d80f9c65108b92d89345dd94027bfe06ac444d1060\"\n+\n+[[package]]\n+name = \"windows_i686_msvc\"\n+version = \"0.48.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"4542c6e364ce21bf45d69fdd2a8e455fa38d316158cfd43b3ac1c5b1b19f8e00\"\n+\n+[[package]]\n+name = \"windows_x86_64_gnu\"\n+version = \"0.42.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"8de912b8b8feb55c064867cf047dda097f92d51efad5b491dfb98f6bbb70cb36\"\n+\n+[[package]]\n+name = \"windows_x86_64_gnu\"\n+version = \"0.48.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"ca2b8a661f7628cbd23440e50b05d705db3686f894fc9580820623656af974b1\"\n+\n+[[package]]\n+name = \"windows_x86_64_gnullvm\"\n+version = \"0.42.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"26d41b46a36d453748aedef1486d5c7a85db22e56aff34643984ea85514e94a3\"\n+\n+[[package]]\n+name = \"windows_x86_64_gnullvm\"\n+version = \"0.48.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"7896dbc1f41e08872e9d5e8f8baa8fdd2677f29468c4e156210174edc7f7b953\"\n+\n+[[package]]\n+name = \"windows_x86_64_msvc\"\n+version = \"0.42.2\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"9aec5da331524158c6d1a4ac0ab1541149c0b9505fde06423b02f5ef0106b9f0\"\n+\n+[[package]]\n+name = \"windows_x86_64_msvc\"\n+version = \"0.48.0\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"1a515f5799fe4961cb532f983ce2b23082366b898e52ffbce459c86f67c8378a\"\n+\n+[[package]]\n+name = \"yaml-rust\"\n+version = \"0.4.5\"\n+source = \"registry+https://github.com/rust-lang/crates.io-index\"\n+checksum = \"56c1936c4cc7a1c9ab21a1ebb602eb942ba868cbd44a99cb7cdc5892335e1c85\"\n+dependencies = [\n+ \"linked-hash-map\",\n+]"
            },
            {
                "file": "compiler/Cargo.toml",
                "git_diff": "@@ -0,0 +1,61 @@\n+[workspace]\n+resolver = \"2\"\n+members = [\"crates/*\"]\n+\n+[workspace.package]\n+authors     = [\"The React Team https://react.dev/community/team\"]\n+description = \"React Compiler\"\n+edition     = \"2021\"\n+homepage    = \"https://github.com/facebook/react\"\n+keywords    = [\"JavaScript\", \"TypeScript\", \"React\", \"React Compiler\", \"Compiler\"]\n+license     = \"MIT\"\n+repository  = \"https://github.com/facebook/react\"\n+\n+[workspace.dependencies]\n+# workspace crates\n+react_build_hir = { path = \"crates/react_build_hir\" }\n+react_diagnostics = { path = \"crates/react_diagnostics\" }\n+react_estree = { path = \"crates/react_estree\" }\n+react_estree_codegen = { path = \"crates/react_estree_codegen\" }\n+react_fixtures = { path = \"crates/react_fixtures\" }\n+react_hermes_parser = { path = \"crates/react_hermes_parser\" }\n+react_hir = { path = \"crates/react_hir\" }\n+react_optimization = { path = \"crates/react_optimization\" }\n+react_semantic_analysis = { path = \"crates/react_semantic_analysis\" }\n+react_ssa = { path = \"crates/react_ssa\" }\n+react_utils = { path = \"crates/react_utils\" }\n+\n+# dependencies\n+indexmap = { version = \"2.0.0\", features = [\"serde\"] }\n+insta = { version = \"1.30.0\", features = [\"glob\"] }\n+miette = { version = \"5.9.0\" }\n+prettyplease = \"0.2.10\"\n+quote = \"1.0.29\"\n+serde = { version = \"1.0.167\", features = [\"serde_derive\"] }\n+serde_json = \"1.0.100\"\n+stacker = \"0.1.15\"\n+static_assertions = \"1.1.0\"\n+syn = \"2.0.23\"\n+thiserror = \"1.0.41\"\n+hermes = { git = \"https://github.com/facebook/hermes.git\" }\n+juno_support = { git = \"https://github.com/facebook/hermes.git\" }\n+\n+[profile.release]\n+# configuration adapted from oxc\n+# https://github.com/Boshen/oxc/blob/ea85ee9f2d64dd284c5b7410f491d81fb879abae/Cargo.toml#L89-L97\n+opt-level     = 3\n+lto           = \"fat\"\n+codegen-units = 1\n+strip         = \"symbols\"\n+debug         = false\n+panic         = \"abort\"   # Let it crash and force ourselves to write safe Rust.\n+\n+# Make insta run faster by compiling with release mode optimizations\n+# https://docs.rs/insta/latest/insta/#optional-faster-runs\n+[profile.dev.package.insta]\n+opt-level = 3\n+\n+# Make insta diffing libary faster by compiling with release mode optimizations\n+# https://docs.rs/insta/latest/insta/#optional-faster-runs\n+[profile.dev.package.similar]\n+opt-level = 3\n\\ No newline at end of file"
            },
            {
                "file": "compiler/README.md",
                "git_diff": "@@ -0,0 +1,7 @@\n+# React Compiler\n+\n+React Compiler is a compiler that optimizes React applications, ensuring that only the minimal parts of components and hooks will re-render when state changes. The compiler also validates that components and hooks follow the Rules of React.\n+\n+More information about the design and architecture of the compiler are covered in the [Design Goals](./docs/DESIGN_GOALS.md).\n+\n+More information about developing the compiler itself is covered in the [Development Guide](./docs/DEVELOPMENT_GUIDE.md).\n\\ No newline at end of file"
            },
            {
                "file": "compiler/apps/playground/.eslintrc.json",
                "git_diff": "@@ -0,0 +1,3 @@\n+{\n+  \"extends\": \"next/core-web-vitals\"\n+}"
            },
            {
                "file": "compiler/apps/playground/.gitignore",
                "git_diff": "@@ -0,0 +1,45 @@\n+# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.\n+\n+# dependencies\n+/node_modules\n+/.pnp\n+.pnp.js\n+\n+# testing\n+/coverage\n+/test-results\n+\n+# next.js\n+/.next/\n+/out/\n+\n+# production\n+/build\n+\n+# misc\n+.DS_Store\n+*.pem\n+\n+# debug\n+npm-debug.log*\n+yarn-debug.log*\n+yarn-error.log*\n+.pnpm-debug.log*\n+\n+# local env files\n+.env*.local\n+\n+# vercel\n+.vercel\n+\n+# typescript\n+*.tsbuildinfo\n+\n+# external fonts\n+public/fonts/Optimistic_Display_W_Lt.woff2\n+public/fonts/Optimistic_Display_W_Md.woff2\n+public/fonts/Optimistic_Display_W_Bd.woff2\n+\n+# vscode\n+.vscode/*\n+!.vscode/extensions.json"
            },
            {
                "file": "compiler/apps/playground/.vscode/extensions.json",
                "git_diff": "@@ -0,0 +1,3 @@\n+{\n+  \"recommendations\": [\"bradlc.vscode-tailwindcss\", \"heybourn.headwind\"]\n+}"
            },
            {
                "file": "compiler/apps/playground/README.md",
                "git_diff": "@@ -0,0 +1,35 @@\n+# React Compiler Playground\n+\n+An interactive playground to demonstrate, test, and have fun with React Compiler.\n+\n+## Setup\n+\n+```sh\n+# Build React Compiler from source and install Playground dependencies.\n+$ yarn\n+\n+# Or similarly\n+$ npm install\n+```\n+\n+## Development\n+\n+```sh\n+# Start the local development server with\n+$ yarn dev\n+\n+# Or\n+$ npm run dev\n+\n+# Rerun the following (in a separate terminal window) when React Compiler\n+# is changed locally to keep Playground in sync.\n+$ yarn\n+```\n+\n+## Deployment\n+\n+This project has been deployed using Vercel. Vercel does the exact same thing as we would\n+locally, by running `yarn` at the install step in the Playground directory to build\n+React Compiler from source and [symlink](https://classic.yarnpkg.com/en/docs/cli/link) it as its dependency.\n+This means that Playground is automatically deployed on every push and pull requests will reflect\n+the behaviors of React Compiler of that commit."
            },
            {
                "file": "compiler/apps/playground/__tests__/e2e/__snapshots__/page.spec.ts/default-input.txt",
                "git_diff": "@@ -0,0 +1,11 @@\n+function\u00a0MyApp()\u00a0{\n+\u00a0\u00a0const\u00a0$\u00a0=\u00a0_c(1);\n+\u00a0\u00a0let\u00a0t0;\n+\u00a0\u00a0if\u00a0($[0]\u00a0===\u00a0Symbol.for(\"react.memo_cache_sentinel\"))\u00a0{\n+\u00a0\u00a0\u00a0\u00a0t0\u00a0=\u00a0<div>Hello\u00a0World</div>;\n+\u00a0\u00a0\u00a0\u00a0$[0]\u00a0=\u00a0t0;\n+\u00a0\u00a0}\u00a0else\u00a0{\n+\u00a0\u00a0\u00a0\u00a0t0\u00a0=\u00a0$[0];\n+\u00a0\u00a0}\n+\u00a0\u00a0return\u00a0t0;\n+}\n\\ No newline at end of file"
            },
            {
                "file": "compiler/apps/playground/__tests__/e2e/__snapshots__/page.spec.ts/user-input.txt",
                "git_diff": "@@ -0,0 +1,13 @@\n+function\u00a0TestComponent(t0)\u00a0{\n+\u00a0\u00a0const\u00a0$\u00a0=\u00a0_c(2);\n+\u00a0\u00a0const\u00a0{\u00a0x\u00a0}\u00a0=\u00a0t0;\n+\u00a0\u00a0let\u00a0t1;\n+\u00a0\u00a0if\u00a0($[0]\u00a0!==\u00a0x)\u00a0{\n+\u00a0\u00a0\u00a0\u00a0t1\u00a0=\u00a0<Button>{x}</Button>;\n+\u00a0\u00a0\u00a0\u00a0$[0]\u00a0=\u00a0x;\n+\u00a0\u00a0\u00a0\u00a0$[1]\u00a0=\u00a0t1;\n+\u00a0\u00a0}\u00a0else\u00a0{\n+\u00a0\u00a0\u00a0\u00a0t1\u00a0=\u00a0$[1];\n+\u00a0\u00a0}\n+\u00a0\u00a0return\u00a0t1;\n+}\n\\ No newline at end of file"
            },
            {
                "file": "compiler/apps/playground/__tests__/e2e/page.spec.ts",
                "git_diff": "@@ -0,0 +1,49 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {expect, test} from '@playwright/test';\n+import {encodeStore, type Store} from '../../lib/stores';\n+\n+const STORE: Store = {\n+  source: `export default function TestComponent({ x }) {\n+  return <Button>{x}</Button>;\n+}\n+`,\n+};\n+const HASH = encodeStore(STORE);\n+\n+function concat(data: Array<string>): string {\n+  return data.join('');\n+}\n+\n+test('editor should compile successfully', async ({page}) => {\n+  await page.goto(`/#${HASH}`, {waitUntil: 'networkidle'});\n+  await page.screenshot({\n+    fullPage: true,\n+    path: 'test-results/00-on-networkidle.png',\n+  });\n+\n+  // User input from hash compiles\n+  await page.screenshot({\n+    fullPage: true,\n+    path: 'test-results/01-show-js-before.png',\n+  });\n+  const userInput =\n+    (await page.locator('.monaco-editor').nth(2).allInnerTexts()) ?? [];\n+  expect(concat(userInput)).toMatchSnapshot('user-input.txt');\n+\n+  // Reset button works\n+  page.on('dialog', dialog => dialog.accept());\n+  await page.getByRole('button', {name: 'Reset'}).click();\n+  await page.screenshot({\n+    fullPage: true,\n+    path: 'test-results/02-show-js-after.png',\n+  });\n+  const defaultInput =\n+    (await page.locator('.monaco-editor').nth(2).allInnerTexts()) ?? [];\n+  expect(concat(defaultInput)).toMatchSnapshot('default-input.txt');\n+});"
            },
            {
                "file": "compiler/apps/playground/app/index.tsx",
                "git_diff": "@@ -0,0 +1,56 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import type {NextPage} from 'next';\n+import Head from 'next/head';\n+import {SnackbarProvider} from 'notistack';\n+import {Editor, Header, StoreProvider} from '../components';\n+import MessageSnackbar from '../components/Message';\n+\n+const Home: NextPage = () => {\n+  return (\n+    <div className=\"flex flex-col w-screen h-screen font-light\">\n+      <Head>\n+        <title>\n+          {process.env.NODE_ENV === 'development'\n+            ? '[DEV] React Compiler Playground'\n+            : 'React Compiler Playground'}\n+        </title>\n+        <meta\n+          name=\"viewport\"\n+          content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\"></meta>\n+        <link rel=\"icon\" href=\"/favicon.ico\" />\n+        <link rel=\"manifest\" href=\"/site.webmanifest\" />\n+        <link\n+          rel=\"preload\"\n+          href=\"/fonts/Source-Code-Pro-Regular.woff2\"\n+          as=\"font\"\n+          type=\"font/woff2\"\n+          crossOrigin=\"anonymous\"\n+        />\n+        <link\n+          rel=\"preload\"\n+          href=\"/fonts/Optimistic_Display_W_Lt.woff2\"\n+          as=\"font\"\n+          type=\"font/woff2\"\n+          crossOrigin=\"anonymous\"\n+        />\n+      </Head>\n+      <StoreProvider>\n+        <SnackbarProvider\n+          preventDuplicate\n+          maxSnack={10}\n+          Components={{message: MessageSnackbar}}>\n+          <Header />\n+          <Editor />\n+        </SnackbarProvider>\n+      </StoreProvider>\n+    </div>\n+  );\n+};\n+\n+export default Home;"
            },
            {
                "file": "compiler/apps/playground/app/layout.tsx",
                "git_diff": "@@ -0,0 +1,43 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import '../styles/globals.css';\n+\n+export default function RootLayout({children}: {children: React.ReactNode}) {\n+  'use no memo';\n+  return (\n+    <html lang=\"en\">\n+      <head>\n+        <title>\n+          {process.env.NODE_ENV === 'development'\n+            ? '[DEV] React Compiler Playground'\n+            : 'React Compiler Playground'}\n+        </title>\n+        <meta\n+          name=\"viewport\"\n+          content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\"></meta>\n+        <link rel=\"icon\" href=\"/favicon.ico\" />\n+        <link rel=\"manifest\" href=\"/site.webmanifest\" />\n+        <link\n+          rel=\"preload\"\n+          href=\"/fonts/Source-Code-Pro-Regular.woff2\"\n+          as=\"font\"\n+          type=\"font/woff2\"\n+          crossOrigin=\"anonymous\"\n+        />\n+        <link\n+          rel=\"preload\"\n+          href=\"/fonts/Optimistic_Display_W_Lt.woff2\"\n+          as=\"font\"\n+          type=\"font/woff2\"\n+          crossOrigin=\"anonymous\"\n+        />\n+      </head>\n+      <body className=\"font-sans h-screen overflow-y-hidden\">{children}</body>\n+    </html>\n+  );\n+}"
            },
            {
                "file": "compiler/apps/playground/app/page.tsx",
                "git_diff": "@@ -0,0 +1,26 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+'use client';\n+\n+import {SnackbarProvider} from 'notistack';\n+import {Editor, Header, StoreProvider} from '../components';\n+import MessageSnackbar from '../components/Message';\n+\n+export default function Hoot() {\n+  return (\n+    <StoreProvider>\n+      <SnackbarProvider\n+        preventDuplicate\n+        maxSnack={10}\n+        Components={{message: MessageSnackbar}}>\n+        <Header />\n+        <Editor />\n+      </SnackbarProvider>\n+    </StoreProvider>\n+  );\n+}"
            },
            {
                "file": "compiler/apps/playground/babel.config.js",
                "git_diff": "@@ -0,0 +1,21 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+module.exports = function (api) {\n+  api.cache(true);\n+  return {\n+    presets: ['next/babel'],\n+    plugins: [\n+      [\n+        'babel-plugin-react-compiler',\n+        {\n+          runtimeModule: 'react-compiler-runtime',\n+        },\n+      ],\n+    ],\n+  };\n+};"
            },
            {
                "file": "compiler/apps/playground/colors.js",
                "git_diff": "@@ -0,0 +1,96 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+/**\n+ * Sync from <https://github.com/reactjs/reactjs.org/blob/main/beta/colors.js>.\n+ */\n+\n+module.exports = {\n+  // Text colors\n+  primary: '#23272F', // gray-90\n+  'primary-dark': '#F6F7F9', // gray-5\n+  secondary: '#404756', // gray-70\n+  'secondary-dark': '#EBECF0', // gray-10\n+  link: '#087EA4', // blue-50\n+  'link-dark': '#149ECA', // blue-40\n+  syntax: '#EBECF0', // gray-10\n+  wash: '#FFFFFF',\n+  'wash-dark': '#23272F', // gray-90\n+  card: '#F6F7F9', // gray-05\n+  'card-dark': '#343A46', // gray-80\n+  highlight: '#E6F7FF', // blue-10\n+  'highlight-dark': 'rgba(88,175,223,.1)',\n+  border: '#EBECF0', // gray-10\n+  'border-dark': '#343A46', // gray-80\n+  'secondary-button': '#EBECF0', // gray-10\n+  'secondary-button-dark': '#404756', // gray-70\n+\n+  // Gray\n+  'gray-95': '#16181D',\n+  'gray-90': '#23272F',\n+  'gray-80': '#343A46',\n+  'gray-70': '#404756',\n+  'gray-60': '#4E5769',\n+  'gray-50': '#5E687E', // unused\n+  'gray-40': '#78839B',\n+  'gray-30': '#99A1B3',\n+  'gray-20': '#BCC1CD',\n+  'gray-10': '#EBECF0',\n+  'gray-5': '#F6F7F9',\n+\n+  // Blue\n+  'blue-60': '#045975',\n+  'blue-50': '#087EA4',\n+  'blue-40': '#149ECA', // Brand Blue\n+  'blue-30': '#58C4DC', // unused\n+  'blue-20': '#ABE2ED',\n+  'blue-10': '#E6F7FF', // todo: doesn't match illustrations\n+  'blue-5': '#E6F6FA',\n+\n+  // Yellow\n+  'yellow-60': '#B65700',\n+  'yellow-50': '#C76A15',\n+  'yellow-40': '#DB7D27', // unused\n+  'yellow-30': '#FABD62', // unused\n+  'yellow-20': '#FCDEB0', // unused\n+  'yellow-10': '#FDE7C7',\n+  'yellow-5': '#FEF5E7',\n+\n+  // Purple\n+  'purple-60': '#2B3491', // unused\n+  'purple-50': '#575FB7',\n+  'purple-40': '#6B75DB',\n+  'purple-30': '#8891EC',\n+  'purple-20': '#C3C8F5', // unused\n+  'purple-10': '#E7E9FB',\n+  'purple-5': '#F3F4FD',\n+\n+  // Green\n+  'green-60': '#2B6E62',\n+  'green-50': '#388F7F',\n+  'green-40': '#44AC99',\n+  'green-30': '#7FCCBF',\n+  'green-20': '#ABDED5',\n+  'green-10': '#E5F5F2',\n+  'green-5': '#F4FBF9',\n+\n+  // RED\n+  'red-60': '#712D28',\n+  'red-50': '#A6423A', // unused\n+  'red-40': '#C1554D',\n+  'red-30': '#D07D77',\n+  'red-20': '#E5B7B3', // unused\n+  'red-10': '#F2DBD9', // unused\n+  'red-5': '#FAF1F0',\n+\n+  // MISC\n+  'code-block': '#99a1b30f', // gray-30 @ 6%\n+  'gradient-blue': '#58C4DC', // Only used for the landing gradient for now.\n+  github: {\n+    highlight: '#fffbdd',\n+  },\n+};"
            },
            {
                "file": "compiler/apps/playground/components/Editor/EditorImpl.tsx",
                "git_diff": "@@ -0,0 +1,355 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {parse as babelParse, ParserPlugin} from '@babel/parser';\n+import * as HermesParser from 'hermes-parser';\n+import traverse, {NodePath} from '@babel/traverse';\n+import * as t from '@babel/types';\n+import {\n+  CompilerError,\n+  CompilerErrorDetail,\n+  Effect,\n+  ErrorSeverity,\n+  parseConfigPragma,\n+  printHIR,\n+  printReactiveFunction,\n+  run,\n+  ValueKind,\n+  type Hook,\n+} from 'babel-plugin-react-compiler/src';\n+import {type ReactFunctionType} from 'babel-plugin-react-compiler/src/HIR/Environment';\n+import clsx from 'clsx';\n+import invariant from 'invariant';\n+import {useSnackbar} from 'notistack';\n+import {useDeferredValue, useMemo} from 'react';\n+import {useMountEffect} from '../../hooks';\n+import {defaultStore} from '../../lib/defaultStore';\n+import {\n+  createMessage,\n+  initStoreFromUrlOrLocalStorage,\n+  MessageLevel,\n+  MessageSource,\n+  type Store,\n+} from '../../lib/stores';\n+import {useStore, useStoreDispatch} from '../StoreContext';\n+import Input from './Input';\n+import {\n+  CompilerOutput,\n+  default as Output,\n+  PrintedCompilerPipelineValue,\n+} from './Output';\n+import {printFunctionWithOutlined} from 'babel-plugin-react-compiler/src/HIR/PrintHIR';\n+import {printReactiveFunctionWithOutlined} from 'babel-plugin-react-compiler/src/ReactiveScopes/PrintReactiveFunction';\n+\n+function parseInput(input: string, language: 'flow' | 'typescript') {\n+  // Extract the first line to quickly check for custom test directives\n+  if (language === 'flow') {\n+    return HermesParser.parse(input, {\n+      babel: true,\n+      flow: 'all',\n+      sourceType: 'module',\n+      enableExperimentalComponentSyntax: true,\n+    });\n+  } else {\n+    return babelParse(input, {\n+      plugins: ['typescript', 'jsx'],\n+      sourceType: 'module',\n+    });\n+  }\n+}\n+\n+function parseFunctions(\n+  source: string,\n+  language: 'flow' | 'typescript',\n+): Array<\n+  | NodePath<t.FunctionDeclaration>\n+  | NodePath<t.ArrowFunctionExpression>\n+  | NodePath<t.FunctionExpression>\n+> {\n+  const items: Array<\n+    | NodePath<t.FunctionDeclaration>\n+    | NodePath<t.ArrowFunctionExpression>\n+    | NodePath<t.FunctionExpression>\n+  > = [];\n+  try {\n+    const ast = parseInput(source, language);\n+    traverse(ast, {\n+      FunctionDeclaration(nodePath) {\n+        items.push(nodePath);\n+        nodePath.skip();\n+      },\n+      ArrowFunctionExpression(nodePath) {\n+        items.push(nodePath);\n+        nodePath.skip();\n+      },\n+      FunctionExpression(nodePath) {\n+        items.push(nodePath);\n+        nodePath.skip();\n+      },\n+    });\n+  } catch (e) {\n+    console.error(e);\n+    CompilerError.throwInvalidJS({\n+      reason: String(e),\n+      description: null,\n+      loc: null,\n+      suggestions: null,\n+    });\n+  }\n+  return items;\n+}\n+\n+const COMMON_HOOKS: Array<[string, Hook]> = [\n+  [\n+    'useFragment',\n+    {\n+      valueKind: ValueKind.Frozen,\n+      effectKind: Effect.Freeze,\n+      noAlias: true,\n+      transitiveMixedData: true,\n+    },\n+  ],\n+  [\n+    'usePaginationFragment',\n+    {\n+      valueKind: ValueKind.Frozen,\n+      effectKind: Effect.Freeze,\n+      noAlias: true,\n+      transitiveMixedData: true,\n+    },\n+  ],\n+  [\n+    'useRefetchableFragment',\n+    {\n+      valueKind: ValueKind.Frozen,\n+      effectKind: Effect.Freeze,\n+      noAlias: true,\n+      transitiveMixedData: true,\n+    },\n+  ],\n+  [\n+    'useLazyLoadQuery',\n+    {\n+      valueKind: ValueKind.Frozen,\n+      effectKind: Effect.Freeze,\n+      noAlias: true,\n+      transitiveMixedData: true,\n+    },\n+  ],\n+  [\n+    'usePreloadedQuery',\n+    {\n+      valueKind: ValueKind.Frozen,\n+      effectKind: Effect.Freeze,\n+      noAlias: true,\n+      transitiveMixedData: true,\n+    },\n+  ],\n+];\n+\n+function isHookName(s: string): boolean {\n+  return /^use[A-Z0-9]/.test(s);\n+}\n+\n+function getReactFunctionType(id: t.Identifier | null): ReactFunctionType {\n+  if (id != null) {\n+    if (isHookName(id.name)) {\n+      return 'Hook';\n+    }\n+\n+    const isPascalCaseNameSpace = /^[A-Z].*/;\n+    if (isPascalCaseNameSpace.test(id.name)) {\n+      return 'Component';\n+    }\n+  }\n+  return 'Other';\n+}\n+\n+function getFunctionIdentifier(\n+  fn:\n+    | NodePath<t.FunctionDeclaration>\n+    | NodePath<t.ArrowFunctionExpression>\n+    | NodePath<t.FunctionExpression>,\n+): t.Identifier | null {\n+  if (fn.isArrowFunctionExpression()) {\n+    return null;\n+  }\n+  const id = fn.get('id');\n+  return Array.isArray(id) === false && id.isIdentifier() ? id.node : null;\n+}\n+\n+function compile(source: string): [CompilerOutput, 'flow' | 'typescript'] {\n+  const results = new Map<string, PrintedCompilerPipelineValue[]>();\n+  const error = new CompilerError();\n+  const upsert = (result: PrintedCompilerPipelineValue) => {\n+    const entry = results.get(result.name);\n+    if (Array.isArray(entry)) {\n+      entry.push(result);\n+    } else {\n+      results.set(result.name, [result]);\n+    }\n+  };\n+  let language: 'flow' | 'typescript';\n+  if (source.match(/\\@flow/)) {\n+    language = 'flow';\n+  } else {\n+    language = 'typescript';\n+  }\n+  let count = 0;\n+  const withIdentifier = (id: t.Identifier | null): t.Identifier => {\n+    if (id != null && id.name != null) {\n+      return id;\n+    } else {\n+      return t.identifier(`anonymous_${count++}`);\n+    }\n+  };\n+  try {\n+    // Extract the first line to quickly check for custom test directives\n+    const pragma = source.substring(0, source.indexOf('\\n'));\n+    const config = parseConfigPragma(pragma);\n+\n+    for (const fn of parseFunctions(source, language)) {\n+      const id = withIdentifier(getFunctionIdentifier(fn));\n+      for (const result of run(\n+        fn,\n+        {\n+          ...config,\n+          customHooks: new Map([...COMMON_HOOKS]),\n+        },\n+        getReactFunctionType(id),\n+        '_c',\n+        null,\n+        null,\n+        null,\n+      )) {\n+        const fnName = id.name;\n+        switch (result.kind) {\n+          case 'ast': {\n+            upsert({\n+              kind: 'ast',\n+              fnName,\n+              name: result.name,\n+              value: {\n+                type: 'FunctionDeclaration',\n+                id,\n+                async: result.value.async,\n+                generator: result.value.generator,\n+                body: result.value.body,\n+                params: result.value.params,\n+              },\n+            });\n+            break;\n+          }\n+          case 'hir': {\n+            upsert({\n+              kind: 'hir',\n+              fnName,\n+              name: result.name,\n+              value: printFunctionWithOutlined(result.value),\n+            });\n+            break;\n+          }\n+          case 'reactive': {\n+            upsert({\n+              kind: 'reactive',\n+              fnName,\n+              name: result.name,\n+              value: printReactiveFunctionWithOutlined(result.value),\n+            });\n+            break;\n+          }\n+          case 'debug': {\n+            upsert({\n+              kind: 'debug',\n+              fnName,\n+              name: result.name,\n+              value: result.value,\n+            });\n+            break;\n+          }\n+          default: {\n+            const _: never = result;\n+            throw new Error(`Unhandled result ${result}`);\n+          }\n+        }\n+      }\n+    }\n+  } catch (err) {\n+    // error might be an invariant violation or other runtime error\n+    // (i.e. object shape that is not CompilerError)\n+    if (err instanceof CompilerError && err.details.length > 0) {\n+      error.details.push(...err.details);\n+    } else {\n+      // Handle unexpected failures by logging (to get a stack trace)\n+      // and reporting\n+      console.error(err);\n+      error.details.push(\n+        new CompilerErrorDetail({\n+          severity: ErrorSeverity.Invariant,\n+          reason: `Unexpected failure when transforming input! ${err}`,\n+          loc: null,\n+          suggestions: null,\n+        }),\n+      );\n+    }\n+  }\n+  if (error.hasErrors()) {\n+    return [{kind: 'err', results, error: error}, language];\n+  }\n+  return [{kind: 'ok', results}, language];\n+}\n+\n+export default function Editor() {\n+  const store = useStore();\n+  const deferredStore = useDeferredValue(store);\n+  const dispatchStore = useStoreDispatch();\n+  const {enqueueSnackbar} = useSnackbar();\n+  const [compilerOutput, language] = useMemo(\n+    () => compile(deferredStore.source),\n+    [deferredStore.source],\n+  );\n+\n+  useMountEffect(() => {\n+    let mountStore: Store;\n+    try {\n+      mountStore = initStoreFromUrlOrLocalStorage();\n+    } catch (e) {\n+      invariant(e instanceof Error, 'Only Error may be caught.');\n+      enqueueSnackbar(e.message, {\n+        variant: 'message',\n+        ...createMessage(\n+          'Bad URL - fell back to the default Playground.',\n+          MessageLevel.Info,\n+          MessageSource.Playground,\n+        ),\n+      });\n+      mountStore = defaultStore;\n+    }\n+    dispatchStore({\n+      type: 'setStore',\n+      payload: {store: mountStore},\n+    });\n+  });\n+\n+  return (\n+    <>\n+      <div className=\"relative flex basis top-14\">\n+        <div className={clsx('relative sm:basis-1/4')}>\n+          <Input\n+            language={language}\n+            errors={\n+              compilerOutput.kind === 'err' ? compilerOutput.error.details : []\n+            }\n+          />\n+        </div>\n+        <div className={clsx('flex sm:flex flex-wrap')}>\n+          <Output store={deferredStore} compilerOutput={compilerOutput} />\n+        </div>\n+      </div>\n+    </>\n+  );\n+}"
            },
            {
                "file": "compiler/apps/playground/components/Editor/Input.tsx",
                "git_diff": "@@ -0,0 +1,145 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import MonacoEditor, {loader, type Monaco} from '@monaco-editor/react';\n+import {CompilerErrorDetail} from 'babel-plugin-react-compiler/src';\n+import invariant from 'invariant';\n+import type {editor} from 'monaco-editor';\n+import * as monaco from 'monaco-editor';\n+import {Resizable} from 're-resizable';\n+import {useEffect, useState} from 'react';\n+import {renderReactCompilerMarkers} from '../../lib/reactCompilerMonacoDiagnostics';\n+import {useStore, useStoreDispatch} from '../StoreContext';\n+import {monacoOptions} from './monacoOptions';\n+// TODO: Make TS recognize .d.ts files, in addition to loading them with webpack.\n+// @ts-ignore\n+import React$Types from '../../node_modules/@types/react/index.d.ts';\n+\n+loader.config({monaco});\n+\n+type Props = {\n+  errors: CompilerErrorDetail[];\n+  language: 'flow' | 'typescript';\n+};\n+\n+export default function Input({errors, language}: Props) {\n+  const [monaco, setMonaco] = useState<Monaco | null>(null);\n+  const store = useStore();\n+  const dispatchStore = useStoreDispatch();\n+\n+  // Set tab width to 2 spaces for the selected input file.\n+  useEffect(() => {\n+    if (!monaco) return;\n+    const uri = monaco.Uri.parse(`file:///index.js`);\n+    const model = monaco.editor.getModel(uri);\n+    invariant(model, 'Model must exist for the selected input file.');\n+    renderReactCompilerMarkers({monaco, model, details: errors});\n+    // N.B. that `tabSize` is a model property, not an editor property.\n+    // So, the tab size has to be set per model.\n+    model.updateOptions({tabSize: 2});\n+  }, [monaco, errors]);\n+\n+  const flowDiagnosticDisable = [\n+    7028 /* unused label */, 6133 /* var declared but not read */,\n+  ];\n+  useEffect(() => {\n+    // Ignore \"can only be used in TypeScript files.\" errors, since\n+    // we want to support syntax highlighting for Flow (*.js) files\n+    // and Flow is not a built-in language.\n+    if (!monaco) return;\n+    monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({\n+      diagnosticCodesToIgnore: [\n+        8002,\n+        8003,\n+        8004,\n+        8005,\n+        8006,\n+        8008,\n+        8009,\n+        8010,\n+        8011,\n+        8012,\n+        8013,\n+        ...(language === 'flow' ? flowDiagnosticDisable : []),\n+      ],\n+      noSemanticValidation: true,\n+      // Monaco can't validate Flow component syntax\n+      noSyntaxValidation: language === 'flow',\n+    });\n+  }, [monaco, language]);\n+\n+  const handleChange = (value: string | undefined) => {\n+    if (!value) return;\n+\n+    dispatchStore({\n+      type: 'updateFile',\n+      payload: {\n+        source: value,\n+      },\n+    });\n+  };\n+\n+  const handleMount = (_: editor.IStandaloneCodeEditor, monaco: Monaco) => {\n+    setMonaco(monaco);\n+\n+    const tscOptions = {\n+      allowNonTsExtensions: true,\n+      target: monaco.languages.typescript.ScriptTarget.ES2015,\n+      moduleResolution: monaco.languages.typescript.ModuleResolutionKind.NodeJs,\n+      jsx: monaco.languages.typescript.JsxEmit.Preserve,\n+      typeRoots: ['node_modules/@types'],\n+      allowSyntheticDefaultImports: true,\n+    };\n+    monaco.languages.typescript.javascriptDefaults.setCompilerOptions(\n+      tscOptions,\n+    );\n+    monaco.languages.typescript.typescriptDefaults.setCompilerOptions({\n+      ...tscOptions,\n+      checkJs: true,\n+      allowJs: true,\n+    });\n+\n+    // Add React type declarations to Monaco\n+    const reactLib = [\n+      React$Types,\n+      'file:///node_modules/@types/react/index.d.ts',\n+    ] as [any, string];\n+    monaco.languages.typescript.javascriptDefaults.addExtraLib(...reactLib);\n+    monaco.languages.typescript.typescriptDefaults.addExtraLib(...reactLib);\n+\n+    // Remeasure the font in case the custom font is loaded only after\n+    // Monaco Editor is mounted.\n+    // N.B. that this applies also to the output editor as it seems\n+    // Monaco Editor instances share the same font config.\n+    document.fonts.ready.then(() => {\n+      monaco.editor.remeasureFonts();\n+    });\n+  };\n+\n+  return (\n+    <div className=\"relative flex flex-col flex-none border-r border-gray-200\">\n+      <Resizable\n+        minWidth={650}\n+        enable={{right: true}}\n+        // Restrict MonacoEditor's height, since the config autoLayout:true\n+        // will grow the editor to fit within parent element\n+        className=\"!h-[calc(100vh_-_3.5rem)]\">\n+        <MonacoEditor\n+          path={'index.js'}\n+          // .js and .jsx files are specified to be TS so that Monaco can actually\n+          // check their syntax using its TS language service. They are still JS files\n+          // due to their extensions, so TS language features don't work.\n+          language={'javascript'}\n+          value={store.source}\n+          onMount={handleMount}\n+          onChange={handleChange}\n+          options={monacoOptions}\n+        />\n+      </Resizable>\n+    </div>\n+  );\n+}"
            },
            {
                "file": "compiler/apps/playground/components/Editor/Output.tsx",
                "git_diff": "@@ -0,0 +1,302 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import generate from '@babel/generator';\n+import * as t from '@babel/types';\n+import {\n+  CodeIcon,\n+  DocumentAddIcon,\n+  InformationCircleIcon,\n+} from '@heroicons/react/outline';\n+import MonacoEditor, {DiffEditor} from '@monaco-editor/react';\n+import {type CompilerError} from 'babel-plugin-react-compiler/src';\n+import parserBabel from 'prettier/plugins/babel';\n+import * as prettierPluginEstree from 'prettier/plugins/estree';\n+import * as prettier from 'prettier/standalone';\n+import {memo, useEffect, useState} from 'react';\n+import {type Store} from '../../lib/stores';\n+import TabbedWindow from '../TabbedWindow';\n+import {monacoOptions} from './monacoOptions';\n+const MemoizedOutput = memo(Output);\n+\n+export default MemoizedOutput;\n+\n+export type PrintedCompilerPipelineValue =\n+  | {\n+      kind: 'ast';\n+      name: string;\n+      fnName: string | null;\n+      value: t.FunctionDeclaration;\n+    }\n+  | {\n+      kind: 'hir';\n+      name: string;\n+      fnName: string | null;\n+      value: string;\n+    }\n+  | {kind: 'reactive'; name: string; fnName: string | null; value: string}\n+  | {kind: 'debug'; name: string; fnName: string | null; value: string};\n+\n+export type CompilerOutput =\n+  | {kind: 'ok'; results: Map<string, PrintedCompilerPipelineValue[]>}\n+  | {\n+      kind: 'err';\n+      results: Map<string, PrintedCompilerPipelineValue[]>;\n+      error: CompilerError;\n+    };\n+\n+type Props = {\n+  store: Store;\n+  compilerOutput: CompilerOutput;\n+};\n+\n+async function tabify(source: string, compilerOutput: CompilerOutput) {\n+  const tabs = new Map<string, React.ReactNode>();\n+  const reorderedTabs = new Map<string, React.ReactNode>();\n+  const concattedResults = new Map<string, string>();\n+  let topLevelFnDecls: Array<t.FunctionDeclaration> = [];\n+  // Concat all top level function declaration results into a single tab for each pass\n+  for (const [passName, results] of compilerOutput.results) {\n+    for (const result of results) {\n+      switch (result.kind) {\n+        case 'hir': {\n+          const prev = concattedResults.get(result.name);\n+          const next = result.value;\n+          const identName = `function ${result.fnName}`;\n+          if (prev != null) {\n+            concattedResults.set(passName, `${prev}\\n\\n${identName}\\n${next}`);\n+          } else {\n+            concattedResults.set(passName, `${identName}\\n${next}`);\n+          }\n+          break;\n+        }\n+        case 'reactive': {\n+          const prev = concattedResults.get(passName);\n+          const next = result.value;\n+          if (prev != null) {\n+            concattedResults.set(passName, `${prev}\\n\\n${next}`);\n+          } else {\n+            concattedResults.set(passName, next);\n+          }\n+          break;\n+        }\n+        case 'ast':\n+          topLevelFnDecls.push(result.value);\n+          break;\n+        case 'debug': {\n+          concattedResults.set(passName, result.value);\n+          break;\n+        }\n+        default: {\n+          const _: never = result;\n+          throw new Error('Unexpected result kind');\n+        }\n+      }\n+    }\n+  }\n+  let lastPassOutput: string | null = null;\n+  let nonDiffPasses = ['HIR', 'BuildReactiveFunction', 'EnvironmentConfig'];\n+  for (const [passName, text] of concattedResults) {\n+    tabs.set(\n+      passName,\n+      <TextTabContent\n+        output={text}\n+        diff={lastPassOutput}\n+        showInfoPanel={!nonDiffPasses.includes(passName)}></TextTabContent>,\n+    );\n+    lastPassOutput = text;\n+  }\n+  // Ensure that JS and the JS source map come first\n+  if (topLevelFnDecls.length > 0) {\n+    // Make a synthetic Program so we can have a single AST with all the top level\n+    // FunctionDeclarations\n+    const ast = t.program(topLevelFnDecls);\n+    const {code, sourceMapUrl} = await codegen(ast, source);\n+    reorderedTabs.set(\n+      'JS',\n+      <TextTabContent\n+        output={code}\n+        diff={null}\n+        showInfoPanel={false}></TextTabContent>,\n+    );\n+    if (sourceMapUrl) {\n+      reorderedTabs.set(\n+        'SourceMap',\n+        <>\n+          <iframe\n+            src={sourceMapUrl}\n+            className=\"w-full h-monaco_small sm:h-monaco\"\n+            title=\"Generated Code\"\n+          />\n+        </>,\n+      );\n+    }\n+  }\n+  tabs.forEach((tab, name) => {\n+    reorderedTabs.set(name, tab);\n+  });\n+  return reorderedTabs;\n+}\n+\n+async function codegen(\n+  ast: t.Program,\n+  source: string,\n+): Promise<{code: any; sourceMapUrl: string | null}> {\n+  const generated = generate(\n+    ast,\n+    {sourceMaps: true, sourceFileName: 'input.js'},\n+    source,\n+  );\n+  const sourceMapUrl = getSourceMapUrl(\n+    generated.code,\n+    JSON.stringify(generated.map),\n+  );\n+  const codegenOutput = await prettier.format(generated.code, {\n+    semi: true,\n+    parser: 'babel',\n+    plugins: [parserBabel, prettierPluginEstree],\n+  });\n+  return {code: codegenOutput, sourceMapUrl};\n+}\n+\n+function utf16ToUTF8(s: string): string {\n+  return unescape(encodeURIComponent(s));\n+}\n+\n+function getSourceMapUrl(code: string, map: string): string | null {\n+  code = utf16ToUTF8(code);\n+  map = utf16ToUTF8(map);\n+  return `https://evanw.github.io/source-map-visualization/#${btoa(\n+    `${code.length}\\0${code}${map.length}\\0${map}`,\n+  )}`;\n+}\n+\n+function Output({store, compilerOutput}: Props) {\n+  const [tabsOpen, setTabsOpen] = useState<Set<string>>(() => new Set(['JS']));\n+  const [tabs, setTabs] = useState<Map<string, React.ReactNode>>(\n+    () => new Map(),\n+  );\n+  useEffect(() => {\n+    tabify(store.source, compilerOutput).then(tabs => {\n+      setTabs(tabs);\n+    });\n+  }, [store.source, compilerOutput]);\n+\n+  const changedPasses: Set<string> = new Set(['JS', 'HIR']); // Initial and final passes should always be bold\n+  let lastResult: string = '';\n+  for (const [passName, results] of compilerOutput.results) {\n+    for (const result of results) {\n+      let currResult = '';\n+      if (result.kind === 'hir' || result.kind === 'reactive') {\n+        currResult += `function ${result.fnName}\\n\\n${result.value}`;\n+      }\n+      if (currResult !== lastResult) {\n+        changedPasses.add(passName);\n+      }\n+      lastResult = currResult;\n+    }\n+  }\n+\n+  return (\n+    <>\n+      <TabbedWindow\n+        defaultTab=\"HIR\"\n+        setTabsOpen={setTabsOpen}\n+        tabsOpen={tabsOpen}\n+        tabs={tabs}\n+        changedPasses={changedPasses}\n+      />\n+      {compilerOutput.kind === 'err' ? (\n+        <div\n+          className=\"flex flex-wrap absolute bottom-0 bg-white grow border-y border-grey-200 transition-all ease-in\"\n+          style={{width: 'calc(100vw - 650px)'}}>\n+          <div className=\"w-full p-4 basis-full border-b\">\n+            <h2>COMPILER ERRORS</h2>\n+          </div>\n+          <pre\n+            className=\"p-4 basis-full text-red-600 overflow-y-scroll whitespace-pre-wrap\"\n+            style={{width: 'calc(100vw - 650px)', height: '150px'}}>\n+            <code>{compilerOutput.error.toString()}</code>\n+          </pre>\n+        </div>\n+      ) : null}\n+    </>\n+  );\n+}\n+\n+function TextTabContent({\n+  output,\n+  diff,\n+  showInfoPanel,\n+}: {\n+  output: string;\n+  diff: string | null;\n+  showInfoPanel: boolean;\n+}) {\n+  const [diffMode, setDiffMode] = useState(false);\n+  return (\n+    // Restrict MonacoEditor's height, since the config autoLayout:true\n+    // will grow the editor to fit within parent element\n+    <div className=\"w-full h-monaco_small sm:h-monaco\">\n+      {showInfoPanel ? (\n+        <div className=\"flex items-center gap-1 bg-amber-50 p-2\">\n+          {diff != null && output !== diff ? (\n+            <button\n+              className=\"flex items-center gap-1 transition-colors duration-150 ease-in text-secondary hover:text-link\"\n+              onClick={() => setDiffMode(diffMode => !diffMode)}>\n+              {!diffMode ? (\n+                <>\n+                  <DocumentAddIcon className=\"w-5 h-5\" /> Show Diff\n+                </>\n+              ) : (\n+                <>\n+                  <CodeIcon className=\"w-5 h-5\" /> Show Output\n+                </>\n+              )}\n+            </button>\n+          ) : (\n+            <>\n+              <span className=\"flex items-center gap-1\">\n+                <InformationCircleIcon className=\"w-5 h-5\" /> No changes from\n+                previous pass\n+              </span>\n+            </>\n+          )}\n+        </div>\n+      ) : null}\n+      {diff != null && diffMode ? (\n+        <DiffEditor\n+          original={diff}\n+          modified={output}\n+          options={{\n+            ...monacoOptions,\n+            readOnly: true,\n+            lineNumbers: 'off',\n+            glyphMargin: false,\n+            // Undocumented see https://github.com/Microsoft/vscode/issues/30795#issuecomment-410998882\n+            lineDecorationsWidth: 0,\n+            lineNumbersMinChars: 0,\n+          }}\n+        />\n+      ) : (\n+        <MonacoEditor\n+          defaultLanguage=\"javascript\"\n+          value={output}\n+          options={{\n+            ...monacoOptions,\n+            readOnly: true,\n+            lineNumbers: 'off',\n+            glyphMargin: false,\n+            // Undocumented see https://github.com/Microsoft/vscode/issues/30795#issuecomment-410998882\n+            lineDecorationsWidth: 0,\n+            lineNumbersMinChars: 0,\n+          }}\n+        />\n+      )}\n+    </div>\n+  );\n+}"
            },
            {
                "file": "compiler/apps/playground/components/Editor/index.tsx",
                "git_diff": "@@ -0,0 +1,16 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import dynamic from 'next/dynamic';\n+\n+// monaco-editor is currently not compatible with ssr\n+// https://github.com/vercel/next.js/issues/31692\n+const Editor = dynamic(() => import('./EditorImpl'), {\n+  ssr: false,\n+});\n+\n+export default Editor;"
            },
            {
                "file": "compiler/apps/playground/components/Editor/monacoOptions.ts",
                "git_diff": "@@ -0,0 +1,32 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import type {EditorProps} from '@monaco-editor/react';\n+\n+export const monacoOptions: Partial<EditorProps['options']> = {\n+  fontSize: 14,\n+  padding: {top: 8},\n+  scrollbar: {\n+    verticalScrollbarSize: 10,\n+    alwaysConsumeMouseWheel: false,\n+  },\n+  minimap: {\n+    enabled: false,\n+  },\n+  formatOnPaste: true,\n+  formatOnType: true,\n+  fontFamily: '\"Source Code Pro\", monospace',\n+  glyphMargin: true,\n+\n+  autoClosingBrackets: 'languageDefined',\n+  autoClosingDelete: 'always',\n+  autoClosingOvertype: 'always',\n+\n+  automaticLayout: true,\n+  wordWrap: 'on',\n+  wrappingIndent: 'deepIndent',\n+};"
            },
            {
                "file": "compiler/apps/playground/components/Header.tsx",
                "git_diff": "@@ -0,0 +1,91 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {RefreshIcon, ShareIcon} from '@heroicons/react/outline';\n+import {CheckIcon} from '@heroicons/react/solid';\n+import clsx from 'clsx';\n+import Link from 'next/link';\n+import {useSnackbar} from 'notistack';\n+import {useState} from 'react';\n+import {defaultStore} from '../lib/defaultStore';\n+import {IconGitHub} from './Icons/IconGitHub';\n+import Logo from './Logo';\n+import {useStoreDispatch} from './StoreContext';\n+\n+export default function Header() {\n+  const [showCheck, setShowCheck] = useState(false);\n+  const dispatchStore = useStoreDispatch();\n+  const {enqueueSnackbar, closeSnackbar} = useSnackbar();\n+\n+  const handleReset = () => {\n+    if (confirm('Are you sure you want to reset the playground?')) {\n+      /*\n+        Close open snackbars if any. This is necessary because when displaying\n+        outputs (Preview or not), we only close previous snackbars if we received\n+        new messages, which is needed in order to display \"Bad URL\" or success\n+        messages when loading Playground for the first time. Otherwise, messages\n+        such as \"Bad URL\" will be closed by the outputs calling `closeSnackbar`.\n+      */\n+      closeSnackbar();\n+      dispatchStore({type: 'setStore', payload: {store: defaultStore}});\n+    }\n+  };\n+\n+  const handleShare = () => {\n+    navigator.clipboard.writeText(location.href).then(() => {\n+      enqueueSnackbar('URL copied to clipboard');\n+      setShowCheck(true);\n+      // Show the check mark icon briefly after URL is copied\n+      setTimeout(() => setShowCheck(false), 1000);\n+    });\n+  };\n+\n+  return (\n+    <div className=\"fixed z-10 flex items-center justify-between w-screen px-5 py-3 bg-white border-b border-gray-200 h-14\">\n+      <div className=\"flex items-center flex-none h-full gap-2 text-lg\">\n+        <Logo\n+          className={clsx(\n+            'w-8 h-8 text-link',\n+            process.env.NODE_ENV === 'development' && 'text-yellow-600',\n+          )}\n+        />\n+        <p className=\"hidden select-none sm:block\">React Compiler Playground</p>\n+      </div>\n+      <div className=\"flex items-center text-[15px] gap-4\">\n+        <button\n+          title=\"Reset Playground\"\n+          aria-label=\"Reset Playground\"\n+          className=\"flex items-center gap-1 transition-colors duration-150 ease-in text-secondary hover:text-link\"\n+          onClick={handleReset}>\n+          <RefreshIcon className=\"w-5 h-5\" />\n+          <p className=\"hidden sm:block\">Reset</p>\n+        </button>\n+        <button\n+          title=\"Copy sharable URL\"\n+          aria-label=\"Copy sharable URL\"\n+          className=\"flex items-center gap-1 transition-colors duration-150 ease-in text-secondary hover:text-link\"\n+          onClick={handleShare}\n+          disabled={showCheck}>\n+          {!showCheck ? (\n+            <ShareIcon className=\"w-5 h-5\" />\n+          ) : (\n+            <CheckIcon className=\"w-5 h-5 fill-blue-50\" />\n+          )}\n+          <p className=\"hidden sm:block\">Share</p>\n+        </button>\n+        <Link\n+          href=\"https://github.com/facebook/react\"\n+          target=\"_blank\"\n+          rel=\"noreferrer noopener\"\n+          aria-label=\"Open on GitHub\"\n+          className=\"flex items-center gap-1 transition-colors duration-150 ease-in text-secondary hover:text-link\">\n+          <IconGitHub />\n+        </Link>\n+      </div>\n+    </div>\n+  );\n+}"
            },
            {
                "file": "compiler/apps/playground/components/Icons/IconGitHub.tsx",
                "git_diff": "@@ -0,0 +1,24 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {memo} from 'react';\n+\n+export const IconGitHub = memo<JSX.IntrinsicElements['svg']>(\n+  function IconGitHub(props) {\n+    return (\n+      <svg\n+        xmlns=\"http://www.w3.org/2000/svg\"\n+        width=\"1.5em\"\n+        height=\"1.5em\"\n+        viewBox=\"0 -2 24 24\"\n+        fill=\"currentColor\"\n+        {...props}>\n+        <path d=\"M10 0a10 10 0 0 0-3.16 19.49c.5.1.68-.22.68-.48l-.01-1.7c-2.78.6-3.37-1.34-3.37-1.34-.46-1.16-1.11-1.47-1.11-1.47-.9-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.9 1.52 2.34 1.08 2.91.83.1-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.94 0-1.1.39-1.99 1.03-2.69a3.6 3.6 0 0 1 .1-2.64s.84-.27 2.75 1.02a9.58 9.58 0 0 1 5 0c1.91-1.3 2.75-1.02 2.75-1.02.55 1.37.2 2.4.1 2.64.64.7 1.03 1.6 1.03 2.69 0 3.84-2.34 4.68-4.57 4.93.36.31.68.92.68 1.85l-.01 2.75c0 .26.18.58.69.48A10 10 0 0 0 10 0\"></path>\n+      </svg>\n+    );\n+  },\n+);"
            },
            {
                "file": "compiler/apps/playground/components/Logo.tsx",
                "git_diff": "@@ -0,0 +1,27 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+// https://github.com/reactjs/reactjs.org/blob/main/beta/src/components/Logo.tsx\n+\n+export default function Logo(props: JSX.IntrinsicElements['svg']) {\n+  return (\n+    <svg\n+      viewBox=\"0 0 410 369\"\n+      fill=\"none\"\n+      xmlns=\"http://www.w3.org/2000/svg\"\n+      {...props}>\n+      <path\n+        d=\"M204.995 224.552C226.56 224.552 244.042 207.07 244.042 185.506C244.042 163.941 226.56 146.459 204.995 146.459C183.43 146.459 165.948 163.941 165.948 185.506C165.948 207.07 183.43 224.552 204.995 224.552Z\"\n+        fill=\"currentColor\"\n+      />\n+      <path\n+        d=\"M409.99 184.505C409.99 153.707 381.437 126.667 335.996 108.925C343.342 60.6535 334.19 22.3878 307.492 6.98883C283.649 -6.77511 250.631 -0.0395641 214.512 25.9753C211.316 28.2692 208.143 30.7097 204.97 33.2477C201.822 30.7097 198.65 28.2692 195.477 25.9753C159.359 -0.0395641 126.34 -6.79951 102.497 6.98883C75.8237 22.3878 66.6721 60.6291 74.0422 108.852C28.5529 126.618 0 153.682 0 184.505C0 215.303 28.5528 242.342 73.9934 260.084C66.6477 308.356 75.7993 346.621 102.497 362.02C110.575 366.682 119.727 369 129.684 369C149.085 369 171.61 360.215 195.477 343.034C198.674 340.74 201.847 338.3 205.019 335.762C208.167 338.3 211.34 340.74 214.512 343.034C238.38 360.239 260.905 369 280.306 369C290.263 369 299.415 366.682 307.492 362.02C331.335 348.256 342 316.287 337.534 271.993C337.143 268.089 336.631 264.135 335.996 260.109C381.461 242.367 409.99 215.327 409.99 184.505ZM225.934 41.8136C246.238 27.1955 265.127 19.5814 280.306 19.5814C286.871 19.5814 292.728 20.9968 297.731 23.8765C315.204 33.9798 322.672 62.9475 317.327 102.433C299.756 97.0401 280.306 92.9158 259.392 90.2802C246.872 73.8074 233.597 58.9453 220.003 46.2551C221.98 44.7421 223.957 43.229 225.934 41.8136ZM112.259 23.8765C117.262 20.9968 123.119 19.5814 129.684 19.5814C144.863 19.5814 163.752 27.1711 184.056 41.8136C186.033 43.229 188.01 44.7176 189.986 46.2551C176.393 58.9453 163.142 73.783 150.622 90.2558C129.732 92.8914 110.258 97.0401 92.687 102.409C87.3424 62.9475 94.7857 33.9798 112.259 23.8765ZM19.5233 184.505C19.5233 164.322 40.9014 143.359 77.776 128.253C81.9003 146.141 88.0502 165.054 96.1768 184.456C88.0014 203.881 81.8515 222.819 77.7272 240.732C40.9014 225.626 19.5233 204.687 19.5233 184.505ZM184.056 327.196C154.966 348.134 128.805 354.675 112.259 345.133C94.7857 335.029 87.3181 306.062 92.6626 266.576C110.234 271.969 129.684 276.093 150.598 278.729C163.117 295.202 176.393 310.064 189.986 322.754C188.01 324.292 186.033 325.78 184.056 327.196ZM204.995 310.04C180.591 287.685 157.138 257.815 137.347 223.551C132.051 214.4 121.344 191.396 117 182.489C113.535 190.786 110.112 198.398 107.427 206.5C109.623 210.575 118.092 229.213 120.434 233.288C125.071 241.317 129.928 249.127 134.931 256.692C120.898 254.227 107.915 251.055 96.1035 247.321C102.815 217.011 116.213 182.064 137.347 145.458C142.545 136.453 153.838 116.346 159.5 108C150.568 109.147 143.395 108.767 135 110.5C132.56 114.453 122.777 131.645 120.434 135.721C115.749 143.823 111.454 151.925 107.427 159.978C102.546 146.581 98.8124 133.744 96.1524 121.64C125.755 112.293 162.727 106.411 204.995 106.411C215.562 106.411 237.63 106.197 247.49 106.905C242.048 99.7544 237.38 93.2819 231.694 86.888C227.082 86.7416 209.705 86.888 204.995 86.888C195.672 86.888 186.545 87.2053 177.589 87.7422C186.472 77.1752 195.672 67.5111 204.995 58.9697C229.375 81.3239 252.851 111.195 272.643 145.458C277.841 154.463 289.073 175.426 293.49 184.505C296.98 176.207 300.281 168.64 302.99 160.489C300.793 156.389 291.898 139.747 289.555 135.696C284.918 127.667 280.062 119.858 275.059 112.317C289.092 114.782 302.075 117.954 313.886 121.688C307.175 151.998 293.777 186.945 272.643 223.551C267.445 232.556 252.651 253.178 246.99 261.524C255.922 260.377 265.595 258.663 273.99 256.93C276.43 252.976 287.212 237.364 289.555 233.288C294.216 225.235 298.512 217.182 302.489 209.153C307.224 222.185 310.982 234.997 313.715 247.394C284.138 256.741 247.214 262.598 204.995 262.598C194.428 262.598 169.859 261.208 160 260.5C165.442 267.65 171.304 275.095 176.99 281.489C181.602 281.635 200.285 282.121 204.995 282.121C214.317 282.121 223.444 281.804 232.401 281.267C223.493 291.834 214.317 301.498 204.995 310.04ZM297.731 345.133C281.185 354.699 254.999 348.159 225.934 327.196C223.957 325.78 221.98 324.292 220.003 322.754C233.597 310.064 246.848 295.226 259.367 278.753C280.233 276.118 299.659 271.993 317.205 266.625C317.547 269.089 317.888 271.554 318.132 273.97C321.72 309.649 314.277 335.566 297.731 345.133ZM332.262 240.756C328.065 222.599 321.842 203.686 313.813 184.578C321.988 165.152 328.138 146.215 332.262 128.302C369.088 143.408 390.466 164.322 390.466 184.505C390.466 204.687 369.113 225.626 332.262 240.756Z\"\n+        fill=\"currentColor\"\n+      />\n+    </svg>\n+  );\n+}"
            },
            {
                "file": "compiler/apps/playground/components/Message.tsx",
                "git_diff": "@@ -0,0 +1,82 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {\n+  BanIcon,\n+  ExclamationIcon,\n+  InformationCircleIcon,\n+  XIcon,\n+} from '@heroicons/react/solid';\n+import {CustomContentProps, SnackbarContent, useSnackbar} from 'notistack';\n+import {forwardRef} from 'react';\n+import {MessageLevel, MessageSource} from '../lib/stores';\n+\n+// https://notistack.com/examples/advanced/custom-component#custom-variant-(typescript)\n+declare module 'notistack' {\n+  interface VariantOverrides {\n+    message: {\n+      title: string;\n+      level: MessageLevel;\n+      codeframe: string | undefined;\n+    };\n+  }\n+}\n+\n+interface MessageProps extends CustomContentProps {\n+  title: string;\n+  level: MessageLevel;\n+  source: MessageSource;\n+  codeframe: string | undefined;\n+}\n+\n+const Message = forwardRef<HTMLDivElement, MessageProps>(\n+  ({id, title, level, source, codeframe}, ref) => {\n+    const {closeSnackbar} = useSnackbar();\n+    const isDismissible = source !== MessageSource.Playground;\n+\n+    return (\n+      <SnackbarContent\n+        ref={ref}\n+        className=\"flex items-start justify-between gap-3 px-4 py-3 text-sm bg-white border rounded-md shadow w-toast\">\n+        <div className=\"flex gap-3 w-toast-body\">\n+          {level === MessageLevel.Warning ? (\n+            <div className=\"flex items-center justify-center flex-none rounded-md w-7 h-7 bg-amber-100\">\n+              <ExclamationIcon className=\"w-5 h-5 text-amber-600\" />\n+            </div>\n+          ) : level === MessageLevel.Error ? (\n+            <div className=\"flex items-center justify-center flex-none bg-red-100 rounded-md w-7 h-7\">\n+              <BanIcon className=\"w-5 h-5 text-red-600\" />\n+            </div>\n+          ) : (\n+            <div className=\"flex items-center justify-center flex-none rounded-md bg-sky-100 w-7 h-7\">\n+              <InformationCircleIcon className=\"w-5 h-5 text-sky-600\" />\n+            </div>\n+          )}\n+          <div className=\"flex flex-col justify-center gap-1 w-toast-title\">\n+            <p className=\"w-full\">{title}</p>\n+            {codeframe ? (\n+              <pre className=\"overflow-x-auto break-words whitespace-pre-wrap\">\n+                <code className=\"text-xs\">{codeframe}</code>\n+              </pre>\n+            ) : null}\n+          </div>\n+        </div>\n+        {isDismissible ? (\n+          <button\n+            className=\"flex items-center justify-center flex-none transition-colors duration-150 ease-in rounded-md justify-self-end group w-7 h-7 hover:bg-gray-200\"\n+            onClick={() => closeSnackbar(id)}>\n+            <XIcon className=\"w-5 h-5 fill-gray-500 group-hover:fill-gray-800\" />\n+          </button>\n+        ) : null}\n+      </SnackbarContent>\n+    );\n+  },\n+);\n+\n+Message.displayName = 'MessageComponent';\n+\n+export default Message;"
            },
            {
                "file": "compiler/apps/playground/components/StoreContext.tsx",
                "git_diff": "@@ -0,0 +1,78 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import type {Dispatch, ReactNode} from 'react';\n+import {useReducer} from 'react';\n+import createContext from '../lib/createContext';\n+import {emptyStore} from '../lib/defaultStore';\n+import type {Store} from '../lib/stores';\n+import {saveStore} from '../lib/stores';\n+\n+const StoreContext = createContext<Store>();\n+\n+/**\n+ * Hook to access the store.\n+ */\n+export const useStore = StoreContext.useContext;\n+\n+const StoreDispatchContext = createContext<Dispatch<ReducerAction>>();\n+\n+/**\n+ * Hook to access the store dispatch function.\n+ */\n+export const useStoreDispatch = StoreDispatchContext.useContext;\n+\n+/**\n+ * Make Store and dispatch function available to all sub-components in children.\n+ */\n+export function StoreProvider({children}: {children: ReactNode}) {\n+  const [store, dispatch] = useReducer(storeReducer, emptyStore);\n+\n+  return (\n+    <StoreContext.Provider value={store}>\n+      <StoreDispatchContext.Provider value={dispatch}>\n+        {children}\n+      </StoreDispatchContext.Provider>\n+    </StoreContext.Provider>\n+  );\n+}\n+\n+type ReducerAction =\n+  | {\n+      type: 'setStore';\n+      payload: {\n+        store: Store;\n+      };\n+    }\n+  | {\n+      type: 'updateFile';\n+      payload: {\n+        source: string;\n+      };\n+    };\n+\n+function storeReducer(store: Store, action: ReducerAction): Store {\n+  switch (action.type) {\n+    case 'setStore': {\n+      const newStore = action.payload.store;\n+\n+      saveStore(newStore);\n+      return newStore;\n+    }\n+    case 'updateFile': {\n+      const {source} = action.payload;\n+\n+      const newStore = {\n+        ...store,\n+        source,\n+      };\n+\n+      saveStore(newStore);\n+      return newStore;\n+    }\n+  }\n+}"
            },
            {
                "file": "compiler/apps/playground/components/TabbedWindow.tsx",
                "git_diff": "@@ -0,0 +1,103 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {Resizable} from 're-resizable';\n+import React, {useCallback} from 'react';\n+\n+type TabsRecord = Map<string, React.ReactNode>;\n+\n+export default function TabbedWindow(props: {\n+  defaultTab: string | null;\n+  tabs: TabsRecord;\n+  tabsOpen: Set<string>;\n+  setTabsOpen: (newTab: Set<string>) => void;\n+  changedPasses: Set<string>;\n+}): React.ReactElement {\n+  if (props.tabs.size === 0) {\n+    return (\n+      <div\n+        className=\"flex items-center justify-center\"\n+        style={{width: 'calc(100vw - 650px)'}}>\n+        No compiler output detected, see errors below\n+      </div>\n+    );\n+  }\n+  return (\n+    <div className=\"flex flex-row\">\n+      {Array.from(props.tabs.keys()).map(name => {\n+        return (\n+          <TabbedWindowItem\n+            name={name}\n+            key={name}\n+            tabs={props.tabs}\n+            tabsOpen={props.tabsOpen}\n+            setTabsOpen={props.setTabsOpen}\n+            hasChanged={props.changedPasses.has(name)}\n+          />\n+        );\n+      })}\n+    </div>\n+  );\n+}\n+\n+function TabbedWindowItem({\n+  name,\n+  tabs,\n+  tabsOpen,\n+  setTabsOpen,\n+  hasChanged,\n+}: {\n+  name: string;\n+  tabs: TabsRecord;\n+  tabsOpen: Set<string>;\n+  setTabsOpen: (newTab: Set<string>) => void;\n+  hasChanged: boolean;\n+}): React.ReactElement {\n+  const isShow = tabsOpen.has(name);\n+\n+  const toggleTabs = useCallback(() => {\n+    const nextState = new Set(tabsOpen);\n+    if (nextState.has(name)) {\n+      nextState.delete(name);\n+    } else {\n+      nextState.add(name);\n+    }\n+    setTabsOpen(nextState);\n+  }, [tabsOpen, name, setTabsOpen]);\n+\n+  return (\n+    <div key={name} className=\"flex flex-row\">\n+      {isShow ? (\n+        <Resizable className=\"border-r\" minWidth={550} enable={{right: true}}>\n+          <h2\n+            title=\"Minimize tab\"\n+            aria-label=\"Minimize tab\"\n+            onClick={toggleTabs}\n+            className={`p-4 duration-150 ease-in border-b cursor-pointer border-grey-200 ${\n+              hasChanged ? 'font-bold' : 'font-light'\n+            } text-secondary hover:text-link`}>\n+            - {name}\n+          </h2>\n+          {tabs.get(name) ?? <div>No output for {name}</div>}\n+        </Resizable>\n+      ) : (\n+        <div className=\"relative items-center h-full px-1 py-6 align-middle border-r border-grey-200\">\n+          <button\n+            title={`Expand compiler tab: ${name}`}\n+            aria-label={`Expand compiler tab: ${name}`}\n+            style={{transform: 'rotate(90deg) translate(-50%)'}}\n+            onClick={toggleTabs}\n+            className={`flex-grow-0 w-5 transition-colors duration-150 ease-in ${\n+              hasChanged ? 'font-bold' : 'font-light'\n+            } text-secondary hover:text-link`}>\n+            {name}\n+          </button>\n+        </div>\n+      )}\n+    </div>\n+  );\n+}"
            },
            {
                "file": "compiler/apps/playground/components/index.ts",
                "git_diff": "@@ -0,0 +1,10 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+export {default as Editor} from './Editor';\n+export {default as Header} from './Header';\n+export {StoreProvider} from './StoreContext';"
            },
            {
                "file": "compiler/apps/playground/hooks/index.ts",
                "git_diff": "@@ -0,0 +1,8 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+export {default as useMountEffect} from './useMountEffect';"
            },
            {
                "file": "compiler/apps/playground/hooks/useMountEffect.ts",
                "git_diff": "@@ -0,0 +1,13 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import type {EffectCallback} from 'react';\n+import {useEffect} from 'react';\n+\n+export default function useMountEffect(effect: EffectCallback) {\n+  return useEffect(effect, []);\n+}"
            },
            {
                "file": "compiler/apps/playground/lib/createContext.ts",
                "git_diff": "@@ -0,0 +1,37 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import React from 'react';\n+\n+/**\n+ * Replacement to React.createContext.\n+ *\n+ * Does not take any default value and avoids non-null assertions when using\n+ * the value of the context, like the following scenario.\n+ *\n+ * ```ts\n+ * const StoreDispatchContext = useContext<Dispatch<ReducerAction>>(null);\n+ * const dispatchStore = useContext(StoreDispatchContext);\n+ * ...\n+ * dipatchStore!({ ... });\n+ * ```\n+ *\n+ * Instead, it throws an error when `useContext` is not called within a\n+ * Provider with a value.\n+ */\n+export default function createContext<T>() {\n+  const context = React.createContext<T | null>(null);\n+\n+  function useContext() {\n+    const c = React.useContext(context);\n+    if (!c)\n+      throw new Error('useContext must be within a Provider with a value');\n+    return c;\n+  }\n+\n+  return {useContext, Provider: context.Provider};\n+}"
            },
            {
                "file": "compiler/apps/playground/lib/defaultStore.ts",
                "git_diff": "@@ -0,0 +1,22 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import type {Store} from './stores';\n+\n+const index = `\\\n+export default function MyApp() {\n+  return <div>Hello World</div>;\n+}\n+`;\n+\n+export const defaultStore: Store = {\n+  source: index,\n+};\n+\n+export const emptyStore: Store = {\n+  source: '',\n+};"
            },
            {
                "file": "compiler/apps/playground/lib/reactCompilerMonacoDiagnostics.ts",
                "git_diff": "@@ -0,0 +1,89 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {Monaco} from '@monaco-editor/react';\n+import {\n+  CompilerErrorDetail,\n+  ErrorSeverity,\n+} from 'babel-plugin-react-compiler/src';\n+import {MarkerSeverity, type editor} from 'monaco-editor';\n+\n+function mapReactCompilerSeverityToMonaco(\n+  level: ErrorSeverity,\n+  monaco: Monaco,\n+): MarkerSeverity {\n+  switch (level) {\n+    case ErrorSeverity.Todo:\n+      return monaco.MarkerSeverity.Warning;\n+    default:\n+      return monaco.MarkerSeverity.Error;\n+  }\n+}\n+\n+function mapReactCompilerDiagnosticToMonacoMarker(\n+  detail: CompilerErrorDetail,\n+  monaco: Monaco,\n+): editor.IMarkerData | null {\n+  if (detail.loc == null || typeof detail.loc === 'symbol') {\n+    return null;\n+  }\n+  const severity = mapReactCompilerSeverityToMonaco(detail.severity, monaco);\n+  let message = detail.printErrorMessage();\n+  return {\n+    severity,\n+    message,\n+    startLineNumber: detail.loc.start.line,\n+    startColumn: detail.loc.start.column + 1,\n+    endLineNumber: detail.loc.end.line,\n+    endColumn: detail.loc.end.column + 1,\n+  };\n+}\n+\n+type ReactCompilerMarkerConfig = {\n+  monaco: Monaco;\n+  model: editor.ITextModel;\n+  details: CompilerErrorDetail[];\n+};\n+let decorations: string[] = [];\n+export function renderReactCompilerMarkers({\n+  monaco,\n+  model,\n+  details,\n+}: ReactCompilerMarkerConfig): void {\n+  let markers = [];\n+  for (const detail of details) {\n+    const marker = mapReactCompilerDiagnosticToMonacoMarker(detail, monaco);\n+    if (marker == null) {\n+      continue;\n+    }\n+    markers.push(marker);\n+  }\n+  if (markers.length > 0) {\n+    monaco.editor.setModelMarkers(model, 'owner', markers);\n+    const newDecorations = markers.map(marker => {\n+      return {\n+        range: new monaco.Range(\n+          marker.startLineNumber,\n+          marker.startColumn,\n+          marker.endLineNumber,\n+          marker.endColumn,\n+        ),\n+        options: {\n+          isWholeLine: true,\n+          glyphMarginClassName: 'bg-red-300',\n+        },\n+      };\n+    });\n+    decorations = model.deltaDecorations(decorations, newDecorations);\n+  } else {\n+    monaco.editor.setModelMarkers(model, 'owner', []);\n+    decorations = model.deltaDecorations(\n+      model.getAllDecorations().map(d => d.id),\n+      [],\n+    );\n+  }\n+}"
            },
            {
                "file": "compiler/apps/playground/lib/stores/index.ts",
                "git_diff": "@@ -0,0 +1,9 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+export * from './messages';\n+export * from './store';"
            },
            {
                "file": "compiler/apps/playground/lib/stores/messages.ts",
                "git_diff": "@@ -0,0 +1,41 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+export enum MessageSource {\n+  Babel,\n+  Forget,\n+  Playground,\n+}\n+\n+export enum MessageLevel {\n+  Info,\n+  Warning,\n+  Error,\n+}\n+\n+export interface Message {\n+  title: string;\n+  level: MessageLevel;\n+  source: MessageSource; // Can be used to further style messages differently.\n+  codeframe: string | undefined;\n+}\n+\n+export function createMessage(\n+  message: string,\n+  level: MessageLevel,\n+  source: MessageSource,\n+): Message {\n+  const [title, ...body] = message.split('\\n');\n+  const codeframe = body.length > 0 ? body.join('\\n') : undefined;\n+\n+  return {\n+    source,\n+    level,\n+    title,\n+    codeframe,\n+  };\n+}"
            },
            {
                "file": "compiler/apps/playground/lib/stores/store.ts",
                "git_diff": "@@ -0,0 +1,67 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import invariant from 'invariant';\n+import {\n+  compressToEncodedURIComponent,\n+  decompressFromEncodedURIComponent,\n+} from 'lz-string';\n+import {defaultStore} from '../defaultStore';\n+\n+/**\n+ * Global Store for Playground\n+ */\n+export interface Store {\n+  source: string;\n+}\n+export function encodeStore(store: Store): string {\n+  return compressToEncodedURIComponent(JSON.stringify(store));\n+}\n+export function decodeStore(hash: string): Store {\n+  return JSON.parse(decompressFromEncodedURIComponent(hash));\n+}\n+\n+/**\n+ * Serialize, encode, and save @param store to localStorage and update URL.\n+ */\n+export function saveStore(store: Store) {\n+  const hash = encodeStore(store);\n+  localStorage.setItem('playgroundStore', hash);\n+  history.replaceState({}, '', `#${hash}`);\n+}\n+\n+/**\n+ * Check if @param raw is a valid Store by if\n+ * - it has a `source` property and is a string\n+ */\n+function isValidStore(raw: unknown): raw is Store {\n+  return (\n+    raw != null &&\n+    typeof raw == 'object' &&\n+    'source' in raw &&\n+    typeof raw['source'] === 'string'\n+  );\n+}\n+\n+/**\n+ * Deserialize, decode, and initialize @param store from URL and then\n+ * localStorage. Throw an error if Store is malformed.\n+ */\n+export function initStoreFromUrlOrLocalStorage(): Store {\n+  const encodedSourceFromUrl = location.hash.slice(1);\n+  const encodedSourceFromLocal = localStorage.getItem('playgroundStore');\n+  const encodedSource = encodedSourceFromUrl || encodedSourceFromLocal;\n+\n+  // No data in the URL and no data in the localStorage to fallback to.\n+  // Initialize with the default store.\n+  if (!encodedSource) return defaultStore;\n+\n+  const raw = decodeStore(encodedSource);\n+\n+  invariant(isValidStore(raw), 'Invalid Store');\n+  return raw;\n+}"
            },
            {
                "file": "compiler/apps/playground/lib/types.d.ts",
                "git_diff": "@@ -0,0 +1,20 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+// v0.17.1\n+declare module \"hermes-parser\" {\n+  type HermesParserOptions = {\n+    allowReturnOutsideFunction?: boolean;\n+    babel?: boolean;\n+    flow?: \"all\" | \"detect\";\n+    enableExperimentalComponentSyntax?: boolean;\n+    sourceFilename?: string;\n+    sourceType?: \"module\" | \"script\" | \"unambiguous\";\n+    tokens?: boolean;\n+  };\n+  export function parse(code: string, options: Partial<HermesParserOptions>);\n+}"
            },
            {
                "file": "compiler/apps/playground/next-env.d.ts",
                "git_diff": "@@ -0,0 +1,5 @@\n+/// <reference types=\"next\" />\n+/// <reference types=\"next/image-types/global\" />\n+\n+// NOTE: This file should not be edited\n+// see https://nextjs.org/docs/basic-features/typescript for more information."
            },
            {
                "file": "compiler/apps/playground/next.config.js",
                "git_diff": "@@ -0,0 +1,49 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+const MonacoWebpackPlugin = require('monaco-editor-webpack-plugin');\n+const path = require('path');\n+\n+const nextConfig = {\n+  reactStrictMode: true,\n+  webpack: (config, options) => {\n+    // Load *.d.ts files as strings using https://webpack.js.org/guides/asset-modules/#source-assets.\n+    config.module.rules.push({\n+      test: /\\.d\\.ts/,\n+      type: 'asset/source',\n+    });\n+\n+    // Monaco Editor\n+    if (!options.isServer) {\n+      config.plugins.push(\n+        new MonacoWebpackPlugin({\n+          languages: ['typescript', 'javascript'],\n+          filename: 'static/[name].worker.js',\n+        })\n+      );\n+    }\n+\n+    config.resolve.alias = {\n+      ...config.resolve.alias,\n+      'react-compiler-runtime': path.resolve(\n+        __dirname,\n+        '../../packages/react-compiler-runtime'\n+      ),\n+    };\n+    config.resolve.fallback = {\n+      fs: false,\n+      path: false,\n+      os: false,\n+    };\n+\n+    return config;\n+  },\n+\n+  transpilePackages: ['monaco-editor'],\n+};\n+\n+module.exports = nextConfig;"
            },
            {
                "file": "compiler/apps/playground/package.json",
                "git_diff": "@@ -0,0 +1,60 @@\n+{\n+  \"name\": \"playground\",\n+  \"version\": \"0.1.0\",\n+  \"private\": true,\n+  \"scripts\": {\n+    \"dev\": \"NODE_ENV=development next dev\",\n+    \"build\": \"next build && node ./scripts/downloadFonts.js\",\n+    \"vercel-build\": \"yarn workspaces run build\",\n+    \"start\": \"next start\",\n+    \"lint\": \"next lint\",\n+    \"test\": \"playwright test\"\n+  },\n+  \"dependencies\": {\n+    \"@babel/core\": \"^7.19.1\",\n+    \"@babel/generator\": \"^7.19.1\",\n+    \"@babel/parser\": \"^7.19.1\",\n+    \"@babel/plugin-syntax-typescript\": \"^7.18.6\",\n+    \"@babel/plugin-transform-block-scoping\": \"^7.18.9\",\n+    \"@babel/plugin-transform-modules-commonjs\": \"^7.18.6\",\n+    \"@babel/preset-react\": \"^7.18.6\",\n+    \"@babel/preset-typescript\": \"^7.18.6\",\n+    \"@babel/traverse\": \"^7.19.1\",\n+    \"@babel/types\": \"^7.19.0\",\n+    \"@heroicons/react\": \"^1.0.6\",\n+    \"@monaco-editor/react\": \"^4.4.6\",\n+    \"@playwright/test\": \"^1.42.1\",\n+    \"@use-gesture/react\": \"^10.2.22\",\n+    \"fs\": \"^0.0.1-security\",\n+    \"hermes-eslint\": \"^0.14.0\",\n+    \"hermes-parser\": \"^0.22.0\",\n+    \"invariant\": \"^2.2.4\",\n+    \"lz-string\": \"^1.5.0\",\n+    \"monaco-editor\": \"^0.34.1\",\n+    \"next\": \"^13.5.6\",\n+    \"notistack\": \"^3.0.0-alpha.7\",\n+    \"prettier\": \"^3.3.3\",\n+    \"pretty-format\": \"^29.3.1\",\n+    \"re-resizable\": \"^6.9.16\",\n+    \"react\": \"18.2.0\",\n+    \"react-compiler-runtime\": \"*\",\n+    \"react-dom\": \"18.2.0\"\n+  },\n+  \"devDependencies\": {\n+    \"@types/node\": \"18.11.9\",\n+    \"@types/react\": \"18.0.25\",\n+    \"@types/react-dom\": \"18.0.9\",\n+    \"autoprefixer\": \"^10.4.13\",\n+    \"clsx\": \"^1.2.1\",\n+    \"eslint\": \"^8.28.0\",\n+    \"eslint-config-next\": \"^13.5.6\",\n+    \"hermes-parser\": \"^0.22.0\",\n+    \"monaco-editor-webpack-plugin\": \"^7.1.0\",\n+    \"postcss\": \"^8.4.31\",\n+    \"tailwindcss\": \"^3.2.4\"\n+  },\n+  \"resolutions\": {\n+    \"./**/@babel/parser\": \"7.7.4\",\n+    \"./**/@babel/types\": \"7.7.4\"\n+  }\n+}"
            },
            {
                "file": "compiler/apps/playground/playwright.config.js",
                "git_diff": "@@ -0,0 +1,84 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+import {defineConfig, devices} from '@playwright/test';\n+import path from 'path';\n+\n+// Use process.env.PORT by default and fallback to port 3000\n+const PORT = process.env.PORT || 3000;\n+\n+// Set webServer.url and use.baseURL with the location of the WebServer respecting the correct set port\n+const baseURL = `http://localhost:${PORT}`;\n+\n+// Reference: https://playwright.dev/docs/test-configuration\n+export default defineConfig({\n+  // Timeout per test\n+  timeout: 30 * 1000,\n+  // Test directory\n+  testDir: path.join(__dirname, '__tests__/e2e'),\n+  // If a test fails, retry it additional 2 times\n+  retries: 2,\n+  // Artifacts folder where screenshots, videos, and traces are stored.\n+  outputDir: 'test-results/',\n+  // Note: we only use text snapshots, so its safe to omit the host environment name\n+  snapshotPathTemplate: '{testDir}/__snapshots__/{testFilePath}/{arg}{ext}',\n+\n+  // Run your local dev server before starting the tests:\n+  // https://playwright.dev/docs/test-advanced#launching-a-development-web-server-during-the-tests\n+  webServer: {\n+    command:\n+      'yarn workspace babel-plugin-react-compiler build && yarn workspace react-compiler-runtime build && yarn dev',\n+    url: baseURL,\n+    timeout: 300 * 1000,\n+    reuseExistingServer: !process.env.CI,\n+  },\n+\n+  use: {\n+    // Use baseURL so to make navigations relative.\n+    // More information: https://playwright.dev/docs/api/class-testoptions#test-options-base-url\n+    baseURL,\n+\n+    // Retry a test if its failing with enabled tracing. This allows you to analyze the DOM, console logs, network traffic etc.\n+    // More information: https://playwright.dev/docs/trace-viewer\n+    trace: 'retry-with-trace',\n+\n+    // All available context options: https://playwright.dev/docs/api/class-browser#browser-new-context\n+    // contextOptions: {\n+    //   ignoreHTTPSErrors: true,\n+    // },\n+  },\n+\n+  projects: [\n+    {\n+      name: 'chromium',\n+      use: {...devices['Desktop Chrome']},\n+    },\n+    // {\n+    //   name: 'Desktop Firefox',\n+    //   use: {\n+    //     ...devices['Desktop Firefox'],\n+    //   },\n+    // },\n+    // {\n+    //   name: 'Desktop Safari',\n+    //   use: {\n+    //     ...devices['Desktop Safari'],\n+    //   },\n+    // },\n+    // Test against mobile viewports.\n+    // {\n+    //   name: \"Mobile Chrome\",\n+    //   use: {\n+    //     ...devices[\"Pixel 5\"],\n+    //   },\n+    // },\n+    // {\n+    //   name: \"Mobile Safari\",\n+    //   use: devices[\"iPhone 12\"],\n+    // },\n+  ],\n+});"
            },
            {
                "file": "compiler/apps/playground/postcss.config.js",
                "git_diff": "@@ -0,0 +1,13 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+module.exports = {\n+  plugins: {\n+    tailwindcss: {},\n+    autoprefixer: {},\n+  },\n+};"
            },
            {
                "file": "compiler/apps/playground/public/favicon.ico",
                "git_diff": ""
            },
            {
                "file": "compiler/apps/playground/public/fonts/Source-Code-Pro-Regular.woff2",
                "git_diff": ""
            },
            {
                "file": "compiler/apps/playground/public/graphvizlib.wasm",
                "git_diff": ""
            },
            {
                "file": "compiler/apps/playground/public/icon-180x180.png",
                "git_diff": ""
            },
            {
                "file": "compiler/apps/playground/public/site.webmanifest",
                "git_diff": "@@ -0,0 +1,16 @@\n+{\n+  \"name\": \"React Compiler Playground\",\n+  \"short_name\": \"React REPL\",\n+  \"display\": \"standalone\",\n+  \"start_url\": \"/\",\n+  \"theme_color\": \"#fff\",\n+  \"background_color\": \"#000000\",\n+  \"orientation\": \"portrait\",\n+  \"icons\": [\n+    {\n+      \"src\": \"/icon-180x180.png\",\n+      \"type\": \"image/png\",\n+      \"sizes\": \"180x180\"\n+    }\n+  ]\n+}"
            },
            {
                "file": "compiler/apps/playground/public/vercel.svg",
                "git_diff": "@@ -0,0 +1,4 @@\n+<svg width=\"283\" height=\"64\" viewBox=\"0 0 283 64\" fill=\"none\" \n+    xmlns=\"http://www.w3.org/2000/svg\">\n+    <path d=\"M141.04 16c-11.04 0-19 7.2-19 18s8.96 18 20 18c6.67 0 12.55-2.64 16.19-7.09l-7.65-4.42c-2.02 2.21-5.09 3.5-8.54 3.5-4.79 0-8.86-2.5-10.37-6.5h28.02c.22-1.12.35-2.28.35-3.5 0-10.79-7.96-17.99-19-17.99zm-9.46 14.5c1.25-3.99 4.67-6.5 9.45-6.5 4.79 0 8.21 2.51 9.45 6.5h-18.9zM248.72 16c-11.04 0-19 7.2-19 18s8.96 18 20 18c6.67 0 12.55-2.64 16.19-7.09l-7.65-4.42c-2.02 2.21-5.09 3.5-8.54 3.5-4.79 0-8.86-2.5-10.37-6.5h28.02c.22-1.12.35-2.28.35-3.5 0-10.79-7.96-17.99-19-17.99zm-9.45 14.5c1.25-3.99 4.67-6.5 9.45-6.5 4.79 0 8.21 2.51 9.45 6.5h-18.9zM200.24 34c0 6 3.92 10 10 10 4.12 0 7.21-1.87 8.8-4.92l7.68 4.43c-3.18 5.3-9.14 8.49-16.48 8.49-11.05 0-19-7.2-19-18s7.96-18 19-18c7.34 0 13.29 3.19 16.48 8.49l-7.68 4.43c-1.59-3.05-4.68-4.92-8.8-4.92-6.07 0-10 4-10 10zm82.48-29v46h-9V5h9zM36.95 0L73.9 64H0L36.95 0zm92.38 5l-27.71 48L73.91 5H84.3l17.32 30 17.32-30h10.39zm58.91 12v9.69c-1-.29-2.06-.49-3.2-.49-5.81 0-10 4-10 10V51h-9V17h9v9.2c0-5.08 5.91-9.2 13.2-9.2z\" fill=\"#000\"/>\n+</svg>\n\\ No newline at end of file"
            },
            {
                "file": "compiler/apps/playground/scripts/downloadFonts.js",
                "git_diff": "@@ -0,0 +1,20 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+const {execSync} = require('child_process');\n+\n+// So that we don't need to check them into the repo.\n+// See https://github.com/reactjs/reactjs.org/blob/main/beta/scripts/downloadFonts.js.\n+execSync(\n+  'curl https://conf.reactjs.org/fonts/Optimistic_Display_W_Lt.woff2 --output public/fonts/Optimistic_Display_W_Lt.woff2'\n+);\n+execSync(\n+  'curl https://conf.reactjs.org/fonts/Optimistic_Display_W_Md.woff2 --output public/fonts/Optimistic_Display_W_Md.woff2'\n+);\n+execSync(\n+  'curl https://conf.reactjs.org/fonts/Optimistic_Display_W_Bd.woff2 --output public/fonts/Optimistic_Display_W_Bd.woff2'\n+);"
            },
            {
                "file": "compiler/apps/playground/styles/globals.css",
                "git_diff": "@@ -0,0 +1,71 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+@tailwind base;\n+@tailwind components;\n+@tailwind utilities;\n+\n+@layer base {\n+  @font-face {\n+    font-family: \"Source Code Pro\";\n+    font-style: normal;\n+    font-weight: 400;\n+    font-display: swap;\n+    src: url(\"/fonts/Source-Code-Pro-Regular.woff2\") format(\"woff2\");\n+  }\n+\n+  @font-face {\n+    font-family: \"Optimistic Display\";\n+    src: url(\"/fonts/Optimistic_Display_W_Lt.woff2\") format(\"woff2\");\n+    font-weight: 300;\n+    font-style: normal;\n+    font-display: swap;\n+  }\n+\n+  @font-face {\n+    font-family: \"Optimistic Display\";\n+    src: url(\"/fonts/Optimistic_Display_W_Md.woff2\") format(\"woff2\");\n+    font-weight: 500;\n+    font-style: normal;\n+    font-display: swap;\n+  }\n+\n+  @font-face {\n+    font-family: \"Optimistic Display\";\n+    src: url(\"/fonts/Optimistic_Display_W_Bd.woff2\") format(\"woff2\");\n+    font-weight: 700;\n+    font-style: normal;\n+    font-display: swap;\n+  }\n+\n+  html,\n+  body {\n+    padding: 0;\n+    margin: 0;\n+  }\n+\n+  a {\n+    color: inherit;\n+    text-decoration: none;\n+  }\n+\n+  * {\n+    box-sizing: border-box;\n+  }\n+}\n+\n+@layer utilities {\n+  /* Chrome, Safari, Opera */\n+  .no-scrollbar::-webkit-scrollbar {\n+    display: none;\n+  }\n+\n+  .no-scrollbar {\n+    -ms-overflow-style: none; /* IE, Edge */\n+    scrollbar-width: none; /* Firefox */\n+  }\n+}"
            },
            {
                "file": "compiler/apps/playground/tailwind.config.js",
                "git_diff": "@@ -0,0 +1,41 @@\n+/**\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+const defaultTheme = require('tailwindcss/defaultTheme');\n+const colors = require('./colors');\n+\n+module.exports = {\n+  content: [\n+    './app/**/*.{js,ts,jsx,tsx}',\n+    './pages/**/*.{js,ts,jsx,tsx}',\n+    './components/**/*.{js,ts,jsx,tsx}',\n+    './lib/forgetMonacoDiagnostics.ts',\n+  ],\n+  theme: {\n+    extend: {\n+      colors,\n+      width: {\n+        toast: 'min(900px, 100vw - 40px)',\n+        'toast-body': 'calc(100% - 60px)',\n+        'toast-title': 'calc(100% - 40px)',\n+      },\n+      height: {\n+        content: 'calc(100vh - 45px)',\n+        monaco: 'calc(100vh - 93px)',\n+        monaco_small: 'calc(100vh - 129px)',\n+      },\n+      fontFamily: {\n+        sans: [\n+          'Optimistic Display',\n+          '-apple-system',\n+          ...defaultTheme.fontFamily.sans,\n+        ],\n+      },\n+    },\n+  },\n+  plugins: [],\n+};"
            },
            {
                "file": "compiler/apps/playground/tsconfig.json",
                "git_diff": "@@ -0,0 +1,36 @@\n+{\n+  \"compilerOptions\": {\n+    \"target\": \"ES2015\",\n+    \"lib\": [\n+      \"dom\",\n+      \"dom.iterable\",\n+      \"esnext\"\n+    ],\n+    \"allowJs\": true,\n+    \"skipLibCheck\": true,\n+    \"strict\": true,\n+    \"forceConsistentCasingInFileNames\": true,\n+    \"noEmit\": true,\n+    \"esModuleInterop\": true,\n+    \"module\": \"esnext\",\n+    \"moduleResolution\": \"node\",\n+    \"resolveJsonModule\": true,\n+    \"isolatedModules\": true,\n+    \"jsx\": \"preserve\",\n+    \"incremental\": true,\n+    \"plugins\": [\n+      {\n+        \"name\": \"next\"\n+      }\n+    ]\n+  },\n+  \"include\": [\n+    \"next-env.d.ts\",\n+    \"**/*.ts\",\n+    \"**/*.tsx\",\n+    \".next/types/**/*.ts\"\n+  ],\n+  \"exclude\": [\n+    \"node_modules\"\n+  ]\n+}"
            },
            {
                "file": "compiler/apps/playground/vercel.json",
                "git_diff": "@@ -0,0 +1,13 @@\n+{\n+ \"headers\": [\n+    {\n+      \"source\": \"/fonts/(.*).woff2\",\n+      \"headers\": [\n+        {\n+          \"key\": \"Cache-Control\",\n+          \"value\": \"public, max-age=31536000, immutable\"\n+        }\n+      ]\n+    }\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_build_hir/Cargo.toml",
                "git_diff": "@@ -0,0 +1,21 @@\n+[package]\n+name = \"react_build_hir\"\n+version = \"0.1.0\"\n+publish               = false\n+authors.workspace     = true\n+description.workspace = true\n+edition.workspace     = true\n+homepage.workspace    = true\n+keywords.workspace    = true\n+license.workspace     = true\n+repository.workspace  = true\n+\n+# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n+\n+[dependencies]\n+react_hir = { workspace = true }\n+react_estree = { workspace = true}\n+indexmap = { workspace = true }\n+react_diagnostics = { workspace = true }\n+react_semantic_analysis = { workspace = true }\n+thiserror = { workspace = true }"
            },
            {
                "file": "compiler/crates/react_build_hir/README.md",
                "git_diff": "@@ -0,0 +1,3 @@\n+# Build-HIR\n+\n+This crate converts from `react_estree` into React Compiler's HIR format as the first phase of compilation.\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_build_hir/src/build.rs",
                "git_diff": "@@ -0,0 +1,746 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use std::collections::HashSet;\n+\n+use react_diagnostics::Diagnostic;\n+use react_estree::{\n+    AssignmentPropertyOrRestElement, AssignmentTarget, BlockStatement, Expression,\n+    ExpressionOrSpread, ExpressionOrSuper, ForInit, Function, IntoFunction, JsValue, Pattern,\n+    Statement, VariableDeclaration, VariableDeclarationKind,\n+};\n+use react_hir::{\n+    ArrayDestructureItem, BlockKind, BranchTerminal, Destructure, DestructurePattern, Environment,\n+    ForTerminal, GotoKind, Identifier, IdentifierOperand, InstructionKind, InstructionValue,\n+    JSXAttribute, JSXElement, LValue, LoadGlobal, LoadLocal, ObjectDestructureItem,\n+    ObjectDestructureProperty, PlaceOrSpread, TerminalValue,\n+};\n+\n+use crate::builder::{Builder, LoopScope};\n+use crate::context::get_context_identifiers;\n+use crate::error::BuildHIRError;\n+\n+/// Converts a React function in ESTree format into HIR. Returns the HIR\n+/// if it was constructed sucessfully, otherwise a list of diagnostics\n+/// if the input could be not be converted to HIR.\n+///\n+/// Failures generally include nonsensical input (`delete 1`) or syntax\n+/// that is not yet supported.\n+pub fn build(env: &Environment, fun: &Function) -> Result<Box<react_hir::Function>, Diagnostic> {\n+    let mut builder = Builder::new(env);\n+\n+    let mut params = Vec::with_capacity(fun.params.len());\n+    for param in &fun.params {\n+        match param {\n+            Pattern::Identifier(param) => {\n+                let identifier = lower_identifier_for_assignment(\n+                    env,\n+                    &mut builder,\n+                    InstructionKind::Let,\n+                    param,\n+                )?;\n+                params.push(identifier);\n+            }\n+            _ => {\n+                return Err(Diagnostic::todo(\n+                    \"Support non-identifier params\",\n+                    param.range(),\n+                ));\n+            }\n+        }\n+    }\n+\n+    match &fun.body {\n+        Some(react_estree::FunctionBody::BlockStatement(body)) => {\n+            lower_block_statement(env, &mut builder, body)?\n+        }\n+        Some(react_estree::FunctionBody::Expression(body)) => {\n+            lower_expression(env, &mut builder, body)?;\n+        }\n+        None => {\n+            return Err(Diagnostic::invalid_syntax(\n+                BuildHIRError::EmptyFunction,\n+                fun.range,\n+            ));\n+        }\n+    }\n+\n+    // In case the function did not explicitly return, terminate the final\n+    // block with an explicit `return undefined`. If the function *did* return,\n+    // this will be unreachable and get pruned later.\n+    let implicit_return_value = builder.push(InstructionValue::Primitive(react_hir::Primitive {\n+        value: JsValue::Undefined,\n+    }));\n+    builder.terminate(\n+        TerminalValue::Return(react_hir::ReturnTerminal {\n+            value: implicit_return_value,\n+        }),\n+        react_hir::BlockKind::Block,\n+    );\n+\n+    let body = builder.build()?;\n+    Ok(Box::new(react_hir::Function {\n+        id: fun.id.as_ref().map(|id| id.name.clone()),\n+        body,\n+        params,\n+        // TODO: populate context!\n+        context: Default::default(),\n+        is_async: fun.is_async,\n+        is_generator: fun.is_generator,\n+    }))\n+}\n+\n+fn lower_block_statement(\n+    env: &Environment,\n+    builder: &mut Builder,\n+    stmt: &BlockStatement,\n+) -> Result<(), Diagnostic> {\n+    for stmt in &stmt.body {\n+        lower_statement(env, builder, stmt, None)?;\n+    }\n+    Ok(())\n+}\n+\n+/// Convert a statement to HIR. This will often result in multiple instructions and blocks\n+/// being created as statements often describe control flow.\n+fn lower_statement(\n+    env: &Environment,\n+    builder: &mut Builder,\n+    stmt: &Statement,\n+    label: Option<String>,\n+) -> Result<(), Diagnostic> {\n+    match stmt {\n+        Statement::BlockStatement(stmt) => {\n+            lower_block_statement(env, builder, stmt)?;\n+        }\n+        Statement::BreakStatement(stmt) => {\n+            let block = builder.resolve_break(stmt.label.as_ref())?;\n+            builder.terminate(\n+                TerminalValue::Goto(react_hir::GotoTerminal {\n+                    block,\n+                    kind: GotoKind::Break,\n+                }),\n+                BlockKind::Block,\n+            );\n+        }\n+        Statement::ContinueStatement(stmt) => {\n+            let block = builder.resolve_continue(stmt.label.as_ref())?;\n+            builder.terminate(\n+                TerminalValue::Goto(react_hir::GotoTerminal {\n+                    block,\n+                    kind: GotoKind::Continue,\n+                }),\n+                BlockKind::Block,\n+            );\n+        }\n+        Statement::ReturnStatement(stmt) => {\n+            let value = match &stmt.argument {\n+                Some(argument) => lower_expression(env, builder, argument)?,\n+                None => builder.push(InstructionValue::Primitive(react_hir::Primitive {\n+                    value: JsValue::Undefined,\n+                })),\n+            };\n+            builder.terminate(\n+                TerminalValue::Return(react_hir::ReturnTerminal { value }),\n+                BlockKind::Block,\n+            );\n+        }\n+        Statement::ExpressionStatement(stmt) => {\n+            lower_expression(env, builder, &stmt.expression)?;\n+        }\n+        Statement::EmptyStatement(_) => {\n+            // no-op\n+        }\n+        Statement::VariableDeclaration(stmt) => {\n+            lower_variable_declaration(env, builder, stmt)?;\n+        }\n+        Statement::IfStatement(stmt) => {\n+            // block for what follows the if statement, though this may\n+            // not be reachable\n+            let fallthrough_block = builder.reserve(BlockKind::Block);\n+\n+            let consequent_block = builder.enter(BlockKind::Block, |builder| {\n+                lower_statement(env, builder, &stmt.consequent, None)?;\n+                Ok(TerminalValue::Goto(react_hir::GotoTerminal {\n+                    block: fallthrough_block.id,\n+                    kind: GotoKind::Break,\n+                }))\n+            })?;\n+\n+            let alternate_block = builder.enter(BlockKind::Block, |builder| {\n+                if let Some(alternate) = &stmt.alternate {\n+                    lower_statement(env, builder, alternate, None)?;\n+                }\n+                Ok(TerminalValue::Goto(react_hir::GotoTerminal {\n+                    block: fallthrough_block.id,\n+                    kind: GotoKind::Break,\n+                }))\n+            })?;\n+\n+            let test = lower_expression(env, builder, &stmt.test)?;\n+            let terminal = TerminalValue::If(react_hir::IfTerminal {\n+                test,\n+                consequent: consequent_block,\n+                alternate: alternate_block,\n+                fallthrough: Some(fallthrough_block.id),\n+            });\n+            builder.terminate_with_fallthrough(terminal, fallthrough_block);\n+        }\n+        Statement::ForStatement(stmt) => {\n+            // Block for the loop's test condition\n+            let test_block = builder.reserve(BlockKind::Loop);\n+\n+            // Block for code following the loop\n+            let fallthrough_block = builder.reserve(BlockKind::Block);\n+\n+            let init_block = builder.enter(BlockKind::Loop, |builder| {\n+                if let Some(ForInit::VariableDeclaration(decl)) = &stmt.init {\n+                    lower_variable_declaration(env, builder, decl)?;\n+                    Ok(TerminalValue::Goto(react_hir::GotoTerminal {\n+                        block: test_block.id,\n+                        kind: GotoKind::Break,\n+                    }))\n+                } else {\n+                    Err(Diagnostic::todo(\n+                        BuildHIRError::ForStatementIsMissingInitializer,\n+                        None,\n+                    ))\n+                }\n+            })?;\n+\n+            let update_block = stmt\n+                .update\n+                .as_ref()\n+                .map(|update| {\n+                    builder.enter(BlockKind::Loop, |builder| {\n+                        lower_expression(env, builder, update)?;\n+                        Ok(TerminalValue::Goto(react_hir::GotoTerminal {\n+                            block: test_block.id,\n+                            kind: GotoKind::Break,\n+                        }))\n+                    })\n+                })\n+                .transpose()?;\n+\n+            let body_block = builder.enter(BlockKind::Block, |builder| {\n+                let loop_ = LoopScope {\n+                    label,\n+                    continue_block: update_block.unwrap_or(test_block.id),\n+                    break_block: fallthrough_block.id,\n+                };\n+                builder.enter_loop(loop_, |builder| {\n+                    lower_statement(env, builder, &stmt.body, None)?;\n+                    Ok(TerminalValue::Goto(react_hir::GotoTerminal {\n+                        block: update_block.unwrap_or(test_block.id),\n+                        kind: GotoKind::Continue,\n+                    }))\n+                })\n+            })?;\n+\n+            let terminal = TerminalValue::For(ForTerminal {\n+                body: body_block,\n+                init: init_block,\n+                test: test_block.id,\n+                fallthrough: fallthrough_block.id,\n+                update: update_block,\n+            });\n+            builder.terminate_with_fallthrough(terminal, test_block);\n+\n+            if let Some(test) = &stmt.test {\n+                let test_value = lower_expression(env, builder, test)?;\n+                let terminal = TerminalValue::Branch(BranchTerminal {\n+                    test: test_value,\n+                    consequent: body_block,\n+                    alternate: fallthrough_block.id,\n+                });\n+                builder.terminate_with_fallthrough(terminal, fallthrough_block);\n+            } else {\n+                return Err(Diagnostic::todo(\n+                    BuildHIRError::ForStatementIsMissingTest,\n+                    stmt.range,\n+                ));\n+            }\n+        }\n+        _ => todo!(\"Lower {stmt:#?}\"),\n+    }\n+    Ok(())\n+}\n+\n+fn lower_variable_declaration(\n+    env: &Environment,\n+    builder: &mut Builder,\n+    stmt: &VariableDeclaration,\n+) -> Result<(), Diagnostic> {\n+    let kind = match stmt.kind {\n+        VariableDeclarationKind::Const => InstructionKind::Const,\n+        VariableDeclarationKind::Let => InstructionKind::Let,\n+        VariableDeclarationKind::Var => {\n+            return Err(Diagnostic::unsupported(\n+                BuildHIRError::VariableDeclarationKindIsVar,\n+                stmt.range,\n+            ));\n+        }\n+    };\n+    for declaration in &stmt.declarations {\n+        if let Some(init) = &declaration.init {\n+            let value = lower_expression(env, builder, init)?;\n+            lower_assignment_pattern(env, builder, kind, &declaration.id, value)?;\n+        } else {\n+            match &declaration.id {\n+                Pattern::Identifier(id) => {\n+                    let identifier = env.resolve_variable_declaration(id.as_ref(), &id.name);\n+                    if let Some(identifier) = identifier {\n+                        builder.push(InstructionValue::DeclareLocal(react_hir::DeclareLocal {\n+                            lvalue: LValue {\n+                                identifier: IdentifierOperand {\n+                                    identifier,\n+                                    effect: None,\n+                                },\n+                                kind,\n+                            },\n+                        }));\n+                    } else {\n+                        return Err(Diagnostic::invariant(\n+                            BuildHIRError::VariableDeclarationBindingIsNonLocal,\n+                            id.range,\n+                        ));\n+                    }\n+                }\n+                _ => {\n+                    return Err(Diagnostic::invalid_syntax(\n+                        \"Expected an identifier for variable declaration without an intializer. Destructuring requires an initial value\",\n+                        declaration.range,\n+                    ));\n+                }\n+            }\n+        }\n+    }\n+    Ok(())\n+}\n+\n+/// Converts an ESTree Expression into an HIR InstructionValue. Note that while only a single\n+/// InstructionValue is returned, this function is recursive and may cause multiple instructions\n+/// to be emitted, possibly across multiple basic blocks (in the case of expressions with control\n+/// flow semenatics such as logical, conditional, and optional expressions).\n+fn lower_expression(\n+    env: &Environment,\n+    builder: &mut Builder,\n+    expr: &Expression,\n+) -> Result<IdentifierOperand, Diagnostic> {\n+    let value = match expr {\n+        Expression::Identifier(expr) => {\n+            let identifier = env.resolve_variable_reference(expr.as_ref());\n+            if let Some(identifier) = identifier {\n+                let place = IdentifierOperand {\n+                    effect: None,\n+                    identifier,\n+                };\n+                InstructionValue::LoadLocal(LoadLocal { place })\n+            } else {\n+                InstructionValue::LoadGlobal(LoadGlobal {\n+                    name: expr.name.clone(),\n+                })\n+            }\n+        }\n+        Expression::Literal(expr) => InstructionValue::Primitive(react_hir::Primitive {\n+            value: expr.value.clone(),\n+        }),\n+        Expression::NumericLiteral(expr) => InstructionValue::Primitive(react_hir::Primitive {\n+            value: JsValue::Number(expr.value),\n+        }),\n+        Expression::BooleanLiteral(expr) => InstructionValue::Primitive(react_hir::Primitive {\n+            value: JsValue::Boolean(expr.value),\n+        }),\n+        Expression::StringLiteral(expr) => InstructionValue::Primitive(react_hir::Primitive {\n+            value: JsValue::String(expr.value.clone()),\n+        }),\n+        Expression::NullLiteral(_expr) => InstructionValue::Primitive(react_hir::Primitive {\n+            value: JsValue::Null,\n+        }),\n+        Expression::ArrayExpression(expr) => {\n+            let mut elements = Vec::with_capacity(expr.elements.len());\n+            for expr in &expr.elements {\n+                let element = match expr {\n+                    Some(react_estree::ExpressionOrSpread::SpreadElement(expr)) => Some(\n+                        PlaceOrSpread::Spread(lower_expression(env, builder, &expr.argument)?),\n+                    ),\n+                    Some(react_estree::ExpressionOrSpread::Expression(expr)) => {\n+                        Some(PlaceOrSpread::Place(lower_expression(env, builder, expr)?))\n+                    }\n+                    None => None,\n+                };\n+                elements.push(element);\n+            }\n+            InstructionValue::Array(react_hir::Array { elements })\n+        }\n+\n+        Expression::AssignmentExpression(expr) => match expr.operator {\n+            react_estree::AssignmentOperator::Equals => {\n+                let right = lower_expression(env, builder, &expr.right)?;\n+                return lower_assignment(\n+                    env,\n+                    builder,\n+                    InstructionKind::Reassign,\n+                    &expr.left,\n+                    right,\n+                );\n+            }\n+            _ => todo!(\"lower assignment expr {:#?}\", expr),\n+        },\n+\n+        Expression::BinaryExpression(expr) => {\n+            let left = lower_expression(env, builder, &expr.left)?;\n+            let right = lower_expression(env, builder, &expr.right)?;\n+            InstructionValue::Binary(react_hir::Binary {\n+                left,\n+                operator: expr.operator,\n+                right,\n+            })\n+        }\n+\n+        Expression::FunctionExpression(expr) => {\n+            InstructionValue::Function(lower_function(env, builder, expr.as_ref())?)\n+        }\n+\n+        Expression::ArrowFunctionExpression(expr) => {\n+            InstructionValue::Function(lower_function(env, builder, expr.as_ref())?)\n+        }\n+\n+        Expression::CallExpression(expr) => {\n+            let callee_expr = match &expr.callee {\n+                ExpressionOrSuper::Super(callee) => {\n+                    return Err(Diagnostic::unsupported(\n+                        BuildHIRError::UnsupportedSuperExpression,\n+                        callee.range,\n+                    ));\n+                }\n+                ExpressionOrSuper::Expression(callee) => callee,\n+            };\n+\n+            if matches!(&callee_expr, Expression::MemberExpression(_)) {\n+                return Err(Diagnostic::todo(\"Support method calls\", expr.range));\n+            }\n+\n+            let callee = lower_expression(env, builder, callee_expr)?;\n+            let arguments = lower_arguments(env, builder, &expr.arguments)?;\n+            InstructionValue::Call(react_hir::Call { callee, arguments })\n+        }\n+\n+        Expression::JSXElement(expr) => {\n+            InstructionValue::JSXElement(lower_jsx_element(env, builder, expr)?)\n+        }\n+\n+        _ => todo!(\"Lower expr {expr:#?}\"),\n+    };\n+    Ok(builder.push(value))\n+}\n+\n+fn lower_arguments(\n+    env: &Environment,\n+    builder: &mut Builder,\n+    args: &[ExpressionOrSpread],\n+) -> Result<Vec<PlaceOrSpread>, Diagnostic> {\n+    let mut arguments = Vec::with_capacity(args.len());\n+    for arg in args {\n+        let element = match arg {\n+            react_estree::ExpressionOrSpread::SpreadElement(arg) => {\n+                PlaceOrSpread::Spread(lower_expression(env, builder, &arg.argument)?)\n+            }\n+            react_estree::ExpressionOrSpread::Expression(arg) => {\n+                PlaceOrSpread::Place(lower_expression(env, builder, arg)?)\n+            }\n+        };\n+        arguments.push(element);\n+    }\n+    Ok(arguments)\n+}\n+\n+fn lower_function<T: IntoFunction>(\n+    env: &Environment,\n+    _builder: &mut Builder,\n+    function: &T,\n+) -> Result<react_hir::FunctionExpression, Diagnostic> {\n+    let context_identifiers = get_context_identifiers(env, function);\n+    let mut context = Vec::new();\n+    let mut seen = HashSet::new();\n+    for declaration_id in context_identifiers {\n+        if let Some(identifier) = env.resolve_declaration_id(declaration_id) {\n+            if !seen.insert(identifier.id) {\n+                continue;\n+            }\n+            context.push(IdentifierOperand {\n+                effect: None,\n+                identifier,\n+            });\n+        }\n+    }\n+    let mut fun = build(env, function.function())?;\n+    fun.context = context;\n+    Ok(react_hir::FunctionExpression {\n+        // TODO: collect dependencies!\n+        dependencies: Default::default(),\n+        lowered_function: fun,\n+    })\n+}\n+\n+fn lower_jsx_element(\n+    env: &Environment,\n+    builder: &mut Builder,\n+    expr: &react_estree::JSXElement,\n+) -> Result<JSXElement, Diagnostic> {\n+    let props: Result<Vec<JSXAttribute>, Diagnostic> = expr\n+        .opening_element\n+        .attributes\n+        .iter()\n+        .map(|attr| lower_jsx_attribute(env, builder, attr))\n+        .collect();\n+    let _props = props?;\n+    let children: Result<Vec<IdentifierOperand>, Diagnostic> = expr\n+        .children\n+        .iter()\n+        .map(|child| {\n+            let child = lower_jsx_child(env, builder, child)?;\n+            Ok(child)\n+        })\n+        .collect();\n+    let _children = children?;\n+    todo!(\"lower jsx element\");\n+    // Ok(JSXElement {\n+    //     tag: todo!(),\n+    //     props,\n+    //     children: if children.is_empty() {\n+    //         None\n+    //     } else {\n+    //         Some(children)\n+    //     },\n+    // })\n+}\n+\n+fn lower_jsx_attribute(\n+    _env: &Environment,\n+    _builder: &mut Builder,\n+    _attr: &react_estree::JSXAttributeOrSpread,\n+) -> Result<JSXAttribute, Diagnostic> {\n+    todo!(\"lower jsx attribute\")\n+}\n+\n+fn lower_jsx_child(\n+    _env: &Environment,\n+    _builder: &mut Builder,\n+    _child: &react_estree::JSXChildItem,\n+) -> Result<IdentifierOperand, Diagnostic> {\n+    todo!(\"lower jsx child\")\n+}\n+\n+fn lower_assignment(\n+    env: &Environment,\n+    builder: &mut Builder,\n+    kind: InstructionKind,\n+    lvalue: &AssignmentTarget,\n+    value: IdentifierOperand,\n+) -> Result<IdentifierOperand, Diagnostic> {\n+    Ok(match lvalue {\n+        AssignmentTarget::Pattern(lvalue) => {\n+            lower_assignment_pattern(env, builder, kind, lvalue, value)?\n+        }\n+        _ => todo!(\"lower assignment for {:#?}\", lvalue),\n+    })\n+}\n+\n+// TODO: change the success type to void, no caller uses it\n+fn lower_assignment_pattern(\n+    env: &Environment,\n+    builder: &mut Builder,\n+    kind: InstructionKind,\n+    lvalue: &Pattern,\n+    value: IdentifierOperand,\n+) -> Result<IdentifierOperand, Diagnostic> {\n+    Ok(match lvalue {\n+        Pattern::Identifier(lvalue) => {\n+            let identifier = lower_identifier_for_assignment(env, builder, kind, lvalue)?;\n+            builder.push(InstructionValue::StoreLocal(react_hir::StoreLocal {\n+                lvalue: LValue { identifier, kind },\n+                value,\n+            }))\n+        }\n+        Pattern::ArrayPattern(lvalue) => {\n+            let mut items = Vec::with_capacity(lvalue.elements.len());\n+            let mut followups: Vec<(Identifier, &Pattern)> = Vec::new();\n+            for element in &lvalue.elements {\n+                match element {\n+                    None => items.push(ArrayDestructureItem::Hole),\n+                    Some(Pattern::Identifier(element)) => {\n+                        let identifier =\n+                            lower_identifier_for_assignment(env, builder, kind, element)?;\n+                        items.push(ArrayDestructureItem::Value(identifier));\n+                    }\n+                    Some(Pattern::RestElement(element)) => {\n+                        if let Pattern::Identifier(element) = &element.argument {\n+                            let identifier = lower_identifier_for_assignment(\n+                                env,\n+                                builder,\n+                                kind,\n+                                element.as_ref(),\n+                            )?;\n+                            items.push(ArrayDestructureItem::Spread(identifier));\n+                        } else {\n+                            let temporary = env.new_temporary();\n+                            items.push(ArrayDestructureItem::Spread(IdentifierOperand {\n+                                identifier: temporary.clone(),\n+                                effect: None,\n+                            }));\n+                            followups.push((temporary, &element.argument));\n+                        }\n+                    }\n+                    Some(element) => {\n+                        let temporary = env.new_temporary();\n+                        items.push(ArrayDestructureItem::Value(IdentifierOperand {\n+                            identifier: temporary.clone(),\n+                            effect: None,\n+                        }));\n+                        followups.push((temporary, element));\n+                    }\n+                }\n+            }\n+            let temporary = builder.push(InstructionValue::Destructure(Destructure {\n+                kind,\n+                pattern: DestructurePattern::Array(items),\n+                value,\n+            }));\n+            for (temporary, pattern) in followups {\n+                lower_assignment_pattern(\n+                    env,\n+                    builder,\n+                    kind,\n+                    pattern,\n+                    IdentifierOperand {\n+                        identifier: temporary,\n+                        effect: None,\n+                    },\n+                )?;\n+            }\n+            temporary\n+        }\n+        Pattern::ObjectPattern(lvalue) => {\n+            let mut properties = Vec::with_capacity(lvalue.properties.len());\n+            let mut followups: Vec<(Identifier, &Pattern)> = Vec::new();\n+\n+            for property in &lvalue.properties {\n+                match property {\n+                    AssignmentPropertyOrRestElement::RestElement(property) => {\n+                        if let Pattern::Identifier(element) = &property.argument {\n+                            let identifier = lower_identifier_for_assignment(\n+                                env,\n+                                builder,\n+                                kind,\n+                                element.as_ref(),\n+                            )?;\n+                            properties.push(ObjectDestructureItem::Spread(identifier));\n+                        } else {\n+                            let temporary = env.new_temporary();\n+                            properties.push(ObjectDestructureItem::Spread(IdentifierOperand {\n+                                identifier: temporary.clone(),\n+                                effect: None,\n+                            }));\n+                            followups.push((temporary, &property.argument));\n+                        }\n+                    }\n+                    AssignmentPropertyOrRestElement::AssignmentProperty(property) => {\n+                        if property.is_computed {\n+                            return Err(Diagnostic::todo(\n+                                \"Handle computed properties in ObjectPattern\",\n+                                property.range,\n+                            ));\n+                        }\n+                        let key = if let Expression::Identifier(key) = &property.key {\n+                            key.name.as_str()\n+                        } else {\n+                            return Err(Diagnostic::todo(\n+                                \"Support non-identifier object keys in non-computed ObjectPattern\",\n+                                property.range,\n+                            ));\n+                        };\n+                        if let Pattern::Identifier(value) = &property.value {\n+                            let value = lower_identifier_for_assignment(env, builder, kind, value)?;\n+                            properties.push(ObjectDestructureItem::Property(\n+                                ObjectDestructureProperty {\n+                                    name: key.to_string(),\n+                                    value,\n+                                },\n+                            ));\n+                        } else {\n+                            let temporary = env.new_temporary();\n+                            properties.push(ObjectDestructureItem::Property(\n+                                ObjectDestructureProperty {\n+                                    name: key.to_string(),\n+                                    value: IdentifierOperand {\n+                                        identifier: temporary.clone(),\n+                                        effect: None,\n+                                    },\n+                                },\n+                            ));\n+                            followups.push((temporary, &property.value));\n+                        }\n+                    }\n+                }\n+            }\n+\n+            let temporary = builder.push(InstructionValue::Destructure(Destructure {\n+                kind,\n+                pattern: DestructurePattern::Object(properties),\n+                value,\n+            }));\n+            for (temporary, pattern) in followups {\n+                lower_assignment_pattern(\n+                    env,\n+                    builder,\n+                    kind,\n+                    pattern,\n+                    IdentifierOperand {\n+                        identifier: temporary,\n+                        effect: None,\n+                    },\n+                )?;\n+            }\n+            temporary\n+        }\n+        _ => todo!(\"lower assignment pattern for {:#?}\", lvalue),\n+    })\n+}\n+\n+fn lower_identifier_for_assignment(\n+    env: &Environment,\n+    _builder: &mut Builder,\n+    kind: InstructionKind,\n+    node: &react_estree::Identifier,\n+) -> Result<IdentifierOperand, Diagnostic> {\n+    match kind {\n+        InstructionKind::Reassign => {\n+            let identifier = env.resolve_variable_reference(node);\n+            if let Some(identifier) = identifier {\n+                Ok(IdentifierOperand {\n+                    identifier,\n+                    effect: None,\n+                })\n+            } else {\n+                // Reassigning a global\n+                Err(\n+                    Diagnostic::invalid_react(BuildHIRError::ReassignedGlobal, node.range)\n+                        .annotate(format!(\"Cannot reassign `{}`\", &node.name), node.range),\n+                )\n+            }\n+        }\n+        _ => {\n+            // Declaration\n+            let identifier = env.resolve_variable_declaration(node, &node.name).unwrap();\n+            Ok(IdentifierOperand {\n+                identifier,\n+                effect: None,\n+            })\n+        }\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_build_hir/src/builder.rs",
                "git_diff": "@@ -0,0 +1,322 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use std::cell::RefCell;\n+use std::rc::Rc;\n+\n+use react_diagnostics::Diagnostic;\n+use react_hir::{\n+    initialize_hir, BasicBlock, BlockId, BlockKind, Blocks, Environment, GotoKind, IdentifierData,\n+    IdentifierOperand, InstrIx, Instruction, InstructionIdGenerator, InstructionValue, Terminal,\n+    TerminalValue, Type, HIR,\n+};\n+\n+use crate::BuildHIRError;\n+\n+/// Helper struct used when converting from ESTree to HIR. Includes:\n+/// - Variable resolution\n+/// - Label resolution (for labeled statements and break/continue)\n+/// - Access to the environment\n+///\n+/// As well as representing the incomplete form of the HIR. Usage\n+/// generally involves driving calls to enter/exit blocks, resolve\n+/// labels and variables, and then calling `build()` when the HIR\n+/// is complete.\n+pub(crate) struct Builder<'e> {\n+    #[allow(dead_code)]\n+    environment: &'e Environment,\n+\n+    completed: Blocks,\n+\n+    instructions: Vec<Instruction>,\n+\n+    entry: BlockId,\n+\n+    wip: WipBlock,\n+\n+    id_gen: InstructionIdGenerator,\n+\n+    scopes: Vec<ControlFlowScope>,\n+}\n+\n+pub(crate) struct WipBlock {\n+    pub id: BlockId,\n+    pub kind: BlockKind,\n+    pub instructions: Vec<InstrIx>,\n+}\n+\n+#[derive(Clone, PartialEq, Eq, Debug)]\n+enum ControlFlowScope {\n+    Loop(LoopScope),\n+\n+    // Switch(SwitchScope),\n+    #[allow(dead_code)]\n+    Label(LabelScope),\n+}\n+\n+#[derive(Clone, PartialEq, Eq, Debug)]\n+pub(crate) struct LoopScope {\n+    pub label: Option<String>,\n+    pub continue_block: BlockId,\n+    pub break_block: BlockId,\n+}\n+\n+#[derive(Clone, PartialEq, Eq, Debug)]\n+pub(crate) struct LabelScope {\n+    pub label: String,\n+    pub block: BlockId,\n+}\n+\n+impl ControlFlowScope {\n+    fn label(&self) -> Option<&String> {\n+        match self {\n+            Self::Loop(scope) => scope.label.as_ref(),\n+            Self::Label(scope) => Some(&scope.label),\n+        }\n+    }\n+\n+    fn break_block(&self) -> BlockId {\n+        match self {\n+            Self::Loop(scope) => scope.break_block,\n+            Self::Label(scope) => scope.block,\n+        }\n+    }\n+}\n+\n+impl<'e> Builder<'e> {\n+    pub(crate) fn new(environment: &'e Environment) -> Self {\n+        let entry = environment.next_block_id();\n+        let current = WipBlock {\n+            id: entry,\n+            kind: BlockKind::Block,\n+            instructions: Default::default(),\n+        };\n+        Self {\n+            environment,\n+            completed: Default::default(),\n+            instructions: Default::default(),\n+            entry,\n+            wip: current,\n+            id_gen: InstructionIdGenerator::new(),\n+            scopes: Default::default(),\n+        }\n+    }\n+\n+    /// Completes the builder and returns the HIR if it was valid,\n+    /// or a Diagnostic if a validation error occured.\n+    ///\n+    /// TODO: refine the type, only invariants should be possible here,\n+    /// not other types of errors\n+    pub(crate) fn build(self) -> Result<HIR, Diagnostic> {\n+        let mut hir = HIR {\n+            entry: self.entry,\n+            blocks: self.completed,\n+            instructions: self.instructions,\n+        };\n+        // Run all the initialization passes\n+        initialize_hir(&mut hir)?;\n+        Ok(hir)\n+    }\n+\n+    /// Adds a new instruction to the end of the work in progress block\n+    pub(crate) fn push(&mut self, value: InstructionValue) -> IdentifierOperand {\n+        let lvalue = IdentifierOperand {\n+            identifier: self.environment.new_temporary(),\n+            effect: None,\n+        };\n+        let instr = Instruction {\n+            id: self.id_gen.next(),\n+            lvalue: lvalue.clone(),\n+            value,\n+        };\n+        let ix = InstrIx::new(self.instructions.len() as u32);\n+        self.instructions.push(instr);\n+        self.wip.instructions.push(ix);\n+        lvalue\n+    }\n+\n+    /// Terminates the work in progress block with the given terminal, and starts a new\n+    /// work in progress block with the given kind\n+    pub(crate) fn terminate(&mut self, terminal: TerminalValue, next_kind: BlockKind) {\n+        let next_wip = WipBlock {\n+            id: self.environment.next_block_id(),\n+            kind: next_kind,\n+            instructions: Default::default(),\n+        };\n+        self.terminate_with_fallthrough(terminal, next_wip)\n+    }\n+\n+    pub(crate) fn terminate_with_fallthrough(\n+        &mut self,\n+        terminal: TerminalValue,\n+        fallthrough: WipBlock,\n+    ) {\n+        let prev_wip = std::mem::replace(&mut self.wip, fallthrough);\n+        self.completed.insert(Box::new(BasicBlock {\n+            id: prev_wip.id,\n+            kind: prev_wip.kind,\n+            instructions: prev_wip.instructions,\n+            terminal: Terminal {\n+                id: self.id_gen.next(),\n+                value: terminal,\n+            },\n+            predecessors: Default::default(),\n+            phis: Default::default(),\n+        }));\n+    }\n+\n+    pub(crate) fn reserve(&mut self, kind: BlockKind) -> WipBlock {\n+        WipBlock {\n+            id: self.environment.next_block_id(),\n+            kind,\n+            instructions: Default::default(),\n+        }\n+    }\n+\n+    pub(crate) fn enter<F>(&mut self, kind: BlockKind, f: F) -> Result<BlockId, Diagnostic>\n+    where\n+        F: FnOnce(&mut Self) -> Result<TerminalValue, Diagnostic>,\n+    {\n+        let wip = self.reserve(kind);\n+        let id = wip.id;\n+        self.enter_reserved(wip, f)?;\n+        Ok(id)\n+    }\n+\n+    fn enter_reserved<F>(&mut self, wip: WipBlock, f: F) -> Result<(), Diagnostic>\n+    where\n+        F: FnOnce(&mut Self) -> Result<TerminalValue, Diagnostic>,\n+    {\n+        let current = std::mem::replace(&mut self.wip, wip);\n+\n+        let (result, terminal) = match f(self) {\n+            Ok(terminal) => (Ok(()), terminal),\n+            Err(error) => (\n+                Err(error),\n+                // TODO: add a `Terminal::Error` variant\n+                TerminalValue::Goto(react_hir::GotoTerminal {\n+                    block: current.id,\n+                    kind: GotoKind::Break,\n+                }),\n+            ),\n+        };\n+\n+        let completed = std::mem::replace(&mut self.wip, current);\n+        self.completed.insert(Box::new(BasicBlock {\n+            id: completed.id,\n+            kind: completed.kind,\n+            instructions: completed.instructions,\n+            terminal: Terminal {\n+                id: self.id_gen.next(),\n+                value: terminal,\n+            },\n+            predecessors: Default::default(),\n+            phis: Default::default(),\n+        }));\n+        result\n+    }\n+\n+    pub(crate) fn enter_loop<F>(\n+        &mut self,\n+        scope: LoopScope,\n+        f: F,\n+    ) -> Result<TerminalValue, Diagnostic>\n+    where\n+        F: FnOnce(&mut Self) -> Result<TerminalValue, Diagnostic>,\n+    {\n+        self.scopes.push(ControlFlowScope::Loop(scope.clone()));\n+        let terminal = f(self);\n+        let last = self.scopes.pop().unwrap();\n+        assert_eq!(last, ControlFlowScope::Loop(scope));\n+        terminal\n+    }\n+\n+    /// Returns a new temporary identifier\n+    /// This may be necessary for destructuring with default values. there\n+    /// we synthesize a temporary identifier to store the possibly-missing value\n+    /// into, and emit a later StoreLocal for the original identifier\n+    #[allow(dead_code)]\n+    pub(crate) fn make_temporary(&self) -> react_hir::Identifier {\n+        react_hir::Identifier {\n+            id: self.environment.next_identifier_id(),\n+            name: None,\n+            data: Rc::new(RefCell::new(IdentifierData {\n+                mutable_range: Default::default(),\n+                scope: None,\n+                type_: Type::Var(self.environment.next_type_var_id()),\n+            })),\n+        }\n+    }\n+\n+    /// Resolves the target for the given break label (if present), or returns the default\n+    /// break target given the current context. Returns a diagnostic if the label is\n+    /// provided but cannot be resolved.\n+    pub(crate) fn resolve_break(\n+        &self,\n+        label: Option<&react_estree::Identifier>,\n+    ) -> Result<BlockId, Diagnostic> {\n+        for scope in self.scopes.iter().rev() {\n+            match (label, scope.label()) {\n+                // If this is an unlabeled break, return the most recent break target\n+                (None, _) => return Ok(scope.break_block()),\n+                // If the break is labeled and matches the current scope, return its break target\n+                (Some(label), Some(scope_label)) if &label.name == scope_label => {\n+                    return Ok(scope.break_block());\n+                }\n+                // Otherwise keep searching\n+                _ => continue,\n+            }\n+        }\n+        Err(Diagnostic::invalid_syntax(\n+            BuildHIRError::UnresolvedBreakTarget,\n+            None,\n+        ))\n+    }\n+\n+    /// Resolves the target for the given continue label (if present), or returns the default\n+    /// continue target given the current context. Returns a diagnostic if the label is\n+    /// provided but cannot be resolved.\n+    pub(crate) fn resolve_continue(\n+        &self,\n+        label: Option<&react_estree::Identifier>,\n+    ) -> Result<BlockId, Diagnostic> {\n+        for scope in self.scopes.iter().rev() {\n+            match scope {\n+                ControlFlowScope::Loop(scope) => {\n+                    match (label, &scope.label) {\n+                        // If this is an unlabeled continue, return the first matching loop\n+                        (None, _) => return Ok(scope.continue_block),\n+                        // If the continue is labeled and matches the current scope, return its continue target\n+                        (Some(label), Some(scope_label))\n+                            if label.name.as_str() == scope_label.as_str() =>\n+                        {\n+                            return Ok(scope.continue_block);\n+                        }\n+                        // Otherwise keep searching\n+                        _ => continue,\n+                    }\n+                }\n+                _ => {\n+                    match (label, scope.label()) {\n+                        (Some(label), Some(scope_label)) if label.name.as_str() == scope_label => {\n+                            // Error, the continue referred to a label that is not a loop\n+                            return Err(Diagnostic::invalid_syntax(\n+                                BuildHIRError::ContinueTargetIsNotALoop,\n+                                None,\n+                            ));\n+                        }\n+                        _ => continue,\n+                    }\n+                }\n+            }\n+        }\n+        Err(Diagnostic::invalid_syntax(\n+            BuildHIRError::UnresolvedContinueTarget,\n+            None,\n+        ))\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_build_hir/src/context.rs",
                "git_diff": "@@ -0,0 +1,44 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use std::collections::HashSet;\n+\n+use react_estree::IntoFunction;\n+use react_hir::Environment;\n+use react_semantic_analysis::{DeclarationId, ScopeView};\n+\n+pub(crate) fn get_context_identifiers<T: IntoFunction>(\n+    env: &Environment,\n+    node: &T,\n+) -> Vec<DeclarationId> {\n+    let function_scope = env.scope(node.function()).unwrap();\n+    let mut free = FreeVariables::default();\n+    let mut seen = HashSet::new();\n+    populate_free_variable_references(&mut free, &mut seen, function_scope);\n+    free\n+}\n+\n+type FreeVariables = Vec<DeclarationId>;\n+\n+fn populate_free_variable_references(\n+    free: &mut FreeVariables,\n+    seen: &mut HashSet<DeclarationId>,\n+    scope: ScopeView<'_>,\n+) {\n+    for reference in scope.references() {\n+        if !seen.insert(reference.declaration().id()) {\n+            continue;\n+        }\n+        let declaration_scope = reference.declaration().scope();\n+        if !declaration_scope.is_descendant_of(scope) {\n+            free.push(reference.declaration().id())\n+        }\n+    }\n+    for child in scope.children() {\n+        populate_free_variable_references(free, seen, child);\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_build_hir/src/error.rs",
                "git_diff": "@@ -0,0 +1,63 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use thiserror::Error;\n+\n+/// Errors which can occur during HIR construction\n+#[derive(Error, Debug)]\n+pub enum BuildHIRError {\n+    /// ErrorSeverity::Unsupported\n+    #[error(\n+        \"Variable declarations must be `let` or `const`, `var` declarations are not supported\"\n+    )]\n+    VariableDeclarationKindIsVar,\n+\n+    /// ErrorSeverity::Invariant\n+    #[error(\"Invariant: Expected variable declaration to declare a fresh binding\")]\n+    VariableDeclarationBindingIsNonLocal,\n+\n+    /// ErrorSeverity::Todo\n+    #[error(\"`for` statements must have an initializer, eg `for (**let i = 0**; ...)`\")]\n+    ForStatementIsMissingInitializer,\n+\n+    /// ErrorSeverity::Todo\n+    #[error(\n+        \"`for` statements must have a test condition, eg `for (let i = 0; **i < count**; ...)`\"\n+    )]\n+    ForStatementIsMissingTest,\n+\n+    /// ErrorSeverity::Invariant\n+    #[error(\"Invariant: Expected an expression node\")]\n+    NonExpressionInExpressionPosition,\n+\n+    /// ErrorSeverity::InvalidReact\n+    #[error(\"React functions may not reassign variables defined outside of the component or hook\")]\n+    ReassignedGlobal,\n+\n+    /// ErrorSeverity::InvalidSyntax\n+    #[error(\"Could not resolve a target for `break` statement\")]\n+    UnresolvedBreakTarget,\n+\n+    /// ErrorSeverity::InvalidSyntax\n+    #[error(\"Could not resolve a target for `continue` statement\")]\n+    UnresolvedContinueTarget,\n+\n+    /// ErrorSeverity::InvalidSyntax\n+    #[error(\"Labeled `continue` statements must use the label of a loop statement\")]\n+    ContinueTargetIsNotALoop,\n+\n+    /// ErrorSeverity::Invariant\n+    #[error(\"Invariant: Identifier was not resolved (did name resolution run successfully?)\")]\n+    UnknownIdentifier,\n+\n+    /// ErrorSeverity::InvalidSyntax\n+    #[error(\"Expected function to have a body\")]\n+    EmptyFunction,\n+\n+    #[error(\"`super` is not suppported\")]\n+    UnsupportedSuperExpression,\n+}"
            },
            {
                "file": "compiler/crates/react_build_hir/src/lib.rs",
                "git_diff": "@@ -0,0 +1,14 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+mod build;\n+mod builder;\n+mod context;\n+mod error;\n+\n+pub use build::build;\n+pub use error::*;"
            },
            {
                "file": "compiler/crates/react_diagnostics/Cargo.toml",
                "git_diff": "@@ -0,0 +1,23 @@\n+[package]\n+name = \"react_diagnostics\"\n+version = \"0.1.0\"\n+publish               = false\n+authors.workspace     = true\n+description.workspace = true\n+edition.workspace     = true\n+homepage.workspace    = true\n+keywords.workspace    = true\n+license.workspace     = true\n+repository.workspace  = true\n+\n+# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n+\n+[dependencies]\n+# TODO: extract SourceRange into a separate crate so that \n+# we don't depend on full estree here\n+react_estree = { workspace = true }\n+# TODO: consider extracting a separate react_miette crate which does\n+# the translation from react_diagnostics::Diagnostic to miette::Diagnostic\n+miette = { workspace = true }\n+thiserror = { workspace = true }\n+static_assertions = { workspace = true }\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_diagnostics/README.md",
                "git_diff": "@@ -0,0 +1,10 @@\n+# react_diagnostics\n+\n+Types for representing compiler diagnostics. Includes a general-purpose representation\n+of diagnostics with related information which can be converted into `miette::Diagnostic` to exploit miette's pretty printing of errors. \n+\n+Unlike miette, lsp_types, and other diagnostic libraries, the error severities match\n+React Compiler's semantics. The intent is that a given diagnostic may be displayed as\n+an error, warning, or not displayed at all depending on the context in which the \n+compiler is being used. For example, an ESLint plugin powered by React Compiler may ignore\n+InvalidSyntax diagnostics, whereas the regular compiler may report them as errors."
            },
            {
                "file": "compiler/crates/react_diagnostics/src/diagnostic.rs",
                "git_diff": "@@ -0,0 +1,285 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use std::error::Error;\n+use std::fmt::{Debug, Display, Write};\n+\n+use miette::SourceSpan;\n+use react_estree::SourceRange;\n+use static_assertions::assert_impl_all;\n+use thiserror::Error;\n+\n+pub type Diagnostics = Vec<Diagnostic>;\n+pub type DiagnosticsResult<T> = Result<T, Diagnostics>;\n+\n+#[derive(Debug)]\n+pub struct WithDiagnostics<T> {\n+    pub item: T,\n+    pub diagnostics: Vec<Diagnostic>,\n+}\n+\n+impl<T> From<WithDiagnostics<T>> for Result<T, Diagnostics> {\n+    fn from(s: WithDiagnostics<T>) -> Result<T, Diagnostics> {\n+        if s.diagnostics.is_empty() {\n+            Ok(s.item)\n+        } else {\n+            Err(s.diagnostics)\n+        }\n+    }\n+}\n+\n+pub fn diagnostics_result<T>(result: T, diagnostics: Diagnostics) -> DiagnosticsResult<T> {\n+    if diagnostics.is_empty() {\n+        Ok(result)\n+    } else {\n+        Err(diagnostics)\n+    }\n+}\n+\n+#[derive(Clone, Copy, PartialEq, Eq, PartialOrd, Ord, Hash, Debug, Error)]\n+pub enum DiagnosticSeverity {\n+    /// A feature that is intended to work but not yet implemented\n+    #[error(\"Not implemented\")]\n+    Todo,\n+\n+    /// Syntax that is valid but intentionally not supported\n+    #[error(\"Unsupported\")]\n+    Unsupported,\n+\n+    /// Invalid syntax\n+    #[error(\"Invalid JavaScript\")]\n+    InvalidSyntax,\n+\n+    /// Valid syntax, but invalid React\n+    #[error(\"Invalid React\")]\n+    InvalidReact,\n+\n+    /// Internal compiler error (ICE)\n+    #[error(\"Internal error\")]\n+    Invariant,\n+}\n+\n+/// A diagnostic message as a result of validating some code. This struct is\n+/// modeled after the LSP Diagnostic type:\n+/// https://microsoft.github.io/language-server-protocol/specification#diagnostic\n+///\n+/// Changes from LSP:\n+/// - `location` is different from LSP in that it's a file + span instead of\n+///   just a span.\n+/// - Unused fields are omitted.\n+/// - Severity is a custom enum that represents React-specific categories of error.\n+///   The translation to an LSP error/warning/etc depends on compiler settings and\n+///   invocation context.\n+#[derive(Debug)]\n+pub struct Diagnostic(Box<DiagnosticData>);\n+\n+impl Diagnostic {\n+    fn with_severity<T: 'static + DiagnosticDisplay>(\n+        severity: DiagnosticSeverity,\n+        message: T,\n+        range: Option<SourceRange>,\n+    ) -> Self {\n+        Self(Box::new(DiagnosticData {\n+            message: Box::new(message),\n+            span: range.map(source_span_from_range),\n+            related_information: Vec::new(),\n+            severity,\n+            data: Vec::new(),\n+        }))\n+    }\n+\n+    /// Creates a new Todo Diagnostic.\n+    /// Additional locations can be added with the `.annotate()` function.\n+    pub fn todo<T: 'static + DiagnosticDisplay>(message: T, range: Option<SourceRange>) -> Self {\n+        Diagnostic::with_severity(DiagnosticSeverity::Todo, message, range)\n+    }\n+\n+    /// Creates a new Unsupported Diagnostic.\n+    /// Additional locations can be added with the `.annotate()` function.\n+    pub fn unsupported<T: 'static + DiagnosticDisplay>(\n+        message: T,\n+        range: Option<SourceRange>,\n+    ) -> Self {\n+        Diagnostic::with_severity(DiagnosticSeverity::Unsupported, message, range)\n+    }\n+\n+    /// Creates a new InvalidSyntax Diagnostic.\n+    /// Additional locations can be added with the `.annotate()` function.\n+    pub fn invalid_syntax<T: 'static + DiagnosticDisplay>(\n+        message: T,\n+        range: Option<SourceRange>,\n+    ) -> Self {\n+        Diagnostic::with_severity(DiagnosticSeverity::InvalidSyntax, message, range)\n+    }\n+\n+    /// Creates a new InvalidReact Diagnostic.\n+    /// Additional locations can be added with the `.annotate()` function.\n+    pub fn invalid_react<T: 'static + DiagnosticDisplay>(\n+        message: T,\n+        range: Option<SourceRange>,\n+    ) -> Self {\n+        Diagnostic::with_severity(DiagnosticSeverity::InvalidReact, message, range)\n+    }\n+\n+    /// Creates a new InvalidReact Diagnostic.\n+    /// Additional locations can be added with the `.annotate()` function.\n+    pub fn invariant<T: 'static + DiagnosticDisplay>(\n+        message: T,\n+        range: Option<SourceRange>,\n+    ) -> Self {\n+        Diagnostic::with_severity(DiagnosticSeverity::Invariant, message, range)\n+    }\n+\n+    /// Annotates this error with an additional location and associated message.\n+    pub fn annotate<T: 'static + DiagnosticDisplay>(\n+        mut self,\n+        message: T,\n+        range: Option<SourceRange>,\n+    ) -> Self {\n+        self.0\n+            .related_information\n+            .push(DiagnosticRelatedInformation {\n+                message: Box::new(message),\n+                span: range.map(source_span_from_range),\n+            });\n+        self\n+    }\n+\n+    pub fn message(&self) -> &impl DiagnosticDisplay {\n+        &self.0.message\n+    }\n+\n+    pub fn span(&self) -> Option<SourceSpan> {\n+        self.0.span\n+    }\n+\n+    pub fn get_data(&self) -> &[impl DiagnosticDisplay] {\n+        &self.0.data\n+    }\n+\n+    pub fn severity(&self) -> DiagnosticSeverity {\n+        self.0.severity\n+    }\n+\n+    pub fn related_information(&self) -> &[DiagnosticRelatedInformation] {\n+        &self.0.related_information\n+    }\n+\n+    pub fn print_without_source(&self) -> String {\n+        let mut result = String::new();\n+        writeln!(\n+            result,\n+            \"{message}:{span:?}\",\n+            message = &self.0.message,\n+            span = self.0.span\n+        )\n+        .unwrap();\n+        if !self.0.related_information.is_empty() {\n+            for (ix, related) in self.0.related_information.iter().enumerate() {\n+                writeln!(\n+                    result,\n+                    \"[related {ix}] {message}:{span:?}\",\n+                    ix = ix + 1,\n+                    message = related.message,\n+                    span = related.span\n+                )\n+                .unwrap();\n+            }\n+        };\n+        result\n+    }\n+}\n+\n+impl Display for Diagnostic {\n+    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {\n+        write!(f, \"{}\", self.0.message)\n+    }\n+}\n+\n+impl Error for Diagnostic {}\n+\n+impl miette::Diagnostic for Diagnostic {\n+    fn help<'a>(&'a self) -> Option<Box<dyn Display + 'a>> {\n+        Some(Box::new(self.0.message.to_string()))\n+    }\n+\n+    fn labels(&self) -> Option<Box<dyn Iterator<Item = miette::LabeledSpan> + '_>> {\n+        let related_items = &self.0.related_information;\n+        let mut spans: Vec<miette::LabeledSpan> = Vec::new();\n+        for related in related_items {\n+            if let Some(span) = related.span {\n+                spans.push(miette::LabeledSpan::new_with_span(\n+                    Some(related.message.to_string()),\n+                    span,\n+                ))\n+            }\n+        }\n+        if spans.is_empty() {\n+            if let Some(span) = self.0.span {\n+                spans.push(miette::LabeledSpan::new_with_span(\n+                    Some(self.0.message.to_string()),\n+                    span,\n+                ))\n+            }\n+        }\n+        Some(Box::new(spans.into_iter()))\n+    }\n+}\n+\n+// Ensure Diagnostic is thread-safe\n+assert_impl_all!(Diagnostic: Send, Sync);\n+\n+#[derive(Debug)]\n+struct DiagnosticData {\n+    /// Human readable error message.\n+    message: Box<dyn DiagnosticDisplay>,\n+\n+    /// The primary location of this diagnostic.\n+    span: Option<SourceSpan>,\n+\n+    /// Related diagnostic information, such as other definitions in the case of\n+    /// a duplicate definition error.\n+    related_information: Vec<DiagnosticRelatedInformation>,\n+\n+    severity: DiagnosticSeverity,\n+\n+    /// A list with data that can be passed to the code actions\n+    /// `data` is used in the LSP protocol:\n+    /// @see https://microsoft.github.io/language-server-protocol/specifications/specification-current/#diagnostic\n+    data: Vec<Box<dyn DiagnosticDisplay>>,\n+}\n+\n+/// Secondary locations attached to a diagnostic.\n+#[derive(Debug)]\n+pub struct DiagnosticRelatedInformation {\n+    /// The message of this related diagnostic information.\n+    pub message: Box<dyn DiagnosticDisplay>,\n+\n+    /// The location of this related diagnostic information.\n+    pub span: Option<SourceSpan>,\n+}\n+\n+/// Trait for diagnostic messages to allow structs that capture\n+/// some data and can lazily convert it to a message.\n+pub trait DiagnosticDisplay: Debug + Display + Send + Sync {}\n+\n+/// Automatically implement the trait if constraints are met, so that\n+/// implementors don't need to.\n+impl<T> DiagnosticDisplay for T where T: Debug + Display + Send + Sync {}\n+\n+impl From<Diagnostic> for Diagnostics {\n+    fn from(diagnostic: Diagnostic) -> Self {\n+        vec![diagnostic]\n+    }\n+}\n+\n+fn source_span_from_range(range: SourceRange) -> SourceSpan {\n+    SourceSpan::new(\n+        (range.start as usize).into(),\n+        ((u32::from(range.end) - range.start) as usize).into(),\n+    )\n+}"
            },
            {
                "file": "compiler/crates/react_diagnostics/src/lib.rs",
                "git_diff": "@@ -0,0 +1,19 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+mod diagnostic;\n+\n+pub use diagnostic::*;\n+\n+/// Returns Ok(()) if the condition is true, otherwise returns Err()\n+/// with the diagnostic produced by the provided callback\n+pub fn invariant<F>(cond: bool, f: F) -> Result<(), Diagnostic>\n+where\n+    F: Fn() -> Diagnostic,\n+{\n+    if cond { Ok(()) } else { Err(f()) }\n+}"
            },
            {
                "file": "compiler/crates/react_estree/Cargo.toml",
                "git_diff": "@@ -0,0 +1,22 @@\n+[package]\n+name = \"react_estree\"\n+version = \"0.1.0\"\n+publish               = false\n+authors.workspace     = true\n+description.workspace = true\n+edition.workspace     = true\n+homepage.workspace    = true\n+keywords.workspace    = true\n+license.workspace     = true\n+repository.workspace  = true\n+\n+# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n+\n+[dependencies]\n+insta = { workspace = true }\n+serde = { workspace = true }\n+serde_json = { workspace = true }\n+static_assertions = { workspace = true }\n+\n+[build-dependencies]\n+react_estree_codegen = { workspace = true }\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_estree/README.md",
                "git_diff": "@@ -0,0 +1,17 @@\n+# react_estree\n+\n+This crate is a Rust representation of the [ESTree format](https://github.com/estree/estree/tree/master) and\n+popular extenions including JSX and (eventually) Flow and TypeScript.\n+\n+This crate is intended as the main interchange format with outside code. A typical integration with React Compiler\n+will look as follows:\n+\n+1. Host Compiler parses into the host AST format.\n+2. Host Compiler converts into `react_estree`.\n+3. Host Compiler invokes React Compiler to compile the input, which (conceptually) \n+   returns the resulting code in `react_estree` format.\n+4. Host Compiler convert back from `react_estree` to its host AST format.\n+\n+Because React Compiler is intended to support JavaScript-based toolchains, `react_estree` is designed to support\n+accurate serialization to/from estree-compatible JSON. We may also support the Babel AST format \n+(a variant of ESTree) as well, depending on demand.\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_estree/build.rs",
                "git_diff": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use react_estree_codegen::estree;\n+\n+// Example custom build script.\n+fn main() {\n+    // Re-run if the codegen files change\n+    println!(\"cargo:rerun-if-changed=../react_estree_codegen/src/codegen.rs\");\n+    println!(\"cargo:rerun-if-changed=../react_estree_codegen/src/lib.rs\");\n+    println!(\"cargo:rerun-if-changed=../react_estree_codegen/src/ecmascript.json\");\n+    println!(\"cargo:rerun-if-changed=../react_estree_codegen\");\n+\n+    let src = estree();\n+    let copyright = \"\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+    \"\n+    .to_string();\n+    let trimmed_copyright = copyright.trim();\n+    let contents = format!(\"{trimmed_copyright}\\n{src}\");\n+    std::fs::write(\"src/generated.rs\", contents).unwrap();\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/binding.rs",
                "git_diff": "@@ -0,0 +1,30 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use serde::{Deserialize, Serialize};\n+\n+#[derive(Serialize, Deserialize, Copy, Clone, Debug, PartialEq, Eq, Hash)]\n+pub enum Binding {\n+    Global,\n+    Module(BindingId),\n+    Local(BindingId),\n+}\n+\n+#[derive(Serialize, Deserialize, Copy, Clone, Debug, PartialEq, Eq, Hash)]\n+pub struct BindingId(u32);\n+\n+impl BindingId {\n+    pub fn new(value: u32) -> Self {\n+        Self(value)\n+    }\n+}\n+\n+impl From<BindingId> for u32 {\n+    fn from(value: BindingId) -> Self {\n+        value.0\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/fixtures/for-statement.json",
                "git_diff": "@@ -0,0 +1,528 @@\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 7,\n+        \"column\": 1\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 7,\n+            \"column\": 1\n+          }\n+        },\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            }\n+          },\n+          \"name\": \"Component\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false,\n+          \"range\": [\n+            9,\n+            18\n+          ]\n+        },\n+        \"params\": [\n+          {\n+            \"type\": \"Identifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 19\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 24\n+              }\n+            },\n+            \"name\": \"props\",\n+            \"typeAnnotation\": null,\n+            \"optional\": false,\n+            \"range\": [\n+              19,\n+              24\n+            ]\n+          }\n+        ],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 26\n+            },\n+            \"end\": {\n+              \"line\": 7,\n+              \"column\": 1\n+            }\n+          },\n+          \"body\": [\n+            {\n+              \"type\": \"VariableDeclaration\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 2,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 2,\n+                  \"column\": 12\n+                }\n+              },\n+              \"kind\": \"let\",\n+              \"declarations\": [\n+                {\n+                  \"type\": \"VariableDeclarator\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 6\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 11\n+                    }\n+                  },\n+                  \"init\": {\n+                    \"type\": \"Literal\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 2,\n+                        \"column\": 10\n+                      },\n+                      \"end\": {\n+                        \"line\": 2,\n+                        \"column\": 11\n+                      }\n+                    },\n+                    \"value\": 0,\n+                    \"range\": [\n+                      38,\n+                      39\n+                    ],\n+                    \"raw\": \"0\"\n+                  },\n+                  \"id\": {\n+                    \"type\": \"Identifier\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 2,\n+                        \"column\": 6\n+                      },\n+                      \"end\": {\n+                        \"line\": 2,\n+                        \"column\": 7\n+                      }\n+                    },\n+                    \"name\": \"x\",\n+                    \"typeAnnotation\": null,\n+                    \"optional\": false,\n+                    \"range\": [\n+                      34,\n+                      35\n+                    ]\n+                  },\n+                  \"range\": [\n+                    34,\n+                    39\n+                  ]\n+                }\n+              ],\n+              \"range\": [\n+                30,\n+                40\n+              ]\n+            },\n+            {\n+              \"type\": \"ForStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 5,\n+                  \"column\": 3\n+                }\n+              },\n+              \"init\": {\n+                \"type\": \"VariableDeclaration\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 7\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 16\n+                  }\n+                },\n+                \"kind\": \"let\",\n+                \"declarations\": [\n+                  {\n+                    \"type\": \"VariableDeclarator\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 11\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 16\n+                      }\n+                    },\n+                    \"init\": {\n+                      \"type\": \"Literal\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 15\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 16\n+                        }\n+                      },\n+                      \"value\": 0,\n+                      \"range\": [\n+                        56,\n+                        57\n+                      ],\n+                      \"raw\": \"0\"\n+                    },\n+                    \"id\": {\n+                      \"type\": \"Identifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 11\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 12\n+                        }\n+                      },\n+                      \"name\": \"i\",\n+                      \"typeAnnotation\": null,\n+                      \"optional\": false,\n+                      \"range\": [\n+                        52,\n+                        53\n+                      ]\n+                    },\n+                    \"range\": [\n+                      52,\n+                      57\n+                    ]\n+                  }\n+                ],\n+                \"range\": [\n+                  48,\n+                  57\n+                ]\n+              },\n+              \"test\": {\n+                \"type\": \"BinaryExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 18\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 24\n+                  }\n+                },\n+                \"left\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 18\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 19\n+                    }\n+                  },\n+                  \"name\": \"i\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false,\n+                  \"range\": [\n+                    59,\n+                    60\n+                  ]\n+                },\n+                \"right\": {\n+                  \"type\": \"Literal\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 22\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 24\n+                    }\n+                  },\n+                  \"value\": 10,\n+                  \"range\": [\n+                    63,\n+                    65\n+                  ],\n+                  \"raw\": \"10\"\n+                },\n+                \"operator\": \"<\",\n+                \"range\": [\n+                  59,\n+                  65\n+                ]\n+              },\n+              \"update\": {\n+                \"type\": \"UpdateExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 29\n+                  }\n+                },\n+                \"operator\": \"++\",\n+                \"argument\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 27\n+                    }\n+                  },\n+                  \"name\": \"i\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false,\n+                  \"range\": [\n+                    67,\n+                    68\n+                  ]\n+                },\n+                \"prefix\": false,\n+                \"range\": [\n+                  67,\n+                  70\n+                ]\n+              },\n+              \"body\": {\n+                \"type\": \"BlockStatement\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 31\n+                  },\n+                  \"end\": {\n+                    \"line\": 5,\n+                    \"column\": 3\n+                  }\n+                },\n+                \"body\": [\n+                  {\n+                    \"type\": \"ExpressionStatement\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 4,\n+                        \"column\": 4\n+                      },\n+                      \"end\": {\n+                        \"line\": 4,\n+                        \"column\": 11\n+                      }\n+                    },\n+                    \"expression\": {\n+                      \"type\": \"AssignmentExpression\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 4,\n+                          \"column\": 4\n+                        },\n+                        \"end\": {\n+                          \"line\": 4,\n+                          \"column\": 10\n+                        }\n+                      },\n+                      \"operator\": \"+=\",\n+                      \"left\": {\n+                        \"type\": \"Identifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 4,\n+                            \"column\": 4\n+                          },\n+                          \"end\": {\n+                            \"line\": 4,\n+                            \"column\": 5\n+                          }\n+                        },\n+                        \"name\": \"x\",\n+                        \"typeAnnotation\": null,\n+                        \"optional\": false,\n+                        \"range\": [\n+                          78,\n+                          79\n+                        ]\n+                      },\n+                      \"right\": {\n+                        \"type\": \"Identifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 4,\n+                            \"column\": 9\n+                          },\n+                          \"end\": {\n+                            \"line\": 4,\n+                            \"column\": 10\n+                          }\n+                        },\n+                        \"name\": \"i\",\n+                        \"typeAnnotation\": null,\n+                        \"optional\": false,\n+                        \"range\": [\n+                          83,\n+                          84\n+                        ]\n+                      },\n+                      \"range\": [\n+                        78,\n+                        84\n+                      ]\n+                    },\n+                    \"directive\": null,\n+                    \"range\": [\n+                      78,\n+                      85\n+                    ]\n+                  }\n+                ],\n+                \"range\": [\n+                  72,\n+                  89\n+                ]\n+              },\n+              \"range\": [\n+                43,\n+                89\n+              ]\n+            },\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 6,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 6,\n+                  \"column\": 11\n+                }\n+              },\n+              \"argument\": {\n+                \"type\": \"Identifier\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 6,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 6,\n+                    \"column\": 10\n+                  }\n+                },\n+                \"name\": \"x\",\n+                \"typeAnnotation\": null,\n+                \"optional\": false,\n+                \"range\": [\n+                  99,\n+                  100\n+                ]\n+              },\n+              \"range\": [\n+                92,\n+                101\n+              ]\n+            }\n+          ],\n+          \"range\": [\n+            26,\n+            103\n+          ]\n+        },\n+        \"typeParameters\": null,\n+        \"returnType\": null,\n+        \"predicate\": null,\n+        \"generator\": false,\n+        \"async\": false,\n+        \"range\": [\n+          0,\n+          103\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      0,\n+      103\n+    ],\n+    \"sourceType\": \"script\"\n+  }\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_estree/src/fixtures/import.json",
                "git_diff": "@@ -0,0 +1,104 @@\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 1,\n+        \"column\": 26\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"ImportDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 26\n+          }\n+        },\n+        \"specifiers\": [\n+          {\n+            \"type\": \"ImportDefaultSpecifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 7\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 12\n+              }\n+            },\n+            \"local\": {\n+              \"type\": \"Identifier\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 1,\n+                  \"column\": 7\n+                },\n+                \"end\": {\n+                  \"line\": 1,\n+                  \"column\": 12\n+                }\n+              },\n+              \"name\": \"React\",\n+              \"typeAnnotation\": null,\n+              \"optional\": false,\n+              \"range\": [\n+                7,\n+                12\n+              ]\n+            },\n+            \"range\": [\n+              7,\n+              12\n+            ]\n+          }\n+        ],\n+        \"source\": {\n+          \"type\": \"Literal\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 25\n+            }\n+          },\n+          \"value\": \"react\",\n+          \"range\": [\n+            18,\n+            25\n+          ],\n+          \"raw\": \"'react'\"\n+        },\n+        \"attributes\": [],\n+        \"importKind\": \"value\",\n+        \"range\": [\n+          0,\n+          26\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      0,\n+      26\n+    ],\n+    \"sourceType\": \"module\"\n+  }\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_estree/src/fixtures/simple.json",
                "git_diff": "@@ -0,0 +1,189 @@\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 3,\n+        \"column\": 1\n+      }\n+    },\n+    \"range\": [\n+      0,\n+      51\n+    ],\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 3,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          0,\n+          51\n+        ],\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            }\n+          },\n+          \"range\": [\n+            9,\n+            18\n+          ],\n+          \"name\": \"Component\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false\n+        },\n+        \"params\": [\n+          {\n+            \"type\": \"Identifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 19\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 24\n+              }\n+            },\n+            \"range\": [\n+              19,\n+              24\n+            ],\n+            \"name\": \"props\",\n+            \"typeAnnotation\": null,\n+            \"optional\": false\n+          }\n+        ],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 26\n+            },\n+            \"end\": {\n+              \"line\": 3,\n+              \"column\": 1\n+            }\n+          },\n+          \"range\": [\n+            26,\n+            51\n+          ],\n+          \"body\": [\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 2,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 2,\n+                  \"column\": 21\n+                }\n+              },\n+              \"range\": [\n+                30,\n+                49\n+              ],\n+              \"argument\": {\n+                \"type\": \"MemberExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 20\n+                  }\n+                },\n+                \"range\": [\n+                  37,\n+                  48\n+                ],\n+                \"object\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 9\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 14\n+                    }\n+                  },\n+                  \"range\": [\n+                    37,\n+                    42\n+                  ],\n+                  \"name\": \"props\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false\n+                },\n+                \"property\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 15\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 20\n+                    }\n+                  },\n+                  \"range\": [\n+                    43,\n+                    48\n+                  ],\n+                  \"name\": \"value\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false\n+                },\n+                \"computed\": false\n+              }\n+            }\n+          ]\n+        },\n+        \"async\": false,\n+        \"generator\": false,\n+        \"predicate\": null,\n+        \"expression\": false,\n+        \"returnType\": null,\n+        \"typeParameters\": null\n+      }\n+    ],\n+    \"comments\": [],\n+    \"errors\": []\n+  }\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_estree/src/fixtures/test.json",
                "git_diff": "@@ -0,0 +1,351 @@\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 2,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 4,\n+        \"column\": 1\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 2,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 4,\n+            \"column\": 1\n+          }\n+        },\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 2,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 2,\n+              \"column\": 12\n+            }\n+          },\n+          \"name\": \"foo\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false,\n+          \"range\": [\n+            10,\n+            13\n+          ]\n+        },\n+        \"params\": [],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 2,\n+              \"column\": 15\n+            },\n+            \"end\": {\n+              \"line\": 4,\n+              \"column\": 1\n+            }\n+          },\n+          \"body\": [\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 36\n+                }\n+              },\n+              \"argument\": {\n+                \"type\": \"JSXElement\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 36\n+                  }\n+                },\n+                \"openingElement\": {\n+                  \"type\": \"JSXOpeningElement\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 9\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    }\n+                  },\n+                  \"name\": {\n+                    \"type\": \"JSXMemberExpression\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 10\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 17\n+                      }\n+                    },\n+                    \"object\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 10\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 13\n+                        }\n+                      },\n+                      \"name\": \"Foo\",\n+                      \"range\": [\n+                        28,\n+                        31\n+                      ]\n+                    },\n+                    \"property\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 14\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 17\n+                        }\n+                      },\n+                      \"name\": \"Bar\",\n+                      \"range\": [\n+                        32,\n+                        35\n+                      ]\n+                    },\n+                    \"range\": [\n+                      28,\n+                      35\n+                    ]\n+                  },\n+                  \"attributes\": [\n+                    {\n+                      \"type\": \"JSXAttribute\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 18\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 24\n+                        }\n+                      },\n+                      \"name\": {\n+                        \"type\": \"JSXIdentifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 3,\n+                            \"column\": 18\n+                          },\n+                          \"end\": {\n+                            \"line\": 3,\n+                            \"column\": 19\n+                          }\n+                        },\n+                        \"name\": \"a\",\n+                        \"range\": [\n+                          36,\n+                          37\n+                        ]\n+                      },\n+                      \"value\": {\n+                        \"type\": \"JSXExpressionContainer\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 3,\n+                            \"column\": 20\n+                          },\n+                          \"end\": {\n+                            \"line\": 3,\n+                            \"column\": 24\n+                          }\n+                        },\n+                        \"expression\": {\n+                          \"type\": \"Literal\",\n+                          \"loc\": {\n+                            \"source\": null,\n+                            \"start\": {\n+                              \"line\": 3,\n+                              \"column\": 21\n+                            },\n+                            \"end\": {\n+                              \"line\": 3,\n+                              \"column\": 23\n+                            }\n+                          },\n+                          \"value\": 10,\n+                          \"range\": [\n+                            39,\n+                            41\n+                          ],\n+                          \"raw\": \"10\"\n+                        },\n+                        \"range\": [\n+                          38,\n+                          42\n+                        ]\n+                      },\n+                      \"range\": [\n+                        36,\n+                        42\n+                      ]\n+                    }\n+                  ],\n+                  \"selfClosing\": false,\n+                  \"range\": [\n+                    27,\n+                    44\n+                  ]\n+                },\n+                \"children\": [],\n+                \"closingElement\": {\n+                  \"type\": \"JSXClosingElement\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 36\n+                    }\n+                  },\n+                  \"name\": {\n+                    \"type\": \"JSXMemberExpression\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 28\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 35\n+                      }\n+                    },\n+                    \"object\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 28\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 31\n+                        }\n+                      },\n+                      \"name\": \"Foo\",\n+                      \"range\": [\n+                        46,\n+                        49\n+                      ]\n+                    },\n+                    \"property\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 32\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 35\n+                        }\n+                      },\n+                      \"name\": \"Bar\",\n+                      \"range\": [\n+                        50,\n+                        53\n+                      ]\n+                    },\n+                    \"range\": [\n+                      46,\n+                      53\n+                    ]\n+                  },\n+                  \"range\": [\n+                    44,\n+                    54\n+                  ]\n+                },\n+                \"range\": [\n+                  27,\n+                  54\n+                ]\n+              },\n+              \"range\": [\n+                20,\n+                54\n+              ]\n+            }\n+          ],\n+          \"range\": [\n+            16,\n+            56\n+          ]\n+        },\n+        \"typeParameters\": null,\n+        \"returnType\": null,\n+        \"predicate\": null,\n+        \"generator\": false,\n+        \"async\": false,\n+        \"range\": [\n+          1,\n+          56\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      1,\n+      56\n+    ],\n+    \"sourceType\": \"script\"\n+  }\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_estree/src/generated.rs",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_estree/src/generated_extensions.rs",
                "git_diff": "@@ -0,0 +1,149 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+// Manual extensions to generated types\n+use crate::{\n+    ArrowFunctionExpression, Class, ClassDeclaration, ClassExpression, Function,\n+    FunctionDeclaration, FunctionExpression, ImportDeclarationSpecifier, JSXElementName,\n+    JSXMemberExpression, JSXMemberExpressionOrIdentifier, Pattern, SourceRange, SourceType,\n+};\n+\n+/// Sentinel trait to distinguish AST *node* types\n+pub trait ESTreeNode {}\n+\n+impl Default for SourceType {\n+    fn default() -> Self {\n+        Self::Module\n+    }\n+}\n+\n+impl Pattern {\n+    pub fn range(&self) -> Option<SourceRange> {\n+        match self {\n+            Self::ArrayPattern(pattern) => pattern.range,\n+            Self::AssignmentPattern(pattern) => pattern.range,\n+            Self::Identifier(pattern) => pattern.range,\n+            Self::ObjectPattern(pattern) => pattern.range,\n+            Self::RestElement(pattern) => pattern.range,\n+        }\n+    }\n+}\n+\n+impl ImportDeclarationSpecifier {\n+    pub fn range(&self) -> Option<SourceRange> {\n+        match self {\n+            Self::ImportDefaultSpecifier(specifier) => specifier.range,\n+            Self::ImportNamespaceSpecifier(specifier) => specifier.range,\n+            Self::ImportSpecifier(specifier) => specifier.range,\n+        }\n+    }\n+}\n+\n+impl JSXElementName {\n+    pub fn root_name(&self) -> &str {\n+        match self {\n+            Self::JSXIdentifier(name) => &name.name,\n+            Self::JSXMemberExpression(name) => name.root_name(),\n+            Self::JSXNamespacedName(name) => &name.namespace.name,\n+        }\n+    }\n+}\n+\n+impl JSXMemberExpression {\n+    pub fn root_name(&self) -> &str {\n+        match &self.object {\n+            JSXMemberExpressionOrIdentifier::JSXMemberExpression(object) => object.root_name(),\n+            JSXMemberExpressionOrIdentifier::JSXIdentifier(object) => &object.name,\n+        }\n+    }\n+}\n+\n+pub trait IntoFunction: ESTreeNode {\n+    fn function(&self) -> &Function;\n+\n+    fn into_function(self) -> Function;\n+}\n+\n+impl IntoFunction for FunctionDeclaration {\n+    fn function(&self) -> &Function {\n+        &self.function\n+    }\n+\n+    fn into_function(self) -> Function {\n+        self.function\n+    }\n+}\n+\n+impl IntoFunction for FunctionExpression {\n+    fn function(&self) -> &Function {\n+        &self.function\n+    }\n+\n+    fn into_function(self) -> Function {\n+        self.function\n+    }\n+}\n+\n+impl IntoFunction for ArrowFunctionExpression {\n+    fn function(&self) -> &Function {\n+        &self.function\n+    }\n+\n+    fn into_function(self) -> Function {\n+        self.function\n+    }\n+}\n+\n+impl ESTreeNode for Function {}\n+\n+impl IntoFunction for Function {\n+    fn function(&self) -> &Function {\n+        self\n+    }\n+\n+    fn into_function(self) -> Function {\n+        self\n+    }\n+}\n+\n+pub trait IntoClass: ESTreeNode {\n+    fn class(&self) -> &Class;\n+\n+    fn into_class(self) -> Class;\n+}\n+\n+impl IntoClass for ClassDeclaration {\n+    fn class(&self) -> &Class {\n+        &self.class\n+    }\n+\n+    fn into_class(self) -> Class {\n+        self.class\n+    }\n+}\n+\n+impl IntoClass for ClassExpression {\n+    fn class(&self) -> &Class {\n+        &self.class\n+    }\n+\n+    fn into_class(self) -> Class {\n+        self.class\n+    }\n+}\n+\n+impl ESTreeNode for Class {}\n+\n+impl IntoClass for Class {\n+    fn class(&self) -> &Class {\n+        self\n+    }\n+\n+    fn into_class(self) -> Class {\n+        self\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/js_value.rs",
                "git_diff": "@@ -0,0 +1,295 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use serde::de::Visitor;\n+use serde::{Deserialize, Serialize};\n+\n+#[derive(Debug, Clone, PartialEq, Eq)]\n+pub enum JsValue {\n+    Boolean(bool),\n+    Null,\n+    Number(Number),\n+    String(String),\n+    Undefined,\n+}\n+\n+impl JsValue {\n+    pub fn is_truthy(&self) -> bool {\n+        match &self {\n+            JsValue::Boolean(value) => *value,\n+            JsValue::Number(value) => value.is_truthy(),\n+            JsValue::String(value) => !value.is_empty(),\n+            JsValue::Null => false,\n+            JsValue::Undefined => false,\n+        }\n+    }\n+\n+    // Partial implementation of loose equality for javascript, returns Some for supported\n+    // cases w the equality result, and None for unsupported cases\n+    pub fn loosely_equals(&self, other: &Self) -> Option<bool> {\n+        // https://tc39.es/ecma262/multipage/abstract-operations.html#sec-islooselyequal\n+        match (&self, &other) {\n+            // 1. If Type(x) is Type(y), then\n+            //    a. Return IsStrictlyEqual(x, y).\n+            (JsValue::Number(left), JsValue::Number(right)) => Some(left.equals(*right)),\n+            (JsValue::Null, JsValue::Null) => Some(true),\n+            (JsValue::Undefined, JsValue::Undefined) => Some(true),\n+            (JsValue::Boolean(left), JsValue::Boolean(right)) => Some(left == right),\n+            (JsValue::String(left), JsValue::String(right)) => Some(left == right),\n+\n+            // 2. If x is null and y is undefined, return true.\n+            (JsValue::Null, JsValue::Undefined) => Some(true),\n+\n+            // 3. If x is undefined and y is null, return true.\n+            (JsValue::Undefined, JsValue::Null) => Some(true),\n+            _ => None,\n+        }\n+    }\n+\n+    pub fn not_loosely_equals(&self, other: &Self) -> Option<bool> {\n+        self.loosely_equals(other).map(|value| !value)\n+    }\n+\n+    // Complete implementation of strict equality for javascript\n+    pub fn strictly_equals(&self, other: &Self) -> bool {\n+        // https://tc39.es/ecma262/multipage/abstract-operations.html#sec-isstrictlyequal\n+        match (&self, &other) {\n+            (JsValue::Number(left), JsValue::Number(right)) => left.equals(*right),\n+            (JsValue::Null, JsValue::Null) => true,\n+            (JsValue::Undefined, JsValue::Undefined) => true,\n+            (JsValue::Boolean(left), JsValue::Boolean(right)) => left == right,\n+            (JsValue::String(left), JsValue::String(right)) => left == right,\n+            _ => false,\n+        }\n+    }\n+\n+    pub fn not_strictly_equals(&self, other: &Self) -> bool {\n+        !self.strictly_equals(other)\n+    }\n+}\n+\n+impl Serialize for JsValue {\n+    fn serialize<S>(&self, serializer: S) -> Result<S::Ok, S::Error>\n+    where\n+        S: serde::Serializer,\n+    {\n+        match self {\n+            Self::Boolean(b) => serializer.serialize_bool(*b),\n+            Self::Null => serializer.serialize_none(),\n+            Self::Number(n) => serializer.serialize_f64(n.into()),\n+            Self::String(s) => serializer.serialize_str(s),\n+            Self::Undefined => serializer.serialize_unit(),\n+        }\n+    }\n+}\n+\n+impl<'de> Deserialize<'de> for JsValue {\n+    #[inline]\n+    fn deserialize<D>(deserializer: D) -> Result<JsValue, D::Error>\n+    where\n+        D: serde::Deserializer<'de>,\n+    {\n+        struct ValueVisitor;\n+\n+        impl<'de> Visitor<'de> for ValueVisitor {\n+            type Value = JsValue;\n+\n+            fn expecting(&self, formatter: &mut std::fmt::Formatter) -> std::fmt::Result {\n+                formatter.write_str(\"valid primitive JSON value (null, boolean, number, or string\")\n+            }\n+\n+            #[inline]\n+            fn visit_bool<E>(self, value: bool) -> Result<JsValue, E> {\n+                Ok(JsValue::Boolean(value))\n+            }\n+\n+            #[inline]\n+            fn visit_i64<E>(self, value: i64) -> Result<JsValue, E> {\n+                if (MIN_SAFE_INT..=MAX_SAFE_INT).contains(&value) {\n+                    Ok(JsValue::Number((value as f64).into()))\n+                } else {\n+                    panic!(\"Invalid number\")\n+                }\n+            }\n+\n+            #[inline]\n+            fn visit_u64<E>(self, value: u64) -> Result<JsValue, E> {\n+                if value as i64 <= MAX_SAFE_INT {\n+                    Ok(JsValue::Number((value as f64).into()))\n+                } else {\n+                    panic!(\"Invalid number\")\n+                }\n+            }\n+\n+            #[inline]\n+            fn visit_f64<E>(self, value: f64) -> Result<JsValue, E> {\n+                Ok(JsValue::Number(value.into()))\n+            }\n+\n+            #[inline]\n+            fn visit_str<E>(self, value: &str) -> Result<JsValue, E>\n+            where\n+                E: serde::de::Error,\n+            {\n+                self.visit_string(String::from(value))\n+            }\n+\n+            #[inline]\n+            fn visit_string<E>(self, value: String) -> Result<JsValue, E> {\n+                Ok(JsValue::String(value))\n+            }\n+\n+            #[inline]\n+            fn visit_none<E>(self) -> Result<JsValue, E> {\n+                Ok(JsValue::Null)\n+            }\n+\n+            #[inline]\n+            fn visit_some<D>(self, deserializer: D) -> Result<JsValue, D::Error>\n+            where\n+                D: serde::Deserializer<'de>,\n+            {\n+                Deserialize::deserialize(deserializer)\n+            }\n+\n+            #[inline]\n+            fn visit_unit<E>(self) -> Result<JsValue, E> {\n+                Ok(JsValue::Undefined)\n+            }\n+        }\n+\n+        deserializer.deserialize_any(ValueVisitor)\n+    }\n+}\n+\n+/// Represents a JavaScript Number as its binary representation so that\n+/// -1 == -1, NaN == Nan etc.\n+/// Note: NaN is *always* represented as the f64::NAN constant to allow\n+/// comparison of NaNs.\n+#[derive(Clone, Copy, Eq, PartialEq, PartialOrd, Ord, Debug, Hash)]\n+pub struct Number(u64);\n+\n+pub const MAX_SAFE_INT: i64 = 9007199254740991;\n+pub const MIN_SAFE_INT: i64 = -9007199254740991;\n+\n+impl From<f64> for Number {\n+    fn from(value: f64) -> Self {\n+        if value.is_nan() {\n+            Self(f64::NAN.to_bits())\n+        } else {\n+            Self(value.to_bits())\n+        }\n+    }\n+}\n+\n+impl From<u32> for Number {\n+    fn from(value: u32) -> Self {\n+        f64::from(value).into()\n+    }\n+}\n+\n+impl From<Number> for f64 {\n+    fn from(number: Number) -> Self {\n+        let value = f64::from_bits(number.0);\n+        assert!(!f64::is_nan(value) || number.0 == f64::NAN.to_bits());\n+        value\n+    }\n+}\n+\n+impl From<&Number> for f64 {\n+    fn from(number: &Number) -> Self {\n+        let value = f64::from_bits(number.0);\n+        assert!(!f64::is_nan(value) || number.0 == f64::NAN.to_bits());\n+        value\n+    }\n+}\n+\n+impl Number {\n+    pub fn equals(self, other: Self) -> bool {\n+        f64::from(self) == f64::from(other)\n+    }\n+\n+    pub fn not_equals(self, other: Self) -> bool {\n+        !self.equals(other)\n+    }\n+\n+    pub fn is_truthy(self) -> bool {\n+        let value = f64::from(self);\n+        !(self.0 == f64::NAN.to_bits() || value == 0.0 || value == -0.0)\n+    }\n+}\n+\n+impl std::ops::Add for Number {\n+    type Output = Number;\n+\n+    fn add(self, rhs: Self) -> Self::Output {\n+        let result = f64::from(self) + f64::from(rhs);\n+        Self::from(result)\n+    }\n+}\n+\n+impl std::ops::Sub for Number {\n+    type Output = Number;\n+\n+    fn sub(self, rhs: Self) -> Self::Output {\n+        let result = f64::from(self) - f64::from(rhs);\n+        Self::from(result)\n+    }\n+}\n+\n+impl std::ops::Mul for Number {\n+    type Output = Number;\n+\n+    fn mul(self, rhs: Self) -> Self::Output {\n+        let result = f64::from(self) * f64::from(rhs);\n+        Self::from(result)\n+    }\n+}\n+\n+impl std::ops::Div for Number {\n+    type Output = Number;\n+\n+    fn div(self, rhs: Self) -> Self::Output {\n+        let result = f64::from(self) / f64::from(rhs);\n+        Self::from(result)\n+    }\n+}\n+\n+impl Serialize for Number {\n+    fn serialize<S>(&self, serializer: S) -> Result<S::Ok, S::Error>\n+    where\n+        S: serde::Serializer,\n+    {\n+        serializer.serialize_f64(self.into())\n+    }\n+}\n+\n+impl<'de> Deserialize<'de> for Number {\n+    fn deserialize<D>(deserializer: D) -> Result<Self, D::Error>\n+    where\n+        D: serde::Deserializer<'de>,\n+    {\n+        struct ValueVisitor;\n+\n+        impl<'de> Visitor<'de> for ValueVisitor {\n+            type Value = Number;\n+\n+            fn expecting(&self, formatter: &mut std::fmt::Formatter) -> std::fmt::Result {\n+                formatter.write_str(\"value JavaScript number value\")\n+            }\n+\n+            fn visit_f64<E>(self, v: f64) -> Result<Self::Value, E>\n+            where\n+                E: serde::de::Error,\n+            {\n+                Ok(v.into())\n+            }\n+        }\n+\n+        deserializer.deserialize_any(ValueVisitor)\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/lib.rs",
                "git_diff": "@@ -0,0 +1,38 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+mod binding;\n+mod generated;\n+mod generated_extensions;\n+mod js_value;\n+mod range;\n+mod visit;\n+\n+pub use binding::{Binding, BindingId};\n+pub use generated::*;\n+pub use generated_extensions::*;\n+pub use js_value::{JsValue, Number};\n+pub use range::SourceRange;\n+pub use visit::*;\n+\n+#[cfg(test)]\n+mod tests {\n+    use insta::{assert_snapshot, glob};\n+\n+    use super::*;\n+\n+    #[test]\n+    fn fixtures() {\n+        glob!(\"fixtures/**.json\", |path| {\n+            println!(\"{:?}\", path);\n+            let input = std::fs::read_to_string(path).unwrap();\n+            let ast: Program = serde_json::from_str(&input).unwrap();\n+            let serialized = serde_json::to_string_pretty(&ast).unwrap();\n+            assert_snapshot!(format!(\"Input:\\n{input}\\n\\nOutput:\\n{serialized}\"));\n+        });\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/range.rs",
                "git_diff": "@@ -0,0 +1,31 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use std::num::NonZeroU32;\n+\n+use serde::ser::SerializeTuple;\n+use serde::{Deserialize, Serialize};\n+\n+#[derive(Deserialize, Copy, Clone, Debug, PartialEq, PartialOrd, Hash)]\n+pub struct SourceRange {\n+    pub start: u32,\n+    pub end: NonZeroU32,\n+}\n+\n+// ESTree and Babel store the `range` as `[start, end]`, so we customize\n+// the serialization to use a tuple representation.\n+impl Serialize for SourceRange {\n+    fn serialize<S>(&self, serializer: S) -> Result<S::Ok, S::Error>\n+    where\n+        S: serde::Serializer,\n+    {\n+        let mut tuple = serializer.serialize_tuple(2)?;\n+        tuple.serialize_element(&self.start)?;\n+        tuple.serialize_element(&self.end)?;\n+        tuple.end()\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/snapshots/forget_estree__tests__fixtures@for-statement.json.snap",
                "git_diff": "@@ -0,0 +1,1058 @@\n+---\n+source: crates/react_estree/src/lib.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{serialized}\\\")\"\n+input_file: crates/react_estree/src/fixtures/for-statement.json\n+---\n+Input:\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 7,\n+        \"column\": 1\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 7,\n+            \"column\": 1\n+          }\n+        },\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            }\n+          },\n+          \"name\": \"Component\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false,\n+          \"range\": [\n+            9,\n+            18\n+          ]\n+        },\n+        \"params\": [\n+          {\n+            \"type\": \"Identifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 19\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 24\n+              }\n+            },\n+            \"name\": \"props\",\n+            \"typeAnnotation\": null,\n+            \"optional\": false,\n+            \"range\": [\n+              19,\n+              24\n+            ]\n+          }\n+        ],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 26\n+            },\n+            \"end\": {\n+              \"line\": 7,\n+              \"column\": 1\n+            }\n+          },\n+          \"body\": [\n+            {\n+              \"type\": \"VariableDeclaration\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 2,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 2,\n+                  \"column\": 12\n+                }\n+              },\n+              \"kind\": \"let\",\n+              \"declarations\": [\n+                {\n+                  \"type\": \"VariableDeclarator\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 6\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 11\n+                    }\n+                  },\n+                  \"init\": {\n+                    \"type\": \"Literal\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 2,\n+                        \"column\": 10\n+                      },\n+                      \"end\": {\n+                        \"line\": 2,\n+                        \"column\": 11\n+                      }\n+                    },\n+                    \"value\": 0,\n+                    \"range\": [\n+                      38,\n+                      39\n+                    ],\n+                    \"raw\": \"0\"\n+                  },\n+                  \"id\": {\n+                    \"type\": \"Identifier\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 2,\n+                        \"column\": 6\n+                      },\n+                      \"end\": {\n+                        \"line\": 2,\n+                        \"column\": 7\n+                      }\n+                    },\n+                    \"name\": \"x\",\n+                    \"typeAnnotation\": null,\n+                    \"optional\": false,\n+                    \"range\": [\n+                      34,\n+                      35\n+                    ]\n+                  },\n+                  \"range\": [\n+                    34,\n+                    39\n+                  ]\n+                }\n+              ],\n+              \"range\": [\n+                30,\n+                40\n+              ]\n+            },\n+            {\n+              \"type\": \"ForStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 5,\n+                  \"column\": 3\n+                }\n+              },\n+              \"init\": {\n+                \"type\": \"VariableDeclaration\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 7\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 16\n+                  }\n+                },\n+                \"kind\": \"let\",\n+                \"declarations\": [\n+                  {\n+                    \"type\": \"VariableDeclarator\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 11\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 16\n+                      }\n+                    },\n+                    \"init\": {\n+                      \"type\": \"Literal\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 15\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 16\n+                        }\n+                      },\n+                      \"value\": 0,\n+                      \"range\": [\n+                        56,\n+                        57\n+                      ],\n+                      \"raw\": \"0\"\n+                    },\n+                    \"id\": {\n+                      \"type\": \"Identifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 11\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 12\n+                        }\n+                      },\n+                      \"name\": \"i\",\n+                      \"typeAnnotation\": null,\n+                      \"optional\": false,\n+                      \"range\": [\n+                        52,\n+                        53\n+                      ]\n+                    },\n+                    \"range\": [\n+                      52,\n+                      57\n+                    ]\n+                  }\n+                ],\n+                \"range\": [\n+                  48,\n+                  57\n+                ]\n+              },\n+              \"test\": {\n+                \"type\": \"BinaryExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 18\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 24\n+                  }\n+                },\n+                \"left\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 18\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 19\n+                    }\n+                  },\n+                  \"name\": \"i\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false,\n+                  \"range\": [\n+                    59,\n+                    60\n+                  ]\n+                },\n+                \"right\": {\n+                  \"type\": \"Literal\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 22\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 24\n+                    }\n+                  },\n+                  \"value\": 10,\n+                  \"range\": [\n+                    63,\n+                    65\n+                  ],\n+                  \"raw\": \"10\"\n+                },\n+                \"operator\": \"<\",\n+                \"range\": [\n+                  59,\n+                  65\n+                ]\n+              },\n+              \"update\": {\n+                \"type\": \"UpdateExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 29\n+                  }\n+                },\n+                \"operator\": \"++\",\n+                \"argument\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 27\n+                    }\n+                  },\n+                  \"name\": \"i\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false,\n+                  \"range\": [\n+                    67,\n+                    68\n+                  ]\n+                },\n+                \"prefix\": false,\n+                \"range\": [\n+                  67,\n+                  70\n+                ]\n+              },\n+              \"body\": {\n+                \"type\": \"BlockStatement\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 31\n+                  },\n+                  \"end\": {\n+                    \"line\": 5,\n+                    \"column\": 3\n+                  }\n+                },\n+                \"body\": [\n+                  {\n+                    \"type\": \"ExpressionStatement\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 4,\n+                        \"column\": 4\n+                      },\n+                      \"end\": {\n+                        \"line\": 4,\n+                        \"column\": 11\n+                      }\n+                    },\n+                    \"expression\": {\n+                      \"type\": \"AssignmentExpression\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 4,\n+                          \"column\": 4\n+                        },\n+                        \"end\": {\n+                          \"line\": 4,\n+                          \"column\": 10\n+                        }\n+                      },\n+                      \"operator\": \"+=\",\n+                      \"left\": {\n+                        \"type\": \"Identifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 4,\n+                            \"column\": 4\n+                          },\n+                          \"end\": {\n+                            \"line\": 4,\n+                            \"column\": 5\n+                          }\n+                        },\n+                        \"name\": \"x\",\n+                        \"typeAnnotation\": null,\n+                        \"optional\": false,\n+                        \"range\": [\n+                          78,\n+                          79\n+                        ]\n+                      },\n+                      \"right\": {\n+                        \"type\": \"Identifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 4,\n+                            \"column\": 9\n+                          },\n+                          \"end\": {\n+                            \"line\": 4,\n+                            \"column\": 10\n+                          }\n+                        },\n+                        \"name\": \"i\",\n+                        \"typeAnnotation\": null,\n+                        \"optional\": false,\n+                        \"range\": [\n+                          83,\n+                          84\n+                        ]\n+                      },\n+                      \"range\": [\n+                        78,\n+                        84\n+                      ]\n+                    },\n+                    \"directive\": null,\n+                    \"range\": [\n+                      78,\n+                      85\n+                    ]\n+                  }\n+                ],\n+                \"range\": [\n+                  72,\n+                  89\n+                ]\n+              },\n+              \"range\": [\n+                43,\n+                89\n+              ]\n+            },\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 6,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 6,\n+                  \"column\": 11\n+                }\n+              },\n+              \"argument\": {\n+                \"type\": \"Identifier\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 6,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 6,\n+                    \"column\": 10\n+                  }\n+                },\n+                \"name\": \"x\",\n+                \"typeAnnotation\": null,\n+                \"optional\": false,\n+                \"range\": [\n+                  99,\n+                  100\n+                ]\n+              },\n+              \"range\": [\n+                92,\n+                101\n+              ]\n+            }\n+          ],\n+          \"range\": [\n+            26,\n+            103\n+          ]\n+        },\n+        \"typeParameters\": null,\n+        \"returnType\": null,\n+        \"predicate\": null,\n+        \"generator\": false,\n+        \"async\": false,\n+        \"range\": [\n+          0,\n+          103\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      0,\n+      103\n+    ],\n+    \"sourceType\": \"script\"\n+  }\n+\n+Output:\n+{\n+  \"type\": \"Program\",\n+  \"body\": [\n+    {\n+      \"type\": \"FunctionDeclaration\",\n+      \"id\": {\n+        \"type\": \"Identifier\",\n+        \"name\": \"Component\",\n+        \"typeAnnotation\": null,\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 9\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 18\n+          }\n+        },\n+        \"range\": [\n+          9,\n+          18\n+        ]\n+      },\n+      \"params\": [\n+        {\n+          \"type\": \"Identifier\",\n+          \"name\": \"props\",\n+          \"typeAnnotation\": null,\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 19\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 24\n+            }\n+          },\n+          \"range\": [\n+            19,\n+            24\n+          ]\n+        }\n+      ],\n+      \"body\": {\n+        \"type\": \"BlockStatement\",\n+        \"body\": [\n+          {\n+            \"type\": \"VariableDeclaration\",\n+            \"kind\": \"let\",\n+            \"declarations\": [\n+              {\n+                \"type\": \"VariableDeclarator\",\n+                \"id\": {\n+                  \"type\": \"Identifier\",\n+                  \"name\": \"x\",\n+                  \"typeAnnotation\": null,\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 6\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 7\n+                    }\n+                  },\n+                  \"range\": [\n+                    34,\n+                    35\n+                  ]\n+                },\n+                \"init\": {\n+                  \"type\": \"Literal\",\n+                  \"value\": 0.0,\n+                  \"raw\": \"0\",\n+                  \"regex\": null,\n+                  \"bigint\": null,\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 10\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 11\n+                    }\n+                  },\n+                  \"range\": [\n+                    38,\n+                    39\n+                  ]\n+                },\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 6\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 11\n+                  }\n+                },\n+                \"range\": [\n+                  34,\n+                  39\n+                ]\n+              }\n+            ],\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 2,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 2,\n+                \"column\": 12\n+              }\n+            },\n+            \"range\": [\n+              30,\n+              40\n+            ]\n+          },\n+          {\n+            \"type\": \"ForStatement\",\n+            \"init\": {\n+              \"type\": \"VariableDeclaration\",\n+              \"kind\": \"let\",\n+              \"declarations\": [\n+                {\n+                  \"type\": \"VariableDeclarator\",\n+                  \"id\": {\n+                    \"type\": \"Identifier\",\n+                    \"name\": \"i\",\n+                    \"typeAnnotation\": null,\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 11\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 12\n+                      }\n+                    },\n+                    \"range\": [\n+                      52,\n+                      53\n+                    ]\n+                  },\n+                  \"init\": {\n+                    \"type\": \"Literal\",\n+                    \"value\": 0.0,\n+                    \"raw\": \"0\",\n+                    \"regex\": null,\n+                    \"bigint\": null,\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 15\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 16\n+                      }\n+                    },\n+                    \"range\": [\n+                      56,\n+                      57\n+                    ]\n+                  },\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 11\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 16\n+                    }\n+                  },\n+                  \"range\": [\n+                    52,\n+                    57\n+                  ]\n+                }\n+              ],\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 7\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 16\n+                }\n+              },\n+              \"range\": [\n+                48,\n+                57\n+              ]\n+            },\n+            \"test\": {\n+              \"type\": \"BinaryExpression\",\n+              \"left\": {\n+                \"type\": \"Identifier\",\n+                \"name\": \"i\",\n+                \"typeAnnotation\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 18\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 19\n+                  }\n+                },\n+                \"range\": [\n+                  59,\n+                  60\n+                ]\n+              },\n+              \"operator\": \"<\",\n+              \"right\": {\n+                \"type\": \"Literal\",\n+                \"value\": 10.0,\n+                \"raw\": \"10\",\n+                \"regex\": null,\n+                \"bigint\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 22\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 24\n+                  }\n+                },\n+                \"range\": [\n+                  63,\n+                  65\n+                ]\n+              },\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 18\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 24\n+                }\n+              },\n+              \"range\": [\n+                59,\n+                65\n+              ]\n+            },\n+            \"update\": {\n+              \"type\": \"UpdateExpression\",\n+              \"operator\": \"++\",\n+              \"argument\": {\n+                \"type\": \"Identifier\",\n+                \"name\": \"i\",\n+                \"typeAnnotation\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 27\n+                  }\n+                },\n+                \"range\": [\n+                  67,\n+                  68\n+                ]\n+              },\n+              \"prefix\": false,\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 26\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 29\n+                }\n+              },\n+              \"range\": [\n+                67,\n+                70\n+              ]\n+            },\n+            \"body\": {\n+              \"type\": \"BlockStatement\",\n+              \"body\": [\n+                {\n+                  \"type\": \"ExpressionStatement\",\n+                  \"expression\": {\n+                    \"type\": \"AssignmentExpression\",\n+                    \"operator\": \"+=\",\n+                    \"left\": {\n+                      \"type\": \"Identifier\",\n+                      \"name\": \"x\",\n+                      \"typeAnnotation\": null,\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 4,\n+                          \"column\": 4\n+                        },\n+                        \"end\": {\n+                          \"line\": 4,\n+                          \"column\": 5\n+                        }\n+                      },\n+                      \"range\": [\n+                        78,\n+                        79\n+                      ]\n+                    },\n+                    \"right\": {\n+                      \"type\": \"Identifier\",\n+                      \"name\": \"i\",\n+                      \"typeAnnotation\": null,\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 4,\n+                          \"column\": 9\n+                        },\n+                        \"end\": {\n+                          \"line\": 4,\n+                          \"column\": 10\n+                        }\n+                      },\n+                      \"range\": [\n+                        83,\n+                        84\n+                      ]\n+                    },\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 4,\n+                        \"column\": 4\n+                      },\n+                      \"end\": {\n+                        \"line\": 4,\n+                        \"column\": 10\n+                      }\n+                    },\n+                    \"range\": [\n+                      78,\n+                      84\n+                    ]\n+                  },\n+                  \"directive\": null,\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 4,\n+                      \"column\": 4\n+                    },\n+                    \"end\": {\n+                      \"line\": 4,\n+                      \"column\": 11\n+                    }\n+                  },\n+                  \"range\": [\n+                    78,\n+                    85\n+                  ]\n+                }\n+              ],\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 31\n+                },\n+                \"end\": {\n+                  \"line\": 5,\n+                  \"column\": 3\n+                }\n+              },\n+              \"range\": [\n+                72,\n+                89\n+              ]\n+            },\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 3,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 5,\n+                \"column\": 3\n+              }\n+            },\n+            \"range\": [\n+              43,\n+              89\n+            ]\n+          },\n+          {\n+            \"type\": \"ReturnStatement\",\n+            \"argument\": {\n+              \"type\": \"Identifier\",\n+              \"name\": \"x\",\n+              \"typeAnnotation\": null,\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 6,\n+                  \"column\": 9\n+                },\n+                \"end\": {\n+                  \"line\": 6,\n+                  \"column\": 10\n+                }\n+              },\n+              \"range\": [\n+                99,\n+                100\n+              ]\n+            },\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 6,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 6,\n+                \"column\": 11\n+              }\n+            },\n+            \"range\": [\n+              92,\n+              101\n+            ]\n+          }\n+        ],\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 26\n+          },\n+          \"end\": {\n+            \"line\": 7,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          26,\n+          103\n+        ]\n+      },\n+      \"generator\": false,\n+      \"async\": false,\n+      \"loc\": null,\n+      \"range\": null,\n+      \"loc\": {\n+        \"source\": null,\n+        \"start\": {\n+          \"line\": 1,\n+          \"column\": 0\n+        },\n+        \"end\": {\n+          \"line\": 7,\n+          \"column\": 1\n+        }\n+      },\n+      \"range\": [\n+        0,\n+        103\n+      ]\n+    }\n+  ],\n+  \"sourceType\": \"script\",\n+  \"loc\": {\n+    \"source\": null,\n+    \"start\": {\n+      \"line\": 1,\n+      \"column\": 0\n+    },\n+    \"end\": {\n+      \"line\": 7,\n+      \"column\": 1\n+    }\n+  },\n+  \"range\": [\n+    0,\n+    103\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/snapshots/forget_estree__tests__fixtures@import.json.snap",
                "git_diff": "@@ -0,0 +1,213 @@\n+---\n+source: crates/react_estree/src/lib.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{serialized}\\\")\"\n+input_file: crates/react_estree/src/fixtures/import.json\n+---\n+Input:\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 1,\n+        \"column\": 26\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"ImportDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 26\n+          }\n+        },\n+        \"specifiers\": [\n+          {\n+            \"type\": \"ImportDefaultSpecifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 7\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 12\n+              }\n+            },\n+            \"local\": {\n+              \"type\": \"Identifier\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 1,\n+                  \"column\": 7\n+                },\n+                \"end\": {\n+                  \"line\": 1,\n+                  \"column\": 12\n+                }\n+              },\n+              \"name\": \"React\",\n+              \"typeAnnotation\": null,\n+              \"optional\": false,\n+              \"range\": [\n+                7,\n+                12\n+              ]\n+            },\n+            \"range\": [\n+              7,\n+              12\n+            ]\n+          }\n+        ],\n+        \"source\": {\n+          \"type\": \"Literal\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 25\n+            }\n+          },\n+          \"value\": \"react\",\n+          \"range\": [\n+            18,\n+            25\n+          ],\n+          \"raw\": \"'react'\"\n+        },\n+        \"attributes\": [],\n+        \"importKind\": \"value\",\n+        \"range\": [\n+          0,\n+          26\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      0,\n+      26\n+    ],\n+    \"sourceType\": \"module\"\n+  }\n+\n+Output:\n+{\n+  \"type\": \"Program\",\n+  \"body\": [\n+    {\n+      \"type\": \"ImportDeclaration\",\n+      \"specifiers\": [\n+        {\n+          \"type\": \"ImportDefaultSpecifier\",\n+          \"local\": {\n+            \"type\": \"Identifier\",\n+            \"name\": \"React\",\n+            \"typeAnnotation\": null,\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 7\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 12\n+              }\n+            },\n+            \"range\": [\n+              7,\n+              12\n+            ]\n+          },\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 7\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 12\n+            }\n+          },\n+          \"range\": [\n+            7,\n+            12\n+          ]\n+        }\n+      ],\n+      \"source\": {\n+        \"type\": \"Literal\",\n+        \"value\": \"react\",\n+        \"raw\": \"'react'\",\n+        \"regex\": null,\n+        \"bigint\": null,\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 18\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 25\n+          }\n+        },\n+        \"range\": [\n+          18,\n+          25\n+        ]\n+      },\n+      \"loc\": {\n+        \"source\": null,\n+        \"start\": {\n+          \"line\": 1,\n+          \"column\": 0\n+        },\n+        \"end\": {\n+          \"line\": 1,\n+          \"column\": 26\n+        }\n+      },\n+      \"range\": [\n+        0,\n+        26\n+      ]\n+    }\n+  ],\n+  \"sourceType\": \"module\",\n+  \"loc\": {\n+    \"source\": null,\n+    \"start\": {\n+      \"line\": 1,\n+      \"column\": 0\n+    },\n+    \"end\": {\n+      \"line\": 1,\n+      \"column\": 26\n+    }\n+  },\n+  \"range\": [\n+    0,\n+    26\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/snapshots/forget_estree__tests__fixtures@simple.json.snap",
                "git_diff": "@@ -0,0 +1,379 @@\n+---\n+source: crates/react_estree/src/lib.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{serialized}\\\")\"\n+input_file: crates/react_estree/src/fixtures/simple.json\n+---\n+Input:\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 3,\n+        \"column\": 1\n+      }\n+    },\n+    \"range\": [\n+      0,\n+      51\n+    ],\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 3,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          0,\n+          51\n+        ],\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            }\n+          },\n+          \"range\": [\n+            9,\n+            18\n+          ],\n+          \"name\": \"Component\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false\n+        },\n+        \"params\": [\n+          {\n+            \"type\": \"Identifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 19\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 24\n+              }\n+            },\n+            \"range\": [\n+              19,\n+              24\n+            ],\n+            \"name\": \"props\",\n+            \"typeAnnotation\": null,\n+            \"optional\": false\n+          }\n+        ],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 26\n+            },\n+            \"end\": {\n+              \"line\": 3,\n+              \"column\": 1\n+            }\n+          },\n+          \"range\": [\n+            26,\n+            51\n+          ],\n+          \"body\": [\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 2,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 2,\n+                  \"column\": 21\n+                }\n+              },\n+              \"range\": [\n+                30,\n+                49\n+              ],\n+              \"argument\": {\n+                \"type\": \"MemberExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 20\n+                  }\n+                },\n+                \"range\": [\n+                  37,\n+                  48\n+                ],\n+                \"object\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 9\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 14\n+                    }\n+                  },\n+                  \"range\": [\n+                    37,\n+                    42\n+                  ],\n+                  \"name\": \"props\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false\n+                },\n+                \"property\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 15\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 20\n+                    }\n+                  },\n+                  \"range\": [\n+                    43,\n+                    48\n+                  ],\n+                  \"name\": \"value\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false\n+                },\n+                \"computed\": false\n+              }\n+            }\n+          ]\n+        },\n+        \"async\": false,\n+        \"generator\": false,\n+        \"predicate\": null,\n+        \"expression\": false,\n+        \"returnType\": null,\n+        \"typeParameters\": null\n+      }\n+    ],\n+    \"comments\": [],\n+    \"errors\": []\n+  }\n+\n+Output:\n+{\n+  \"type\": \"Program\",\n+  \"body\": [\n+    {\n+      \"type\": \"FunctionDeclaration\",\n+      \"id\": {\n+        \"type\": \"Identifier\",\n+        \"name\": \"Component\",\n+        \"typeAnnotation\": null,\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 9\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 18\n+          }\n+        },\n+        \"range\": [\n+          9,\n+          18\n+        ]\n+      },\n+      \"params\": [\n+        {\n+          \"type\": \"Identifier\",\n+          \"name\": \"props\",\n+          \"typeAnnotation\": null,\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 19\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 24\n+            }\n+          },\n+          \"range\": [\n+            19,\n+            24\n+          ]\n+        }\n+      ],\n+      \"body\": {\n+        \"type\": \"BlockStatement\",\n+        \"body\": [\n+          {\n+            \"type\": \"ReturnStatement\",\n+            \"argument\": {\n+              \"type\": \"MemberExpression\",\n+              \"object\": {\n+                \"type\": \"Identifier\",\n+                \"name\": \"props\",\n+                \"typeAnnotation\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 14\n+                  }\n+                },\n+                \"range\": [\n+                  37,\n+                  42\n+                ]\n+              },\n+              \"property\": {\n+                \"type\": \"Identifier\",\n+                \"name\": \"value\",\n+                \"typeAnnotation\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 15\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 20\n+                  }\n+                },\n+                \"range\": [\n+                  43,\n+                  48\n+                ]\n+              },\n+              \"computed\": false,\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 2,\n+                  \"column\": 9\n+                },\n+                \"end\": {\n+                  \"line\": 2,\n+                  \"column\": 20\n+                }\n+              },\n+              \"range\": [\n+                37,\n+                48\n+              ]\n+            },\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 2,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 2,\n+                \"column\": 21\n+              }\n+            },\n+            \"range\": [\n+              30,\n+              49\n+            ]\n+          }\n+        ],\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 26\n+          },\n+          \"end\": {\n+            \"line\": 3,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          26,\n+          51\n+        ]\n+      },\n+      \"generator\": false,\n+      \"async\": false,\n+      \"loc\": null,\n+      \"range\": null,\n+      \"loc\": {\n+        \"source\": null,\n+        \"start\": {\n+          \"line\": 1,\n+          \"column\": 0\n+        },\n+        \"end\": {\n+          \"line\": 3,\n+          \"column\": 1\n+        }\n+      },\n+      \"range\": [\n+        0,\n+        51\n+      ]\n+    }\n+  ],\n+  \"sourceType\": \"module\",\n+  \"loc\": {\n+    \"source\": null,\n+    \"start\": {\n+      \"line\": 1,\n+      \"column\": 0\n+    },\n+    \"end\": {\n+      \"line\": 3,\n+      \"column\": 1\n+    }\n+  },\n+  \"range\": [\n+    0,\n+    51\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/snapshots/forget_estree__tests__fixtures@test.json.snap",
                "git_diff": "@@ -0,0 +1,708 @@\n+---\n+source: crates/react_estree/src/lib.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{serialized}\\\")\"\n+input_file: crates/react_estree/src/fixtures/test.json\n+---\n+Input:\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 2,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 4,\n+        \"column\": 1\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 2,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 4,\n+            \"column\": 1\n+          }\n+        },\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 2,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 2,\n+              \"column\": 12\n+            }\n+          },\n+          \"name\": \"foo\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false,\n+          \"range\": [\n+            10,\n+            13\n+          ]\n+        },\n+        \"params\": [],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 2,\n+              \"column\": 15\n+            },\n+            \"end\": {\n+              \"line\": 4,\n+              \"column\": 1\n+            }\n+          },\n+          \"body\": [\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 36\n+                }\n+              },\n+              \"argument\": {\n+                \"type\": \"JSXElement\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 36\n+                  }\n+                },\n+                \"openingElement\": {\n+                  \"type\": \"JSXOpeningElement\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 9\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    }\n+                  },\n+                  \"name\": {\n+                    \"type\": \"JSXMemberExpression\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 10\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 17\n+                      }\n+                    },\n+                    \"object\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 10\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 13\n+                        }\n+                      },\n+                      \"name\": \"Foo\",\n+                      \"range\": [\n+                        28,\n+                        31\n+                      ]\n+                    },\n+                    \"property\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 14\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 17\n+                        }\n+                      },\n+                      \"name\": \"Bar\",\n+                      \"range\": [\n+                        32,\n+                        35\n+                      ]\n+                    },\n+                    \"range\": [\n+                      28,\n+                      35\n+                    ]\n+                  },\n+                  \"attributes\": [\n+                    {\n+                      \"type\": \"JSXAttribute\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 18\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 24\n+                        }\n+                      },\n+                      \"name\": {\n+                        \"type\": \"JSXIdentifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 3,\n+                            \"column\": 18\n+                          },\n+                          \"end\": {\n+                            \"line\": 3,\n+                            \"column\": 19\n+                          }\n+                        },\n+                        \"name\": \"a\",\n+                        \"range\": [\n+                          36,\n+                          37\n+                        ]\n+                      },\n+                      \"value\": {\n+                        \"type\": \"JSXExpressionContainer\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 3,\n+                            \"column\": 20\n+                          },\n+                          \"end\": {\n+                            \"line\": 3,\n+                            \"column\": 24\n+                          }\n+                        },\n+                        \"expression\": {\n+                          \"type\": \"Literal\",\n+                          \"loc\": {\n+                            \"source\": null,\n+                            \"start\": {\n+                              \"line\": 3,\n+                              \"column\": 21\n+                            },\n+                            \"end\": {\n+                              \"line\": 3,\n+                              \"column\": 23\n+                            }\n+                          },\n+                          \"value\": 10,\n+                          \"range\": [\n+                            39,\n+                            41\n+                          ],\n+                          \"raw\": \"10\"\n+                        },\n+                        \"range\": [\n+                          38,\n+                          42\n+                        ]\n+                      },\n+                      \"range\": [\n+                        36,\n+                        42\n+                      ]\n+                    }\n+                  ],\n+                  \"selfClosing\": false,\n+                  \"range\": [\n+                    27,\n+                    44\n+                  ]\n+                },\n+                \"children\": [],\n+                \"closingElement\": {\n+                  \"type\": \"JSXClosingElement\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 36\n+                    }\n+                  },\n+                  \"name\": {\n+                    \"type\": \"JSXMemberExpression\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 28\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 35\n+                      }\n+                    },\n+                    \"object\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 28\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 31\n+                        }\n+                      },\n+                      \"name\": \"Foo\",\n+                      \"range\": [\n+                        46,\n+                        49\n+                      ]\n+                    },\n+                    \"property\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 32\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 35\n+                        }\n+                      },\n+                      \"name\": \"Bar\",\n+                      \"range\": [\n+                        50,\n+                        53\n+                      ]\n+                    },\n+                    \"range\": [\n+                      46,\n+                      53\n+                    ]\n+                  },\n+                  \"range\": [\n+                    44,\n+                    54\n+                  ]\n+                },\n+                \"range\": [\n+                  27,\n+                  54\n+                ]\n+              },\n+              \"range\": [\n+                20,\n+                54\n+              ]\n+            }\n+          ],\n+          \"range\": [\n+            16,\n+            56\n+          ]\n+        },\n+        \"typeParameters\": null,\n+        \"returnType\": null,\n+        \"predicate\": null,\n+        \"generator\": false,\n+        \"async\": false,\n+        \"range\": [\n+          1,\n+          56\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      1,\n+      56\n+    ],\n+    \"sourceType\": \"script\"\n+  }\n+\n+Output:\n+{\n+  \"type\": \"Program\",\n+  \"body\": [\n+    {\n+      \"type\": \"FunctionDeclaration\",\n+      \"id\": {\n+        \"type\": \"Identifier\",\n+        \"name\": \"foo\",\n+        \"typeAnnotation\": null,\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 2,\n+            \"column\": 9\n+          },\n+          \"end\": {\n+            \"line\": 2,\n+            \"column\": 12\n+          }\n+        },\n+        \"range\": [\n+          10,\n+          13\n+        ]\n+      },\n+      \"params\": [],\n+      \"body\": {\n+        \"type\": \"BlockStatement\",\n+        \"body\": [\n+          {\n+            \"type\": \"ReturnStatement\",\n+            \"argument\": {\n+              \"type\": \"JSXElement\",\n+              \"openingElement\": {\n+                \"type\": \"JSXOpeningElement\",\n+                \"name\": {\n+                  \"type\": \"JSXMemberExpression\",\n+                  \"object\": {\n+                    \"type\": \"JSXIdentifier\",\n+                    \"name\": \"Foo\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 10\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 13\n+                      }\n+                    },\n+                    \"range\": [\n+                      28,\n+                      31\n+                    ]\n+                  },\n+                  \"property\": {\n+                    \"type\": \"JSXIdentifier\",\n+                    \"name\": \"Bar\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 14\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 17\n+                      }\n+                    },\n+                    \"range\": [\n+                      32,\n+                      35\n+                    ]\n+                  },\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 10\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 17\n+                    }\n+                  },\n+                  \"range\": [\n+                    28,\n+                    35\n+                  ]\n+                },\n+                \"attributes\": [\n+                  {\n+                    \"type\": \"JSXAttribute\",\n+                    \"name\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"name\": \"a\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 18\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 19\n+                        }\n+                      },\n+                      \"range\": [\n+                        36,\n+                        37\n+                      ]\n+                    },\n+                    \"value\": {\n+                      \"type\": \"JSXExpressionContainer\",\n+                      \"expression\": {\n+                        \"type\": \"Literal\",\n+                        \"value\": 10.0,\n+                        \"raw\": \"10\",\n+                        \"regex\": null,\n+                        \"bigint\": null,\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 3,\n+                            \"column\": 21\n+                          },\n+                          \"end\": {\n+                            \"line\": 3,\n+                            \"column\": 23\n+                          }\n+                        },\n+                        \"range\": [\n+                          39,\n+                          41\n+                        ]\n+                      },\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 20\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 24\n+                        }\n+                      },\n+                      \"range\": [\n+                        38,\n+                        42\n+                      ]\n+                    },\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 18\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 24\n+                      }\n+                    },\n+                    \"range\": [\n+                      36,\n+                      42\n+                    ]\n+                  }\n+                ],\n+                \"selfClosing\": false,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  }\n+                },\n+                \"range\": [\n+                  27,\n+                  44\n+                ]\n+              },\n+              \"children\": [],\n+              \"closingElement\": {\n+                \"type\": \"JSXClosingElement\",\n+                \"name\": {\n+                  \"type\": \"JSXMemberExpression\",\n+                  \"object\": {\n+                    \"type\": \"JSXIdentifier\",\n+                    \"name\": \"Foo\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 28\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 31\n+                      }\n+                    },\n+                    \"range\": [\n+                      46,\n+                      49\n+                    ]\n+                  },\n+                  \"property\": {\n+                    \"type\": \"JSXIdentifier\",\n+                    \"name\": \"Bar\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 32\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 35\n+                      }\n+                    },\n+                    \"range\": [\n+                      50,\n+                      53\n+                    ]\n+                  },\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 28\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 35\n+                    }\n+                  },\n+                  \"range\": [\n+                    46,\n+                    53\n+                  ]\n+                },\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 36\n+                  }\n+                },\n+                \"range\": [\n+                  44,\n+                  54\n+                ]\n+              },\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 9\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 36\n+                }\n+              },\n+              \"range\": [\n+                27,\n+                54\n+              ]\n+            },\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 3,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 3,\n+                \"column\": 36\n+              }\n+            },\n+            \"range\": [\n+              20,\n+              54\n+            ]\n+          }\n+        ],\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 2,\n+            \"column\": 15\n+          },\n+          \"end\": {\n+            \"line\": 4,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          16,\n+          56\n+        ]\n+      },\n+      \"generator\": false,\n+      \"async\": false,\n+      \"loc\": null,\n+      \"range\": null,\n+      \"loc\": {\n+        \"source\": null,\n+        \"start\": {\n+          \"line\": 2,\n+          \"column\": 0\n+        },\n+        \"end\": {\n+          \"line\": 4,\n+          \"column\": 1\n+        }\n+      },\n+      \"range\": [\n+        1,\n+        56\n+      ]\n+    }\n+  ],\n+  \"sourceType\": \"script\",\n+  \"loc\": {\n+    \"source\": null,\n+    \"start\": {\n+      \"line\": 2,\n+      \"column\": 0\n+    },\n+    \"end\": {\n+      \"line\": 4,\n+      \"column\": 1\n+    }\n+  },\n+  \"range\": [\n+    1,\n+    56\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/snapshots/react_estree__tests__fixtures@for-statement.json.snap",
                "git_diff": "@@ -0,0 +1,1058 @@\n+---\n+source: crates/react_estree/src/lib.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{serialized}\\\")\"\n+input_file: crates/react_estree/src/fixtures/for-statement.json\n+---\n+Input:\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 7,\n+        \"column\": 1\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 7,\n+            \"column\": 1\n+          }\n+        },\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            }\n+          },\n+          \"name\": \"Component\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false,\n+          \"range\": [\n+            9,\n+            18\n+          ]\n+        },\n+        \"params\": [\n+          {\n+            \"type\": \"Identifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 19\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 24\n+              }\n+            },\n+            \"name\": \"props\",\n+            \"typeAnnotation\": null,\n+            \"optional\": false,\n+            \"range\": [\n+              19,\n+              24\n+            ]\n+          }\n+        ],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 26\n+            },\n+            \"end\": {\n+              \"line\": 7,\n+              \"column\": 1\n+            }\n+          },\n+          \"body\": [\n+            {\n+              \"type\": \"VariableDeclaration\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 2,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 2,\n+                  \"column\": 12\n+                }\n+              },\n+              \"kind\": \"let\",\n+              \"declarations\": [\n+                {\n+                  \"type\": \"VariableDeclarator\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 6\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 11\n+                    }\n+                  },\n+                  \"init\": {\n+                    \"type\": \"Literal\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 2,\n+                        \"column\": 10\n+                      },\n+                      \"end\": {\n+                        \"line\": 2,\n+                        \"column\": 11\n+                      }\n+                    },\n+                    \"value\": 0,\n+                    \"range\": [\n+                      38,\n+                      39\n+                    ],\n+                    \"raw\": \"0\"\n+                  },\n+                  \"id\": {\n+                    \"type\": \"Identifier\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 2,\n+                        \"column\": 6\n+                      },\n+                      \"end\": {\n+                        \"line\": 2,\n+                        \"column\": 7\n+                      }\n+                    },\n+                    \"name\": \"x\",\n+                    \"typeAnnotation\": null,\n+                    \"optional\": false,\n+                    \"range\": [\n+                      34,\n+                      35\n+                    ]\n+                  },\n+                  \"range\": [\n+                    34,\n+                    39\n+                  ]\n+                }\n+              ],\n+              \"range\": [\n+                30,\n+                40\n+              ]\n+            },\n+            {\n+              \"type\": \"ForStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 5,\n+                  \"column\": 3\n+                }\n+              },\n+              \"init\": {\n+                \"type\": \"VariableDeclaration\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 7\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 16\n+                  }\n+                },\n+                \"kind\": \"let\",\n+                \"declarations\": [\n+                  {\n+                    \"type\": \"VariableDeclarator\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 11\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 16\n+                      }\n+                    },\n+                    \"init\": {\n+                      \"type\": \"Literal\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 15\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 16\n+                        }\n+                      },\n+                      \"value\": 0,\n+                      \"range\": [\n+                        56,\n+                        57\n+                      ],\n+                      \"raw\": \"0\"\n+                    },\n+                    \"id\": {\n+                      \"type\": \"Identifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 11\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 12\n+                        }\n+                      },\n+                      \"name\": \"i\",\n+                      \"typeAnnotation\": null,\n+                      \"optional\": false,\n+                      \"range\": [\n+                        52,\n+                        53\n+                      ]\n+                    },\n+                    \"range\": [\n+                      52,\n+                      57\n+                    ]\n+                  }\n+                ],\n+                \"range\": [\n+                  48,\n+                  57\n+                ]\n+              },\n+              \"test\": {\n+                \"type\": \"BinaryExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 18\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 24\n+                  }\n+                },\n+                \"left\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 18\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 19\n+                    }\n+                  },\n+                  \"name\": \"i\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false,\n+                  \"range\": [\n+                    59,\n+                    60\n+                  ]\n+                },\n+                \"right\": {\n+                  \"type\": \"Literal\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 22\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 24\n+                    }\n+                  },\n+                  \"value\": 10,\n+                  \"range\": [\n+                    63,\n+                    65\n+                  ],\n+                  \"raw\": \"10\"\n+                },\n+                \"operator\": \"<\",\n+                \"range\": [\n+                  59,\n+                  65\n+                ]\n+              },\n+              \"update\": {\n+                \"type\": \"UpdateExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 29\n+                  }\n+                },\n+                \"operator\": \"++\",\n+                \"argument\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 27\n+                    }\n+                  },\n+                  \"name\": \"i\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false,\n+                  \"range\": [\n+                    67,\n+                    68\n+                  ]\n+                },\n+                \"prefix\": false,\n+                \"range\": [\n+                  67,\n+                  70\n+                ]\n+              },\n+              \"body\": {\n+                \"type\": \"BlockStatement\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 31\n+                  },\n+                  \"end\": {\n+                    \"line\": 5,\n+                    \"column\": 3\n+                  }\n+                },\n+                \"body\": [\n+                  {\n+                    \"type\": \"ExpressionStatement\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 4,\n+                        \"column\": 4\n+                      },\n+                      \"end\": {\n+                        \"line\": 4,\n+                        \"column\": 11\n+                      }\n+                    },\n+                    \"expression\": {\n+                      \"type\": \"AssignmentExpression\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 4,\n+                          \"column\": 4\n+                        },\n+                        \"end\": {\n+                          \"line\": 4,\n+                          \"column\": 10\n+                        }\n+                      },\n+                      \"operator\": \"+=\",\n+                      \"left\": {\n+                        \"type\": \"Identifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 4,\n+                            \"column\": 4\n+                          },\n+                          \"end\": {\n+                            \"line\": 4,\n+                            \"column\": 5\n+                          }\n+                        },\n+                        \"name\": \"x\",\n+                        \"typeAnnotation\": null,\n+                        \"optional\": false,\n+                        \"range\": [\n+                          78,\n+                          79\n+                        ]\n+                      },\n+                      \"right\": {\n+                        \"type\": \"Identifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 4,\n+                            \"column\": 9\n+                          },\n+                          \"end\": {\n+                            \"line\": 4,\n+                            \"column\": 10\n+                          }\n+                        },\n+                        \"name\": \"i\",\n+                        \"typeAnnotation\": null,\n+                        \"optional\": false,\n+                        \"range\": [\n+                          83,\n+                          84\n+                        ]\n+                      },\n+                      \"range\": [\n+                        78,\n+                        84\n+                      ]\n+                    },\n+                    \"directive\": null,\n+                    \"range\": [\n+                      78,\n+                      85\n+                    ]\n+                  }\n+                ],\n+                \"range\": [\n+                  72,\n+                  89\n+                ]\n+              },\n+              \"range\": [\n+                43,\n+                89\n+              ]\n+            },\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 6,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 6,\n+                  \"column\": 11\n+                }\n+              },\n+              \"argument\": {\n+                \"type\": \"Identifier\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 6,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 6,\n+                    \"column\": 10\n+                  }\n+                },\n+                \"name\": \"x\",\n+                \"typeAnnotation\": null,\n+                \"optional\": false,\n+                \"range\": [\n+                  99,\n+                  100\n+                ]\n+              },\n+              \"range\": [\n+                92,\n+                101\n+              ]\n+            }\n+          ],\n+          \"range\": [\n+            26,\n+            103\n+          ]\n+        },\n+        \"typeParameters\": null,\n+        \"returnType\": null,\n+        \"predicate\": null,\n+        \"generator\": false,\n+        \"async\": false,\n+        \"range\": [\n+          0,\n+          103\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      0,\n+      103\n+    ],\n+    \"sourceType\": \"script\"\n+  }\n+\n+Output:\n+{\n+  \"type\": \"Program\",\n+  \"body\": [\n+    {\n+      \"type\": \"FunctionDeclaration\",\n+      \"id\": {\n+        \"type\": \"Identifier\",\n+        \"name\": \"Component\",\n+        \"typeAnnotation\": null,\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 9\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 18\n+          }\n+        },\n+        \"range\": [\n+          9,\n+          18\n+        ]\n+      },\n+      \"params\": [\n+        {\n+          \"type\": \"Identifier\",\n+          \"name\": \"props\",\n+          \"typeAnnotation\": null,\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 19\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 24\n+            }\n+          },\n+          \"range\": [\n+            19,\n+            24\n+          ]\n+        }\n+      ],\n+      \"body\": {\n+        \"type\": \"BlockStatement\",\n+        \"body\": [\n+          {\n+            \"type\": \"VariableDeclaration\",\n+            \"kind\": \"let\",\n+            \"declarations\": [\n+              {\n+                \"type\": \"VariableDeclarator\",\n+                \"id\": {\n+                  \"type\": \"Identifier\",\n+                  \"name\": \"x\",\n+                  \"typeAnnotation\": null,\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 6\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 7\n+                    }\n+                  },\n+                  \"range\": [\n+                    34,\n+                    35\n+                  ]\n+                },\n+                \"init\": {\n+                  \"type\": \"Literal\",\n+                  \"value\": 0.0,\n+                  \"raw\": \"0\",\n+                  \"regex\": null,\n+                  \"bigint\": null,\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 10\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 11\n+                    }\n+                  },\n+                  \"range\": [\n+                    38,\n+                    39\n+                  ]\n+                },\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 6\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 11\n+                  }\n+                },\n+                \"range\": [\n+                  34,\n+                  39\n+                ]\n+              }\n+            ],\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 2,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 2,\n+                \"column\": 12\n+              }\n+            },\n+            \"range\": [\n+              30,\n+              40\n+            ]\n+          },\n+          {\n+            \"type\": \"ForStatement\",\n+            \"init\": {\n+              \"type\": \"VariableDeclaration\",\n+              \"kind\": \"let\",\n+              \"declarations\": [\n+                {\n+                  \"type\": \"VariableDeclarator\",\n+                  \"id\": {\n+                    \"type\": \"Identifier\",\n+                    \"name\": \"i\",\n+                    \"typeAnnotation\": null,\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 11\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 12\n+                      }\n+                    },\n+                    \"range\": [\n+                      52,\n+                      53\n+                    ]\n+                  },\n+                  \"init\": {\n+                    \"type\": \"Literal\",\n+                    \"value\": 0.0,\n+                    \"raw\": \"0\",\n+                    \"regex\": null,\n+                    \"bigint\": null,\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 15\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 16\n+                      }\n+                    },\n+                    \"range\": [\n+                      56,\n+                      57\n+                    ]\n+                  },\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 11\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 16\n+                    }\n+                  },\n+                  \"range\": [\n+                    52,\n+                    57\n+                  ]\n+                }\n+              ],\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 7\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 16\n+                }\n+              },\n+              \"range\": [\n+                48,\n+                57\n+              ]\n+            },\n+            \"test\": {\n+              \"type\": \"BinaryExpression\",\n+              \"left\": {\n+                \"type\": \"Identifier\",\n+                \"name\": \"i\",\n+                \"typeAnnotation\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 18\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 19\n+                  }\n+                },\n+                \"range\": [\n+                  59,\n+                  60\n+                ]\n+              },\n+              \"operator\": \"<\",\n+              \"right\": {\n+                \"type\": \"Literal\",\n+                \"value\": 10.0,\n+                \"raw\": \"10\",\n+                \"regex\": null,\n+                \"bigint\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 22\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 24\n+                  }\n+                },\n+                \"range\": [\n+                  63,\n+                  65\n+                ]\n+              },\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 18\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 24\n+                }\n+              },\n+              \"range\": [\n+                59,\n+                65\n+              ]\n+            },\n+            \"update\": {\n+              \"type\": \"UpdateExpression\",\n+              \"operator\": \"++\",\n+              \"argument\": {\n+                \"type\": \"Identifier\",\n+                \"name\": \"i\",\n+                \"typeAnnotation\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 27\n+                  }\n+                },\n+                \"range\": [\n+                  67,\n+                  68\n+                ]\n+              },\n+              \"prefix\": false,\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 26\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 29\n+                }\n+              },\n+              \"range\": [\n+                67,\n+                70\n+              ]\n+            },\n+            \"body\": {\n+              \"type\": \"BlockStatement\",\n+              \"body\": [\n+                {\n+                  \"type\": \"ExpressionStatement\",\n+                  \"expression\": {\n+                    \"type\": \"AssignmentExpression\",\n+                    \"operator\": \"+=\",\n+                    \"left\": {\n+                      \"type\": \"Identifier\",\n+                      \"name\": \"x\",\n+                      \"typeAnnotation\": null,\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 4,\n+                          \"column\": 4\n+                        },\n+                        \"end\": {\n+                          \"line\": 4,\n+                          \"column\": 5\n+                        }\n+                      },\n+                      \"range\": [\n+                        78,\n+                        79\n+                      ]\n+                    },\n+                    \"right\": {\n+                      \"type\": \"Identifier\",\n+                      \"name\": \"i\",\n+                      \"typeAnnotation\": null,\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 4,\n+                          \"column\": 9\n+                        },\n+                        \"end\": {\n+                          \"line\": 4,\n+                          \"column\": 10\n+                        }\n+                      },\n+                      \"range\": [\n+                        83,\n+                        84\n+                      ]\n+                    },\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 4,\n+                        \"column\": 4\n+                      },\n+                      \"end\": {\n+                        \"line\": 4,\n+                        \"column\": 10\n+                      }\n+                    },\n+                    \"range\": [\n+                      78,\n+                      84\n+                    ]\n+                  },\n+                  \"directive\": null,\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 4,\n+                      \"column\": 4\n+                    },\n+                    \"end\": {\n+                      \"line\": 4,\n+                      \"column\": 11\n+                    }\n+                  },\n+                  \"range\": [\n+                    78,\n+                    85\n+                  ]\n+                }\n+              ],\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 31\n+                },\n+                \"end\": {\n+                  \"line\": 5,\n+                  \"column\": 3\n+                }\n+              },\n+              \"range\": [\n+                72,\n+                89\n+              ]\n+            },\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 3,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 5,\n+                \"column\": 3\n+              }\n+            },\n+            \"range\": [\n+              43,\n+              89\n+            ]\n+          },\n+          {\n+            \"type\": \"ReturnStatement\",\n+            \"argument\": {\n+              \"type\": \"Identifier\",\n+              \"name\": \"x\",\n+              \"typeAnnotation\": null,\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 6,\n+                  \"column\": 9\n+                },\n+                \"end\": {\n+                  \"line\": 6,\n+                  \"column\": 10\n+                }\n+              },\n+              \"range\": [\n+                99,\n+                100\n+              ]\n+            },\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 6,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 6,\n+                \"column\": 11\n+              }\n+            },\n+            \"range\": [\n+              92,\n+              101\n+            ]\n+          }\n+        ],\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 26\n+          },\n+          \"end\": {\n+            \"line\": 7,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          26,\n+          103\n+        ]\n+      },\n+      \"generator\": false,\n+      \"async\": false,\n+      \"loc\": null,\n+      \"range\": null,\n+      \"loc\": {\n+        \"source\": null,\n+        \"start\": {\n+          \"line\": 1,\n+          \"column\": 0\n+        },\n+        \"end\": {\n+          \"line\": 7,\n+          \"column\": 1\n+        }\n+      },\n+      \"range\": [\n+        0,\n+        103\n+      ]\n+    }\n+  ],\n+  \"sourceType\": \"script\",\n+  \"loc\": {\n+    \"source\": null,\n+    \"start\": {\n+      \"line\": 1,\n+      \"column\": 0\n+    },\n+    \"end\": {\n+      \"line\": 7,\n+      \"column\": 1\n+    }\n+  },\n+  \"range\": [\n+    0,\n+    103\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/snapshots/react_estree__tests__fixtures@import.json.snap",
                "git_diff": "@@ -0,0 +1,213 @@\n+---\n+source: crates/react_estree/src/lib.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{serialized}\\\")\"\n+input_file: crates/react_estree/src/fixtures/import.json\n+---\n+Input:\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 1,\n+        \"column\": 26\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"ImportDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 26\n+          }\n+        },\n+        \"specifiers\": [\n+          {\n+            \"type\": \"ImportDefaultSpecifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 7\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 12\n+              }\n+            },\n+            \"local\": {\n+              \"type\": \"Identifier\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 1,\n+                  \"column\": 7\n+                },\n+                \"end\": {\n+                  \"line\": 1,\n+                  \"column\": 12\n+                }\n+              },\n+              \"name\": \"React\",\n+              \"typeAnnotation\": null,\n+              \"optional\": false,\n+              \"range\": [\n+                7,\n+                12\n+              ]\n+            },\n+            \"range\": [\n+              7,\n+              12\n+            ]\n+          }\n+        ],\n+        \"source\": {\n+          \"type\": \"Literal\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 25\n+            }\n+          },\n+          \"value\": \"react\",\n+          \"range\": [\n+            18,\n+            25\n+          ],\n+          \"raw\": \"'react'\"\n+        },\n+        \"attributes\": [],\n+        \"importKind\": \"value\",\n+        \"range\": [\n+          0,\n+          26\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      0,\n+      26\n+    ],\n+    \"sourceType\": \"module\"\n+  }\n+\n+Output:\n+{\n+  \"type\": \"Program\",\n+  \"body\": [\n+    {\n+      \"type\": \"ImportDeclaration\",\n+      \"specifiers\": [\n+        {\n+          \"type\": \"ImportDefaultSpecifier\",\n+          \"local\": {\n+            \"type\": \"Identifier\",\n+            \"name\": \"React\",\n+            \"typeAnnotation\": null,\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 7\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 12\n+              }\n+            },\n+            \"range\": [\n+              7,\n+              12\n+            ]\n+          },\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 7\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 12\n+            }\n+          },\n+          \"range\": [\n+            7,\n+            12\n+          ]\n+        }\n+      ],\n+      \"source\": {\n+        \"type\": \"Literal\",\n+        \"value\": \"react\",\n+        \"raw\": \"'react'\",\n+        \"regex\": null,\n+        \"bigint\": null,\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 18\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 25\n+          }\n+        },\n+        \"range\": [\n+          18,\n+          25\n+        ]\n+      },\n+      \"loc\": {\n+        \"source\": null,\n+        \"start\": {\n+          \"line\": 1,\n+          \"column\": 0\n+        },\n+        \"end\": {\n+          \"line\": 1,\n+          \"column\": 26\n+        }\n+      },\n+      \"range\": [\n+        0,\n+        26\n+      ]\n+    }\n+  ],\n+  \"sourceType\": \"module\",\n+  \"loc\": {\n+    \"source\": null,\n+    \"start\": {\n+      \"line\": 1,\n+      \"column\": 0\n+    },\n+    \"end\": {\n+      \"line\": 1,\n+      \"column\": 26\n+    }\n+  },\n+  \"range\": [\n+    0,\n+    26\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/snapshots/react_estree__tests__fixtures@simple.json.snap",
                "git_diff": "@@ -0,0 +1,379 @@\n+---\n+source: crates/react_estree/src/lib.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{serialized}\\\")\"\n+input_file: crates/react_estree/src/fixtures/simple.json\n+---\n+Input:\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 1,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 3,\n+        \"column\": 1\n+      }\n+    },\n+    \"range\": [\n+      0,\n+      51\n+    ],\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 3,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          0,\n+          51\n+        ],\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 18\n+            }\n+          },\n+          \"range\": [\n+            9,\n+            18\n+          ],\n+          \"name\": \"Component\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false\n+        },\n+        \"params\": [\n+          {\n+            \"type\": \"Identifier\",\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 1,\n+                \"column\": 19\n+              },\n+              \"end\": {\n+                \"line\": 1,\n+                \"column\": 24\n+              }\n+            },\n+            \"range\": [\n+              19,\n+              24\n+            ],\n+            \"name\": \"props\",\n+            \"typeAnnotation\": null,\n+            \"optional\": false\n+          }\n+        ],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 26\n+            },\n+            \"end\": {\n+              \"line\": 3,\n+              \"column\": 1\n+            }\n+          },\n+          \"range\": [\n+            26,\n+            51\n+          ],\n+          \"body\": [\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 2,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 2,\n+                  \"column\": 21\n+                }\n+              },\n+              \"range\": [\n+                30,\n+                49\n+              ],\n+              \"argument\": {\n+                \"type\": \"MemberExpression\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 20\n+                  }\n+                },\n+                \"range\": [\n+                  37,\n+                  48\n+                ],\n+                \"object\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 9\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 14\n+                    }\n+                  },\n+                  \"range\": [\n+                    37,\n+                    42\n+                  ],\n+                  \"name\": \"props\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false\n+                },\n+                \"property\": {\n+                  \"type\": \"Identifier\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 2,\n+                      \"column\": 15\n+                    },\n+                    \"end\": {\n+                      \"line\": 2,\n+                      \"column\": 20\n+                    }\n+                  },\n+                  \"range\": [\n+                    43,\n+                    48\n+                  ],\n+                  \"name\": \"value\",\n+                  \"typeAnnotation\": null,\n+                  \"optional\": false\n+                },\n+                \"computed\": false\n+              }\n+            }\n+          ]\n+        },\n+        \"async\": false,\n+        \"generator\": false,\n+        \"predicate\": null,\n+        \"expression\": false,\n+        \"returnType\": null,\n+        \"typeParameters\": null\n+      }\n+    ],\n+    \"comments\": [],\n+    \"errors\": []\n+  }\n+\n+Output:\n+{\n+  \"type\": \"Program\",\n+  \"body\": [\n+    {\n+      \"type\": \"FunctionDeclaration\",\n+      \"id\": {\n+        \"type\": \"Identifier\",\n+        \"name\": \"Component\",\n+        \"typeAnnotation\": null,\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 9\n+          },\n+          \"end\": {\n+            \"line\": 1,\n+            \"column\": 18\n+          }\n+        },\n+        \"range\": [\n+          9,\n+          18\n+        ]\n+      },\n+      \"params\": [\n+        {\n+          \"type\": \"Identifier\",\n+          \"name\": \"props\",\n+          \"typeAnnotation\": null,\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 1,\n+              \"column\": 19\n+            },\n+            \"end\": {\n+              \"line\": 1,\n+              \"column\": 24\n+            }\n+          },\n+          \"range\": [\n+            19,\n+            24\n+          ]\n+        }\n+      ],\n+      \"body\": {\n+        \"type\": \"BlockStatement\",\n+        \"body\": [\n+          {\n+            \"type\": \"ReturnStatement\",\n+            \"argument\": {\n+              \"type\": \"MemberExpression\",\n+              \"object\": {\n+                \"type\": \"Identifier\",\n+                \"name\": \"props\",\n+                \"typeAnnotation\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 14\n+                  }\n+                },\n+                \"range\": [\n+                  37,\n+                  42\n+                ]\n+              },\n+              \"property\": {\n+                \"type\": \"Identifier\",\n+                \"name\": \"value\",\n+                \"typeAnnotation\": null,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 2,\n+                    \"column\": 15\n+                  },\n+                  \"end\": {\n+                    \"line\": 2,\n+                    \"column\": 20\n+                  }\n+                },\n+                \"range\": [\n+                  43,\n+                  48\n+                ]\n+              },\n+              \"computed\": false,\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 2,\n+                  \"column\": 9\n+                },\n+                \"end\": {\n+                  \"line\": 2,\n+                  \"column\": 20\n+                }\n+              },\n+              \"range\": [\n+                37,\n+                48\n+              ]\n+            },\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 2,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 2,\n+                \"column\": 21\n+              }\n+            },\n+            \"range\": [\n+              30,\n+              49\n+            ]\n+          }\n+        ],\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 1,\n+            \"column\": 26\n+          },\n+          \"end\": {\n+            \"line\": 3,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          26,\n+          51\n+        ]\n+      },\n+      \"generator\": false,\n+      \"async\": false,\n+      \"loc\": null,\n+      \"range\": null,\n+      \"loc\": {\n+        \"source\": null,\n+        \"start\": {\n+          \"line\": 1,\n+          \"column\": 0\n+        },\n+        \"end\": {\n+          \"line\": 3,\n+          \"column\": 1\n+        }\n+      },\n+      \"range\": [\n+        0,\n+        51\n+      ]\n+    }\n+  ],\n+  \"sourceType\": \"module\",\n+  \"loc\": {\n+    \"source\": null,\n+    \"start\": {\n+      \"line\": 1,\n+      \"column\": 0\n+    },\n+    \"end\": {\n+      \"line\": 3,\n+      \"column\": 1\n+    }\n+  },\n+  \"range\": [\n+    0,\n+    51\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/snapshots/react_estree__tests__fixtures@test.json.snap",
                "git_diff": "@@ -0,0 +1,708 @@\n+---\n+source: crates/react_estree/src/lib.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{serialized}\\\")\"\n+input_file: crates/react_estree/src/fixtures/test.json\n+---\n+Input:\n+{\n+    \"type\": \"Program\",\n+    \"loc\": {\n+      \"source\": null,\n+      \"start\": {\n+        \"line\": 2,\n+        \"column\": 0\n+      },\n+      \"end\": {\n+        \"line\": 4,\n+        \"column\": 1\n+      }\n+    },\n+    \"body\": [\n+      {\n+        \"type\": \"FunctionDeclaration\",\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 2,\n+            \"column\": 0\n+          },\n+          \"end\": {\n+            \"line\": 4,\n+            \"column\": 1\n+          }\n+        },\n+        \"id\": {\n+          \"type\": \"Identifier\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 2,\n+              \"column\": 9\n+            },\n+            \"end\": {\n+              \"line\": 2,\n+              \"column\": 12\n+            }\n+          },\n+          \"name\": \"foo\",\n+          \"typeAnnotation\": null,\n+          \"optional\": false,\n+          \"range\": [\n+            10,\n+            13\n+          ]\n+        },\n+        \"params\": [],\n+        \"body\": {\n+          \"type\": \"BlockStatement\",\n+          \"loc\": {\n+            \"source\": null,\n+            \"start\": {\n+              \"line\": 2,\n+              \"column\": 15\n+            },\n+            \"end\": {\n+              \"line\": 4,\n+              \"column\": 1\n+            }\n+          },\n+          \"body\": [\n+            {\n+              \"type\": \"ReturnStatement\",\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 2\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 36\n+                }\n+              },\n+              \"argument\": {\n+                \"type\": \"JSXElement\",\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 36\n+                  }\n+                },\n+                \"openingElement\": {\n+                  \"type\": \"JSXOpeningElement\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 9\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    }\n+                  },\n+                  \"name\": {\n+                    \"type\": \"JSXMemberExpression\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 10\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 17\n+                      }\n+                    },\n+                    \"object\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 10\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 13\n+                        }\n+                      },\n+                      \"name\": \"Foo\",\n+                      \"range\": [\n+                        28,\n+                        31\n+                      ]\n+                    },\n+                    \"property\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 14\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 17\n+                        }\n+                      },\n+                      \"name\": \"Bar\",\n+                      \"range\": [\n+                        32,\n+                        35\n+                      ]\n+                    },\n+                    \"range\": [\n+                      28,\n+                      35\n+                    ]\n+                  },\n+                  \"attributes\": [\n+                    {\n+                      \"type\": \"JSXAttribute\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 18\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 24\n+                        }\n+                      },\n+                      \"name\": {\n+                        \"type\": \"JSXIdentifier\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 3,\n+                            \"column\": 18\n+                          },\n+                          \"end\": {\n+                            \"line\": 3,\n+                            \"column\": 19\n+                          }\n+                        },\n+                        \"name\": \"a\",\n+                        \"range\": [\n+                          36,\n+                          37\n+                        ]\n+                      },\n+                      \"value\": {\n+                        \"type\": \"JSXExpressionContainer\",\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 3,\n+                            \"column\": 20\n+                          },\n+                          \"end\": {\n+                            \"line\": 3,\n+                            \"column\": 24\n+                          }\n+                        },\n+                        \"expression\": {\n+                          \"type\": \"Literal\",\n+                          \"loc\": {\n+                            \"source\": null,\n+                            \"start\": {\n+                              \"line\": 3,\n+                              \"column\": 21\n+                            },\n+                            \"end\": {\n+                              \"line\": 3,\n+                              \"column\": 23\n+                            }\n+                          },\n+                          \"value\": 10,\n+                          \"range\": [\n+                            39,\n+                            41\n+                          ],\n+                          \"raw\": \"10\"\n+                        },\n+                        \"range\": [\n+                          38,\n+                          42\n+                        ]\n+                      },\n+                      \"range\": [\n+                        36,\n+                        42\n+                      ]\n+                    }\n+                  ],\n+                  \"selfClosing\": false,\n+                  \"range\": [\n+                    27,\n+                    44\n+                  ]\n+                },\n+                \"children\": [],\n+                \"closingElement\": {\n+                  \"type\": \"JSXClosingElement\",\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 26\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 36\n+                    }\n+                  },\n+                  \"name\": {\n+                    \"type\": \"JSXMemberExpression\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 28\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 35\n+                      }\n+                    },\n+                    \"object\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 28\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 31\n+                        }\n+                      },\n+                      \"name\": \"Foo\",\n+                      \"range\": [\n+                        46,\n+                        49\n+                      ]\n+                    },\n+                    \"property\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 32\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 35\n+                        }\n+                      },\n+                      \"name\": \"Bar\",\n+                      \"range\": [\n+                        50,\n+                        53\n+                      ]\n+                    },\n+                    \"range\": [\n+                      46,\n+                      53\n+                    ]\n+                  },\n+                  \"range\": [\n+                    44,\n+                    54\n+                  ]\n+                },\n+                \"range\": [\n+                  27,\n+                  54\n+                ]\n+              },\n+              \"range\": [\n+                20,\n+                54\n+              ]\n+            }\n+          ],\n+          \"range\": [\n+            16,\n+            56\n+          ]\n+        },\n+        \"typeParameters\": null,\n+        \"returnType\": null,\n+        \"predicate\": null,\n+        \"generator\": false,\n+        \"async\": false,\n+        \"range\": [\n+          1,\n+          56\n+        ]\n+      }\n+    ],\n+    \"comments\": [],\n+    \"interpreter\": null,\n+    \"range\": [\n+      1,\n+      56\n+    ],\n+    \"sourceType\": \"script\"\n+  }\n+\n+Output:\n+{\n+  \"type\": \"Program\",\n+  \"body\": [\n+    {\n+      \"type\": \"FunctionDeclaration\",\n+      \"id\": {\n+        \"type\": \"Identifier\",\n+        \"name\": \"foo\",\n+        \"typeAnnotation\": null,\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 2,\n+            \"column\": 9\n+          },\n+          \"end\": {\n+            \"line\": 2,\n+            \"column\": 12\n+          }\n+        },\n+        \"range\": [\n+          10,\n+          13\n+        ]\n+      },\n+      \"params\": [],\n+      \"body\": {\n+        \"type\": \"BlockStatement\",\n+        \"body\": [\n+          {\n+            \"type\": \"ReturnStatement\",\n+            \"argument\": {\n+              \"type\": \"JSXElement\",\n+              \"openingElement\": {\n+                \"type\": \"JSXOpeningElement\",\n+                \"name\": {\n+                  \"type\": \"JSXMemberExpression\",\n+                  \"object\": {\n+                    \"type\": \"JSXIdentifier\",\n+                    \"name\": \"Foo\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 10\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 13\n+                      }\n+                    },\n+                    \"range\": [\n+                      28,\n+                      31\n+                    ]\n+                  },\n+                  \"property\": {\n+                    \"type\": \"JSXIdentifier\",\n+                    \"name\": \"Bar\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 14\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 17\n+                      }\n+                    },\n+                    \"range\": [\n+                      32,\n+                      35\n+                    ]\n+                  },\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 10\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 17\n+                    }\n+                  },\n+                  \"range\": [\n+                    28,\n+                    35\n+                  ]\n+                },\n+                \"attributes\": [\n+                  {\n+                    \"type\": \"JSXAttribute\",\n+                    \"name\": {\n+                      \"type\": \"JSXIdentifier\",\n+                      \"name\": \"a\",\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 18\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 19\n+                        }\n+                      },\n+                      \"range\": [\n+                        36,\n+                        37\n+                      ]\n+                    },\n+                    \"value\": {\n+                      \"type\": \"JSXExpressionContainer\",\n+                      \"expression\": {\n+                        \"type\": \"Literal\",\n+                        \"value\": 10.0,\n+                        \"raw\": \"10\",\n+                        \"regex\": null,\n+                        \"bigint\": null,\n+                        \"loc\": {\n+                          \"source\": null,\n+                          \"start\": {\n+                            \"line\": 3,\n+                            \"column\": 21\n+                          },\n+                          \"end\": {\n+                            \"line\": 3,\n+                            \"column\": 23\n+                          }\n+                        },\n+                        \"range\": [\n+                          39,\n+                          41\n+                        ]\n+                      },\n+                      \"loc\": {\n+                        \"source\": null,\n+                        \"start\": {\n+                          \"line\": 3,\n+                          \"column\": 20\n+                        },\n+                        \"end\": {\n+                          \"line\": 3,\n+                          \"column\": 24\n+                        }\n+                      },\n+                      \"range\": [\n+                        38,\n+                        42\n+                      ]\n+                    },\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 18\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 24\n+                      }\n+                    },\n+                    \"range\": [\n+                      36,\n+                      42\n+                    ]\n+                  }\n+                ],\n+                \"selfClosing\": false,\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 9\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  }\n+                },\n+                \"range\": [\n+                  27,\n+                  44\n+                ]\n+              },\n+              \"children\": [],\n+              \"closingElement\": {\n+                \"type\": \"JSXClosingElement\",\n+                \"name\": {\n+                  \"type\": \"JSXMemberExpression\",\n+                  \"object\": {\n+                    \"type\": \"JSXIdentifier\",\n+                    \"name\": \"Foo\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 28\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 31\n+                      }\n+                    },\n+                    \"range\": [\n+                      46,\n+                      49\n+                    ]\n+                  },\n+                  \"property\": {\n+                    \"type\": \"JSXIdentifier\",\n+                    \"name\": \"Bar\",\n+                    \"loc\": {\n+                      \"source\": null,\n+                      \"start\": {\n+                        \"line\": 3,\n+                        \"column\": 32\n+                      },\n+                      \"end\": {\n+                        \"line\": 3,\n+                        \"column\": 35\n+                      }\n+                    },\n+                    \"range\": [\n+                      50,\n+                      53\n+                    ]\n+                  },\n+                  \"loc\": {\n+                    \"source\": null,\n+                    \"start\": {\n+                      \"line\": 3,\n+                      \"column\": 28\n+                    },\n+                    \"end\": {\n+                      \"line\": 3,\n+                      \"column\": 35\n+                    }\n+                  },\n+                  \"range\": [\n+                    46,\n+                    53\n+                  ]\n+                },\n+                \"loc\": {\n+                  \"source\": null,\n+                  \"start\": {\n+                    \"line\": 3,\n+                    \"column\": 26\n+                  },\n+                  \"end\": {\n+                    \"line\": 3,\n+                    \"column\": 36\n+                  }\n+                },\n+                \"range\": [\n+                  44,\n+                  54\n+                ]\n+              },\n+              \"loc\": {\n+                \"source\": null,\n+                \"start\": {\n+                  \"line\": 3,\n+                  \"column\": 9\n+                },\n+                \"end\": {\n+                  \"line\": 3,\n+                  \"column\": 36\n+                }\n+              },\n+              \"range\": [\n+                27,\n+                54\n+              ]\n+            },\n+            \"loc\": {\n+              \"source\": null,\n+              \"start\": {\n+                \"line\": 3,\n+                \"column\": 2\n+              },\n+              \"end\": {\n+                \"line\": 3,\n+                \"column\": 36\n+              }\n+            },\n+            \"range\": [\n+              20,\n+              54\n+            ]\n+          }\n+        ],\n+        \"loc\": {\n+          \"source\": null,\n+          \"start\": {\n+            \"line\": 2,\n+            \"column\": 15\n+          },\n+          \"end\": {\n+            \"line\": 4,\n+            \"column\": 1\n+          }\n+        },\n+        \"range\": [\n+          16,\n+          56\n+        ]\n+      },\n+      \"generator\": false,\n+      \"async\": false,\n+      \"loc\": null,\n+      \"range\": null,\n+      \"loc\": {\n+        \"source\": null,\n+        \"start\": {\n+          \"line\": 2,\n+          \"column\": 0\n+        },\n+        \"end\": {\n+          \"line\": 4,\n+          \"column\": 1\n+        }\n+      },\n+      \"range\": [\n+        1,\n+        56\n+      ]\n+    }\n+  ],\n+  \"sourceType\": \"script\",\n+  \"loc\": {\n+    \"source\": null,\n+    \"start\": {\n+      \"line\": 2,\n+      \"column\": 0\n+    },\n+    \"end\": {\n+      \"line\": 4,\n+      \"column\": 1\n+    }\n+  },\n+  \"range\": [\n+    1,\n+    56\n+  ]\n+}"
            },
            {
                "file": "compiler/crates/react_estree/src/visit.rs",
                "git_diff": "@@ -0,0 +1,537 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use crate::{\n+    AssignmentPropertyOrRestElement, AssignmentTarget, Class, ClassItem, ClassPrivateProperty,\n+    ClassProperty, Declaration, DeclarationOrExpression, ExportAllDeclaration,\n+    ExportDefaultDeclaration, ExportNamedDeclaration, Expression, ExpressionOrPrivateIdentifier,\n+    ExpressionOrSpread, ExpressionOrSuper, ForInInit, ForInit, Function, FunctionBody,\n+    FunctionDeclaration, Identifier, ImportDeclaration, ImportDeclarationSpecifier,\n+    ImportOrExportDeclaration, Literal, MethodDefinition, ModuleItem, Pattern, PrivateIdentifier,\n+    PrivateName, Program, Statement, StaticBlock, Super, SwitchCase, VariableDeclarator, _Literal,\n+};\n+\n+/// Trait for visiting an estree\n+#[allow(non_camel_case_types)]\n+#[deprecated]\n+pub trait Visitor_DEPRECATED<'ast> {\n+    fn visit_lvalue<F>(&mut self, f: F)\n+    where\n+        F: FnOnce(&mut Self),\n+    {\n+        f(self);\n+    }\n+\n+    fn visit_rvalue<F>(&mut self, f: F)\n+    where\n+        F: FnOnce(&mut Self),\n+    {\n+        f(self);\n+    }\n+\n+    fn visit_program(&mut self, program: &'ast Program) {\n+        self.default_visit_program(program)\n+    }\n+\n+    fn default_visit_program(&mut self, program: &'ast Program) {\n+        for item in &program.body {\n+            self.visit_module_item(item);\n+        }\n+    }\n+\n+    fn visit_function(&mut self, function: &'ast Function) {\n+        self.default_visit_function(function);\n+    }\n+\n+    fn default_visit_function(&mut self, function: &'ast Function) {\n+        self.visit_lvalue(|visitor| {\n+            for param in &function.params {\n+                visitor.visit_pattern(param);\n+            }\n+        });\n+        match &function.body {\n+            Some(FunctionBody::BlockStatement(body)) => {\n+                for stmt in &body.body {\n+                    self.visit_statement(stmt)\n+                }\n+            }\n+            Some(FunctionBody::Expression(body)) => self.visit_expression(body),\n+            None => {}\n+        }\n+    }\n+\n+    fn visit_module_item(&mut self, item: &'ast ModuleItem) {\n+        match item {\n+            ModuleItem::Statement(item) => self.visit_statement(item),\n+            ModuleItem::ImportOrExportDeclaration(item) => {\n+                self.visit_import_or_export_declaration(item)\n+            }\n+        }\n+    }\n+\n+    fn visit_import_or_export_declaration(&mut self, declaration: &'ast ImportOrExportDeclaration) {\n+        match declaration {\n+            ImportOrExportDeclaration::ImportDeclaration(declaration) => {\n+                self.visit_import_declaration(declaration);\n+            }\n+            ImportOrExportDeclaration::ExportAllDeclaration(declaration) => {\n+                self.visit_export_all_declaration(declaration);\n+            }\n+            ImportOrExportDeclaration::ExportDefaultDeclaration(declaration) => {\n+                self.visit_export_default_declaration(declaration);\n+            }\n+            ImportOrExportDeclaration::ExportNamedDeclaration(declaration) => {\n+                self.visit_export_named_declaration(declaration);\n+            }\n+        }\n+    }\n+\n+    fn visit_import_declaration(&mut self, declaration: &'ast ImportDeclaration) {\n+        self.visit_lvalue(|visitor| {\n+            for specifier in &declaration.specifiers {\n+                visitor.visit_import_declaration_specifier(specifier);\n+            }\n+        });\n+        self.visit_import_source(&declaration.source);\n+    }\n+\n+    fn visit_export_all_declaration(&mut self, declaration: &'ast ExportAllDeclaration) {\n+        self.visit_export_source(&declaration.source);\n+    }\n+\n+    fn visit_export_default_declaration(&mut self, declaration: &'ast ExportDefaultDeclaration) {\n+        match &declaration.declaration {\n+            DeclarationOrExpression::Declaration(declaration) => {\n+                self.visit_declaration(declaration)\n+            }\n+            DeclarationOrExpression::Expression(declaration) => self.visit_expression(declaration),\n+        }\n+    }\n+\n+    fn visit_export_named_declaration(&mut self, declaration: &'ast ExportNamedDeclaration) {\n+        if let Some(declaration) = &declaration.declaration {\n+            self.visit_declaration(declaration)\n+        }\n+        if let Some(source) = &declaration.source {\n+            self.visit_export_source(source);\n+        }\n+    }\n+\n+    fn visit_import_declaration_specifier(&mut self, specifier: &'ast ImportDeclarationSpecifier) {\n+        match specifier {\n+            ImportDeclarationSpecifier::ImportSpecifier(specifier) => {\n+                self.visit_identifier(&specifier.local);\n+            }\n+            ImportDeclarationSpecifier::ImportDefaultSpecifier(specifier) => {\n+                self.visit_identifier(&specifier.local);\n+            }\n+            ImportDeclarationSpecifier::ImportNamespaceSpecifier(specifier) => {\n+                self.visit_identifier(&specifier.local);\n+            }\n+        }\n+    }\n+\n+    fn visit_declaration(&mut self, declaration: &'ast Declaration) {\n+        self.default_visit_declaration(declaration);\n+    }\n+\n+    fn default_visit_declaration(&mut self, declaration: &'ast Declaration) {\n+        match declaration {\n+            Declaration::ClassDeclaration(declaration) => {\n+                self.visit_class(&declaration.class);\n+            }\n+            Declaration::FunctionDeclaration(declaration) => {\n+                self.visit_function_declaration(declaration);\n+            }\n+            Declaration::VariableDeclaration(declaration) => {\n+                for declarator in &declaration.declarations {\n+                    self.visit_variable_declarator(declarator)\n+                }\n+            }\n+            Declaration::TSTypeAliasDeclaration(_declaration) => {\n+                todo!(\"visit TSTypeAliasDeclaration\")\n+            }\n+        }\n+    }\n+\n+    fn visit_function_declaration(&mut self, declaration: &'ast FunctionDeclaration) {\n+        self.visit_function(&declaration.function);\n+    }\n+\n+    fn visit_statement(&mut self, stmt: &'ast Statement) {\n+        self.default_visit_statement(stmt);\n+    }\n+\n+    fn default_visit_statement(&mut self, stmt: &'ast Statement) {\n+        match stmt {\n+            Statement::BlockStatement(stmt) => {\n+                for stmt in &stmt.body {\n+                    self.visit_statement(stmt)\n+                }\n+            }\n+            Statement::BreakStatement(_stmt) => {\n+                // todo\n+            }\n+            Statement::ContinueStatement(_stmt) => {\n+                // todo\n+            }\n+            Statement::DebuggerStatement(_stmt) => {\n+                // todo\n+            }\n+            Statement::ClassDeclaration(stmt) => {\n+                self.visit_class(&stmt.class);\n+            }\n+            Statement::DoWhileStatement(stmt) => {\n+                self.visit_statement(&stmt.body);\n+                self.visit_expression(&stmt.test);\n+            }\n+            Statement::EmptyStatement(_stmt) => {\n+                // nothing to do\n+            }\n+            Statement::ExpressionStatement(stmt) => {\n+                self.visit_expression(&stmt.expression);\n+            }\n+            Statement::ForInStatement(stmt) => {\n+                self.visit_for_in_init(&stmt.left);\n+                self.visit_expression(&stmt.right);\n+                self.visit_statement(&stmt.body);\n+            }\n+            Statement::ForOfStatement(stmt) => {\n+                self.visit_for_in_init(&stmt.left);\n+                self.visit_expression(&stmt.right);\n+                self.visit_statement(&stmt.body);\n+            }\n+            Statement::ForStatement(stmt) => {\n+                if let Some(init) = &stmt.init {\n+                    self.visit_for_init(init);\n+                }\n+                if let Some(test) = &stmt.test {\n+                    self.visit_expression(test);\n+                }\n+                if let Some(update) = &stmt.update {\n+                    self.visit_expression(update);\n+                }\n+                self.visit_statement(&stmt.body);\n+            }\n+            Statement::FunctionDeclaration(stmt) => {\n+                self.visit_function_declaration(stmt);\n+            }\n+            Statement::IfStatement(stmt) => {\n+                self.visit_expression(&stmt.test);\n+                self.visit_statement(&stmt.consequent);\n+                if let Some(alternate) = &stmt.alternate {\n+                    self.visit_statement(alternate);\n+                }\n+            }\n+            Statement::LabeledStatement(stmt) => {\n+                self.visit_statement(&stmt.body);\n+            }\n+            Statement::ReturnStatement(stmt) => {\n+                if let Some(argument) = &stmt.argument {\n+                    self.visit_expression(argument);\n+                }\n+            }\n+            Statement::SwitchStatement(stmt) => {\n+                self.visit_expression(&stmt.discriminant);\n+                for case_ in &stmt.cases {\n+                    self.visit_case(case_);\n+                }\n+            }\n+            Statement::ThrowStatement(stmt) => {\n+                self.visit_expression(&stmt.argument);\n+            }\n+            Statement::TryStatement(stmt) => {\n+                for item in &stmt.block.body {\n+                    self.visit_statement(item);\n+                }\n+                if let Some(handler) = &stmt.handler {\n+                    if let Some(param) = &handler.param {\n+                        self.visit_lvalue(|visitor| visitor.visit_pattern(param));\n+                    }\n+                    for item in &handler.body.body {\n+                        self.visit_statement(item);\n+                    }\n+                }\n+                if let Some(finalizer) = &stmt.finalizer {\n+                    for item in &finalizer.body {\n+                        self.visit_statement(item);\n+                    }\n+                }\n+            }\n+            Statement::VariableDeclaration(stmt) => {\n+                for decl in &stmt.declarations {\n+                    self.visit_variable_declarator(decl);\n+                }\n+            }\n+            Statement::WhileStatement(stmt) => {\n+                self.visit_expression(&stmt.test);\n+                self.visit_statement(&stmt.body);\n+            }\n+            Statement::WithStatement(stmt) => {\n+                self.visit_expression(&stmt.object);\n+                self.visit_statement(&stmt.body);\n+            }\n+            Statement::TSTypeAliasDeclaration(_stmt) => {\n+                todo!(\"visit TSTypeAliasDeclaration\")\n+            }\n+        }\n+    }\n+\n+    fn visit_class(&mut self, class: &'ast Class) {\n+        if let Some(id) = &class.id {\n+            self.visit_identifier(id)\n+        }\n+        if let Some(super_class) = &class.super_class {\n+            self.visit_expression(super_class);\n+        }\n+        for item in &class.body.body {\n+            match item {\n+                ClassItem::MethodDefinition(item) => self.visit_method_definition(item),\n+                ClassItem::ClassProperty(item) => {\n+                    self.visit_class_property(item);\n+                }\n+                ClassItem::ClassPrivateProperty(item) => {\n+                    self.visit_class_private_property(item);\n+                }\n+                ClassItem::StaticBlock(item) => {\n+                    self.visit_static_block(item);\n+                }\n+            }\n+        }\n+    }\n+\n+    fn visit_class_property(&mut self, property: &'ast ClassProperty) {\n+        self.visit_expression(&property.key);\n+        if let Some(value) = &property.value {\n+            self.visit_expression(value)\n+        }\n+    }\n+\n+    fn visit_class_private_property(&mut self, property: &'ast ClassPrivateProperty) {\n+        match &property.key {\n+            ExpressionOrPrivateIdentifier::Expression(key) => self.visit_expression(key),\n+            ExpressionOrPrivateIdentifier::PrivateIdentifier(key) => {\n+                self.visit_private_identifier(key)\n+            }\n+            ExpressionOrPrivateIdentifier::PrivateName(key) => self.visit_private_name(key),\n+        }\n+        if let Some(value) = &property.value {\n+            self.visit_expression(value)\n+        }\n+    }\n+\n+    fn visit_static_block(&mut self, property: &'ast StaticBlock) {\n+        for stmt in &property.body {\n+            self.visit_statement(stmt)\n+        }\n+    }\n+\n+    fn visit_method_definition(&mut self, method: &'ast MethodDefinition) {\n+        self.default_visit_method_definition(method);\n+    }\n+\n+    fn default_visit_method_definition(&mut self, method: &'ast MethodDefinition) {\n+        self.visit_expression(&method.key);\n+        self.visit_function(&method.value.function);\n+    }\n+\n+    fn visit_case(&mut self, case_: &'ast SwitchCase) {\n+        if let Some(test) = &case_.test {\n+            self.visit_expression(test);\n+        }\n+        for stmt in &case_.consequent {\n+            self.visit_statement(stmt)\n+        }\n+    }\n+\n+    fn visit_for_init(&mut self, init: &'ast ForInit) {\n+        match init {\n+            ForInit::Expression(init) => {\n+                self.visit_expression(init);\n+            }\n+            ForInit::VariableDeclaration(init) => {\n+                for decl in &init.declarations {\n+                    self.visit_variable_declarator(decl);\n+                }\n+            }\n+        }\n+    }\n+\n+    fn visit_for_in_init(&mut self, init: &'ast ForInInit) {\n+        match init {\n+            ForInInit::Pattern(init) => {\n+                self.visit_pattern(init);\n+            }\n+            ForInInit::VariableDeclaration(init) => {\n+                for decl in &init.declarations {\n+                    self.visit_variable_declarator(decl);\n+                }\n+            }\n+        }\n+    }\n+\n+    fn visit_pattern(&mut self, pattern: &'ast Pattern) {\n+        match pattern {\n+            Pattern::Identifier(pattern) => self.visit_identifier(pattern),\n+            Pattern::ArrayPattern(pattern) => {\n+                for element in &pattern.elements {\n+                    if let Some(element) = element {\n+                        self.visit_pattern(element);\n+                    }\n+                }\n+            }\n+            Pattern::ObjectPattern(pattern) => {\n+                for property in &pattern.properties {\n+                    match property {\n+                        AssignmentPropertyOrRestElement::AssignmentProperty(property) => {\n+                            self.visit_pattern(&property.value);\n+                        }\n+                        AssignmentPropertyOrRestElement::RestElement(property) => {\n+                            self.visit_pattern(&property.argument);\n+                        }\n+                    }\n+                }\n+            }\n+            Pattern::RestElement(pattern) => self.visit_pattern(&pattern.argument),\n+            Pattern::AssignmentPattern(pattern) => {\n+                self.visit_pattern(&pattern.left);\n+                self.visit_rvalue(|visitor| {\n+                    visitor.visit_expression(&pattern.right);\n+                });\n+            }\n+        }\n+    }\n+\n+    fn visit_variable_declarator(&mut self, decl: &'ast VariableDeclarator) {\n+        self.visit_lvalue(|visitor| {\n+            visitor.visit_pattern(&decl.id);\n+        });\n+        if let Some(init) = &decl.init {\n+            self.visit_expression(init);\n+        }\n+    }\n+\n+    fn visit_assignment_target(&mut self, target: &'ast AssignmentTarget) {\n+        match target {\n+            AssignmentTarget::Expression(target) => {\n+                self.visit_expression(target);\n+            }\n+            AssignmentTarget::Pattern(target) => self.visit_pattern(target),\n+        }\n+    }\n+\n+    fn visit_expression(&mut self, expr: &'ast Expression) {\n+        self.default_visit_expression(expr);\n+    }\n+\n+    fn default_visit_expression(&mut self, expr: &'ast Expression) {\n+        match expr {\n+            Expression::ArrayExpression(expr) => {\n+                for item in &expr.elements {\n+                    match item {\n+                        Some(ExpressionOrSpread::SpreadElement(item)) => {\n+                            self.visit_expression(&item.argument)\n+                        }\n+                        Some(ExpressionOrSpread::Expression(item)) => self.visit_expression(item),\n+                        _ => {}\n+                    }\n+                }\n+            }\n+            Expression::AssignmentExpression(expr) => {\n+                self.visit_lvalue(|visitor| visitor.visit_assignment_target(&expr.left));\n+                self.visit_expression(&expr.right);\n+            }\n+            Expression::BinaryExpression(expr) => {\n+                self.visit_expression(&expr.left);\n+                self.visit_expression(&expr.right);\n+            }\n+            Expression::Identifier(expr) => {\n+                self.visit_identifier(expr);\n+            }\n+            Expression::Literal(expr) => self.visit_literal(expr),\n+            Expression::FunctionExpression(expr) => self.visit_function(&expr.function),\n+            Expression::ArrowFunctionExpression(expr) => self.visit_function(&expr.function),\n+            Expression::MemberExpression(expr) => {\n+                match &expr.object {\n+                    ExpressionOrSuper::Super(object) => self.visit_super(object),\n+                    ExpressionOrSuper::Expression(object) => self.visit_expression(object),\n+                };\n+                if !expr.is_computed {\n+                    match &expr.property {\n+                        ExpressionOrPrivateIdentifier::Expression(property) => {\n+                            self.visit_expression(property)\n+                        }\n+                        ExpressionOrPrivateIdentifier::PrivateIdentifier(property) => {\n+                            self.visit_private_identifier(property);\n+                        }\n+                        ExpressionOrPrivateIdentifier::PrivateName(property) => {\n+                            self.visit_private_name(property);\n+                        }\n+                    }\n+                }\n+            }\n+            Expression::CallExpression(expr) => {\n+                match &expr.callee {\n+                    ExpressionOrSuper::Expression(callee) => self.visit_expression(callee),\n+                    ExpressionOrSuper::Super(callee) => self.visit_super(callee),\n+                }\n+                for arg in &expr.arguments {\n+                    match arg {\n+                        ExpressionOrSpread::Expression(arg) => self.visit_expression(arg),\n+                        ExpressionOrSpread::SpreadElement(arg) => {\n+                            self.visit_expression(&arg.argument)\n+                        }\n+                    }\n+                }\n+            }\n+            Expression::UpdateExpression(expr) => {\n+                self.visit_expression(&expr.argument);\n+            }\n+            Expression::BooleanLiteral(_)\n+            | Expression::NullLiteral(_)\n+            | Expression::StringLiteral(_)\n+            | Expression::NumericLiteral(_) => {\n+                // no-op\n+            }\n+            _ => {\n+                todo!(\"{:#?}\", expr)\n+            }\n+        }\n+    }\n+\n+    fn visit_super(&mut self, _super: &'ast Super) {\n+        todo!(\"Implement visit_super\")\n+    }\n+\n+    fn visit_private_identifier(&mut self, _identifier: &'ast PrivateIdentifier) {\n+        todo!(\"Implement visit_private_identifier()\")\n+    }\n+\n+    fn visit_private_name(&mut self, _identifier: &'ast PrivateName) {\n+        todo!(\"Implement visit_private_name()\")\n+    }\n+\n+    fn visit_identifier(&mut self, _identifier: &'ast Identifier) {\n+        todo!(\"Implement visit_identifier()\")\n+    }\n+\n+    fn visit_import_source(&mut self, literal: &'ast _Literal) {\n+        self.visit_any_literal(literal);\n+    }\n+\n+    fn visit_export_source(&mut self, literal: &'ast _Literal) {\n+        self.visit_any_literal(literal);\n+    }\n+\n+    fn visit_any_literal(&mut self, _literal: &'ast _Literal) {\n+        todo!(\"Implement visit_any_literal()\")\n+    }\n+\n+    fn visit_literal(&mut self, _literal: &'ast Literal) {\n+        todo!(\"Implement visit_literal()\")\n+    }\n+}"
            },
            {
                "file": "compiler/crates/react_estree_codegen/Cargo.toml",
                "git_diff": "@@ -0,0 +1,21 @@\n+[package]\n+name = \"react_estree_codegen\"\n+version = \"0.1.0\"\n+publish               = false\n+authors.workspace     = true\n+description.workspace = true\n+edition.workspace     = true\n+homepage.workspace    = true\n+keywords.workspace    = true\n+license.workspace     = true\n+repository.workspace  = true\n+\n+# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n+\n+[dependencies]\n+indexmap = { workspace = true }\n+prettyplease = { workspace = true }\n+quote = { workspace = true }\n+serde = { workspace = true }\n+serde_json = { workspace = true }\n+syn = { workspace = true }"
            },
            {
                "file": "compiler/crates/react_estree_codegen/README.md",
                "git_diff": "@@ -0,0 +1,4 @@\n+# react_estree_codegen\n+\n+This crate is a build dependency for `react_estree`, and contains codegen logic to produce Rust code to describe the ESTree format\n+given a JSON schema.\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_estree_codegen/src/codegen.rs",
                "git_diff": "@@ -0,0 +1,969 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use std::collections::HashSet;\n+\n+use indexmap::IndexMap;\n+use quote::__private::TokenStream;\n+use quote::{format_ident, quote};\n+use serde::{Deserialize, Serialize};\n+use syn::Type;\n+\n+/// Returns prettyplease-formatted Rust source for estree\n+pub fn estree() -> String {\n+    let src = include_str!(\"./ecmascript.json\");\n+    let grammar: Grammar = serde_json::from_str(src).unwrap();\n+    let raw = grammar.codegen().to_string();\n+\n+    let parsed = syn::parse_file(&raw).unwrap();\n+    format!(\n+        \"// {}generated\\n#![cfg_attr(rustfmt, rustfmt_skip)]\\n{}\",\n+        '\\u{0040}',\n+        prettyplease::unparse(&parsed)\n+    )\n+}\n+\n+/// Returns prettyplease-formatted Rust source for converting HermesParser results\n+/// into estree\n+pub fn estree_hermes() -> String {\n+    let src = include_str!(\"./ecmascript.json\");\n+    let grammar: Grammar = serde_json::from_str(src).unwrap();\n+    let raw = grammar.codegen_hermes().to_string();\n+\n+    let parsed = syn::parse_file(&raw).unwrap();\n+    format!(\n+        \"// {}generated\\n#![cfg_attr(rustfmt, rustfmt_skip)]\\n{}\",\n+        '\\u{0040}',\n+        prettyplease::unparse(&parsed)\n+    )\n+}\n+\n+#[derive(Serialize, Deserialize, Debug)]\n+#[serde(deny_unknown_fields)]\n+pub struct Grammar {\n+    pub objects: IndexMap<String, Object>,\n+    pub nodes: IndexMap<String, Node>,\n+    pub enums: IndexMap<String, Enum>,\n+    pub operators: IndexMap<String, Operator>,\n+}\n+\n+impl Grammar {\n+    pub fn codegen(self) -> TokenStream {\n+        let object_defs: Vec<_> = self\n+            .objects\n+            .iter()\n+            .map(|(name, object)| object.codegen(name))\n+            .collect();\n+        let object_visitors: Vec<_> = self\n+            .objects\n+            .iter()\n+            .filter_map(|(name, object)| {\n+                if object.visitor {\n+                    Some(object.codegen_visitor(name, &self))\n+                } else {\n+                    None\n+                }\n+            })\n+            .collect();\n+        let node_defs: Vec<_> = self\n+            .nodes\n+            .iter()\n+            .map(|(name, node)| node.codegen(name))\n+            .collect();\n+        let node_visitors: Vec<_> = self\n+            .nodes\n+            .iter()\n+            .map(|(name, node)| node.codegen_visitor(name, &self))\n+            .collect();\n+        let enum_defs: Vec<_> = self\n+            .enums\n+            .iter()\n+            .map(|(name, enum_)| enum_.codegen(name, &self.enums))\n+            .collect();\n+        let enum_visitors: Vec<_> = self\n+            .enums\n+            .iter()\n+            .map(|(name, enum_)| enum_.codegen_visitor(name))\n+            .collect();\n+        let operator_defs: Vec<_> = self\n+            .operators\n+            .iter()\n+            .map(|(name, operator)| operator.codegen(name))\n+            .collect();\n+\n+        quote! {\n+            #![allow(dead_code)]\n+            #![allow(unused_variables)]\n+            #![allow(non_snake_case)]\n+            #![allow(clippy::enum_variant_names)]\n+\n+            use std::num::NonZeroU32;\n+            use serde::ser::{Serializer, SerializeMap};\n+            use serde::{Serialize,Deserialize};\n+            use crate::{JsValue, Binding, SourceRange, Number, ESTreeNode};\n+\n+            #(#object_defs)*\n+\n+            #(#node_defs)*\n+\n+            #(#enum_defs)*\n+\n+            #(#operator_defs)*\n+\n+            pub trait Visitor {\n+                #(#object_visitors)*\n+\n+                #(#node_visitors)*\n+\n+                #(#enum_visitors)*\n+            }\n+        }\n+    }\n+\n+    pub fn codegen_hermes(self) -> TokenStream {\n+        let nodes: Vec<_> = self\n+            .nodes\n+            .iter()\n+            .filter(|(_, node)| !node.skip_hermes_codegen)\n+            .map(|(name, node)| node.codegen_hermes(name))\n+            .collect();\n+        let enums: Vec<_> = self\n+            .enums\n+            .iter()\n+            .map(|(name, enum_)| enum_.codegen_hermes(name, &self))\n+            .collect();\n+        let operators: Vec<_> = self\n+            .operators\n+            .iter()\n+            .map(|(name, operator)| operator.codegen_hermes(name))\n+            .collect();\n+\n+        quote! {\n+            #![allow(dead_code)]\n+            #![allow(unused_variables)]\n+            #![allow(clippy::enum_variant_names)]\n+\n+            use react_estree::*;\n+            use hermes::parser::{NodePtr, NodeKind, NodeLabel };\n+            use hermes::utf::{utf8_with_surrogates_to_string};\n+            use crate::generated_extension::*;\n+\n+            #(#nodes)*\n+\n+            #(#enums)*\n+\n+            #(#operators)*\n+        }\n+    }\n+}\n+\n+#[derive(Serialize, Deserialize, Debug)]\n+#[serde(deny_unknown_fields)]\n+pub struct Object {\n+    #[serde(default)]\n+    pub fields: IndexMap<String, Field>,\n+\n+    #[serde(default)]\n+    pub visitor: bool,\n+}\n+\n+impl Object {\n+    pub fn codegen(&self, name: &str) -> TokenStream {\n+        let name = format_ident!(\"{}\", name);\n+        let fields: Vec<_> = self\n+            .fields\n+            .iter()\n+            .map(|(name, field)| field.codegen(name))\n+            .collect();\n+\n+        quote! {\n+            #[derive(Serialize, Deserialize, Clone, Debug)]\n+            #[serde(deny_unknown_fields)]\n+            pub struct #name {\n+                #(#fields),*\n+            }\n+        }\n+    }\n+\n+    pub fn codegen_visitor(&self, name: &str, grammar: &Grammar) -> TokenStream {\n+        let visitor_name = format_ident!(\"visit_{}\", to_lower_snake_case(name));\n+        let name = format_ident!(\"{}\", name);\n+        let field_visitors: Vec<_> = self\n+            .fields\n+            .iter()\n+            .filter_map(|(name, field)| {\n+                let (type_name_str, type_kind) = parse_type(&field.type_).unwrap();\n+                if !grammar.nodes.contains_key(&type_name_str)\n+                    && !grammar.enums.contains_key(&type_name_str)\n+                {\n+                    return None;\n+                }\n+                let visitor_name = format_ident!(\"visit_{}\", to_lower_snake_case(&type_name_str));\n+                let field_name = format_ident!(\"{}\", name);\n+                Some(match type_kind {\n+                    TypeKind::Named => {\n+                        quote! {\n+                            self.#visitor_name(&ast.#field_name);\n+                        }\n+                    }\n+                    TypeKind::Option => {\n+                        quote! {\n+                            if let Some(#field_name) = &ast.#field_name {\n+                                self.#visitor_name(#field_name);\n+                            }\n+                        }\n+                    }\n+                    TypeKind::Vec => {\n+                        quote! {\n+                            for #field_name in &ast.#field_name {\n+                                self.#visitor_name(#field_name);\n+                            }\n+                        }\n+                    }\n+                    TypeKind::VecOfOption => {\n+                        quote! {\n+                            for #field_name in &ast.#field_name {\n+                                if let Some(#field_name) = #field_name {\n+                                    self.#visitor_name(#field_name);\n+                                }\n+                            }\n+                        }\n+                    }\n+                })\n+            })\n+            .collect();\n+        quote! {\n+            fn #visitor_name(&mut self, ast: &#name) {\n+                #(#field_visitors)*\n+            }\n+        }\n+    }\n+}\n+\n+#[derive(Serialize, Deserialize, Debug)]\n+#[serde(deny_unknown_fields)]\n+pub struct Node {\n+    #[serde(default)]\n+    #[serde(rename = \"type\")]\n+    pub type_: Option<String>,\n+\n+    #[serde(default)]\n+    pub fields: IndexMap<String, Field>,\n+\n+    #[serde(default)]\n+    pub skip_hermes_codegen: bool,\n+\n+    #[serde(default)]\n+    pub skip_hermes_enum_variant: bool,\n+\n+    #[serde(default)]\n+    #[serde(rename = \"TODO\")]\n+    pub todo: Option<String>,\n+}\n+\n+impl Node {\n+    pub fn codegen(&self, name: &str) -> TokenStream {\n+        let name_str = name;\n+        let name = format_ident!(\"{}\", name);\n+        let fields: Vec<_> = self\n+            .fields\n+            .iter()\n+            .map(|(name, field)| field.codegen_node(name))\n+            .collect();\n+\n+        let type_serializer = if let Some(type_) = &self.type_ {\n+            quote! {\n+                state.serialize_entry(\"type\", #type_)?;\n+            }\n+        } else {\n+            quote! {\n+                state.serialize_entry(\"type\", #name_str)?;\n+            }\n+        };\n+\n+        let mut field_serializers = Vec::with_capacity(self.fields.len()); // type, loc, range\n+        for (field_name_str, field) in &self.fields {\n+            if field.skip {\n+                continue;\n+            }\n+            let field_name = format_ident!(\"{}\", field_name_str);\n+            let serialized_field_name = field.rename.as_ref().unwrap_or(field_name_str);\n+            let serializer = if field.flatten {\n+                quote! {\n+                    Serialize::serialize(&self.#field_name, serde::__private::ser::FlatMapSerializer(&mut state))?;\n+                }\n+            } else {\n+                quote! {\n+                    state.serialize_entry(#serialized_field_name, &self.#field_name)?;\n+                }\n+            };\n+            field_serializers.push(serializer);\n+        }\n+\n+        quote! {\n+            #[derive(Deserialize, Clone, Debug)]\n+            pub struct #name {\n+                #(#fields,)*\n+\n+                #[serde(default)]\n+                pub loc: Option<SourceLocation>,\n+\n+                #[serde(default)]\n+                pub range: Option<SourceRange>,\n+            }\n+\n+            impl ESTreeNode for #name {}\n+\n+            impl Serialize for #name {\n+                fn serialize<S>(&self, serializer: S) -> Result<S::Ok, S::Error>\n+                where\n+                    S: Serializer,\n+                {\n+                    let mut state = serializer.serialize_map(None)?;\n+                    #type_serializer\n+                    #(#field_serializers)*\n+                    state.serialize_entry(\"loc\", &self.loc)?;\n+                    state.serialize_entry(\"range\", &self.range)?;\n+                    state.end()\n+                }\n+            }\n+        }\n+    }\n+\n+    pub fn codegen_visitor(&self, name: &str, grammar: &Grammar) -> TokenStream {\n+        let visitor_name = format_ident!(\"visit_{}\", to_lower_snake_case(name));\n+        let name = format_ident!(\"{}\", name);\n+        let field_visitors: Vec<_> = self\n+            .fields\n+            .iter()\n+            .filter_map(|(name, field)| {\n+                let (type_name_str, type_kind) = parse_type(&field.type_).unwrap();\n+                if (!grammar.objects.contains_key(&type_name_str)\n+                    || !grammar.objects.get(&type_name_str).unwrap().visitor)\n+                    && !grammar.nodes.contains_key(&type_name_str)\n+                    && !grammar.enums.contains_key(&type_name_str)\n+                {\n+                    return None;\n+                }\n+                let visitor_name = format_ident!(\"visit_{}\", to_lower_snake_case(&type_name_str));\n+                let field_name = format_ident!(\"{}\", name);\n+                Some(match type_kind {\n+                    TypeKind::Named => {\n+                        quote! {\n+                            self.#visitor_name(&ast.#field_name);\n+                        }\n+                    }\n+                    TypeKind::Option => {\n+                        quote! {\n+                            if let Some(#field_name) = &ast.#field_name {\n+                                self.#visitor_name(#field_name);\n+                            }\n+                        }\n+                    }\n+                    TypeKind::Vec => {\n+                        quote! {\n+                            for #field_name in &ast.#field_name {\n+                                self.#visitor_name(#field_name);\n+                            }\n+                        }\n+                    }\n+                    TypeKind::VecOfOption => {\n+                        quote! {\n+                            for #field_name in &ast.#field_name {\n+                                if let Some(#field_name) = #field_name {\n+                                    self.#visitor_name(#field_name);\n+                                }\n+                            }\n+                        }\n+                    }\n+                })\n+            })\n+            .collect();\n+        quote! {\n+            fn #visitor_name(&mut self, ast: &#name) {\n+                #(#field_visitors)*\n+            }\n+        }\n+    }\n+\n+    pub fn codegen_hermes(&self, name: &str) -> TokenStream {\n+        let name_str = name;\n+        let name = format_ident!(\"{}\", name);\n+        let field_names: Vec<_> = self\n+            .fields\n+            .iter()\n+            .map(|(name, _field)| format_ident!(\"{}\", name))\n+            .collect();\n+        let fields: Vec<_> = self\n+            .fields\n+            .iter()\n+            .map(|(name, field)| {\n+                let (type_name_str, type_kind) = parse_type(&field.type_).unwrap();\n+                let camelcase_name = field.rename.as_ref().unwrap_or(name);\n+                let field_name = format_ident!(\"{}\", name);\n+                let helper = format_ident!(\"hermes_get_{}_{}\", name_str, camelcase_name);\n+                let type_name = format_ident!(\"{}\", type_name_str);\n+                if field.skip || field.hermes_default {\n+                    return quote! {\n+                        let #field_name = Default::default();\n+                    };\n+                }\n+                if let Some(convert_with) = &field.hermes_convert_with {\n+                    let convert_with = format_ident!(\"{}\", convert_with);\n+                    return quote! {\n+                        let #field_name = #convert_with(cx, unsafe { hermes::parser::#helper(node) } );\n+                    }\n+                }\n+                match type_kind {\n+                    TypeKind::Named => {\n+                        match type_name_str.as_ref() {\n+                            \"bool\" => {\n+                                quote! {\n+                                    let #field_name = unsafe { hermes::parser::#helper(node) };\n+                                }\n+                            }\n+                            \"Number\" => {\n+                                quote! {\n+                                    let #field_name = convert_number(unsafe { hermes::parser::#helper(node) });\n+                                }\n+                            }\n+                            \"String\" => {\n+                                quote! {\n+                                    let #field_name = convert_string(cx, unsafe { hermes::parser::#helper(node) });\n+                                }\n+                            }\n+                            _ => {\n+                                quote! {\n+                                    let #field_name = #type_name::convert(cx, unsafe { hermes::parser::#helper(node) });\n+                                }\n+                            }\n+                        }\n+                    }\n+                    TypeKind::Option => {\n+                        match type_name_str.as_ref() {\n+                            \"String\" => {\n+                                quote! {\n+                                    let #field_name = convert_option_string(cx, unsafe { hermes::parser::#helper(node) });\n+                                }\n+                            }\n+                            _ => {\n+                                quote! {\n+                                    let #field_name = convert_option(unsafe { hermes::parser::#helper(node) }, |node| #type_name::convert(cx, node));\n+                                }\n+                            }\n+                        }\n+                    }\n+                    TypeKind::Vec => {\n+                        quote! {\n+                            let #field_name = convert_vec(unsafe { hermes::parser::#helper(node) }, |node| #type_name::convert(cx, node));\n+                        }\n+                    }\n+                    TypeKind::VecOfOption => {\n+                        quote! {\n+                            let #field_name = convert_vec_of_option(unsafe { hermes::parser::#helper(node) }, |node| #type_name::convert(cx, node));\n+                        }\n+                    }\n+                }\n+            })\n+            .collect();\n+\n+        let type_ = format_ident!(\"{}\", self.type_.as_ref().unwrap_or(&name_str.to_string()));\n+        quote! {\n+            impl FromHermes for #name {\n+                fn convert(cx: &mut Context, node: NodePtr) -> Self {\n+                    let node_ref = node.as_ref();\n+                    assert_eq!(node_ref.kind, NodeKind::#type_);\n+                    let range = convert_range(cx, node);\n+                    #(#fields)*\n+                    Self {\n+                        #(#field_names,)*\n+                        loc: None,\n+                        range: Some(range),\n+                    }\n+                }\n+            }\n+        }\n+    }\n+}\n+\n+#[derive(Serialize, Deserialize, Debug)]\n+#[serde(deny_unknown_fields)]\n+pub struct Field {\n+    // TODO: deserialize with `parse_type` into a custom type\n+    #[serde(rename = \"type\")]\n+    pub type_: String,\n+\n+    #[serde(default)]\n+    pub optional: bool,\n+\n+    #[serde(default)]\n+    pub flatten: bool,\n+\n+    #[serde(default)]\n+    pub rename: Option<String>,\n+\n+    #[serde(default)]\n+    pub skip: bool,\n+\n+    #[serde(default)]\n+    #[serde(rename = \"TODO\")]\n+    pub todo: Option<String>,\n+\n+    #[serde(default)]\n+    pub hermes_convert_with: Option<String>,\n+\n+    #[serde(default)]\n+    pub hermes_default: bool,\n+}\n+\n+impl Field {\n+    pub fn codegen(&self, name: &str) -> TokenStream {\n+        let name = format_ident!(\"{}\", name);\n+        parse_type(&self.type_).unwrap();\n+        let type_name: Type = syn::parse_str(&self.type_)\n+            .unwrap_or_else(|_| panic!(\"Expected a type name, got `{}`\", &self.type_));\n+\n+        let type_ = quote!(#type_name);\n+        let mut field = quote!(pub #name: #type_);\n+        if self.optional {\n+            field = quote! {\n+                #[serde(default)]\n+                #field\n+            }\n+        }\n+        if self.flatten {\n+            field = quote! {\n+                #[serde(flatten)]\n+                #field\n+            }\n+        }\n+        if self.skip {\n+            field = quote! {\n+                #[serde(skip)]\n+                #field\n+            }\n+        }\n+        if let Some(rename) = &self.rename {\n+            field = quote! {\n+                #[serde(rename = #rename)]\n+                #field\n+            }\n+        }\n+        field\n+    }\n+\n+    pub fn codegen_node(&self, name: &str) -> TokenStream {\n+        let name = format_ident!(\"{}\", name);\n+        parse_type(&self.type_).unwrap();\n+        let type_name: Type = syn::parse_str(&self.type_)\n+            .unwrap_or_else(|_| panic!(\"Expected a type name, got `{}`\", &self.type_));\n+        let type_ = quote!(#type_name);\n+        let mut field = quote!(pub #name: #type_);\n+        if self.optional {\n+            field = quote! {\n+                #[serde(default)]\n+                #field\n+            }\n+        }\n+        if self.flatten {\n+            field = quote! {\n+                #[serde(flatten)]\n+                #field\n+            }\n+        }\n+        if self.skip {\n+            field = quote! {\n+                #[serde(skip)]\n+                #field\n+            }\n+        }\n+        if let Some(rename) = &self.rename {\n+            field = quote! {\n+                #[serde(rename = #rename)]\n+                #field\n+            }\n+        }\n+        field\n+    }\n+}\n+\n+#[derive(Serialize, Deserialize, Debug)]\n+#[serde(transparent)]\n+#[serde(deny_unknown_fields)]\n+pub struct Enum {\n+    pub variants: Vec<String>,\n+}\n+\n+impl Enum {\n+    pub fn codegen(&self, name: &str, enums: &IndexMap<String, Enum>) -> TokenStream {\n+        let mut sorted_variants: Vec<_> = self.variants.iter().collect();\n+        sorted_variants.sort();\n+\n+        let name_str = name;\n+        let name = format_ident!(\"{}\", name);\n+        let variants: Vec<_> = sorted_variants\n+            .iter()\n+            .map(|name| {\n+                let variant = format_ident!(\"{}\", name);\n+                if enums.contains_key(*name) {\n+                    quote!(#variant(#variant))\n+                } else {\n+                    quote!(#variant(Box<#variant>))\n+                }\n+            })\n+            .collect();\n+\n+        let enum_tag = format_ident!(\"__{}Tag\", name);\n+        let mut seen = HashSet::new();\n+\n+        // tag_variants is used to generate an enum of all the possible type tags (`type` values)\n+        // that can appear in this enum. we emit this enum and derive a deserializer for it so that\n+        // our enum deserializer can first decode the tag in order to know how to decode the data\n+        let mut tag_variants = Vec::new();\n+\n+        // once the tag is decoded, we need to match against it and deserialize according the tag (`type`)\n+        // tag_matches are the match arms for each type.\n+        let mut tag_matches = Vec::new();\n+\n+        // Imagine a case like:\n+        // enum ModuleItem {\n+        //   ImportDeclaration, // struct\n+        //   Statement // another enum\n+        // }\n+        // We need to generate matches for all the possible *concrete* `type` values, which means\n+        // we have to expand nested enums such as `Statement`\n+        for variant in self.variants.iter() {\n+            if let Some(nested_enum) = enums.get(variant) {\n+                let outer_variant = format_ident!(\"{}\", variant);\n+                for variant in nested_enum.variants.iter() {\n+                    // Skip variants that appear in multiple nested enums, we deserialize\n+                    // as the first listed outer variant\n+                    if !seen.insert(variant.to_string()) {\n+                        continue;\n+                    }\n+                    // Modeling ESTree only requires a single level of nested enums,\n+                    // so that's all we support. Though in theory we could support arbitrary nesting,\n+                    // since ultimately we're matching based on the final concrete types.\n+                    assert!(!enums.contains_key(variant));\n+\n+                    let inner_variant = format_ident!(\"{}\", variant);\n+                    tag_variants.push(quote!(#inner_variant));\n+\n+                    tag_matches.push(quote! {\n+                        #enum_tag::#inner_variant => {\n+                            let node: Box<#inner_variant> = <Box<#inner_variant> as Deserialize>::deserialize(\n+                                serde::__private::de::ContentDeserializer::<D::Error>::new(tagged.1),\n+                            )?;\n+                            Ok(#name::#outer_variant(#outer_variant::#inner_variant(node)))\n+                        }\n+                    });\n+                }\n+            } else {\n+                if !seen.insert(variant.to_string()) {\n+                    panic!(\n+                        \"Concrete variant {} was already added by a nested enum\",\n+                        variant\n+                    );\n+                }\n+                let variant_name = format_ident!(\"{}\", variant);\n+                tag_variants.push(quote!(#variant_name));\n+\n+                tag_matches.push(quote! {\n+                    #enum_tag::#variant_name => {\n+                        let node: Box<#variant_name> = <Box<#variant_name> as Deserialize>::deserialize(\n+                            serde::__private::de::ContentDeserializer::<D::Error>::new(tagged.1),\n+                        )?;\n+                        Ok(#name::#variant_name(node))\n+                    }\n+                })\n+            }\n+        }\n+        quote! {\n+            #[derive(Serialize, Clone, Debug)]\n+            #[serde(untagged)]\n+            pub enum #name {\n+                #(#variants),*\n+            }\n+\n+            #[derive(Deserialize, Debug)]\n+            enum #enum_tag {\n+                #(#tag_variants),*\n+            }\n+\n+            impl <'de> serde::Deserialize<'de> for #name {\n+                fn deserialize<D>(deserializer: D) -> Result<Self, D::Error>\n+                where D: serde::Deserializer<'de> {\n+                    let tagged = serde::Deserializer::deserialize_any(\n+                        deserializer,\n+                        serde::__private::de::TaggedContentVisitor::<#enum_tag>::new(\"type\", #name_str)\n+                    )?;\n+                    match tagged.0 {\n+                        #(#tag_matches),*\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    pub fn codegen_visitor(&self, name: &str) -> TokenStream {\n+        let visitor_name = format_ident!(\"visit_{}\", to_lower_snake_case(name));\n+        let name = format_ident!(\"{}\", name);\n+        let mut tag_matches = Vec::new();\n+\n+        for variant in self.variants.iter() {\n+            let node_variant = format_ident!(\"{}\", variant);\n+            let visitor_name = format_ident!(\"visit_{}\", to_lower_snake_case(variant));\n+\n+            tag_matches.push(quote! {\n+                #name::#node_variant(ast) => {\n+                    self.#visitor_name(ast);\n+                }\n+            })\n+        }\n+        quote! {\n+            fn #visitor_name(&mut self, ast: &#name) {\n+                match ast {\n+                    #(#tag_matches),*\n+                }\n+            }\n+        }\n+    }\n+\n+    pub fn codegen_hermes(&self, name: &str, grammar: &Grammar) -> TokenStream {\n+        let name_str = name;\n+        let name = format_ident!(\"{}\", name);\n+\n+        let mut tag_matches = Vec::new();\n+        let mut seen = HashSet::new();\n+\n+        // Imagine a case like:\n+        // enum ModuleItem {\n+        //   ImportDeclaration, // struct\n+        //   Statement // another enum\n+        // }\n+        // We need to generate matches for all the possible *concrete* `type` values, which means\n+        // we have to expand nested enums such as `Statement`\n+        for variant in self.variants.iter() {\n+            if let Some(nested_enum) = grammar.enums.get(variant) {\n+                let outer_variant = format_ident!(\"{}\", variant);\n+                for variant in nested_enum.variants.iter() {\n+                    // Skip variants that appear in multiple nested enums, we deserialize\n+                    // as the first listed outer variant\n+                    if !seen.insert(variant.to_string()) {\n+                        continue;\n+                    }\n+                    // Modeling ESTree only requires a single level of nested enums,\n+                    // so that's all we support. Though in theory we could support arbitrary nesting,\n+                    // since ultimately we're matching based on the final concrete types.\n+                    assert!(!grammar.enums.contains_key(variant));\n+                    let node = grammar.nodes.get(variant).unwrap();\n+                    if node.skip_hermes_enum_variant {\n+                        continue;\n+                    }\n+\n+                    let inner_variant = format_ident!(\"{}\", variant);\n+                    let node_variant_name = node.type_.as_ref().unwrap_or(variant);\n+                    let node_variant = format_ident!(\"{}\", node_variant_name);\n+\n+                    tag_matches.push(quote! {\n+                        NodeKind::#node_variant => {\n+                            let node = #inner_variant::convert(cx, node);\n+                            #name::#outer_variant(#outer_variant::#inner_variant(Box::new(node)))\n+                        }\n+                    });\n+                }\n+            } else {\n+                if !seen.insert(variant.to_string()) {\n+                    panic!(\n+                        \"Concrete variant {} was already added by a nested enum\",\n+                        variant\n+                    );\n+                }\n+                let variant_name = format_ident!(\"{}\", variant);\n+                let node = grammar.nodes.get(variant).unwrap();\n+                if node.skip_hermes_enum_variant {\n+                    continue;\n+                }\n+\n+                let node_variant_name = node.type_.as_ref().unwrap_or(variant);\n+                let node_variant = format_ident!(\"{}\", node_variant_name);\n+\n+                tag_matches.push(quote! {\n+                    NodeKind::#node_variant => {\n+                        let node = #variant_name::convert(cx, node);\n+                        #name::#variant_name(Box::new(node))\n+                    }\n+                })\n+            }\n+        }\n+\n+        quote! {\n+            impl FromHermes for #name {\n+                fn convert(cx: &mut Context, node: NodePtr) -> Self {\n+                    let node_ref = node.as_ref();\n+                    match node_ref.kind {\n+                        #(#tag_matches),*\n+                        _ => panic!(\"Unexpected node kind `{:?}` for `{}`\", node_ref.kind, #name_str)\n+                    }\n+                }\n+            }\n+        }\n+    }\n+}\n+\n+#[derive(Serialize, Deserialize, Debug)]\n+#[serde(transparent)]\n+#[serde(deny_unknown_fields)]\n+pub struct Operator {\n+    pub variants: IndexMap<String, String>,\n+}\n+\n+impl Operator {\n+    pub fn codegen(&self, name: &str) -> TokenStream {\n+        let mut sorted_variants: Vec<_> = self.variants.iter().collect();\n+        sorted_variants.sort();\n+\n+        let name = format_ident!(\"{}\", name);\n+        let variants: Vec<_> = sorted_variants\n+            .iter()\n+            .map(|(name, operator)| {\n+                let name = format_ident!(\"{}\", name);\n+                let comment = format!(\" {}\", &operator);\n+                quote! {\n+                    #[doc = #comment]\n+                    #[serde(rename = #operator)]\n+                    #name\n+                }\n+            })\n+            .collect();\n+\n+        let display_matches: Vec<_> = sorted_variants\n+            .iter()\n+            .map(|(name, operator)| {\n+                let name = format_ident!(\"{}\", name);\n+                quote!(Self::#name => #operator)\n+            })\n+            .collect();\n+\n+        let fromstr_matches: Vec<_> = sorted_variants\n+            .iter()\n+            .map(|(name, operator)| {\n+                let name = format_ident!(\"{}\", name);\n+                quote!(#operator => Ok(Self::#name))\n+            })\n+            .collect();\n+\n+        quote! {\n+            #[derive(Serialize, Deserialize, Clone, Copy, Eq, PartialEq, Ord, PartialOrd, Hash, Debug)]\n+            pub enum #name {\n+                #(#variants),*\n+            }\n+\n+            impl std::fmt::Display for #name {\n+                fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {\n+                    let name = match self {\n+                        #(#display_matches),*\n+                    };\n+                    f.write_str(name)\n+                }\n+            }\n+\n+            impl std::str::FromStr for #name {\n+                type Err = ();\n+\n+                fn from_str(s: &str) -> Result<Self, Self::Err> {\n+                    match s {\n+                        #(#fromstr_matches,)*\n+                        _ => Err(()),\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    pub fn codegen_hermes(&self, name: &str) -> TokenStream {\n+        let mut sorted_variants: Vec<_> = self.variants.iter().collect();\n+        sorted_variants.sort();\n+\n+        let name = format_ident!(\"{}\", name);\n+\n+        quote! {\n+            impl FromHermesLabel for #name {\n+                fn convert(cx: &mut Context, label: NodeLabel) -> Self {\n+                    let utf_str = utf8_with_surrogates_to_string(label.as_slice()).unwrap();\n+                    utf_str.parse().unwrap()\n+                }\n+            }\n+        }\n+    }\n+}\n+\n+enum TypeKind {\n+    /// T\n+    Named,\n+\n+    /// Option<T>\n+    Option,\n+\n+    /// Vec<T>\n+    Vec,\n+\n+    /// Vec<Option<T>>\n+    VecOfOption,\n+}\n+\n+/// Parses a given type into the underlying type name plus a descriptor of the\n+/// kind of type. Only a subset of Rust types are supported:\n+/// - T\n+/// - Option<T>\n+/// - Vec<T>\n+/// - Vec<Option<T>>\n+fn parse_type(type_: &str) -> Result<(String, TypeKind), String> {\n+    let mut current = type_;\n+    let mut is_list = false;\n+    let mut is_option = false;\n+    if current.starts_with(\"Vec<\") {\n+        current = &current[4..current.len() - 1];\n+        is_list = true;\n+    }\n+    if current.starts_with(\"Option<\") {\n+        current = &current[7..current.len() - 1];\n+        is_option = true;\n+    }\n+    if current.contains('<') {\n+        Err(format!(\n+            \"Unsupported type `{current}` expected named type (`Identifier`), optional type (`Option<Identifier>`), list type (`Vec<Identifier>`), or optional list (`Vec<Option<Identifier>>`)\"\n+        ))\n+    } else {\n+        let kind = match (is_list, is_option) {\n+            (true, true) => TypeKind::VecOfOption,\n+            (true, false) => TypeKind::Vec,\n+            (false, true) => TypeKind::Option,\n+            (false, false) => TypeKind::Named,\n+        };\n+        Ok((current.to_string(), kind))\n+    }\n+}\n+\n+// from https://github.com/rust-lang/rust-analyzer/blob/4105378dc7479a3dbd39a4afb3eba67d083bd7f8/xtask/src/codegen/gen_syntax.rs#L406C1-L418C2\n+fn to_lower_snake_case(s: &str) -> String {\n+    let mut buf = String::with_capacity(s.len());\n+    let mut prev = false;\n+    for c in s.chars() {\n+        if c.is_ascii_uppercase() {\n+            if prev {\n+                buf.push('_')\n+            }\n+            prev = false;\n+        } else {\n+            prev = true;\n+        }\n+\n+        buf.push(c.to_ascii_lowercase());\n+    }\n+    buf\n+}"
            },
            {
                "file": "compiler/crates/react_estree_codegen/src/ecmascript.json",
                "git_diff": "@@ -0,0 +1,1367 @@\n+{\n+    \"objects\": {\n+        \"SourceLocation\": {\n+            \"fields\": {\n+                \"source\": {\n+                    \"type\": \"Option<String>\"\n+                },\n+                \"start\": {\n+                    \"type\": \"Position\"\n+                },\n+                \"end\": {\n+                    \"type\": \"Position\"\n+                }\n+            }\n+        },\n+        \"Position\": {\n+            \"fields\": {\n+                \"line\": {\n+                    \"type\": \"NonZeroU32\"\n+                },\n+                \"column\": {\n+                    \"type\": \"u32\"\n+                }\n+            }\n+        },\n+        \"Class\": {\n+            \"visitor\": true,\n+            \"fields\": {\n+                \"id\": {\n+                    \"type\": \"Option<Identifier>\"\n+                },\n+                \"super_class\": {\n+                    \"type\": \"Option<Expression>\",\n+                    \"rename\": \"superClass\"\n+                },\n+                \"body\": {\n+                    \"type\": \"ClassBody\"\n+                }\n+            }\n+        },\n+        \"Function\": {\n+            \"visitor\": true,\n+            \"fields\": {\n+                \"id\": {\n+                    \"type\": \"Option<Identifier>\"\n+                },\n+                \"params\": {\n+                    \"type\": \"Vec<Pattern>\"\n+                },\n+                \"body\": {\n+                    \"type\": \"Option<FunctionBody>\"\n+                },\n+                \"is_generator\": {\n+                    \"type\": \"bool\",\n+                    \"optional\": true,\n+                    \"rename\": \"generator\"\n+                },\n+                \"is_async\": {\n+                    \"type\": \"bool\",\n+                    \"optional\": true,\n+                    \"rename\": \"async\"\n+                },\n+                \"loc\": {\n+                    \"type\": \"Option<SourceLocation>\",\n+                    \"optional\": true\n+                },\n+                \"range\": {\n+                    \"type\": \"Option<SourceRange>\",\n+                    \"optional\": true\n+                }\n+            }\n+        },\n+        \"RegExpValue\": {\n+            \"fields\": {\n+                \"pattern\": {\n+                    \"type\": \"String\"\n+                },\n+                \"flags\": {\n+                    \"type\": \"String\"\n+                }\n+            }\n+        },\n+        \"TemplateElementValue\": {\n+            \"fields\": {\n+                \"cooked\": {\n+                    \"type\": \"Option<String>\"\n+                },\n+                \"raw\": {\n+                    \"type\": \"String\"\n+                }\n+            }\n+        }\n+    },\n+    \"nodes\": {\n+        \"Identifier\": {\n+            \"fields\": {\n+                \"name\": {\n+                    \"type\": \"String\"\n+                },\n+                \"binding\": {\n+                    \"type\": \"Option<Binding>\",\n+                    \"optional\": true,\n+                    \"skip\": true\n+                },\n+                \"type_annotation\": {\n+                    \"type\": \"Option<TypeAnnotation>\",\n+                    \"optional\": true,\n+                    \"rename\": \"typeAnnotation\",\n+                    \"hermes_default\": true,\n+                    \"TODO\": \"support HermesParser\"\n+                }\n+            }\n+        },\n+        \"Literal\": {\n+            \"skip_hermes_codegen\": true,\n+            \"skip_hermes_enum_variant\": true,\n+            \"fields\": {\n+                \"value\": {\n+                    \"type\": \"JsValue\"\n+                },\n+                \"raw\": {\n+                    \"type\": \"Option<String>\",\n+                    \"optional\": true\n+                },\n+                \"regex\": {\n+                    \"type\": \"Option<RegExpValue>\",\n+                    \"optional\": true\n+                },\n+                \"bigint\": {\n+                    \"type\": \"Option<String>\",\n+                    \"optional\": true\n+                }\n+            }\n+        },\n+        \"NumericLiteral\": {\n+            \"fields\": {\n+                \"value\": {\n+                    \"type\": \"Number\"\n+                }\n+            }\n+        },\n+        \"BooleanLiteral\": {\n+            \"fields\": {\n+                \"value\": {\n+                    \"type\": \"bool\"\n+                }\n+            }\n+        },\n+        \"NullLiteral\": {},\n+        \"StringLiteral\": {\n+            \"fields\": {\n+                \"value\": {\n+                    \"type\": \"String\",\n+                    \"hermes_convert_with\": \"convert_string_value\"\n+                }\n+            }\n+        },\n+        \"RegExpLiteral\": {\n+            \"fields\": {\n+                \"pattern\": {\n+                    \"type\": \"String\"\n+                },\n+                \"flags\": {\n+                    \"type\": \"String\"\n+                }\n+            }\n+        },\n+        \"Program\": {\n+            \"fields\": {\n+                \"body\": {\n+                    \"type\": \"Vec<ModuleItem>\"\n+                },\n+                \"source_type\": {\n+                    \"type\": \"SourceType\",\n+                    \"optional\": true,\n+                    \"rename\": \"sourceType\",\n+                    \"hermes_default\": true\n+                }\n+            }\n+        },\n+        \"ExpressionStatement\": {\n+            \"fields\": {\n+                \"expression\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"directive\": {\n+                    \"type\": \"Option<String>\",\n+                    \"optional\": true,\n+                    \"hermes_default\": true\n+                }\n+            }\n+        },\n+        \"BlockStatement\": {\n+            \"fields\": {\n+                \"body\": {\n+                    \"type\": \"Vec<Statement>\"\n+                }\n+            }\n+        },\n+        \"EmptyStatement\": {},\n+        \"DebuggerStatement\": {},\n+        \"WithStatement\": {\n+            \"fields\": {\n+                \"object\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"body\": {\n+                    \"type\": \"Statement\"\n+                }\n+            }\n+        },\n+        \"ReturnStatement\": {\n+            \"fields\": {\n+                \"argument\": {\n+                    \"type\": \"Option<Expression>\"\n+                }\n+            }\n+        },\n+        \"LabeledStatement\": {\n+            \"fields\": {\n+                \"label\": {\n+                    \"type\": \"Identifier\"\n+                },\n+                \"body\": {\n+                    \"type\": \"Statement\"\n+                }\n+            }\n+        },\n+        \"BreakStatement\": {\n+            \"fields\": {\n+                \"label\": {\n+                    \"type\": \"Option<Identifier>\"\n+                }\n+            }\n+        },\n+        \"ContinueStatement\": {\n+            \"fields\": {\n+                \"label\": {\n+                    \"type\": \"Option<Identifier>\"\n+                }\n+            }\n+        },\n+        \"IfStatement\": {\n+            \"fields\": {\n+                \"test\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"consequent\": {\n+                    \"type\": \"Statement\"\n+                },\n+                \"alternate\": {\n+                    \"type\": \"Option<Statement>\"\n+                }\n+            }\n+        },\n+        \"SwitchStatement\": {\n+            \"fields\": {\n+                \"discriminant\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"cases\": {\n+                    \"type\": \"Vec<SwitchCase>\"\n+                }\n+            }\n+        },\n+        \"SwitchCase\": {\n+            \"fields\": {\n+                \"test\": {\n+                    \"type\": \"Option<Expression>\"\n+                },\n+                \"consequent\": {\n+                    \"type\": \"Vec<Statement>\"\n+                }\n+            }\n+        },\n+        \"ThrowStatement\": {\n+            \"fields\": {\n+                \"argument\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"TryStatement\": {\n+            \"fields\": {\n+                \"block\": {\n+                    \"type\": \"BlockStatement\"\n+                },\n+                \"handler\": {\n+                    \"type\": \"Option<CatchClause>\"\n+                },\n+                \"finalizer\": {\n+                    \"type\": \"Option<BlockStatement>\"\n+                }\n+            }\n+        },\n+        \"CatchClause\": {\n+            \"fields\": {\n+                \"param\": {\n+                    \"type\": \"Option<Pattern>\"\n+                },\n+                \"body\": {\n+                    \"type\": \"BlockStatement\"\n+                }\n+            }\n+        },\n+        \"WhileStatement\": {\n+            \"fields\": {\n+                \"test\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"body\": {\n+                    \"type\": \"Statement\"\n+                }\n+            }\n+        },\n+        \"DoWhileStatement\": {\n+            \"fields\": {\n+                \"body\": {\n+                    \"type\": \"Statement\"\n+                },\n+                \"test\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"ForStatement\": {\n+            \"fields\": {\n+                \"init\": {\n+                    \"type\": \"Option<ForInit>\"\n+                },\n+                \"test\": {\n+                    \"type\": \"Option<Expression>\"\n+                },\n+                \"update\": {\n+                    \"type\": \"Option<Expression>\"\n+                },\n+                \"body\": {\n+                    \"type\": \"Statement\"\n+                }\n+            }\n+        },\n+        \"ForInStatement\": {\n+            \"fields\": {\n+                \"left\": {\n+                    \"type\": \"ForInInit\"\n+                },\n+                \"right\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"body\": {\n+                    \"type\": \"Statement\"\n+                }\n+            }\n+        },\n+        \"ForOfStatement\": {\n+            \"fields\": {\n+                \"is_await\": {\n+                    \"type\": \"bool\",\n+                    \"optional\": true,\n+                    \"rename\": \"await\"\n+                },\n+                \"left\": {\n+                    \"type\": \"ForInInit\"\n+                },\n+                \"right\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"body\": {\n+                    \"type\": \"Statement\"\n+                }\n+            }\n+        },\n+        \"FunctionDeclaration\": {\n+            \"skip_hermes_codegen\": true,\n+            \"fields\": {\n+                \"function\": {\n+                    \"type\": \"Function\",\n+                    \"flatten\": true\n+                }\n+            }\n+        },\n+        \"ClassDeclaration\": {\n+            \"skip_hermes_codegen\": true,\n+            \"fields\": {\n+                \"class\": {\n+                    \"type\": \"Class\",\n+                    \"flatten\": true\n+                }\n+            }\n+        },\n+        \"ClassExpression\": {\n+            \"skip_hermes_codegen\": true,\n+            \"fields\": {\n+                \"class\": {\n+                    \"type\": \"Class\",\n+                    \"flatten\": true\n+                }\n+            }\n+        },\n+        \"ClassBody\": {\n+            \"fields\": {\n+                \"body\": {\n+                    \"type\": \"Vec<ClassItem>\"\n+                }\n+            }\n+        },\n+        \"MethodDefinition\": {\n+            \"fields\": {\n+                \"key\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"value\": {\n+                    \"type\": \"FunctionExpression\"\n+                },\n+                \"kind\": {\n+                    \"type\": \"MethodKind\"\n+                },\n+                \"is_computed\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"computed\"\n+                },\n+                \"is_static\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"static\"\n+                }\n+            }\n+        },\n+        \"VariableDeclaration\": {\n+            \"fields\": {\n+                \"kind\": {\n+                    \"type\": \"VariableDeclarationKind\"\n+                },\n+                \"declarations\": {\n+                    \"type\": \"Vec<VariableDeclarator>\"\n+                }\n+            }\n+        },\n+        \"VariableDeclarator\": {\n+            \"fields\": {\n+                \"id\": {\n+                    \"type\": \"Pattern\"\n+                },\n+                \"init\": {\n+                    \"type\": \"Option<Expression>\"\n+                }\n+            }\n+        },\n+        \"ThisExpression\": {},\n+        \"ArrayExpression\": {\n+            \"fields\": {\n+                \"elements\": {\n+                    \"type\": \"Vec<Option<ExpressionOrSpread>>\",\n+                    \"hermes_convert_with\": \"convert_array_expression_elements\"\n+                }\n+            }\n+        },\n+        \"ObjectExpression\": {\n+            \"fields\": {\n+                \"properties\": {\n+                    \"type\": \"Vec<PropertyOrSpreadElement>\"\n+                }\n+            }\n+        },\n+        \"Property\": {\n+            \"fields\": {\n+                \"key\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"value\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"kind\": {\n+                    \"type\": \"PropertyKind\"\n+                },\n+                \"is_method\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"method\"\n+                },\n+                \"is_shorthand\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"shorthand\"\n+                },\n+                \"is_computed\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"computed\"\n+                }\n+            }\n+        },\n+        \"FunctionExpression\": {\n+            \"skip_hermes_codegen\": true,\n+            \"fields\": {\n+                \"function\": {\n+                    \"type\": \"Function\",\n+                    \"flatten\": true\n+                }\n+            }\n+        },\n+        \"ArrowFunctionExpression\": {\n+            \"skip_hermes_codegen\": true,\n+            \"fields\": {\n+                \"function\": {\n+                    \"type\": \"Function\",\n+                    \"flatten\": true\n+                },\n+                \"is_expression\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"expression\"\n+                }\n+            }\n+        },\n+        \"UnaryExpression\": {\n+            \"fields\": {\n+                \"operator\": {\n+                    \"type\": \"UnaryOperator\"\n+                },\n+                \"prefix\": {\n+                    \"type\": \"bool\"\n+                },\n+                \"argument\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"UpdateExpression\": {\n+            \"fields\": {\n+                \"operator\": {\n+                    \"type\": \"UpdateOperator\"\n+                },\n+                \"argument\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"prefix\": {\n+                    \"type\": \"bool\"\n+                }\n+            }\n+        },\n+        \"BinaryExpression\": {\n+            \"fields\": {\n+                \"left\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"operator\": {\n+                    \"type\": \"BinaryOperator\"\n+                },\n+                \"right\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"AssignmentExpression\": {\n+            \"fields\": {\n+                \"operator\": {\n+                    \"type\": \"AssignmentOperator\"\n+                },\n+                \"left\": {\n+                    \"type\": \"AssignmentTarget\"\n+                },\n+                \"right\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"LogicalExpression\": {\n+            \"fields\": {\n+                \"operator\": {\n+                    \"type\": \"LogicalOperator\"\n+                },\n+                \"left\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"right\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"MemberExpression\": {\n+            \"fields\": {\n+                \"object\": {\n+                    \"type\": \"ExpressionOrSuper\"\n+                },\n+                \"property\": {\n+                    \"type\": \"ExpressionOrPrivateIdentifier\"\n+                },\n+                \"is_computed\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"computed\"\n+                }\n+            }\n+        },\n+        \"ConditionalExpression\": {\n+            \"fields\": {\n+                \"test\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"alternate\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"consequent\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"CallExpression\": {\n+            \"fields\": {\n+                \"callee\": {\n+                    \"type\": \"ExpressionOrSuper\"\n+                },\n+                \"arguments\": {\n+                    \"type\": \"Vec<ExpressionOrSpread>\"\n+                }\n+            }\n+        },\n+        \"NewExpression\": {\n+            \"fields\": {\n+                \"callee\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"arguments\": {\n+                    \"type\": \"Vec<ExpressionOrSpread>\"\n+                }\n+            }\n+        },\n+        \"SequenceExpression\": {\n+            \"fields\": {\n+                \"expressions\": {\n+                    \"type\": \"Vec<Expression>\"\n+                }\n+            }\n+        },\n+        \"Super\": {},\n+        \"SpreadElement\": {\n+            \"fields\": {\n+                \"argument\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"YieldExpression\": {\n+            \"fields\": {\n+                \"argument\": {\n+                    \"type\": \"Option<Expression>\",\n+                    \"optional\": true\n+                },\n+                \"is_delegate\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"delegate\"\n+                }\n+            }\n+        },\n+        \"ImportDeclaration\": {\n+            \"fields\": {\n+                \"specifiers\": {\n+                    \"type\": \"Vec<ImportDeclarationSpecifier>\"\n+                },\n+                \"source\": {\n+                    \"type\": \"_Literal\"\n+                }\n+            }\n+        },\n+        \"ImportSpecifier\": {\n+            \"fields\": {\n+                \"imported\": {\n+                    \"type\": \"Identifier\"\n+                },\n+                \"local\": {\n+                    \"type\": \"Identifier\"\n+                }\n+            }\n+        },\n+        \"ImportDefaultSpecifier\": {\n+            \"fields\": {\n+                \"local\": {\n+                    \"type\": \"Identifier\"\n+                }\n+            }\n+        },\n+        \"ImportNamespaceSpecifier\": {\n+            \"fields\": {\n+                \"local\": {\n+                    \"type\": \"Identifier\"\n+                }\n+            }\n+        },\n+        \"ExportNamedDeclaration\": {\n+            \"fields\": {\n+                \"declaration\": {\n+                    \"type\": \"Option<Declaration>\"\n+                },\n+                \"specifiers\": {\n+                    \"type\": \"Vec<ExportSpecifier>\"\n+                },\n+                \"source\": {\n+                    \"type\": \"Option<_Literal>\"\n+                }\n+            }\n+        },\n+        \"ExportSpecifier\": {\n+            \"fields\": {\n+                \"exported\": {\n+                    \"type\": \"Identifier\"\n+                }\n+            }\n+        },\n+        \"ExportDefaultDeclaration\": {\n+            \"fields\": {\n+                \"declaration\": {\n+                    \"type\": \"DeclarationOrExpression\"\n+                }\n+            }\n+        },\n+        \"ExportAllDeclaration\": {\n+            \"fields\": {\n+                \"source\": {\n+                    \"type\": \"_Literal\"\n+                },\n+                \"exported\": {\n+                    \"type\": \"Option<Identifier>\",\n+                    \"optional\": true,\n+                    \"hermes_default\": true\n+                }\n+            }\n+        },\n+        \"JSXIdentifier\": {\n+            \"fields\": {\n+                \"name\": {\n+                    \"type\": \"String\"\n+                },\n+                \"binding\": {\n+                    \"type\": \"Option<Binding>\",\n+                    \"optional\": true,\n+                    \"skip\": true\n+                }\n+            }\n+        },\n+        \"JSXNamespacedName\": {\n+            \"fields\": {\n+                \"namespace\": {\n+                    \"type\": \"JSXIdentifier\"\n+                },\n+                \"name\": {\n+                    \"type\": \"JSXIdentifier\"\n+                }\n+            }\n+        },\n+        \"JSXMemberExpression\": {\n+            \"fields\": {\n+                \"object\": {\n+                    \"type\": \"JSXMemberExpressionOrIdentifier\"\n+                },\n+                \"property\": {\n+                    \"type\": \"JSXIdentifier\"\n+                }\n+            }\n+        },\n+        \"JSXEmptyExpression\": {},\n+        \"JSXExpressionContainer\": {\n+            \"fields\": {\n+                \"expression\": {\n+                    \"type\": \"JSXExpressionOrEmpty\"\n+                }\n+            }\n+        },\n+        \"JSXSpreadChild\": {\n+            \"fields\": {\n+                \"expression\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"JSXOpeningElement\": {\n+            \"fields\": {\n+                \"name\": {\n+                    \"type\": \"JSXElementName\"\n+                },\n+                \"attributes\": {\n+                    \"type\": \"Vec<JSXAttributeOrSpread>\"\n+                },\n+                \"self_closing\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"selfClosing\"\n+                }\n+            }\n+        },\n+        \"JSXClosingElement\": {\n+            \"fields\": {\n+                \"name\": {\n+                    \"type\": \"JSXElementName\"\n+                }\n+            }\n+        },\n+        \"JSXAttribute\": {\n+            \"fields\": {\n+                \"name\": {\n+                    \"type\": \"JSXIdentifierOrNamespacedName\"\n+                },\n+                \"value\": {\n+                    \"type\": \"Option<JSXAttributeValue>\"\n+                }\n+            }\n+        },\n+        \"JSXSpreadAttribute\": {\n+            \"fields\": {\n+                \"argument\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"JSXText\": {\n+            \"fields\": {\n+                \"value\": {\n+                    \"type\": \"String\",\n+                    \"hermes_convert_with\": \"convert_string_value\"\n+                },\n+                \"raw\": {\n+                    \"type\": \"String\"\n+                }\n+            }\n+        },\n+        \"JSXStringLiteral\": {\n+            \"fields\": {\n+                \"value\": {\n+                    \"type\": \"String\",\n+                    \"hermes_convert_with\": \"convert_string_value\"\n+                },\n+                \"raw\": {\n+                    \"type\": \"String\"\n+                }\n+            },\n+            \"TODO\": \"Non-standard HermesParser node\"\n+        },\n+        \"JSXElement\": {\n+            \"fields\": {\n+                \"opening_element\": {\n+                    \"type\": \"JSXOpeningElement\",\n+                    \"rename\": \"openingElement\"\n+                },\n+                \"children\": {\n+                    \"type\": \"Vec<JSXChildItem>\"\n+                },\n+                \"closing_element\": {\n+                    \"type\": \"Option<JSXClosingElement>\",\n+                    \"rename\": \"closingElement\"\n+                }\n+            }\n+        },\n+        \"JSXFragment\": {\n+            \"fields\": {\n+                \"opening_fragment\": {\n+                    \"type\": \"JSXOpeningFragment\",\n+                    \"rename\": \"openingFragment\"\n+                },\n+                \"children\": {\n+                    \"type\": \"Vec<JSXChildItem>\"\n+                },\n+                \"closing_fragment\": {\n+                    \"type\": \"JSXClosingFragment\",\n+                    \"rename\": \"closingFragment\"\n+                }\n+            }\n+        },\n+        \"JSXOpeningFragment\": {},\n+        \"JSXClosingFragment\": {},\n+        \"ArrayPattern\": {\n+            \"fields\": {\n+                \"elements\": {\n+                    \"type\": \"Vec<Option<Pattern>>\"\n+                }\n+            }\n+        },\n+        \"ObjectPattern\": {\n+            \"fields\": {\n+                \"properties\": {\n+                    \"type\": \"Vec<AssignmentPropertyOrRestElement>\"\n+                }\n+            }\n+        },\n+        \"AssignmentProperty\": {\n+            \"skip_hermes_codegen\": true,\n+            \"type\": \"Property\",\n+            \"fields\": {\n+                \"key\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"value\": {\n+                    \"type\": \"Pattern\"\n+                },\n+                \"kind\": {\n+                    \"type\": \"PropertyKind\",\n+                    \"TODO\": \"fixed value `init`\"\n+                },\n+                \"is_computed\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"computed\"\n+                },\n+                \"is_shorthand\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"shorthand\"\n+                },\n+                \"is_method\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"method\",\n+                    \"TODO\": \"fixed value `false`\" \n+                }\n+            }\n+        },\n+        \"RestElement\": {\n+            \"fields\": {\n+                \"argument\": {\n+                    \"type\": \"Pattern\"\n+                }\n+            }\n+        },\n+        \"AssignmentPattern\": {\n+            \"fields\": {\n+                \"left\": {\n+                    \"type\": \"Pattern\"\n+                },\n+                \"right\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"TemplateLiteral\": {\n+            \"fields\": {\n+                \"quasis\": {\n+                    \"type\": \"Vec<TemplateElement>\"\n+                },\n+                \"expressions\": {\n+                    \"type\": \"Vec<Expression>\"\n+                }\n+            }\n+        },\n+        \"TemplateElement\": {\n+            \"skip_hermes_codegen\": true,\n+            \"fields\": {\n+                \"tail\": {\n+                    \"type\": \"bool\"\n+                },\n+                \"value\": {\n+                    \"type\": \"TemplateElementValue\"\n+                }\n+            }\n+        },\n+        \"TaggedTemplateExpression\": {\n+            \"fields\": {\n+                \"tag\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"quasi\": {\n+                    \"type\": \"TemplateLiteral\"\n+                }\n+            }\n+        },\n+        \"MetaProperty\": {\n+            \"fields\": {\n+                \"meta\": {\n+                    \"type\": \"Identifier\"\n+                },\n+                \"property\": {\n+                    \"type\": \"Identifier\"\n+                }\n+            }\n+        },\n+        \"AwaitExpression\": {\n+            \"fields\": {\n+                \"argument\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"ChainExpression\": {\n+            \"skip_hermes_codegen\": true,\n+            \"skip_hermes_enum_variant\": true,\n+            \"fields\": {\n+                \"expression\": {\n+                    \"type\": \"ChainElement\"\n+                }\n+            }\n+        },\n+        \"OptionalMemberExpression\": {\n+            \"fields\": {\n+                \"object\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"property\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"is_computed\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"computed\"\n+                },\n+                \"is_optional\": {\n+                    \"type\": \"bool\",\n+                    \"optional\": true,\n+                    \"rename\": \"optional\"\n+                }\n+            }\n+        },\n+        \"OptionalCallExpression\": {\n+            \"fields\": {\n+                \"callee\": {\n+                    \"type\": \"ExpressionOrSuper\"\n+                },\n+                \"arguments\": {\n+                    \"type\": \"Vec<ExpressionOrSpread>\"\n+                },\n+                \"is_optional\": {\n+                    \"type\": \"bool\",\n+                    \"optional\": true,\n+                    \"rename\": \"optional\"\n+                }\n+            }\n+        },\n+        \"ImportExpression\": {\n+            \"fields\": {\n+                \"source\": {\n+                    \"type\": \"Expression\"\n+                }\n+            }\n+        },\n+        \"ClassProperty\": {\n+            \"fields\": {\n+                \"key\": {\n+                    \"type\": \"Expression\"\n+                },\n+                \"value\": {\n+                    \"type\": \"Option<Expression>\",\n+                    \"optional\": true\n+                },\n+                \"is_computed\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"computed\"\n+                },\n+                \"is_static\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"static\"\n+                }\n+            }\n+        },\n+        \"ClassPrivateProperty\": {\n+            \"fields\": {\n+                \"key\": {\n+                    \"type\": \"ExpressionOrPrivateIdentifier\"\n+                },\n+                \"value\": {\n+                    \"type\": \"Option<Expression>\",\n+                    \"optional\": true\n+                },\n+                \"is_static\": {\n+                    \"type\": \"bool\",\n+                    \"rename\": \"static\"\n+                }\n+            },\n+            \"TODO\": \"Non-standard HermesParser node\"\n+        },\n+        \"PrivateName\": {\n+            \"fields\": {\n+                \"id\": {\n+                    \"type\": \"Identifier\"\n+                }\n+            },\n+            \"TODO\": \"Non-standard HermesParser node\"\n+        },\n+        \"PrivateIdentifier\": {\n+            \"skip_hermes_codegen\": true,\n+            \"skip_hermes_enum_variant\": true,\n+            \"fields\": {\n+                \"name\": {\n+                    \"type\": \"String\"\n+                }\n+            }\n+        },\n+        \"StaticBlock\": {\n+            \"skip_hermes_codegen\": true,\n+            \"skip_hermes_enum_variant\": true,\n+            \"fields\": {\n+                \"body\": {\n+                    \"type\": \"Vec<Statement>\"\n+                }\n+            },\n+            \"TODO\": \"not yet supported in HermesParser\"\n+        },\n+        \"CoverTypedIdentifier\": {\n+            \"fields\": {\n+                \"left\": {\n+                    \"type\": \"Identifier\"\n+                },\n+                \"right\": {\n+                    \"type\": \"Option<TypeAnnotation>\"\n+                }\n+            },\n+            \"TODO\": \"Non-standard HermesParser node\"\n+        },\n+        \"TSTypeAnnotation\": {},\n+        \"TSTypeAliasDeclaration\": {}\n+    },\n+    \"enums\": {\n+        \"Statement\": [\n+            \"BlockStatement\",\n+            \"BreakStatement\",\n+            \"ClassDeclaration\",\n+            \"ContinueStatement\",\n+            \"DebuggerStatement\",\n+            \"DoWhileStatement\",\n+            \"EmptyStatement\",\n+            \"ExpressionStatement\",\n+            \"ForInStatement\",\n+            \"ForOfStatement\",\n+            \"ForStatement\",\n+            \"FunctionDeclaration\",\n+            \"IfStatement\",\n+            \"LabeledStatement\",\n+            \"ReturnStatement\",\n+            \"SwitchStatement\",\n+            \"ThrowStatement\",\n+            \"TryStatement\",\n+            \"TSTypeAliasDeclaration\",\n+            \"VariableDeclaration\",\n+            \"WhileStatement\",\n+            \"WithStatement\"\n+        ],\n+        \"Expression\": [\n+            \"ArrayExpression\",\n+            \"ArrowFunctionExpression\",\n+            \"AssignmentExpression\",\n+            \"AwaitExpression\",\n+            \"BinaryExpression\",\n+            \"BooleanLiteral\",\n+            \"CallExpression\",\n+            \"ChainExpression\",\n+            \"ClassExpression\",\n+            \"ConditionalExpression\",\n+            \"CoverTypedIdentifier\",\n+            \"FunctionExpression\",\n+            \"Identifier\",\n+            \"ImportExpression\",\n+            \"JSXElement\",\n+            \"JSXFragment\",\n+            \"Literal\",\n+            \"LogicalExpression\",\n+            \"MemberExpression\",\n+            \"MetaProperty\",\n+            \"NewExpression\",\n+            \"NullLiteral\",\n+            \"NumericLiteral\",\n+            \"ObjectExpression\",\n+            \"OptionalCallExpression\",\n+            \"OptionalMemberExpression\",\n+            \"RegExpLiteral\",\n+            \"SequenceExpression\",\n+            \"StringLiteral\",\n+            \"TaggedTemplateExpression\",\n+            \"TemplateLiteral\",\n+            \"ThisExpression\",\n+            \"UnaryExpression\",\n+            \"UpdateExpression\",\n+            \"YieldExpression\"\n+        ],\n+        \"_Literal\": [\n+            \"Literal\",\n+            \"BooleanLiteral\",\n+            \"NullLiteral\",\n+            \"StringLiteral\",\n+            \"NumericLiteral\"\n+        ],\n+        \"Declaration\": [\n+            \"ClassDeclaration\",\n+            \"FunctionDeclaration\",\n+            \"VariableDeclaration\",\n+            \"TSTypeAliasDeclaration\"\n+        ],\n+        \"ImportDeclarationSpecifier\": [\n+            \"ImportSpecifier\",\n+            \"ImportDefaultSpecifier\",\n+            \"ImportNamespaceSpecifier\"\n+        ],\n+        \"ModuleItem\": [\n+            \"ImportOrExportDeclaration\",\n+            \"Statement\"\n+        ],\n+        \"ImportOrExportDeclaration\": [\n+            \"ImportDeclaration\",\n+            \"ExportNamedDeclaration\",\n+            \"ExportDefaultDeclaration\",\n+            \"ExportAllDeclaration\"\n+        ],\n+        \"ExpressionOrSuper\": [\n+            \"Expression\",\n+            \"Super\"\n+        ],\n+        \"ExpressionOrSpread\": [\n+            \"Expression\",\n+            \"SpreadElement\"\n+        ],\n+        \"FunctionBody\": [\n+            \"BlockStatement\",\n+            \"Expression\"\n+        ],\n+        \"Pattern\": [\n+            \"Identifier\",\n+            \"ArrayPattern\",\n+            \"ObjectPattern\",\n+            \"RestElement\",\n+            \"AssignmentPattern\"\n+        ],\n+        \"ForInit\": [\n+            \"Expression\",\n+            \"VariableDeclaration\"\n+        ],\n+        \"ForInInit\": [\n+            \"Pattern\",\n+            \"VariableDeclaration\"\n+        ],\n+        \"PropertyOrSpreadElement\": [\n+            \"Property\",\n+            \"SpreadElement\"\n+        ],\n+        \"AssignmentPropertyOrRestElement\": [\n+            \"AssignmentProperty\",\n+            \"RestElement\"\n+        ],\n+        \"AssignmentTarget\": [\n+            \"Pattern\",\n+            \"Expression\"\n+        ],\n+        \"ChainElement\": [\n+            \"CallExpression\",\n+            \"MemberExpression\"\n+        ],\n+        \"JSXMemberExpressionOrIdentifier\": [\n+            \"JSXMemberExpression\",\n+            \"JSXIdentifier\"\n+        ],\n+        \"JSXExpressionOrEmpty\": [\n+            \"Expression\",\n+            \"JSXEmptyExpression\"\n+        ],\n+        \"JSXAttributeOrSpread\": [\n+            \"JSXAttribute\",\n+            \"JSXSpreadAttribute\"\n+        ],\n+        \"JSXAttributeValue\": [\n+            \"Literal\",\n+            \"JSXExpressionContainer\",\n+            \"JSXElement\",\n+            \"JSXFragment\",\n+            \"JSXStringLiteral\"\n+        ],\n+        \"JSXElementName\": [\n+            \"JSXIdentifier\",\n+            \"JSXMemberExpression\",\n+            \"JSXNamespacedName\"\n+        ],\n+        \"JSXIdentifierOrNamespacedName\": [\n+            \"JSXIdentifier\",\n+            \"JSXNamespacedName\"\n+        ],\n+        \"JSXChildItem\": [\n+            \"JSXText\", \n+            \"JSXStringLiteral\",\n+            \"JSXExpressionContainer\",\n+            \"JSXSpreadChild\",\n+            \"JSXElement\",\n+            \"JSXFragment\"\n+        ],\n+        \"DeclarationOrExpression\": [\n+            \"Declaration\",\n+            \"Expression\"\n+        ],\n+        \"ClassItem\": [\n+            \"MethodDefinition\",\n+            \"ClassProperty\",\n+            \"ClassPrivateProperty\",\n+            \"StaticBlock\"\n+        ],\n+        \"ExpressionOrPrivateIdentifier\": [\n+            \"Expression\",\n+            \"PrivateIdentifier\",\n+            \"PrivateName\"\n+        ],\n+        \"TypeAnnotation\": [\n+            \"TSTypeAnnotation\"\n+        ]\n+    },\n+    \"operators\": {\n+        \"VariableDeclarationKind\": {\n+            \"Const\": \"const\",\n+            \"Let\": \"let\",\n+            \"Var\": \"var\"\n+        },\n+        \"PropertyKind\": {\n+            \"Get\": \"get\",\n+            \"Init\": \"init\",\n+            \"Set\": \"set\"\n+        },\n+        \"UnaryOperator\": {\n+            \"Delete\": \"delete\",\n+            \"Minus\": \"-\",\n+            \"Negation\": \"!\",\n+            \"Plus\": \"+\",\n+            \"Tilde\": \"~\",\n+            \"Typeof\": \"typeof\",\n+            \"Void\": \"void\"\n+        },\n+        \"UpdateOperator\": {\n+            \"Decrement\": \"--\",\n+            \"Increment\": \"++\"\n+        },\n+        \"BinaryOperator\": {\n+            \"Add\": \"+\",\n+            \"BinaryAnd\": \"&\",\n+            \"BinaryOr\": \"|\",\n+            \"BinaryXor\": \"^\",\n+            \"Divide\": \"/\",\n+            \"Equals\": \"==\",\n+            \"Exponent\": \"**\",\n+            \"GreaterThan\": \">\",\n+            \"GreaterThanOrEqual\": \">=\",\n+            \"In\": \"in\",\n+            \"Instanceof\": \"instanceof\",\n+            \"LessThan\": \"<\",\n+            \"LessThanOrEqual\": \"<=\",\n+            \"Modulo\": \"%\",\n+            \"Multiply\": \"*\",\n+            \"NotEquals\": \"!=\",\n+            \"NotStrictEquals\": \"!==\",\n+            \"ShiftLeft\": \"<<\",\n+            \"ShiftRight\": \">>\",\n+            \"StrictEquals\": \"===\",\n+            \"Subtract\": \"-\",\n+            \"UnsignedShiftRight\": \">>>\"\n+        },\n+        \"AssignmentOperator\": {\n+            \"BinaryAndEquals\": \"&=\",\n+            \"BinaryOrEquals\": \"|=\",\n+            \"BinaryXorEquals\": \"^=\",\n+            \"DivideEquals\": \"/=\",\n+            \"Equals\": \"=\",\n+            \"Exponent\": \"**=\",\n+            \"MinusEquals\": \"-=\",\n+            \"ModuloEquals\": \"%=\",\n+            \"MultiplyEquals\": \"*=\",\n+            \"PlusEquals\": \"+=\",\n+            \"ShiftLeftEquals\": \"<<=\",\n+            \"ShiftRightEquals\": \">>=\",\n+            \"UnsignedShiftRightEquals\": \">>>=\",\n+            \"AndEquals\": \"&&=\",\n+            \"OrEquals\": \"||=\",\n+            \"NullCoalescingEquals\": \"??=\"\n+        },\n+        \"LogicalOperator\": {\n+            \"And\": \"&&\",\n+            \"NullCoalescing\": \"??\",\n+            \"Or\": \"||\"\n+        },\n+        \"SourceType\": {\n+            \"Script\": \"script\",\n+            \"Module\": \"module\"\n+        },\n+        \"MethodKind\": {\n+            \"Constructor\": \"constructor\",\n+            \"Method\": \"method\",\n+            \"Get\": \"get\",\n+            \"Set\": \"set\"\n+        }\n+    }\n+}\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_estree_codegen/src/lib.rs",
                "git_diff": "@@ -0,0 +1,10 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+mod codegen;\n+\n+pub use codegen::{estree, estree_hermes};"
            },
            {
                "file": "compiler/crates/react_fixtures/Cargo.toml",
                "git_diff": "@@ -0,0 +1,24 @@\n+[package]\n+name = \"react_fixtures\"\n+version = \"0.1.0\"\n+publish               = false\n+authors.workspace     = true\n+description.workspace = true\n+edition.workspace     = true\n+homepage.workspace    = true\n+keywords.workspace    = true\n+license.workspace     = true\n+repository.workspace  = true\n+\n+# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n+\n+[dev-dependencies]\n+insta = { workspace = true }\n+react_estree = { workspace = true }\n+react_hermes_parser = { workspace = true }\n+react_hir = { workspace = true }\n+react_optimization = { workspace = true }\n+react_semantic_analysis = { workspace = true }\n+react_ssa = { workspace = true }\n+react_build_hir = { workspace = true }\n+miette = { workspace = true, features = [\"backtrace\", \"fancy\"] }"
            },
            {
                "file": "compiler/crates/react_fixtures/README.md",
                "git_diff": "@@ -0,0 +1,3 @@\n+# fixtures\n+\n+This crate is for tests only, and runs the suite of compiler fixture tests.\n\\ No newline at end of file"
            },
            {
                "file": "compiler/crates/react_fixtures/src/lib.rs",
                "git_diff": "@@ -0,0 +1,6 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/constant-propagation-constant-if-condition.js",
                "git_diff": "@@ -0,0 +1,34 @@\n+function Component() {\n+  let a = 1;\n+\n+  let b;\n+  if (a === 1) {\n+    b = true;\n+  } else {\n+    b = false;\n+  }\n+\n+  let c;\n+  if (b) {\n+    c = \"hello\";\n+  } else {\n+    c = null;\n+  }\n+\n+  let d;\n+  if (c === \"hello\") {\n+    d = 42.0;\n+  } else {\n+    d = 42.001;\n+  }\n+\n+  let e;\n+  if (d === 42.0) {\n+    e = \"ok\";\n+  } else {\n+    e = \"nope\";\n+  }\n+\n+  // should constant-propagate to \"ok\"\n+  return e;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/constant-propagation.js",
                "git_diff": "@@ -0,0 +1,60 @@\n+function Component(props) {\n+  // global propagation\n+  let a;\n+  a = Math;\n+  a; // Math\n+\n+  // primitive propagation w phi\n+  let b;\n+  if (props) {\n+    b = true;\n+  } else {\n+    b = true;\n+  }\n+  b; // true\n+\n+  // primitive propagation fails if different values\n+  let c;\n+  if (props) {\n+    c = true;\n+  } else {\n+    c = 42;\n+  }\n+  c; // <no change>\n+\n+  // constant evaluation\n+  42 + 1; // 43\n+  42 - 1; // 41\n+  42 * 2; // 84\n+  42 / 2; // 21\n+  0 == 1; // false\n+  0 != 1; // true\n+  0 === 1; // false\n+  0 !== 1; // true\n+  0 == 0; // true\n+  // TODO: unary operators\n+  //   0 == -0; // false\n+  //   0 != -0; // true\n+  //   0 === -0; // false\n+  //   0 !== -0; // true\n+  NaN == NaN; // false\n+  NaN != NaN; // true\n+  NaN !== NaN; // true\n+  NaN !== NaN; // true\n+  \"hello\" == \"hello\"; // true\n+  \"hello\" != \"hello\"; // false\n+  \"hello\" === \"hello\"; // true\n+  \"hello\" !== \"hello\"; // false\n+  \"hello\" == \"world\"; // false\n+  \"hello\" != \"world\"; // true\n+  \"hello\" === \"world\"; // false\n+  \"hello\" !== \"world\"; // true\n+  true == true; // true\n+  true != true; // false\n+  true === true; // true\n+  true !== true; // false\n+\n+  // constant evaluation through variable\n+  let x = 5 * 60 * 60 * 1000; // 5 hours in milliseconds\n+  x;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/destructure-array.js",
                "git_diff": "@@ -0,0 +1,5 @@\n+function Component(a, b) {\n+  const [c, , ...d] = a;\n+  const [[[e]], ...[f]] = b;\n+  return [c, d, e, f];\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/destructure-object.js",
                "git_diff": "@@ -0,0 +1,15 @@\n+function Component(a, b) {\n+  const {\n+    c,\n+    d,\n+    e: { e },\n+    f: { _f: f },\n+    g: {\n+      g: {\n+        g: { g, ...h },\n+      },\n+    },\n+    ...i\n+  } = a;\n+  return [c, d, e, f, g, h, i];\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/error.assign-to-global.js",
                "git_diff": "@@ -0,0 +1,3 @@\n+function foo() {\n+  x = true;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/for-statement.js",
                "git_diff": "@@ -0,0 +1,7 @@\n+function foo() {\n+  let x = 0;\n+  for (let i = 0; i < 10; i = i + 1) {\n+    x = x + i;\n+  }\n+  return x;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/function-expressions.js",
                "git_diff": "@@ -0,0 +1,21 @@\n+function Component(props) {\n+  const x = 2;\n+  const foo = function foo(y) {\n+    let a = 1;\n+    let b;\n+    if (a === 1) {\n+      b = 5 + 3;\n+    } else {\n+      b = false;\n+    }\n+    x + y + a + b;\n+    const bar = function bar(z) {\n+      let c = 2;\n+      let d;\n+      d = 3;\n+      x + y + a + b + z + c + d;\n+    };\n+    bar;\n+    foo;\n+  };\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/identifiers.js",
                "git_diff": "@@ -0,0 +1,16 @@\n+// import React from \"react\";\n+\n+// const FOO = false;\n+\n+function id(x) {\n+  // React;\n+  // FOO;\n+  Math;\n+  id;\n+  let y = true;\n+  y = false;\n+  y;\n+  let z;\n+  z;\n+  return x;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/if-statement.js",
                "git_diff": "@@ -0,0 +1,8 @@\n+function foo(a, b, c, d) {\n+  if (a) {\n+    return b;\n+  } else {\n+    c;\n+  }\n+  d;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/simple-function.js",
                "git_diff": "@@ -0,0 +1,9 @@\n+function Component(a) {\n+  Math;\n+  let b = 0;\n+  const foo = function foo_(c) {\n+    let d = 1;\n+    return a + b + c + d;\n+  };\n+  return foo();\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/simple-ssa.js",
                "git_diff": "@@ -0,0 +1,9 @@\n+function Component(props) {\n+  let a;\n+  if (props) {\n+    a = 1;\n+  } else {\n+    a = 2;\n+  }\n+  return a;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/simple.js",
                "git_diff": "@@ -0,0 +1,4 @@\n+function test() {\n+  [true, false, null, 1, 3.14, ...[\"hello world!\"]];\n+  return 2;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/ssa-reassign-if.js",
                "git_diff": "@@ -0,0 +1,16 @@\n+function Component(a, b) {\n+  let x;\n+  let y = 0;\n+  let z = 10;\n+  if (a) {\n+    x = 1;\n+    if (b) {\n+      z = 20;\n+    } else {\n+      z = 30;\n+    }\n+  } else {\n+    x = 2;\n+  }\n+  return x + y + z;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures/use-memo.js",
                "git_diff": "@@ -0,0 +1,8 @@\n+import { useMemo } from \"react\";\n+\n+function Component(x) {\n+  const y = useMemo(() => {\n+    return x;\n+  });\n+  return y;\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/fixtures_test.rs",
                "git_diff": "@@ -0,0 +1,88 @@\n+/*\n+ * Copyright (c) Meta Platforms, Inc. and affiliates.\n+ *\n+ * This source code is licensed under the MIT license found in the\n+ * LICENSE file in the root directory of this source tree.\n+ */\n+\n+use std::env;\n+use std::fmt::Write;\n+\n+use insta::{assert_snapshot, glob};\n+use miette::{NamedSource, Report};\n+use react_build_hir::build;\n+use react_estree::{ModuleItem, Statement};\n+use react_hermes_parser::parse;\n+use react_hir::{inline_use_memo, Environment, Features, Print, Registry};\n+use react_optimization::constant_propagation;\n+use react_semantic_analysis::analyze;\n+use react_ssa::{eliminate_redundant_phis, enter_ssa};\n+\n+#[test]\n+fn fixtures() {\n+    glob!(\"fixtures/**.js\", |path| {\n+        println!(\"fixture {}\", path.to_str().unwrap());\n+        let input = std::fs::read_to_string(path).unwrap();\n+        let ast = parse(&input, path.to_str().unwrap()).unwrap();\n+        println!(\"ok parse\");\n+\n+        let mut output = String::new();\n+\n+        let mut analysis = analyze(&ast, Default::default());\n+        let diagnostics = analysis.diagnostics();\n+        if !diagnostics.is_empty() {\n+            for diagnostic in diagnostics {\n+                eprintln!(\n+                    \"{:?}\",\n+                    Report::new(diagnostic)\n+                        .with_source_code(NamedSource::new(path.to_string_lossy(), input.clone(),))\n+                );\n+            }\n+        }\n+        let environment = Environment::new(\n+            Features {\n+                validate_frozen_lambdas: true,\n+            },\n+            Registry,\n+            analysis,\n+        );\n+        for (ix, item) in ast.body.iter().enumerate() {\n+            if let ModuleItem::Statement(stmt) = item {\n+                if let Statement::FunctionDeclaration(fun) = stmt {\n+                    if ix != 0 {\n+                        output.push_str(\"\\n\\n\");\n+                    }\n+                    match build(&environment, &fun.function) {\n+                        Ok(mut fun) => {\n+                            println!(\"ok build\");\n+                            enter_ssa(&environment, &mut fun).unwrap();\n+                            println!(\"ok enter_ssa\");\n+                            eliminate_redundant_phis(&environment, &mut fun);\n+                            println!(\"ok eliminate_redundant_phis\");\n+                            constant_propagation(&environment, &mut fun).unwrap();\n+                            println!(\"ok constant_propagation\");\n+                            inline_use_memo(&environment, &mut fun).unwrap();\n+                            println!(\"ok inline_use_memo\");\n+                            fun.print(&fun.body, &mut output).unwrap();\n+                            println!(\"ok print\");\n+                        }\n+                        Err(error) => {\n+                            write!(&mut output, \"{}\", error,).unwrap();\n+                            eprintln!(\n+                                \"{:?}\",\n+                                Report::new(error).with_source_code(NamedSource::new(\n+                                    path.to_string_lossy(),\n+                                    input.clone(),\n+                                ))\n+                            );\n+                            continue;\n+                        }\n+                    };\n+                }\n+            }\n+        }\n+\n+        let output = output.trim();\n+        assert_snapshot!(format!(\"Input:\\n{input}\\n\\nOutput:\\n{output}\"));\n+    });\n+}"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@constant-propagation-constant-if-condition.js.snap",
                "git_diff": "@@ -0,0 +1,73 @@\n+---\n+source: crates/react_fixtures/tests/fixtures_test.rs\n+expression: \"format!(\\\"Input:\\\\n{input}\\\\n\\\\nOutput:\\\\n{output}\\\")\"\n+input_file: crates/react_fixtures/tests/fixtures/constant-propagation-constant-if-condition.js\n+---\n+Input:\n+function Component() {\n+  let a = 1;\n+\n+  let b;\n+  if (a === 1) {\n+    b = true;\n+  } else {\n+    b = false;\n+  }\n+\n+  let c;\n+  if (b) {\n+    c = \"hello\";\n+  } else {\n+    c = null;\n+  }\n+\n+  let d;\n+  if (c === \"hello\") {\n+    d = 42.0;\n+  } else {\n+    d = 42.001;\n+  }\n+\n+  let e;\n+  if (d === 42.0) {\n+    e = \"ok\";\n+  } else {\n+    e = \"nope\";\n+  }\n+\n+  // should constant-propagate to \"ok\"\n+  return e;\n+}\n+\n+\n+Output:\n+function Component(\n+)\n+entry bb0\n+bb0 (block)\n+  [0] unknown $39 = 1\n+  [1] unknown $41 = StoreLocal Let unknown a$40 = unknown $39\n+  [2] unknown $43 = DeclareLocal Let unknown b$42\n+  [3] unknown $44 = 1\n+  [4] unknown $45 = 1\n+  [5] unknown $46 = true\n+  [6] unknown $47 = true\n+  [7] unknown $49 = StoreLocal Reassign unknown b$48 = unknown $47\n+  [8] unknown $54 = DeclareLocal Let unknown c$53\n+  [9] unknown $56 = true\n+  [10] unknown $57 = \"hello\"\n+  [11] unknown $59 = StoreLocal Reassign unknown c$58 = unknown $57\n+  [12] unknown $64 = DeclareLocal Let unknown d$63\n+  [13] unknown $66 = \"hello\"\n+  [14] unknown $67 = \"hello\"\n+  [15] unknown $68 = true\n+  [16] unknown $69 = 42\n+  [17] unknown $71 = StoreLocal Reassign unknown d$70 = unknown $69\n+  [18] unknown $76 = DeclareLocal Let unknown e$75\n+  [19] unknown $78 = 42\n+  [20] unknown $79 = 42\n+  [21] unknown $80 = true\n+  [22] unknown $81 = \"ok\"\n+  [23] unknown $83 = StoreLocal Reassign unknown e$82 = unknown $81\n+  [24] unknown $88 = \"ok\"\n+  [25] Return unknown $88"
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@constant-propagation.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@destructure-array.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@destructure-object.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@error.assign-to-global.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@for-statement.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@function-expressions.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@identifiers.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@if-statement.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@simple-function.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@simple-ssa.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@simple.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@ssa-reassign-if.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_fixtures/tests/snapshots/fixtures_test__fixtures@use-memo.js.snap",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/Cargo.toml",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/README.md",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/build.rs",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/src/generated.rs",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/src/generated_extension.rs",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/src/lib.rs",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/alias-capture-in-method-receiver-and-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/alias-capture-in-method-receiver.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/alias-computed-load.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/alias-nested-member-path-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/alias-nested-member-path.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/alias-while.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/allocating-primitive-as-dep-nested-scope.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/allocating-primitive-as-dep.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/allow-passing-refs-as-props.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-access-assignment.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-at-closure.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-at-effect.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-at-mutate-after-capture.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-expression-spread.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-join.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-map-frozen-array.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-map-mutable-array-mutating-lambda.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-pattern-params.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-properties.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-property-call.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/array-push-effect.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/arrow-function-expr-gating-test.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/assignment-expression-computed.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/assignment-expression-nested-path.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/assignment-in-nested-if.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/assignment-variations-complex-lvalue-array.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/assignment-variations-complex-lvalue.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/assignment-variations.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/await-side-effecting-promise.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/await.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/babel-existing-react-import.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/babel-existing-react-kitchensink-import.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/bug.useMemo-deps-array-not-cleared.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/bug_object-pattern.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/builtin-jsx-tag-lowered-between-mutations.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/call-args-assignment.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/call-args-destructuring-assignment.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/call-spread.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/call-with-independently-memoizable-arg.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/call.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capture-indirect-mutate-alias.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capture-param-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capture_mutate-across-fns.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-arrow-function-1.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-fun-alias-captured-mutate-2.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-fun-alias-captured-mutate-arr-2.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-alias-captured-mutate-arr.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-alias-captured-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-alias-computed-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-alias-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-alias-receiver-computed-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-alias-receiver-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-mutate-2.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-mutate-3.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-mutate-nested.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-func-simple-alias.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-1.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-alias-computed-load-2.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-alias-computed-load-3.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-alias-computed-load-4.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-alias-computed-load.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-capture-ref-before-rename.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-conditional-capture-mutate.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-decl.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-member-expr-arguments.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-member-expr-call.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-renamed-ref.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-runs-inference.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-shadow-captured.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-skip-computed-path.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-function-within-block.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-member-expr.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-nested-member-call.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-nested-member-expr-in-nested-func.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-nested-member-expr.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-reference-changes-type.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-variable-in-nested-block.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/capturing-variable-in-nested-function.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/chained-assignment-context-variable.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/chained-assignment-expressions.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/codegen-emit-imports-same-source.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/codegen-emit-make-read-only.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/codegen-instrument-forget-gating-test.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/codegen-instrument-forget-test.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/complex-while.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/component.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/computed-call-evaluation-order.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/computed-call-spread.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/computed-load-primitive-as-dependency.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/computed-store-alias.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/concise-arrow-expr.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/cond-deps-conditional-member-expr.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/conditional-break-labeled.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/conditional-break.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/conditional-on-mutable.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/conditional-set-state-in-render.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/console-readonly.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/const-propagation-into-function-expression-global.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/const-propagation-into-function-expression-primitive.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/constant-computed.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/constant-propagation-for.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/constant-propagation-into-function-expressions.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/constant-propagation-phi.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/constant-propagation-while.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/constant-propagation.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/constructor.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/context-variable-reassigned-outside-of-lambda.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/controlled-input.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/dce-loop.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/debugger-memoized.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/debugger.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/declare-reassign-variable-in-closure.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/declare-reassign-variable-in-function-declaration.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/delete-computed-property.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/delete-property.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/dependencies-outputs.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/dependencies.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructure-capture-global.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructure-direct-reassignment.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-array-default.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-array-param-default.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-assignment-array-default.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-assignment.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-mixed-scope-and-local-variables-with-default.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-mixed-scope-declarations-and-locals.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-object-default.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-object-param-default.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring-property-inference.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/destructuring.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/disable-jsx-memoization.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/do-while-break.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/do-while-compound-test.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/do-while-conditional-break.js",
                "git_diff": ""
            },
            {
                "file": "compiler/crates/react_hermes_parser/tests/fixtures/do-while-continue.js",
                "git_diff": ""
            },
            {
                "file": "packages/react-devtools-shared/src/backend/fiber/renderer.js",
                "git_diff": "@@ -1098,7 +1098,10 @@ export function attach(\n     // even if objects are different\n     const message = formatConsoleArgumentsToSingleString(...args);\n     if (__DEBUG__) {\n-      debug('onErrorOrWarning', fiber, null, `${type}: \"${message}\"`);\n+      const fiberInstance = fiberToFiberInstanceMap.get(fiber);\n+      if (fiberInstance !== undefined) {\n+        debug('onErrorOrWarning', fiberInstance, null, `${type}: \"${message}\"`);\n+      }\n     }\n \n     // Mark this Fiber as needed its warning/error count updated during the next flush.\n@@ -1134,32 +1137,37 @@ export function attach(\n   // It relies on the extension to pass the preference through via the global.\n   patchConsoleUsingWindowValues();\n \n-  const debug = (\n+  function debug(\n     name: string,\n-    fiber: Fiber,\n+    instance: DevToolsInstance,\n     parentInstance: null | DevToolsInstance,\n     extraString: string = '',\n-  ): void => {\n+  ): void {\n     if (__DEBUG__) {\n       const displayName =\n-        fiber.tag + ':' + (getDisplayNameForFiber(fiber) || 'null');\n-\n-      const maybeID = getFiberIDUnsafe(fiber) || '<no id>';\n-\n-      let parentDisplayName;\n-      let maybeParentID;\n-      if (parentInstance !== null && parentInstance.kind === FIBER_INSTANCE) {\n-        const parentFiber = parentInstance.data;\n-        parentDisplayName =\n-          parentFiber.tag +\n-          ':' +\n-          (getDisplayNameForFiber(parentFiber) || 'null');\n-        maybeParentID = String(parentInstance.id);\n-      } else {\n-        // TODO: Handle VirtualInstance\n-        parentDisplayName = '';\n-        maybeParentID = '<no-id>';\n-      }\n+        instance.kind === VIRTUAL_INSTANCE\n+          ? instance.data.name || 'null'\n+          : instance.data.tag +\n+            ':' +\n+            (getDisplayNameForFiber(instance.data) || 'null');\n+\n+      const maybeID =\n+        instance.kind === FILTERED_FIBER_INSTANCE ? '<no id>' : instance.id;\n+\n+      const parentDisplayName =\n+        parentInstance === null\n+          ? ''\n+          : parentInstance.kind === VIRTUAL_INSTANCE\n+            ? parentInstance.data.name || 'null'\n+            : parentInstance.data.tag +\n+              ':' +\n+              (getDisplayNameForFiber(parentInstance.data) || 'null');\n+\n+      const maybeParentID =\n+        parentInstance === null ||\n+        parentInstance.kind === FILTERED_FIBER_INSTANCE\n+          ? '<no id>'\n+          : parentInstance.id;\n \n       console.groupCollapsed(\n         `[renderer] %c${name} %c${displayName} (${maybeID}) %c${\n@@ -1173,7 +1181,7 @@ export function attach(\n       console.log(new Error().stack.split('\\n').slice(1).join('\\n'));\n       console.groupEnd();\n     }\n-  };\n+  }\n \n   // eslint-disable-next-line no-unused-vars\n   function debugTree(instance: DevToolsInstance, indent: number = 0) {\n@@ -1569,9 +1577,6 @@ export function attach(\n   // Removes a Fiber (and its alternate) from the Maps used to track their id.\n   // This method should always be called when a Fiber is unmounting.\n   function untrackFiber(nearestInstance: DevToolsInstance, fiber: Fiber) {\n-    if (__DEBUG__) {\n-      debug('untrackFiber()', fiber, null);\n-    }\n     // TODO: Consider using a WeakMap instead. The only thing where that doesn't work\n     // is React Native Paper which tracks tags but that support is eventually going away\n     // and can use the old findFiberByHostInstance strategy.\n@@ -2245,7 +2250,7 @@ export function attach(\n     const id = fiberInstance.id;\n \n     if (__DEBUG__) {\n-      debug('recordMount()', fiber, parentInstance);\n+      debug('recordMount()', fiberInstance, parentInstance);\n     }\n \n     const isProfilingSupported = fiber.hasOwnProperty('treeBaseDuration');\n@@ -2422,7 +2427,7 @@ export function attach(\n   function recordUnmount(fiberInstance: FiberInstance): void {\n     const fiber = fiberInstance.data;\n     if (__DEBUG__) {\n-      debug('recordUnmount()', fiber, null);\n+      debug('recordUnmount()', fiberInstance, reconcilingParent);\n     }\n \n     if (trackedPathMatchInstance === fiberInstance) {\n@@ -2757,15 +2762,14 @@ export function attach(\n     fiber: Fiber,\n     traceNearestHostComponentUpdate: boolean,\n   ): void {\n-    if (__DEBUG__) {\n-      debug('mountFiberRecursively()', fiber, reconcilingParent);\n-    }\n-\n     const shouldIncludeInTree = !shouldFilterFiber(fiber);\n     let newInstance = null;\n     if (shouldIncludeInTree) {\n       newInstance = recordMount(fiber, reconcilingParent);\n       insertChild(newInstance);\n+      if (__DEBUG__) {\n+        debug('mountFiberRecursively()', newInstance, reconcilingParent);\n+      }\n     } else if (\n       reconcilingParent !== null &&\n       reconcilingParent.kind === VIRTUAL_INSTANCE\n@@ -2785,6 +2789,9 @@ export function attach(\n \n       newInstance = createFilteredFiberInstance(fiber);\n       insertChild(newInstance);\n+      if (__DEBUG__) {\n+        debug('mountFiberRecursively()', newInstance, reconcilingParent);\n+      }\n     }\n \n     // If we have the tree selection from previous reload, try to match this Fiber.\n@@ -2898,9 +2905,7 @@ export function attach(\n   // when we switch from primary to fallback, or deleting a subtree.\n   function unmountInstanceRecursively(instance: DevToolsInstance) {\n     if (__DEBUG__) {\n-      if (instance.kind === FIBER_INSTANCE) {\n-        debug('unmountInstanceRecursively()', instance.data, null);\n-      }\n+      debug('unmountInstanceRecursively()', instance, reconcilingParent);\n     }\n \n     const stashedParent = reconcilingParent;\n@@ -3034,13 +3039,10 @@ export function attach(\n     parentInstance: FiberInstance | VirtualInstance,\n   ) {\n     if (__DEBUG__) {\n-      if (\n-        parentInstance.firstChild !== null &&\n-        parentInstance.firstChild.kind === FIBER_INSTANCE\n-      ) {\n+      if (parentInstance.firstChild !== null) {\n         debug(\n           'recordResetChildren()',\n-          parentInstance.firstChild.data,\n+          parentInstance.firstChild,\n           parentInstance,\n         );\n       }\n@@ -3417,7 +3419,9 @@ export function attach(\n     traceNearestHostComponentUpdate: boolean,\n   ): boolean {\n     if (__DEBUG__) {\n-      debug('updateFiberRecursively()', nextFiber, reconcilingParent);\n+      if (fiberInstance !== null) {\n+        debug('updateFiberRecursively()', fiberInstance, reconcilingParent);\n+      }\n     }\n \n     if (traceUpdatesEnabled) {"
            }
        ]
    }
]